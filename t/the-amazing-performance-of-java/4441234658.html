<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/the-amazing-performance-of-java/444123?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:37:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>The amazing performance of java - General Programming - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;ll just leave this picture here. 

[image] [image] 

Note: For C++ the CLOCKS_PER_SEC value on the system was 1000 - so that&amp;#39;s 2262ms.">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="4441234658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;The amazing performance of java&#39;" href="444123.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://i50.tinypic.com/2l8hr9f.png" />
<meta property="og:image" content="http://i50.tinypic.com/2l8hr9f.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/the-amazing-performance-of-java/444123?page=2" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/the-amazing-performance-of-java/444123?page=2" />
<meta property="og:title" content="The amazing performance of java" />
<meta name="twitter:title" content="The amazing performance of java" />
<meta property="og:description" content="In case any of you want to learn a bit more about the topic at hand, read here: http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=5005861  Essentially, the JIT won’t help much here, except avoid the JNI overhead of calling since StrictMath is all delegated to native code. The reason Java lags behind is that StrictMath is implemented to return cross-platform strict results with a high-degree of precision and accuracy, while the C++ code most likely uses low-level fsin/fcos/fsincos instructions, ..." />
<meta name="twitter:description" content="In case any of you want to learn a bit more about the topic at hand, read here: http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=5005861  Essentially, the JIT won’t help much here, except avoid the JNI overhead of calling since StrictMath is all delegated to native code. The reason Java lags behind is that StrictMath is implemented to return cross-platform strict results with a high-degree of precision and accuracy, while the C++ code most likely uses low-level fsin/fcos/fsincos instructions, ..." />
<meta property="article:published_time" content="2012-06-09T16:06:09+00:00" />
<meta property="og:ignore_canonical" content="true" />

      <link rel="prev" href="444123.html">


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="444123.html">The amazing performance of java</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-06-09T16:06:09Z'>
            <time itemprop='dateModified' datetime='2016-08-03T03:05:34Z' class='post-time'>
              August 3, 2016,  3:05am
            </time>
        <span itemprop='position'>#21</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>In case any of you want to learn a bit more about the topic at hand, read here: <a href="http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=5005861" rel="nofollow noopener">http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=5005861</a></p>
<p>Essentially, the JIT won’t help much here, except avoid the JNI overhead of calling since StrictMath is all delegated to native code. The reason Java lags behind is that StrictMath is implemented to return cross-platform strict results with a high-degree of precision and accuracy, while the C++ code most likely uses low-level fsin/fcos/fsincos instructions, which are going to be much faster. Unfortunately, fsin/fcos/fsincos are pretty arbitrary in their hardware implementation, and on Intel at least, they’re only accurate over the interval [-pi/4, pi/4] – as such, they require sophisticated precise argument reduction.</p>
<p>The JVM does attempt to optimize the calls on x86, as can be seen here: <a href="http://hg.openjdk.java.net/jdk7/hotspot/hotspot/file/9b0ca45cd756/src/cpu/x86/vm/interpreter_x86_32.cpp" rel="nofollow noopener">http://hg.openjdk.java.net/jdk7/hotspot/hotspot/file/9b0ca45cd756/src/cpu/x86/vm/interpreter_x86_32.cpp</a></p>
<p><code>address InterpreterGenerator::generate_math_entry(AbstractInterpreter::MethodKind kind) {
      109 
      110   // rbx,: methodOop
      111   // rcx: scratrch
      112   // rsi: sender sp
      113 
      114   if (!InlineIntrinsics) return NULL; // Generate a vanilla entry
      115 
      116   address entry_point = __ pc();
      117 
      118   // These don't need a safepoint check because they aren't virtually
      119   // callable. We won't enter these intrinsics from compiled code.
      120   // If in the future we added an intrinsic which was virtually callable
      121   // we'd have to worry about how to safepoint so that this code is used.
      122 
      123   // mathematical functions inlined by compiler
      124   // (interpreter must provide identical implementation
      125   // in order to avoid monotonicity bugs when switching
      126   // from interpreter to compiler in the middle of some
      127   // computation)
      128   //
      129   // stack: [ ret adr ] &lt;-- rsp
      130   //        [ lo(arg) ]
      131   //        [ hi(arg) ]
      132   //
      133 
      134   // Note: For JDK 1.2 StrictMath doesn't exist and Math.sin/cos/sqrt are
      135   //       native methods. Interpreter::method_kind(...) does a check for
      136   //       native methods first before checking for intrinsic methods and
      137   //       thus will never select this entry point. Make sure it is not
      138   //       called accidentally since the SharedRuntime entry points will
      139   //       not work for JDK 1.2.
      140   //
      141   // We no longer need to check for JDK 1.2 since it's EOL'ed.
      142   // The following check existed in pre 1.6 implementation,
      143   //    if (Universe::is_jdk12x_version()) {
      144   //      __ should_not_reach_here();
      145   //    }
      146   // Universe::is_jdk12x_version() always returns false since
      147   // the JDK version is not yet determined when this method is called.
      148   // This method is called during interpreter_init() whereas
      149   // JDK version is only determined when universe2_init() is called.
      150 
      151   // Note: For JDK 1.3 StrictMath exists and Math.sin/cos/sqrt are
      152   //       java methods.  Interpreter::method_kind(...) will select
      153   //       this entry point for the corresponding methods in JDK 1.3.
      154   // get argument
      155   __ fld_d(Address(rsp, 1*wordSize));
      156   switch (kind) {
      157     case Interpreter::java_lang_math_sin :
      158         __ trigfunc('s');
      159         break;
      160     case Interpreter::java_lang_math_cos :
      161         __ trigfunc('c');
      162         break;
      163     case Interpreter::java_lang_math_tan :
      164         __ trigfunc('t');
      165         break;
      166     case Interpreter::java_lang_math_sqrt:
      167         __ fsqrt();
      168         break;
      169     case Interpreter::java_lang_math_abs:
      170         __ fabs();
      171         break;
      172     case Interpreter::java_lang_math_log:
      173         __ flog();
      174         // Store to stack to convert 80bit precision back to 64bits
      175         __ push_fTOS();
      176         __ pop_fTOS();
      177         break;
      178     case Interpreter::java_lang_math_log10:
      179         __ flog10();
      180         // Store to stack to convert 80bit precision back to 64bits
      181         __ push_fTOS();
      182         __ pop_fTOS();
      183         break;
      184     default                              :
      185         ShouldNotReachHere();
      186   }
      187 
      188   // return double result in xmm0 for interpreter and compilers.
      189   if (UseSSE &gt;= 2) {
      190     __ subptr(rsp, 2*wordSize);
      191     __ fstp_d(Address(rsp, 0));
      192     __ movdbl(xmm0, Address(rsp, 0));
      193     __ addptr(rsp, 2*wordSize);
      194   }
      195 
      196   // done, result in FPU ST(0) or XMM0
      197   __ pop(rdi);                               // get return address
      198   __ mov(rsp, rsi);                          // set sp to sender sp
      199   __ jmp(rdi);
      200 
      201   return entry_point;
      202 }</code></p>
      </div>

      <meta itemprop='headline' content='The amazing performance of java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/JavaTC.html'><span itemprop='name'>JavaTC</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-06-16T20:25:04Z'>
            <time itemprop='dateModified' datetime='2016-08-03T03:17:00Z' class='post-time'>
              August 3, 2016,  3:17am
            </time>
        <span itemprop='position'>#22</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Maybe I should have bought that Java book <img src="../../images/emoji/twitter/expressionlessae52.png?v=5" title=":expressionless:" class="emoji" alt=":expressionless:"></p>
      </div>

      <meta itemprop='headline' content='The amazing performance of java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Smokey2.html'><span itemprop='name'>Smokey2</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-22T18:27:29Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:51:26Z' class='post-time'>
              August 4, 2016,  1:51am
            </time>
        <span itemprop='position'>#23</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>In addition to running a compiled Java program, computers running Java applications generally must also run the Java virtual machine (JVM), while compiled C++ programs can be run without external applications. Early versions of Java were significantly outperformed by statically compiled languages such as C++. This is because the program statements of these two closely related languages may compile to a few machine instructions with C++, while compiling into several byte codes involving several machine instructions each when interpreted by a JVM. For example:</p>
<p>Java/C++ statement:</p>
<pre><code class="lang-auto"></code></pre>
<p>C++ generated code:</p>
<p><code>mov edx,[ebp+4h]
mov eax,[ebp+1Ch]
inc dword ptr [edx+eax*4] </code></p>
<p>Java generated code:</p>
<p><code>aload_1
iload_2
dup2
iaload
iconst_1
iadd
iastore</code></p>
<p>Certain inefficiencies are inherent to the Java language itself, primarily:<br>
All objects are allocated on the heap. For functions using small objects this can result in performance degradation as stack allocation, in contrast, costs essentially zero. However, this advantage is obsoleted by modern JIT compilers utilising escape analysis or escape detection to allocate objects on the stack. Escape analysis was introduced in Oracle JDK 6.<br>
Methods are virtual by default. This slightly increases memory usage by adding a single pointer to a virtual table per each object. It also induces a startup performance penalty, since a JIT compiler must perform additional optimization passes even for de-virtualization of small functions.<br>
A lot of casting required even using standard containers induces a performance penalty. However, most of these casts are statically eliminated by the JIT compiler, and the casts that remain in the code usually do not cost more than a single CPU cycle on modern processors, thanks to branch prediction.<br>
Array access must be safe. The compiler is required to put appropriate range checks in the code. The naive approach of guarding each array access with a range check is not efficient, so most JIT compilers generate range check instructions only if they cannot statically prove the array access is safe. Even if all runtime range checks cannot be statically elided, JIT compilers try to move them out of inner loops to make the performance degradation as low as possible.<br>
Lack of access to low-level details prevents the developer from improving the program where the compiler is unable to do so. Programmers can interface with the OS directly by providing code in C or C++ and calling that code from Java by means of JNI.<br>
In contrast, various optimizations in C++ are either too difficult or impractical to implement:<br>
Pointers make optimization difficult since they may point to arbitrary data. However, in some cases this is obsoleted as new compilers introduced a strict-aliasing rule and because of support of the C99 keyword restrict.<br>
Java garbage collection may have better cache coherence than the usual usage of malloc/new for memory allocation, as its allocations are generally made sequentially. Nevertheless, arguments exist[weasel words] that both allocators equally fragment the heap and neither exhibits better cache locality.<br>
Due to the lack of garbage collection in C++, programmers must supply their own memory management code, often in the form of reference-counted smart pointers.<br>
Since the code generated from various concretisations of the same templated class in C++ is not shared, excessive use of templates may lead to significant increase of the executable code size.<br>
Run-time compilation can potentially use additional information available at run-time to improve code more effectively, such as the processor on which the code will be executed. However, this claim is effectively made obsolete as most state-of-the-art C++ compilers generate multiple code paths to employ the full computational abilities of the given system<br>
Run-time compilation allows for more aggressive virtual function inlining than is possible for a static compiler, because the JIT compiler has complete information about all possible targets of the virtual call, even if they are in different dynamically loaded modules. Currently available JVM implementations have no problem in inlining most of the monomorphic, mostly monomorphic and dimorphic calls, and research is in progress to inline also megamorphic calls, thanks to the recent invoke dynamic enhancements added in Java 7. Inlining can allow for further optimisations like loop vectorisation or loop unrolling, resulting in a huge overall performance increase.<br>
Because dynamic linking is performed after code generation and optimisation in C++, function calls spanning different dynamic modules cannot be inlined.<br>
Because thread support is provided by libraries in C++, C++ compilers have no chance to perform thread-related optimisations. In Java, thread synchronisation is built into the language, so the JIT compiler can, with the help of escape analysis, easily elide or coarse locks, significantly improving performance of multithreaded code. This technique was introduced in Sun JDK 6 update 10 and is named biased locking.</p>
<aside class="onebox wikipedia">
  <header class="source">
      <a href="https://en.wikipedia.org/wiki/Comparison_of_Java_and_C++" target="_blank" rel="nofollow noopener">en.wikipedia.org</a>
  </header>
  <article class="onebox-body">
    <img src="http://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/Text_document_with_red_question_mark.svg/40px-Text_document_with_red_question_mark.svg.png" class="thumbnail onebox-full-image" width="40" height="40">

<h3><a href="https://en.wikipedia.org/wiki/Comparison_of_Java_and_C++" target="_blank" rel="nofollow noopener">Comparison of Java and C++</a></h3>

<p>This is a comparison of the programming languages Java and C++.   The differences between the programming languages C++ and Java can be traced to their heritage, as they have different design goals.</p>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

      </div>

      <meta itemprop='headline' content='The amazing performance of java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pwnd.html'><span itemprop='name'>Pwnd</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-31T10:01:55Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:59:10Z' class='post-time'>
              August 4, 2016,  1:59am
            </time>
        <span itemprop='position'>#24</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Redundant, but when a language is more difficult to implement, how would that directly correlate to the amount of money you make?</p>
<p>difficulty != usefulness</p>
      </div>

      <meta itemprop='headline' content='The amazing performance of java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
      <span itemprop='name'><a rel="prev" itemprop="url" href="444123.html">← previous page</a></span>
  </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/the-amazing-performance-of-java/444123?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:37:16 GMT -->
</html>
