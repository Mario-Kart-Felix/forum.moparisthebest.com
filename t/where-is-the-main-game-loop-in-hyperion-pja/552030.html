<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/where-is-the-main-game-loop-in-hyperion-pja/552030 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Where is the main game loop in Hyperion(PJA)? - Runescape - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;ve taken a look at the way Hyperion handles events by queueing them up and dispatching threads to deal with them sequentially(i think). But something is bugging me, where is Hyperion&amp;#39;s main game loop? I know according &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="552030.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Where is the main game loop in Hyperion(PJA)?&#39;" href="552030.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/where-is-the-main-game-loop-in-hyperion-pja/552030" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/where-is-the-main-game-loop-in-hyperion-pja/552030" />
<meta property="og:title" content="Where is the main game loop in Hyperion(PJA)?" />
<meta name="twitter:title" content="Where is the main game loop in Hyperion(PJA)?" />
<meta property="og:description" content="I’ve taken a look at the way Hyperion handles events by queueing them up and dispatching threads to deal with them sequentially(i think). But something is bugging me, where is Hyperion’s main game loop? I know according to Graham the server doesn’t have a main game loop equivalent to run() in other servers, but, where can you even submit new events for the game engine to process? Is it   ?  If so does this mean you must register all events ahead of time? Also As I’m using Project Anihilition(Whi..." />
<meta name="twitter:description" content="I’ve taken a look at the way Hyperion handles events by queueing them up and dispatching threads to deal with them sequentially(i think). But something is bugging me, where is Hyperion’s main game loop? I know according to Graham the server doesn’t have a main game loop equivalent to run() in other servers, but, where can you even submit new events for the game engine to process? Is it   ?  If so does this mean you must register all events ahead of time? Also As I’m using Project Anihilition(Whi..." />
<meta property="article:published_time" content="2015-06-16T16:14:29+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="552030.html">Where is the main game loop in Hyperion(PJA)?</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frozon566.html'><span itemprop='name'>frozon566</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-16T16:14:29Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:13Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’ve taken a look at the way Hyperion handles events by queueing them up and dispatching threads to deal with them sequentially(i think). But something is bugging me, where is Hyperion’s main game loop? I know according to Graham the server doesn’t have a main game loop equivalent to run() in other servers, but, where can you even submit new events for the game engine to process? Is it</p>
<pre><code class="lang-auto"></code></pre>
<p>?</p>
<p>If so does this mean you must register all events ahead of time? Also As I’m using Project Anihilition(Which was built on top of Hyperion) my registerGlobalEvents() looks like this</p>
<p><code>	private void registerGlobalEvents() {
		submit(new UpdateEvent());
		submit(new CleanupEvent());
		submit(new SkullEvent());
		submit(new RestoreEvent());
		submit(new RunEnergyEvent());
		submit(new SpecialUpdateEvent());
		submit(new WarriorGuildEvent());
		submit(new GroundItemEvent());
		submit(new SavingEvent());
		submit(new HolidayEvent());
	}</code></p>
<p>But i’m noticing this doesn’t contain network-related events(aside from UpdateEvent() which removes players if they are no longer connected). So where would networking events like, say, pressing a button be handled, I would imagine on a separate thread, but where exactly?</p>
      </div>

      <meta itemprop='headline' content='Where is the main game loop in Hyperion(PJA)?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-16T16:18:45Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:13Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“frozon566, post:1, topic:552030”]I’ve taken a look at the way Hyperion handles events by queueing them up and dispatching threads to deal with them sequentially(i think). But something is bugging me, where is Hyperion’s main game loop? I know according to Graham the server doesn’t have a main game loop equivalent to run() in other servers, but, where can you even submit new events for the game engine to process? Is it</p>
<pre><code class="lang-auto"></code></pre>
<p>?</p>
<p>If so does this mean you must register all events ahead of time? Also As I’m using Project Anihilition(Which was built on top of Hyperion) my registerGlobalEvents() looks like this</p>
<p><code>	private void registerGlobalEvents() {
		submit(new UpdateEvent());
		submit(new CleanupEvent());
		submit(new SkullEvent());
		submit(new RestoreEvent());
		submit(new RunEnergyEvent());
		submit(new SpecialUpdateEvent());
		submit(new WarriorGuildEvent());
		submit(new GroundItemEvent());
		submit(new SavingEvent());
		submit(new HolidayEvent());
	}</code></p>
<p>But i’m noticing this doesn’t contain network-related events(aside from UpdateEvent() which removes players if they are no longer connected). So where would networking events like, say, pressing a button be handled, I would imagine on a separate thread, but where exactly?[/quote]</p>
<p>Hmm, take a look in the event dispatcher. I’ll go get the source code and take a look.</p>
<p>EDIT: Yeah, it looks like it’s done in GameEngine in the run() method:</p>
<p><code>
@Override
public void run() {
    try {
        while(running) {
            try {
                final Task task = tasks.take();
                submitLogic(new Runnable() {
                    @Override
                    public void run() {
                        task.execute(GameEngine.this);
                    }
                });
            } catch(InterruptedException e) {
                continue;
            }
        }
    } finally {
        logicService.shutdown();
        taskService.shutdown();
        workService.shutdown();
    }
}</code></p>
<p>GameEngine has its own thread. <span class="bbcode-b">tasks</span> is a <span class="bbcode-i">BlockingQueue</span> which means that the current thread will block until there is a task to take. And while it’s running, it will always try to take tasks to process. There’s a <span class="bbcode-i">stop</span> method that will interrupt the current thread (and interrupt the currently processing task, if there is one) and stop the server.</p>
      </div>

      <meta itemprop='headline' content='Where is the main game loop in Hyperion(PJA)?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frozon566.html'><span itemprop='name'>frozon566</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-16T16:42:38Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:13Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I see, so events are scheduled future tasks.</p>
<p>In that case does this mean Hyperion doesn’t handle events that happen occasionally(like eating only occurs when you click the food) through the eventManager/game engine?</p>
      </div>

      <meta itemprop='headline' content='Where is the main game loop in Hyperion(PJA)?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/HcoJustin.html'><span itemprop='name'>HcoJustin</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-16T16:47:15Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:13Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“frozon566, post:3, topic:552030”]I see, so events are scheduled future tasks.</p>
<p>In that case does this mean Hyperion doesn’t handle events that happen occasionally(like eating only occurs when you click the food) through the eventManager/game engine?[/quote]<br>
That is called a Task. You can submit them to the World instance and they will be ran once when suitable. An Event is basically a scheduled Task.</p>
      </div>

      <meta itemprop='headline' content='Where is the main game loop in Hyperion(PJA)?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-16T16:56:02Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:14Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“frozon566, post:3, topic:552030”]I see, so events are scheduled future tasks.</p>
<p>In that case does this mean Hyperion doesn’t handle events that happen occasionally(like eating only occurs when you click the food) through the eventManager/game engine?[/quote]</p>
<p>No. Also in GameEngine, there are different ExecutorServices. One is for logic, which I take is for game events, one is a BlockingExecutorService, which creates a thread pool based on the number of available CPU cores you have, for things that need to be executed in parallel, and another ExecutorService that runs in a single thread, intended for File IO and other blocking operations. There are also subclasses of <span class="bbcode-b">Task</span>, namely <span class="bbcode-b">ParallelTask</span>, and <span class="bbcode-b">ConsecutiveTask</span>. Depending on which one is used, it calls one of three methods in GameEngine; <span class="bbcode-b">submitTask</span>, <span class="bbcode-b">submitWork</span>, and <span class="bbcode-b">submitLogic</span> which tells the engine how to process that task. Also, you wouldn’t really need to worry about it “missing” a tick, unless that thread (which should be the <span class="bbcode-b">logic</span> thread) is taking &gt; 600ms to process everything, which shouldn’t really be the case because each of those services have their own thread.</p>
      </div>

      <meta itemprop='headline' content='Where is the main game loop in Hyperion(PJA)?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/where-is-the-main-game-loop-in-hyperion-pja/552030 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:45 GMT -->
</html>
