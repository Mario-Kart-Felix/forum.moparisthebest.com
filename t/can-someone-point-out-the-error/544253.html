<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/can-someone-point-out-the-error/544253 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Can someone point out the error? - Game Development - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;m trying to merge packed models with un-packed models and I have it correctly writing the id and length but something is going wrong with the byte data of the model as everything is turning invisible when reading. 

Re&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="544253.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Can someone point out the error?&#39;" href="544253.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/can-someone-point-out-the-error/544253" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/can-someone-point-out-the-error/544253" />
<meta property="og:title" content="Can someone point out the error?" />
<meta name="twitter:title" content="Can someone point out the error?" />
<meta property="og:description" content="I’m trying to merge packed models with un-packed models and I have it correctly writing the id and length but something is going wrong with the byte data of the model as everything is turning invisible when reading.  Reading current models, new models and writing to a new file      public void readCurrentModels(String path) {         File file = new File(path);         int totalBytes = 0;         try {             FileInputStream input = new FileInputStream(file);             Stream stream = new..." />
<meta name="twitter:description" content="I’m trying to merge packed models with un-packed models and I have it correctly writing the id and length but something is going wrong with the byte data of the model as everything is turning invisible when reading.  Reading current models, new models and writing to a new file      public void readCurrentModels(String path) {         File file = new File(path);         int totalBytes = 0;         try {             FileInputStream input = new FileInputStream(file);             Stream stream = new..." />
<meta property="article:published_time" content="2014-06-24T02:43:37+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="544253.html">Can someone point out the error?</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming/game-development.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Game Development</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ohokay.html'><span itemprop='name'>ohokay</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-06-24T02:43:37Z'>
            <time itemprop='dateModified' datetime='2016-08-04T13:20:08Z' class='post-time'>
              August 4, 2016,  1:20pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’m trying to merge packed models with un-packed models and I have it correctly writing the id and length but something is going wrong with the byte data of the model as everything is turning invisible when reading.</p>
<p>Reading current models, new models and writing to a new file</p>
<pre><code class="lang-auto">    public void readCurrentModels(String path) {
        File file = new File(path);
        int totalBytes = 0;
        try {
            FileInputStream input = new FileInputStream(file);
            Stream stream = new Stream(new byte[input.available()]);
            input.read(stream.buffer, 0, stream.buffer.length);

            int modelCount = stream.readDWord();
            this.modelCount = modelCount;

            for (int i = 0; i &lt; modelCount; i++) {
                int modelId = stream.readDWord();
                int modelLength = stream.readDWord();
                byte[] modelData = stream.readBytes(0, modelLength);
                totalBytes += modelLength;
                modelList.add(new Model(modelId, modelLength, modelData));
            }
            input.close();
        } catch (Exception ex) {
        }
        
       System.out.println("Current models total bytes: "+ totalBytes);
    }

    public void readNewModels(String path) throws Exception {
        File file = new File(path);
        int totalBytes = 0;
        
        
        if (!foundModels(path)) {
            return;
        }
        
        if (file.isDirectory()) {
            for (File f : file.listFiles()) {
                DataInputStream fis = new DataInputStream(new FileInputStream(f));
                int id = Integer.parseInt(f.getName().substring(0, f.getName().indexOf(".")));
                int length = (int) f.length();
               // byte[] data = Files.readAllBytes(Paths.get(f.getCanonicalPath()));
                byte[] data = new byte[length];
                fis.readFully(data);
                modelCount++;
                totalBytes += length;
                modelList.add(new Model(id, length, data));
            }
        }
        
        System.out.println("New models total bytes: "+ totalBytes);
    }
    
    public void writeNewModels(String path) throws Exception {
        File newFile = new File(path);
        //Stream stream = new Stream(new byte[getTotalBytes()]);
        DataOutputStream output = new DataOutputStream(new FileOutputStream(newFile));
        
        output.writeInt(modelCount);
        System.out.println(modelCount+"");
        
        for (int i = 0; i &lt; modelCount; i++) {
            output.writeInt(modelList.get(i).getModelId());
            output.writeInt(modelList.get(i).getModelLength());
            output.write(modelList.get(i).getModelData(), 0, modelList.get(i).getModelLength());
        }
        System.out.println("New buffer total bytes: "+ getTotalBytes());
    }</code></pre>
<p>Reading all model data on client startup</p>
<pre><code class="lang-auto">    public void loadModels(String location) {
        File file = new File(location);
        try {
            DataInputStream input = new DataInputStream(new FileInputStream(file));
            byte[] buffer = new byte[input.available()];

            int modelCount = input.readInt();
            for (int i = 0; i &lt; modelCount; i++) {
                int modelId = input.readInt();
                int modelLength = input.readInt();  
                input.read(buffer, 0, modelLength);

                Model.method460(buffer, modelId);
            }

            input.close();
        } catch (Exception ex) {
        }
    }</code></pre>
<p>The length and id seems to be reading/writing correctly, just the model data is not. It’d be much appreciated if someone could show me where I’ve gone wrong.</p>
<pre><code class="lang-auto">id65328
len10904
id65269
len4903
id65288
len7224
id65312
len8503
id65271
len3500
id61727
len3742
id61729
len3769
id61731
len3742
id61732
len3509
id61741
len3509
id61764
len3763
id61812
len3569</code></pre>
      </div>

      <meta itemprop='headline' content='Can someone point out the error?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/can-someone-point-out-the-error/544253 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:00 GMT -->
</html>
