<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/cross-platform-detect-when-another-process-ends-c-or-c/398294 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 16:21:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Cross-platform detect when another process ends C or C++? - General Programming - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;m not even sure if this is possible to write in a decent cross platform way, first I&amp;#39;ll tell you what I am doing so you might have another solution, then I&amp;#39;ll tell you my idea to solve this particular problem. 

I am s&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="398294.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Cross-platform detect when another process ends C or C++?&#39;" href="398294.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/cross-platform-detect-when-another-process-ends-c-or-c/398294" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/cross-platform-detect-when-another-process-ends-c-or-c/398294" />
<meta property="og:title" content="Cross-platform detect when another process ends C or C++?" />
<meta name="twitter:title" content="Cross-platform detect when another process ends C or C++?" />
<meta property="og:description" content="I’m not even sure if this is possible to write in a decent cross platform way, first I’ll tell you what I am doing so you might have another solution, then I’ll tell you my idea to solve this particular problem.  I am spawning a native program from java using the Process class, then reading/writing to it over stdin and stdout.  This works great, except for when the java process is forcibly killed, since I can’t catch the signal in Java and close the process nicely, I need some way to detect if t..." />
<meta name="twitter:description" content="I’m not even sure if this is possible to write in a decent cross platform way, first I’ll tell you what I am doing so you might have another solution, then I’ll tell you my idea to solve this particular problem.  I am spawning a native program from java using the Process class, then reading/writing to it over stdin and stdout.  This works great, except for when the java process is forcibly killed, since I can’t catch the signal in Java and close the process nicely, I need some way to detect if t..." />
<meta property="article:published_time" content="2011-06-08T05:34:37+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="398294.html">Cross-platform detect when another process ends C or C++?</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-08T05:34:37Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:17:18Z' class='post-time'>
              August 1, 2016, 12:17pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’m not even sure if this is possible to write in a decent cross platform way, first I’ll tell you what I am doing so you might have another solution, then I’ll tell you my idea to solve this particular problem.</p>
<p>I am spawning a native program from java using the Process class, then reading/writing to it over stdin and stdout.  This works great, except for when the java process is forcibly killed, since I can’t catch the signal in Java and close the process nicely, I need some way to detect if the java process quit running from the native code and end it nicely if it did.</p>
<p>One of my ideas is to pass the PID of the java process into the spawned process, then every iteration the native code can check if the java process is still running or not, and, if not, stop itself nicely.</p>
<p>Of course this needs to be cross platform, at least supporting windows, linux, osx, and bsd variants.  (where ever sun java runs, basically)</p>
<p>Any ideas?</p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ollie.html'><span itemprop='name'>Ollie</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-08T13:59:58Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:17:30Z' class='post-time'>
              August 1, 2016, 12:17pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>do you need something like this? then do what you said before and cache the pid’s</p>
<p><code>BOOL IsRunning(DWORD id)
{
    HANDLE h = OpenProcess(SYNCHRONIZE, FALSE, id);
    DWORD return = WaitForSingleObject(h, 0);
    CloseHandle(h);
    return return == WAIT_TIMEOUT;
}</code></p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-08T16:54:44Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:17:38Z' class='post-time'>
              August 1, 2016, 12:17pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>this might help<br>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="https://stackoverflow.com/questions/284325/how-to-make-child-process-die-after-parent-exits" target="_blank" rel="nofollow noopener">stackoverflow.com</a>
  </header>
  <article class="onebox-body">
      <a href="https://stackoverflow.com/users/9403/paweł-hajdan" target="_blank" rel="nofollow noopener">
    <img alt="Paweł Hajdan" src="https://www.gravatar.com/avatar/df22611131aab1cc1f41fa8ea463f604?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="https://stackoverflow.com/questions/284325/how-to-make-child-process-die-after-parent-exits" target="_blank" rel="nofollow noopener">How to make child process die after parent exits?</a>
</h4>

<div class="tags">
  <strong>c, linux, unix, process</strong>
</div>

<div class="date">
  asked by
  
  <a href="https://stackoverflow.com/users/9403/paweł-hajdan" target="_blank" rel="nofollow noopener">
    Paweł Hajdan
  </a>
  on <a href="https://stackoverflow.com/questions/284325/how-to-make-child-process-die-after-parent-exits" target="_blank" rel="nofollow noopener">03:37PM - 12 Nov 08</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-08T17:04:11Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:17:38Z' class='post-time'>
              August 1, 2016, 12:17pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="../../u/ollie-2.html">@Ollie</a>, looks like it could work, it’s windows only though.</p>
<p><a class="mention" href="../../u/lawl.html">@lawl</a>, I don’t think this is actually a child process in the normal sense of the word, just a process spawned from java code, I’ll have to look into it, thanks.</p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-08T17:16:59Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:17:38Z' class='post-time'>
              August 1, 2016, 12:17pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hmm, actually this might work just fine:<br>
<a href="http://download.oracle.com/javase/1.4.2/docs/api/java/lang/Runtime.html#addShutdownHook%28java.lang.Thread%29" class="onebox" target="_blank">http://download.oracle.com/javase/1.4.2/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread)</a><br>
I’ll have to test to see how it works later.</p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-08T17:32:07Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:17:39Z' class='post-time'>
              August 1, 2016, 12:17pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Moparisthebest, post:5, topic:398294”]Hmm, actually this might work just fine:<br>
<a href="http://download.oracle.com/javase/1.4.2/docs/api/java/lang/Runtime.html#addShutdownHook%28java.lang.Thread%29" class="onebox" target="_blank" rel="nofollow noopener">http://download.oracle.com/javase/1.4.2/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread)</a><br>
I’ll have to test to see how it works later.[/quote]<br>
very unlikely that it will work for a kill signal, seeing as the process gets no notification</p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-08T20:07:22Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:17:48Z' class='post-time'>
              August 1, 2016, 12:17pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Not for a SIGKILL, but nothing can handle that, it should work for a regular kill, abort message or similar.  I’ll see soon I guess.</p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-08T20:13:49Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:17:48Z' class='post-time'>
              August 1, 2016, 12:17pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote quote-modified" data-post="7" data-topic="398294">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/moparisthebest/40/30_1.png" class="avatar"> Moparisthebest:</div>
<blockquote>
<p>Not for a SIGKILL, but nothing can handle that, it should work for a regular kill, abort message or similar.  I’ll see soon I guess.</p>
</blockquote>
</aside>
<p>yeah, but there are solutions that would work for a sigkill. for example, keeping a socket open between parent and child, polling, etc</p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-09T03:48:06Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:18:10Z' class='post-time'>
              August 1, 2016, 12:18pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“lawl_temp, post:8, topic:398294”][quote author=Moparisthebest link=topic=495430.msg3622602#msg3622602 date=1307563642]<br>
Not for a SIGKILL, but nothing can handle that, it should work for a regular kill, abort message or similar.  I’ll see soon I guess.<br>
[/quote]<br>
yeah, but there are solutions that would work for a sigkill. for example, keeping a socket open between parent and child, polling, etc[/quote]</p>
<p>I don’t really want to introduce sockets to this C code if I can avoid it, what do you mean about polling?</p>
<p>edit:<br>
I found a POSIX way of doing it, simply call ‘getppid’, which returns the pid of the parent process (in this case the JVM), if it ever returns anything different than what it returned for the first call to it, or 1, then the parent process has ended and I can exit gracefully.  Still can’t find a nice windows way of doing it, unless maybe I could use Ollie’s code, but I need a way to find the parent pid in windows in the first place, and I can’t find that out, every post says you either can’t do it or it is too unreliable.</p>
<p>In other news, the addShutdownHook works well except in the case of a SIGKILL or similar. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Mopman.html'><span itemprop='name'>Mopman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-09T05:57:57Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:18:20Z' class='post-time'>
              August 1, 2016, 12:18pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Incredibly doubtful you’ll be able to do this cross-platform.</p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-09T06:27:59Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:18:29Z' class='post-time'>
              August 1, 2016, 12:18pm
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The POSIX way should work cross-platform with the exception of windows.  Assuming Ollie’s windows code works, and assuming I can get the parent pid in windows, I can do the same there perhaps.</p>
<p>Anyway, the cleanest POSIX way to do it appears to be this:<br>
<span class="hashtag">#ifndef</span> _WIN32<br>
signal(SIGPIPE, signal_callback_handler);<br>
<span class="hashtag">#endif</span></p>
<p>Since the program gets a SIGPIPE signal when the JVM exits, so that is nice.  I’m debating whether to leave my parent process code in there or not.</p>
<p>Also, all of this is probably mute since I found a nice way of timing out the process if it hasn’t received a command for X seconds, still all of this might be useful elsewhere…</p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-09T06:47:19Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:18:29Z' class='post-time'>
              August 1, 2016, 12:18pm
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>So here is a ‘cross-platform’ way to do this, tested under linux, and not windows (I’d appreciate it if anyone could test it for me, though I probably still won’t use it)</p>
<p>I’m going to post it here in case I or someone else needs it again, because I’m taking it out of my program, the other two ways work fine:</p>
<pre><code class="lang-auto">int ppid = 0;

#ifdef _WIN32

// no idea if this is right
// http://stackoverflow.com/questions/185254/how-can-a-win32-process-get-the-pid-of-its-parent
ULONG_PTR getppid() // By Napalm @ NetCore2K
{
 ULONG_PTR pbi[6];
 ULONG ulSize = 0;
 LONG (WINAPI *NtQueryInformationProcess)(HANDLE ProcessHandle, ULONG ProcessInformationClass,
  PVOID ProcessInformation, ULONG ProcessInformationLength, PULONG ReturnLength);
 *(FARPROC *)&amp;NtQueryInformationProcess =
  GetProcAddress(LoadLibraryA("NTDLL.DLL"), "NtQueryInformationProcess");
 if(NtQueryInformationProcess){
  if(NtQueryInformationProcess(GetCurrentProcess(), 0,
    &amp;pbi, sizeof(pbi), &amp;ulSize) &gt;= 0 &amp;&amp; ulSize == sizeof(pbi))
     return pbi[5];
 }
 return (ULONG_PTR)-1;
}

bool parent_died(){
    HANDLE h = OpenProcess(SYNCHRONIZE, FALSE, ppid);
    DWORD ret = WaitForSingleObject(h, 0);
    CloseHandle(h);
    return ret != WAIT_TIMEOUT;
}

#else

bool parent_died(){return false;
	int cur_ppid = getppid();
	debug("current pid: %d, expected pid: %d\n", cur_ppid, ppid);
	return (cur_ppid != ppid || cur_ppid == 1);
}

#endif

int main(int argc, char* argv[])
{
	ppid = getppid();

	while(true){
		printf("doing stuff");
		if(parent_died())
			break;
	}
}
</code></pre>
<p>I wrote that in the code box, so things might not work quite right, you need to at least include some headers and probably add a sleep to the loop so as not to eat your CPU cycles.</p>
<p>Anyway, thanks for all the help, in the end signal handling is nice to have, but the only real platform-independent solution is for your child process to just timeout after no communication with the parent process after X amount of time.  Grr.</p>
      </div>

      <meta itemprop='headline' content='Cross-platform detect when another process ends C or C++?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/cross-platform-detect-when-another-process-ends-c-or-c/398294 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 16:21:57 GMT -->
</html>
