<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/sending-clans-to-mysql-db-562/457513 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 21:26:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Sending Clans to MySQL DB[562] - Runescape - moparisthebest.com</title>
    <meta name="description" content="Okay I&amp;#39;m trying to send the clans made on my server to my mysql db.  The clans are in an xml file and are outputted like this: [code=xml]       hansolo415            Nex       hansolo415       0       0       7          &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="457513.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Sending Clans to MySQL DB[562]&#39;" href="457513.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/sending-clans-to-mysql-db-562/457513" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/sending-clans-to-mysql-db-562/457513" />
<meta property="og:title" content="Sending Clans to MySQL DB[562]" />
<meta name="twitter:title" content="Sending Clans to MySQL DB[562]" />
<meta property="og:description" content="Okay I’m trying to send the clans made on my server to my mysql db.  The clans are in an xml file and are outputted like this:   &lt;entry&gt;     &lt;string&gt;hansolo415&lt;/string&gt;     &lt;com.rs2hd.content.clans.Clan&gt;       &lt;roomName&gt;Nex&lt;/roomName&gt;       &lt;roomOwner&gt;hansolo415&lt;/roomOwner&gt;       &lt;joinReq&gt;0&lt;/joinReq&gt;       &lt;talkReq&gt;0&lt;/talkReq&gt;       &lt;kickReq&gt;7&lt;/kickReq&gt;       &lt;ranks/&gt;     &lt;/com.rs2hd.content.clans.Clan&gt;   &lt;/entry&gt;   &lt;entry&gt;  Here is my clanmanager class: [code=java]public class ClanManager {  pr..." />
<meta name="twitter:description" content="Okay I’m trying to send the clans made on my server to my mysql db.  The clans are in an xml file and are outputted like this:   &lt;entry&gt;     &lt;string&gt;hansolo415&lt;/string&gt;     &lt;com.rs2hd.content.clans.Clan&gt;       &lt;roomName&gt;Nex&lt;/roomName&gt;       &lt;roomOwner&gt;hansolo415&lt;/roomOwner&gt;       &lt;joinReq&gt;0&lt;/joinReq&gt;       &lt;talkReq&gt;0&lt;/talkReq&gt;       &lt;kickReq&gt;7&lt;/kickReq&gt;       &lt;ranks/&gt;     &lt;/com.rs2hd.content.clans.Clan&gt;   &lt;/entry&gt;   &lt;entry&gt;  Here is my clanmanager class: [code=java]public class ClanManager {  pr..." />
<meta property="article:published_time" content="2012-08-31T21:33:08+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="457513.html">Sending Clans to MySQL DB[562]</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sageofmali.html'><span itemprop='name'>sageofmali</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-08-31T21:33:08Z'>
            <time itemprop='dateModified' datetime='2016-08-03T23:50:50Z' class='post-time'>
              August 3, 2016, 11:50pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Okay I’m trying to send the clans made on my server to my mysql db.  The clans are in an xml file and are outputted like this: <code>  &lt;entry&gt;
    &lt;string&gt;hansolo415&lt;/string&gt;
    &lt;com.rs2hd.content.clans.Clan&gt;
      &lt;roomName&gt;Nex&lt;/roomName&gt;
      &lt;roomOwner&gt;hansolo415&lt;/roomOwner&gt;
      &lt;joinReq&gt;0&lt;/joinReq&gt;
      &lt;talkReq&gt;0&lt;/talkReq&gt;
      &lt;kickReq&gt;7&lt;/kickReq&gt;
      &lt;ranks/&gt;
    &lt;/com.rs2hd.content.clans.Clan&gt;
  &lt;/entry&gt;
  &lt;entry&gt;</code><br>
Here is my clanmanager class: [code=java]public class ClanManager {</p>
<pre><code>private Map&lt;String, Clan&gt; clans;

@SuppressWarnings("unchecked")
public ClanManager() {
	Logger.getInstance().info("Loading clans....");
	try {
		clans = (HashMap&lt;String, Clan&gt;) XStreamUtil.getXStream().fromXML(new FileInputStream("data/clans.xml"));
	} catch (Exception e) {
		clans = new HashMap&lt;String, Clan&gt;();
	}
	for (Map.Entry&lt;String, Clan&gt; entries : clans.entrySet()) {
		final Clan clan = entries.getValue();
		clan.setTransient();
	}
	Logger.getInstance().info("Loaded " +clans.size()+ " SageScape clans.");
}

public Clan getClans(String s) {
	return clans.get(Misc.formatPlayerNameForProtocol(s));
}
public Map&lt;String, Clan&gt; getClans() {
	return clans;
}

public void createClan(Player p, String name) {
	if (name.equals("") || name.length() &lt; 0) {
		return;
	}		
	name = Misc.optimizeText(name);
	String user = Misc.formatPlayerNameForProtocol(p.getUsername());
	if (!clans.containsKey(user)) {
		Clan clan = new Clan(user, name);
		clans.put(Misc.formatPlayerNameForProtocol(p.getUsername()), clan);
		p.getActionSender().sendString(clan.getName(), 590, 32);
		refresh(clan);
	} else {
		Clan clan = clans.get(user);
		clan.setName(name);
		p.getActionSender().sendString(clan.getName(), 590, 32);
		refresh(clan);
	}
}

public void joinClan(final Player p, final String user) {
	p.getActionSender().sendMessage("Attempting to join channel...");
	final Clan clan = clans.get(Misc.formatPlayerNameForProtocol(user));
	if (clan == null) {
		World.getWorld().registerEvent(new Event(500) {
			@Override
			public void execute() {
				p.getActionSender().sendMessage("Then channel you tried to join does not exist.");
				this.stop();
			}
		});
		return;
	}
	World.getWorld().registerEvent(new Event(500) {
		@Override
		public void execute() {
			if(clan.canJoin(p)) {
				p.getSettings().setClanOwner(user);
				clan.addMember(p);
				refresh(clan);
				p.getActionSender().sendConfig(1083, clan.isLootsharing() ? 1 : 0);
				p.getActionSender().sendMessage("Now talking in the clan channel " +clan.getName());
				p.getActionSender().sendMessage("To talk, start each line of chat with the / symbol.");
			} else {
				p.getActionSender().sendMessage("You don't have a high enough rank to join this channel.");
			}
			this.stop();
		}
	});
}
public void destroy(Player player, String username) {
	Clan c = clans.get(Misc.formatPlayerNameForProtocol(username));
	if (c != null) {
		for (Player p : c.getMembers()) {
			if (p == null) { 
				continue;
			}
			ClanPacket.sendClanList(p, null);
		}
	}
	clans.remove(username);
}
public void refresh(Clan clan) {
	for (Player p : clan.getMembers()) {
		if (p == null) {
			continue;
		}
		ClanPacket.sendClanList(p, clan);
	}
}
public void leaveClan(Player player) {
	if(player.inWkiMini) {
		player.inWkiMini = false;
		player.teleport(WKInvasion.DEFAULT_LOC);
	}
	if (!player.getSettings().getClanOwner().equals("")) {
		String name = Misc.formatPlayerNameForProtocol(player.getSettings().getClanOwner());
		Clan c = clans.get(name);
		if(c != null) {
			if(c.getOwner().equals(player.getUsername())) {
				for(Player pl : c.getMembers()) {
					if(pl.inWkiMini) {
						pl.inWkiMini = false;
						pl.teleport(WKInvasion.DEFAULT_LOC);
					}
					if(player.wkiStartTimer &gt; 0 || pl.inWkiMini)
						pl.sm("The white knights minigame has been cancelled since the owner has left.");
				}
				player.wkiStartTimer = -1;
			}
			c.removeMember(player);
			refresh(c);
			ClanPacket.sendClanList(player, null);
		}
	}
	player.getActionSender().sendConfig(1083, 0);
}
public void rankMember(Player player, String user, int rank) {
	Clan c = clans.get(player.getUsername());
	if (c == null) {
		return;
	}
	c.rankUser(user, rank);
	refresh(c);
}
public String getClanName(String user) {
	Clan c = clans.get(user);
	if (c == null) {
		return "Chat disabled";
	} 
	return c.getName();
}
public void sendClanMessage(Player player, String text) {
	Clan c = clans.get(Misc.formatPlayerNameForProtocol(player.getSettings().getClanOwner()));
	if (c == null) {
		return;
	}
	for (Player pl : c.getMembers()) {
		if (pl.getIndex() == player.getIndex()) {
			continue;
		}
		ClanMessage.sendClanChatMessage(player, pl, c.getName(), c.getOwner(), text);
	}
	ClanMessage.sendClanChatMessage(player, null, c.getName(), c.getOwner(), text);
}

public void toggleLootshare(Player player) {
	Clan c = clans.get(player.getUsername());
	if(c != null) {
		c.toggleLootshare();
	} else {
		player.getActionSender().sendMessage("You don't have a clan to active lootshare with.");
	}
}
</code></pre>
<p>}[/code]<br>
I think I should add a method in my mysql db class and put it in the public ClanManager() method where it loads the clans, but I’m not entirely sure on how to get every owner’s name and roomname correctly.  I know I should use something like this for the sql: <code>   public static boolean sendClans(String owner, String name){
		try {
            Statement statement = con.createStatement();
            ResultSet group = statement.executeQuery("SELECT * FROM clans WHERE owner = '"+ owner +"'");
			if (!group.next())
				statement.execute("INSERT INTO `clans`(`owner`, `name`) VALUES('"+ owner +"', '"+ name +"')");
		} catch (Exception localException) {
			return false;
		}
		return true;
   }</code><br>
But how would I use sendClans(owner, name);  with the hashmap bullcrap?</p>
      </div>

      <meta itemprop='headline' content='Sending Clans to MySQL DB[562]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/sending-clans-to-mysql-db-562/457513 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 21:26:58 GMT -->
</html>
