<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>PI need help with shops</title>
    <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937</link>
    <description>When I buy an item I get 2 of thems instead of 1 :O</description>
    
    <lastBuildDate>Sun, 09 Mar 2014 13:12:31 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@loruviam loruviam]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/loruviam">@loruviam</a> wrote:</p>
          <blockquote>
              <p>[quote=“sk8rdude461, post:11, topic:540937”]Like I said in the code:</p>
<p><code>                /* I don't know what this is for, all the other shops are handled differently below... 
                                EDIT: This right here may be your issue, consider removing it.*/
                if (ItemLoader.isStackable(itemID) &amp;&amp; c.getItems().playerHasItem(Slot, TotPrice2*amount)) {
                        c.getItems().deleteItem2(Slot, TotPrice2*amount);
                        c.getItems().addItem(itemID, amount);
                        GameEngine.shopHandler.ShopItemsN[c.myShopId][fromSlot] -= amount;
                        GameEngine.shopHandler.ShopItemsDelay[c.myShopId][fromSlot] = 0;
                        c.getItems().resetItems(3823);
                        resetShop(c.myShopId);
                        updatePlayerShop();
                        return false;
                }</code><br>
This may be your issue, I don’t know why it is there since all your shops are handled underneath it.<br>
As for points, if you mean a variable like “c.dungPoints” or similar, you don’t have anything handling it.[/quote]</p>
<p>I have no idea <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=5" title=":confused:" class="emoji" alt=":confused:"> my points shops works perfectly, but the dungeoneering shops doesnt ;x when I click an item in shop it says this item cost 0 coins, and then when I try to buy it, it says that I don’t have not enough tokens. When I get the right amount of tokens, I buy it but it doesnt use the tokens</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/12</link>
        <pubDate>Sun, 09 Mar 2014 13:12:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-12</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>Like I said in the code:</p>
<p><code>                /* I don't know what this is for, all the other shops are handled differently below... 
                                EDIT: This right here may be your issue, consider removing it.*/
                if (ItemLoader.isStackable(itemID) &amp;&amp; c.getItems().playerHasItem(Slot, TotPrice2*amount)) {
                        c.getItems().deleteItem2(Slot, TotPrice2*amount);
                        c.getItems().addItem(itemID, amount);
                        GameEngine.shopHandler.ShopItemsN[c.myShopId][fromSlot] -= amount;
                        GameEngine.shopHandler.ShopItemsDelay[c.myShopId][fromSlot] = 0;
                        c.getItems().resetItems(3823);
                        resetShop(c.myShopId);
                        updatePlayerShop();
                        return false;
                }</code><br>
This may be your issue, I don’t know why it is there since all your shops are handled underneath it.<br>
As for points, if you mean a variable like “c.dungPoints” or similar, you don’t have anything handling it.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/11</link>
        <pubDate>Sun, 09 Mar 2014 10:37:07 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-11</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@loruviam loruviam]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/loruviam">@loruviam</a> wrote:</p>
          <blockquote>
              <p>[quote=“sk8rdude461, post:9, topic:540937”][quote author=loruviam link=topic=659803.msg4412502#msg4412502 date=1394341584]</p>
<aside class="quote">
<blockquote>
<p>Go ahead and try this (I cleaned it a bit). There should be no errors but I’m not 100% certain.</p>
<p>[code=java]	public boolean buyItem(int itemID, int fromSlot, int amount) {</p>
<pre><code>	if (ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] - 1 != itemID
			&amp;&amp; c.getVariables().myShopId != 14) {
		return false;
	}
	  
	if (c.getVariables().myShopId == 14) {
		skillBuy(itemID);
		return false;
	}
	  
	/* All those else ifs were converted to 1 if statement, since they all did the same thing. || is "OR" in Java. */
	if (c.getVariables().myShopId == 3 || c.getVariables().myShopId == 13 || c.getVariables().myShopId == 72
			|| c.getVariables().myShopId == 71 || c.getVariables().myShopId == 69 || c.getVariables().myShopId == 70
			|| c.getVariables().myShopId == 17 || c.getVariables().myShopId == 2 &amp;&amp; c.getVariables().myShopId == 4
			|| c.getVariables().myShopId == 82) {
		handleOtherShop(itemID);
		return false;
	}
		 
	if(!shopSellsItem(itemID))
		return false;

	if (amount &gt; ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot]) {
		amount = ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot];
	}
	
	int TotPrice2 = (int) Math.floor(getItemShopValue(itemID, 0, fromSlot));
	int Slot = c.getItems().getItemSlot(995);// Money
	int Slot1 = c.getItems().getItemSlot(6529);// Tokkul
	int Slot2 = c.getItems().getItemSlot(13650);// Dungeoneering points
	
	/* I don't know what this is for, all the other shops are handled differently below... 
			EDIT: This right here may be your issue, consider removing it.*/
	if (ItemLoader.isStackable(itemID) &amp;&amp; c.getItems().playerHasItem(Slot, TotPrice2*amount)) {
		c.getItems().deleteItem2(Slot, TotPrice2*amount);
		c.getItems().addItem(itemID, amount);
		GameEngine.shopHandler.ShopItemsN[c.myShopId][fromSlot] -= amount;
		GameEngine.shopHandler.ShopItemsDelay[c.myShopId][fromSlot] = 0;
		c.getItems().resetItems(3823);
		resetShop(c.myShopId);
		updatePlayerShop();
		return false;
	}
		
	/**
	 * Since the TotPrice2 is already declared above, there was no reason to re-state it here.
	 * Instead, I just left the multiplier.
	 **/
	if (TotPrice2 &lt;= 1) {
		TotPrice2 *= 1.66;
	}
	
	/* Check if they have enough coins */
	if ( (Slot == -1 || c.getVariables().playerItemsN[Slot] &lt; TotPrice2) &amp;&amp;
			(c.getVariables().myShopId != 29 &amp;&amp; c.getVariables().myShopId != 30 &amp;&amp;
				c.getVariables().myShopId != 31 &amp;&amp; c.getVariables().myShopId != 47) ) {
		c.sendMessage("You don't have enough coins.");
		return false;
	}
	
	/* Check if they have enough tokkul */
	if ( (Slot1 == -1 || c.getVariables().playerItemsN[Slot1] &lt; TotPrice2) &amp;&amp;
			(c.getVariables().myShopId == 29 || c.getVariables().myShopId == 30 ||
				c.getVariables().myShopId == 31) ) {
		c.sendMessage("You don't have enough tokkul.");
		return false;
	}
	
	/* Check if they have enough dungeoneering tokens */
	if ( (Slot2 == -1 || c.getVariables().playerItemsN[Slot2] &lt; TotPrice2) &amp;&amp; c.getVariables().myShopId == 80) {
		c.sendMessage("You don't have enough dungeoneering tokens.");
		return false;
	}
		
	/**
	 * I changed the ||'s (or's) to &amp;&amp;'s (and's) because you want to make sure that the shop is NONE of the id's
	 * I also removed the nested if statements, and made them their own.
	 * Lastly, I removed the for-loop, and made it give all the items in a single stack.
	 **/
	 
	/**
	 * Check if they have a free slot
	 * NOTE: You should change this to check if they have enough spaces based on the amount they are buying.
	 **/
	if (c.getItems().freeSlots() &gt; 0) {
		c.sendMessage("You don't have enough space in your inventory.");
		return false;
	}
	
	/* Regular coins */
	if (c.getVariables().myShopId != 29 &amp;&amp; c.getVariables().myShopId != 30 &amp;&amp; c.getVariables().myShopId != 31
	&amp;&amp; c.getVariables().myShopId != 47 &amp;&amp; c.getVariables().myShopId != 80) {
		c.getItems().deleteItem(Slot,
			c.getItems().getItemSlot(Slot), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
		
	/* Tokkul handling */
	if (c.getVariables().myShopId == 29 || c.getVariables().myShopId == 30 || c.getVariables().myShopId == 31) {
		c.getItems().deleteItem(Slot1,
			c.getItems().getItemSlot(Slot1), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
	
	/* I assume this is your dungeoneering shop.*/
	if (c.getVariables().myShopId == 80) {
		c.getItems().deleteItem(Slot2,
			c.getItems().getItemSlot(Slot2), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
		
	/* Since these were in all the if statements above, I just moved them down here*/
	ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot] -= amount;
	ShopHandler.ShopItemsDelay[c.getVariables().myShopId][fromSlot] = 0;
	
	if ((fromSlot + 1) &gt; ShopHandler.ShopItemsStandard[c.getVariables().myShopId]) {
		ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] = 0;
	}
		
	c.getItems().resetItems(3823);
	resetShop(c.getVariables().myShopId);
	updatePlayerShop();
	return true;
}[/code]
</code></pre>
</blockquote>
</aside>
<p>Thanks alot ! <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> but when I try to buy an item it says, not enough space in your inventory :s<br>
[/quote]<br>
Sorry bout that.<br>
Change:</p>
<p><code>
                /**
                 * Check if they have a free slot
                 * NOTE: You should change this to check if they have enough spaces based on the amount they are buying.
                 **/
                if (c.getItems().freeSlots() &gt; 0) {
                        c.sendMessage("You don't have enough space in your inventory.");
                        return false;
                }</code><br>
To:</p>
<p><code>
                /**
                 * Check if they have a free slot
                 * NOTE: You should change this to check if they have enough spaces based on the amount they are buying.
                 **/
                if (c.getItems().freeSlots() &lt; 1) {
                        c.sendMessage("You don't have enough space in your inventory.");
                        return false;
                }
</code>[/quote]</p>
<p>Awesome! thank you very much but when I buy from shops it doesnt use the coins :x  not sure about points didnt tested it yet</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/10</link>
        <pubDate>Sun, 09 Mar 2014 05:19:42 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-10</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>[quote=“loruviam, post:8, topic:540937”][quote author=sk8rdude461 link=topic=659803.msg4412489#msg4412489 date=1394337141]<br>
Go ahead and try this (I cleaned it a bit). There should be no errors but I’m not 100% certain.</p>
<p>[code=java]	public boolean buyItem(int itemID, int fromSlot, int amount) {</p>
<pre><code>	if (ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] - 1 != itemID
			&amp;&amp; c.getVariables().myShopId != 14) {
		return false;
	}
	  
	if (c.getVariables().myShopId == 14) {
		skillBuy(itemID);
		return false;
	}
	  
	/* All those else ifs were converted to 1 if statement, since they all did the same thing. || is "OR" in Java. */
	if (c.getVariables().myShopId == 3 || c.getVariables().myShopId == 13 || c.getVariables().myShopId == 72
			|| c.getVariables().myShopId == 71 || c.getVariables().myShopId == 69 || c.getVariables().myShopId == 70
			|| c.getVariables().myShopId == 17 || c.getVariables().myShopId == 2 &amp;&amp; c.getVariables().myShopId == 4
			|| c.getVariables().myShopId == 82) {
		handleOtherShop(itemID);
		return false;
	}
		 
	if(!shopSellsItem(itemID))
		return false;

	if (amount &gt; ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot]) {
		amount = ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot];
	}
	
	int TotPrice2 = (int) Math.floor(getItemShopValue(itemID, 0, fromSlot));
	int Slot = c.getItems().getItemSlot(995);// Money
	int Slot1 = c.getItems().getItemSlot(6529);// Tokkul
	int Slot2 = c.getItems().getItemSlot(13650);// Dungeoneering points
	
	/* I don't know what this is for, all the other shops are handled differently below... 
			EDIT: This right here may be your issue, consider removing it.*/
	if (ItemLoader.isStackable(itemID) &amp;&amp; c.getItems().playerHasItem(Slot, TotPrice2*amount)) {
		c.getItems().deleteItem2(Slot, TotPrice2*amount);
		c.getItems().addItem(itemID, amount);
		GameEngine.shopHandler.ShopItemsN[c.myShopId][fromSlot] -= amount;
		GameEngine.shopHandler.ShopItemsDelay[c.myShopId][fromSlot] = 0;
		c.getItems().resetItems(3823);
		resetShop(c.myShopId);
		updatePlayerShop();
		return false;
	}
		
	/**
	 * Since the TotPrice2 is already declared above, there was no reason to re-state it here.
	 * Instead, I just left the multiplier.
	 **/
	if (TotPrice2 &lt;= 1) {
		TotPrice2 *= 1.66;
	}
	
	/* Check if they have enough coins */
	if ( (Slot == -1 || c.getVariables().playerItemsN[Slot] &lt; TotPrice2) &amp;&amp;
			(c.getVariables().myShopId != 29 &amp;&amp; c.getVariables().myShopId != 30 &amp;&amp;
				c.getVariables().myShopId != 31 &amp;&amp; c.getVariables().myShopId != 47) ) {
		c.sendMessage("You don't have enough coins.");
		return false;
	}
	
	/* Check if they have enough tokkul */
	if ( (Slot1 == -1 || c.getVariables().playerItemsN[Slot1] &lt; TotPrice2) &amp;&amp;
			(c.getVariables().myShopId == 29 || c.getVariables().myShopId == 30 ||
				c.getVariables().myShopId == 31) ) {
		c.sendMessage("You don't have enough tokkul.");
		return false;
	}
	
	/* Check if they have enough dungeoneering tokens */
	if ( (Slot2 == -1 || c.getVariables().playerItemsN[Slot2] &lt; TotPrice2) &amp;&amp; c.getVariables().myShopId == 80) {
		c.sendMessage("You don't have enough dungeoneering tokens.");
		return false;
	}
		
	/**
	 * I changed the ||'s (or's) to &amp;&amp;'s (and's) because you want to make sure that the shop is NONE of the id's
	 * I also removed the nested if statements, and made them their own.
	 * Lastly, I removed the for-loop, and made it give all the items in a single stack.
	 **/
	 
	/**
	 * Check if they have a free slot
	 * NOTE: You should change this to check if they have enough spaces based on the amount they are buying.
	 **/
	if (c.getItems().freeSlots() &gt; 0) {
		c.sendMessage("You don't have enough space in your inventory.");
		return false;
	}
	
	/* Regular coins */
	if (c.getVariables().myShopId != 29 &amp;&amp; c.getVariables().myShopId != 30 &amp;&amp; c.getVariables().myShopId != 31
	&amp;&amp; c.getVariables().myShopId != 47 &amp;&amp; c.getVariables().myShopId != 80) {
		c.getItems().deleteItem(Slot,
			c.getItems().getItemSlot(Slot), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
		
	/* Tokkul handling */
	if (c.getVariables().myShopId == 29 || c.getVariables().myShopId == 30 || c.getVariables().myShopId == 31) {
		c.getItems().deleteItem(Slot1,
			c.getItems().getItemSlot(Slot1), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
	
	/* I assume this is your dungeoneering shop.*/
	if (c.getVariables().myShopId == 80) {
		c.getItems().deleteItem(Slot2,
			c.getItems().getItemSlot(Slot2), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
		
	/* Since these were in all the if statements above, I just moved them down here*/
	ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot] -= amount;
	ShopHandler.ShopItemsDelay[c.getVariables().myShopId][fromSlot] = 0;
	
	if ((fromSlot + 1) &gt; ShopHandler.ShopItemsStandard[c.getVariables().myShopId]) {
		ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] = 0;
	}
		
	c.getItems().resetItems(3823);
	resetShop(c.getVariables().myShopId);
	updatePlayerShop();
	return true;
}[/code]
</code></pre>
<p>[/quote]</p>
<p>Thanks alot ! <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> but when I try to buy an item it says, not enough space in your inventory :s[/quote]<br>
Sorry bout that.<br>
Change:</p>
<p><code>
                /**
                 * Check if they have a free slot
                 * NOTE: You should change this to check if they have enough spaces based on the amount they are buying.
                 **/
                if (c.getItems().freeSlots() &gt; 0) {
                        c.sendMessage("You don't have enough space in your inventory.");
                        return false;
                }</code><br>
To:</p>
<pre><code class="lang-auto">                /**
                 * Check if they have a free slot
                 * NOTE: You should change this to check if they have enough spaces based on the amount they are buying.
                 **/
                if (c.getItems().freeSlots() &lt; 1) {
                        c.sendMessage("You don't have enough space in your inventory.");
                        return false;
                }</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/9</link>
        <pubDate>Sun, 09 Mar 2014 05:12:07 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-9</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@loruviam loruviam]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/loruviam">@loruviam</a> wrote:</p>
          <blockquote>
              <p>[quote=“sk8rdude461, post:7, topic:540937”]Go ahead and try this (I cleaned it a bit). There should be no errors but I’m not 100% certain.</p>
<p>[code=java]	public boolean buyItem(int itemID, int fromSlot, int amount) {</p>
<pre><code>	if (ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] - 1 != itemID
			&amp;&amp; c.getVariables().myShopId != 14) {
		return false;
	}
	  
	if (c.getVariables().myShopId == 14) {
		skillBuy(itemID);
		return false;
	}
	  
	/* All those else ifs were converted to 1 if statement, since they all did the same thing. || is "OR" in Java. */
	if (c.getVariables().myShopId == 3 || c.getVariables().myShopId == 13 || c.getVariables().myShopId == 72
			|| c.getVariables().myShopId == 71 || c.getVariables().myShopId == 69 || c.getVariables().myShopId == 70
			|| c.getVariables().myShopId == 17 || c.getVariables().myShopId == 2 &amp;&amp; c.getVariables().myShopId == 4
			|| c.getVariables().myShopId == 82) {
		handleOtherShop(itemID);
		return false;
	}
		 
	if(!shopSellsItem(itemID))
		return false;

	if (amount &gt; ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot]) {
		amount = ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot];
	}
	
	int TotPrice2 = (int) Math.floor(getItemShopValue(itemID, 0, fromSlot));
	int Slot = c.getItems().getItemSlot(995);// Money
	int Slot1 = c.getItems().getItemSlot(6529);// Tokkul
	int Slot2 = c.getItems().getItemSlot(13650);// Dungeoneering points
	
	/* I don't know what this is for, all the other shops are handled differently below... 
			EDIT: This right here may be your issue, consider removing it.*/
	if (ItemLoader.isStackable(itemID) &amp;&amp; c.getItems().playerHasItem(Slot, TotPrice2*amount)) {
		c.getItems().deleteItem2(Slot, TotPrice2*amount);
		c.getItems().addItem(itemID, amount);
		GameEngine.shopHandler.ShopItemsN[c.myShopId][fromSlot] -= amount;
		GameEngine.shopHandler.ShopItemsDelay[c.myShopId][fromSlot] = 0;
		c.getItems().resetItems(3823);
		resetShop(c.myShopId);
		updatePlayerShop();
		return false;
	}
		
	/**
	 * Since the TotPrice2 is already declared above, there was no reason to re-state it here.
	 * Instead, I just left the multiplier.
	 **/
	if (TotPrice2 &lt;= 1) {
		TotPrice2 *= 1.66;
	}
	
	/* Check if they have enough coins */
	if ( (Slot == -1 || c.getVariables().playerItemsN[Slot] &lt; TotPrice2) &amp;&amp;
			(c.getVariables().myShopId != 29 &amp;&amp; c.getVariables().myShopId != 30 &amp;&amp;
				c.getVariables().myShopId != 31 &amp;&amp; c.getVariables().myShopId != 47) ) {
		c.sendMessage("You don't have enough coins.");
		return false;
	}
	
	/* Check if they have enough tokkul */
	if ( (Slot1 == -1 || c.getVariables().playerItemsN[Slot1] &lt; TotPrice2) &amp;&amp;
			(c.getVariables().myShopId == 29 || c.getVariables().myShopId == 30 ||
				c.getVariables().myShopId == 31) ) {
		c.sendMessage("You don't have enough tokkul.");
		return false;
	}
	
	/* Check if they have enough dungeoneering tokens */
	if ( (Slot2 == -1 || c.getVariables().playerItemsN[Slot2] &lt; TotPrice2) &amp;&amp; c.getVariables().myShopId == 80) {
		c.sendMessage("You don't have enough dungeoneering tokens.");
		return false;
	}
		
	/**
	 * I changed the ||'s (or's) to &amp;&amp;'s (and's) because you want to make sure that the shop is NONE of the id's
	 * I also removed the nested if statements, and made them their own.
	 * Lastly, I removed the for-loop, and made it give all the items in a single stack.
	 **/
	 
	/**
	 * Check if they have a free slot
	 * NOTE: You should change this to check if they have enough spaces based on the amount they are buying.
	 **/
	if (c.getItems().freeSlots() &gt; 0) {
		c.sendMessage("You don't have enough space in your inventory.");
		return false;
	}
	
	/* Regular coins */
	if (c.getVariables().myShopId != 29 &amp;&amp; c.getVariables().myShopId != 30 &amp;&amp; c.getVariables().myShopId != 31
	&amp;&amp; c.getVariables().myShopId != 47 &amp;&amp; c.getVariables().myShopId != 80) {
		c.getItems().deleteItem(Slot,
			c.getItems().getItemSlot(Slot), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
		
	/* Tokkul handling */
	if (c.getVariables().myShopId == 29 || c.getVariables().myShopId == 30 || c.getVariables().myShopId == 31) {
		c.getItems().deleteItem(Slot1,
			c.getItems().getItemSlot(Slot1), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
	
	/* I assume this is your dungeoneering shop.*/
	if (c.getVariables().myShopId == 80) {
		c.getItems().deleteItem(Slot2,
			c.getItems().getItemSlot(Slot2), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
		
	/* Since these were in all the if statements above, I just moved them down here*/
	ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot] -= amount;
	ShopHandler.ShopItemsDelay[c.getVariables().myShopId][fromSlot] = 0;
	
	if ((fromSlot + 1) &gt; ShopHandler.ShopItemsStandard[c.getVariables().myShopId]) {
		ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] = 0;
	}
		
	c.getItems().resetItems(3823);
	resetShop(c.getVariables().myShopId);
	updatePlayerShop();
	return true;
}[/code][/quote]
</code></pre>
<p>Thanks alot ! <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> but when I try to buy an item it says, not enough space in your inventory :s</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/8</link>
        <pubDate>Sun, 09 Mar 2014 05:06:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-8</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>Go ahead and try this (I cleaned it a bit). There should be no errors but I’m not 100% certain.</p>
<p>[code=java]	public boolean buyItem(int itemID, int fromSlot, int amount) {</p>
<pre><code>	if (ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] - 1 != itemID
			&amp;&amp; c.getVariables().myShopId != 14) {
		return false;
	}
	  
	if (c.getVariables().myShopId == 14) {
		skillBuy(itemID);
		return false;
	}
	  
	/* All those else ifs were converted to 1 if statement, since they all did the same thing. || is "OR" in Java. */
	if (c.getVariables().myShopId == 3 || c.getVariables().myShopId == 13 || c.getVariables().myShopId == 72
			|| c.getVariables().myShopId == 71 || c.getVariables().myShopId == 69 || c.getVariables().myShopId == 70
			|| c.getVariables().myShopId == 17 || c.getVariables().myShopId == 2 &amp;&amp; c.getVariables().myShopId == 4
			|| c.getVariables().myShopId == 82) {
		handleOtherShop(itemID);
		return false;
	}
		 
	if(!shopSellsItem(itemID))
		return false;

	if (amount &gt; ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot]) {
		amount = ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot];
	}
	
	int TotPrice2 = (int) Math.floor(getItemShopValue(itemID, 0, fromSlot));
	int Slot = c.getItems().getItemSlot(995);// Money
	int Slot1 = c.getItems().getItemSlot(6529);// Tokkul
	int Slot2 = c.getItems().getItemSlot(13650);// Dungeoneering points
	
	/* I don't know what this is for, all the other shops are handled differently below... 
			EDIT: This right here may be your issue, consider removing it.*/
	if (ItemLoader.isStackable(itemID) &amp;&amp; c.getItems().playerHasItem(Slot, TotPrice2*amount)) {
		c.getItems().deleteItem2(Slot, TotPrice2*amount);
		c.getItems().addItem(itemID, amount);
		GameEngine.shopHandler.ShopItemsN[c.myShopId][fromSlot] -= amount;
		GameEngine.shopHandler.ShopItemsDelay[c.myShopId][fromSlot] = 0;
		c.getItems().resetItems(3823);
		resetShop(c.myShopId);
		updatePlayerShop();
		return false;
	}
		
	/**
	 * Since the TotPrice2 is already declared above, there was no reason to re-state it here.
	 * Instead, I just left the multiplier.
	 **/
	if (TotPrice2 &lt;= 1) {
		TotPrice2 *= 1.66;
	}
	
	/* Check if they have enough coins */
	if ( (Slot == -1 || c.getVariables().playerItemsN[Slot] &lt; TotPrice2) &amp;&amp;
			(c.getVariables().myShopId != 29 &amp;&amp; c.getVariables().myShopId != 30 &amp;&amp;
				c.getVariables().myShopId != 31 &amp;&amp; c.getVariables().myShopId != 47) ) {
		c.sendMessage("You don't have enough coins.");
		return false;
	}
	
	/* Check if they have enough tokkul */
	if ( (Slot1 == -1 || c.getVariables().playerItemsN[Slot1] &lt; TotPrice2) &amp;&amp;
			(c.getVariables().myShopId == 29 || c.getVariables().myShopId == 30 ||
				c.getVariables().myShopId == 31) ) {
		c.sendMessage("You don't have enough tokkul.");
		return false;
	}
	
	/* Check if they have enough dungeoneering tokens */
	if ( (Slot2 == -1 || c.getVariables().playerItemsN[Slot2] &lt; TotPrice2) &amp;&amp; c.getVariables().myShopId == 80) {
		c.sendMessage("You don't have enough dungeoneering tokens.");
		return false;
	}
		
	/**
	 * I changed the ||'s (or's) to &amp;&amp;'s (and's) because you want to make sure that the shop is NONE of the id's
	 * I also removed the nested if statements, and made them their own.
	 * Lastly, I removed the for-loop, and made it give all the items in a single stack.
	 **/
	 
	/**
	 * Check if they have a free slot
	 * NOTE: You should change this to check if they have enough spaces based on the amount they are buying.
	 **/
	if (c.getItems().freeSlots() &gt; 0) {
		c.sendMessage("You don't have enough space in your inventory.");
		return false;
	}
	
	/* Regular coins */
	if (c.getVariables().myShopId != 29 &amp;&amp; c.getVariables().myShopId != 30 &amp;&amp; c.getVariables().myShopId != 31
	&amp;&amp; c.getVariables().myShopId != 47 &amp;&amp; c.getVariables().myShopId != 80) {
		c.getItems().deleteItem(Slot,
			c.getItems().getItemSlot(Slot), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
		
	/* Tokkul handling */
	if (c.getVariables().myShopId == 29 || c.getVariables().myShopId == 30 || c.getVariables().myShopId == 31) {
		c.getItems().deleteItem(Slot1,
			c.getItems().getItemSlot(Slot1), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
	
	/* I assume this is your dungeoneering shop.*/
	if (c.getVariables().myShopId == 80) {
		c.getItems().deleteItem(Slot2,
			c.getItems().getItemSlot(Slot2), TotPrice2);
		c.getItems().addItem(itemID, amount);
	}
		
	/* Since these were in all the if statements above, I just moved them down here*/
	ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot] -= amount;
	ShopHandler.ShopItemsDelay[c.getVariables().myShopId][fromSlot] = 0;
	
	if ((fromSlot + 1) &gt; ShopHandler.ShopItemsStandard[c.getVariables().myShopId]) {
		ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] = 0;
	}
		
	c.getItems().resetItems(3823);
	resetShop(c.getVariables().myShopId);
	updatePlayerShop();
	return true;
}[/code]</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/7</link>
        <pubDate>Sun, 09 Mar 2014 03:52:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-7</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@matzie matzie]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/matzie">@matzie</a> wrote:</p>
          <blockquote>
              <p>could you modify your last post and use the new [ code=java] tag instead of a quote please? makes it much simpler to read.(its under the bold option)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/6</link>
        <pubDate>Sun, 09 Mar 2014 02:39:12 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-6</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@loruviam loruviam]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/loruviam">@loruviam</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="4" data-topic="540937">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/sk8rdude461/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> sk8rdude461:</div>
<blockquote>
<p>Show us your buyItem method.</p>
</blockquote>
</aside>
<blockquote>public boolean buyItem(int itemID, int fromSlot, int amount) {
<pre><code>	if (ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] - 1 != itemID
			&amp;&amp; c.getVariables().myShopId != 14) {
		return false;
	}
	if (c.getVariables().myShopId == 14) {
		skillBuy(itemID);
		return false;
	} else if (c.getVariables().myShopId == 3) {
		handleOtherShop(itemID);
		return false;
	} else if (c.getVariables().myShopId == 13) {
		handleOtherShop(itemID);
		return false;	
	} else if (c.getVariables().myShopId == 72) {
		handleOtherShop(itemID);
		return false;	
	} else if (c.getVariables().myShopId == 71) {
		handleOtherShop(itemID);
		return false;
	} else if (c.getVariables().myShopId == 69) {
		handleOtherShop(itemID);
		return false;
	} else if (c.getVariables().myShopId == 70) {
		handleOtherShop(itemID);
		return false;
	} else if (c.getVariables().myShopId == 82) {
		handleOtherShop(itemID);
		return false;
	}
	if (amount &gt; 0) {
		int currency = (c.myShopId &gt;= 77 &amp;&amp; c.myShopId &lt;= 79) ? com.exile.game.players.content.skills.dungeoneering.Constants.CURRENCY : 995;
		if(!shopSellsItem(itemID))
			return false;
		if (amount &gt; ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot]) {
			amount = ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot];
		}
		// double ShopValue;
		// double TotPrice;
		int TotPrice2 = 0;
		// int Overstock;
		int Slot = 0;
		int Slot1 = 0;// Tokkul
		int Slot2 = 0;// Pking Points
		int Slot3 = 0;// dung Points
		if (c.getVariables().myShopId == 17 || c.getVariables().myShopId == 2 &amp;&amp; c.getVariables().myShopId == 4) {
			handleOtherShop(itemID);
			return false;
		}
		if (ItemLoader.isStackable(itemID) &amp;&amp; c.getItems().playerHasItem(currency, TotPrice2*amount)) {
			c.getItems().deleteItem2(currency, TotPrice2*amount);
			c.getItems().addItem(itemID, amount);
			GameEngine.shopHandler.ShopItemsN[c.myShopId][fromSlot] -= amount;
			GameEngine.shopHandler.ShopItemsDelay[c.myShopId][fromSlot] = 0;
			c.getItems().resetItems(3823);
			resetShop(c.myShopId);
			updatePlayerShop();
			return false;
		}
		for (int i = amount; i &gt; 0; i--) {
			TotPrice2 = (int) Math.floor(getItemShopValue(itemID, 0,
					fromSlot));
			Slot = c.getItems().getItemSlot(currency);
			Slot1 = c.getItems().getItemSlot(6529);
			if (Slot == -1 &amp;&amp; c.getVariables().myShopId != 29 &amp;&amp; c.getVariables().myShopId != 30
					&amp;&amp; c.getVariables().myShopId != 31 &amp;&amp; c.getVariables().myShopId != 47) {
				c.sendMessage("You don't have enough coins.");
				break;
			}
			if (Slot1 == -1 &amp;&amp; c.getVariables().myShopId == 29 || c.getVariables().myShopId == 30
					|| c.getVariables().myShopId == 31) {
				c.sendMessage("You don't have enough tokkul.");
				break;
			}
			if (Slot3 == -1 &amp;&amp; c.getVariables().myShopId == 80) {
				c.sendMessage("You don't have enough dungeoneering tokens.");
				break;
			}
			if (TotPrice2 &lt;= 1) {
				TotPrice2 = (int) Math.floor(getItemShopValue(itemID, 0,
						fromSlot));
				TotPrice2 *= 1.66;
			}
			if (c.getVariables().myShopId != 29 || c.getVariables().myShopId != 30 || c.getVariables().myShopId != 31
					|| c.getVariables().myShopId != 47) {
				if (c.getVariables().playerItemsN[Slot] &gt;= TotPrice2) {
					if (c.getItems().freeSlots() &gt; 0) {
						c.getItems().deleteItem(currency,
								c.getItems().getItemSlot(currency), TotPrice2);
						c.getItems().addItem(itemID, 1);
						ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot] -= 1;
						ShopHandler.ShopItemsDelay[c.getVariables().myShopId][fromSlot] = 0;
						if ((fromSlot + 1) &gt; ShopHandler.ShopItemsStandard[c.getVariables().myShopId]) {
							ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] = 0;
						}
					} else {
						c.sendMessage("You don't have enough space in your inventory.");
						break;
					}
				} else {
					c.sendMessage("You don't have enough coins.");
					break;
				}
			}
			if (c.getVariables().myShopId != 80) {
				if (c.getVariables().playerItemsN[Slot3] &gt;= TotPrice2) {
					if (c.getItems().freeSlots() &gt; 0) {
						c.getItems().deleteItem(13650,
								c.getItems().getItemSlot(13650), TotPrice2);
						c.getItems().addItem(itemID, 1);
						ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot] -= 1;
						ShopHandler.ShopItemsDelay[c.getVariables().myShopId][fromSlot] = 0;
						if ((fromSlot + 1) &gt; ShopHandler.ShopItemsStandard[c.getVariables().myShopId]) {
							ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] = 0;
						}
					} else {
						c.sendMessage("You don't have enough space in your inventory.");
						break;
					}
				} else {
					c.sendMessage("You don't have enough dungeoneering tokens.");
					break;
				}
			}
			if (c.getVariables().myShopId == 29 || c.getVariables().myShopId == 30 || c.getVariables().myShopId == 31) {
				if (c.getVariables().playerItemsN[Slot1] &gt;= TotPrice2) {
					if (c.getItems().freeSlots() &gt; 0) {
						c.getItems().deleteItem(6529,
								c.getItems().getItemSlot(6529), TotPrice2);
						c.getItems().addItem(itemID, 1);
						ShopHandler.ShopItemsN[c.getVariables().myShopId][fromSlot] -= 1;
						ShopHandler.ShopItemsDelay[c.getVariables().myShopId][fromSlot] = 0;
						if ((fromSlot + 1) &gt; ShopHandler.ShopItemsStandard[c.getVariables().myShopId]) {
							ShopHandler.ShopItems[c.getVariables().myShopId][fromSlot] = 0;
						}
					} else {
						c.sendMessage("You don't have enough space in your inventory.");
						break;
					}
				} else {
					c.sendMessage("You don't have enough tokkul.");
					break;
				}
			}
		}
		c.getItems().resetItems(3823);
		resetShop(c.getVariables().myShopId);
		updatePlayerShop();
		return true;
	}
	return false;
}&lt;/blockquote&gt;
</code></pre>
<p>Also my dungeoneering token shop doesnt work very well, it doesnt buy the item with token :x if someone know how to fix that it would be very nice, thank you in advance</p>
</blockquote>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/5</link>
        <pubDate>Sat, 08 Mar 2014 15:52:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-5</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>Show us your buyItem method.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/4</link>
        <pubDate>Sat, 08 Mar 2014 01:31:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-4</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@loruviam loruviam]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/loruviam">@loruviam</a> wrote:</p>
          <blockquote>
              <p>[quote=“Pure_, post:2, topic:540937”]Check how <a href="https://rswiki.moparisthebest.com/index.php?title=317:Bank_5_items" data-bbcode="true" rel="nofollow noopener">this</a> packet is parsed. Make sure it isn’t called twice for whatever reason and that it’s attempting to buy the right amount, e.g.</p>
<p>[code=java]void parse() {<br>
// …</p>
<p>player.buyItem(id, 2);<br>
}[/code][/quote]</p>
<p>Doesnt work? ):</p>
<blockquote>case 3900:
			c.getShops().buyItem(removeId, slot, 1);
			break;
<pre><code>		case 3823:
		c.getShops().sellItem(removeId, slot, 1);
		break;&lt;/blockquote&gt;</code></pre>
</blockquote>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/3</link>
        <pubDate>Sat, 08 Mar 2014 01:16:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-3</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@pure2ownage Pure_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pure2ownage">@pure2ownage</a> wrote:</p>
          <blockquote>
              <p>Check how <a href="https://rswiki.moparisthebest.com/index.php?title=317:Bank_5_items" data-bbcode="true" rel="nofollow noopener">this</a> packet is parsed. Make sure it isn’t called twice for whatever reason and that it’s attempting to buy the right amount, e.g.</p>
<p>[code=java]void parse() {<br>
// …</p>
<p>player.buyItem(id, 2);<br>
}[/code]</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/2</link>
        <pubDate>Thu, 06 Mar 2014 21:47:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-2</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
      <item>
        <title>PI need help with shops</title>
        <dc:creator><![CDATA[@loruviam loruviam]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/loruviam">@loruviam</a> wrote:</p>
          <blockquote>
              <p>When I buy an item I get 2 of thems instead of 1 <img src="https://forum.moparisthebest.com/images/emoji/twitter/open_mouth.png?v=5" title=":open_mouth:" class="emoji" alt=":open_mouth:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937/1</link>
        <pubDate>Thu, 06 Mar 2014 04:45:26 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-540937-1</guid>
        <source url="https://forum.moparisthebest.com/t/pi-need-help-with-shops/540937.rss">PI need help with shops</source>
      </item>
  </channel>
</rss>
