<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>New deob garbage: Bitwse not &quot;~&quot; spam</title>
    <link>https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854</link>
    <description>I&#39;ve been annoyed by Jagex&#39;s random obfuscation use of the &quot;~&quot; operator in their newest client code.
For example:
[code]if(i &gt; 5000)[/code]
may become
[code]if(~i &lt; -4999)[/code]
But it doesn&#39;t only affect constants, which is the problem I am experiencing in attempting to remove this garbage.

So far, I&#39;ve managed to remove a lot of the ~ obfuscation on constant values and 2 field non-complex comparations, with the BCEL patterns:
[code]StackProducer (ICONST|LDC2_W) ixor (ConstantPushInstruction|LDC) IfInstruction[/code]and
[code]PushInstruction (ICONST|LDC2_W) ixor (PushInstruction|GETFIELD) (ICONST|LDC2_W) ixor IfInstruction[/code]
And this fixed ~1.5k matches in a recent deob, leaving the client operating and easier to scan, but there are problem matches such as:
[code]tc.java:328:        if(~i2 != ~qd.Hb.cb)
tc.java:344:        qd.Hb.a(~arg0);
tc.java:379:        if(~fc.O.F &gt; ~byte0)
tc.java:410:        if(~fc.O.cb[0] != 0)[/code]
Because there can be mismatches between the var types, causing instructions that cast or compare across casts, more pops onto the stack, generally making life difficult when it comes trying to find and remove the obfuscation.

Has anyone achieved full success or tried other approaches? I have attempted expanding my patterns, and adding repeaters on the StackProducer instructions so they match more of the above, but they end up getting a lot of false positives, for some reason.</description>
    
    <lastBuildDate>Thu, 10 Aug 2006 04:15:27 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>New deob garbage: Bitwse not &quot;~&quot; spam</title>
        <dc:creator><![CDATA[@ruler ruler]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ruler">@ruler</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="5" data-topic="7854">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/nourlol/40/5_6259e4fa9dfe0dec282fb0955bb1974c.png" class="avatar"> NOURLOL:</div>
<blockquote>
<p>Was that a bump, or were you serious? <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
</blockquote>
</aside>
<p>a bump hehe<br>
in xerxes orignal post of “lol bot”  i mentioned “this is runescape not irc” about the ~ operator.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/7</link>
        <pubDate>Thu, 10 Aug 2006 04:15:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-7854-7</guid>
        <source url="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854.rss">New deob garbage: Bitwse not &quot;~&quot; spam</source>
      </item>
      <item>
        <title>New deob garbage: Bitwse not &quot;~&quot; spam</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <p>He was being serious.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/6</link>
        <pubDate>Thu, 10 Aug 2006 04:11:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-7854-6</guid>
        <source url="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854.rss">New deob garbage: Bitwse not &quot;~&quot; spam</source>
      </item>
      <item>
        <title>New deob garbage: Bitwse not &quot;~&quot; spam</title>
        <dc:creator><![CDATA[@NOURLOL NOURLOL]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nourlol">@NOURLOL</a> wrote:</p>
          <blockquote>
              <p>Was that a bump, or were you serious? <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/5</link>
        <pubDate>Thu, 10 Aug 2006 04:01:07 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-7854-5</guid>
        <source url="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854.rss">New deob garbage: Bitwse not &quot;~&quot; spam</source>
      </item>
      <item>
        <title>New deob garbage: Bitwse not &quot;~&quot; spam</title>
        <dc:creator><![CDATA[@ruler ruler]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ruler">@ruler</a> wrote:</p>
          <blockquote>
              <p>what about irc operators?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/4</link>
        <pubDate>Thu, 10 Aug 2006 03:58:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-7854-4</guid>
        <source url="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854.rss">New deob garbage: Bitwse not &quot;~&quot; spam</source>
      </item>
      <item>
        <title>New deob garbage: Bitwse not &quot;~&quot; spam</title>
        <dc:creator><![CDATA[@NOURLOL NOURLOL]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nourlol">@NOURLOL</a> wrote:</p>
          <blockquote>
              <p>Ugh, the problem isn’t in transforms, it’s in efficiency. If I write a transform for every individual pattern of ~ that occurs it’s going to be very slow.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/3</link>
        <pubDate>Tue, 08 Aug 2006 05:39:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-7854-3</guid>
        <source url="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854.rss">New deob garbage: Bitwse not &quot;~&quot; spam</source>
      </item>
      <item>
        <title>New deob garbage: Bitwse not &quot;~&quot; spam</title>
        <dc:creator><![CDATA[@Taios Taios]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/taios">@Taios</a> wrote:</p>
          <blockquote>
              <p>Ye, the obfuscation has been a problem in our bot also, so we have written a few transformers in BCEL and are still writing more. For example one of them searches for certain patterns like</p>
<p>(were in the middle of this one)<br>
if ((x ^ 0xffffffff) == -43)<br>
^^ Obviosuly thats not what it looks like in Bytecode this is if you were to deob, so after the transform it comes out like,<br>
if (x == 42)</p>
<p>were just writing various transformers so that searching through for patterns is alot easier and they dont change. We havnt tried removing the “~” crap yet but that will probaly be one of the next transformers we do so ill let you know if we incur any problems.</p>
<p>Hopefully not.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/2</link>
        <pubDate>Mon, 07 Aug 2006 16:26:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-7854-2</guid>
        <source url="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854.rss">New deob garbage: Bitwse not &quot;~&quot; spam</source>
      </item>
      <item>
        <title>New deob garbage: Bitwse not &quot;~&quot; spam</title>
        <dc:creator><![CDATA[@NOURLOL NOURLOL]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nourlol">@NOURLOL</a> wrote:</p>
          <blockquote>
              <p>I’ve been annoyed by Jagex’s random obfuscation use of the “~” operator in their newest client code.<br>
For example:</p>
<pre><code class="lang-auto">if(i &gt; 5000)</code></pre>
<p>may become</p>
<pre><code class="lang-auto">if(~i &lt; -4999)</code></pre>
<p>But it doesn’t only affect constants, which is the problem I am experiencing in attempting to remove this garbage.</p>
<p>So far, I’ve managed to remove a lot of the ~ obfuscation on constant values and 2 field non-complex comparations, with the BCEL patterns:</p>
<p><code>StackProducer (ICONST|LDC2_W) ixor (ConstantPushInstruction|LDC) IfInstruction</code>and</p>
<pre><code class="lang-auto">PushInstruction (ICONST|LDC2_W) ixor (PushInstruction|GETFIELD) (ICONST|LDC2_W) ixor IfInstruction</code></pre>
<p>And this fixed ~1.5k matches in a recent deob, leaving the client operating and easier to scan, but there are problem matches such as:</p>
<p><code>tc.java:328:        if(~i2 != ~qd.Hb.cb)
tc.java:344:        qd.Hb.a(~arg0);
tc.java:379:        if(~fc.O.F &gt; ~byte0)
tc.java:410:        if(~fc.O.cb[0] != 0)</code><br>
Because there can be mismatches between the var types, causing instructions that cast or compare across casts, more pops onto the stack, generally making life difficult when it comes trying to find and remove the obfuscation.</p>
<p>Has anyone achieved full success or tried other approaches? I have attempted expanding my patterns, and adding repeaters on the StackProducer instructions so they match more of the above, but they end up getting a lot of false positives, for some reason.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854/1</link>
        <pubDate>Fri, 04 Aug 2006 10:32:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-7854-1</guid>
        <source url="https://forum.moparisthebest.com/t/new-deob-garbage-bitwse-not-spam/7854.rss">New deob garbage: Bitwse not &quot;~&quot; spam</source>
      </item>
  </channel>
</rss>
