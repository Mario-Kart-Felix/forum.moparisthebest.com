<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[Clojure] mp3sorter</title>
    <link>https://forum.moparisthebest.com/t/clojure-mp3sorter/434838</link>
    <description>The earlier mp3sorters were written ages ago but since T4 never released a Clojure version, here&#39;s the one I wrote :P

[code=clojure](ns org.echo.mp3sorter
  (:require [clojure.java.io :as io]))
 
(defn- read-buffer [buffer start finish]
  (loop [s start r (str)]
    (if (= s finish)
      (.trim r)
      (recur (inc s) (str r (char (aget buffer s)))))))
       
(defn- mp3path [output title artist album year]
  (str output &quot;/&quot; artist &quot;/&quot; year &quot; - &quot; album &quot;/&quot; title &quot;.mp3&quot;))
       
(defn- get-mp3path [f output]
  (let [ba (byte-array 128)]
    (with-open [is (io/input-stream f)]
      (doto is
        (.skip (- (.length f) (alength ba)))
        (.read ba 0 (alength ba))))
    (mp3path output (read-buffer ba 3 30) (read-buffer ba 33 63) (read-buffer ba 63 93) (read-buffer ba 93 97))))
       
(defn- sort-mp3s [input output]
  (doseq [f (file-seq (io/file input)) :when (and (.isFile f) (.. f getName (endsWith &quot;.mp3&quot;)))]
    (let [info (get-mp3path f output)
          dest (io/file (.toString info))]             
      (io/make-parents dest)
      (io/copy f dest)
      (println info))))
		
(defn -main [&amp; args]
  (if (not= (count args) 2)
    (println &quot;Usage: main &lt;in&gt; &lt;out&gt;&quot;)
    (sort-mp3s (first args) (second args))))
       
(-main &quot;orig&quot; &quot;sorted&quot;)[/code]

P.S. Clojure code tags would be awesome</description>
    
    <lastBuildDate>Thu, 12 Apr 2012 10:50:34 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[Clojure] mp3sorter</title>
        <dc:creator><![CDATA[@SpeedIsMeh SpeedIsMeh]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/speedismeh">@SpeedIsMeh</a> wrote:</p>
          <blockquote>
              <p>You mean since Speed didn’t release a clojure one ;);)<img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/clojure-mp3sorter/434838/5</link>
        <pubDate>Thu, 12 Apr 2012 10:50:34 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-434838-5</guid>
        <source url="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838.rss">[Clojure] mp3sorter</source>
      </item>
      <item>
        <title>[Clojure] mp3sorter</title>
        <dc:creator><![CDATA[@Echo3 Echo_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/echo3">@Echo3</a> wrote:</p>
          <blockquote>
              <p>[quote="_s, post:3, topic:434838"][quote author=t4 link=topic=537556.msg3930837#msg3930837 date=1330654115]<br>
i never got around to learning common lisp so…<br>
[/quote]i think you’ll find that common lisp and clojure are different <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>Echo_:</p>
<p><code>(defn guess-what []
  (println "clojure tags!"))</code>[/quote]</p>
<p>OMG HAX</p>
<p>Gotta agree with _s though, features such as CLOS really set Common Lisp and Clojure apart</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/clojure-mp3sorter/434838/4</link>
        <pubDate>Sat, 03 Mar 2012 23:28:58 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-434838-4</guid>
        <source url="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838.rss">[Clojure] mp3sorter</source>
      </item>
      <item>
        <title>[Clojure] mp3sorter</title>
        <dc:creator><![CDATA[@_s11 s1gma]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/_s11">@_s11</a> wrote:</p>
          <blockquote>
              <p>[quote=“t4, post:2, topic:434838”]i never got around to learning common lisp so…[/quote]i think you’ll find that common lisp and clojure are different <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>Echo_:</p>
<p><code>(defn guess-what []
  (println "clojure tags!"))</code></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/clojure-mp3sorter/434838/3</link>
        <pubDate>Fri, 02 Mar 2012 21:38:01 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-434838-3</guid>
        <source url="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838.rss">[Clojure] mp3sorter</source>
      </item>
      <item>
        <title>[Clojure] mp3sorter</title>
        <dc:creator><![CDATA[@T41 t4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/t41">@T41</a> wrote:</p>
          <blockquote>
              <p>i never got around to learning common lisp so…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/clojure-mp3sorter/434838/2</link>
        <pubDate>Fri, 02 Mar 2012 02:08:35 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-434838-2</guid>
        <source url="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838.rss">[Clojure] mp3sorter</source>
      </item>
      <item>
        <title>[Clojure] mp3sorter</title>
        <dc:creator><![CDATA[@Echo3 Echo_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/echo3">@Echo3</a> wrote:</p>
          <blockquote>
              <p>The earlier mp3sorters were written ages ago but since T4 never released a Clojure version, here’s the one I wrote <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>[code=clojure](ns org.echo.mp3sorter<br>
(:require [<a href="http://clojure.java.io" rel="nofollow noopener">clojure.java.io</a> :as io]))</p>
<p>(defn- read-buffer [buffer start finish]<br>
(loop [s start r (str)]<br>
(if (= s finish)<br>
(.trim r)<br>
(recur (inc s) (str r (char (aget buffer s)))))))</p>
<p>(defn- mp3path [output title artist album year]<br>
(str output “/” artist “/” year " - " album “/” title “.mp3”))</p>
<p>(defn- get-mp3path [f output]<br>
(let [ba (byte-array 128)]<br>
(with-open [is (io/input-stream f)]<br>
(doto is<br>
(.skip (- (.length f) (alength ba)))<br>
(.read ba 0 (alength ba))))<br>
(mp3path output (read-buffer ba 3 30) (read-buffer ba 33 63) (read-buffer ba 63 93) (read-buffer ba 93 97))))</p>
<p>(defn- sort-mp3s [input output]<br>
(doseq [f (file-seq (io/file input)) :when (and (.isFile f) (… f getName (endsWith “.mp3”)))]<br>
(let [info (get-mp3path f output)<br>
dest (io/file (.toString info))]<br>
(io/make-parents dest)<br>
(io/copy f dest)<br>
(println info))))</p>
<p>(defn -main [&amp; args]<br>
(if (not= (count args) 2)<br>
(println "Usage: main  ")<br>
(sort-mp3s (first args) (second args))))</p>
<p>(-main “orig” “sorted”)[/code]</p>
<p>P.S. Clojure code tags would be awesome</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/clojure-mp3sorter/434838/1</link>
        <pubDate>Fri, 02 Mar 2012 01:45:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-434838-1</guid>
        <source url="https://forum.moparisthebest.com/t/clojure-mp3sorter/434838.rss">[Clojure] mp3sorter</source>
      </item>
  </channel>
</rss>
