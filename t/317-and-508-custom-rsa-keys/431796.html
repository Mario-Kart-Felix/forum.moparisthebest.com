<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/317-and-508-custom-rsa-keys/431796 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>317 and 508 custom RSA keys - Community Inside Talk - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;m implementing custom RSA key support in MoparScape 4, and for RSC it was pretty self explanatory, for 317 I never see an actual &amp;#39;Key&amp;#39; object being made, so I don&amp;#39;t know where exactly to do this. 

I know that to disab&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="431796.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;317 and 508 custom RSA keys&#39;" href="431796.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/317-and-508-custom-rsa-keys/431796" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/317-and-508-custom-rsa-keys/431796" />
<meta property="og:title" content="317 and 508 custom RSA keys" />
<meta name="twitter:title" content="317 and 508 custom RSA keys" />
<meta property="og:description" content="I’m implementing custom RSA key support in MoparScape 4, and for RSC it was pretty self explanatory, for 317 I never see an actual ‘Key’ object being made, so I don’t know where exactly to do this.  I know that to disable rsa, this comment was needed (this is how 317 currently runs):  in Stream.java      public void doKeys() {         int i = currentOffset;         currentOffset = 0;         byte abyte0[] = new byte[i];         readBytes(i, 0, abyte0);         BigInteger biginteger2 = new BigInt..." />
<meta name="twitter:description" content="I’m implementing custom RSA key support in MoparScape 4, and for RSC it was pretty self explanatory, for 317 I never see an actual ‘Key’ object being made, so I don’t know where exactly to do this.  I know that to disable rsa, this comment was needed (this is how 317 currently runs):  in Stream.java      public void doKeys() {         int i = currentOffset;         currentOffset = 0;         byte abyte0[] = new byte[i];         readBytes(i, 0, abyte0);         BigInteger biginteger2 = new BigInt..." />
<meta property="article:published_time" content="2012-02-04T22:22:25+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="431796.html">317 and 508 custom RSA keys</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/community-inside-talk.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Community Inside Talk</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-04T22:22:25Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:45:30Z' class='post-time'>
              August 2, 2016,  3:45pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’m implementing custom RSA key support in MoparScape 4, and for RSC it was pretty self explanatory, for 317 I never see an actual ‘Key’ object being made, so I don’t know where exactly to do this.</p>
<p>I know that to disable rsa, this comment was needed (this is how 317 currently runs):<br>
in Stream.java</p>
<pre><code class="lang-auto">    public void doKeys() {
        int i = currentOffset;
        currentOffset = 0;
        byte abyte0[] = new byte[i];
        readBytes(i, 0, abyte0);
        BigInteger biginteger2 = new BigInteger(abyte0);
        BigInteger biginteger3 = biginteger2/*.modPow(biginteger, biginteger1)*/;
        byte abyte1[] = biginteger3.toByteArray();
        currentOffset = 0;
        writeWordBigEndian(abyte1.length);
        writeBytes(abyte1, abyte1.length, 0);
    }</code></pre>
<p>Similar code exists in 508 Stream.java:</p>
<pre><code class="lang-auto">    public void doKeys(boolean bool, BigInteger biginteger, BigInteger biginteger_19_) {
        try {
            anInt2995++;
            int i = currentOffset;
            byte[] is = new byte[i];
            currentOffset = 0;
            method938(0, 0, i, is);
            BigInteger biginteger_20_ = new BigInteger(is);
            if (bool != false) {
                aClass68_Sub17_2994 = null;
            }
            BigInteger biginteger_21_ = biginteger_20_; //.modPow(biginteger, biginteger_19_);
            byte[] is_22_ = biginteger_21_.toByteArray();
            currentOffset = 0;
            writeByte(is_22_.length);
            writeBytes(is_22_.length, 0, is_22_);
        } catch (RuntimeException runtimeexception) {
            throw Class107.method1652(runtimeexception,
                    ("lh.UA(" + bool + ',' + (biginteger != null ? "{...}"
                            : "null") + ',' + (biginteger_19_ != null ? "{...}"
                            : "null") + ')'));
        }
    }</code></pre>
<p>Say I have an RSA key byte array, the kind I would send into X509EncodedKeySpec() to create a public key, how do I translate that to the above?</p>
<p>Thanks for any help or pointers you can give.</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-04T23:11:55Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:45:32Z' class='post-time'>
              August 2, 2016,  3:45pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’ve been unable to properly implement the key using the available classes in Java. But basically the method is this</p>
<pre><code class="lang-auto">BigInteger message = new BigInteger(data);
BigInteger encodedData = message.modPow(publicKey, modulus);</code></pre>
<p>Source: <a href="http://introcs.cs.princeton.edu/java/78crypto/RSA.java.html">http://introcs.cs.princeton.edu/java/78crypto/RSA.java.html</a></p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-04T23:32:27Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:45:34Z' class='post-time'>
              August 2, 2016,  3:45pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <pre><code class="lang-auto">        BigInteger biginteger2 = new BigInteger(abyte0);
        BigInteger biginteger3 = biginteger2/*.modPow(biginteger, biginteger1)*/;</code></pre>
<p>ta da! (the correct instructions are commented out)</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/silabsoft.html'><span itemprop='name'>silabsoft</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-05T00:47:48Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:45:39Z' class='post-time'>
              August 2, 2016,  3:45pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“t4, post:5, topic:431796”]<code>
        BigInteger biginteger2 = new BigInteger(abyte0);
        BigInteger biginteger3 = biginteger2/*.modPow(biginteger, biginteger1)*/;
</code><br>
ta da! (the correct instructions are commented out)[/quote]<br>
yeah thats all you need to do is uncomment the code and generate your public and private keys.</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-05T06:41:46Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:46:09Z' class='post-time'>
              August 2, 2016,  3:46pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I generated the keys with something similar to this:</p>
<pre><code class="lang-auto">import java.security.KeyPair;
import java.security.KeyPairGenerator;

/**
 * Created by IntelliJ IDEA.
 * User: dloth
 * Date: 31/01/12
 * Time: 11:21 AM
 * To change this template use File | Settings | File Templates.
 */
public class KeyGenerator {
   
    public static void main(String[] args) throws Exception {
        KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");

        // Generate a key that is 2048 bits long
        RSAKeyGenParameterSpec spec = new RSAKeyGenParameterSpec(2048, RSAKeyGenParameterSpec.F4);
        keyGen.initialize(spec);
        KeyPair pair = keyGen.generateKeyPair();
        System.out.printf("Private key: %s\n\n", pair.getPrivate());
        System.out.printf("Public key: %s\n\n", pair.getPublic());
    }
}</code></pre>
<p>And kept the byte array that key.getEncoded() returned.  I knew the commented part did the actual encryption, but I wasn’t sure how to get from the byte array to what that particular bit of code needed.</p>
<p>[quote=“zyle1992, post:3, topic:431796”]I’ve been unable to properly implement the key using the available classes in Java. But basically the method is this</p>
<pre><code class="lang-auto">BigInteger message = new BigInteger(data);
BigInteger encodedData = message.modPow(publicKey, modulus);</code></pre>
<p>Source: <a href="http://introcs.cs.princeton.edu/java/78crypto/RSA.java.html%5B/quote%5D">http://introcs.cs.princeton.edu/java/78crypto/RSA.java.html[/quote]</a></p>
<p>If that is correct, then all I need to do to get the publicKey and modulus BigInteger’s would be something like this:</p>
<pre><code class="lang-auto">KeyFactory keyFactory = KeyFactory.getInstance("RSA");
RSAPublicKey pubKey = keyFactory.generatePublic(new X509EncodedKeySpec(myByteArray));
BigInteger publicKey = pubKey.getPublicExponent();
BigInteger modulus = pubKey.getModulus();</code></pre>
<p>and that is it?  If so, thanks, easy enough. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/silabsoft.html'><span itemprop='name'>silabsoft</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-05T10:23:29Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:46:37Z' class='post-time'>
              August 2, 2016,  3:46pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Moparisthebest, post:7, topic:431796”]I generated the keys with something similar to this:</p>
<pre><code class="lang-auto">import java.security.KeyPair;
import java.security.KeyPairGenerator;

/**
 * Created by IntelliJ IDEA.
 * User: dloth
 * Date: 31/01/12
 * Time: 11:21 AM
 * To change this template use File | Settings | File Templates.
 */
public class KeyGenerator {
   
    public static void main(String[] args) throws Exception {
        KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");

        // Generate a key that is 2048 bits long
        RSAKeyGenParameterSpec spec = new RSAKeyGenParameterSpec(2048, RSAKeyGenParameterSpec.F4);
        keyGen.initialize(spec);
        KeyPair pair = keyGen.generateKeyPair();
        System.out.printf("Private key: %s\n\n", pair.getPrivate());
        System.out.printf("Public key: %s\n\n", pair.getPublic());
    }
}</code></pre>
<p>And kept the byte array that key.getEncoded() returned.  I knew the commented part did the actual encryption, but I wasn’t sure how to get from the byte array to what that particular bit of code needed.</p>
<aside class="quote">
<blockquote>
<p>I’ve been unable to properly implement the key using the available classes in Java. But basically the method is this</p>
<pre><code class="lang-auto">BigInteger message = new BigInteger(data);
BigInteger encodedData = message.modPow(publicKey, modulus);</code></pre>
<p>Source: <a href="http://introcs.cs.princeton.edu/java/78crypto/RSA.java.html" rel="nofollow noopener">http://introcs.cs.princeton.edu/java/78crypto/RSA.java.html</a></p>
</blockquote>
</aside>
<p>If that is correct, then all I need to do to get the publicKey and modulus BigInteger’s would be something like this:</p>
<pre><code class="lang-auto">KeyFactory keyFactory = KeyFactory.getInstance("RSA");
RSAPublicKey pubKey = keyFactory.generatePublic(new X509EncodedKeySpec(myByteArray));
BigInteger publicKey = pubKey.getPublicExponent();
BigInteger modulus = pubKey.getModulus();</code></pre>
<p>and that is it?  If so, thanks, easy enough. :)[/quote]</p>
<p>the public keys are static biginteger variables in the client, why do you need to go from a bytearray? :s</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-05T15:30:03Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:46:45Z' class='post-time'>
              August 2, 2016,  3:46pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>To allow people to specify their own public keys, I’m currently planning to accept either base64 url-friendly encoding of the key pasted directly into the program, or a file with a base64 encoding of the key with any supported download method (either http(s) or bittorrent)</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-26T18:30:15Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:10:35Z' class='post-time'>
              August 2, 2016,  4:10pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>317 doesn’t store any “key” object, it simply stores the public exponent and modulus as BigInteger instances.<br>
You use BigInteger.modPow(exp, mod) to both encode and decode the block.</p>
<p>If you want to use the abstracted Java API version for it, this may help you:<br>
<a href="https://github.com/vexsoftware/votifier/blob/master/java/com/vexsoftware/votifier/crypto/RSAIO.java" class="onebox" target="_blank">https://github.com/vexsoftware/votifier/blob/master/java/com/vexsoftware/votifier/crypto/RSAIO.java</a><br>
<a href="https://github.com/vexsoftware/votifier/blob/master/java/com/vexsoftware/votifier/crypto/RSA.java" class="onebox" target="_blank">https://github.com/vexsoftware/votifier/blob/master/java/com/vexsoftware/votifier/crypto/RSA.java</a></p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-27T04:20:24Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:11:51Z' class='post-time'>
              August 2, 2016,  4:11pm
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’ve already implemented this into the current version of MoparScape 4, you can check it out now. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-27T06:31:30Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:11:55Z' class='post-time'>
              August 2, 2016,  4:11pm
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote quote-modified" data-post="11" data-topic="431796">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/moparisthebest/40/30_1.png" class="avatar"> Moparisthebest:</div>
<blockquote>
<p>I’ve already implemented this into the current version of MoparScape 4, you can check it out now. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</blockquote>
</aside>
<p>you should really put your mscp v* on git or something</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-28T06:11:37Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:13:04Z' class='post-time'>
              August 2, 2016,  4:13pm
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“t4, post:12, topic:431796”][quote author=Moparisthebest link=topic=534500.msg3927062#msg3927062 date=1330316424]<br>
I’ve already implemented this into the current version of MoparScape 4, you can check it out now. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
[/quote]<br>
you should really put your mscp v* on git or something[/quote]</p>
<p>I share all of the interesting code in MoparscapeSources.jar, but I’ve been meaning to change the distribution to something better like git, I just have to write all new automation code to push it out there for me, so I’m not as motivated to change it. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>What does ‘v*’ mean though? <img src="../../images/emoji/twitter/confusedae52.png?v=5" title=":confused:" class="emoji" alt=":confused:"></p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/davidi2.html'><span itemprop='name'>davidi2</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-28T06:14:58Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:13:04Z' class='post-time'>
              August 2, 2016,  4:13pm
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>version#</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-28T14:38:17Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:13:13Z' class='post-time'>
              August 2, 2016,  4:13pm
            </time>
        <span itemprop='position'>#15</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i remember along time ago there was a moparscape client that wasn’t loaded into a custom UI, i think it was moparscape 2 or something? what were the differences between that and 3? what was moparscape 1?</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-28T16:00:09Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:13:17Z' class='post-time'>
              August 2, 2016,  4:13pm
            </time>
        <span itemprop='position'>#16</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Oh, gotcha.</p>
<p>Let me see if I remember.  MoparScape ‘1’ was just called MoparScape, and it was a cheat client for regular runescape, before private servers existed.  It had things that gave PVPers an advantage, like HP over heads, and color-coding of people (by level) on the mini-map in the wilderness so you knew who you could beat and who could beat you before you got close enough to see them the legit way.  It also had things for SCAR scripters, such as locking the map true north (or any other way), and colors that didn’t change like the normal client.  It also had some strings changed (hold onto your butts…), and disabled the chat censor which people liked.  I wrote a truly awful automatic updater for it, that used waffendennis’s deobs, read the .java files I was interested in into a giant String[] line-by-line and proceeded to edit the source code based on a lot of .substring()'s and .indexOf()'s (no regular expressions!), then recompiled it so I could upload it to <a href="http://kaitneiks.com/">kaitneiks.com</a>. I probably still have that stuff someplace, no idea where though.</p>
<p>MoparScape 2 was the same thing I believe, except a private server client for 317.</p>
<p>MoparScape 3 had all the above features, as well as Aryan (the bot) built into it.</p>
<p>MoparScape 4 is just a fancy loader with a bunch of features, so anyone can write any client for it.  Because it seems people insist on creating their own client now to add an item or two.</p>
<p>That’s what I remember so far, if I track down my updater I’ll post it and many laughs will be had.  I think it was the first thing I wrote in Java outside of my entry-level Java class, my only other experience programming at the time was writing and/or modifying other’s SCAR scripts. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>edit:<br>
I forgot about ‘MoparScape Revolution’, which was basically an improved version of MoparScape (1).  I just found the source code, I’m not sure if it was the latest, but you’ll get an idea of how bad it was anyhow.  Hell, I used windows at the time. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>From scanning over the updater, the features at the time were:</p>
<ol>
<li>World Switcher</li>
<li>Maplock</li>
<li>Zoom in/out and camera movement (move camera away from player)</li>
<li>HP over heads</li>
<li>Removed logo, changed strings</li>
<li>mapdots, the PVP color-coding I mentioned earlier.</li>
</ol>
<p>here is the original .rar archive I found dated April, 2006:<br>
<a href="http://uppit.com/ini5jxjbwqzc/moparsfullupdate.rar" class="onebox" target="_blank">http://uppit.com/ini5jxjbwqzc/moparsfullupdate.rar</a></p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-28T16:09:30Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:13:17Z' class='post-time'>
              August 2, 2016,  4:13pm
            </time>
        <span itemprop='position'>#17</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Haha, this was my ‘improved’ version of the updater, it was actually much cleaner than the original, if you can believe it.  It almost makes me want to puke looking at this:</p>
<pre><code class="lang-auto">import java.io.*;
import java.util.regex.*;

public class ClientUpdater
{

	public static String fileprefix = "output/";
	public static String[] clientline = new String[20000];
	
	private static String getRegexString(String regex,String searchstring){
		String[] result = searchstring.split(regex);
		if(result.length==2)
   	  return (searchstring.substring(result[0].length(),searchstring.length()-result[1].length()));
   	else
     return (searchstring.substring(result[0].length()));
 	}

	 	private static void renamePrivVar(String regex, String newName){
 		  for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++)
 		    clientline[x] = clientline[x].replaceAll(regex,newName);
		}
		
		private static void renamePrivVar(String[] regex, String[] newName){
			if(regex.length!=newName.length)
				return;
 		  for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++)
 		    for(int i = 0; i &lt; regex.length;i++)
 		      clientline[x] = clientline[x].replaceAll(regex[i],newName[i]);
		}
		
		public static void renameClassVar(String className, String regex, String newName){
			   try{
    	      File file2 = new File(fileprefix+className);
            FileInputStream fi = new FileInputStream(file2);
            byte[] bytes = new byte[(int) file2.length()];
            fi.read(bytes);
            fi.close();
            String content = new String(bytes);
            content = content.replaceAll(regex, newName);
            FileOutputStream fos = new FileOutputStream(file2);
            fos.write(content.getBytes());
            fos.close();
         }
        catch(Exception e){
            e.printStackTrace();
        }
    }
    
    public static void renameClassVar(String className, String[] regex, String[] newName){
			   try{
    	      File file2 = new File(fileprefix+className);
            FileInputStream fi = new FileInputStream(file2);
            byte[] bytes = new byte[(int) file2.length()];
            fi.read(bytes);
            fi.close();
            String content = new String(bytes);
            for(int i = 0; i &lt; regex.length;i++)
              content = content.replaceAll(regex[i], newName[i]);
            FileOutputStream fos = new FileOutputStream(file2);
            fos.write(content.getBytes());
            fos.close();
         }
        catch(Exception e){
            e.printStackTrace();
        }
    }
		
		public static void renamePubVar(String regex, String newName){
			renamePrivVar(regex, newName);
			File index = new File("./"+fileprefix);
		  String[] filet = index.list();
	  	for(int i = 0; i &lt; filet.length;i++)
		    if(filet[i].trim().endsWith(".java") &amp;&amp; (((filet[i].trim().indexOf("Class")&gt;-1)||(filet[i].trim().indexOf("Sub")&gt;-1))))
          renameClassVar(filet[i], regex, newName);
    }
    
    public static void renamePubVar(String[] regex, String[] newName){
    	if(regex.length!=newName.length)
				return;
			renamePrivVar(regex, newName);
			File index = new File("./"+fileprefix);
		  String[] filet = index.list();
	  	for(int i = 0; i &lt; filet.length;i++)
		    if(filet[i].trim().endsWith(".java") &amp;&amp; (((filet[i].trim().indexOf("Class")&gt;-1)||(filet[i].trim().indexOf("Sub")&gt;-1))))
          renameClassVar(filet[i], regex, newName);
    }
    
    public static void declareMethod(String nameParams){
    	for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++)
    	  if ((clientline[x].indexOf("public client()")&gt;-1))
				  clientline[x] = "public "+nameParams+"{ }\n"+clientline[x];
    }
  
	
	public static void main(String[] args)
	{
		String writetoscreen = "";
		try
		{
			File file = new File(fileprefix+"client.java");
			FileInputStream fistream = new FileInputStream(file);
			BufferedReader reader = new BufferedReader(new InputStreamReader(fistream));
		  int linenumber = 0;
			while ((clientline[linenumber] = reader.readLine()) != null)
			  linenumber++;
			fistream.close();
			
			for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++)
			  if (clientline[x].indexOf("mapdots")&gt;-1){
			//    System.out.println(clientline[x]);
			    String[] classnames = clientline[x].trim().split("\\s");
		//	    System.out.println(classnames[0]);
			    int aclassnum = Integer.parseInt(getRegexString("_\\d{1,4}",classnames[0]).substring(1));
			    String aclassname = classnames[0].substring(0,classnames[0].indexOf("_"+aclassnum)+1);
			    String[] dotNames = {"itemDot", "npcDot", "playerDot", "friendDot", "unknownDot"};
			    for (int t=0;t&lt;5; t++)
			      renamePrivVar(aclassname+(aclassnum+t), dotNames[t]);
			    declareMethod("void ChangeColors()");
			    declareMethod("void ChangeBack()");
			    declareMethod("void updateColors()");
			    declareMethod("void updatePlayers(int otherPlyrLvl)");
			    aclassname = "dot";  
			    aclassnum = 0;
			    String intarraystring = "";
			    String wildyposclass = "";
//			    System.out.println(aclassnum);
//			    System.out.println(aclassname);
			//    System.out.println(getRegexString("_\\d{1,4}",classnames[0]).substring(1));
			 //   System.out.println(classnames[3].substring(0,classnames[3].indexOf("(")));
			    try{
			      File pkclass = new File(fileprefix+classnames[3].substring(0,classnames[3].indexOf("("))+".java");
			      FileInputStream fistreampkclass = new FileInputStream(pkclass);
		      	BufferedReader pkreader = new BufferedReader(new InputStreamReader(fistreampkclass));
		        String tempstring = "";
		       	while ((tempstring = pkreader.readLine()) != null){
		      	  if ((tempstring.indexOf("public int anIntArray")&gt;-1)){
		      	  	String[] result = tempstring.trim().split("\\s");
		      	  	intarraystring = result[2].substring(0,result[2].indexOf("["));
		      	  	renamePubVar(intarraystring, "mapDotArray");
		      	  	intarraystring = "mapDotArray";
//		      	    System.out.println(intarraystring);
		      	  }
		        }
		      } catch(IOException e) { e.printStackTrace(); }
		      for (int i=0;i&lt;clientline.length&amp;&amp;clientline[i]!=null; i++)
					  if ((clientline[i].indexOf(" (level-")&gt;-1)&amp;&amp;(clientline[i].indexOf("aString")==-1)){
					  	      wildyposclass = getRegexString("aClass.{1,40}anInt\\d{1,4}",clientline[i]);
//                   System.out.println(wildyposclass.substring(0,wildyposclass.indexOf(".anInt")));
//                   System.out.println(wildyposclass.substring(wildyposclass.indexOf("anInt"),wildyposclass.length()));
// 	                  System.out.println(wildyposclass.substring(1).toLowerCase().replaceAll("_\\d{1,4}\\.anint\\d{1,4}",""));
 	                  renamePubVar(wildyposclass.substring(0,wildyposclass.indexOf(".anInt")),"myPlayer");
 	                  renamePrivVar(wildyposclass.substring(1).toLowerCase().replaceAll("_\\d{1,4}\\.anint\\d{1,4}",""),"otherPlayer");
 	                  renamePubVar(wildyposclass.substring(wildyposclass.indexOf("anInt"),wildyposclass.length()),"cmbtLvl");
 	                  i = clientline.length;
			    	}
		      for (int z=0;z&lt;clientline.length&amp;&amp;clientline[z]!=null; z++)
		        if (clientline[z].indexOf("* 4 + 2) -")&gt;-1){
		          for (int a=z;a&gt;0;a--)
		            if (clientline[a].indexOf("public void method")&gt;-1){
                  clientline[a+1] = clientline[a+1]+"\n    	  updateColors();";
		            	a = 0;
		            }
		          for (int a=z;a&lt;clientline.length&amp;&amp;clientline[a]!=null; a++)
		            if(clientline[a].indexOf("otherPlayer")&gt;-1){
		            	clientline[a]=clientline[a]+"\n    	  updatePlayers(otherPlayer.cmbtLvl);"; 
                a = clientline.length;
		            }
  z = clientline.length; 
	}
		      x = clientline.length;
		  }
			
for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++)
  if (clientline[x].indexOf("\"%5\"")&gt;-1){
  	clientline[x+4] = clientline[x+4]+"\n                            if(s.startsWith(\"Level:\"))\n"+
"                              wildypos = Integer.parseInt(s.substring(7));\n";
    x = clientline.length;
  }

	                for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++)
				if(clientline[x].indexOf("getParameter(\"nodeid\")")&gt;-1)
				{
					String[] result = clientline[x].trim().split("\\s");
					renamePrivVar(result[0],"nodeId");
				}

	                for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++)
				if(clientline[x].indexOf("public Socket method")&gt;-1)
				{
				//	String[] result = clientline[x].trim().split("\\s");
                       //       String methodname = result[2].substring(0,result[2].indexOf("int")-1);
				//	renamePrivVar(methodname,"socketMethod");
                              clientline[x+3] = "//"+clientline[x+3];
                              clientline[x+4] = "//"+clientline[x+4];
                              clientline[x+5] = "//"+clientline[x+5];                               
				}

Pattern pattern3 = Pattern.compile("if\\(super\\.anInt\\d{1,4} == 1 &amp;&amp; super\\.anInt\\d{1,4} &gt;= \\w{1,2} - 15 &amp;&amp; super\\.anInt\\d{1,4} &lt; \\w\\d?\\)");   	
for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++){//adds world switcher
Matcher match2 = pattern3.matcher(clientline[x]);	
    if(match2.find()){
				clientline[x+5] = clientline[x+5]+"\n"+clientline[x]+"\n"+clientline[x+1].replace("0;","2;")+"\n"+clientline[x+2];
				String[] result = clientline[x+1].trim().split("\\s");
				for (int i=0;i&lt;clientline.length&amp;&amp;clientline[i]!=null; i++)
				  if(clientline[i].indexOf("if("+result[0]+" == 1)")&gt;-1){
					  String[] password = clientline[i+3].trim().split("\\s");
					  clientline[i+10] = clientline[i+10]+"else\nif("+result[0]+" == 2)\n";
					  for (int z=1;z&lt;10;z++)
					    clientline[i+10] = ((clientline[i+10]+clientline[i+z]+"\n").replaceAll(password[0],"worldnum")).replaceAll("20\\)","3)");	
					    clientline[i+10] = clientline[i+10]+"}";
					  clientline[i+5] = clientline[i+5].replace("0;","2;");	
					  i = clientline.length;			    
			for (int y=0;y&lt;clientline.length&amp;&amp;clientline[y]!=null; y++)
			  if(clientline[y].indexOf("Username: ")&gt;-1){
			    clientline[y+3] = clientline[y+3]+"\n"+
			    clientline[y].replaceAll("aString\\d{1,4}","worldnum").replaceAll("Username","World #").replaceAll("== 0\\)","== 2\\)")+
			    "\n"+clientline[y+3];
			    y = clientline.length;
			  }	
			}
		  x = clientline.length;			
	  }
}
	
for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++)//adds maplock
	if ((clientline[x].indexOf("/ 2 &amp; 0x7ff;")&gt;-1))
				{
				 String[] result = clientline[x].trim().split("\\s");
         int firstvariable = Integer.parseInt(result[0].replace("anInt",""));
				 clientline[x] = "if(maplock){\n"+
         "   anInt"+firstvariable+" = mapface;\n"+
         "   anInt"+(firstvariable-1)+" = 383;\n"+
         "   }else{\n"+clientline[x];
         clientline[x+1] = clientline[x+1]+"\n}";
				}
				
	try{			
		Pattern pattern = Pattern.compile("int \\w{1,2} = 2048 - \\w{1,2} &amp; 0x7ff;"); //adds zoom and camera movement
    for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++){	
     Matcher match = pattern.matcher(clientline[x]);
     if (match.find())
				{
					  String[] zoomvars = new String[3];
					  String[] result = clientline[x+2].trim().split("\\s");
				  	zoomvars[0]=result[1];	
			  		result = clientline[x+3].trim().split("\\s");
				  	zoomvars[1]=result[1];		
		  			result = clientline[x+4].trim().split("\\s");
				  	zoomvars[2]=result[1];			
						//insertzoomcrap
						clientline[x+14] = clientline[x+14]+"if(cameratoggle){\n"+  
            "	if(lftrit == 0)\n"+    
            "    lftrit = "+zoomvars[0]+";\n"+
            "	if(zoom == 0)\n"+      
            "    zoom = "+zoomvars[1]+";\n"+
            "  if(fwdbwd == 0)\n"+  
            "    fwdbwd = "+zoomvars[2]+";\n"+
            "  "+zoomvars[0]+" = lftrit;\n"+
            "  "+zoomvars[1]+" = zoom;\n"+
            "  "+zoomvars[2]+" = fwdbwd;\n"+
            "}";
            x = clientline.length; 
				}
}
			} catch(Exception e) { e.printStackTrace(); }
				
// 0x3f008edd disables frame check 
				
for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++)	//fixes hp over heads
      if ((clientline[x].indexOf("* 30) /")&gt;-1))
				{
					int anintnumber = 0;
					String currenthp = clientline[x].substring(clientline[x].indexOf("=")+1,clientline[x].indexOf("*")).trim()+")";
					String totalhp = clientline[x].substring(clientline[x].indexOf("/")+1,clientline[x].indexOf(";")).trim();
					Pattern pattern2 = Pattern.compile("anInt\\d+ - 3");
					Matcher match2 = pattern2.matcher(clientline[x+3]);	
					if (match2.find()){
					  String tempstring =(clientline[x+3].substring(match2.start(),match2.end()));
					  anintnumber = Integer.parseInt(tempstring.substring(tempstring.indexOf("anInt")+5,tempstring.indexOf(" - 3")));
					}
					for (int i=0;i&lt;clientline.length&amp;&amp;clientline[i]!=null; i++){
					  if ((clientline[i].indexOf("Welcome to RuneScape")&gt;-1))
			    	{
			    		Pattern xcoord = Pattern.compile("[a-z] / 2");
			    		Pattern ycoord1 = Pattern.compile(", [a-z],");
			    		Pattern ycoord2 = Pattern.compile(", [a-z]\\)");
			    		Pattern ycoord3 = Pattern.compile("\\([a-z],");
			    		Matcher ymatch1 = ycoord1.matcher(clientline[i]);
			    		Matcher ymatch2 = ycoord2.matcher(clientline[i]);
			    		Matcher ymatch3 = ycoord3.matcher(clientline[i]);
			    		String[]  aroundx = xcoord.split(clientline[i]);
				    	writetoscreen = aroundx[0]+"anInt"+(anintnumber-1)+aroundx[1];
				    	if (ymatch1.find()){
				    	aroundx = ycoord1.split(writetoscreen);
				    	writetoscreen = aroundx[0]+", "+"anInt"+anintnumber+"-9, "+aroundx[1];
				      }
				      if (ymatch2.find()){
				    	aroundx = ycoord2.split(writetoscreen);
				    	writetoscreen = aroundx[0]+", "+"anInt"+anintnumber+"-9)"+aroundx[1];
				      }
				      if (ymatch3.find()){
				    	aroundx = ycoord3.split(writetoscreen);
				    	writetoscreen = aroundx[0]+"("+"anInt"+anintnumber+"-9, "+aroundx[1];
				      }
				     writetoscreen = writetoscreen.replace("\"Welcome to RuneScape\"",currenthp+"+\"/\"+"+totalhp);
				     writetoscreen = writetoscreen.replace("0xffff00","0xFF0000");
			    	}
				  }
				  clientline[x] = "if(showhp)\n"+writetoscreen+"\n"+clientline[x];
				 x = clientline.length;
				}
		
for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++){//changes names
			if ((clientline[x].indexOf("Welcome to RuneScape")&gt;-1))
					clientline[x]= clientline[x].replace("RuneScape","MoparScape");
			if ((clientline[x].indexOf("New User")&gt;-1))
					clientline[x]= clientline[x].replace("New User","Info");
		  if ((clientline[x].indexOf("Existing User")&gt;-1)){
					clientline[x]= clientline[x].replace("Existing User","Play");
					clientline[x]= clientline[x].replace("0xffffff","0xFF0000");
				}
		  if ((clientline[x].indexOf("Login")&gt;-1)){
					clientline[x]= clientline[x].replace("Login","Enter");
					clientline[x]= clientline[x].replace("0xffffff","0xFF0000");
				}
		 if ((clientline[x].indexOf("Cancel")&gt;-1))
					clientline[x]= clientline[x].replace("Cancel","Quit");
		 if ((clientline[x].indexOf("Create a free account")&gt;-1))
					clientline[x]= clientline[x].replace("Create a free account","This is MoparScape");
	 	 if ((clientline[x].indexOf("To create a new account you need to")&gt;-1))
					clientline[x]= clientline[x].replace("To create a new account you need to","For help, more info, suggestions,");
		 if ((clientline[x].indexOf("go back to the main RuneScape webpage")&gt;-1))
					clientline[x]= clientline[x].replace("go back to the main RuneScape webpage","or new versions, visit www.moparisthebest.com");
		 if ((clientline[x].indexOf("and choose the 'create account'")&gt;-1))
					clientline[x]= clientline[x].replace("and choose the 'create account'","and my thread ask anything you want");
		 if ((clientline[x].indexOf("button near the top of that page.")&gt;-1))
					clientline[x]= clientline[x].replace("button near the top of that page.","Have Fun. ~Moparisthebest");
		 if ((clientline[x].indexOf("RuneScape is loading - please wait...")&gt;-1))
					clientline[x]= clientline[x].replace("RuneScape is loading - please wait...","MoparScape is loading - Hold onto your Butts...");
		 clientline[x] = clientline[x].replaceAll("if\\(aBoolean\\d{1,4} \\|\\| aBoolean\\d{1,4} \\|\\| aBoolean\\d{1,4}\\)","if\\(false\\)");
		 if(clientline[x].indexOf("/ 2 - 128")&gt;-1)//removes logo
        clientline[x] = "//"+clientline[x];
     if(clientline[x].indexOf("extends Applet_Sub1")&gt;-1)//adds variables
        clientline[x+1] = clientline[x+1]+"public static boolean showhp,cameratoggle,maplock;\n"+
	                     "public static int zoom,lftrit,fwdbwd,mapface,wildypos;\n";
	   if ((clientline[x].indexOf("jagex.com")&gt;-1))
				clientline[x] = "flag = true;\n"+clientline[x];
     if ((clientline[x].indexOf("public client()")&gt;-1))
				clientline[x] = "public static String worldnum = \"10\";\n"+clientline[x];
}
			FileOutputStream fos = new FileOutputStream(file);
			for (int x=0;x&lt;clientline.length&amp;&amp;clientline[x]!=null; x++)
        fos.write((clientline[x]+"\n").getBytes());
      fos.close();
			
		} catch(IOException e) { e.printStackTrace(); }
	}
}
</code></pre>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-28T16:11:04Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:13:18Z' class='post-time'>
              August 2, 2016,  4:13pm
            </time>
        <span itemprop='position'>#18</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[code=java5]import java.lang.reflect.<em>;<br>
import <a href="http://java.io/">java.io</a>.</em>;</p>
<p>//getBadClass() by moparisthebest<br>
//getVersion() by newbiehacker<br>
public class getBCVer<br>
{<br>
public static String fileprefix = “output/”;</p>
<pre><code>public static void main(String args[])
{
	if(args.length != 1){
	  System.out.println("args: .bat_file_name");
	  return;
	}
	
	writeToBat(args[0],getBadClass(),getVersion());

}

public static void writeToBat(String batFileName, String badClass, int version){
	   System.out.println("bad class: " + badClass + "\nclient version: " + version);
	   try{   
	      File file2 = new File(batFileName);
        FileInputStream fi = new FileInputStream(file2);
        byte[] bytes = new byte[(int) file2.length()];
        fi.read(bytes);
        fi.close();
        String content = new String(bytes);
        content = content.replaceAll("badclass=.*", "badclass=" + badClass);
        content = content.replaceAll("version=\\d*", "version=" + version);
        FileOutputStream fos = new FileOutputStream(file2);
        fos.write(content.getBytes());
        fos.close();
     } catch(Exception e){
        e.printStackTrace();
    }
}

public static String getBadClass(){
   String badclassname = "NotFound";
   int filecount = 0;
   try{
   	    String filename = "";
        File index = new File("./"+fileprefix);
        String[] files = index.list();
        for(int i = 0; i &lt; files.length; i++){
            if(files[i].trim().endsWith(".java")){
                filename = files[i];
                    File file = new File(fileprefix+filename);
                    FileInputStream fistream2 = new FileInputStream(file);
                    byte[] bytes = new byte[(int) file.length()];
                    fistream2.read(bytes);
                    fistream2.close();
                    String content = new String(bytes);
                    if(content.contains("goto")){
                        badclassname = filename.substring(0, filename.length() - 5);
                        return badclassname;
                    }
                    filecount++;
            }
        }
    }
    catch(Exception e){
        e.printStackTrace();
    }
    return badclassname;
}

public static int getVersion(){
	 int clientversion = 0;
	 try{   
        Class signlink = Class.forName("sign.signlink");
        Field clientVersion = signlink.getDeclaredField("clientversion");
        clientVersion.setAccessible(true);
        clientversion = clientVersion.getInt(clientversion);
      } catch(Exception e){
        e.printStackTrace();
      }
    return clientversion;
}
</code></pre>
<p>}<br>
[/code]</p>
<p>[code=java5]import <a href="http://java.io/">java.io</a>.*;<br>
public class RandomRemover<br>
{<br>
static String tamafile = “”;<br>
static int filecount;<br>
public static String fileprefix = “output/”;<br>
public static void main(String[] args)<br>
{<br>
//replacing Math.random() ----&gt; /<em>Math.randm()</em>/0.5<br>
System.out.println(“Replacing Math.random() with /<em>Math.randm()</em>/0.5”);<br>
File index = new File("./"+fileprefix);<br>
String[] filet = index.list();<br>
boolean imagereplaced = false,chatremoved = false;<br>
for(int i = 0; i &lt; filet.length;i++)<br>
{<br>
//file alotetaan<br>
if(filet[i].trim().endsWith(".java") &amp;&amp; (((filet[i].trim().indexOf(“Class”)&gt;-1)||(filet[i].trim().indexOf(“Sub”)&gt;-1)) || (filet[i].trim().indexOf(“client.java”)&gt;-1)) )<br>
{<br>
tamafile = filet[i];<br>
try<br>
{<br>
File file = new File(fileprefix+tamafile);<br>
FileInputStream fistream = new FileInputStream(file);<br>
BufferedReader reader = new BufferedReader(new InputStreamReader(fistream));<br>
File file2 = new File(fileprefix+tamafile+“a”);<br>
FileOutputStream fos = new FileOutputStream(file2);<br>
int replacecount = 0;<br>
String fileline = “”;<br>
String line = “”;<br>
//		  FileOutputStream fos = new FileOutputStream(file);<br>
while ((line = reader.readLine()) != null)<br>
{				<br>
//	System.out.println(line);<br>
if (line.indexOf(“Math.random()”)&gt;-1)<br>
{<br>
replacecount++;<br>
line = line.replaceAll(“Math.random\(\)”,"/<em>Math.randm()</em>/0.5");<br>
}</p>
<pre><code>			if (line.indexOf("Image image =")&gt;-1)
			{
				imagereplaced = true;
				line = "Image image = Toolkit.getDefaultToolkit().getImage(\"mopar.jpg\");";
			}
			
			if (line.indexOf("return (new String(ac)).trim();")&gt;-1)
			{
				chatremoved = true;
				line = "return s;";
			}
			
			if (line.indexOf("\"Jagex\"")&gt;-1)
			{
				line = line.replaceAll("\"Jagex\"","\"MoparScape\"");
			}
		//	fileline = fileline + "\n" + line;
			fos.write((line+"\n").getBytes());
		}
		System.out.println("Replaced "+replacecount+" times in "+tamafile);
//		FileOutputStream fos = new FileOutputStream(file);
</code></pre>
<p>//    fos.write(contentout.getBytes());<br>
fistream.close();<br>
fos.close();<br>
file.delete();<br>
file2.renameTo(new File(fileprefix+tamafile));<br>
//    String line = “”;<br>
//    fos.write(fileline.getBytes());<br>
filecount++;<br>
} catch(IOException e) { e.printStackTrace(); }</p>
<pre><code>	//file hoidettu
	}
	}
	System.out.println("Replace done in "+filecount+" files");
	if(imagereplaced)
		  System.out.println("Succesfuly replaced image");
		else
		  System.out.println("failed replacing image");
  if(chatremoved)
		  System.out.println("Succesfuly removed chat filter");
		else
		  System.out.println("failed removing chat filter");
}
</code></pre>
<p>}<br>
[/code]</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-28T16:26:20Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:13:18Z' class='post-time'>
              August 2, 2016,  4:13pm
            </time>
        <span itemprop='position'>#19</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>so what revision was mscp 2? was it still the whole 317 client loading a 349(?) cache deal?</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-28T18:02:39Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:13:23Z' class='post-time'>
              August 2, 2016,  4:13pm
            </time>
        <span itemprop='position'>#20</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="19" data-topic="431796">
<div class="title">
<div class="quote-controls"></div>
 t4:</div>
<blockquote>
<p>so what revision was mscp 2? was it still the whole 317 client loading a 349(?) cache deal?</p>
</blockquote>
</aside>
<p>Up until 4 they were all 317, probably loading the newest cache available at the time. (up to 377)</p>
      </div>

      <meta itemprop='headline' content='317 and 508 custom RSA keys'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/317-and-508-custom-rsa-keys/431796 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:06 GMT -->
</html>
