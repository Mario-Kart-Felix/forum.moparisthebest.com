<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/event-based-updating/337921?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Event based updating? - Community Inside Talk - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;m posting my ideas here because my knowledge of the client/protocol is quite limited and I&amp;#39;m trying to figure out whether it will work or not. 

I&amp;#39;ve noticed that current servers exclusively use polling for player upda&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="3379214658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Event based updating?&#39;" href="337921.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://img38.imageshack.us/img38/7758/eventj.png" />
<meta property="og:image" content="http://img38.imageshack.us/img38/7758/eventj.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/event-based-updating/337921?page=2" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/event-based-updating/337921?page=2" />
<meta property="og:title" content="Event based updating?" />
<meta name="twitter:title" content="Event based updating?" />
<meta property="og:description" content="[quote=“MrPotatoHead, post:18, topic:337921”][quote author=blakeman8192 link=topic=434318.msg3191849#msg3191849 date=1272332673]  I’m pretty sure the viewing range is limited to 32x32 (16 tiles in any direction), I haven’t explicitly checked though.  [/quote]  50x50 defined by method313. (and checking)  You could always ignore that and decide it’s going to be 32x32 for the sake of simplicity.  Thx for the crash course, interesting reading.[/quote]  You only see players in a 32x32 area which is w..." />
<meta name="twitter:description" content="[quote=“MrPotatoHead, post:18, topic:337921”][quote author=blakeman8192 link=topic=434318.msg3191849#msg3191849 date=1272332673]  I’m pretty sure the viewing range is limited to 32x32 (16 tiles in any direction), I haven’t explicitly checked though.  [/quote]  50x50 defined by method313. (and checking)  You could always ignore that and decide it’s going to be 32x32 for the sake of simplicity.  Thx for the crash course, interesting reading.[/quote]  You only see players in a 32x32 area which is w..." />
<meta property="article:published_time" content="2010-04-27T19:27:41+00:00" />
<meta property="og:ignore_canonical" content="true" />

      <link rel="prev" href="337921.html">
      <link rel="next" href="3379219ba9.html?page=3">


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="337921.html">Event based updating?</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/community-inside-talk.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Community Inside Talk</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Graham.html'><span itemprop='name'>Graham</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-27T19:27:41Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:10:07Z' class='post-time'>
              July 31, 2016,  4:10pm
            </time>
        <span itemprop='position'>#21</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“MrPotatoHead, post:18, topic:337921”][quote author=blakeman8192 link=topic=434318.msg3191849#msg3191849 date=1272332673]<br>
I’m pretty sure the viewing range is limited to 32x32 (16 tiles in any direction), I haven’t explicitly checked though.<br>
[/quote]<br>
50x50 defined by method313. (and checking)<br>
You could always ignore that and decide it’s going to be 32x32 for the sake of simplicity.</p>
<p>Thx for the crash course, interesting reading.[/quote]</p>
<p>You only see players in a 32x32 area which is what I think most people are referring to (other player position offset is sent as a 5 bit signed integer).</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-27T20:57:09Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:10:12Z' class='post-time'>
              July 31, 2016,  4:10pm
            </time>
        <span itemprop='position'>#22</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Persoanally [quote=“Lothy, post:19, topic:337921”]To me personally, it makes more sense to use a number based on the visible terrain that the player sees. With that said, I’d personally use 32x32 regions.[/quote]</p>
<p>I see your 32x32 region and raise you 64x64.<br>
64x64 allows real simple bit manipulation for region overlap without to much pissing about, you just shift by 1.<br>
Something like this.</p>
<pre><code class="lang-auto">pa = player_array
for (int i=0; i&lt;pa.length;i++);
{
//region overlap
regionx= pa[i].regx + (pa[i].regx &lt;&lt; 1)&amp;0xffff +(pa[i].regx &gt;&gt; 1)&amp;0xffff
regiony= pa[i].regy + (pa[i].regy &lt;&lt; 1)&amp;0xffff +(pa[i].regy &gt;&gt; 1)&amp;0xffff
  for (int j=0; j&lt;pa.length;j++);
	{
	if(((regionx &amp; pa[j].regx) | (regiony &amp; pa[j].regy)) ==0)
       Break;
	else calc_distance;   
	}
}


calc_distance
{
 dist = math.sqrt(((pa[i].x-pa[j].x)*(pa[i].x-pa[j].x)) + ((pa[i].y-pa[j].y)*(pa[i].y-pa[j].y)))
 if (dist &lt; 32) pa[i].distance[dist][count[dist]++]= j; 
}</code></pre>
<p>Surface map is effectively 32x32 maps, PLUS another 32x32 maps for other areas like dungeons, 64x64 regions fit nicely into a LONG if you put your surface map and dungeons maps side by side.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-27T21:23:41Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:10:14Z' class='post-time'>
              July 31, 2016,  4:10pm
            </time>
        <span itemprop='position'>#23</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“MrPotatoHead, post:22, topic:337921”]Persoanally [quote author=Lothy link=topic=434318.msg3192061#msg3192061 date=1272365378]<br>
To me personally, it makes more sense to use a number based on the visible terrain that the player sees. With that said, I’d personally use 32x32 regions.<br>
[/quote]</p>
<p>I see your 32x32 region and raise you 64x64.<br>
64x64 allows real simple bit manipulation for region overlap without to much pissing about, you just shift by 1.<br>
Something like this.</p>
<pre><code class="lang-auto">pa = player_array
for (int i=0; i&lt;pa.length;i++);
{
//region overlap
regionx= pa[i].regx + (pa[i].regx &lt;&lt; 1)&amp;0xffff +(pa[i].regx &gt;&gt; 1)&amp;0xffff
regiony= pa[i].regy + (pa[i].regy &lt;&lt; 1)&amp;0xffff +(pa[i].regy &gt;&gt; 1)&amp;0xffff
  for (int j=0; j&lt;pa.length;j++);
	{
	if(((regionx &amp; pa[j].regx) | (regiony &amp; pa[j].regy)) ==0)
       Break;
	else calc_distance;   
	}
}


calc_distance
{
 dist = math.sqrt(((pa[i].x-pa[j].x)*(pa[i].x-pa[j].x)) + ((pa[i].y-pa[j].y)*(pa[i].y-pa[j].y)))
 if (dist &lt; 32) pa[i].distance[dist][count[dist]++]= j; 
}</code></pre>
<p>Surface map is effectively 32x32 maps, PLUS another 32x32 maps for other areas like dungeons, 64x64 regions fit nicely into a LONG if you put your surface map and dungeons maps side by side.[/quote]<br>
As Graham said, the position of added players is relative to the position of this player, and the distance is written as a 5-bit value, which means that the max value is 2^5, or 32.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-27T21:41:44Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:10:15Z' class='post-time'>
              July 31, 2016,  4:10pm
            </time>
        <span itemprop='position'>#24</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i chose 16x16 regions because if someone is at the edge of one region, they will see at most 16 tiles ahead, which is ideal.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-28T17:27:10Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:11:05Z' class='post-time'>
              July 31, 2016,  4:11pm
            </time>
        <span itemprop='position'>#25</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“la­wl, post:24, topic:337921”]i chose 16x16 regions because if someone is at the edge of one region, they will see at most 16 tiles ahead, which is ideal.[/quote]That works well, but the clientside region isn’t 16x16 so you’d have to have a separate region detection/changing system where you send the client the new map region.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-28T19:52:32Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:11:09Z' class='post-time'>
              July 31, 2016,  4:11pm
            </time>
        <span itemprop='position'>#26</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="23" data-topic="337921">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/blakeman8192/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> blakeman8192:</div>
<blockquote>
<p>As Graham said, the position of added players is relative to the position of this player, and the distance is written as a 5-bit value, which means that the max value is 2^5, or 32.</p>
</blockquote>
</aside>
<p>Wait, Graham said (other player position offset is sent as a 5 bit signed integer).<br>
So that’s 5 bit distance value + 1 bit sign? or 4 bits value + sign bit?<br>
If it’s distance of 32 then it works out at sqrt((31^2)/2) = 21-32 tiles max distance from player.<br>
If it’s 4 bit distance + sign bit then max distance is 11-15 tiles.<br>
i’ll go look.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-28T20:58:14Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:11:12Z' class='post-time'>
              July 31, 2016,  4:11pm
            </time>
        <span itemprop='position'>#27</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>its definitely 32x32 centered at the player</p>
<p>in client:</p>
<pre><code class="lang-auto">            int local_y = stream.getBits(5);
            if (local_y &gt; 15)
                local_y -= 32;
            int local_x = stream.getBits(5);
            if (local_x &gt; 15)
                local_x -= 32;</code></pre>
<p>edit: 16x16 also lets me skip distance checking on same region players</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-29T00:01:10Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:11:22Z' class='post-time'>
              July 31, 2016,  4:11pm
            </time>
        <span itemprop='position'>#28</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>yeah that’s right, checked in game, it’s not distance, it’s that, that’s not distance, that’s position offsets.</p>
<p>How you going to ‘subscribe’ to regions?<br>
My only real concern about using a smaller region would be the number of extra events that would occur above a larger region, which might generate extra packets, but i guess you won’t know until you try.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-29T14:16:32Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:11:42Z' class='post-time'>
              July 31, 2016,  4:11pm
            </time>
        <span itemprop='position'>#29</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“MrPotatoHead, post:28, topic:337921”]yeah that’s right, checked in game, it’s not distance, it’s that, that’s not distance, that’s position offsets.[/quote]Maximum position offset = maximum distance from this player (when being updated/added to the player list).</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-29T21:54:42Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:12:00Z' class='post-time'>
              July 31, 2016,  4:12pm
            </time>
        <span itemprop='position'>#30</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>What about height level?<br>
Had a play on RS, if you go up a ladder in lumbridge, you can’t see the players on the floors below, only those on your height level. I assume that the dungeon levels are similar and have 4 height levels, cept dungeons go downwards instead of upwards?<br>
So your going to need 8x the number of regions.<br>
That would be pretty simple for 32x32 region size, use longs (with bit shifting for region overlap) and an 8 bit level test, you test for height level BEFORE you test for distance on that level.</p>
<p>There’s going to be a trade off between the number of players tested V’s region size, the smaller the region the fewer players need to be tested, but conversly the smaller the region size the greater the number of region change events that occur.<br>
Mathematically that trade off point is either 16x or 32x tile size regions, just depends on which one produces the least number of packets, they didn’t go to all that trouble compressing the 3D models and not think about the bandwidth the servers produced.</p>
<p>My suggestion is to do both a 16x16 region size server and a 32x32 region size server, see what efficiencies you can save in processor time and bandwidth with both.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-29T23:30:51Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:12:05Z' class='post-time'>
              July 31, 2016,  4:12pm
            </time>
        <span itemprop='position'>#31</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>wah wah wah</p>
<p>[quote=“la­wl, post:27, topic:337921”]its definitely 32x32 centered at the player</p>
<p>in client:</p>
<pre><code class="lang-auto">            int local_y = stream.getBits(5);
            if (local_y &gt; 15)
                local_y -= 32;
            int local_x = stream.getBits(5);
            if (local_x &gt; 15)
                local_x -= 32;</code></pre>
<p>edit: 16x16 also lets me skip distance checking on same region players[/quote]</p>
<p>wow cool i told you that like a week ago</p>
<p><a class="mention" href="../../u/blakeman.html">@blakeman</a>: m8 i’m pretty sure i talked about that months ago</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-30T03:10:06Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:12:14Z' class='post-time'>
              July 31, 2016,  4:12pm
            </time>
        <span itemprop='position'>#32</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“MrPotatoHead, post:30, topic:337921”]What about height level?<br>
Had a play on RS, if you go up a ladder in lumbridge, you can’t see the players on the floors below, only those on your height level. I assume that the dungeon levels are similar and have 4 height levels, cept dungeons go downwards instead of upwards?<br>
So your going to need 8x the number of regions.<br>
That would be pretty simple for 32x32 region size, use longs (with bit shifting for region overlap) and an 8 bit level test, you test for height level BEFORE you test for distance on that level.</p>
<p>There’s going to be a trade off between the number of players tested V’s region size, the smaller the region the fewer players need to be tested, but conversly the smaller the region size the greater the number of region change events that occur.<br>
Mathematically that trade off point is either 16x or 32x tile size regions, just depends on which one produces the least number of packets, they didn’t go to all that trouble compressing the 3D models and not think about the bandwidth the servers produced.</p>
<p>My suggestion is to do both a 16x16 region size server and a 32x32 region size server, see what efficiencies you can save in processor time and bandwidth with both.[/quote]<br>
height isnt a problem… regions are only created when theres someone in them anyway. 16x16 is better for upstairs etc because usually there wont be any active adjacent regions so theres no distance checking at all.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-30T16:07:04Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:12:28Z' class='post-time'>
              July 31, 2016,  4:12pm
            </time>
        <span itemprop='position'>#33</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“MrPotatoHead, post:30, topic:337921”]What about height level?<br>
Had a play on RS, if you go up a ladder in lumbridge, you can’t see the players on the floors below, only those on your height level. I assume that the dungeon levels are similar and have 4 height levels, cept dungeons go downwards instead of upwards?<br>
So your going to need 8x the number of regions.<br>
That would be pretty simple for 32x32 region size, use longs (with bit shifting for region overlap) and an 8 bit level test, you test for height level BEFORE you test for distance on that level.</p>
<p>There’s going to be a trade off between the number of players tested V’s region size, the smaller the region the fewer players need to be tested, but conversly the smaller the region size the greater the number of region change events that occur.<br>
Mathematically that trade off point is either 16x or 32x tile size regions, just depends on which one produces the least number of packets, they didn’t go to all that trouble compressing the 3D models and not think about the bandwidth the servers produced.</p>
<p>My suggestion is to do both a 16x16 region size server and a 32x32 region size server, see what efficiencies you can save in processor time and bandwidth with both.[/quote]Height isn’t really a concern. You don’t update players on separate heights, height is sent only for updating this player movement (as a part of the “teleport” flag, value 3). Also, there are only 4 height levels (limited by the 2 bit value). All of the dungeons are actually Y position + 6400 (say there’s a ladder down to a dungeon at position 3200, 3300 - down the ladder into the dungeon would be 3200, 9700).</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-30T22:37:13Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:12:47Z' class='post-time'>
              July 31, 2016,  4:12pm
            </time>
        <span itemprop='position'>#34</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>you have to remove all the players from the previous height level and add new ones though, right?</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-05-01T04:33:25Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:13:08Z' class='post-time'>
              July 31, 2016,  4:13pm
            </time>
        <span itemprop='position'>#35</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“la­wl, post:34, topic:337921”]you have to remove all the players from the previous height level and add new ones though, right?[/quote]You don’t update players across multiple height levels. You only update other players on the current plane.<br>
But yeah, if you’re switching height levels, of course you have to remove everyone in the other height level and add the new ones. <img src="../../images/emoji/twitter/stuck_out_tongueae52.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-05-08T03:18:30Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:20:28Z' class='post-time'>
              July 31, 2016,  4:20pm
            </time>
        <span itemprop='position'>#36</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>lawl i pose a question. what if the adjacent regions have a shit load of players? what if yours does too? however, consider the region is big enough to have ‘distant’ yet still regionally local players… what if there are many of these such players? then you still have the issue of looping through a whole niggerload of them when determining which are in view when you shouldn’t have to. my model was to use a space partitioning tree where the depth in different areas was not uniform throughout and rather dependent on population; i.e. ρ ∝ d</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-05-08T18:12:19Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:20:58Z' class='post-time'>
              July 31, 2016,  4:20pm
            </time>
        <span itemprop='position'>#37</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“oksuper_, post:36, topic:337921”]lawl i pose a question. what if the adjacent regions have a shit load of players? what if yours does too? however, consider the region is big enough to have ‘distant’ yet still regionally local players… what if there are many of these such players? then you still have the issue of looping through a whole niggerload of them when determining which are in view when you shouldn’t have to. my model was to use a space partitioning tree where the depth in different areas was not uniform throughout and rather dependent on population; i.e. ρ ∝ d[/quote]That’s what I did too. <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"><br>
In the 7th dimension server, my region system for player updating is based on a quadtree data structure.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/NewbieNewty.html'><span itemprop='name'>NewbieNewty</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-05-08T18:51:44Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:20:59Z' class='post-time'>
              July 31, 2016,  4:20pm
            </time>
        <span itemprop='position'>#38</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“blakeman8192, post:37, topic:337921”][quote author=oksuper_ link=topic=434318.msg3200596#msg3200596 date=1273288710]<br>
lawl i pose a question. what if the adjacent regions have a shit load of players? what if yours does too? however, consider the region is big enough to have ‘distant’ yet still regionally local players… what if there are many of these such players? then you still have the issue of looping through a whole niggerload of them when determining which are in view when you shouldn’t have to. my model was to use a space partitioning tree where the depth in different areas was not uniform throughout and rather dependent on population; i.e. ρ ∝ d<br>
[/quote]That’s what I did too. <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"><br>
In the 7th dimension server, my region system for player updating is based on a quadtree data structure.[/quote]</p>
<p>I believe you have mentioned quadtree’s at least 4 times in this thread, just a guestimate <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-05-08T21:17:57Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:21:08Z' class='post-time'>
              July 31, 2016,  4:21pm
            </time>
        <span itemprop='position'>#39</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>the problem with trees is the constant need to reconstruct them. methinks.</p>
<p><a class="mention" href="../../u/super.html">@super</a>, as i said on irc, i am not worried about it, its an uncommon scenario and you are underestimating the processing power of modern cpus</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-05-09T15:53:08Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:21:57Z' class='post-time'>
              July 31, 2016,  4:21pm
            </time>
        <span itemprop='position'>#40</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="39" data-topic="337921">
<div class="title">
<div class="quote-controls"></div>
 la­wl:</div>
<blockquote>
<p>i am not worried about it, its an uncommon scenario</p>
</blockquote>
</aside>
<p>Is it that uncommon?<br>
Thinking about the old world 1 varrock bank (which a 16x16 region cuts into 4 btw)  made me think about what type of server your creating. The ideal is everyone spread about in small groups, the worst case scenario is old world 1 varrock with drop parties.<br>
I don’t think your going to be catering for either, it’s a private server, if it’s popular your going to get large groupings of players, either hacking the shit out of each other or calling each other noob. Server still has to work even if 2048 players stands on the same tile.<br>
Maybe there’s an adaptive solution.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
      <span itemprop='name'><a rel="prev" itemprop="url" href="337921.html">← previous page</a></span>
      <span itemprop='name'><b><a rel="next" itemprop="url" href="3379219ba9.html?page=3">next page →</a></b></span>
  </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/event-based-updating/337921?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:12 GMT -->
</html>
