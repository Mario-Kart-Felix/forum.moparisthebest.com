<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/event-based-updating/337921 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Event based updating? - Community Inside Talk - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;m posting my ideas here because my knowledge of the client/protocol is quite limited and I&amp;#39;m trying to figure out whether it will work or not. 

I&amp;#39;ve noticed that current servers exclusively use polling for player upda&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="337921.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Event based updating?&#39;" href="337921.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://img38.imageshack.us/img38/7758/eventj.png" />
<meta property="og:image" content="http://img38.imageshack.us/img38/7758/eventj.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/event-based-updating/337921" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/event-based-updating/337921" />
<meta property="og:title" content="Event based updating?" />
<meta name="twitter:title" content="Event based updating?" />
<meta property="og:description" content="I’m posting my ideas here because my knowledge of the client/protocol is quite limited and I’m trying to figure out whether it will work or not.  I’ve noticed that current servers exclusively use polling for player updating, my idea is to use an event system instead:  There would be a typical region system. I propose 16x16 regions, and as a player needs to see events in a 32x32 area, they would be ‘subscribed’ to 9 regions at a time.  Player updates will be done per region, save for the player s..." />
<meta name="twitter:description" content="I’m posting my ideas here because my knowledge of the client/protocol is quite limited and I’m trying to figure out whether it will work or not.  I’ve noticed that current servers exclusively use polling for player updating, my idea is to use an event system instead:  There would be a typical region system. I propose 16x16 regions, and as a player needs to see events in a 32x32 area, they would be ‘subscribed’ to 9 regions at a time.  Player updates will be done per region, save for the player s..." />
<meta property="article:published_time" content="2010-04-24T03:19:42+00:00" />
<meta property="og:ignore_canonical" content="true" />

      <link rel="next" href="3379214658.html?page=2">


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="337921.html">Event based updating?</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/community-inside-talk.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Community Inside Talk</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-24T03:19:42Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:06:55Z' class='post-time'>
              July 31, 2016,  4:06pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’m posting my ideas here because my knowledge of the client/protocol is quite limited and I’m trying to figure out whether it will work or not.</p>
<p>I’ve noticed that current servers exclusively use polling for player updating, my idea is to use an event system instead:</p>
<p>There would be a typical region system. I propose 16x16 regions, and as a player needs to see events in a 32x32 area, they would be ‘subscribed’ to 9 regions at a time.<br>
Player updates will be done per region, save for the player specific initial packet. When an event occurs in a region, it notifies every adjacent region. During player update, each region constructs the necessary update packets based on the events received since the previous server tick.<br>
Possible events include player movement, player added/removed to region, player appearance change, chat messages, etc…</p>
<p><img src="http://img38.imageshack.us/img38/7758/eventj.png" alt width="" height=""><br>
In this example, a player leaves region B, and every adjacent region is notified. Since that player’s new region is not adjacent to region A, all players in region A will be sent a packet indicating that said player should be removed. This packet would only need to be constructed once.</p>
<p>I think that is a sufficient description, what I want is for you to challenge the design so I can figure out if it is flawed or not before I attempt to implement it.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Protosstribe.html'><span itemprop='name'>Protosstribe</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-24T07:46:03Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:07:02Z' class='post-time'>
              July 31, 2016,  4:07pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I have already done that a few years ago and it works pretty well. I even released the source, but not many even looked at it, so it never really got a lot of attention. It was a new concept here at this site back then.</p>
<p>However, I didn’t get time to fix some synchronization problems with the subscriptions etc. but they wouldn’t be that hard to fix.</p>
<p>Actually there are two ways I see possible for no duplicate events to occur:</p>
<ol>
<li>
<p>Have all players send their events to the region they are in at the time of the event and let all players in surrounding regions receive it from that region if they are close enough.</p>
</li>
<li>
<p>Have all players send their events to the (at most 4) closest regions and let all players only receive events from their own region.</p>
</li>
</ol>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-24T19:32:05Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:07:27Z' class='post-time'>
              July 31, 2016,  4:07pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>and where might I be able to take a look at the source?</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Protosstribe.html'><span itemprop='name'>Protosstribe</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-24T21:30:46Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:07:37Z' class='post-time'>
              July 31, 2016,  4:07pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Here is the link for it: <a href="http://www.megaupload.com/?d=4EOKMN39" rel="nofollow noopener">http://www.megaupload.com/?d=4EOKMN39</a></p>
<p>For your information; it is an RSC private server, so if you were looking for an RS private server I really cannot help you with that. But I assume the concepts would be pretty much the same. Although your concepts might not be 100% accurate to what I did back then. Plus, don’t blame me for my bad design and / or architecture - I know it sucks and that was the reason I stopped working on it. <img src="../../images/emoji/twitter/smileyae52.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-24T22:25:09Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:07:47Z' class='post-time'>
              July 31, 2016,  4:07pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I have a feeling its not going to be any good because the server has to keep track of a list of players that every players sees and keep it in the correct order</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-25T20:41:08Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:08:34Z' class='post-time'>
              July 31, 2016,  4:08pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“object, post:2, topic:337921”]I have already done that a few years ago and it works pretty well. I even released the source, but not many even looked at it, so it never really got a lot of attention. It was a new concept here at this site back then.</p>
<p>However, I didn’t get time to fix some synchronization problems with the subscriptions etc. but they wouldn’t be that hard to fix.[/quote]<br>
Well, with a proper thread model, no synchronization should be required during player updating…</p>
<p>Also, yeah this will work. Instead of broadcasting an event to every player to do the updating, maybe you could broadcast an event to the region which prepares a ‘sector’ of the packet that gets cached for the region and all other players just use that ‘sector’ (as player updating order is different among different players, so you can’t just cache one huge packet).</p>
<p>It would be a pretty cool design. I recommend you use a quadtree for the region system.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-25T20:53:37Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:08:34Z' class='post-time'>
              July 31, 2016,  4:08pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>theres still the problem of having to keep an ordered list for each player of all surrounding players, which seems to fuck up the entire idea</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lothy.html'><span itemprop='name'>lothy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-26T03:18:58Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:08:54Z' class='post-time'>
              July 31, 2016,  4:08pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="7" data-topic="337921">
<div class="title">
<div class="quote-controls"></div>
 la­wl:</div>
<blockquote>
<p>theres still the problem of having to keep an ordered list for each player of all surrounding players, which seems to fuck up the entire idea</p>
</blockquote>
</aside>
<p>Each region could maintain two collections – a collection of all players that are currently in the region, and a collection of players that have just left the region. When either of these lists is modified, any player subscribed to the region gets updated. Once that’s done, the list of players recently removed can be cleared.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-26T03:38:40Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:08:54Z' class='post-time'>
              July 31, 2016,  4:08pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i just discovered that upon movement only the direction needs to be sent, that makes this quite a bit better than i first imagined.</p>
<p>anyway lothy i dont think thats necessary. every tick i will loop through all active regions, and tell them to update all their players. it will give each player a list of all the events, then at the end clear the queue. also that doesnt help with the problem, the point was to avoid keeping an array of local players per player</p>
<p>working on it atm i will report my findings!</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lothy.html'><span itemprop='name'>lothy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-26T11:33:16Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:09:01Z' class='post-time'>
              July 31, 2016,  4:09pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I might get my hands on some of the code tomorrow (probably from Graham’s release). A part of me thinks that the ordering isn’t overly essential, so I’m keen to check on it.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Protosstribe.html'><span itemprop='name'>Protosstribe</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-26T12:33:01Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:09:02Z' class='post-time'>
              July 31, 2016,  4:09pm
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>As far as I know, the client only renders the entities that have / has (whatever) been sent to it since the last tick-update - and removes all the others. Atleast that’s what I discovered in RSC. So this means, you don’t have to keep track of whom will be removed (out of range) etc. Just update what’s currently there. I might have missed some stuff, so if that is the case - please enlighten me. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Also, why would you need to keep your players and / or other entities ordered? What must be ordered is the events sent from different players and / or other entities.</p>
<p>When I wrote my server, I had one event-queue for each player and one event-queue for the region (area) in which that player (well, every player had that, not just one :)) was located. The one the player had was a private one, for things that do not need to be shown to everyone else. And the other one was used for public access. It was made out of an array with a fixed length and had itself overwritten everytime a new event was added (with a nulled event as delimiter between the last one and the first one - because of the circularity). When a player grabbed an event from the two event-queues, it increased its last-grabbed event-index (one for the private one and one for the public one) and therefore was always up to date on both.</p>
<p>To get the next event would just be to use a simple remainder operation.</p>
<p>Hopefully you understand what I am talking about, but I am at work, so I can’t spend a lot of time fixing potential spelling mistakes and whatever else I did to this text. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-26T17:59:00Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:09:18Z' class='post-time'>
              July 31, 2016,  4:09pm
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I don’t know much about servers but that sounds like alot of objects/threads.<br>
With a 377 cache that would be 11,120 “regions” over the entire map.<br>
Even with inactive regions, it’s still seems too many, are you actually reducing the ammount of packets sent to players?<br>
Like the idea, just think your regions are too small, processing time is cheap, bandwidth isn’t.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-26T20:22:33Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:09:24Z' class='post-time'>
              July 31, 2016,  4:09pm
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“MrPotatoHead, post:12, topic:337921”]I don’t know much about servers but that sounds like alot of objects/threads.<br>
With a 377 cache that would be 11,120 “regions” over the entire map.<br>
Even with inactive regions, it’s still seems too many, are you actually reducing the ammount of packets sent to players?<br>
Like the idea, just think your regions are too small, processing time is cheap, bandwidth isn’t.[/quote]<br>
memory is cheap, processing time isn’t. this doesnt save bandwidth in any way, no, it only saves processing time</p>
<p>[quote=“object, post:11, topic:337921”]As far as I know, the client only renders the entities that have / has (whatever) been sent to it since the last tick-update - and removes all the others. Atleast that’s what I discovered in RSC. So this means, you don’t have to keep track of whom will be removed (out of range) etc. Just update what’s currently there. I might have missed some stuff, so if that is the case - please enlighten me. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Also, why would you need to keep your players and / or other entities ordered? What must be ordered is the events sent from different players and / or other entities.</p>
<p>When I wrote my server, I had one event-queue for each player and one event-queue for the region (area) in which that player (well, every player had that, not just one :)) was located. The one the player had was a private one, for things that do not need to be shown to everyone else. And the other one was used for public access. It was made out of an array with a fixed length and had itself overwritten everytime a new event was added (with a nulled event as delimiter between the last one and the first one - because of the circularity). When a player grabbed an event from the two event-queues, it increased its last-grabbed event-index (one for the private one and one for the public one) and therefore was always up to date on both.</p>
<p>To get the next event would just be to use a simple remainder operation.</p>
<p>Hopefully you understand what I am talking about, but I am at work, so I can’t spend a lot of time fixing potential spelling mistakes and whatever else I did to this text. :)[/quote]<br>
im not sure if thats true for rs2, the server sends when to remove players so i dunno</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Protosstribe.html'><span itemprop='name'>Protosstribe</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-26T20:38:12Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:09:25Z' class='post-time'>
              July 31, 2016,  4:09pm
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>MrPotatoHead: You could always remove unused regions from their repository. And when it comes to threads; you don’t really need a lot of them. I used one thread per client - but that is overkill (not to talk about thread context-switches). To use one thread may also not be the best option. Perhaps use a few, but not too many. The amount of objects doesn’t really matter as long as you do not run out of RAM. It won’t as long as you keep the memory consumption somewhat stable.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-26T21:57:21Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:09:28Z' class='post-time'>
              July 31, 2016,  4:09pm
            </time>
        <span itemprop='position'>#15</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Just trying to get head around the region size and how that effects how many packets are sent. Why use 16x16 and not 8x8 or 32x32?</p>
<p>You’ve said, this is based on visible area, but i’m not sure you understand the visible area.<br>
The visible region is 50x50, NORMALLY reduced by the camera calculations to 16 in front of the player at ground level (it’s dependant on height). So the player at the top of A, say 2 spaces from top, can see everything in the 16x16 region above it since the 2+16 spaces are greater than that player can normally see from the ground. However when higher up the player will see up to 25 tiles in front so with a 16x16 region the player at the top of a will have 7 tiles missing.<br>
I just checked, it’s possible to click 20 tiles in front of the player with an unmodified client.</p>
<p>So now i’ve completely screwed up your 16x16 region system, i’m going to try and work out the packet usage for both bigger AND smaller regions (you can simply subscibe to more regions).<br>
I really do like the idea btw.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-26T23:08:29Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:09:32Z' class='post-time'>
              July 31, 2016,  4:09pm
            </time>
        <span itemprop='position'>#16</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>region size really doesnt matter at this point</p>
<p>could use different sizes depending on height or somethin</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-27T01:44:33Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:09:37Z' class='post-time'>
              July 31, 2016,  4:09pm
            </time>
        <span itemprop='position'>#17</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="11" data-topic="337921">
<div class="title">
<div class="quote-controls"></div>
 object:</div>
<blockquote>
<p>As far as I know, the client only renders the entities that have / has (whatever) been sent to it since the last tick-update - and removes all the others. Atleast that’s what I discovered in RSC. So this means, you don’t have to keep track of whom will be removed (out of range) etc. Just update what’s currently there. I might have missed some stuff, so if that is the case - please enlighten me. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</blockquote>
</aside>
<p>I don’t know about with RSC, but with RS2 you must explicitly add a player to the local player’s list (there is a whole segment of the update packet where you do that), and you must explicitly remove from the player’s local list. You must also retain the proper order of players added to the list because when you’re not adding/removing players all you’re doing is sending individual blocks (the only way the client knows which player it is is the order in which it received the block).</p>
<blockquote>Also, why would you need to keep your players and / or other entities ordered? What must be ordered is the events sent from different players and / or other entities.</blockquote>
Because the client uses the ordering of which players were added/removed when updating players already in the local list.
<p>[quote=“MrPotatoHead, post:15, topic:337921”]Just trying to get head around the region size and how that effects how many packets are sent. Why use 16x16 and not 8x8 or 32x32?</p>
<p>You’ve said, this is based on visible area, but i’m not sure you understand the visible area.<br>
The visible region is 50x50, NORMALLY reduced by the camera calculations to 16 in front of the player at ground level (it’s dependant on height). So the player at the top of A, say 2 spaces from top, can see everything in the 16x16 region above it since the 2+16 spaces are greater than that player can normally see from the ground. However when higher up the player will see up to 25 tiles in front so with a 16x16 region the player at the top of a will have 7 tiles missing.<br>
I just checked, it’s possible to click 20 tiles in front of the player with an unmodified client.</p>
<p>So now i’ve completely screwed up your 16x16 region system, i’m going to try and work out the packet usage for both bigger AND smaller regions (you can simply subscibe to more regions).<br>
I really do like the idea btw.[/quote]<br>
I’m pretty sure the viewing range is limited to 32x32 (16 tiles in any direction), I haven’t explicitly checked though.<br>
Also, if you’re worried about sizing/etc., just use a quadtree data structure which can resize (by increasing or decreasing the branch depth) regions by splitting one into four equal regions.</p>
<p>The biggest problem would be the ordered list clientside. You could add/remove each player every time manually (as when you add, you automatically update the appearance and other shit of that player immediately after) but that would be using quite a bit more bandwidth and would sort of be “hacking” the player updating system, plus it’d look pretty icky and I’m not sure how well it’d perform. The biggest performance loss of the mainstream (winterlove) implementation of player updating is the add-checking, where it loops through every player in the world (for every player, so it’s worse than O(n^2) performance when you take into account the other looping shit that has to be done) to check if they are within distance and are not in our player list (in which case they need to be added). Most proposed solutions to this include a region or tile system of some sort where every player loops through smaller localized regions instead of the entire game world.</p>
<aside class="quote no-group quote-modified" data-post="10" data-topic="337921">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/lothy/40/51_1.png" class="avatar"> Lothy:</div>
<blockquote>
<p>I might get my hands on some of the code tomorrow (probably from Graham’s release). A part of me thinks that the ordering isn’t overly essential, so I’m keen to check on it.</p>
</blockquote>
</aside>
<p>If you PM me, I can hook you up with some highly object-oriented/polymorphic player updating code which operates via update “requests” for the <span class="hashtag">#459</span> revision that should help you better understand how everything works (as object orientation in programming is pretty much about designing things and making them work the way we think about stuff). It’s pretty cool :P. The ordering is, however, essential. The client has no other way to keep track of which player is which. When you send the update packets for other players, you just loop through every player in the list and send their updated movement and “blocks” (I prefer to call them sectors :P) and there is no other identifying information except for that your list and the client’s list retains the order in which they were added.</p>
<p><span class="bbcode-b">tl;dr:</span> Ordering is crucial.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-27T05:14:17Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:09:54Z' class='post-time'>
              July 31, 2016,  4:09pm
            </time>
        <span itemprop='position'>#18</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="17" data-topic="337921">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/blakeman8192/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> blakeman8192:</div>
<blockquote>
<p>I’m pretty sure the viewing range is limited to 32x32 (16 tiles in any direction), I haven’t explicitly checked though.</p>
</blockquote>
</aside>
<p>50x50 defined by method313. (and checking)<br>
You could always ignore that and decide it’s going to be 32x32 for the sake of simplicity.</p>
<p>Thx for the crash course, interesting reading.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lothy.html'><span itemprop='name'>lothy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-27T10:49:38Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:09:57Z' class='post-time'>
              July 31, 2016,  4:09pm
            </time>
        <span itemprop='position'>#19</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>To me personally, it makes more sense to use a number based on the visible terrain that the player sees. With that said, I’d personally use 32x32 regions.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-27T18:20:27Z'>
            <time itemprop='dateModified' datetime='2016-07-31T16:10:05Z' class='post-time'>
              July 31, 2016,  4:10pm
            </time>
        <span itemprop='position'>#20</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="19" data-topic="337921">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/lothy/40/51_1.png" class="avatar"> Lothy:</div>
<blockquote>
<p>To me personally, it makes more sense to use a number based on the visible terrain that the player sees. With that said, I’d personally use 32x32 regions.</p>
</blockquote>
</aside>
<p>In that case, you’d have to handle map region loading (sent to the client as a packet) separately from server-side region changing.<br>
It wouldn’t be that big of a deal, but it’d be nice to have the server-side map region changing associated with loading new map regions client-side.</p>
      </div>

      <meta itemprop='headline' content='Event based updating?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
      <span itemprop='name'><b><a rel="next" itemprop="url" href="3379214658.html?page=2">next page →</a></b></span>
  </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/event-based-updating/337921 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:10 GMT -->
</html>
