<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/issue-with-hit-counter/207829 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 15:34:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Issue with hit counter - General Programming - moparisthebest.com</title>
    <meta name="description" content="I was writing my own hit counter for a php application and the damn thing just dosn&amp;#39;t seem to want to work, My guestimation is its because of the way im writing to the sql database. I also track ips which I&amp;#39;m going to be&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="207829.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Issue with hit counter&#39;" href="207829.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/issue-with-hit-counter/207829" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/issue-with-hit-counter/207829" />
<meta property="og:title" content="Issue with hit counter" />
<meta name="twitter:title" content="Issue with hit counter" />
<meta property="og:description" content="I was writing my own hit counter for a php application and the damn thing just dosn’t seem to want to work, My guestimation is its because of the way im writing to the sql database. I also track ips which I’m going to be using a cron to truncate the table every evening.  Let me give you a overview of my site layout  $session which is a object given to all users holds a database, and constants object, I know that they are all functioning because it does fine reading and writing other stuff to the..." />
<meta name="twitter:description" content="I was writing my own hit counter for a php application and the damn thing just dosn’t seem to want to work, My guestimation is its because of the way im writing to the sql database. I also track ips which I’m going to be using a cron to truncate the table every evening.  Let me give you a overview of my site layout  $session which is a object given to all users holds a database, and constants object, I know that they are all functioning because it does fine reading and writing other stuff to the..." />
<meta property="article:published_time" content="2008-05-25T00:46:30+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="207829.html">Issue with hit counter</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/silabsoft.html'><span itemprop='name'>silabsoft</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T00:46:30Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:49:43Z' class='post-time'>
              July 30, 2016, 10:49pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I was writing my own hit counter for a php application and the damn thing just dosn’t seem to want to work, My guestimation is its because of the way im writing to the sql database. I also track ips which I’m going to be using a cron to truncate the table every evening.</p>
<p>Let me give you a overview of my site layout</p>
<p>$session which is a object given to all users holds a database, and constants object, I know that they are all functioning because it does fine reading and writing other stuff to the database.</p>
<p>[code]	function addHit($id, $ip){ // id represents page id.<br>
//TBL_hitsip and TBL_hits both refer to tables defined in the constant object.<br>
$q = “SELECT # FROM “.TBL_hitsip.” WHERE id = ‘$id’ AND ip = ‘$ip’”;<br>
$result = mysql_query($q, $this-&gt;connection);<br>
if($result == null){ //if ip is not on the ip database<br>
mysql_query(“INSERT INTO “.TBL_hitsip.” (id, ip) VALUES (’$id’, ‘$ip’)”);<br>
$q = “SELECT hits FROM quote_hits WHERE id = ‘$id’”;<br>
$result = mysql_query($q, $this-&gt;connection);<br>
$data = mysql_fetch_row($result);</p>
<pre><code>		if($data == null){
			$result = mysql_query("INSERT INTO ".TBL_hits." (id, hits) VALUES ('$id', '1')");
			return 1;
		}
		else{	
			$data = mysql_fetch_row($result);
			$data[1]=+1;
			mysql_query("UPDATE ".TBL_hits." SET hits = '$data[1]' WHERE id = '$id'");
			return $data[0];			
		}
		
					
	} // if ip is on the ip database
	$q = "SELECT hits FROM ".TBL_hits." WHERE id = '$id'";
	$result = mysql_query($q, $this-&gt;connection);
	$data = mysql_fetch_row($result);	
	return $data[0];	
}	
</code></pre>
<p>};<br>
[/code]</p>
<p>its writing to the ip table just fine but it will not write to the hits table. Also here is my table structure for both</p>
<p><code>CREATE TABLE `the_ip_table_not_valid_naming` (
  `id` int(10) NOT NULL,
  `ip` varchar(15) collate utf8_unicode_ci NOT NULL,
  PRIMARY KEY  (`id`),
  UNIQUE KEY `ip` (`ip`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;</code></p>
<p><code>CREATE TABLE `the_hits_table_not_valid_naming` (
  `id` int(10) NOT NULL,
  `hits` int(10) NOT NULL,
  PRIMARY KEY  (`id`),
  UNIQUE KEY `hits` (`hits`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;</code></p>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/MastrChief.html'><span itemprop='name'>MastrChief</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T00:56:06Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:49:44Z' class='post-time'>
              July 30, 2016, 10:49pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Try</p>
<p>[code]<br>
function addHit($id, $ip){ // id represents page id.<br>
//TBL_hitsip and TBL_hits both refer to tables defined in the constant object.<br>
$q = “SELECT # FROM <code>".TBL_hitsip."</code> WHERE <code>id</code>=’$id’ AND <code>ip</code>=’$ip’”;<br>
$result = mysql_query($q, $this-&gt;connection);<br>
if($result == null){ //if ip is not on the ip database<br>
mysql_query(“INSERT INTO <code>".TBL_hitsip."</code> (<code>id</code>, <code>ip</code>) VALUES (’$id’, ‘$ip’)”);<br>
$q = “SELECT <code>hits</code> FROM <code>quote_hits</code> WHERE <code>id</code>=’$id’”;<br>
$result = mysql_query($q, $this-&gt;connection);<br>
$data = mysql_fetch_row($result);</p>
<pre><code>		if($data == null){
			$result = mysql_query("INSERT INTO `".TBL_hits."` (`id`, `hits`) VALUES ('$id', '1')");
			return 1;
		}
		else{	
			$data = mysql_fetch_row($result);
			$data[1]=+1;
			mysql_query("UPDATE `".TBL_hits."` SET `hits`='$data[1]' WHERE `id`='$id'");
			return $data[0];			
		}
		
					
	} // if ip is on the ip database
	$q = "SELECT `hits` FROM `".TBL_hits."` WHERE `id`='$id'";
	$result = mysql_query($q, $this-&gt;connection);
	$data = mysql_fetch_row($result);	
	return $data[0];	
}[/code]
</code></pre>
<p>I mainly only removed spaces e.g: WHERE id = ‘$id’, because I remember having problems when I had a space there. If it didn’t help, sorry <img src="../../images/emoji/twitter/confused1bce.png?v=6" title=":confused:" class="emoji" alt=":confused:"></p>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/silabsoft.html'><span itemprop='name'>silabsoft</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T01:00:42Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:49:44Z' class='post-time'>
              July 30, 2016, 10:49pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Still no change, It’s a very weird error because its not throwing any exceptions.</p>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/z.html'><span itemprop='name'>z</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T01:05:48Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:49:44Z' class='post-time'>
              July 30, 2016, 10:49pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>$result = mysql_query($q, $this-&gt;connection);<br>
if($result == null){ //if ip is not on the ip database</p>
<p>You’re checking if a mysql_query is null?</p>
<p>I think you should be checking the mysql_num_rows, not if the mysql_query was successful.</p>
<p>$result = mysql_query($q, $this-&gt;connection);<br>
$rows = mysql_num_rows($result);<br>
if($rows == 0){ //if ip is not on the ip database</p>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/silabsoft.html'><span itemprop='name'>silabsoft</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T01:08:25Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:49:44Z' class='post-time'>
              July 30, 2016, 10:49pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Zachera, post:4, topic:207829”]$result = mysql_query($q, $this-&gt;connection);<br>
if($result == null){ //if ip is not on the ip database</p>
<p>You’re checking if a mysql_query is null?</p>
<p>I think you should be checking the mysql_num_rows, not if the mysql_query was successful.</p>
<p>$result = mysql_query($q, $this-&gt;connection);<br>
$rows = mysql_num_rows($result);<br>
if($rows == 0){ //if ip is not on the ip database[/quote]<br>
wouldn’t that be adding another call to the database, I was under the impression that it will return null if it cannot retrieve anything.</p>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/z.html'><span itemprop='name'>z</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T01:12:55Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:49:45Z' class='post-time'>
              July 30, 2016, 10:49pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Miss Silabsoft, post:5, topic:207829”][quote author=Zachera link=topic=274032.msg2240853#msg2240853 date=1211677548]<br>
$result = mysql_query($q, $this-&gt;connection);<br>
if($result == null){ //if ip is not on the ip database</p>
<p>You’re checking if a mysql_query is null?</p>
<p>I think you should be checking the mysql_num_rows, not if the mysql_query was successful.</p>
<p>$result = mysql_query($q, $this-&gt;connection);<br>
$rows = mysql_num_rows($result);<br>
if($rows == 0){ //if ip is not on the ip database<br>
[/quote]<br>
wouldn’t that be adding another call to the database, I was under the impression that it will return null if it cannot retrieve anything.[/quote]</p>
<p>When you do mysql_num_rows, it checks how many rows were returned. If no rows were found, obviously, the mysql_num_rows value is going to be zero. I would rather check for the amount of rows returned rather than if the query was successful.</p>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/silabsoft.html'><span itemprop='name'>silabsoft</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T01:19:57Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:49:45Z' class='post-time'>
              July 30, 2016, 10:49pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I don’t mind doing it that way except that would cause 2 extra querys would it not, and I’m stressing the database enough with the method as is, Do you know if it does add a query or not?</p>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sppt.html'><span itemprop='name'>sppt</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T01:21:44Z'>
            <time itemprop='dateModified' datetime='2019-02-08T07:23:08Z' class='post-time'>
              February 8, 2019,  7:23am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>mysql_num_rows() shouldn’t add a function</p>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/z.html'><span itemprop='name'>z</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T01:37:52Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:49:47Z' class='post-time'>
              July 30, 2016, 10:49pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>mysql_num_rows works off the mysql_query you just executed. It doesn’t requery the database a second time for the rows.</p>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/silabsoft.html'><span itemprop='name'>silabsoft</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T01:52:34Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:49:48Z' class='post-time'>
              July 30, 2016, 10:49pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I changed it just for the sake of argument however if its writing the ip to the ip database its not failing on the part where it checks the row, its failing on the part of writing the hit to the database which would be</p>
<pre><code class="lang-auto">			$q = "SELECT `hits` FROM `quote_hits` WHERE `id`='$id'";
			$result = mysql_query($q, $this-&gt;connection);
			$data = mysql_fetch_row($result);
			
			if($data == null){
				$result = mysql_query("INSERT INTO `".TBL_hits."` (`id`, `hits`) VALUES ('$id', '1')");
				return 1;
			}
			else{	
				$data = mysql_fetch_row($result);
				$data[1]=+1;
				mysql_query("UPDATE `".TBL_hits."` SET `hits`='$data[1]' WHERE `id`='$id'");
				return $data[1];			
			}
			
			</code></pre>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/MastrChief.html'><span itemprop='name'>MastrChief</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T02:48:30Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:49:52Z' class='post-time'>
              July 30, 2016, 10:49pm
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>You’ll probably want to do it the same way.</p>
<p>[code]<br>
$q = “SELECT <code>hits</code> FROM <code>quote_hits</code> WHERE <code>id</code>=’$id’”;<br>
$result = mysql_query($q, $this-&gt;connection);<br>
$data = mysql_num_rows($result);</p>
<pre><code>		if($data == 0){
			$result = mysql_query("INSERT INTO `".TBL_hits."` (`id`, `hits`) VALUES ('$id', '1')");
			return 1;
		}
		else{	
			$data = mysql_fetch_row($result);
			$data[1]=+1;
			mysql_query("UPDATE `".TBL_hits."` SET `hits`='$data[1]' WHERE `id`='$id'");
			return $data[1];			
		}[/code]</code></pre>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/z.html'><span itemprop='name'>z</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-05-25T03:45:32Z'>
            <time itemprop='dateModified' datetime='2016-07-30T22:50:00Z' class='post-time'>
              July 30, 2016, 10:50pm
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><code>
			$query = mysql_query("SELECT `hits` FROM `quote_hits` WHERE `id`='$id'",$this-&gt;connection);
			$data = mysql_num_rows($query);
			if($data &gt; 0){
				$data = mysql_fetch_row($data);
				$data[1]=+1;
				mysql_query("UPDATE `".TBL_hits."` SET `hits`='$data[1]' WHERE `id`='$id'");
				return $data[1];
			} else {
				$result = mysql_query("INSERT INTO `".TBL_hits."` (`id`, `hits`) VALUES ('$id', 1)");
				return 1;
			}</code></p>
<p>Some cleanup. <img src="../../images/emoji/twitter/slight_smile1bce.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='Issue with hit counter'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/issue-with-hit-counter/207829 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 15:34:05 GMT -->
</html>
