<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/what-zkm-does-to-runescape-for-newbs/295646 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 10:02:27 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>What ZKM does to RuneScape *for newbs* - Runescape - moparisthebest.com</title>
    <meta name="description" content="This thread is dedicated to the newbies who don&amp;#39;t quite understand exactly what ZKM does to runescape :stuck_out_tongue: 

Ok, runescape is obfuscated with several different methods of obfuscation. ZKM only accounts for &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="295646.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;What ZKM does to RuneScape *for newbs*&#39;" href="295646.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/what-zkm-does-to-runescape-for-newbs/295646" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/what-zkm-does-to-runescape-for-newbs/295646" />
<meta property="og:title" content="What ZKM does to RuneScape *for newbs*" />
<meta name="twitter:title" content="What ZKM does to RuneScape *for newbs*" />
<meta property="og:description" content="This thread is dedicated to the newbies who don’t quite understand exactly what ZKM does to runescape 😛  Ok, runescape is obfuscated with several different methods of obfuscation. ZKM only accounts for one: the one that affects control flow.  Code control flow is the path it takes through instructions until it reaches it end. To visit a chunk of code that’s not immediately after it, branch instructions were created. For example, a for loop; after the loop code it has to go back ..." />
<meta name="twitter:description" content="This thread is dedicated to the newbies who don’t quite understand exactly what ZKM does to runescape 😛  Ok, runescape is obfuscated with several different methods of obfuscation. ZKM only accounts for one: the one that affects control flow.  Code control flow is the path it takes through instructions until it reaches it end. To visit a chunk of code that’s not immediately after it, branch instructions were created. For example, a for loop; after the loop code it has to go back ..." />
<meta property="article:published_time" content="2009-08-17T03:22:11+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="295646.html">What ZKM does to RuneScape *for newbs*</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-17T03:22:11Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:07:27Z' class='post-time'>
              July 31, 2016, 10:07am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This thread is dedicated to the newbies who don’t quite understand exactly what ZKM does to runescape <img src="../../images/emoji/twitter/stuck_out_tongueae52.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>Ok, runescape is obfuscated with several different methods of obfuscation. ZKM only accounts for one: the one that affects control flow.</p>
<p>Code control flow is the path it takes through instructions until it reaches it end. To visit a chunk of code that’s not immediately after it, branch instructions were created. For example, a for loop; after the loop code it has to go back to checking the loop condition, and if it is still met, it’ll rejump to the start of the code. The first jump is a unconditional jump; it jumps directly without a condition. The second is a conditional jump, it only jumps under a condition (in this case, the loop condition). Conditions are predicates, or evaluate to truth values.</p>
<p>What ZKM’s flow obfuscator does is go through and find unconditional branches, and give them a condition. The condition is opaque, or has a set, constant truth value when evaluated. Source-code level constructs like a for loop will always use an unconditional branch, but when ZKM goes through and obstructs the flow, the decompiler can’t tell what it was because random jumps now have conditions. ZKM also adds these branches to random places within code with conditions that will always evaluate to being false due to how the code works. To construct these predicates, ZKM creates int or boolean fields that I term flow obstructors. These fields are used to build the constant evaluated value conditions, or opaque predicates, which ZKM compares to zero.</p>
<p>Any range of obstructors could be present in an obfuscated application, and you can find them by checking methods for code that does something similar to:</p>
<pre><code class="lang-auto">obstructor1 = ++obstructor2;</code></pre>
<p>So, to fix the control flow, we must remove constantly-false conditioned branches, and turn constantly-true conditioned branches into unconditional branches.</p>
<p>Note, I don’t think this was very in-depth at all, butt I know from first-hand experience what it feels like to wonder what ZKM actually does, and how we reverse it. Feel free to critique! And hopefully newbs will learn a thing or two <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='What ZKM does to RuneScape *for newbs*'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-17T03:30:35Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:07:27Z' class='post-time'>
              July 31, 2016, 10:07am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Good thread, very interesting read. Post more like this when you get the time. <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>

      <meta itemprop='headline' content='What ZKM does to RuneScape *for newbs*'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Unhandled.html'><span itemprop='name'>Unhandled</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-17T13:37:42Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:07:58Z' class='post-time'>
              July 31, 2016, 10:07am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="1" data-topic="295646">
<div class="title">
<div class="quote-controls"></div>
 oksuper_:</div>
<blockquote>
<p>So, to fix the control flow, we must remove constantly-false conditioned branches, and turn constantly-true conditioned branches into unconditional branches.</p>
</blockquote>
</aside>
<p>Is this possible (easy) with static analysis?</p>
      </div>

      <meta itemprop='headline' content='What ZKM does to RuneScape *for newbs*'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-17T14:36:40Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:08:00Z' class='post-time'>
              July 31, 2016, 10:08am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>yes, partial evaluation up in this bitch</p>
      </div>

      <meta itemprop='headline' content='What ZKM does to RuneScape *for newbs*'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-17T15:43:39Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:08:04Z' class='post-time'>
              July 31, 2016, 10:08am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Unhandled, post:3, topic:295646”][quote author=oksuper_ link=topic=391643.msg2916475#msg2916475 date=1250479331]<br>
So, to fix the control flow, we must remove constantly-false conditioned branches, and turn constantly-true conditioned branches into unconditional branches.<br>
[/quote]<br>
Is this possible (easy) with static analysis?[/quote]</p>
<p>Yep, as a rule of thumb: the branches with the condition obstructor == 0 -&gt; unconditional branch. the branches with condition obstructor != 0 -&gt; remove.</p>
      </div>

      <meta itemprop='headline' content='What ZKM does to RuneScape *for newbs*'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/what-zkm-does-to-runescape-for-newbs/295646 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 10:02:28 GMT -->
</html>
