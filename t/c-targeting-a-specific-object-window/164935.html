<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/c-targeting-a-specific-object-window/164935 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 16:37:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[C#]Targeting a Specific Object/Window - General Programming - moparisthebest.com</title>
    <meta name="description" content="What I&amp;#39;ve been trying to do for a while now, is create something like SCAR&amp;#39;s client window finder. You know, that crosshair that you drag onto an object and it re-defines the co-ords for you. 

Now, I can target basic wi&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="164935.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[C#]Targeting a Specific Object/Window&#39;" href="164935.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/c-targeting-a-specific-object-window/164935" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/c-targeting-a-specific-object-window/164935" />
<meta property="og:title" content="[C#]Targeting a Specific Object/Window" />
<meta name="twitter:title" content="[C#]Targeting a Specific Object/Window" />
<meta property="og:description" content="What I’ve been trying to do for a while now, is create something like SCAR’s client window finder. You know, that crosshair that you drag onto an object and it re-defines the co-ords for you.  Now, I can target basic windows, like Firefox, iTunes, etc. Windows that show up in your task bar and have handle names. However, I’d like to target something like an embedded flash file, so the co-ords (0,0) would be the very bottom left of the flash applet, not the browser.  It also doesn’t HAVE to be in..." />
<meta name="twitter:description" content="What I’ve been trying to do for a while now, is create something like SCAR’s client window finder. You know, that crosshair that you drag onto an object and it re-defines the co-ords for you.  Now, I can target basic windows, like Firefox, iTunes, etc. Windows that show up in your task bar and have handle names. However, I’d like to target something like an embedded flash file, so the co-ords (0,0) would be the very bottom left of the flash applet, not the browser.  It also doesn’t HAVE to be in..." />
<meta property="article:published_time" content="2007-12-15T22:31:14+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="164935.html">[C#]Targeting a Specific Object/Window</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/David-2.html'><span itemprop='name'>David</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2007-12-15T22:31:14Z'>
            <time itemprop='dateModified' datetime='2016-07-30T17:44:40Z' class='post-time'>
              July 30, 2016,  5:44pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>What I’ve been trying to do for a while now, is create something like SCAR’s client window finder. You know, that crosshair that you drag onto an object and it re-defines the co-ords for you.</p>
<p>Now, I can target basic windows, like Firefox, iTunes, etc. Windows that show up in your task bar and have handle names. However, I’d like to target something like an embedded flash file, so the co-ords (0,0) would be the very bottom left of the flash applet, not the browser.</p>
<p>It also doesn’t HAVE to be in C#, I’d just like to see an example of this sort of code so I can learn from it and re-create it.</p>
<p>Thanks in advance</p>
<p>-David</p>
      </div>

      <meta itemprop='headline' content='[C#]Targeting a Specific Object/Window'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ilyaostr9.html'><span itemprop='name'>ilyaostr9</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2007-12-15T22:55:08Z'>
            <time itemprop='dateModified' datetime='2016-07-30T17:44:43Z' class='post-time'>
              July 30, 2016,  5:44pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>IIRC, Kaitnieks did this in Delphi making it snap to the COM-object nearest to/which the crosshair is one by getting a list of COM objects, and choosing the one based on where the crosshair was released.</p>
<p>Sorry if this was too confusing.</p>
      </div>

      <meta itemprop='headline' content='[C#]Targeting a Specific Object/Window'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Freddy1990.html'><span itemprop='name'>Freddy1990</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2007-12-15T23:02:03Z'>
            <time itemprop='dateModified' datetime='2016-07-30T17:44:44Z' class='post-time'>
              July 30, 2016,  5:44pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“io9, post:2, topic:164935”]IIRC, Kaitnieks did this in Delphi making it snap to the COM-object nearest to/which the crosshair is one by getting a list of COM objects, and choosing the one based on where the crosshair was released.</p>
<p>Sorry if this was too confusing.[/quote]</p>
<p>Kaitnieks did this like everyone by using the WindowFromPoint api…</p>
<p>You basically get the coordinates of your cursor with the GetCursorPos api, then you use those x and y coorinates in the WindowFromPoint api to get the handle of the window you’re selecting, then you just use the GetWindowRect api to get the rectangle of the window and just substract the leftupper coordinate of the window from the x and y coordinates returned by the GetCursorPos api… Sec, I’ll write an example…</p>
<p>(Have to reinstall Visual Studio)</p>
      </div>

      <meta itemprop='headline' content='[C#]Targeting a Specific Object/Window'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/David-2.html'><span itemprop='name'>David</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2007-12-15T23:37:30Z'>
            <time itemprop='dateModified' datetime='2016-07-30T17:44:49Z' class='post-time'>
              July 30, 2016,  5:44pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Freddy1990, post:3, topic:164935”][quote author=io9 link=topic=223865.msg1932349#msg1932349 date=1197759308]<br>
IIRC, Kaitnieks did this in Delphi making it snap to the COM-object nearest to/which the crosshair is one by getting a list of COM objects, and choosing the one based on where the crosshair was released.</p>
<p>Sorry if this was too confusing.<br>
[/quote]</p>
<p>Kaitnieks did this like everyone by using the WindowFromPoint api…</p>
<p>You basically get the coordinates of your cursor with the GetCursorPos api, then you use those x and y coorinates in the WindowFromPoint api to get the handle of the window you’re selecting, then you just use the GetWindowRect api to get the rectangle of the window and just substract the leftupper coordinate of the window from the x and y coordinates returned by the GetCursorPos api… Sec, I’ll write an example…</p>
<p>(Have to reinstall Visual Studio)[/quote]</p>
<p>Wow. Thanks so much; If you could write an example that’d be champion of you =)</p>
      </div>

      <meta itemprop='headline' content='[C#]Targeting a Specific Object/Window'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Freddy1990.html'><span itemprop='name'>Freddy1990</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2007-12-16T00:28:45Z'>
            <time itemprop='dateModified' datetime='2016-07-30T17:44:53Z' class='post-time'>
              July 30, 2016,  5:44pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yea, gonna do that right now, it’ll be done in a min or 5 I recon</p>
<p>EDIT: Here you are, have fun coding <img src="../../images/emoji/twitter/wink1bce.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>

      <meta itemprop='headline' content='[C#]Targeting a Specific Object/Window'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/David-2.html'><span itemprop='name'>David</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2007-12-16T00:56:14Z'>
            <time itemprop='dateModified' datetime='2016-07-30T17:44:57Z' class='post-time'>
              July 30, 2016,  5:44pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Freddy; thanks so much for the fast, and precisely to the point answer and example. You’ve really helped me out a lot here  <img src="../../images/emoji/twitter/smiley1bce.png?v=6" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>thanks man.</p>
      </div>

      <meta itemprop='headline' content='[C#]Targeting a Specific Object/Window'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Freddy1990.html'><span itemprop='name'>Freddy1990</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2007-12-16T00:59:37Z'>
            <time itemprop='dateModified' datetime='2016-07-30T17:44:57Z' class='post-time'>
              July 30, 2016,  5:44pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Glad I could help <img src="../../images/emoji/twitter/slight_smile1bce.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='[C#]Targeting a Specific Object/Window'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Exception.html'><span itemprop='name'>Exception</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2007-12-16T01:28:19Z'>
            <time itemprop='dateModified' datetime='2016-07-30T17:45:02Z' class='post-time'>
              July 30, 2016,  5:45pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’m interested to know what your trying to do…A colour clicker in C#?</p>
      </div>

      <meta itemprop='headline' content='[C#]Targeting a Specific Object/Window'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Freddy1990.html'><span itemprop='name'>Freddy1990</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2007-12-16T02:29:22Z'>
            <time itemprop='dateModified' datetime='2016-07-30T17:45:09Z' class='post-time'>
              July 30, 2016,  5:45pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Well, thats a possibility, but this can have millions of purposes…</p>
      </div>

      <meta itemprop='headline' content='[C#]Targeting a Specific Object/Window'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ThatOneServer.html'><span itemprop='name'>ThatOneServer</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-01-05T05:00:10Z'>
            <time itemprop='dateModified' datetime='2016-07-30T18:29:19Z' class='post-time'>
              July 30, 2016,  6:29pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Most likely a screen shot or video maker or if this is runescape-related any type of auto that you can think of</p>
      </div>

      <meta itemprop='headline' content='[C#]Targeting a Specific Object/Window'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/c-targeting-a-specific-object-window/164935 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 16:37:34 GMT -->
</html>
