<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>SecurityManagers and Network control?</title>
    <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897</link>
    <description>I&#39;ve already seen both threads by MITB. One about the [url=http://www.moparisthebest.com/smf/index.php?topic=427763.0]hack me challenge[/url] on his security manager, and the one about him wanting to have [url=http://www.moparisthebest.com/smf/index.php?topic=514882.0]full control over file and network requests[/url].

I&#39;m looking for a way to do the same thing he was, although I&#39;m having a hard time grasping how the security manager works...

I already have the directory set up that I can use for R,W,D, and then for any other file in the system it blocks access, however I want to have the security manager ask the user if they&#39;d like to allow the program access. Either One time only, or for the remainder of the process&#39;s life.

I&#39;m sure it would just be a matter of changing checkPermission? A nudge in the right direction would surely be helpful!

On a side note, the security manager may have been too strict, it was denying read only access for the system fonts, any ideas? The permission&#39;s were the same as MITB&#39;s I think...</description>
    
    <lastBuildDate>Sun, 05 Feb 2012 00:34:27 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>OSX blows indeed.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/11</link>
        <pubDate>Sun, 05 Feb 2012 00:34:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-11</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>I have fixed the issues I had with allowing manual override of my SecurityManager, if you want to allow it it will simply ask the user whether they want to allow a specific permission or not, the entire class is attached for those interested.</p>
<p>I also fixed even more problems with java’s standard library wanting to use reflection, create classloaders and securitymanagers and all sorts of things.  Annoying…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/10</link>
        <pubDate>Sat, 04 Feb 2012 22:30:06 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-10</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@mod_taharok Taharok]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mod_taharok">@mod_taharok</a> wrote:</p>
          <blockquote>
              <p>That’s interesting, I never saw that before.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/9</link>
        <pubDate>Tue, 10 Jan 2012 05:16:37 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-9</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>[quote=“Taharok, post:7, topic:427897”][quote author=Moparisthebest link=topic=530587.msg3875689#msg3875689 date=1325649836]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>That SecurityManager was probably the hardest thing I’ve ever written.  Well not exactly hard, but tedious would certainly be correct.  The permissions the same code asks for on different Operating Systems are different, they are different with each release of the JVM, and as you said, the font issue was very hard to overcome.</p>
<p>I also wanted to put in code to over-ride the set permissions, but even JOptionDialog requires a whole other set of permissions, and the circular requests cause a stack overflow, crashing the program.</p>
<p>You can go ahead and use my SecurityManager if you wish, it’s licensed under the GPL.  You will see how I handled the fonts and such, it should be pretty safe.</p>
</blockquote>
</aside>
<p>That would explain why the option pane wouldn’t work… Is there a way to just run the applets in a sandbox and let the rest of the application run free? I suppose I could do it in a client-server fashion and let the clients run in their own process, which actually solves a memory issue I’ve been running into…</p>
</blockquote>
</aside>
<p>Well if you dynamically define all the applet and related classes, you can do so in a custom ClassLoader like Moparisthebest said. Otherwise, there’s another more complicated solution.</p>
<p>I think I did this in my Oriole server framework I wrote a few years ago. There’s a class in the proprietary sun reflection package for building stack traces. It allows you to get the actual Class object in reverse order of the current execution stack. You could use this to figure out whether any of the applet’s classes are part of that call sequence, and then apply the security manager limitations to the current execution instance.</p>
</blockquote>
</aside>
<p>You don’t have to use proprietary sun classes to get a class stack, I do it in my SecurityManager by only using official APIs.<br>
[/quote]</p>
<p>I’m curious how you did that. Did you just parse the stack trace elements provided by java.lang.Throwable?[/quote]</p>
<p>Right here, it’s a method of SecurityManager:<br>
<a href="http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/SecurityManager.html#getClassContext%28%29" class="onebox" target="_blank">http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/SecurityManager.html#getClassContext()</a></p>
<p>Here is my entire class, if you wish to use it:</p>
<pre><code class="lang-auto">/*
 * Copyright (C) 2010  moparisthebest
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 *
 * Official forums are http://www.moparisthebest.com/smf/
 * Email me at admin@moparisthebest.com , I read it but don't usually respond.
 */

package org.moparscape.security;

import org.moparscape.Debug;

import java.security.Permission;
import java.security.Permissions;
import java.util.Map;

/**
 * Very flexible SecurityManager that restricts permissions based on class loader. Fixes some painful problems with
 * default JVM classes.
 */
public class SecurityManager extends java.lang.SecurityManager {

    // IdentityHashMap is faster than HashMap and better in this case as the ClassLoader is the SAME OBJECT
    // and therefore will compare better and faster with == rather than the .equals() HashMap uses
    private Map&lt;ClassLoader, Permissions&gt; permissionMap = new java.util.IdentityHashMap&lt;ClassLoader, Permissions&gt;();

    // single socket permission that is allowed
    private java.net.SocketPermission allowedSocket = new java.net.SocketPermission("localhost", "connect,accept,resolve");

    // some permissions we need for special cases
    private Permission p1 = new java.lang.RuntimePermission("accessClassInPackage.sun.util.resources");
    private Permission reflectPerm = new java.lang.reflect.ReflectPermission("suppressAccessChecks");
    private Permission classLoaderPerm = new java.lang.RuntimePermission("createClassLoader");

    public void addPermissions(ClassLoader cl, Permissions perms) {
        // if they can't set the SecurityManager, they shouldn't be able to modify this one, so check...
        System.getSecurityManager().checkPermission(new java.lang.RuntimePermission("setSecurityManager"));
        //if the key already exists, just return, we only support setting the permissions once
        if (permissionMap.containsKey(cl))
            return;

        perms.setReadOnly();  // no need for this anymore
        permissionMap.put(cl, perms);
    }

    public void allowSocketTo(String host) {
        // if they can't set the SecurityManager, they shouldn't be able to modify this one, so check...
        System.getSecurityManager().checkPermission(new java.lang.RuntimePermission("setSecurityManager"));
        allowedSocket = new java.net.SocketPermission(host, "connect,accept,resolve");
    }

    /**
     * Throws a &lt;code&gt;SecurityException&lt;/code&gt; if the requested
     * access, specified by the given permission, is not permitted based
     * on the security policy currently in effect.
     * &lt;p/&gt;
     * This method calls &lt;code&gt;AccessController.checkPermission&lt;/code&gt;
     * with the given permission.
     *
     * @param perm the requested permission.
     * @throws SecurityException    if access is not permitted based on
     *                              the current security policy.
     * @throws NullPointerException if the permission argument is
     *                              &lt;code&gt;null&lt;/code&gt;.
     * @since 1.2
     */
    @Override
    public void checkPermission(Permission perm) {
        if (perm == null)
            throw new NullPointerException("Permission cannot be null.");

        // this isn't ready to go live yet, so just return and allow it all
        //if (true) return;

        // we are now going to go through the ClassLoaders of all Classes on the stack
        // if any of them are in perms, then check the permissions, sticking to the most
        // restrictive of the permissions of any class in the stack (if any are false, deny the request)

        // get all classes on stack
        Class c[] = getClassContext();

        // if this is true, the request came from SecurityManager or this class, so allow it.
        // this stops Circularity errors, and is only used when ran as an applet, why the hell?...
        if (c[2].getName().equals("org.moparscape.security.SecurityManager"))
            return;

        //System.out.println("requesting perm: " + perm);

        for (int i = 1; i &lt; c.length; i++) {
            ClassLoader cl = c[i].getClassLoader();

            // getClassLoader() can return null, if it is the bootstrap class
            // loader, since our Map implementation handles nulls, go ahead
            // and ignore whether or not it is null (my tests show speed is the same)
            //if (cl == null)     continue;

            Permissions clPerms = permissionMap.get(cl);
            // if the classloader isn't in our map, we don't have any say on it so continue
            if (clPerms == null)
                continue;

            // if the permissions allows this, continue and avoid all the following time-consuming checks
            // TODO: I've since discovered .implies() is rather slow, so find out what is slower, this or the following...
            if (clPerms.implies(perm))
                continue;

            // 2 exceptions here for java.util.GregorianCalendar, java.util.Calendar, java.text.SimpleDateFormat:
            // java.lang.RuntimePermission accessClassInPackage.sun.util.resources
            // java.lang.reflect.ReflectPermission suppressAccessChecks
            String lastCName = c[i - 1].getName();
            if (((lastCName.startsWith("java.util.") &amp;&amp; lastCName.endsWith("Calendar"))
                    || lastCName.equals("java.text.SimpleDateFormat"))
                    &amp;&amp; (perm.equals(p1) || perm.equals(reflectPerm)))
                return;
            // some more exceptions for when java classes use reflection. why?...
            // also an exception for jsound, we can't just allow loadlibrary.jsound* because there could be malicious
            // code in a custom library named jsoundhacks and it would be allowed to load, so we only allow
            // loadlibrary.jsound* if the next class on the stack is javax.sound.sampled.AudioSystem
            // known examples are jsoundds and jsoundalsa
            if (lastCName.equals("javax.sound.sampled.AudioSystem") &amp;&amp; (perm.equals(reflectPerm) || perm.getName().startsWith("loadLibrary.jsound")))
                return;
            // or sun.java2d.SunGraphics2D for Mac OSX Leopard...
            if (lastCName.equals("java.awt.Component") || lastCName.equals("sun.font.FontDesignMetrics") || lastCName.equals("sun.java2d.SunGraphics2D")) {
                // component uses reflection, and sometimes creates a classloader, yay...
                if (perm.equals(reflectPerm) || perm.equals(classLoaderPerm))
                    return;
                // it also loads about a million fonts, with no platform independent way to handle this, so we are going to kludge it
                // we are going to allow reading (only) of all .ttf files
                if (perm instanceof java.io.FilePermission &amp;&amp; perm.getActions().equals("read")) {
                    String lowName = perm.getName().toLowerCase();
                    // most end with .ttf
                    if (lowName.endsWith(".ttf"))
                        return;
                    // some end with .ttc
                    if (lowName.endsWith(".ttc"))
                        return;
                    // others are named something stupid, like 'ttf-arabeyes', or even 'kochi'
                    // something they all have in common (at least on linux) is they all contain 'font' in the path
                    if (lowName.contains("font"))
                        return;
                }
            }

            // one last check, which I found is very slow
            // if this is the allowed socket, allow it
            if (allowedSocket.implies(perm))
                return;

            // if we get all the way down here, the permission was denied and wasn't an exception, so throw an exception
            System.err.println("denying: " + perm.toString());

            if (Debug.debug()) {
                // class stack for debugging
                for (int x = 1; x &lt; c.length; x++) System.out.println(x + ": " + c[x].getName());

                Thread.dumpStack();
            }

            // otherwise allow is false, throw a SecurityException
            throw new SecurityException("Permission denied: " + perm.toString());
            //return;
        }

    }

    @Override
    public void checkPermission(Permission perm, Object context) {
        // ignore context
        this.checkPermission(perm);
    }

    public static Permissions getClientPermissions(String allowedDir) {
        //printSystemPropertiesExit();
        // java.library.path=/opt/jdk1.6.0_18/jre/lib/i386/server:/opt/jdk1.6.0_18/jre/lib/i386:/opt/jdk1.6.0_18/jre/../lib/i386:.::/usr/java/packages/lib/i386:/lib:/usr/lib
        // to allow recursively everything under allowedDir
        allowedDir += "-";
        Debug.debug("allowedDir: " + allowedDir);
        Permissions permissions = new Permissions();
        //permissions.add(new java.security.AllPermission());

        // only needed when not in a jar
        // will deny this later
        permissions.add(new java.io.FilePermission("./-", "read"));
        permissions.add(new java.net.SocketPermission("graveman.info", "connect,accept,resolve"));
        //questionable
        permissions.add(new RuntimePermission("accessDeclaredMembers"));
        permissions.add(new RuntimePermission("setFactory"));
        permissions.add(new RuntimePermission("loadLibrary.awt"));
        permissions.add(new java.security.SecurityPermission("putProviderProperty.SUN"));
        // very questionable
        permissions.add(new RuntimePermission("modifyThreadGroup"));
        permissions.add(new java.net.NetPermission("getProxySelector"));
        //needed
        String javaHome = System.getProperty("java.home") + "/-";
        permissions.add(new java.io.FilePermission(javaHome, "read"));
        permissions.add(new java.io.FilePermission(allowedDir, "read,write,delete"));
        permissions.add(new java.io.FilePermission(allowedDir.substring(0, allowedDir.length() - 2), "read,write,delete"));
        permissions.add(new java.net.SocketPermission("localhost:1024-", "accept,connect,listen"));
        permissions.add(new java.util.PropertyPermission("socksProxyHost", "read"));
        permissions.add(new java.util.PropertyPermission("line.separator", "read"));
        permissions.add(new java.util.PropertyPermission("java.protocol.handler.pkgs", "read"));
        // java.util.Calendar screwing with things again, write isn't too harmful, it only
        // lasts for the run of that individual JVM
        permissions.add(new java.util.PropertyPermission("user.timezone", "read,write"));
        permissions.add(new java.util.PropertyPermission("user.country", "read"));
        permissions.add(new java.util.PropertyPermission("sun.timezone.ids.oldmapping", "read"));
        permissions.add(new java.util.PropertyPermission("sun.net.inetaddr.ttl", "read"));
        permissions.add(new java.util.PropertyPermission("java.net.useSystemProxies", "read"));
        permissions.add(new java.security.SecurityPermission("getProperty.networkaddress.*"));
        // following needed for networking and file read/write
        // this is OK because we restrict FilePermissions and SocketPermission
        permissions.add(new RuntimePermission("readFileDescriptor"));
        permissions.add(new RuntimePermission("writeFileDescriptor"));

        // asked for with java5 runtime
        permissions.add(new java.util.PropertyPermission("sun.java2d.remote", "read"));

        // the above is sufficient for 317, following is needed for 508
        permissions.add(new java.util.PropertyPermission("user.home", "read"));
        permissions.add(new java.util.PropertyPermission("line.separator", "read"));
        permissions.add(new java.util.PropertyPermission("java.vendor", "read"));
        permissions.add(new java.util.PropertyPermission("java.version", "read"));
        permissions.add(new java.util.PropertyPermission("java.home", "read"));
        permissions.add(new java.util.PropertyPermission("java.class.path", "read"));
        permissions.add(new java.util.PropertyPermission("os.*", "read"));
        permissions.add(new java.util.PropertyPermission("sun.awt.*", "read"));
        permissions.add(new java.util.PropertyPermission("javax.*", "read"));
        permissions.add(new java.awt.AWTPermission("accessEventQueue"));
        permissions.add(new java.net.NetPermission("getCookieHandler"));
        permissions.add(new java.net.NetPermission("getResponseCache"));
        permissions.add(new RuntimePermission("loadLibrary.jsound"));

        // following for OSX leopard
        permissions.add(new java.util.PropertyPermission("socksNonProxyHosts", "read"));
        permissions.add(new java.util.PropertyPermission("sun.java2d.*", "read"));
        permissions.add(new RuntimePermission("accessClassInPackage.sun.text.resources"));
        // apparantly the following isn't in System.getProperty("java.home")? whatever, osx blows...
        permissions.add(new java.io.FilePermission("/System/Library/Frameworks/JavaVM.framework/-", "read"));

        return permissions;
    }

    public static Permissions getServerPermissions(String allowedDir) {
        // basically the same, why not?
        Permissions permissions = getClientPermissions(allowedDir);

        // for 508
        permissions.add(new java.util.PropertyPermission("python.home", "read,write"));
        permissions.add(new java.util.PropertyPermission("java.vm.vendor", "read"));
        permissions.add(new java.util.PropertyPermission("python.home", "read"));

        //System.out.println(permissions.toString());
        return permissions;
    }
}
</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/8</link>
        <pubDate>Tue, 10 Jan 2012 00:45:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-8</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@mod_taharok Taharok]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mod_taharok">@mod_taharok</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:6, topic:427897”][quote author=Taharok link=topic=530587.msg3875597#msg3875597 date=1325645003]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>That SecurityManager was probably the hardest thing I’ve ever written.  Well not exactly hard, but tedious would certainly be correct.  The permissions the same code asks for on different Operating Systems are different, they are different with each release of the JVM, and as you said, the font issue was very hard to overcome.</p>
<p>I also wanted to put in code to over-ride the set permissions, but even JOptionDialog requires a whole other set of permissions, and the circular requests cause a stack overflow, crashing the program.</p>
<p>You can go ahead and use my SecurityManager if you wish, it’s licensed under the GPL.  You will see how I handled the fonts and such, it should be pretty safe.</p>
</blockquote>
</aside>
<p>That would explain why the option pane wouldn’t work… Is there a way to just run the applets in a sandbox and let the rest of the application run free? I suppose I could do it in a client-server fashion and let the clients run in their own process, which actually solves a memory issue I’ve been running into…</p>
</blockquote>
</aside>
<p>Well if you dynamically define all the applet and related classes, you can do so in a custom ClassLoader like Moparisthebest said. Otherwise, there’s another more complicated solution.</p>
<p>I think I did this in my Oriole server framework I wrote a few years ago. There’s a class in the proprietary sun reflection package for building stack traces. It allows you to get the actual Class object in reverse order of the current execution stack. You could use this to figure out whether any of the applet’s classes are part of that call sequence, and then apply the security manager limitations to the current execution instance.<br>
[/quote]</p>
<p>You don’t have to use proprietary sun classes to get a class stack, I do it in my SecurityManager by only using official APIs.[/quote]</p>
<p>I’m curious how you did that. Did you just parse the stack trace elements provided by java.lang.Throwable?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/7</link>
        <pubDate>Mon, 09 Jan 2012 05:24:59 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-7</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>[quote=“Taharok, post:5, topic:427897”][quote author=HcoJustin link=topic=530587.msg3875526#msg3875526 date=1325641401]</p>
<aside class="quote">
<blockquote>
<p>That SecurityManager was probably the hardest thing I’ve ever written.  Well not exactly hard, but tedious would certainly be correct.  The permissions the same code asks for on different Operating Systems are different, they are different with each release of the JVM, and as you said, the font issue was very hard to overcome.</p>
<p>I also wanted to put in code to over-ride the set permissions, but even JOptionDialog requires a whole other set of permissions, and the circular requests cause a stack overflow, crashing the program.</p>
<p>You can go ahead and use my SecurityManager if you wish, it’s licensed under the GPL.  You will see how I handled the fonts and such, it should be pretty safe.</p>
</blockquote>
</aside>
<p>That would explain why the option pane wouldn’t work… Is there a way to just run the applets in a sandbox and let the rest of the application run free? I suppose I could do it in a client-server fashion and let the clients run in their own process, which actually solves a memory issue I’ve been running into…<br>
[/quote]</p>
<p>Well if you dynamically define all the applet and related classes, you can do so in a custom ClassLoader like Moparisthebest said. Otherwise, there’s another more complicated solution.</p>
<p>I think I did this in my Oriole server framework I wrote a few years ago. There’s a class in the proprietary sun reflection package for building stack traces. It allows you to get the actual Class object in reverse order of the current execution stack. You could use this to figure out whether any of the applet’s classes are part of that call sequence, and then apply the security manager limitations to the current execution instance.[/quote]</p>
<p>You don’t have to use proprietary sun classes to get a class stack, I do it in my SecurityManager by only using official APIs.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/6</link>
        <pubDate>Wed, 04 Jan 2012 04:03:56 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-6</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@mod_taharok Taharok]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mod_taharok">@mod_taharok</a> wrote:</p>
          <blockquote>
              <p>[quote=“HcoJustin, post:3, topic:427897”][quote author=Moparisthebest link=topic=530587.msg3874844#msg3874844 date=1325607594]<br>
That SecurityManager was probably the hardest thing I’ve ever written.  Well not exactly hard, but tedious would certainly be correct.  The permissions the same code asks for on different Operating Systems are different, they are different with each release of the JVM, and as you said, the font issue was very hard to overcome.</p>
<p>I also wanted to put in code to over-ride the set permissions, but even JOptionDialog requires a whole other set of permissions, and the circular requests cause a stack overflow, crashing the program.</p>
<p>You can go ahead and use my SecurityManager if you wish, it’s licensed under the GPL.  You will see how I handled the fonts and such, it should be pretty safe.<br>
[/quote]</p>
<p>That would explain why the option pane wouldn’t work… Is there a way to just run the applets in a sandbox and let the rest of the application run free? I suppose I could do it in a client-server fashion and let the clients run in their own process, which actually solves a memory issue I’ve been running into…[/quote]</p>
<p>Well if you dynamically define all the applet and related classes, you can do so in a custom ClassLoader like Moparisthebest said. Otherwise, there’s another more complicated solution.</p>
<p>I think I did this in my Oriole server framework I wrote a few years ago. There’s a class in the proprietary sun reflection package for building stack traces. It allows you to get the actual Class object in reverse order of the current execution stack. You could use this to figure out whether any of the applet’s classes are part of that call sequence, and then apply the security manager limitations to the current execution instance.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/5</link>
        <pubDate>Wed, 04 Jan 2012 02:43:23 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-5</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="3" data-topic="427897">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/hcojustin/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> HcoJustin:</div>
<blockquote>
<p>Is there a way to just run the applets in a sandbox and let the rest of the application run free?</p>
</blockquote>
</aside>
<p>I wish that there was, the closest I have came was the SecurityManager I wrote which lets me control permissions based on which classloader was used to load the code.  If you come up with a better solution, please do let me know.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/4</link>
        <pubDate>Wed, 04 Jan 2012 01:49:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-4</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@HcoJustin HcoJustin]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/hcojustin">@HcoJustin</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:2, topic:427897”]That SecurityManager was probably the hardest thing I’ve ever written.  Well not exactly hard, but tedious would certainly be correct.  The permissions the same code asks for on different Operating Systems are different, they are different with each release of the JVM, and as you said, the font issue was very hard to overcome.</p>
<p>I also wanted to put in code to over-ride the set permissions, but even JOptionDialog requires a whole other set of permissions, and the circular requests cause a stack overflow, crashing the program.</p>
<p>You can go ahead and use my SecurityManager if you wish, it’s licensed under the GPL.  You will see how I handled the fonts and such, it should be pretty safe.[/quote]</p>
<p>That would explain why the option pane wouldn’t work… Is there a way to just run the applets in a sandbox and let the rest of the application run free? I suppose I could do it in a client-server fashion and let the clients run in their own process, which actually solves a memory issue I’ve been running into…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/3</link>
        <pubDate>Wed, 04 Jan 2012 01:43:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-3</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>That SecurityManager was probably the hardest thing I’ve ever written.  Well not exactly hard, but tedious would certainly be correct.  The permissions the same code asks for on different Operating Systems are different, they are different with each release of the JVM, and as you said, the font issue was very hard to overcome.</p>
<p>I also wanted to put in code to over-ride the set permissions, but even JOptionDialog requires a whole other set of permissions, and the circular requests cause a stack overflow, crashing the program.</p>
<p>You can go ahead and use my SecurityManager if you wish, it’s licensed under the GPL.  You will see how I handled the fonts and such, it should be pretty safe.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/2</link>
        <pubDate>Tue, 03 Jan 2012 16:19:54 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-2</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
      <item>
        <title>SecurityManagers and Network control?</title>
        <dc:creator><![CDATA[@HcoJustin HcoJustin]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/hcojustin">@HcoJustin</a> wrote:</p>
          <blockquote>
              <p>I’ve already seen both threads by MITB. One about the <a href="http://www.moparisthebest.com/smf/index.php?topic=427763.0" data-bbcode="true" rel="nofollow noopener">hack me challenge</a> on his security manager, and the one about him wanting to have <a href="http://www.moparisthebest.com/smf/index.php?topic=514882.0" data-bbcode="true" rel="nofollow noopener">full control over file and network requests</a>.</p>
<p>I’m looking for a way to do the same thing he was, although I’m having a hard time grasping how the security manager works…</p>
<p>I already have the directory set up that I can use for R,W,D, and then for any other file in the system it blocks access, however I want to have the security manager ask the user if they’d like to allow the program access. Either One time only, or for the remainder of the process’s life.</p>
<p>I’m sure it would just be a matter of changing checkPermission? A nudge in the right direction would surely be helpful!</p>
<p>On a side note, the security manager may have been too strict, it was denying read only access for the system fonts, any ideas? The permission’s were the same as MITB’s I think…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897/1</link>
        <pubDate>Tue, 03 Jan 2012 13:07:42 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-427897-1</guid>
        <source url="https://forum.moparisthebest.com/t/securitymanagers-and-network-control/427897.rss">SecurityManagers and Network control?</source>
      </item>
  </channel>
</rss>
