<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/auto-null-routing-of-connections/326234 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Auto null routing of connections - Technology - moparisthebest.com</title>
    <meta name="description" content="Hello fellow moparscapers 

I would like a program which temporarily null routes an IP address if it makes multiple connections with my server over a short period of time. I&amp;#39;d like to be able to specify the time the IP w&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="326234.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Auto null routing of connections&#39;" href="326234.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/auto-null-routing-of-connections/326234" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/auto-null-routing-of-connections/326234" />
<meta property="og:title" content="Auto null routing of connections" />
<meta name="twitter:title" content="Auto null routing of connections" />
<meta property="og:description" content="Hello fellow moparscapers  I would like a program which temporarily null routes an IP address if it makes multiple connections with my server over a short period of time. I’d like to be able to specify the time the IP would be null routed for, and the maximum threshold of connections per second, but it doesn’t matter if I can’t.  Does such a program exist? If not, can someone point me in the right direction so I can make it myself? I’d be able to analyse when an IP needs to be blocked, and null ..." />
<meta name="twitter:description" content="Hello fellow moparscapers  I would like a program which temporarily null routes an IP address if it makes multiple connections with my server over a short period of time. I’d like to be able to specify the time the IP would be null routed for, and the maximum threshold of connections per second, but it doesn’t matter if I can’t.  Does such a program exist? If not, can someone point me in the right direction so I can make it myself? I’d be able to analyse when an IP needs to be blocked, and null ..." />
<meta property="article:published_time" content="2010-01-18T14:55:31+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="326234.html">Auto null routing of connections</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/technology.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Technology</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/inertia.html'><span itemprop='name'>inertia</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-01-18T14:55:31Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:08:25Z' class='post-time'>
              July 31, 2016,  2:08pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hello fellow moparscapers</p>
<p>I would like a program which temporarily null routes an IP address if it makes multiple connections with my server over a short period of time. I’d like to be able to specify the time the IP would be null routed for, and the maximum threshold of connections per second, but it doesn’t matter if I can’t.</p>
<p>Does such a program exist? If not, can someone point me in the right direction so I can make it myself? I’d be able to analyse when an IP needs to be blocked, and null route the IP but I don’t have a clue how to monitor the actual connections coming into the server.</p>
<p>ps, this isn’t for integration with the web server software, I want to check connections as soon as they come into the machine so all my applications are protected and unnecessary load isn’t put on each daemon.</p>
      </div>

      <meta itemprop='headline' content='Auto null routing of connections'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Cheese_Police.html'><span itemprop='name'>Cheese_Police</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-01-18T15:23:44Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:08:27Z' class='post-time'>
              July 31, 2016,  2:08pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>If you are looking to null route addresses for hitting specific services, check out <a href="http://www.fail2ban.org/wiki/index.php/Main_Page" data-bbcode="true" rel="nofollow noopener">fail2ban</a> (can be configured to ban using <span class="bbcode-i">route</span> or iptables, etc).  I use it on my server and it’s very effective (not mine, but a friend’s: <a href="http://wos.cvncpu.net/" data-bbcode="true" rel="nofollow noopener">http://wos.cvncpu.net/</a>).</p>
<p>If you are looking to null route addresses for attacking you in general (ddos?), if it’s an effective attack you won’t really be able to do much locally.<br>
I recommend you read up about hardening the ip stack on linux so that in the event you do get hit by a relatively minor attack, you will at least be able to find the offending addresses manually (or find/write a small script to do it) with netstat and nullroute them then.</p>
      </div>

      <meta itemprop='headline' content='Auto null routing of connections'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/inertia.html'><span itemprop='name'>inertia</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-01-18T16:12:15Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:08:33Z' class='post-time'>
              July 31, 2016,  2:08pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yeah I’m trying to protect myself from ddos attacks. They only originate from the random moparscaper, but my webserver (apache) just completely cocks up at the slightest hint of an attack, while the machine itself stays okay. If I null route attacking IPs manually (using the apache logs) this proves very effective, but I’m not active 24/7 and attacks tend to happen when I’m sleeping.</p>
<p>So are there no programs to do this, or do I need to write my own using netstat and route?</p>
      </div>

      <meta itemprop='headline' content='Auto null routing of connections'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Cheese_Police.html'><span itemprop='name'>Cheese_Police</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-01-18T16:28:39Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:08:34Z' class='post-time'>
              July 31, 2016,  2:08pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“inertia, post:3, topic:326234”]Yeah I’m trying to protect myself from ddos attacks. They only originate from the random moparscaper, but my webserver (apache) just completely cocks up at the slightest hint of an attack, while the machine itself stays okay. If I null route attacking IPs manually (using the apache logs) this proves very effective, but I’m not active 24/7 and attacks tend to happen when I’m sleeping.</p>
<p>So are there no programs to do this, or do I need to write my own using netstat and route?[/quote]</p>
<p>Well, now that the actual problem is known, it is easier to give advice.</p>
<ol>
<li>read <a href="http://www.securityfocus.com/infocus/1729" data-bbcode="true" rel="nofollow noopener">http://www.securityfocus.com/infocus/1729</a>, it contains information about SYN attacks and methods of protecting against them.</li>
<li>install and configure <a href="http://www.mydigitallife.info/2007/08/15/install-mod_evasive-for-apache-to-prevent-ddos-attacks/" data-bbcode="true" rel="nofollow noopener">mod_evasive</a> for apache.</li>
</ol>
<p>mod_evasive should be enough but null routing offending addresses is still a good idea.  it will probably be best to save a list of known attackers to a file so you can write some quick scripts to apply/remove them (if you’re going to do it like this, i would recommend using iptables over route).</p>
      </div>

      <meta itemprop='headline' content='Auto null routing of connections'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Speljohan.html'><span itemprop='name'>Speljohan</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-01-18T16:46:57Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:08:37Z' class='post-time'>
              July 31, 2016,  2:08pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Get rid of apache, get lighttpd</p>
      </div>

      <meta itemprop='headline' content='Auto null routing of connections'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/eczema3.html'><span itemprop='name'>eczema3</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-01-18T16:49:22Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:08:38Z' class='post-time'>
              July 31, 2016,  2:08pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>If you did install iptables:</p>
<p><code>#!/bin/bash
if [ ! $# == 1 ]; then
        echo "Usage: $0 &lt;ip&gt;"
else
        iptables --append INPUT --source $1 -j DROP
        echo "Nullrouted $1"
fi
</code></p>
<p>chmod +x script.sh<br>
./script.sh </p>
      </div>

      <meta itemprop='headline' content='Auto null routing of connections'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Mopman.html'><span itemprop='name'>Mopman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-02-05T14:42:10Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:33:27Z' class='post-time'>
              July 31, 2016,  2:33pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>except that doesn’t do what he asked, at all</p>
      </div>

      <meta itemprop='headline' content='Auto null routing of connections'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-02-05T22:12:30Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:33:42Z' class='post-time'>
              July 31, 2016,  2:33pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="5" data-topic="326234">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/speljohan/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> Speljohan:</div>
<blockquote>
<p>Get rid of apache, get lighttpd</p>
</blockquote>
</aside>
      </div>

      <meta itemprop='headline' content='Auto null routing of connections'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-02-05T22:18:16Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:33:42Z' class='post-time'>
              July 31, 2016,  2:33pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>mod_evasive does exactly what you want at the web server level, I used to use it on apache and I now use it on lighttpd, it works much better on lighttpd.</p>
      </div>

      <meta itemprop='headline' content='Auto null routing of connections'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/auto-null-routing-of-connections/326234 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:40 GMT -->
</html>
