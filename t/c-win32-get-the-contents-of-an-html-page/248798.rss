<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[C++][Win32] Get the contents of an HTML page</title>
    <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798</link>
    <description>[code]#include &quot;stdafx.h&quot;
#include &lt;windows.h&gt;
#include &lt;wininet.h&gt;
#pragma comment(lib,&quot;wininet.lib&quot;)
#include &lt;string&gt;
using namespace std;

LPCTSTR GetPage(LPCSTR server, LPCSTR path)
{
	DWORD dwRead;
	HINTERNET hSession = InternetOpen(&quot;GetPage/1.0&quot;,INTERNET_OPEN_TYPE_DIRECT,NULL,NULL,0);
	HINTERNET hConnection = InternetConnect(hSession,server,INTERNET_DEFAULT_HTTP_PORT,&quot;&quot;,&quot;&quot;,INTERNET_SERVICE_HTTP,0,0);
	if(!hConnection)
	{
		MessageBox(NULL,&quot;An error occured while trying to connect to the host specified.&quot;,NULL,MB_OK);
		SetLastError(ERROR_CONNECTION_INVALID);
		return &quot;Error opening site&quot;;
	}
	HINTERNET hData = HttpOpenRequest(hConnection,&quot;GET&quot;,path,NULL,NULL,NULL,INTERNET_FLAG_KEEP_CONNECTION,0);
	HttpSendRequest(hData,NULL,0,NULL,0);
	CHAR pageContents[2048];
	string temp_s;
	while(InternetReadFile(hData,pageContents,255,&amp;dwRead))
	{
		if(dwRead==0)
		{
			break;
		}
		pageContents[dwRead]=0;
		temp_s+=pageContents;
	}
	InternetCloseHandle(hConnection);
	InternetCloseHandle(hSession);
	LPCTSTR retVal = temp_s.c_str();
	return retVal;
}[/code]

This just returns the HTML, it doesn&#39;t do anything to parse it at all.  Read up on WinInet on MSDN if you need an understanding on how this works.  Note that WinInet can only be used for HTTP and FTP.   WinSock is more versatile.</description>
    
    <lastBuildDate>Sun, 14 Dec 2008 12:36:24 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@R.I.P_RSC R.I.P RSC]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/r.i.p_rsc">@R.I.P_RSC</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group quote-modified" data-post="13" data-topic="248798">
<div class="title">
<div class="quote-controls"></div>
 the bank:</div>
<blockquote>
<p>Also, in my eyes, anyone who takes this forum serious is a fucking idiot, like yourself, and insulting Coder xynt just to try and fit in doesn’t make it any better for you.</p>
</blockquote>
</aside>
<p>So everyone trying to keep this forum at least cleaner then moparscape is a retard? I’m sorry, but if you don’t take this place serious, why are you here? Or, why don’t you post nothing but crap? I’ve seen a few of your posts that contain intelligence, so you take this place serious, or you don’t know what it means.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/14</link>
        <pubDate>Sun, 14 Dec 2008 12:36:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-14</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@the_bank the bank]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/the_bank">@the_bank</a> wrote:</p>
          <blockquote>
              <p>[quote=“seand, post:8, topic:248798”]either Cain_ has some special thing against you, SMR, or he just thinks he’s better than you. there can’t be any other explanation, unless he’s on his period, because his reason for flaming is horribly pathetic. i don’t see how he could think he’s better than you, because i can’t really remember the last time he posted anything that was of worth. in fact, i wouldn’t be surprised if he’s never posted a project of his own. i could be mistaken: i doubt that anything he could output would be something not easily forgotten. i would recommend that he pull the stick out of his ass before reading any more of your posts, but usually advice doesn’t sway the retarded majority of the mitb community.</p>
<p>and yes, just in case you weren’t sure, you fall into this category too, Coder xynt. more specifically, you’d fall into a smaller subcategory of much dumber people who we can only hope die without passing their genes on.</p>
<p>don’t be assholes when you post, people. if you don’t want to contribute anything, that’s fine, but you can’t say shit when other people try to contribute. just fuck off.[/quote]Lol.</p>
<p>First off, this is the best read I have had all day.  Thank you.</p>
<p>Anywho, how can you tell someone not to be an asshole after you post all that?</p>
<p>Also, in my eyes, anyone who takes this forum serious is a fucking idiot, like yourself, and insulting Coder xynt just to try and fit in doesn’t make it any better for you.</p>
<p>Cain_ is more intelligent than the both of you, and just because his posts don’t portray it, does not mean it is not a fact.</p>
<p>Also, Java Is My Life, stop back seat modding.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/13</link>
        <pubDate>Sun, 14 Dec 2008 02:27:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-13</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@Cheese_Police c|p]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/cheese_police">@Cheese_Police</a> wrote:</p>
          <blockquote>
              <p>if that was true, then how would they be following the rules if there were none?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/12</link>
        <pubDate>Fri, 12 Dec 2008 17:48:01 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-12</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@Java_Is_My_Life Java Is My Life™]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/java_is_my_life">@Java_Is_My_Life</a> wrote:</p>
          <blockquote>
              <p>I’m not backseat modding. If everyone who followed rules was a backseat modder they’re would be no rules.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/11</link>
        <pubDate>Fri, 12 Dec 2008 17:32:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-11</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@eVokki1 Cowie`]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/evokki1">@eVokki1</a> wrote:</p>
          <blockquote>
              <p>[quote=“Java Is My Life™, post:9, topic:248798”][quote author=Cain_ link=topic=327913.msg2574543#msg2574543 date=1228871901]</p>
<aside class="quote no-group">
<blockquote>
<p>either Cain_ has some special thing against you, SMR, or he just thinks he’s better than you. there can’t be any other explanation, unless he’s on his period, because his reason for flaming is horribly pathetic. i don’t see how he could think he’s better than you, because i can’t really remember the last time he posted anything that was of worth. in fact, i wouldn’t be surprised if he’s never posted a project of his own. i could be mistaken: i doubt that anything he could output would be something not easily forgotten. i would recommend that he pull the stick out of his ass before reading any more of your posts, but usually advice doesn’t sway the retarded majority of the mitb community.</p>
<p>and yes, just in case you weren’t sure, you fall into this category too, Coder xynt. more specifically, you’d fall into a smaller subcategory of much dumber people who we can only hope die without passing their genes on.</p>
<p>don’t be assholes when you post, people. if you don’t want to contribute anything, that’s fine, but you can’t say shit when other people try to contribute. just fuck off.</p>
</blockquote>
</aside>
<p>i mainly come to this forum for laughs, i don’t see any point in posting anything of worth here, so I won’t. Also don’t make assumptions about me when you don’t know me at all (What I do on this forum is meaningless.) It’s perfectly fine for me to ‘say shit’ when other people ‘contribute’ UTTER CRAP. Also thanks, i had a pretty good laugh at that.</p>
<p>edit: Also i wouldn’t judge someone on their posts etc, i don’t think i’m better than him as i cannot judge that, I flame for laughs nothing more nothing less, flaming needs no reason.<br>
[/quote]</p>
<p>Moparisthebest:</p>
<p>[quote]Rule 7:<br>
We don’t make posts that contain not useful information. Posts like “cool”, “lol”, “yeah” and “I agree” don’t contain anything useful for others. We are not fans of off topic, unless it contains something smart or funny. Most of things spammers find funny are actually not funny at all.[/quote][/quote]</p>
<p>Me:</p>
<p>Be quiet and stop trying to be a back seat moderator, especially when you use a rule that doesn’t apply.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/10</link>
        <pubDate>Fri, 12 Dec 2008 15:59:35 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-10</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@Java_Is_My_Life Java Is My Life™]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/java_is_my_life">@Java_Is_My_Life</a> wrote:</p>
          <blockquote>
              <p>[quote=“Cain_”][quote author=seand link=topic=327913.msg2574097#msg2574097 date=1228859719]<br>
either Cain_ has some special thing against you, SMR, or he just thinks he’s better than you. there can’t be any other explanation, unless he’s on his period, because his reason for flaming is horribly pathetic. i don’t see how he could think he’s better than you, because i can’t really remember the last time he posted anything that was of worth. in fact, i wouldn’t be surprised if he’s never posted a project of his own. i could be mistaken: i doubt that anything he could output would be something not easily forgotten. i would recommend that he pull the stick out of his ass before reading any more of your posts, but usually advice doesn’t sway the retarded majority of the mitb community.</p>
<p>and yes, just in case you weren’t sure, you fall into this category too, Coder xynt. more specifically, you’d fall into a smaller subcategory of much dumber people who we can only hope die without passing their genes on.</p>
<p>don’t be assholes when you post, people. if you don’t want to contribute anything, that’s fine, but you can’t say shit when other people try to contribute. just fuck off.<br>
[/quote]</p>
<p>i mainly come to this forum for laughs, i don’t see any point in posting anything of worth here, so I won’t. Also don’t make assumptions about me when you don’t know me at all (What I do on this forum is meaningless.) It’s perfectly fine for me to ‘say shit’ when other people ‘contribute’ UTTER CRAP. Also thanks, i had a pretty good laugh at that.</p>
<p>edit: Also i wouldn’t judge someone on their posts etc, i don’t think i’m better than him as i cannot judge that, I flame for laughs nothing more nothing less, flaming needs no reason.[/quote]</p>
<p>Moparisthebest:</p>
<blockquote>Rule 7:
We don't make posts that contain not useful information. Posts like "cool", "lol", "yeah" and "I agree" don't contain anything useful for others. We are not fans of off topic, unless it contains something smart or funny. Most of things spammers find funny are actually not funny at all.</blockquote>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/9</link>
        <pubDate>Fri, 12 Dec 2008 12:42:09 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-9</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@system system]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/system">@system</a> wrote:</p>
          <blockquote>
              <p>either Cain_ has some special thing against you, SMR, or he just thinks he’s better than you. there can’t be any other explanation, unless he’s on his period, because his reason for flaming is horribly pathetic. i don’t see how he could think he’s better than you, because i can’t really remember the last time he posted anything that was of worth. in fact, i wouldn’t be surprised if he’s never posted a project of his own. i could be mistaken: i doubt that anything he could output would be something not easily forgotten. i would recommend that he pull the stick out of his ass before reading any more of your posts, but usually advice doesn’t sway the retarded majority of the mitb community.</p>
<p>and yes, just in case you weren’t sure, you fall into this category too, Coder xynt. more specifically, you’d fall into a smaller subcategory of much dumber people who we can only hope die without passing their genes on.</p>
<p>don’t be assholes when you post, people. if you don’t want to contribute anything, that’s fine, but you can’t say shit when other people try to contribute. just fuck off.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/8</link>
        <pubDate>Tue, 09 Dec 2008 21:55:19 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-8</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@R.I.P_RSC R.I.P RSC]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/r.i.p_rsc">@R.I.P_RSC</a> wrote:</p>
          <blockquote>
              <p>[quote=“R.I.P RSC, post:3, topic:248798”]I wonder why it would be a few pages down.</p>
<p>Perhaps because the thread starter doesn’t care anymore?</p>
<p>DING DING DING![/quote]</p>
<p>It’s because I can’t report myself, but that post wasn’t really needed.</p>
<p>Kudos to you, suck my r2h! But next time, explain how it works.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/7</link>
        <pubDate>Sat, 06 Dec 2008 10:53:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-7</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:5, topic:248798”]There is nothing wrong with posting of code like this, in fact it’s a good learning exercise.  If I ever wanted to learn the windows API I would have a look at this.[/quote]because the msdn isnt blatantly better…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/6</link>
        <pubDate>Sat, 06 Dec 2008 02:30:19 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-6</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>There is nothing wrong with posting of code like this, in fact it’s a good learning exercise.  If I ever wanted to learn the windows API I would have a look at this.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/5</link>
        <pubDate>Sat, 06 Dec 2008 01:48:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-5</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@suck_my_r2h suck my r2h]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/suck_my_r2h">@suck_my_r2h</a> wrote:</p>
          <blockquote>
              <p>Or because no one had an answer so the thread started didn’t think it was worth the effort of bumping it?</p>
<p>For a community that’s supposed to be friendly to newcomers you seem to go out of your way to discourage people who are trying to be helpful and contribute to Q/A on programming forums - but poorly, seeing as your logic with the whole “thread starter doesn’t care anymore” thing is fallacious - a thread will die when no one is able to answer a question, not when the OP decides he doesn’t need one.  GG</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/4</link>
        <pubDate>Fri, 05 Dec 2008 19:29:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-4</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@R.I.P_RSC R.I.P RSC]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/r.i.p_rsc">@R.I.P_RSC</a> wrote:</p>
          <blockquote>
              <p>I wonder why it would be a few pages down.</p>
<p>Perhaps because the thread starter doesn’t care anymore?</p>
<p>DING DING DING!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/3</link>
        <pubDate>Fri, 05 Dec 2008 15:11:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-3</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@suck_my_r2h suck my r2h]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/suck_my_r2h">@suck_my_r2h</a> wrote:</p>
          <blockquote>
              <p>I saw a thread a few pages down about someone requesting help with a GetPage function in C++.  I didn’t want to bump it so I decided to post my own here.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/2</link>
        <pubDate>Fri, 05 Dec 2008 05:41:01 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-2</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
      <item>
        <title>[C++][Win32] Get the contents of an HTML page</title>
        <dc:creator><![CDATA[@suck_my_r2h suck my r2h]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/suck_my_r2h">@suck_my_r2h</a> wrote:</p>
          <blockquote>
              <p>[code]<span class="hashtag">#include</span> “stdafx.h”<br>
<span class="hashtag">#include</span> &lt;windows.h&gt;<br>
<span class="hashtag">#include</span> &lt;wininet.h&gt;<br>
<span class="hashtag">#pragma</span> comment(lib,“wininet.lib”)<br>
<span class="hashtag">#include</span> <br>
using namespace std;</p>
<p>LPCTSTR GetPage(LPCSTR server, LPCSTR path)<br>
{<br>
DWORD dwRead;<br>
HINTERNET hSession = InternetOpen(“GetPage/1.0”,INTERNET_OPEN_TYPE_DIRECT,NULL,NULL,0);<br>
HINTERNET hConnection = InternetConnect(hSession,server,INTERNET_DEFAULT_HTTP_PORT,"","",INTERNET_SERVICE_HTTP,0,0);<br>
if(!hConnection)<br>
{<br>
MessageBox(NULL,“An error occured while trying to connect to the host specified.”,NULL,MB_OK);<br>
SetLastError(ERROR_CONNECTION_INVALID);<br>
return “Error opening site”;<br>
}<br>
HINTERNET hData = HttpOpenRequest(hConnection,“GET”,path,NULL,NULL,NULL,INTERNET_FLAG_KEEP_CONNECTION,0);<br>
HttpSendRequest(hData,NULL,0,NULL,0);<br>
CHAR pageContents[2048];<br>
string temp_s;<br>
while(InternetReadFile(hData,pageContents,255,&amp;dwRead))<br>
{<br>
if(dwRead==0)<br>
{<br>
break;<br>
}<br>
pageContents[dwRead]=0;<br>
temp_s+=pageContents;<br>
}<br>
InternetCloseHandle(hConnection);<br>
InternetCloseHandle(hSession);<br>
LPCTSTR retVal = temp_s.c_str();<br>
return retVal;<br>
}[/code]</p>
<p>This just returns the HTML, it doesn’t do anything to parse it at all.  Read up on WinInet on MSDN if you need an understanding on how this works.  Note that WinInet can only be used for HTTP and FTP.   WinSock is more versatile.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798/1</link>
        <pubDate>Fri, 05 Dec 2008 03:48:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-248798-1</guid>
        <source url="https://forum.moparisthebest.com/t/c-win32-get-the-contents-of-an-html-page/248798.rss">[C++][Win32] Get the contents of an HTML page</source>
      </item>
  </channel>
</rss>
