<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/heads-invisible-need-help/459787 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 20:02:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Heads Invisible - Need Help - Runescape - moparisthebest.com</title>
    <meta name="description" content="Alright, so I&amp;#39;ve been told that the reason for my heads disappearing whenever i equip any kind of headgear is because my player updating isnt correct. It&amp;#39;s not client side as other other servers will work just fine. I&amp;#39;ve&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="459787.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Heads Invisible - Need Help&#39;" href="459787.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/heads-invisible-need-help/459787" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/heads-invisible-need-help/459787" />
<meta property="og:title" content="Heads Invisible - Need Help" />
<meta name="twitter:title" content="Heads Invisible - Need Help" />
<meta property="og:description" content="Alright, so I’ve been told that the reason for my heads disappearing whenever i equip any kind of headgear is because my player updating isnt correct. It’s not client side as other other servers will work just fine. I’ve also been told to post my update process, which i THINK is this. If anyone can find something wrong and explain why my heads are disappearing when I equip headgear, then please tell me.  [code]private stream updateBlock = new stream(new byte[10000]);  public void updatePlayer(Pl..." />
<meta name="twitter:description" content="Alright, so I’ve been told that the reason for my heads disappearing whenever i equip any kind of headgear is because my player updating isnt correct. It’s not client side as other other servers will work just fine. I’ve also been told to post my update process, which i THINK is this. If anyone can find something wrong and explain why my heads are disappearing when I equip headgear, then please tell me.  [code]private stream updateBlock = new stream(new byte[10000]);  public void updatePlayer(Pl..." />
<meta property="article:published_time" content="2012-09-14T20:52:56+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="459787.html">Heads Invisible - Need Help</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Fox2007.html'><span itemprop='name'>Fox2007</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-09-14T20:52:56Z'>
            <time itemprop='dateModified' datetime='2016-08-04T00:06:34Z' class='post-time'>
              August 4, 2016, 12:06am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Alright, so I’ve been told that the reason for my heads disappearing whenever i equip any kind of headgear is because my player updating isnt correct. It’s not client side as other other servers will work just fine. I’ve also been told to post my update process, which i THINK is this. If anyone can find something wrong and explain why my heads are disappearing when I equip headgear, then please tell me.</p>
<p>[code]private stream updateBlock = new stream(new byte[10000]);<br>
public void updatePlayer(Player plr, stream str) {<br>
updateBlock.currentOffset = 0;</p>
<pre><code>	if (updateRunning &amp;&amp; !updateAnnounced) {
		str.createFrame(114);
		str.writeWordBigEndian(updateSeconds*50/30);
	}

	plr.updateThisPlayerMovement(str);
	boolean saveChatTextUpdate = plr.chatTextUpdateRequired;
	plr.chatTextUpdateRequired = false;
	plr.appendPlayerUpdateBlock(updateBlock);
	plr.chatTextUpdateRequired = saveChatTextUpdate;
	str.writeBits(8, plr.playerListSize);
	int size = plr.playerListSize;
	plr.playerListSize = 0;
	for(int i = 0; i &lt; size; i++) {
		if(plr.didTeleport == false &amp;&amp; plr.withinDistance(plr.playerList[i]) == true) {
			plr.playerList[i].updatePlayerMovement(str);
			plr.playerList[i].appendPlayerUpdateBlock(updateBlock);
			plr.playerList[plr.playerListSize++] = plr.playerList[i];
		} else {
			int id = plr.playerList[i].playerId;
			plr.playerInListBitmap[id&gt;&gt;3] &amp;= ~(1 &lt;&lt; (id&amp;7));
			str.writeBits(1, 1);
			str.writeBits(2, 3);
		}
	}

		if (plr.didTeleport)
		{
			plr.updateVisiblePlayers(); // so if we teleport and we are in our original region we are added back to the list for all the players that can see us
		}

		int[] addPlayers = toIntArray(plr.addPlayerList);
		int addSize = plr.addPlayerSize;

		if (size + addSize &gt; 255)
		{
			addSize = size - 255;
		}

		for (int i = 0; i &lt; addSize; i++)
		{
			int id = addPlayers[i];

			if(players[id] == null || !players[id].isActive || players[id] == plr)
				continue;

			if(!plr.withinDistance(players[id]) || (plr.playerInListBitmap[id &gt;&gt; 3] &amp; (1 &lt;&lt; (id &amp; 7))) != 0)
			{
				continue;
			}

			plr.addNewPlayer(players[id], str, updateBlock);
			plr.addPlayerSize--; // you could just put these in player.java
			plr.addPlayerList.remove((Integer)id); // but for the sake of the tutorial, it's right here.
		}

		if (plr.addPlayerSize &gt; 0)
		{
			plr.addPlayerSize = 0;
			plr.addPlayerList.clear();
		}

	if(updateBlock.currentOffset &gt; 0) {
		str.writeBits(11, 2047);
		str.finishBitAccess();
		str.writeBytes(updateBlock.buffer, updateBlock.currentOffset, 0);
	} else {
		str.finishBitAccess();
	}
	str.endFrameVarSizeWord();
}[/code]
</code></pre>
<p>And this is the update void in the client. Just to make sure it’s right as well. Its small.</p>
<p><code>public void update() {
     handler.updatePlayer(this, outStream);
     handler.updateNPC(this, outStream);
     flushOutStream();
}</code></p>
<p>I hope this is the right block, if not please tell me the correct one and it will be posted. This is the ONLY glitch I have in my server. Whoever fixes will gladly have their name put into the credits of the making.</p>
<p>Thanks<br>
~Fox</p>
      </div>

      <meta itemprop='headline' content='Heads Invisible - Need Help'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/heads-invisible-need-help/459787 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 20:02:40 GMT -->
</html>
