<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/not-a-typical-shops-problem/381215 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Aug 2019 07:21:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Not a typical shops problem - Runescape - moparisthebest.com</title>
    <meta name="description" content="Ok so lets start out with the version which is a z508, I go to buy from any shop and i get dced and the item does not buy. I looked over the shops.java, shophandler, and the npcoptions2.java. None of that seems to have b&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="381215.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Not a typical shops problem&#39;" href="381215.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/not-a-typical-shops-problem/381215" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/not-a-typical-shops-problem/381215" />
<meta property="og:title" content="Not a typical shops problem" />
<meta name="twitter:title" content="Not a typical shops problem" />
<meta property="og:description" content="Ok so lets start out with the version which is a z508, I go to buy from any shop and i get dced and the item does not buy. I looked over the shops.java, shophandler, and the npcoptions2.java. None of that seems to have bad code since i recoded it like 5 times. i get no errors so i think its the packetmanager but i also added all the packet cases in there that i have found on every single tut. i will show my code if someone is willing to help out. Don’t say to use google or the search on forums b..." />
<meta name="twitter:description" content="Ok so lets start out with the version which is a z508, I go to buy from any shop and i get dced and the item does not buy. I looked over the shops.java, shophandler, and the npcoptions2.java. None of that seems to have bad code since i recoded it like 5 times. i get no errors so i think its the packetmanager but i also added all the packet cases in there that i have found on every single tut. i will show my code if someone is willing to help out. Don’t say to use google or the search on forums b..." />
<meta property="article:published_time" content="2011-02-04T20:37:27+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="381215.html">Not a typical shops problem</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Sir_wootness.html'><span itemprop='name'>Sir_wootness</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-04T20:37:27Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:22:22Z' class='post-time'>
              August 1, 2016,  7:22am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Ok so lets start out with the version which is a z508, I go to buy from any shop and i get dced and the item does not buy. I looked over the shops.java, shophandler, and the npcoptions2.java. None of that seems to have bad code since i recoded it like 5 times. i get no errors so i think its the packetmanager but i also added all the packet cases in there that i have found on every single tut. i will show my code if someone is willing to help out. Don’t say to use google or the search on forums because there is no thread for my solution.</p>
<p>packetmanager.java</p>
<p>[code]/*</p>
<ul>
<li>Class PacketManager</li>
<li>
</li>
<li>Version 1.0</li>
<li>
</li>
<li>Sunday, August 17, 2008</li>
<li>
</li>
<li>Created by Palidino76<br>
*/</li>
</ul>
<p>package <a href="http://net.com.codeusa.io/" rel="nofollow noopener">net.com.codeusa.io</a>;</p>
<p>import net.com.codeusa.Server;<br>
import net.com.codeusa.Engine;<br>
import net.com.codeusa.model.Player;<br>
import net.com.codeusa.util.Misc;<br>
import net.com.codeusa.net.packethandler.*;</p>
<p>public class PacketManager {<br>
/*<br>
* Create all the packets for use.<br>
*/<br>
public Walking walk = new Walking();<br>
public ItemOption3 itemOption3 = new ItemOption3();<br>
public PublicChat publicChat = new PublicChat();<br>
public Commands command = new Commands();<br>
public SwitchItems switchItems = new SwitchItems();<br>
public ActionButtons actionButtons = new ActionButtons();<br>
public Equipment equipment = new Equipment();<br>
public ItemOption1 itemOption1 = new ItemOption1();<br>
public ItemOption2 itemOption2 = new ItemOption2();<br>
public ItemOperate itemOperate = new ItemOperate();<br>
public ItemOnItem itemOnItem = new ItemOnItem();<br>
public DropItem dropItem = new DropItem();<br>
public PickupItem pickupItem = new PickupItem();<br>
public PlayerOption1 playerOption1 = new PlayerOption1();<br>
public PlayerOption2 playerOption2 = new PlayerOption2();<br>
public PlayerOption3 playerOption3 = new PlayerOption3();<br>
public NPCAttack npcAttack = new NPCAttack();<br>
public NPCOption1 npcOption1 = new NPCOption1();<br>
public NPCOption2 npcOption2 = new NPCOption2();<br>
public ItemSelect itemSelect = new ItemSelect();<br>
//public ItemSelect2 itemSelect2 = new ItemSelect2();<br>
public ObjectOption1 objectOption1 = new ObjectOption1();<br>
public ObjectOption2 objectOption2 = new ObjectOption2();<br>
public SwitchItems2 switchItems2 = new SwitchItems2();<br>
public ItemOnNPC itemOnNPC = new ItemOnNPC();<br>
public ItemOnObject itemOnObject = new ItemOnObject();</p>
<pre><code>public PacketManager() {
}

/**
 * Handle any packets.
 * &lt;p&gt;Handles all packets within the range of 0 - 255. Not every
 * packet has been setup, you'll have to do some yourself.
 * @param p The Player which the frame should be created for.
 * @param packetId The packet id to handle.
 * @param packetSize The number of bytes the packet contains.
 */
public void parsePacket(Player p, int packetId, int packetSize) {
    if (p == null) {
        return;
    }
    if (p.clickDelay &gt; 0 &amp;&amp; packetId != 222) {
        /*
         * When delayed only allow chatting.
         */
        return;
    }
    switch (packetId) {

   
          case 43:
            p.input.setInput(p.stream.readDWord());
            break;








case 224:
    /**
     * Item on Object
     */
    itemOnObject.createPacket(p);
    break;
    case 115:
        /*
         * This packet is constantly sent almost like a ping to verify the still exists.
         */
        break;
    case 22:
        /*
         * Recieved every time updateReq is set to true.
         */
        p.stream.readDWord(); // Junk? Same value every time.
        break;
case 12:
    /**
     * Item on NPC
     */
    itemOnNPC.addItemOnNPCEvent(p);
    break;
</code></pre>
<p>case 60:<br>
p.objects();<br>
break;<br>
case 253:<br>
int playerId = p.stream.readUnsignedWord();<br>
playerId -= 33024;<br>
playerId = playerId / 256;<br>
playerId++;<br>
if (playerId &lt; 0 || playerId &gt;= Engine.players.length || Engine.players[playerId] == null) {<br>
return;<br>
}<br>
if (Engine.players[playerId].pTrade.getPartner() == p) {<br>
p.pTrade.tradePlayer(Engine.players[playerId]);<br>
}</p>
<pre><code>            break;


case 152:
    itemOption3.handlePacket(p, packetId, packetSize);
break;

    case 99:
        /*
         * Unknown.
         */
        p.stream.readUnsignedWordBigEndianA();
        p.stream.readUnsignedWordA();
        break;
    case 117:
    case 248:
    case 247: // Possibly a packet sent if the login  is successful.
        /*
         * Unknown.
         */
        break;
    case 59:
        /*
         * Send every time you click your mouse.
         */
        p.stream.readUnsignedWord();
        p.stream.readDWord_v1();
        break;
    case 49:
        /*
         * Main map walking.
         */
case 119:
	if (p.interfaceId == 762) {
	p.getActionSender().removeShownInterface(p);
	}
	if(p.interfaceId==335 || p.interfaceId==334 || p.interfaceId==620) {
		p.pTrade.declineTrade();
	}
    case 138:
        walk.handlePacket(p, packetId, packetSize);
        break;
    case 222:
        /*
         * Public chatting.
         */
        publicChat.handlePacket(p, packetId, packetSize);
        break;
        case 107:
        /*
         * When you type text starting with ::, its sent with this packet Id rather than as 
         * Normal chat.
         */
        command.handlePacket(p, packetId, packetSize);
        break;

        case 30:
    long name = p.getByteVector().readQWord();
    if(p.friends.size() &gt;= 200) {
            p.getActionSender().sendMessage(p, "Your friends list is full.");
	break;
    }
    if(p.friends.contains((Long) name)) {
            p.getActionSender().sendMessage(p, "Already on your friends list.");
	break;
    }
    p.friends.add((Long) name);
    p.getActionSender().sendFriend(p, name, p.getWorld(name));
    break;

case 61:
    name = p.getByteVector().readQWord();
    if(p.ignores.size() &gt;= 100) {
            p.getActionSender().sendMessage(p, "Your ignore list is full.");
	break;
    }
    if(p.ignores.contains((Long) name)) {
            p.getActionSender().sendMessage(p, "Already on your ignore list.");
	break;
    }
    p.ignores.add((Long) name);
    break;

case 132:
    name = p.getByteVector().readQWord();
    p.friends.remove((Long) name);
    break;

        case 195:
                int itemId = p.getByteVector().readUnsignedWord();
	    System.out.println(itemId);
	    break;

case 2:
    name = p.getByteVector().readQWord();
    p.ignores.remove((Long) name);
    break;

    case 178:
        name = p.stream.readQWord();
    int numChars = p.stream.readUnsignedByte();
</code></pre>
<p>String stringshiz = String.valueOf(’\u0022’);<br>
String a = (“x”);<br>
String text = Misc.decryptPlayerChat(p.stream, numChars);<br>
for(Player p2 : Engine.players) {<br>
if(p2 != null &amp;&amp; p2.online) {<br>
if(Misc.stringToLong(p2.username) == name) {<br>
if (text.contains(stringshiz)) {<br>
return;<br>
}<br>
if (text.contains("&gt;") || text.contains("&lt;") || text.contains("^") || text.contains("@") || text.contains("#") || text.contains(")") || text.contains("(") || text.contains("!") || text.contains("?") || text.contains(":") || text.contains(";") || text.contains("$") || text.contains("%") || text.contains("&amp;") || text.contains("*") || text.contains("_") || text.contains("+") || text.contains("}") || text.contains("{") || text.contains("?")) {<br>
return;<br>
}<br>
if (a.length() &gt; 10) {<br>
return;<br>
}<br>
p2.getActionSender().sendReceivedPrivateMessage(p2, Misc.stringToLong(p.username), p.rights, text);<br>
p.getActionSender().sendSentPrivateMessage(p, name, text);<br>
return;<br>
}<br>
}<br>
}<br>
p.getActionSender().sendMessage(p, “Player is unavailable.”);<br>
break;</p>
<pre><code>    case 167:
        /*
         * Switching items on interfaces.
         */
        switchItems.handlePacket(p, packetId, packetSize);
        break;

         case 233:
    case 113:
    case 21:
    case 169:
    case 232:
	case 214:
	case 90:
	case 173:
	case 133:
	case 226:
	case 102:
        /*
         * When you click an interface button this packet is sent.
         */
        actionButtons.handlePacket(p, packetId, packetSize);
        break;

    case 3:
        /*
         * Equipping an item.
         */
         equipment.handlePacket(p, packetId, packetSize);
         break;
    case 203:
        /*
         * Item options 1.
         */
        itemOption1.handlePacket(p, packetId, packetSize);
        break;
    case 186:
        /*
         * Item operating.
         */
        itemOperate.handlePacket(p, packetId, packetSize);
        break;
    case 211:
        /*
         * Dropping an item.
         */
        dropItem.handlePacket(p, packetId, packetSize);
        break;
    case 201:
        /*
         * Picking an item up.
         */
        pickupItem.handlePacket(p, packetId, packetSize);
        break;
    case 160:
        /*
         * First option on a player.
         */
        playerOption1.handlePacket(p, packetId, packetSize);
        break;
    case 37:
        /*
         * Second option on a player.
         */
      	 playerOption2.handlePacket(p, packetId, packetSize);
       	 break;
    case 227:
        /*
         * Third option on a player.
         */
        playerOption3.handlePacket(p, packetId, packetSize);
        break;
    case 123:
        /*
         * NPC attack option.
         */
        npcAttack.handlePacket(p, packetId, packetSize);
        break;
    case 7:
        /*
         * NPC first option.
         */
        npcOption1.handlePacket(p, packetId, packetSize);
        break;
    case 220:
        /* 
         * Item eating, drinking, etc.
         */
        itemSelect.handlePacket(p, packetId, packetSize);
        break;
    case 158:
        /*
         * Object first option.
         */
        objectOption1.handlePacket(p, packetId, packetSize);
        break;
    case 165:
        /*
         * Settings buttons, such as music volume.
         */
        p.stream.readDWord_v2();
        break;
    case 108:
        /*
         * Remove open interfaces.
         */
        p.getActionSender().removeShownInterface(p);
        break;
    case 228:
        /*
         * Second object option.
         */
        objectOption2.handlePacket(p, packetId, packetSize);
        break;
    case 52:
        /*
         * Second NPC option.
         */
        npcOption2.handlePacket(p, packetId, packetSize);
        break;
    case 38:
        /*
         * Item examining.
         */
        p.getActionSender().sendMessage(p, Engine.items.getItemDescription(p.stream.readUnsignedWordBigEndianA()));
        break;
    case 88:
        /*
         * NPC examining.
         */
        p.getActionSender().sendMessage(p, Server.engine.getNPCDescription(p.stream.readUnsignedWord()));
        break;
    case 84:
        /*
         * Object examining.
         */
        int objectId = p.stream.readUnsignedWordA();
        p.getActionSender().sendMessage(p, "An object.");

        break;
    case 47:
        /*
         * Idle packet.
         */
        break;

case 70: //Magic
	new MagicOnPlayer(p);
break;
        case 24: // Magic on Npc
            new MagicOnNpc(p);
            break;

case 134:
	itemOption2.handlePacket(p, packetId, packetSize);
break;
case 40:
    /**
     * Item on item packet
     */
    itemOnItem.handlePacket(p, packetId, packetSize);
break;
    case 179:
        /*
         * Switching items on interfaces.
         */
        switchItems2.handlePacket(p, packetId, packetSize);
        break;
</code></pre>
<p>case 63:<br>
/**<br>
* First option on options.<br>
*/<br>
new OptionClicking§;<br>
break;<br>
default:<br>
Misc.println("[" + p.username + "] Unhandled packet: " + packetId);<br>
break;<br>
}<br>
}<br>
}[/code]</p>
<p>Wow your all assholes for not helping.</p>
<p>fixed fucking fags…</p>
      </div>

      <meta itemprop='headline' content='Not a typical shops problem'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/not-a-typical-shops-problem/381215 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Aug 2019 07:21:05 GMT -->
</html>
