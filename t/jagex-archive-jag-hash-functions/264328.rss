<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
    <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328</link>
    <description>A few days ago a friend of mine (Tom) tried to create a method too decode &quot;JAG&quot; hash values. At first he tried brute force and then finally came up with a method to decode it without brute force. I joined in and made my own decoder: 

[code]
/**
 * @(#)Hash.java	1.0 Feb 24, 2009
 */

package org.sirox.rstools.jag;

/**
 * @author Joseph Melsha
 * @version 1.0, Feb 24, 2009
 */
public final class Hash
{
	private Hash()
	{
	}

	public static String decode(int j)
	{
		long l = value(j);
		byte b = 0;
		char c;
		long l1;
		for (l1 = l; l1 &gt;= 32L; l1 = l1 / 61L + 31L,b++);
		byte b1;
		long l2;
		long l3 = 0L;
		String s = &quot;&quot;;
		for (byte b2 = 1; b2 &lt; b; b2++)
		{
			for (b1 = (byte) (b2 + 1),l1 = l; b1 &lt; b; b1++,l1 = l1 / 61L + 31L);
			l2 = l1;
			l3 *= 61L;
			if (l3 != 0L)
				l2 -= l3;

			l3 = l1 - 32L;
			c = (char) l2;
			if (b2 == b - 2)
				c++;
			else if (b2 == b - 1)
				c -= 29;

			s += c;
		}

		return s;
	}

	private static long value(int j)
	{
		long l;
		for (l = j + 0xffffffffL; (int) l != j; l += 0xffffffffL);
		return l;
	}

	public static int encode(String s)
	{
		if (s == null)
			throw new NullPointerException();

		int j = 0;
		for (int i = 0; i &lt; s.length(); i++)
			j = (j * 61 + Character.toUpperCase(s.charAt(i))) - 32;

		return j;
	}
}

[/code]

Working version of mine (only can decode Strings that are smaller or equal to the length of 6:

[code]
/**
 * @(#)Hash.java	1.0 Feb 24, 2009
 */

package org.sirox.rstools.jag;

/**
 * @author Joseph Melsha
 * @version 1.0, Feb 24, 2009
 */
public final class Hash
{
	private Hash()
	{
	}

	public static String decode(int j)
	{
		long l = j;
		if (j &lt; 0)
			l += 0xffffffffL;

		byte b = 0;
		char c;
		long l1;
		for (l1 = l; l1 &gt;= 32L; l1 = l1 / 61L + 31L,b++);
		byte b1;
		long l2;
		long l3 = 0L;
		String s = &quot;&quot;;
		for (byte b2 = 1; b2 &lt; b; b2++)
		{
			for (b1 = (byte) (b2 + 1),l1 = l; b1 &lt; b; b1++,l1 = l1 / 61L + 31L);
			l2 = l1;
			l3 *= 61L;
			if (l3 != 0L)
				l2 -= l3;

			l3 = l1 - 32L;
			c = (char) l2;
			if (b2 == b - 2)
				c++;
			else if (b2 == b - 1)
				c -= 29;

			s += c;
		}

		return s;
	}

	public static int encode(String s)
	{
		if (s == null)
			throw new NullPointerException();

		int j = 0;
		for (int i = 0; i &lt; s.length(); i++)
			j = (j * 61 + Character.toUpperCase(s.charAt(i))) - 32;

		return j;
	}
}

[/code]

Original by Tom: 
(Only method that was made by Tom in this class is reverseHash(int))

[code]
package com.auradevil;

public final class Crack
{
	public static void main(String[] args)
	{
		int j = hashValueOf(&quot;DATA&quot;);
		System.out.println(reverseHash(j));
	}

	private static string reverseHash(int hash)
	{
		int strLen = 0;
		int tmpHash = hash;
		int lastSolve = 0;
		int y = 0;
		while (tmpHash &gt;= 32)
		{
			tmpHash /= 61;
			tmpHash += 31;
			strLen++;
		}
		strLen--;
		tmpHash = hash;
		char[] out = new char[strLen];
		for (int x = 0; x &lt; strLen; x++)
		{
			tmpHash = hash;
			for (int i = x + 1; i &lt; strLen; i++)
			{
				tmpHash /= 61;
				tmpHash += 31;
			}

			int res = tmpHash;
			lastSolve *= 61;
			if (lastSolve != 0)
				res -= lastSolve;

			lastSolve = tmpHash - 32;
			out[x] = (char) res;
			if (x == strLen - 2)
				out[x]++;

			if (x == strLen - 1)
				out[x] -= 29;

		}

		return String.valueOf(out);
	}

	public static int hashValueOf(String s)
	{
		if (s == null)
			throw new NullPointerException();

		int j = 0;
		for (int i = 0; i &lt; s.length(); i++)
			j = (j * 61 + Character.toUpperCase(s.charAt(i))) - 32;

		return j;
	}
}

[/code]

( This summary is going to be fairly short because I&#39;m a bit tired =\ )
I did figure out how to get the actual hash value from the hash stored in the RS &quot;JAG&quot; archives. I&#39;m still trailing on how to pick out the value from the value(int) method, but I have tested that it is scanning over the actual hash value but I&#39;m unable to pick it out correctly. My decoder can currently only work on strings shorter or equal to the length of 5 (same with Tom&#39;s). Mine may not work because I have been fooling with trying to get the actual hash value. I will be adding more to this later after I get some sleep.</description>
    
    <lastBuildDate>Fri, 27 Feb 2009 01:46:16 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@TeleNubby TeleNubby]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/telenubby">@TeleNubby</a> wrote:</p>
          <blockquote>
              <p>[quote=“Miss Silabsoft, post:20, topic:264328”][quote author=Taharok link=topic=349074.msg2686106#msg2686106 date=1235686772]</p>
<aside class="quote no-group">
<blockquote>
<aside class="quote no-group">
<blockquote>
<p>note: even for this tiny example your code takes 5 seconds to run.<br>
[/quote]Wow, that’s slow. I’d rather setup a database with 10000 entires of these “hashes” than use this.</p>
</blockquote>
</aside>
<p>Which you’re already doing.</p>
</blockquote>
</aside>
<p>There is no reason to really reverse the hash in the first place.[/quote]True story^</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/22">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/22</link>
        <pubDate>Fri, 27 Feb 2009 01:46:16 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-22</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@mod_taharok Taharok]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mod_taharok">@mod_taharok</a> wrote:</p>
          <blockquote>
              <p>[quote=“Miss Silabsoft, post:20, topic:264328”][quote author=Taharok link=topic=349074.msg2686106#msg2686106 date=1235686772]</p>
<aside class="quote no-group">
<blockquote>
<aside class="quote no-group">
<blockquote>
<p>note: even for this tiny example your code takes 5 seconds to run.<br>
[/quote]Wow, that’s slow. I’d rather setup a database with 10000 entires of these “hashes” than use this.</p>
</blockquote>
</aside>
<p>Which you’re already doing.</p>
</blockquote>
</aside>
<p>There is no reason to really reverse the hash in the first place.[/quote]</p>
<p>He still isn’t reversing the hash, as hashes are obviously irreversible. Storing 10k hash values &gt; bruteforcing the value imo.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/21">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/21</link>
        <pubDate>Fri, 27 Feb 2009 00:11:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-21</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@silabsoft RuneAgent]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/silabsoft">@silabsoft</a> wrote:</p>
          <blockquote>
              <p>[quote=“Taharok, post:19, topic:264328”][quote author=TeleNubby link=topic=349074.msg2686010#msg2686010 date=1235682968]</p>
<aside class="quote no-group">
<blockquote>
<p>note: even for this tiny example your code takes 5 seconds to run.<br>
[/quote]Wow, that’s slow. I’d rather setup a database with 10000 entires of these “hashes” than use this.</p>
</blockquote>
</aside>
<p>Which you’re already doing.[/quote]<br>
There is no reason to really reverse the hash in the first place.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/20">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/20</link>
        <pubDate>Fri, 27 Feb 2009 00:08:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-20</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@mod_taharok Taharok]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mod_taharok">@mod_taharok</a> wrote:</p>
          <blockquote>
              <p>[quote=“TeleNubby, post:17, topic:264328”][quote author=frank_ link=topic=349074.msg2685576#msg2685576 date=1235664304]<br>
note: even for this tiny example your code takes 5 seconds to run.<br>
[/quote]Wow, that’s slow. I’d rather setup a database with 10000 entires of these “hashes” than use this.[/quote]</p>
<p>Which you’re already doing.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/19</link>
        <pubDate>Thu, 26 Feb 2009 22:19:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-19</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@Killer-99-pkz Killer-99-pkz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/killer-99-pkz">@Killer-99-pkz</a> wrote:</p>
          <blockquote>
              <p>[quote=“frank_, post:16, topic:264328”][quote author=Killer-99-pkz link=topic=349074.msg2685539#msg2685539 date=1235660918]<br>
no i figured out how to turn the over flowed int into the actual value as seen in the method value(int)<br>
[/quote]</p>
<p>considering it doesnt work for a single character…</p>
<p><code>        String msg = "S";
        int i = encode(msg);
        String s = decode(i);
        System.out.printf("\"%s\" -&gt; %d -&gt; \"%s\"%n", msg, i, s);</code>[quote]“S” -&gt; 51 -&gt; “”[/quote]…what hope has it got for anything else?</p>
<p>note: even for this tiny example your code takes 5 seconds to run.[/quote]</p>
<p>Yes because it’s not finished. It’s generating the value the actual output was but it’s not selecting it properly and also I don’t know how to check if the value is overflowed or not. I have a good idea how to check if it’s overflowed but it’s a bit shaky.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/18</link>
        <pubDate>Thu, 26 Feb 2009 22:06:57 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-18</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@TeleNubby TeleNubby]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/telenubby">@TeleNubby</a> wrote:</p>
          <blockquote>
              <p>[quote=“frank_, post:16, topic:264328”]note: even for this tiny example your code takes 5 seconds to run.[/quote]Wow, that’s slow. I’d rather setup a database with 10000 entires of these “hashes” than use this.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/17</link>
        <pubDate>Thu, 26 Feb 2009 21:16:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-17</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>considering it doesnt work for a single character…</p>
<p><code>        String msg = "S";
        int i = encode(msg);
        String s = decode(i);
        System.out.printf("\"%s\" -&gt; %d -&gt; \"%s\"%n", msg, i, s);</code></p><blockquote>“S” -&gt; 51 -&gt; “”</blockquote>…what hope has it got for anything else?
<p>note: even for this tiny example your code takes 5 seconds to run.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/16</link>
        <pubDate>Thu, 26 Feb 2009 16:05:04 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-16</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@Killer-99-pkz Killer-99-pkz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/killer-99-pkz">@Killer-99-pkz</a> wrote:</p>
          <blockquote>
              <p>no i figured out how to turn the over flowed int into the actual value as seen in the method value(int)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/15</link>
        <pubDate>Thu, 26 Feb 2009 15:08:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-15</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>[quote=“unlimitedorb, post:11, topic:264328”]Hopefully, you have grown up frank_ and realize that x += i is not the same as x = x + i[/quote]wat, i cant be arsed searching for logs that i do not have to find the full context, but judging from what i said at the time you were being retarded and vague</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/14</link>
        <pubDate>Thu, 26 Feb 2009 09:32:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-14</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@unlimitedorb unlimitedorb]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/unlimitedorb">@unlimitedorb</a> wrote:</p>
          <blockquote>
              <p>shhhhhh</p>
<p><img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/13</link>
        <pubDate>Thu, 26 Feb 2009 08:05:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-13</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@silabsoft RuneAgent]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/silabsoft">@silabsoft</a> wrote:</p>
          <blockquote>
              <p>its dated a year ago lol</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/12</link>
        <pubDate>Thu, 26 Feb 2009 08:01:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-12</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@unlimitedorb unlimitedorb]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/unlimitedorb">@unlimitedorb</a> wrote:</p>
          <blockquote>
              <p>[quote=“Miss Silabsoft, post:8, topic:264328”][quote author=frank_ link=topic=349074.msg2683908#msg2683908 date=1235537712]<br>
both of your ways suck, i wrote a decode function that does the exact same thing as yours but it was around 5 lines (silab and newbiehacker may remember it)</p>
<p>it <em>should</em> be possible to obtain the original value despite the int being overflowed</p>
<p>ps, yours is horribly slow<br>
[/quote]</p>
<p><a href="http://pastie.org/169163" class="onebox" target="_blank" rel="nofollow noopener">http://pastie.org/169163</a></p>
<p>[15:47] &lt;frank_&gt; s/bruteforcing/*/<br>
[15:48] &lt;frank_&gt; newbiehacker<code>paste iit [15:48] &lt;newbiehacker</code>&gt; k<br>
[15:48] &lt;newbiehacker<code>&gt; but it sucks omg [15:48] &lt;lawl&gt; lool [15:48] &lt;newbiehacker</code>&gt; <a href="http://pastie.caboo.se/169163" rel="nofollow noopener">http://pastie.caboo.se/169163</a><br>
[15:48] &lt;newbiehacker<code>&gt; lulzy [15:48] &lt;frank_&gt; i dun care, its a hack :P [15:48] &lt;frank_&gt; wow [15:48] &lt;stork&gt; brute forcer ??? [15:48] &lt;frank_&gt; thats 999x longer than i imagined it [15:48] &lt;newbiehacker</code>&gt; rifk</p>
<p>[16:23] &lt;frank_&gt; newbiehacker<code>, yeah [16:23] &lt;frank_&gt; print the hash value [16:23] &lt;frank_&gt; its -ve [16:23] &lt;dafan&gt; int i = 123456; short x = 0; x += i; [16:23] &lt;newbiehacker</code>&gt; dafan, err<br>
[16:23] &lt;frank_&gt; dafan, yeah it will cast then<br>
[16:23] &lt;newbiehacker<code>&gt; but they're the same type [16:23] &lt;frank_&gt; but im using 2 ints [16:23] &lt;newbiehacker</code>&gt; lmfao<br>
[16:24]  x = (short) x + i;<br>
[16:24]  but that’s an example<br>
[16:24]  it will always cast<br>
[16:24] &lt;frank_&gt; dafan, dafan, dafan, you suck<br>
[16:24] &lt;frank_&gt; …</p>
<p>[05:41] &lt;frank_&gt; silabsofttt, its cus da encoded value is 9999x larger than an int, its destroying data and acting like a hash</p>
<p>Franks work was ofcourse on <a href="http://rafb.net" rel="nofollow noopener">rafb.net</a>[/quote]</p>
<p>I remember that conversation. Hopefully, you have grown up frank_ and realize that x += i is not the same as x = x + i</p>
<p>Admittedly, my original argument wasn’t totally convincing, but that was quite a while back, and now I am far wiser. There is a far easier way to present the difference between those two statements.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/11</link>
        <pubDate>Thu, 26 Feb 2009 06:56:10 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-11</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>[quote=“Killer-99-pkz, post:9, topic:264328”]Nice that only works for values that haven’t overflowed the Java integer[/quote]yours doesnt work for an overflowed int, what are you trying to say?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/10</link>
        <pubDate>Thu, 26 Feb 2009 04:21:56 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-10</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@Killer-99-pkz Killer-99-pkz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/killer-99-pkz">@Killer-99-pkz</a> wrote:</p>
          <blockquote>
              <p>Nice that only works for values that haven’t overflowed the Java integer</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/9</link>
        <pubDate>Wed, 25 Feb 2009 22:54:10 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-9</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@silabsoft RuneAgent]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/silabsoft">@silabsoft</a> wrote:</p>
          <blockquote>
              <p>[quote=“frank_, post:5, topic:264328”]both of your ways suck, i wrote a decode function that does the exact same thing as yours but it was around 5 lines (silab and newbiehacker may remember it)</p>
<p>it <em>should</em> be possible to obtain the original value despite the int being overflowed</p>
<p>ps, yours is horribly slow[/quote]</p>
<p><a href="http://pastie.org/169163" class="onebox" target="_blank" rel="nofollow noopener">http://pastie.org/169163</a></p>
<p>[15:47] &lt;frank_&gt; s/bruteforcing/*/<br>
[15:48] &lt;frank_&gt; newbiehacker<code>paste iit [15:48] &lt;newbiehacker</code>&gt; k<br>
[15:48] &lt;newbiehacker<code>&gt; but it sucks omg [15:48] &lt;lawl&gt; lool [15:48] &lt;newbiehacker</code>&gt; <a href="http://pastie.caboo.se/169163" rel="nofollow noopener">http://pastie.caboo.se/169163</a><br>
[15:48] &lt;newbiehacker<code>&gt; lulzy [15:48] &lt;frank_&gt; i dun care, its a hack :P [15:48] &lt;frank_&gt; wow [15:48] &lt;stork&gt; brute forcer ??? [15:48] &lt;frank_&gt; thats 999x longer than i imagined it [15:48] &lt;newbiehacker</code>&gt; rifk</p>
<p>[16:23] &lt;frank_&gt; newbiehacker<code>, yeah [16:23] &lt;frank_&gt; print the hash value [16:23] &lt;frank_&gt; its -ve [16:23] &lt;dafan&gt; int i = 123456; short x = 0; x += i; [16:23] &lt;newbiehacker</code>&gt; dafan, err<br>
[16:23] &lt;frank_&gt; dafan, yeah it will cast then<br>
[16:23] &lt;newbiehacker<code>&gt; but they're the same type [16:23] &lt;frank_&gt; but im using 2 ints [16:23] &lt;newbiehacker</code>&gt; lmfao<br>
[16:24]  x = (short) x + i;<br>
[16:24]  but that’s an example<br>
[16:24]  it will always cast<br>
[16:24] &lt;frank_&gt; dafan, dafan, dafan, you suck<br>
[16:24] &lt;frank_&gt; …</p>
<p>[05:41] &lt;frank_&gt; silabsofttt, its cus da encoded value is 9999x larger than an int, its destroying data and acting like a hash</p>
<p>Franks work was ofcourse on <a href="http://rafb.net" rel="nofollow noopener">rafb.net</a></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/8</link>
        <pubDate>Wed, 25 Feb 2009 08:55:20 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-8</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>i did, it is still crap</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/7</link>
        <pubDate>Wed, 25 Feb 2009 05:29:42 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-7</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@Killer-99-pkz Killer-99-pkz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/killer-99-pkz">@Killer-99-pkz</a> wrote:</p>
          <blockquote>
              <p>[quote=“frank_, post:5, topic:264328”]both of your ways suck, i wrote a decode function that does the exact same thing as yours but it was around 5 lines (silab and newbiehacker may remember it)</p>
<p>it <em>should</em> be possible to obtain the original value despite the int being overflowed</p>
<p>ps, yours is horribly slow[/quote]</p>
<p>Re-read my first post.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/6</link>
        <pubDate>Wed, 25 Feb 2009 05:04:34 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-6</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>both of your ways suck, i wrote a decode function that does the exact same thing as yours but it was around 5 lines (silab and newbiehacker may remember it)</p>
<p>it <em>should</em> be possible to obtain the original value despite the int being overflowed</p>
<p>ps, yours is horribly slow</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/5</link>
        <pubDate>Wed, 25 Feb 2009 04:55:12 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-5</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@Killer-99-pkz Killer-99-pkz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/killer-99-pkz">@Killer-99-pkz</a> wrote:</p>
          <blockquote>
              <p>If it’s negative you can add the max Java integer value (32bit) and subtract the lowest integer value and get the actual positive (you can only do this with 64bit+ number values “long”). But when the hash value is made it is only using 32 bit integers, in order to get the actual value (for longer Strings) you would need to match them up because there normally larger then the 32 bit (Java integer) max value. In a short answer no.<br>
[br][br][size=1]Posted on: February 24, 2009, 09:39:02 pm[/size][hr][quote=“frank_, post:3, topic:264328”]you obviously don’t know what a hash is</p>
<p>ps good luck reversing the encoded values that have overflowed the int[/quote]</p>
<p>I already devised a way to get the actual value as I mentioned in my first post.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/4</link>
        <pubDate>Wed, 25 Feb 2009 03:37:37 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-4</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>you obviously dont know what a hash is</p>
<p>ps good luck reversing the encoded values that have overflowed the int</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/3</link>
        <pubDate>Wed, 25 Feb 2009 03:34:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-3</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@TeleNubby TeleNubby]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/telenubby">@TeleNubby</a> wrote:</p>
          <blockquote>
              <p>I recall somebody telling me it only worked with positive hashes as well. Is this true?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/2</link>
        <pubDate>Wed, 25 Feb 2009 03:31:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-2</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
      <item>
        <title>Jagex Archive (&quot;JAG&quot;) hash functions</title>
        <dc:creator><![CDATA[@Killer-99-pkz Killer-99-pkz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/killer-99-pkz">@Killer-99-pkz</a> wrote:</p>
          <blockquote>
              <p>A few days ago a friend of mine (Tom) tried to create a method too decode “JAG” hash values. At first he tried brute force and then finally came up with a method to decode it without brute force. I joined in and made my own decoder:</p>
<pre><code class="lang-auto">/**
 * @(#)Hash.java	1.0 Feb 24, 2009
 */

package org.sirox.rstools.jag;

/**
 * @author Joseph Melsha
 * @version 1.0, Feb 24, 2009
 */
public final class Hash
{
	private Hash()
	{
	}

	public static String decode(int j)
	{
		long l = value(j);
		byte b = 0;
		char c;
		long l1;
		for (l1 = l; l1 &gt;= 32L; l1 = l1 / 61L + 31L,b++);
		byte b1;
		long l2;
		long l3 = 0L;
		String s = "";
		for (byte b2 = 1; b2 &lt; b; b2++)
		{
			for (b1 = (byte) (b2 + 1),l1 = l; b1 &lt; b; b1++,l1 = l1 / 61L + 31L);
			l2 = l1;
			l3 *= 61L;
			if (l3 != 0L)
				l2 -= l3;

			l3 = l1 - 32L;
			c = (char) l2;
			if (b2 == b - 2)
				c++;
			else if (b2 == b - 1)
				c -= 29;

			s += c;
		}

		return s;
	}

	private static long value(int j)
	{
		long l;
		for (l = j + 0xffffffffL; (int) l != j; l += 0xffffffffL);
		return l;
	}

	public static int encode(String s)
	{
		if (s == null)
			throw new NullPointerException();

		int j = 0;
		for (int i = 0; i &lt; s.length(); i++)
			j = (j * 61 + Character.toUpperCase(s.charAt(i))) - 32;

		return j;
	}
}
</code></pre>
<p>Working version of mine (only can decode Strings that are smaller or equal to the length of 6:</p>
<pre><code class="lang-auto">/**
 * @(#)Hash.java	1.0 Feb 24, 2009
 */

package org.sirox.rstools.jag;

/**
 * @author Joseph Melsha
 * @version 1.0, Feb 24, 2009
 */
public final class Hash
{
	private Hash()
	{
	}

	public static String decode(int j)
	{
		long l = j;
		if (j &lt; 0)
			l += 0xffffffffL;

		byte b = 0;
		char c;
		long l1;
		for (l1 = l; l1 &gt;= 32L; l1 = l1 / 61L + 31L,b++);
		byte b1;
		long l2;
		long l3 = 0L;
		String s = "";
		for (byte b2 = 1; b2 &lt; b; b2++)
		{
			for (b1 = (byte) (b2 + 1),l1 = l; b1 &lt; b; b1++,l1 = l1 / 61L + 31L);
			l2 = l1;
			l3 *= 61L;
			if (l3 != 0L)
				l2 -= l3;

			l3 = l1 - 32L;
			c = (char) l2;
			if (b2 == b - 2)
				c++;
			else if (b2 == b - 1)
				c -= 29;

			s += c;
		}

		return s;
	}

	public static int encode(String s)
	{
		if (s == null)
			throw new NullPointerException();

		int j = 0;
		for (int i = 0; i &lt; s.length(); i++)
			j = (j * 61 + Character.toUpperCase(s.charAt(i))) - 32;

		return j;
	}
}
</code></pre>
<p>Original by Tom:<br>
(Only method that was made by Tom in this class is reverseHash(int))</p>
<pre><code class="lang-auto">package com.auradevil;

public final class Crack
{
	public static void main(String[] args)
	{
		int j = hashValueOf("DATA");
		System.out.println(reverseHash(j));
	}

	private static string reverseHash(int hash)
	{
		int strLen = 0;
		int tmpHash = hash;
		int lastSolve = 0;
		int y = 0;
		while (tmpHash &gt;= 32)
		{
			tmpHash /= 61;
			tmpHash += 31;
			strLen++;
		}
		strLen--;
		tmpHash = hash;
		char[] out = new char[strLen];
		for (int x = 0; x &lt; strLen; x++)
		{
			tmpHash = hash;
			for (int i = x + 1; i &lt; strLen; i++)
			{
				tmpHash /= 61;
				tmpHash += 31;
			}

			int res = tmpHash;
			lastSolve *= 61;
			if (lastSolve != 0)
				res -= lastSolve;

			lastSolve = tmpHash - 32;
			out[x] = (char) res;
			if (x == strLen - 2)
				out[x]++;

			if (x == strLen - 1)
				out[x] -= 29;

		}

		return String.valueOf(out);
	}

	public static int hashValueOf(String s)
	{
		if (s == null)
			throw new NullPointerException();

		int j = 0;
		for (int i = 0; i &lt; s.length(); i++)
			j = (j * 61 + Character.toUpperCase(s.charAt(i))) - 32;

		return j;
	}
}
</code></pre>
<p>( This summary is going to be fairly short because I’m a bit tired =\ )<br>
I did figure out how to get the actual hash value from the hash stored in the RS “JAG” archives. I’m still trailing on how to pick out the value from the value(int) method, but I have tested that it is scanning over the actual hash value but I’m unable to pick it out correctly. My decoder can currently only work on strings shorter or equal to the length of 5 (same with Tom’s). Mine may not work because I have been fooling with trying to get the actual hash value. I will be adding more to this later after I get some sleep.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328/1</link>
        <pubDate>Wed, 25 Feb 2009 03:29:12 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-264328-1</guid>
        <source url="https://forum.moparisthebest.com/t/jagex-archive-jag-hash-functions/264328.rss">Jagex Archive (&quot;JAG&quot;) hash functions</source>
      </item>
  </channel>
</rss>
