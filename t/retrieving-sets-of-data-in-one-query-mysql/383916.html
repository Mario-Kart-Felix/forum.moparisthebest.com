<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/retrieving-sets-of-data-in-one-query-mysql/383916 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 20:03:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Retrieving sets of data in one query [mysql] - General Programming - moparisthebest.com</title>
    <meta name="description" content="EDIT: Probably should start at this post: http://www.moparisthebest.com/smf/index.php/topic,479678.msg3514385.html#msg3514385 

Alright, this is partially hard for me to explain.  I don&amp;#39;t really know if there is a &amp;quot;term&amp;quot;&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="383916.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Retrieving sets of data in one query [mysql]&#39;" href="383916.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/retrieving-sets-of-data-in-one-query-mysql/383916" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/retrieving-sets-of-data-in-one-query-mysql/383916" />
<meta property="og:title" content="Retrieving sets of data in one query [mysql]" />
<meta name="twitter:title" content="Retrieving sets of data in one query [mysql]" />
<meta property="og:description" content="EDIT: Probably should start at this post: http://www.moparisthebest.com/smf/index.php/topic,479678.msg3514385.html#msg3514385  Alright, this is partially hard for me to explain.  I don’t really know if there is a “term” for it, but whatever, heregoes.  I have a table with some data like “string”, “total_views”, “views_in_10min”, “views_in_24hrs”.  I, with one query, want to get the top 5 of “total_views”, “views_in_10min”, “views_in_24hrs”.  I’m finding it rather difficult.  People have been try..." />
<meta name="twitter:description" content="EDIT: Probably should start at this post: http://www.moparisthebest.com/smf/index.php/topic,479678.msg3514385.html#msg3514385  Alright, this is partially hard for me to explain.  I don’t really know if there is a “term” for it, but whatever, heregoes.  I have a table with some data like “string”, “total_views”, “views_in_10min”, “views_in_24hrs”.  I, with one query, want to get the top 5 of “total_views”, “views_in_10min”, “views_in_24hrs”.  I’m finding it rather difficult.  People have been try..." />
<meta property="article:published_time" content="2011-02-25T19:17:24+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="383916.html">Retrieving sets of data in one query [mysql]</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pwnd.html'><span itemprop='name'>Pwnd</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-25T19:17:24Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:47:59Z' class='post-time'>
              August 1, 2016,  7:47am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>EDIT: Probably should start at this post: <a href="http://www.moparisthebest.com/smf/index.php/topic,479678.msg3514385.html#msg3514385" rel="nofollow noopener">http://www.moparisthebest.com/smf/index.php/topic,479678.msg3514385.html#msg3514385</a></p>
<p>Alright, this is partially hard for me to explain.  I don’t really know if there is a “term” for it, but whatever, heregoes.</p>
<p>I have a table with some data like “string”, “total_views”, “views_in_10min”, “views_in_24hrs”.  I, with one query, want to get the top 5 of “total_views”, “views_in_10min”, “views_in_24hrs”.</p>
<p>I’m finding it rather difficult.  People have been trying to show me examples, but I’m just unable to get them.  I was referred to <a href="http://thenoyes.com/littlenoise/?p=36" rel="nofollow noopener">http://thenoyes.com/littlenoise/?p=36</a> but I don’t understand it and cannot apply it to my current problem.</p>
<p>Thanks dawgs</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/eczema3.html'><span itemprop='name'>eczema3</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-25T19:45:20Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:47:59Z' class='post-time'>
              August 1, 2016,  7:47am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>SELECT * FROM <code>table</code> ORDER BY <code>total_views</code>,<code>views_in_10min</code>,<code>views_in_24hrs</code> LIMIT 5;</p>
<p>I think?</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pwnd.html'><span itemprop='name'>Pwnd</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-25T19:51:03Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:48:00Z' class='post-time'>
              August 1, 2016,  7:48am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Not quite lol.</p>
<p>I ended up doing this, as per sppt’s suggestion, but it’s still like me querying the database three separate times (something I would rather not do).</p>
<p>$query = “SELECT id, text FROM likes ORDER BY views DESC” . $limit . " UNION" .<br>
" SELECT id, text FROM likes ORDER BY 10min DESC" . $limit . " UNION" .<br>
" SELECT id, text FROM likes ORDER BY 30min DESC" . $limit;</p>
<p>EDIT: I have the syntax wrong still.</p>
<p>EDIT:<br>
(SELECT id, text FROM likes ORDER BY views DESC LIMIT 0,5) UNION (SELECT id, text FROM likes ORDER BY 10_min DESC LIMIT 0,5) UNION (SELECT id, text FROM likes ORDER BY 30_min DESC LIMIT 0,5)<br>
Only returns 10, but I think I know why lol…  Probably because the 10_min and 30_min data is the same.</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/nade.html'><span itemprop='name'>nade</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-25T21:10:04Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:48:02Z' class='post-time'>
              August 1, 2016,  7:48am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Doesn’t look like your tables are normalized properly. First of all post a relational diagram or the “Describe” of all your tables.</p>
<p>Second of all, you shouldn’t have anything in your table that is along the lines of “views-in-something” if you do that in an IT company prepare to see an empty box on your desk when you come back to work the next day</p>
<p>If anything your table should be like:</p>
<p>[SOME_TEXT]<br>
-id (primary key)<br>
-text</p>
<p>[VIEWS]<br>
-id (foreign key)<br>
-view_date (foreign key)</p>
<p>With the query (psuedo-code):</p>
<pre><code class="lang-auto">Select id, text, view_date from SOME_TEXT inner join VIEWS on SOME_TEXT.id = VIEWS.id WHERE
DATEDIFF( minute, GETDATE( ), Date-10 ) OR DATEDIFF( minute, GETDATE( ), Date-20 ) OR DATEDIFF( minute, GETDATE( ), Date-30 )</code></pre>
<p>And everytime somebody views something you do an INSERT into the views</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pwnd.html'><span itemprop='name'>Pwnd</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-26T04:13:22Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:48:29Z' class='post-time'>
              August 1, 2016,  7:48am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>It’s a single table.  And sorry, not at the professional level when it comes to database management <img src="../../images/emoji/twitter/stuck_out_tongueae52.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>The LITERAL time of the view is redundant, but I think you were just using that as an example.  I just need the counts.</p>
<p>I think creating a new row per view would be ridiculous as well.  I’m not entirely sure how MySQL works, but for some reason I think that would be a huge overhead on retrieving the amount of views.</p>
<p>My table looks like:<br>
id, text, total_views, views_10min, views_30min, views_24hrs</p>
<p>And what I ultimately want to do is get the top (#) of the 3 end view amounts and return the 3 * # in a single query.  I also wish to ignore duplicate data, if that could be weaseled in there without php intervention.</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lawl.html'><span itemprop='name'>lawl</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-26T06:43:07Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:48:33Z' class='post-time'>
              August 1, 2016,  7:48am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>what nade said looks like the proper way to do it to me, but it will probably not scale well. i cant think of any way that will scale well, though</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pwnd.html'><span itemprop='name'>Pwnd</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-26T06:54:06Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:48:34Z' class='post-time'>
              August 1, 2016,  7:48am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“la­wl, post:6, topic:383916”]what nade said looks like the proper way to do it to me, but it will probably not scale well. i cant think of any way that will scale well, though[/quote]It gets done, as far as I know… And what I know is a similar site hands 55k peak users well.</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/NewbieNewty.html'><span itemprop='name'>NewbieNewty</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-26T07:08:39Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:48:37Z' class='post-time'>
              August 1, 2016,  7:48am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a href="http://www.plus2net.com/sql_tutorial/sql_max.php" class="onebox" target="_blank">http://www.plus2net.com/sql_tutorial/sql_max.php</a></p>
<p>I just started using sql again today, needed to do some php/sql db interaction, and I came across the above link.</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pwnd.html'><span itemprop='name'>Pwnd</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-26T10:32:38Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:48:51Z' class='post-time'>
              August 1, 2016,  7:48am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Not quite what I’m looking for, but thanks.</p>
<p>A less “simpler” way of doing sql max would be to order by desc.  That would have been the first thing that would have popped in my head, but I am fail when it comes to this apparently.</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/z.html'><span itemprop='name'>z</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-27T14:26:56Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:50:35Z' class='post-time'>
              August 1, 2016,  7:50am
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Your vague explanation of what you need help with makes it harder for others to understand what you need help with. Maybe you should rewrite the topic and go in-depth about every specific detail so that we can get an understanding? I’ll explain a solution though, based on my interpretation.</p>
<p>It seems like you have a video website where you want to display the most viewed, most viewed in 30 days, etc. The way I explain below will be based on my interpretation, so hopefully you won’t get confused.</p>
<p>Normalizing the database, like nade mentioned, would be the proper solution. While it may seem like you would be overflowing any particular table, you would actually be organizing your data effectively. By normalizing your database, you are organizing your data effectively and connecting pieces together without getting too much data intertwined in one table. It’s very important to separate data into tables effectively in MySQL and connect them with <span class="bbcode-b">foreign keys</span> so that you aren’t getting data result sets with more data than you really need. For example, what if you wanted to get database information for views, but nothing related to the actual video for that view? What if you wanted only video data but no view counts? It’s important to outline what your requirements are and ensure that you’re not getting more data than you need.</p>
<p>A solution to the issue you’re having would simply be to reorganize your table structure(s).<br>
I would suggest you effectively put videos into one table (tbl_Video) and views into another table (tbl_View).<br>
tbl_Video should contain all of the video data, such as VideoID, Title, URL, Uploaded By, DateCreated, etc.<br>
tbl_View should contain all of the view data: ViewID, VideoID, IP, Referer, DateCreated, etc.</p>
<p>I added IP and Referer to tbl_View table to better explain my solution. DateCreated in tbl_Video is vitally necessary, as we’ll be using it in this example.</p>
<p>One of the benefits of MySQL is that you have the ability to specify which columns you want to have in your result set. It’s very crucial to take advantage of this – personally, I never use “SELECT <span class="bbcode-b">*</span> FROM…” – because you will find that it’s a lot easier to get only what you want and nothing more.</p>
<p>With that said, we can now start building our queries. All of it will be explained.</p>
<p>SELECT Video.Title, Video.URL, Video.UploadedBy, Video.DateCreated, COUNT(View.ViewID) AS Views FROM tbl_Video AS Video, tbl_View AS View WHERE View.VideoID = Video.VideoID AND View.DateCreated BETWEEN “2011-01-01” AND “2011-01-31” GROUP BY Video.VideoID</p>
<p>This query selects data from the two tables – Video and View. Each block is explained below.</p>
<p><span class="bbcode-b">SELECT Video.Title, Video.URL, Video.UploadedBy, Video.DateCreated, COUNT(View.ViewID) AS Views</span><br>
We select the video data from the Video table, as well as the amount of Views (by counting the View records returned in the result set).</p>
<p><span class="bbcode-b">FROM tbl_Video AS Video, tbl_View AS View</span><br>
We specify which tables we get data from, then setting them up as ‘Video’ and ‘View’ as their alias (so we don’t have to do SELECT tbl_Video.Title, tbl_Video.URL, etc).</p>
<p><span class="bbcode-b">WHERE View.VideoID = Video.VideoID AND View.DateCreated BETWEEN “2011-01-01” AND “2011-01-31”</span><br>
We be sure to match the Views to the Video as well as selecting a date-range for which the Views were added (or, created).</p>
<p><span class="bbcode-b">GROUP BY Video.VideoID</span><br>
We group the results by VideoID, meaning that each View will go to their respective Video rather than scattering across to the wrong videos.</p>
<p>By utilizing the functionality of normalizing your database structure, you give yourself very specific focuses on which result sets you want and which result sets you don’t want when displaying data on a website. You ultimately avoid redundancy and are left with a structure that allows for flexibility amongst each normalized aspect of the table. Adding new features which are specific to only one of the two tables is better than adding more complexity to simply just one table all by itself.</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pwnd.html'><span itemprop='name'>Pwnd</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-27T20:33:28Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:51:00Z' class='post-time'>
              August 1, 2016,  7:51am
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thanks for that, Zachera.  I thought I’ve explained my issue well enough, but I will do my best here, then yano, put a note say “this post is probably better to read than the entirety of the thread.”</p>
<p>Simply, what I wanted was to see if I could get multiple sets of data in one query, all from the same table.  The sets of data would be relatively the same, just different constraints were added to each set (I.E. get x sets which have the highest views in the past 10 minutes, get x sets which have the highest views in the past 30 minutes, etc.)</p>
<p>We will refer to the sets of data as “likes”.  All it is, is an id and text, mostly.  That is its own table, blah blah blah.</p>
<p>I did rework everything though.  I made it more “normalized”, if that’s the word for it haha.  I have four tables now.<br>
The last 3 are the 10m_views, 30m_views, 24h_views.  They are described as ‘id’, the id of the like, and ‘views’, the amount of views that like has.  It will be incremented (view = view + 1) each time the like is viewed independently.</p>
<p>So, there’s going to be a single record in these three tables per like that will hold the data representing how many views.</p>
<p>I was told that “multiple queries” isn’t necessarily resource intensive, but I figured there was a better way.  This is what I have CURRENTLY:</p>
<p>[code=php]<br>
$queries = array(“SELECT likes.id, text, 10m_views.views FROM likes, 10m_views WHERE likes.id = 10m_views.id ORDER BY views DESC” . $limit,<br>
“SELECT likes.id, text, 30m_views.views FROM likes, 30m_views WHERE likes.id = 30m_views.id ORDER BY views DESC” . $limit,<br>
“SELECT likes.id, text, 24h_views.views FROM likes, 24h_views WHERE likes.id = 24h_views.id ORDER BY views DESC” . $limit<br>
);</p>
<pre><code>	foreach ($queries as $query) {
		$stmt = $pdo-&gt;prepare($query);
		if ($stmt-&gt;execute()) {
			while ($res = $stmt-&gt;fetch(PDO::FETCH_ASSOC)) {
				$arr[] = array($res['id'], $res['text']);
			}		
		}	
		$stmt = NULL;
	}[/code]
</code></pre>
<p>That looks dirty to me, but whatever.  Any input on what I have now or how I described it?</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/z.html'><span itemprop='name'>z</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-02-28T00:15:37Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:51:08Z' class='post-time'>
              August 1, 2016,  7:51am
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The new code doesn’t look dirty. You’ve normalized your database structure a bit more, which is the good part about it, but you should be using one table for all of your view data. This will allow you to choose more ranges of view data when you need it freely accessible.</p>
<p>Following your recent post, I would suggest you make a view table with a timestamp which specifies the time in which that view was initiated. When you want to select a range of the last 10 minutes, you would write the WHERE clause with a <a href="http://www.w3schools.com/sql/sql_between.asp" data-bbcode="true" rel="nofollow noopener">BETWEEN</a> functionality. This will allow you to select views between two timestamps and associate them with the like ID.</p>
<p>10 mins: SELECT likes.id,likes.text,count(views.id) AS view_count FROM likes, views WHERE likes.id = views.likeid AND timestamp BETWEEN <span class="bbcode-b">UNIX_TIMESTAMP()-600</span> AND UNIX_TIMESTAMP() GROUP BY likes.id ORDER BY view_count DESC</p>
<p>30 mins: SELECT likes.id,likes.text,count(views.id) AS view_count FROM likes, views WHERE likes.id = views.likeid AND timestamp BETWEEN <span class="bbcode-b">UNIX_TIMESTAMP()-1800</span> AND UNIX_TIMESTAMP() GROUP BY likes.id ORDER BY view_count DESC</p>
<p>24 hours: SELECT likes.id,likes.text,count(views.id) AS view_count FROM likes, views WHERE likes.id = views.likeid AND timestamp BETWEEN <span class="bbcode-b">UNIX_TIMESTAMP()-86400</span> AND UNIX_TIMESTAMP() GROUP BY likes.id ORDER BY view_count DESC</p>
<p>total: SELECT likes.id,likes.text,count(views.id) AS view_count FROM likes, views WHERE likes.id = views.likeid GROUP BY likes.id ORDER BY view_count DESC</p>
      </div>

      <meta itemprop='headline' content='Retrieving sets of data in one query [mysql]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/retrieving-sets-of-data-in-one-query-mysql/383916 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 20:03:42 GMT -->
</html>
