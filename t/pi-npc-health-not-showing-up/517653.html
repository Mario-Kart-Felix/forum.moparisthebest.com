<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/pi-npc-health-not-showing-up/517653 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 02:06:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[PI] NPC Health Not Showing Up - Runescape - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;ve recently tried adding old school hit splats and it worked except for now the players HP bar above the head is red and the NPC health bar just doesn&amp;#39;t show up.  

[IMG]http://i34.tinypic.com/2utqfza.png[/img] 

This &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="517653.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[PI] NPC Health Not Showing Up&#39;" href="517653.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://i34.tinypic.com/2utqfza.png" />
<meta property="og:image" content="http://i34.tinypic.com/2utqfza.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/pi-npc-health-not-showing-up/517653" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/pi-npc-health-not-showing-up/517653" />
<meta property="og:title" content="[PI] NPC Health Not Showing Up" />
<meta name="twitter:title" content="[PI] NPC Health Not Showing Up" />
<meta property="og:description" content="I’ve recently tried adding old school hit splats and it worked except for now the players HP bar above the head is red and the NPC health bar just doesn’t show up.    This is what I changed:  I commented this out:  [CODE]public void hitmarkDraw(Entity e, int hitLength, int markType, int icon, int damage, int move, int opacity, int focusPlayer, int focusNPC) {  hitLength = 2;  if (damage &gt; 0) {  if(icon &gt; 0 &amp;&amp; icon &lt; hitMarkIcons.length)  hitMarkIcons[icon].drawSprite1(spriteDrawX - 34, spriteDra..." />
<meta name="twitter:description" content="I’ve recently tried adding old school hit splats and it worked except for now the players HP bar above the head is red and the NPC health bar just doesn’t show up.    This is what I changed:  I commented this out:  [CODE]public void hitmarkDraw(Entity e, int hitLength, int markType, int icon, int damage, int move, int opacity, int focusPlayer, int focusNPC) {  hitLength = 2;  if (damage &gt; 0) {  if(icon &gt; 0 &amp;&amp; icon &lt; hitMarkIcons.length)  hitMarkIcons[icon].drawSprite1(spriteDrawX - 34, spriteDra..." />
<meta property="article:published_time" content="2013-04-21T20:26:18+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="517653.html">[PI] NPC Health Not Showing Up</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/DerpaDerpy.html'><span itemprop='name'>DerpaDerpy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-04-21T20:26:18Z'>
            <time itemprop='dateModified' datetime='2016-08-04T07:03:12Z' class='post-time'>
              August 4, 2016,  7:03am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’ve recently tried adding old school hit splats and it worked except for now the players HP bar above the head is red and the NPC health bar just doesn’t show up.</p>
<p><img src="http://i34.tinypic.com/2utqfza.png" alt width="513" height="340"></p>
<p>This is what I changed:</p>
<p>I commented this out:</p>
<p>[CODE]public void hitmarkDraw(Entity e, int hitLength, int markType, int icon, int damage, int move, int opacity, int focusPlayer, int focusNPC) {<br>
hitLength <em>= 2;<br>
if (damage &gt; 0) {<br>
if(icon &gt; 0 &amp;&amp; icon &lt; hitMarkIcons.length)<br>
hitMarkIcons[icon].drawSprite1(spriteDrawX - 34, spriteDrawY - 14 + move, opacity);<br>
int focusType = (e == myPlayer || (focusPlayer != 0 &amp;&amp; e == playerArray[focusPlayer]) || (focusNPC != 0 &amp;&amp; e == npcArray[focusNPC])) ? 0 : 1;<br>
hitMarkBacks[markType][focusType][0].drawSprite1(spriteDrawX - 12, spriteDrawY - 12 + move, opacity);<br>
for (int i = 1; i &lt;= hitLength; i++)<br>
hitMarkBacks[markType][focusType][1].drawSprite1(spriteDrawX - 12 + i</em>4, spriteDrawY - 12 + move, opacity);<br>
hitMarkBacks[markType][focusType][2].drawSprite1(spriteDrawX - 8 + hitLength*4, spriteDrawY - 12 + move, opacity);</p>
<pre><code>		if(hitLength == 6)
			normalFont.drawText(0xffffff, String.valueOf(damage), spriteDrawY + 3 + move, spriteDrawX+4);
		else if(hitLength == 4)
			normalFont.drawText(0xffffff, String.valueOf(damage), spriteDrawY + 3 + move, spriteDrawX);
		else
			normalFont.drawText(0xffffff, String.valueOf(damage), spriteDrawY + 3 + move, spriteDrawX-4);
	} else {
		hitMarkIcons[0].drawSprite1(spriteDrawX - 12, spriteDrawY - 14 + move, opacity);
	}
}[/CODE]
</code></pre>
<p>Changed This:</p>
<p><code>for(int j1 = 0; j1 &lt; 4; j1++)
					if(((Entity) (obj)).hitsLoopCycle[j1] &gt; loopCycle) {
						npcScreenPos(((Entity) (obj)), ((Entity) (obj)).height / 2);
						if(spriteDrawX &gt; -1) {
							//spriteDrawY = 20 + 
							switch (j1) {
								case 1:
								spriteDrawY += 20;
								break;
								case 2:
								spriteDrawY += 25;
								break;
								case 3:
								spriteDrawY += 45;
								break;
							}
							Entity e = ((Entity) (obj));
							if (e.hitmarkMove[j1] &gt; -30) {
									e.hitmarkMove[j1]--;
								if (e.hitmarkTrans[j1] &gt; 0)
									e.hitmarkTrans[j1] -= 5;
								hitmarkDraw(e,String.valueOf(e.hitMarkDamage[j1]).length(), e.hitMarkTypes[j1], e.hitmarkIcon[j1], e.hitMarkDamage[j1], e.hitmarkMove[j1], e.hitmarkTrans[j1], e.hitMarkFocusPlayer[j1], e.hitMarkFocusNPC[j1]);
							}
						}
					}
			}</code><br>
To This:</p>
<p><code>for(int j1 = 0; j1 &lt; 4; j1++)
					if(((Entity) (obj)).hitsLoopCycle[j1] &gt; loopCycle)
					{
						npcScreenPos(((Entity) (obj)), ((Entity) (obj)).height / 2);
						if(spriteDrawX &gt; -1)
						{
							if(j1 == 1)
								spriteDrawY -= 20;
							if(j1 == 2)
							{
								spriteDrawX -= 15;
								spriteDrawY -= 10;
							}
							if(j1 == 3)
							{
								spriteDrawX += 15;
								spriteDrawY -= 10;
							}
							hitMarks[((Entity) (obj)).hitMarkTypes[j1]].drawSprite(spriteDrawX - 12, spriteDrawY - 12);
							smallText.drawText(0, String.valueOf(((Entity) (obj)).hitArray[j1]), spriteDrawY + 4, spriteDrawX);
							smallText.drawText(0xffffff, String.valueOf(((Entity) (obj)).hitArray[j1]), spriteDrawY + 3, spriteDrawX - 1);
						}
					}
			}</code><br>
Added this:</p>
<p><code>catch(Exception _ex) { }
			try
			{
				for(int i4 = 0; i4 &lt; 20; i4++)
					hitMarks[i4] = new Sprite(mediaArchive, "hitmarks", i4);
			}</code><br>
Changed this:</p>
<pre><code class="lang-auto"></code></pre>
<p>To this:</p>
<pre><code class="lang-auto"></code></pre>
<p>Deleted this:</p>
<pre><code class="lang-auto"></code></pre>
<p>and this:</p>
<p><code>for(int i4 = 0; i4 &lt; hitMarkIcons.length; i4++)
				hitMarkIcons[i4] = new Sprite("/Hits/icons/icon " + i4);</code><br>
Changed this:</p>
<p><code>if((l &amp; 8) != 0)
			{
				int damage = stream.method426();
				int type = stream.method427();
				int icon = stream.readUnsignedByte();
				int focusNPC = stream.readUnsignedByte();
				npc.updateHitData(type, damage, loopCycle, icon, 0, focusNPC);
				npc.loopCycleStatus = loopCycle + 300;
				npc.currentHealth = stream.method426();
				npc.maxHealth = stream.readUnsignedByte();
			}
			if((l &amp; 0x80) != 0)
			{
				npc.anInt1520 = stream.readUnsignedWord();
				int k1 = stream.readDWord();
				npc.anInt1524 = k1 &gt;&gt; 16;
				npc.anInt1523 = loopCycle + (k1 &amp; 0xffff);
				npc.anInt1521 = 0;
				npc.anInt1522 = 0;
				if(npc.anInt1523 &gt; loopCycle)
					npc.anInt1521 = -1;
				if(npc.anInt1520 == 65535)
					npc.anInt1520 = -1;
			}
			if((l &amp; 0x20) != 0)
			{
				npc.interactingEntity = stream.readUnsignedWord();
				if(npc.interactingEntity == 65535)
					npc.interactingEntity = -1;
			}
			if((l &amp; 1) != 0)
			{
				npc.textSpoken = stream.readString();
				npc.textCycle = 100;
				//entityMessage(npc);
			}
			if((l &amp; 0x40) != 0)
			{
				int damage = stream.method427();
				int type = stream.method428();
				int icon = stream.readUnsignedByte();
				int focusNPC = stream.readUnsignedByte();
				npc.updateHitData(type, damage, loopCycle, icon, 0, focusNPC);
				npc.loopCycleStatus = loopCycle + 300;
				npc.currentHealth = stream.method428();
				npc.maxHealth = stream.method427();
			}
                         if((i &amp; 0x20) != 0)
		        {
			int damage = stream.readUnsignedByte();
			int type = stream.method426();
			int icon = stream.readUnsignedByte();
			int focusPlayer = stream.readUnsignedByte();
			player.updateHitData(type, damage, loopCycle, icon, focusPlayer, 0);
			player.loopCycleStatus = loopCycle + 300;
			player.currentHealth = stream.method427();
			player.maxHealth = stream.readUnsignedByte();
		        }
		        if((i &amp; 0x200) != 0)
	         	{
			int damage = stream.readUnsignedByte();
			int type = stream.method428();
			int icon = stream.readUnsignedByte();
			int focusPlayer = stream.readUnsignedByte();
			player.updateHitData(type, damage, loopCycle, icon, focusPlayer, 0);
			player.loopCycleStatus = loopCycle + 300;
			player.currentHealth = stream.readUnsignedByte();
			player.maxHealth = stream.method427();
		        }</code><br>
To this:</p>
<p><code>if((l &amp; 8) != 0)
			{
				int j1 = stream.method426();
				int j2 = stream.method427();
				npc.updateHitData(j2, j1, loopCycle);
				npc.loopCycleStatus = loopCycle + 300;
				npc.currentHealth = stream.method426();
				npc.maxHealth = stream.readUnsignedByte();
			}
			if((l &amp; 0x80) != 0)
			{
				npc.anInt1520 = stream.readUnsignedWord();
				int k1 = stream.readDWord();
				npc.anInt1524 = k1 &gt;&gt; 16;
				npc.anInt1523 = loopCycle + (k1 &amp; 0xffff);
				npc.anInt1521 = 0;
				npc.anInt1522 = 0;
				if(npc.anInt1523 &gt; loopCycle)
					npc.anInt1521 = -1;
				if(npc.anInt1520 == 65535)
					npc.anInt1520 = -1;
			}
			if((l &amp; 0x20) != 0)
			{
				npc.interactingEntity = stream.readUnsignedWord();
				if(npc.interactingEntity == 65535)
					npc.interactingEntity = -1;
			}
			if((l &amp; 1) != 0)
			{
				npc.textSpoken = stream.readString();
				npc.textCycle = 100;
				//entityMessage(npc);
			}
			if((l &amp; 0x40) != 0)
			{
				int l1 = stream.method427();
				int k2 = stream.method428();
				npc.updateHitData(k2, l1, loopCycle);
				npc.loopCycleStatus = loopCycle + 300;
				npc.currentHealth = stream.method428();
				npc.maxHealth = stream.method427();
			}
                         if((i &amp; 0x20) != 0)
		{
			int k1 = stream.readUnsignedByte();
			int k2 = stream.method426();
			player.updateHitData(k2, k1, loopCycle);
			player.loopCycleStatus = loopCycle + 300;
			player.currentHealth = stream.method427();
			player.maxHealth = stream.readUnsignedByte();
		}
		if((i &amp; 0x200) != 0)
		{
			int l1 = stream.readUnsignedByte();
			int l2 = stream.method428();
			player.updateHitData(l2, l1, loopCycle);
			player.loopCycleStatus = loopCycle + 300;
			player.currentHealth = stream.readUnsignedByte();
			player.maxHealth = stream.method427();
		}
                       </code><br>
This:</p>
<p><code>if(((Entity) (obj)).loopCycleStatus &gt; loopCycle)
			{
				try{
					npcScreenPos(((Entity) (obj)), ((Entity) (obj)).height + 15);
					if(spriteDrawX &gt; -1)
					{
						if(healthBars) {
							int amount = 56;
							int j2 = (((Entity)(Entity)obj).currentHealth * amount) / ((Entity)(Entity)obj).maxHealth;
							if(j2 &gt; amount)
								j2 = amount;
							HPBarEmpty.drawSprite(spriteDrawX - 28, spriteDrawY - 3);
							HPBarFull = new Sprite("HITPOINTS_0", j2, 7);
							HPBarFull.drawSprite(spriteDrawX - 28, spriteDrawY - 3);
						} else {
							int i1 = (((Entity) (obj)).currentHealth * 30) / ((Entity) (obj)).maxHealth;
							if(i1 &gt; 30)
								i1 = 30;
							DrawingArea.drawPixels(5, spriteDrawY - 3, spriteDrawX - 15, 65280, i1);
							DrawingArea.drawPixels(5, spriteDrawY - 3, (spriteDrawX - 15) + i1, 0xff0000, 30 - i1);
						}
					}
				}catch(Exception ex){ }
			}</code><br>
To this:</p>
<p><code>if(((Entity) (obj)).loopCycleStatus &gt; loopCycle)
			{
				try{
					npcScreenPos(((Entity) (obj)), ((Entity) (obj)).height + 15);
					if(spriteDrawX &gt; -1)
					{
						int i1 = (((Entity) (obj)).currentHealth * 30) / ((Entity) (obj)).maxHealth;
						if(i1 &gt; 30)
							i1 = 30;
						DrawingArea.drawPixels(5, spriteDrawY - 3, spriteDrawX - 15, 65280, i1);
						DrawingArea.drawPixels(5, spriteDrawY - 3, (spriteDrawX - 15) + i1, 0xff0000, 30 - i1);
					}
				}catch(Exception e){ }
				}</code></p>
      </div>

      <meta itemprop='headline' content='[PI] NPC Health Not Showing Up'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sk8rdude461.html'><span itemprop='name'>sk8rdude461</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-04-21T20:56:48Z'>
            <time itemprop='dateModified' datetime='2016-08-04T07:03:13Z' class='post-time'>
              August 4, 2016,  7:03am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Take a gander at what you commented out:</p>
<pre><code class="lang-auto"></code></pre>
<pre><code class="lang-auto"></code></pre>
<p><code>hitMarkBacks[markType][focusType][1].drawSprite1(spriteDrawX - 12 + i*4, spriteDrawY - 12 + move, opacity);
                        hitMarkBacks[markType][focusType][2].drawSprite1(spriteDrawX - 8 + hitLength*4, spriteDrawY - 12 + move, opacity);</code><br>
That kind of looks like it has to do with the NPC’s health…</p>
      </div>

      <meta itemprop='headline' content='[PI] NPC Health Not Showing Up'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/DerpaDerpy.html'><span itemprop='name'>DerpaDerpy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-04-21T23:29:36Z'>
            <time itemprop='dateModified' datetime='2016-08-04T07:03:16Z' class='post-time'>
              August 4, 2016,  7:03am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“sk8rdude461, post:2, topic:517653”]Take a gander at what you commented out:</p>
<pre><code class="lang-auto"></code></pre>
<pre><code class="lang-auto"></code></pre>
<p><code>hitMarkBacks[markType][focusType][1].drawSprite1(spriteDrawX - 12 + i*4, spriteDrawY - 12 + move, opacity);
                        hitMarkBacks[markType][focusType][2].drawSprite1(spriteDrawX - 8 + hitLength*4, spriteDrawY - 12 + move, opacity);</code><br>
That kind of looks like it has to do with the NPC’s health…[/quote]<br>
It’s not. I already tried un-commenting it.</p>
      </div>

      <meta itemprop='headline' content='[PI] NPC Health Not Showing Up'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/pi-npc-health-not-showing-up/517653 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 02:06:52 GMT -->
</html>
