<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Real construction using Construct Map Region packet</title>
    <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091</link>
    <description>If you clicked this thread expecting full construction then..

HAHAHAHAHAHHAAHHA. good 1 m8. This is simply a base to work from. One of the main problems with nobody ever being able to work on construction was tons of people didn&#39;t even know how to work the packet.

Basically I&#39;ve left you with a very bare framework. To finish this you need to add a lot of stuff yourself.

Add a command like this

[code]if(playerCommand.equalsIgnoreCase(&quot;poh&quot;)) {
			final Client p = c;
			p.getPA().movePlayer(48, 48, p.playerId * 4);
			CycleEventHandler.getSingleton().addEvent(p, new CycleEvent() {

				@Override
				public void execute(CycleEventContainer container) {
					stop();
					container.stop();
				}

				@Override
				public void stop() {
					House.showHouse(p, p);
				}
				
			}, 1);
		}[/code]


Now for the main class [b]House[/b], add this in server.model.content

[code]package server.model.content;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import java.util.LinkedList;

import server.model.objects.Object;
import server.model.players.Client;

public class House implements Serializable {

	private static final long serialVersionUID = 1L;
	
	private static final String houseLocation = &quot;./Data/houses/&quot;;
	
	public static boolean hasHouse(Client player) {
		File file = new File(houseLocation);
		return file.exists();
	}
	
	public static void showHouse(Client host, Client visiter) {
		visiter.outStream.createFrameVarSizeWord(241);
		visiter.outStream.writeWordA(visiter.mapRegionY + 6);
		visiter.outStream.initBitAccess();
		for(int z = 0; z &lt; 4; z++) {
			for(int x = 0; x &lt; 13; x++) {
				for(int y = 0; y &lt; 13; y++) {
					Room room = host.getHouse().rooms[x][y][z];
					visiter.getOutStream().writeBits(1, room != null ? 1 : 0);
					if(room != null) {
						visiter.getOutStream().writeBits(26, room.locationHash);
					}
				}
			}
		}
		visiter.getOutStream().finishBitAccess();
		visiter.getOutStream().writeWord(visiter.mapRegionX + 6);
		visiter.getOutStream().endFrameVarSizeWord();
		visiter.flushOutStream();
		visiter.inHouse = true;
		loadObjects(host);
	}
	
	public static void loadObjects(Client c) {
		for(RoomObject object : c.getHouse().objects) {
			/*visiter.getOutStream().createFrame(85);
			visiter.getOutStream().writeByteC(object.y - visiter.getMapRegionY() * 8);
			visiter.getOutStream().writeByteC(object.x - visiter.getMapRegionX() * 8);
			visiter.getOutStream().createFrame(101);
			visiter.getOutStream().writeByteC(object.rot);
			visiter.getOutStream().writeByte(0);
			visiter.getOutStream().createFrame(151);
			visiter.getOutStream().writeByteS(0);
			visiter.getOutStream().writeWordBigEndian(object.id);
			visiter.getOutStream().writeByteS(object.rot);
			visiter.flushOutStream();*/
			new Object(object.id, object.y, object.x, c.playerId*4, c.objRot, getObjType(object.id), object.id, 0);
			System.out.println(c.objRot);
		}
	}
	
	public House getHouse(Client player) {
		House d = null;
		try {
			ObjectInputStream in = new ObjectInputStream(new FileInputStream(houseLocation + player.playerName + &quot;.house&quot;));
			d = (House) in.readObject();
			in.close();
			System.out.println(&quot;umm:&quot; +d.objects.size());
		} catch (Exception e) {
		//	e.printStackTrace();
			return new House(player, false);
		}
		return d;
		
	}
	
	public House(Client player, boolean hasHouse) {
		House h = getHouse(player);
		for(int x = 0; x &lt; 11; x++) {
			for(int y = 0; y &lt; 11; y++) {
				rooms[x][y][0] = h.rooms[x][y][0];
				if(x == 0 || y == 0 || x == 1 || y == 1 || x == 11 || y == 11 || x == 10 || y == 10) {
					rooms[x][y][0] = null;
				}
			}
		}
		rooms[6][6][0] = GARDEN;
	}
	
	public static boolean save(Client player) {
		player.sendMessage(&quot;Saving house.&quot;);
		try {
			ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(houseLocation + player.playerName + &quot;.house&quot;));
			out.writeObject(player.getHouse());
			out.close();
			return true;
		} catch (Exception e) {
			e.printStackTrace();
			return false;
		}
	}
	
    private Room[][][] rooms = new Room[13][13][4];
       
    public static class Room implements Serializable {

		private static final long serialVersionUID = 1L;
		
		private int locationHash;
		private Room(int x, int y, int z, int rot) {
			this.locationHash = x / 8 &lt;&lt; 14 | y / 8 &lt;&lt; 3 | z % 4 &lt;&lt; 24 | rot % 4 &lt;&lt; 1;
		}
	}
	
	private LinkedList&lt;RoomObject&gt; objects = new LinkedList&lt;RoomObject&gt;();
	private static class RoomObject implements Serializable {

		private static final long serialVersionUID = 1L;
		private int x;
		private int y;
		private int z;
		private int id;
		private int rot;
		private RoomObject(int id, int x, int y, int z, int type, int face) {
			this.rot = type &lt;&lt; 2 | face &amp; 3;
			this.x = x;
			this.y = y;
			this.z = z;
			this.id = id;
		}
	}
	
	public static final Room DEFAULT = new Room(1864, 5056, 0, 0);
    public static final Room GARDEN = new Room(1859, 5066, 0, 0);
    public static final Room THRONE = new Room(1904, 5096, 0, 0);
    public static final Room GAME = new Room(1864, 5104, 0, 0);
    public static final Room FLOOR2 = new Room(1903, 5095, 0, 0);
	public static final Room PARLOUR = new Room(1856, 5112, 0, 0);
	public static final Room KITCHEN = new Room(1872, 5112, 0, 0);
	public static final Room DINING = new Room(1890, 5112, 0, 0);
	public static final Room WORKSHOP = new Room(1856, 5096, 0, 0);
	public static final Room BEDROOM = new Room(1904, 5112, 0, 0);
	public static final Room SKILLHALL = new Room(1880, 5104, 0, 0);
	public static final Room COMBAT = new Room(1880, 5088, 0, 0);
	public static final Room QUEST_HALL = new Room(1912, 5104, 0, 0);
	public static final Room STUDY = new Room(1888, 5096, 0, 0);
	public static final Room COSTUME_ROOM = new Room(1904, 5064, 0, 0);
	public static final Room CHAPEL = new Room(1872, 5096, 0, 0);
	public static final Room PORTAL_CHAMBER = new Room(1864, 5088, 0, 0);
	public static final Room FORMAL_GARDEN = new Room(1872, 5064, 0, 0);
	public static final Room THRONE_ROOM = new Room(1904, 5080, 0, 0);
	public static final Room OUBILIETTE = new Room(1904, 5080, 0, 0);
	public static final Room CORRIDOR_DUNGEON = new Room(1888, 5080, 0, 0);
	public static final Room JUNCTION_DUNGEON = new Room(1856, 5080, 0, 0);
	public static final Room STAIRS_DUNGEON = new Room(1872, 5080, 0, 0);
	public static final Room TREASURE_ROOM = new Room(1912, 5088, 0, 0);
    
	public static int[][] objectData = { 
		//Build obj id, Real obj id, obj type
		{15361, 13405, 10}
	};
	
	public static int getObjType(int id) {
		for(int i = 0; i &lt; objectData.length; i++) {
			if(objectData[i][0] == id) {
				return objectData[i][2];
			}
		}
		return 10;
	}
	
	public static int getObjId(int id) {
		for(int i = 0; i &lt; objectData.length; i++) {
			if(objectData[i][0] == id) {
				return objectData[i][1];
			}
		}
		return -1;
	}
	
	public static void handleConstructionClick(Client player, int id, int x, int y) {
		int locX = player.absX % 8;
		int locY = player.absY % 8;
		switch(id) {
		case 15364:
		case 15361:
			createObject(player, getObjId(id), x, y, getObjType(id), player.objRot);
			break;
		case 15314:
		case 15313:
			if(locX == 3 &amp;&amp; locY == 0 || locX == 4 &amp;&amp; locY == 0) {
				addRoom(player, id, x, y, getRoomToBuild(player), player.absX / 8, (player.absY - 1) / 8);
			}	
			if(locX == 0 &amp;&amp; locY == 3 || locX == 0 &amp;&amp; locY == 4) {
				addRoom(player, id, x, y, getRoomToBuild(player), (player.absX - 1) / 8, player.absY / 8);
			}	
			if(locX == 3 &amp;&amp; locY == 7 || locX == 4 &amp;&amp; locY == 7) {
				addRoom(player, id, x, y, getRoomToBuild(player), player.absX / 8, (player.absY + 1) / 8);
			}
			if(locX == 7 &amp;&amp; locY == 3 || locX == 7 &amp;&amp; locY == 4) {
				addRoom(player, id, x, y, getRoomToBuild(player), (player.absX + 1) / 8, player.absY / 8);
			}	
			break;
		}
		player.getDH().sendDialogues(62, 0);
	}
	
	public static boolean handleButtons(Client c, int actionButtonId) {
		switch(actionButtonId) {
		case 9168:
			if(c.objRot &gt; 3) {
				c.objRot++;
			}
			createObject(c, getObjId(c.objId), c.objectX, c.objectY, getObjType(c.objId), c.objRot);
			loadObjects(c);
			break;
		}
		return false;
	}
	
	public static void createObject(Client player, int id, int x, int y, int type, int face) {
		if(player != null) {
			RoomObject object = new RoomObject(id, x, y, player.heightLevel, type, face);
			player.objectId = id;
			player.objRot = face;
			new Object(object.id, object.y, object.x, player.playerId*4, player.objRot, getObjType(object.id), object.id, 0);
			/*object.id = id;
			object.x = player.objectX;
			object.y = player.objectY;
			player.getOutStream().createFrame(85);
			player.getOutStream().writeByteC(object.y - player.getMapRegionY() * 8);
			player.getOutStream().writeByteC(object.x - player.getMapRegionX() * 8);
			player.getOutStream().createFrame(101);
			player.getOutStream().writeByteC(object.rot);
			player.getOutStream().writeByte(0);
			player.getOutStream().createFrame(151);
			player.getOutStream().writeByteS(0);
			player.getOutStream().writeWordBigEndian(object.id);
			player.getOutStream().writeByteS(object.rot);
			player.flushOutStream();*/
			player.getHouse().objects.add(object);
			loadObjects(player);
		}	
	}
	
	public static Room getRoomToBuild(Client c) {
		return GAME;
	}
	
	public static void addRoom(Client player, int id, int x, int y, Room room, int slotX, int slotY) {
		player.getHouse().rooms[slotX][slotY][0] = room;
		showHouse(player, player);
	}
}[/code]


And the palette class created by [user]Graham[/user]

[code]package server.model.players;
 
public class Palette {
       
        public static final int DIRECTION_NORMAL = 0;
        public static final int DIRECTION_CW_0 = 0;
        public static final int DIRECTION_CW_90 = 1;
        public static final int DIRECTION_CW_180 = 2;
        public static final int DIRECTION_CW_270 = 3;
       
        public static class PaletteTile {
               
                private int x;
                private int y;
                private int z;
                private int rot;
               
                public PaletteTile(int x, int y) {
                        this(x, y, 0);
                }
               
                public PaletteTile(int x, int y, int z) {
                        this(x, y, z, DIRECTION_NORMAL);
                }
               
                public PaletteTile(int x, int y, int z, int rot) {
                        this.x = x;
                        this.y = y;
                        this.z = z;
                        this.rot = rot;
                }
               
                public int getX() {
                        return x / 8;
                }
               
                public int getY() {
                        return y / 8;
                }
               
                public int getZ() {
                        return z % 4;
                }
               
                public int getRotation() {
                        return rot % 4;
                }
               
        }
       
        private PaletteTile[][][] tiles = new PaletteTile[13][13][4];

		public PaletteTile getTile(int x, int y, int z) {
                return tiles[x][y][z];
        }
       
        public void setTile(int x, int y, int z, PaletteTile tile) {
                tiles[x][y][z] = tile;
        }
 
}[/code]

Your final result:

[IMG]http://i.imgur.com/DdTlPdz.png[/img]
[IMG]http://i.imgur.com/zJC1v2c.png[/img]

cause ik a lot of ppl will leech this, there is a problem with the client that you have to fix for the packet to work. i released it before but i took it down.

also put a &#39;houses&#39; folder in your data folder


more uses of the packet:
[IMG]http://i.imgur.com/Sn0eueg.png[/img]

[IMG]http://i.imgur.com/9RM1MxR.png[/img]

you can also make the stealing creation map randomized like it is in rs with the packet like above</description>
    
    <lastBuildDate>Mon, 04 Nov 2013 20:33:40 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@Loveandpower Loveandpower]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/loveandpower">@Loveandpower</a> wrote:</p>
          <blockquote>
              <p>thanks for the contrib nick I’m sure someone will use this/leech it/re-release it for a better/fuller version of it</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/12</link>
        <pubDate>Mon, 04 Nov 2013 20:33:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-12</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@arham_4 arham 4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/arham_4">@arham_4</a> wrote:</p>
          <blockquote>
              <p>[quote=“Clawz fury, post:10, topic:535091”][quote author=arham 4 link=topic=653891.msg4380543#msg4380543 date=1383370797]</p>
<aside class="quote">
<blockquote>
<p>people are actually retarded for not seeing the value in this</p>
<p>the construct map region packet is so useful</p>
</blockquote>
</aside>
<p>Uh, I just asked a question?<br>
[/quote]<br>
Uh, I wasn’t referring to you?[/quote]<br>
O</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/11</link>
        <pubDate>Sun, 03 Nov 2013 06:22:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-11</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@Clawz_fury lare69]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/clawz_fury">@Clawz_fury</a> wrote:</p>
          <blockquote>
              <p>[quote=“arham 4, post:8, topic:535091”][quote author=Clawz fury link=topic=653891.msg4380538#msg4380538 date=1383369158]<br>
people are actually retarded for not seeing the value in this</p>
<p>the construct map region packet is so useful<br>
[/quote]<br>
Uh, I just asked a question?[/quote]<br>
Uh, I wasn’t referring to you?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/10</link>
        <pubDate>Sun, 03 Nov 2013 06:21:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-10</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@asshole_rule asshole_rule]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/asshole_rule">@asshole_rule</a> wrote:</p>
          <blockquote>
              <p>[quote=“Clawz fury, post:7, topic:535091”]people are actually retarded for not seeing the value in this</p>
<p>the construct map region packet is so useful[/quote]</p>
<p>people probs still dunno how to work it</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/9</link>
        <pubDate>Sat, 02 Nov 2013 16:11:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-9</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@arham_4 arham 4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/arham_4">@arham_4</a> wrote:</p>
          <blockquote>
              <p>[quote=“Clawz fury, post:7, topic:535091”]people are actually retarded for not seeing the value in this</p>
<p>the construct map region packet is so useful[/quote]<br>
Uh, I just asked a question?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/8</link>
        <pubDate>Sat, 02 Nov 2013 05:39:57 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-8</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@Clawz_fury lare69]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/clawz_fury">@Clawz_fury</a> wrote:</p>
          <blockquote>
              <p>people are actually retarded for not seeing the value in this</p>
<p>the construct map region packet is so useful</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/7</link>
        <pubDate>Sat, 02 Nov 2013 05:12:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-7</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@arham_4 arham 4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/arham_4">@arham_4</a> wrote:</p>
          <blockquote>
              <p>[quote=“asshole_rule, post:5, topic:535091”][quote author=arham 4 link=topic=653891.msg4380457#msg4380457 date=1383343335]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>So what is the difference between this and DynamicRegion?</p>
</blockquote>
</aside>
<p>I don’t know what you mean when you say Dynamic Region, so I don’t know.</p>
</blockquote>
</aside>
<p>DynamicRegion is a system that allows you to copy an area and make it seem “player-owned”.</p>
<p>Example:<br>
<a href="http://www.youtube.com/watch?v=y1l_C3kb7yI" class="onebox" target="_blank" rel="nofollow noopener">http://www.youtube.com/watch?v=y1l_C3kb7yI</a><br>
[/quote]</p>
<p>Well that looks way bigger, and I’m not sure 317 client has support for that.[/quote]<br>
Ah, kk.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/6</link>
        <pubDate>Fri, 01 Nov 2013 22:05:45 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-6</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@asshole_rule asshole_rule]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/asshole_rule">@asshole_rule</a> wrote:</p>
          <blockquote>
              <p>[quote=“arham 4, post:4, topic:535091”][quote author=asshole_rule link=topic=653891.msg4380456#msg4380456 date=1383343199]</p>
<aside class="quote">
<blockquote>
<p>So what is the difference between this and DynamicRegion?</p>
</blockquote>
</aside>
<p>I don’t know what you mean when you say Dynamic Region, so I don’t know.<br>
[/quote]<br>
DynamicRegion is a system that allows you to copy an area and make it seem “player-owned”.</p>
<p>Example:<br>
<a href="http://www.youtube.com/watch?v=y1l_C3kb7yI%5B/quote%5D" class="onebox" target="_blank" rel="nofollow noopener">http://www.youtube.com/watch?v=y1l_C3kb7yI[/quote]</a></p>
<p>Well that looks way bigger, and I’m not sure 317 client has support for that.</p>
<p>That probably grabs bigger chunks of the map too. Didn’t watch the whole video btw, lol.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/5</link>
        <pubDate>Fri, 01 Nov 2013 22:04:56 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-5</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@arham_4 arham 4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/arham_4">@arham_4</a> wrote:</p>
          <blockquote>
              <p>[quote=“asshole_rule, post:3, topic:535091”][quote author=arham 4 link=topic=653891.msg4380455#msg4380455 date=1383343153]<br>
So what is the difference between this and DynamicRegion?<br>
[/quote]</p>
<p>I don’t know what you mean when you say Dynamic Region, so I don’t know.[/quote]<br>
DynamicRegion is a system that allows you to copy an area and make it seem “player-owned”.</p>
<p>Example:<br>
<a href="http://www.youtube.com/watch?v=y1l_C3kb7yI" class="onebox" target="_blank" rel="nofollow noopener">http://www.youtube.com/watch?v=y1l_C3kb7yI</a></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/4</link>
        <pubDate>Fri, 01 Nov 2013 22:02:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-4</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@asshole_rule asshole_rule]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/asshole_rule">@asshole_rule</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="2" data-topic="535091">
<div class="title">
<div class="quote-controls"></div>
 arham 4:</div>
<blockquote>
<p>So what is the difference between this and DynamicRegion?</p>
</blockquote>
</aside>
<p>I don’t know what you mean when you say Dynamic Region, so I don’t know.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/3</link>
        <pubDate>Fri, 01 Nov 2013 21:59:59 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-3</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@arham_4 arham 4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/arham_4">@arham_4</a> wrote:</p>
          <blockquote>
              <p>So what is the difference between this and DynamicRegion?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/2</link>
        <pubDate>Fri, 01 Nov 2013 21:59:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-2</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
      <item>
        <title>Real construction using Construct Map Region packet</title>
        <dc:creator><![CDATA[@asshole_rule asshole_rule]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/asshole_rule">@asshole_rule</a> wrote:</p>
          <blockquote>
              <p>If you clicked this thread expecting full construction then…</p>
<p>HAHAHAHAHAHHAAHHA. good 1 m8. This is simply a base to work from. One of the main problems with nobody ever being able to work on construction was tons of people didn’t even know how to work the packet.</p>
<p>Basically I’ve left you with a very bare framework. To finish this you need to add a lot of stuff yourself.</p>
<p>Add a command like this</p>
<p>[code]if(playerCommand.equalsIgnoreCase(“poh”)) {<br>
final Client p = c;<br>
p.getPA().movePlayer(48, 48, p.playerId * 4);<br>
CycleEventHandler.getSingleton().addEvent(p, new CycleEvent() {</p>
<pre><code>			@Override
			public void execute(CycleEventContainer container) {
				stop();
				container.stop();
			}

			@Override
			public void stop() {
				House.showHouse(p, p);
			}
			
		}, 1);
	}[/code]
</code></pre>
<p>Now for the main class <span class="bbcode-b">House</span>, add this in server.model.content</p>
<p>[code]package server.model.content;</p>
<p>import java.io.File;<br>
import java.io.FileInputStream;<br>
import java.io.FileOutputStream;<br>
import java.io.ObjectInputStream;<br>
import java.io.ObjectOutputStream;<br>
import java.io.Serializable;<br>
import java.util.LinkedList;</p>
<p>import server.model.objects.Object;<br>
import server.model.players.Client;</p>
<p>public class House implements Serializable {</p>
<pre><code>private static final long serialVersionUID = 1L;

private static final String houseLocation = "./Data/houses/";

public static boolean hasHouse(Client player) {
	File file = new File(houseLocation);
	return file.exists();
}

public static void showHouse(Client host, Client visiter) {
	visiter.outStream.createFrameVarSizeWord(241);
	visiter.outStream.writeWordA(visiter.mapRegionY + 6);
	visiter.outStream.initBitAccess();
	for(int z = 0; z &lt; 4; z++) {
		for(int x = 0; x &lt; 13; x++) {
			for(int y = 0; y &lt; 13; y++) {
				Room room = host.getHouse().rooms[x][y][z];
				visiter.getOutStream().writeBits(1, room != null ? 1 : 0);
				if(room != null) {
					visiter.getOutStream().writeBits(26, room.locationHash);
				}
			}
		}
	}
	visiter.getOutStream().finishBitAccess();
	visiter.getOutStream().writeWord(visiter.mapRegionX + 6);
	visiter.getOutStream().endFrameVarSizeWord();
	visiter.flushOutStream();
	visiter.inHouse = true;
	loadObjects(host);
}

public static void loadObjects(Client c) {
	for(RoomObject object : c.getHouse().objects) {
		/*visiter.getOutStream().createFrame(85);
		visiter.getOutStream().writeByteC(object.y - visiter.getMapRegionY() * 8);
		visiter.getOutStream().writeByteC(object.x - visiter.getMapRegionX() * 8);
		visiter.getOutStream().createFrame(101);
		visiter.getOutStream().writeByteC(object.rot);
		visiter.getOutStream().writeByte(0);
		visiter.getOutStream().createFrame(151);
		visiter.getOutStream().writeByteS(0);
		visiter.getOutStream().writeWordBigEndian(object.id);
		visiter.getOutStream().writeByteS(object.rot);
		visiter.flushOutStream();*/
		new Object(object.id, object.y, object.x, c.playerId*4, c.objRot, getObjType(object.id), object.id, 0);
		System.out.println(c.objRot);
	}
}

public House getHouse(Client player) {
	House d = null;
	try {
		ObjectInputStream in = new ObjectInputStream(new FileInputStream(houseLocation + player.playerName + ".house"));
		d = (House) in.readObject();
		in.close();
		System.out.println("umm:" +d.objects.size());
	} catch (Exception e) {
	//	e.printStackTrace();
		return new House(player, false);
	}
	return d;
	
}

public House(Client player, boolean hasHouse) {
	House h = getHouse(player);
	for(int x = 0; x &lt; 11; x++) {
		for(int y = 0; y &lt; 11; y++) {
			rooms[x][y][0] = h.rooms[x][y][0];
			if(x == 0 || y == 0 || x == 1 || y == 1 || x == 11 || y == 11 || x == 10 || y == 10) {
				rooms[x][y][0] = null;
			}
		}
	}
	rooms[6][6][0] = GARDEN;
}

public static boolean save(Client player) {
	player.sendMessage("Saving house.");
	try {
		ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(houseLocation + player.playerName + ".house"));
		out.writeObject(player.getHouse());
		out.close();
		return true;
	} catch (Exception e) {
		e.printStackTrace();
		return false;
	}
}

private Room[][][] rooms = new Room[13][13][4];
   
public static class Room implements Serializable {

	private static final long serialVersionUID = 1L;
	
	private int locationHash;
	private Room(int x, int y, int z, int rot) {
		this.locationHash = x / 8 &lt;&lt; 14 | y / 8 &lt;&lt; 3 | z % 4 &lt;&lt; 24 | rot % 4 &lt;&lt; 1;
	}
}

private LinkedList&lt;RoomObject&gt; objects = new LinkedList&lt;RoomObject&gt;();
private static class RoomObject implements Serializable {

	private static final long serialVersionUID = 1L;
	private int x;
	private int y;
	private int z;
	private int id;
	private int rot;
	private RoomObject(int id, int x, int y, int z, int type, int face) {
		this.rot = type &lt;&lt; 2 | face &amp; 3;
		this.x = x;
		this.y = y;
		this.z = z;
		this.id = id;
	}
}

public static final Room DEFAULT = new Room(1864, 5056, 0, 0);
public static final Room GARDEN = new Room(1859, 5066, 0, 0);
public static final Room THRONE = new Room(1904, 5096, 0, 0);
public static final Room GAME = new Room(1864, 5104, 0, 0);
public static final Room FLOOR2 = new Room(1903, 5095, 0, 0);
public static final Room PARLOUR = new Room(1856, 5112, 0, 0);
public static final Room KITCHEN = new Room(1872, 5112, 0, 0);
public static final Room DINING = new Room(1890, 5112, 0, 0);
public static final Room WORKSHOP = new Room(1856, 5096, 0, 0);
public static final Room BEDROOM = new Room(1904, 5112, 0, 0);
public static final Room SKILLHALL = new Room(1880, 5104, 0, 0);
public static final Room COMBAT = new Room(1880, 5088, 0, 0);
public static final Room QUEST_HALL = new Room(1912, 5104, 0, 0);
public static final Room STUDY = new Room(1888, 5096, 0, 0);
public static final Room COSTUME_ROOM = new Room(1904, 5064, 0, 0);
public static final Room CHAPEL = new Room(1872, 5096, 0, 0);
public static final Room PORTAL_CHAMBER = new Room(1864, 5088, 0, 0);
public static final Room FORMAL_GARDEN = new Room(1872, 5064, 0, 0);
public static final Room THRONE_ROOM = new Room(1904, 5080, 0, 0);
public static final Room OUBILIETTE = new Room(1904, 5080, 0, 0);
public static final Room CORRIDOR_DUNGEON = new Room(1888, 5080, 0, 0);
public static final Room JUNCTION_DUNGEON = new Room(1856, 5080, 0, 0);
public static final Room STAIRS_DUNGEON = new Room(1872, 5080, 0, 0);
public static final Room TREASURE_ROOM = new Room(1912, 5088, 0, 0);

public static int[][] objectData = { 
	//Build obj id, Real obj id, obj type
	{15361, 13405, 10}
};

public static int getObjType(int id) {
	for(int i = 0; i &lt; objectData.length; i++) {
		if(objectData[i][0] == id) {
			return objectData[i][2];
		}
	}
	return 10;
}

public static int getObjId(int id) {
	for(int i = 0; i &lt; objectData.length; i++) {
		if(objectData[i][0] == id) {
			return objectData[i][1];
		}
	}
	return -1;
}

public static void handleConstructionClick(Client player, int id, int x, int y) {
	int locX = player.absX % 8;
	int locY = player.absY % 8;
	switch(id) {
	case 15364:
	case 15361:
		createObject(player, getObjId(id), x, y, getObjType(id), player.objRot);
		break;
	case 15314:
	case 15313:
		if(locX == 3 &amp;&amp; locY == 0 || locX == 4 &amp;&amp; locY == 0) {
			addRoom(player, id, x, y, getRoomToBuild(player), player.absX / 8, (player.absY - 1) / 8);
		}	
		if(locX == 0 &amp;&amp; locY == 3 || locX == 0 &amp;&amp; locY == 4) {
			addRoom(player, id, x, y, getRoomToBuild(player), (player.absX - 1) / 8, player.absY / 8);
		}	
		if(locX == 3 &amp;&amp; locY == 7 || locX == 4 &amp;&amp; locY == 7) {
			addRoom(player, id, x, y, getRoomToBuild(player), player.absX / 8, (player.absY + 1) / 8);
		}
		if(locX == 7 &amp;&amp; locY == 3 || locX == 7 &amp;&amp; locY == 4) {
			addRoom(player, id, x, y, getRoomToBuild(player), (player.absX + 1) / 8, player.absY / 8);
		}	
		break;
	}
	player.getDH().sendDialogues(62, 0);
}

public static boolean handleButtons(Client c, int actionButtonId) {
	switch(actionButtonId) {
	case 9168:
		if(c.objRot &gt; 3) {
			c.objRot++;
		}
		createObject(c, getObjId(c.objId), c.objectX, c.objectY, getObjType(c.objId), c.objRot);
		loadObjects(c);
		break;
	}
	return false;
}

public static void createObject(Client player, int id, int x, int y, int type, int face) {
	if(player != null) {
		RoomObject object = new RoomObject(id, x, y, player.heightLevel, type, face);
		player.objectId = id;
		player.objRot = face;
		new Object(object.id, object.y, object.x, player.playerId*4, player.objRot, getObjType(object.id), object.id, 0);
		/*object.id = id;
		object.x = player.objectX;
		object.y = player.objectY;
		player.getOutStream().createFrame(85);
		player.getOutStream().writeByteC(object.y - player.getMapRegionY() * 8);
		player.getOutStream().writeByteC(object.x - player.getMapRegionX() * 8);
		player.getOutStream().createFrame(101);
		player.getOutStream().writeByteC(object.rot);
		player.getOutStream().writeByte(0);
		player.getOutStream().createFrame(151);
		player.getOutStream().writeByteS(0);
		player.getOutStream().writeWordBigEndian(object.id);
		player.getOutStream().writeByteS(object.rot);
		player.flushOutStream();*/
		player.getHouse().objects.add(object);
		loadObjects(player);
	}	
}

public static Room getRoomToBuild(Client c) {
	return GAME;
}

public static void addRoom(Client player, int id, int x, int y, Room room, int slotX, int slotY) {
	player.getHouse().rooms[slotX][slotY][0] = room;
	showHouse(player, player);
}
</code></pre>
<p>}[/code]</p>
<p>And the palette class created by [user]Graham[/user]</p>
<p>[code]package server.model.players;</p>
<p>public class Palette {</p>
<pre><code>    public static final int DIRECTION_NORMAL = 0;
    public static final int DIRECTION_CW_0 = 0;
    public static final int DIRECTION_CW_90 = 1;
    public static final int DIRECTION_CW_180 = 2;
    public static final int DIRECTION_CW_270 = 3;
   
    public static class PaletteTile {
           
            private int x;
            private int y;
            private int z;
            private int rot;
           
            public PaletteTile(int x, int y) {
                    this(x, y, 0);
            }
           
            public PaletteTile(int x, int y, int z) {
                    this(x, y, z, DIRECTION_NORMAL);
            }
           
            public PaletteTile(int x, int y, int z, int rot) {
                    this.x = x;
                    this.y = y;
                    this.z = z;
                    this.rot = rot;
            }
           
            public int getX() {
                    return x / 8;
            }
           
            public int getY() {
                    return y / 8;
            }
           
            public int getZ() {
                    return z % 4;
            }
           
            public int getRotation() {
                    return rot % 4;
            }
           
    }
   
    private PaletteTile[][][] tiles = new PaletteTile[13][13][4];

	public PaletteTile getTile(int x, int y, int z) {
            return tiles[x][y][z];
    }
   
    public void setTile(int x, int y, int z, PaletteTile tile) {
            tiles[x][y][z] = tile;
    }
</code></pre>
<p>}[/code]</p>
<p>Your final result:</p>
<p><img src="http://i.imgur.com/DdTlPdz.png" alt width="" height=""><br>
<img src="http://i.imgur.com/zJC1v2c.png" alt width="" height=""></p>
<p>cause ik a lot of ppl will leech this, there is a problem with the client that you have to fix for the packet to work. i released it before but i took it down.</p>
<p>also put a ‘houses’ folder in your data folder</p>
<p>more uses of the packet:<br>
<img src="http://i.imgur.com/Sn0eueg.png" alt width="" height=""></p>
<p><img src="http://i.imgur.com/9RM1MxR.png" alt width="" height=""></p>
<p>you can also make the stealing creation map randomized like it is in rs with the packet like above</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091/1</link>
        <pubDate>Fri, 01 Nov 2013 19:18:19 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-535091-1</guid>
        <source url="https://forum.moparisthebest.com/t/real-construction-using-construct-map-region-packet/535091.rss">Real construction using Construct Map Region packet</source>
      </item>
  </channel>
</rss>
