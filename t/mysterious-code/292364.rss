<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Mysterious code</title>
    <link>https://forum.moparisthebest.com/t/mysterious-code/292364</link>
    <description>[code]    public static void method567(int i_7_, int i_8_, Class17 class17,
				 long l, int i_9_, int i_10_) {
	Buffer buffer = new Buffer(128);
	buffer.putByte(10);
	buffer.putShort((int) (Math.random() * 99999.0));
	buffer.putShort(531);
	buffer.putLong(l);
	buffer.putInt((int) (9.9999999E7 * Math.random()));
	buffer.putString(class17);
	buffer.putInt((int) (Math.random() * 9.9999999E7));
	buffer.putShort(Class34.anInt640);
	buffer.putByte(i_9_);
	buffer.putByte(i_10_);
	buffer.putInt((int) (Math.random() * 9.9999999E7));
	buffer.putShort(i_7_);
	buffer.putShort(i_8_);
	buffer.putInt((int) (Math.random() * 9.9999999E7));
	buffer.applyRSA(Class115_Sub21.RSA_EXPONENT, Class13.RSA_MODULUS);
	Class115_Sub18_Sub25.outputBuffer.offset = 0;
	Class115_Sub18_Sub25.outputBuffer.putByte(3);
	Class115_Sub18_Sub25.outputBuffer.putByte(buffer.offset);
	Class115_Sub18_Sub25.outputBuffer.putBytes(0, buffer.data, buffer.offset);
	// ?? vars below
	Class115_Sub18_Sub5.anInt4148 = -3;
	Class112.anInt1988 = 0;
	Class64.anInt1194 = 1;
	Class98.anInt1799 = 0;
    }[/code]
Discuss :|
It appears to be writing a packet similar to that of the login block but smaller (it&#39;s also RSA encrypted at the end like the login block) this is only ever called when in a clientscript instruction&#39;s handling code.
[code]
											    if (opcode == 5605) {
												intStackPtr -= 4;
												stringStackPtr -= 2;
												if (Class132.anInt2411 == 12) {
												    if (Class115_Sub18_Sub36.anInt4669 == 0 &amp;&amp; Class115_Sub18_Sub5.anInt4152 == 0 &amp;&amp; Class64.anInt1194 == 0 &amp;&amp; Class115_Sub25_Sub11.anInt4919 == 0)
													Class51_Sub2_Sub1.method567(Class26.intStack[2 + intStackPtr], Class26.intStack[intStackPtr + 3], Class123.stringStack[stringStackPtr + 1], Class123.stringStack[stringStackPtr].encode(), Class26.intStack[intStackPtr], Class26.intStack[1 + intStackPtr]);
												}
												break;
											    }
[/code]

Anybody have a clue as to what it&#39;s purpose is?
NOTE: This is from a 531 client decompiled deob because it&#39;s the latest one I have at hand.

Found another block similar.

[code]        public static void method82(Class17 class17, int i_13_,
				Class17 class17_14_) {
	try {
	    Class43_Sub7.aClass17_3040 = class17;
	    Class43_Sub7.aClass17_3039 = class17_14_;
	    Class115_Sub13.anInt3378 = i_13_;
	    if (Class43_Sub7.aClass17_3039
		    .method164(Class43_Sub7.aClass17_3037, (byte) -120)
		|| Class43_Sub7.aClass17_3040
		       .method164(Class43_Sub7.aClass17_3037, (byte) -122))
		Class18.anInt284 = 3;
	    else if ((Class37.anInt682 ^ 0xffffffff) != 0)
		Class51_Sub1.method555(i ^ 0x6a);
	    else {
		Class18.anInt284 = -3;
		Class7.anInt188 = 0;
		Class115_Sub18_Sub36.anInt4669 = 1;
		Class28.anInt487 = 0;
                // ?? vars above
		Buffer buffer = new Buffer(128);
		buffer.putByte(10);
		buffer.putShort((int) (99999.0 * Math.random()));
		buffer.putShort(531);
		buffer.putLong(Class43_Sub7.aClass17_3039.encode());
		buffer.putInt((int) (Math.random() * 9.9999999E7));
		buffer.putString(Class43_Sub7.aClass17_3040);
		buffer.putInt((int) (9.9999999E7 * Math.random()));
		buffer.applyRSA(Class115_Sub21.RSA_EXPONENT, Class13.RSA_MODULUS);
		Class115_Sub18_Sub25.outputBuffer.offset = 0;
		Class115_Sub18_Sub25.outputBuffer.putByte(239);
		Class115_Sub18_Sub25.outputBuffer.putByte(buffer.offset);
		Class115_Sub18_Sub25.outputBuffer.putBytes(0, buffer.data, buffer.offset);
	    }
	} catch (RuntimeException runtimeexception) {
	    throw Class136.method1926(runtimeexception,
				      (&quot;ah.D(&quot;
				       + (class17 != null ? &quot;{...}&quot; : &quot;null&quot;)
				       + &#39;,&#39; + i + &#39;,&#39; + i_13_ + &#39;,&#39;
				       + (class17_14_ != null ? &quot;{...}&quot;
					  : &quot;null&quot;)
				       + &#39;)&#39;));
	}
    }[/code]
Called via the clientscript VM instruction handler:
[code]											    if (opcode == 5602) {
												int i_187_ = Class26.intStack[--intStackPtr];
												stringStackPtr -= 2;
												Class17 class17 = Class123.stringStack[stringStackPtr + 1];
												Class17 class17_188_ = Class123.stringStack[stringStackPtr];
												if (Class132.anInt2411 == 12) {
												    if (Class115_Sub18_Sub36.anInt4669 == 0 &amp;&amp; Class115_Sub18_Sub5.anInt4152 == 0 &amp;&amp; Class64.anInt1194  == 0 &amp;&amp; Class115_Sub25_Sub11.anInt4919 == 0)
													Class4.method82(class17, i_187_, class17_188_);
												}
												break;
											    }[/code]

Odd, both methods are only called after a certain number of what I think are just flags are 0... these flags are the exact same. Both methods are also only called if anInt2411 equal 12. 
Here&#39;s my hunch: since these are called through the clientscript VM, they are obviously close in contact with Jagex&#39;s Widget/Interface system. What comes to mind is &#39;friend server&#39;, do you think these are used to login to the friend server? Anyone have any other possibilites? 

* Hopes semaphore happens to drop by today *</description>
    
    <lastBuildDate>Fri, 14 Aug 2009 05:06:52 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/mysterious-code/292364.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>[quote=“xEnt, post:18, topic:292364”][quote author=frank_ link=topic=386264.msg2898354#msg2898354 date=1249354302]<br>
when i started playing runescape i registered using the client and started as a warrior… or was it explorer<br>
[/quote]sounds like it was an adventurer[/quote]or that!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/19</link>
        <pubDate>Fri, 14 Aug 2009 05:06:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-19</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@xEnt xEnt]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/xent">@xEnt</a> wrote:</p>
          <blockquote>
              <p>[quote=“frank_, post:14, topic:292364”]when i started playing runescape i registered using the client and started as a warrior… or was it explorer[/quote]sounds like it was an adventurer</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/18</link>
        <pubDate>Fri, 14 Aug 2009 03:52:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-18</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@henry henry]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/henry">@henry</a> wrote:</p>
          <blockquote>
              <p>[quote=“Metho D, post:16, topic:292364”][quote author=henry link=topic=386264.msg2901056#msg2901056 date=1249517062]<br>
So they are putting registering a new account through the client into the game?  Thats the conclusion I’m coming to after reading this thread through.<br>
[/quote]</p>
<p>Yes, it’s already available at the login screen.[/quote]</p>
<p>Oh… really? I havn’t actually played RS in a while now <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=5" title=":confused:" class="emoji" alt=":confused:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/17</link>
        <pubDate>Thu, 06 Aug 2009 00:09:48 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-17</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@Metho_D Method]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/metho_d">@Metho_D</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group quote-modified" data-post="15" data-topic="292364">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/henry/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> henry:</div>
<blockquote>
<p>So they are putting registering a new account through the client into the game?  Thats the conclusion I’m coming to after reading this thread through.</p>
</blockquote>
</aside>
<p>Yes, it’s already available at the login screen.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/16</link>
        <pubDate>Thu, 06 Aug 2009 00:06:16 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-16</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@henry henry]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/henry">@henry</a> wrote:</p>
          <blockquote>
              <p>So they are putting registering a new account through the client into the game?  Thats the conclusion I’m coming to after reading this thread through.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/15</link>
        <pubDate>Thu, 06 Aug 2009 00:04:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-15</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>when i started playing runescape i registered using the client and started as a warrior… or was it explorer</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/14</link>
        <pubDate>Tue, 04 Aug 2009 02:51:42 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-14</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@Jython super_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/jython">@Jython</a> wrote:</p>
          <blockquote>
              <p>Taharok, I could’ve sworn it was also inside a 317 deob I had… Or maybe it was a different revision.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/13</link>
        <pubDate>Tue, 04 Aug 2009 01:23:48 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-13</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@mod_taharok Taharok]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mod_taharok">@mod_taharok</a> wrote:</p>
          <blockquote>
              <p>[quote=“oksuper_, post:11, topic:292364”]PS it is registration:<br>
<a href="http://pastebin.com/m348f43b3%5B/quote%5D" class="onebox" target="_blank" rel="nofollow noopener">http://pastebin.com/m348f43b3[/quote]</a></p>
<p>Interesting. They had similar code in the 194 client, then it disappeared for a few hundred versions:</p>
<pre><code class="lang-auto">	public final void performRegistration(String username, String password, int i) {
		try {
			loginStatus1 = "";
			loginStatus2 = "Connecting to server...";
			drawStartupScreen();
			clientStream = new ClientStream(this, openSocket(43594 + portOffset));
			clientStream.read(inBuffer.buffer, 0, 8);
			inBuffer.position = 0;
			serverSessionKey = inBuffer.getLong();
			clientBuffer.position = 0;
			clientBuffer.put(10);
			clientBuffer.putInt((int) Math.random() * 99999999);
			clientBuffer.putInt((int) Math.random() * 99999999);
			clientBuffer.putLong(serverSessionKey);
			clientBuffer.putInt(i);
			clientBuffer.putRSString(username);
			clientBuffer.putRSString(password);
			//rsaBuffer.encrypt(publicRSAKey, privateRSAKey);
			outputBuffer.position = 0;
			outputBuffer.put(17);
			outputBuffer.put(clientBuffer.position);
			outputBuffer.put((clientBuffer.buffer), 0, clientBuffer.position);
			clientStream.write(outputBuffer.buffer, 0, outputBuffer.position);
			int response = clientStream.read();

			if (response == 1) {
				try {
					Thread.sleep(2000L);
				} catch (Exception exception) { }
				performRegistration(username, password, i);
			} else if (response == 2) {
				loginStatus1 = "Username already taken.";
				loginStatus2 = "Please choose a different name.";
			} else if (response == 3) {
				loginScreenPage = 2;
				performLogin(loginUsername, loginPassword, i, false);
			}
		} catch (IOException ioexception) {
			loginStatus1 = "";
			loginStatus2 = "Error connecting to server.";
		}
	}</code></pre>
<pre><code class="lang-auto">		if (loginScreenPage == 1 || loginScreenPage == 2) {
			int i_657 = i_653 / 2 - 50;

			if (loginStatus1.length() &gt; 0) {
				dialogInputArea.drawMulticolorCenteredX(loginStatus1, i / 2,
						i_657 - 15, 16776960, true);
				dialogInputArea.drawMulticolorCenteredX(loginStatus2, i / 2, i_657,
						16776960, true);
				i_657 += 30;
			} else {
				dialogInputArea.drawMulticolorCenteredX(loginStatus2, i / 2, i_657 - 7,
						16776960, true);
				i_657 += 30;
			}
			dialogInputArea.drawMulticolor(("Username: " + loginUsername
					+ ((loginFieldIndex == 0 &amp; successfulUpdateCode % 40 &lt; 20) ? "@yel@|" : "")), i / 2 - 90, i_657,
					16777215, true);
			i_657 += 15;
			dialogInputArea.drawMulticolor(("Password: " + TextClass.hideCharacters(loginPassword)
					+ (loginFieldIndex == 1 &amp; successfulUpdateCode % 40 &lt; 20 ? "@yel@|" : "")), i / 2 - 88, i_657,
					16777215, true);
			i_657 += 15;
			if (loginScreenPage == 1) {
				dialogInputArea.drawMulticolor(("Confirm Password: "
						+ TextClass.hideCharacters(confirmLoginPassword)
						+ (loginFieldIndex == 2 &amp; successfulUpdateCode % 40 &lt; 20 ? "@yel@|" : "")), i / 2 - 143, i_657,
						16777215, true);
			}
			int i_658 = i / 2 - 80;
			int i_659 = i_653 / 2 + 40;

			titleButton.draw(i_659 - 20, i_658 - 73);
			if (loginScreenPage == 1) {
				dialogInputArea.drawMulticolorCenteredX("Create", i_658, i_659 + 5,
						16777215, true);
			} else {
				dialogInputArea.drawMulticolorCenteredX("Login", i_658, i_659 + 5,
						16777215, true);
			}
			i_658 = i / 2 + 80;
			titleButton.draw(i_659 - 20, i_658 - 73);
			dialogInputArea.drawMulticolorCenteredX("Cancel", i_658, i_659 + 5,
					16777215, true);
		}</code></pre>
<p>Note that the above code was implemented into the 194, but wasn’t “activated”. There’s no way to see the registration page without physically changing the client.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/12</link>
        <pubDate>Tue, 04 Aug 2009 01:01:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-12</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@Jython super_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/jython">@Jython</a> wrote:</p>
          <blockquote>
              <p>PS it is registration:<br>
<a href="http://pastebin.com/m348f43b3" class="onebox" target="_blank" rel="nofollow noopener">http://pastebin.com/m348f43b3</a></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/11</link>
        <pubDate>Tue, 04 Aug 2009 00:26:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-11</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>the first method is to create an account, in recent versions it is expanded to contain the email field and related options</p>
<p>the second checks the validity of a chosen username or password</p>
<p>edit: chances are this was in development during that version release and that is why it is only available when run as local</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/10</link>
        <pubDate>Mon, 03 Aug 2009 21:34:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-10</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@Jython super_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/jython">@Jython</a> wrote:</p>
          <blockquote>
              <p>Much love frank_, that would help.:)[br][br][size=1]Posted on: August 03, 2009, 07:56:23 pm[/size][hr]Possibly solved!</p>
<blockquote>Peter says:
 Are you there?
super_ says:
 yo
Peter says:
 About your strange code from the client
 its the staff local login block
 it gets called when you run the client as local
super_ says:
 oh shit
 really
Peter says:
 the reason why you cant trace it to login is that its called and processed by a script
super_ says:
 yeah
 figured that much out
 it is processed by
 clientscript VM
 already figured it out
Peter says:
 i was confused about this when i madea 521, i ran it as local and the login was deifferent than the (standard) code from thew client i looked at
super_ says:
<p>mind if i copy this convo onto thread?<br>
Peter says:<br>
then i noticed it only happened with modewhere on 2 / local<br>
you can copy it<br>
super_ says:</p>
<p>thanks</p>
</blockquote><br>
from peterbjornx
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/9</link>
        <pubDate>Mon, 03 Aug 2009 12:32:20 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-9</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>i will have a look as soon as i am able <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=5" title=":wink:" class="emoji" alt=":wink:"> looks interesting</p>
<p>[quote=“unlimitedorb, post:4, topic:292364”][quote author=BAsh link=topic=386264.msg2895226#msg2895226 date=1249170521]<br>
I know nothing about the code but judging by the Math.random() calls it might be code to test the random number generator to prevent the hacks that stop the game screen from turning.<br>
[/quote]</p>
<p>It’s padding to prevent RSA plaintext attacks, etc.[/quote]<br>
the nonce stops replay attacks, not known/chosen plaintex attacks</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/8</link>
        <pubDate>Mon, 03 Aug 2009 09:50:03 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-8</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@peterbjornx peterbjornx]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/peterbjornx">@peterbjornx</a> wrote:</p>
          <blockquote>
              <p>Theres 2 loginblocks in runescape, location local uses block 2</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/7</link>
        <pubDate>Sun, 02 Aug 2009 14:48:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-7</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@light232 light232]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/light232">@light232</a> wrote:</p>
          <blockquote>
              <p>its is sent before the login block(big one), its been there since pvp worlds</p>
<p><code>lass18.anInt284 = -3;
		Class7.anInt188 = 0;
		Class115_Sub18_Sub36.anInt4669 = 1;
		Class28.anInt487 = 0;</code><br>
one of those variables is the login stage, it does infact send the username and password<br>
there are 2 of these methods, one is sent for normal worlds, another is sent for pvp worlds</p>
<p>from 552(srry didnt think of renaming it):</p>
<p><code>		    class104_sub25.method1369((byte) -115, 10);//signals this was deciphered correctly
		    class104_sub25.method1368((int) (Math.random() * 9.9999999E7), (byte) 118);
		    class104_sub25.method1341(Class165.method2301(false, Canvas_Sub2.aString52), (byte) 7);//username for sure
		    class104_sub25.method1368((int) (Math.random() * 9.9999999E7), (byte) -125);
		    class104_sub25.method1357(Class104_Sub25.aString4010, 0);//password 4shure
		    class104_sub25.method1368((int) (Math.random() * 9.9999999E7), (byte) -79);
		    class104_sub25.method1338(-126, Class104_Sub13.aBigInteger3742, (Class104_Sub28_Sub13.aBigInteger5400));//encrypts
		    Class89.aClass104_Sub25_Sub1_1297.anInt4020 = 0;
		    Class89.aClass104_Sub25_Sub1_1297.method1369((byte) -110, 24);//op
		    Class89.aClass104_Sub25_Sub1_1297.method1369((byte) -109, class104_sub25.anInt4020 + 2);
		    Class89.aClass104_Sub25_Sub1_1297.method1375(552, (byte) 125);//client vr
		    Class89.aClass104_Sub25_Sub1_1297.method1363(0, 3009, class104_sub25.anInt4020, class104_sub25.aByteArray3962);//to out buffer</code></p>
<p>havnt done much more research on it than that</p>
<p>~Godsent</p>
<p>edit:</p>
<pre><code class="lang-auto">Class104_Sub28_Sub16.anInt5437 = 3;</code></pre>
<p>(from 552)</p>
<pre><code class="lang-auto">Class18.anInt284 = 3;</code></pre>
<p>(from 531)<br>
it is the ‘response code’ that we send when a password wrong(etc.) or we send 2 in response to login block being correct and no errors while decoding it<br>
so it does have something to do with login<br>
<img src="http://static.zybez.net/img/genimg/gettingstart/login.gif" alt width="" height=""><br>
the response code represents the text that replaces the “enter your…”(response code 3)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/6</link>
        <pubDate>Sun, 02 Aug 2009 01:47:34 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-6</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@Jython super_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/jython">@Jython</a> wrote:</p>
          <blockquote>
              <p>[quote=“unlimitedorb, post:4, topic:292364”][quote author=BAsh link=topic=386264.msg2895226#msg2895226 date=1249170521]<br>
I know nothing about the code but judging by the Math.random() calls it might be code to test the random number generator to prevent the hacks that stop the game screen from turning.<br>
[/quote]</p>
<p>It’s padding to prevent RSA plaintext attacks, etc.[/quote]</p>
<p>Didn’t think of that… but disregarding that it’s still a little confusing.[br][br][size=1]Posted on: August 02, 2009, 01:01:50 am[/size][hr]I’ve figured out there are 3 RSA encrypted blocks inside the RuneScape client. These two and the login block.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/5</link>
        <pubDate>Sun, 02 Aug 2009 00:20:45 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-5</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@unlimitedorb unlimitedorb]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/unlimitedorb">@unlimitedorb</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="2" data-topic="292364">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/bash/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> BAsh:</div>
<blockquote>
<p>I know nothing about the code but judging by the Math.random() calls it might be code to test the random number generator to prevent the hacks that stop the game screen from turning.</p>
</blockquote>
</aside>
<p>It’s padding to prevent RSA plaintext attacks, etc.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/4</link>
        <pubDate>Sun, 02 Aug 2009 00:18:51 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-4</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@Jython super_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/jython">@Jython</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="2" data-topic="292364">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/bash/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> BAsh:</div>
<blockquote>
<p>I know nothing about the code but judging by the Math.random() calls it might be code to test the random number generator to prevent the hacks that stop the game screen from turning.</p>
</blockquote>
</aside>
<p>Thanks for at least trying but I highly doubt that <img src="https://forum.moparisthebest.com/images/emoji/twitter/frowning.png?v=5" title=":frowning:" class="emoji" alt=":frowning:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/3</link>
        <pubDate>Sun, 02 Aug 2009 00:03:06 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-3</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@BAsh BAsh]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/bash">@BAsh</a> wrote:</p>
          <blockquote>
              <p>I know nothing about the code but judging by the Math.random() calls it might be code to test the random number generator to prevent the hacks that stop the game screen from turning.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/2</link>
        <pubDate>Sat, 01 Aug 2009 23:48:41 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-2</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
      <item>
        <title>Mysterious code</title>
        <dc:creator><![CDATA[@Jython super_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/jython">@Jython</a> wrote:</p>
          <blockquote>
              <p><code>    public static void method567(int i_7_, int i_8_, Class17 class17,
				 long l, int i_9_, int i_10_) {
	Buffer buffer = new Buffer(128);
	buffer.putByte(10);
	buffer.putShort((int) (Math.random() * 99999.0));
	buffer.putShort(531);
	buffer.putLong(l);
	buffer.putInt((int) (9.9999999E7 * Math.random()));
	buffer.putString(class17);
	buffer.putInt((int) (Math.random() * 9.9999999E7));
	buffer.putShort(Class34.anInt640);
	buffer.putByte(i_9_);
	buffer.putByte(i_10_);
	buffer.putInt((int) (Math.random() * 9.9999999E7));
	buffer.putShort(i_7_);
	buffer.putShort(i_8_);
	buffer.putInt((int) (Math.random() * 9.9999999E7));
	buffer.applyRSA(Class115_Sub21.RSA_EXPONENT, Class13.RSA_MODULUS);
	Class115_Sub18_Sub25.outputBuffer.offset = 0;
	Class115_Sub18_Sub25.outputBuffer.putByte(3);
	Class115_Sub18_Sub25.outputBuffer.putByte(buffer.offset);
	Class115_Sub18_Sub25.outputBuffer.putBytes(0, buffer.data, buffer.offset);
	// ?? vars below
	Class115_Sub18_Sub5.anInt4148 = -3;
	Class112.anInt1988 = 0;
	Class64.anInt1194 = 1;
	Class98.anInt1799 = 0;
    }</code><br>
Discuss <img src="https://forum.moparisthebest.com/images/emoji/twitter/expressionless.png?v=5" title=":expressionless:" class="emoji" alt=":expressionless:"><br>
It appears to be writing a packet similar to that of the login block but smaller (it’s also RSA encrypted at the end like the login block) this is only ever called when in a clientscript instruction’s handling code.</p>
<pre><code class="lang-auto">											    if (opcode == 5605) {
												intStackPtr -= 4;
												stringStackPtr -= 2;
												if (Class132.anInt2411 == 12) {
												    if (Class115_Sub18_Sub36.anInt4669 == 0 &amp;&amp; Class115_Sub18_Sub5.anInt4152 == 0 &amp;&amp; Class64.anInt1194 == 0 &amp;&amp; Class115_Sub25_Sub11.anInt4919 == 0)
													Class51_Sub2_Sub1.method567(Class26.intStack[2 + intStackPtr], Class26.intStack[intStackPtr + 3], Class123.stringStack[stringStackPtr + 1], Class123.stringStack[stringStackPtr].encode(), Class26.intStack[intStackPtr], Class26.intStack[1 + intStackPtr]);
												}
												break;
											    }</code></pre>
<p>Anybody have a clue as to what it’s purpose is?<br>
NOTE: This is from a 531 client decompiled deob because it’s the latest one I have at hand.</p>
<p>Found another block similar.</p>
<p><code>        public static void method82(Class17 class17, int i_13_,
				Class17 class17_14_) {
	try {
	    Class43_Sub7.aClass17_3040 = class17;
	    Class43_Sub7.aClass17_3039 = class17_14_;
	    Class115_Sub13.anInt3378 = i_13_;
	    if (Class43_Sub7.aClass17_3039
		    .method164(Class43_Sub7.aClass17_3037, (byte) -120)
		|| Class43_Sub7.aClass17_3040
		       .method164(Class43_Sub7.aClass17_3037, (byte) -122))
		Class18.anInt284 = 3;
	    else if ((Class37.anInt682 ^ 0xffffffff) != 0)
		Class51_Sub1.method555(i ^ 0x6a);
	    else {
		Class18.anInt284 = -3;
		Class7.anInt188 = 0;
		Class115_Sub18_Sub36.anInt4669 = 1;
		Class28.anInt487 = 0;
                // ?? vars above
		Buffer buffer = new Buffer(128);
		buffer.putByte(10);
		buffer.putShort((int) (99999.0 * Math.random()));
		buffer.putShort(531);
		buffer.putLong(Class43_Sub7.aClass17_3039.encode());
		buffer.putInt((int) (Math.random() * 9.9999999E7));
		buffer.putString(Class43_Sub7.aClass17_3040);
		buffer.putInt((int) (9.9999999E7 * Math.random()));
		buffer.applyRSA(Class115_Sub21.RSA_EXPONENT, Class13.RSA_MODULUS);
		Class115_Sub18_Sub25.outputBuffer.offset = 0;
		Class115_Sub18_Sub25.outputBuffer.putByte(239);
		Class115_Sub18_Sub25.outputBuffer.putByte(buffer.offset);
		Class115_Sub18_Sub25.outputBuffer.putBytes(0, buffer.data, buffer.offset);
	    }
	} catch (RuntimeException runtimeexception) {
	    throw Class136.method1926(runtimeexception,
				      ("ah.D("
				       + (class17 != null ? "{...}" : "null")
				       + ',' + i + ',' + i_13_ + ','
				       + (class17_14_ != null ? "{...}"
					  : "null")
				       + ')'));
	}
    }</code><br>
Called via the clientscript VM instruction handler:</p>
<p><code>											    if (opcode == 5602) {
												int i_187_ = Class26.intStack[--intStackPtr];
												stringStackPtr -= 2;
												Class17 class17 = Class123.stringStack[stringStackPtr + 1];
												Class17 class17_188_ = Class123.stringStack[stringStackPtr];
												if (Class132.anInt2411 == 12) {
												    if (Class115_Sub18_Sub36.anInt4669 == 0 &amp;&amp; Class115_Sub18_Sub5.anInt4152 == 0 &amp;&amp; Class64.anInt1194  == 0 &amp;&amp; Class115_Sub25_Sub11.anInt4919 == 0)
													Class4.method82(class17, i_187_, class17_188_);
												}
												break;
											    }</code></p>
<p>Odd, both methods are only called after a certain number of what I think are just flags are 0… these flags are the exact same. Both methods are also only called if anInt2411 equal 12.<br>
Here’s my hunch: since these are called through the clientscript VM, they are obviously close in contact with Jagex’s Widget/Interface system. What comes to mind is ‘friend server’, do you think these are used to login to the friend server? Anyone have any other possibilites?</p>
<ul>
<li>Hopes semaphore happens to drop by today *</li>
</ul>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/mysterious-code/292364/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/mysterious-code/292364/1</link>
        <pubDate>Sat, 01 Aug 2009 23:31:50 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-292364-1</guid>
        <source url="https://forum.moparisthebest.com/t/mysterious-code/292364.rss">Mysterious code</source>
      </item>
  </channel>
</rss>
