<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/help-really-bad-need-help-asap/282404 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 13:58:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Help really bad need help asap! - Runescape - moparisthebest.com</title>
    <meta name="description" content="when im running server i get this and then it nulls the hell out of my server witch make it lagg like hell NOTE (ip) NULLERS IP I DIDENT WANT TO SHOW THE NULLERS IP  

 Disconnecting bugged player null
java.lang.NullPoin&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="282404.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Help really bad need help asap!&#39;" href="282404.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/help-really-bad-need-help-asap/282404" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/help-really-bad-need-help-asap/282404" />
<meta property="og:title" content="Help really bad need help asap!" />
<meta name="twitter:title" content="Help really bad need help asap!" />
<meta property="og:description" content="when im running server i get this and then it nulls the hell out of my server witch make it lagg like hell  NOTE (ip) NULLERS IP I DIDENT WANT TO SHOW THE NULLERS IP  Disconnecting bugged player null java.lang.NullPointerException         at stream.createFrame(stream.java:36)         at client.logout(client.java:9484)         at PlayerHandler.saveGame(PlayerHandler.java:379)         at PlayerHandler.removePlayer(PlayerHandler.java:371)         at PlayerHandler.process(PlayerHandler.java:258)    ..." />
<meta name="twitter:description" content="when im running server i get this and then it nulls the hell out of my server witch make it lagg like hell  NOTE (ip) NULLERS IP I DIDENT WANT TO SHOW THE NULLERS IP  Disconnecting bugged player null java.lang.NullPointerException         at stream.createFrame(stream.java:36)         at client.logout(client.java:9484)         at PlayerHandler.saveGame(PlayerHandler.java:379)         at PlayerHandler.removePlayer(PlayerHandler.java:371)         at PlayerHandler.process(PlayerHandler.java:258)    ..." />
<meta property="article:published_time" content="2009-06-06T04:11:37+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="282404.html">Help really bad need help asap!</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-06-06T04:11:37Z'>
            <time itemprop='dateModified' datetime='2016-07-31T08:17:08Z' class='post-time'>
              July 31, 2016,  8:17am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>when im running server i get this and then it nulls the hell out of my server witch make it lagg like hell<br>
NOTE (ip) NULLERS IP I DIDENT WANT TO SHOW THE NULLERS IP</p>
<p><code>Disconnecting bugged player null
java.lang.NullPointerException
        at stream.createFrame(stream.java:36)
        at client.logout(client.java:9484)
        at PlayerHandler.saveGame(PlayerHandler.java:379)
        at PlayerHandler.removePlayer(PlayerHandler.java:371)
        at PlayerHandler.process(PlayerHandler.java:258)
        at process.run(process.java:23)
        at java.lang.Thread.run(Unknown Source)
ClientHandler: Client null disconnected (ip)
socket closed
java.net.SocketException: socket closed
        at java.net.SocketInputStream.socketRead0(Native Method)
        at java.net.SocketInputStream.read(Unknown Source)
        at client.fillInStream(client.java:8126)
        at client.run(client.java:16813)
        at java.lang.Thread.run(Unknown Source)
Disconnecting bugged player null
java.lang.NullPointerException
        at stream.createFrame(stream.java:36)
        at client.logout(client.java:9484)
        at PlayerHandler.saveGame(PlayerHandler.java:379)
        at PlayerHandler.removePlayer(PlayerHandler.java:371)
        at PlayerHandler.process(PlayerHandler.java:258)
        at process.run(process.java:23)
        at java.lang.Thread.run(Unknown Source)
ClientHandler: Client null disconnected (ip)
socket closed
java.net.SocketException: socket closed
        at java.net.SocketInputStream.socketRead0(Native Method)
        at java.net.SocketInputStream.read(Unknown Source)
        at client.fillInStream(client.java:8126)
        at client.run(client.java:16813)
        at java.lang.Thread.run(Unknown Source)</code></p>
<p>and i show u the files now</p>
<pre><code class="lang-auto">	static {
		for (int i = 0; i &lt; 32; i++)
			bitMaskOut[i] = (1 &lt;&lt; i) - 1;
	}

	public int bitPosition = 0;

	public byte buffer[] = null;

	public int currentOffset = 0;

	private int frameStack[] = new int[frameStackSize];

	private int frameStackPtr = -1;

	public Cryption packetEncryption = null;

	public stream() {
	}

	public stream(byte abyte0[]) {
		buffer = abyte0;
		currentOffset = 0;
	}

	public void createFrame(int id) {
		if (currentOffset + 2 &gt;= buffer.length)
			return;
		try {
buffer[currentOffset++] = (byte) (id + packetEncryption//([COLOR="Red"]line 36 here[/COLOR]
					.getNextKey());
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public void createFrameVarSize(int id) { // creates a variable sized frame
		if (currentOffset + 2 &gt;= buffer.length)
			return;
		buffer[currentOffset++] = (byte) (id + packetEncryption.getNextKey());
		buffer[currentOffset++] = 0; // place holder for size byte
		if (frameStackPtr &gt;= frameStackSize - 1) {
			throw new RuntimeException("Stack overflow");
		} else
			frameStack[++frameStackPtr] = currentOffset;
	}</code></pre>
<p>client.java</p>
<p><code>		try {
			line = characterfile.readLine();
		} catch (IOException ioexception) {
			misc.println(playerName + ": error loading file.");
			return 3;
		}
		while ((EndOfFile == false) &amp;&amp; (line != null)) {
			line = line.trim();
			int spot = line.indexOf("=");
			if (spot &gt; -1) {
				token = line.substring(0, spot);
				token = token.trim();
				token2 = line.substring(spot + 1);
				token2 = token2.trim();
				token3 = token2.split("\t");
				switch (ReadMode) {
				case 1:
					if (token.equals("character-username")) {
						if (playerName.equalsIgnoreCase(token2)) {
						} else {
							saveNeeded = false;
							validClient = false;
							return 3;
						}
					} else if (token.equals("character-password")) {
						if (playerPass.equalsIgnoreCase(token2)) {
						} else {
							saveNeeded = false;
							validClient = false;
							return 3;
						}
					}
					break;
				case 2:
					if (token.equals("character-height")) {
						heightLevel = Integer.parseInt(token2);
					} else if (token.equals("character-posx")) {
						toX = Integer.parseInt(token2) == -1 ? 3088
								: Integer.parseInt(token2);
					} else if (token.equals("character-posy")) {
						toY = Integer.parseInt(token2) == -1 ? 3500
								: Integer.parseInt(token2); [COLOR="Red"]line 9484 here[/COLOR]//
					} else if (token.equals("character-rights")) {
						playerRights = Integer.parseInt(token2);
					} else if (token.equals("character-lastconnection")) {
						playerLastConnect = token2;
					} else if (token.equals("character-special")) {
						specialAmount = Integer.parseInt(token2);
					} else if (token.equals("character-tz")) {
						TzWave = Integer.parseInt(token2);
					} else if (token.equals("character-starter")) {
						starter = Integer.parseInt(token2);
					} else if (token.equals("character-pouch1")) {
						smallPouch = Integer.parseInt(token2);
					} else if (token.equals("character-pouch2")) {
						mediumPouch = Integer.parseInt(token2);
					} else if (token.equals("character-pouch3")) {
						largePouch = Integer.parseInt(token2);
					} else if (token.equals("character-pouch4")) {
						giantPouch = Integer.parseInt(token2);
					} else if (token.equals("character-energy")) {</code></p>
<p>playerhandler.java there 2 line in this</p>
<p>[CODE]			// iptables -I INPUT -s <a href="http://my89-104-38-48.mynow.co.uk/">my89-104-38-48.mynow.co.uk</a> -j DROP<br>
// at first, parse all the incoming data<br>
// this has to be seperated from the outgoing part because we have<br>
// to keep all the player data<br>
// static, so each client gets exactly the same and not the one<br>
// clients are ahead in time<br>
// than the other ones.<br>
for (int i = 0; i &lt; maxPlayers; i++) {<br>
try {<br>
if (players[i] == null/* || !players[i].isActive */)<br>
continue;<br>
if (!players[i].disconnected &amp;&amp; !players[i].isActive) {<br>
if (players[i].violations &gt; 20) {<br>
System.out.println("Disconnecting bugged player "<br>
+ players[i].playerName);<br>
removePlayer(players[i]);//[COLOR=“Red”]line 258[/COLOR]<br>
players[i] = null;<br>
continue;<br>
} else {<br>
players[i].violations++;<br>
continue;<br>
}<br>
}<br>
if (players[i].disconnected)<br>
continue;</p>
<pre><code>				players[ i ].preProcessing();
				players[ i ].process();
				while(players[ i ].packetProcess());
				players[ i ].postProcessing();

				players[i].getNextPlayerMovement();

				if (players[i].disconnected) {
					client p = (client) players[i];
					if (p.inTrade) {
						client p2 = (client) players[p.trade_reqId];
						p.declineTrade();
					}[/CODE]
</code></pre>
<p>line 379 and 371</p>
<p>[CODE]public void removePlayer(Player plr) {<br>
if (plr == null)<br>
return;<br>
if (plr.Privatechat != 2) { // PM System<br>
for (int i = 1; i &lt; maxPlayers; i++) {<br>
if ((players[i] == null) || (players[i].isActive == false)<br>
|| (players[i].playerName == null))<br>
continue;<br>
players[i].pmupdate(plr.playerId, 0);<br>
}<br>
}<br>
// anything can be done here like unlinking this player structure from<br>
// any of the other existing structures<br>
saveGame(plr);//[COLOR=“Red”]line 371 here[/COLOR]<br>
plr.destruct();<br>
}</p>
<pre><code>public boolean saveGame(Player plr) {
	client saving = (client) plr;
	if (saving == null)
		return false;
	saving.logout();//[COLOR="Red"]line 379[/COLOR]
	return true;
}

public void updateNPC(Player plr, stream str) {
	updateBlock.currentOffset = 0;

	str.createFrameVarSizeWord(65);
	str.initBitAccess();

	str.writeBits(8, plr.npcListSize);
	int size = plr.npcListSize;
	plr.npcListSize = 0;
	for (int i = 0; i &lt; size; i++) {
		if ((plr.RebuildNPCList == false)
				&amp;&amp; (plr.withinDistance(plr.npcList[i]) == true)) {
			plr.npcList[i].updateNPCMovement(str);
			plr.npcList[i].appendNPCUpdateBlock(updateBlock);
			plr.npcList[plr.npcListSize++] = plr.npcList[i];
		} else {
			int id = plr.npcList[i].npcId;
			plr.npcInListBitmap[id &gt;&gt; 3] &amp;= ~(1 &lt;&lt; (id &amp; 7)); // clear the
			// flag
			str.writeBits(1, 1);
			str.writeBits(2, 3); // tells client to remove this npc
			// from list
		}
	}

	// iterate through all npcs to check whether there's new npcs to add
	for (int i = 0; i &lt; NPCHandler.maxNPCSpawns; i++) {
		if (server.npcHandler.npcs[i] != null) {
			int id = server.npcHandler.npcs[i].npcId;
			if ((plr.RebuildNPCList == false)
					&amp;&amp; ((plr.npcInListBitmap[id &gt;&gt; 3] &amp; (1 &lt;&lt; (id &amp; 7))) != 0)) {
				// npc already in npcList
			} else if (plr.withinDistance(server.npcHandler.npcs[i]) == false) {[/CODE]
</code></pre>
<p>my process.java</p>
<p>[CODE]public class process extends Thread {<br>
public static final int cycleTime = 500;</p>
<pre><code>@Override
public void run() {
	int waitFails = 0;
	long lastTicks = System.currentTimeMillis();
	long totalTimeSpentProcessing = 0;
	int cycle = 0;
	while (!server.shutdownServer) {
		try {
			if (server.updateServer)
				server.calcTime();
			// could do game updating stuff in here...
			// maybe do all the major stuff here in a big loop and just do
			// the packet
			// sending/receiving in the client sub-threads. The actual packet
			// forming code
			// will reside within here and all created packets are then
			// relayed by the sub-threads.
			// This way we avoid all the sync'in issues
			// The rough outline could look like:
			server.playerHandler.process(); // updates all player related//[COLOR="Red"]line 23[/COLOR]
											// stuff
			server.npcHandler.process();
			server.itemHandler.process();
			server.shopHandler.process();
			// misc.println("objectHandler(f) process...");
			// server.objectHandler.firemaking_process();
			// doNpcs() // all npc related stuff
			// doObjects()
			// doWhatever()

			// taking into account the time spend in the processing code for
			// more accurate timing
			long timeSpent = System.currentTimeMillis() - lastTicks;
			totalTimeSpentProcessing += timeSpent;
			if (timeSpent &gt;= cycleTime) {
				timeSpent = cycleTime;
				if (++waitFails &gt; 100) {
					// shutdownServer = true;
					// misc.println("[KERNEL]: machine is too slow to run
					// this server!");
				}
			}
			try {
				Thread.sleep(cycleTime - timeSpent);
			} catch (java.lang.Exception _ex) {
			}
			lastTicks = System.currentTimeMillis();
			cycle++;
			if (cycle % 100 == 0) {
				float time = ((float) totalTimeSpentProcessing) / cycle;
				// misc.println_debug("[KERNEL]: "+(time*100/cycleTime)+"%
				// processing time");
			}
			if (server.ShutDown == true) {
				if (server.ShutDownCounter &gt;= 100) {
					server.shutdownServer = true;
				}
				server.ShutDownCounter++;
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	// shut down the server
	server.playerHandler.destruct();
	server.clientHandler.killServer();
	server.clientHandler = null;
}
</code></pre>
<p>}<br>
[/CODE]<br>
and that what i get when i get nulled</p>
<p><code>java.net.SocketException: Connection reset
        at java.net.SocketInputStream.read(Unknown Source)
        at client.fillInStream(client.java:8360)
        at client.run(client.java:17070)
        at java.lang.Thread.run(Unknown Source)
ClientHandler: Client null disconnected (ip)
Exception encountered while parsing incoming packets from Bwuk the pk.
java.lang.NullPointerException
        at misc.playerNameToInt64(misc.java:171)
        at client.parseIncomingPackets(client.java:14225)
        at client.packetProcess(client.java:16625)
        at PlayerHandler.process(PlayerHandler.java:271)
        at process.run(process.java:23)
        at java.lang.Thread.run(Unknown Source)
ClientHandler: Client Bwuk the pk disconnected (ip)
Game saved for player Naruto
ClientHandler: Client Naruto disconnected (ip)
Connection from ip:49501
[client-1-Bwuk the pk]: Loading Process Completed  [Regular player, lag: 0 ms]
null
null
null
[client-2-The 99prayer]: Fatal: couldn't find connection vertex! Dropping packet
.
ClientHandler: Client The 99prayer disconnected (ip)
null
null
null
null
Connection from ip:53946
null
[client-2-The 99prayer]: Loading Process Completed  [Regular player, lag: 1 ms]
null
null
null
null
null
null
null
Connection from ip:49502
ClientHandler: Client null disconnected (ip)
Connection from ip</code><br>
help me plz</p>
      </div>

      <meta itemprop='headline' content='Help really bad need help asap!'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/help-really-bad-need-help-asap/282404 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 13:58:03 GMT -->
</html>
