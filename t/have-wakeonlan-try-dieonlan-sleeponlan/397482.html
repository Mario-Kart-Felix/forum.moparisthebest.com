<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/have-wakeonlan-try-dieonlan-sleeponlan/397482 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Have WakeOnLan? Try DieOnLan / SleepOnLan - Technology - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;ve been using WakeOnLan with my desktop for years, it&amp;#39;s great that I can turn it on from anywhere to grab a file or two.  The painful part is shutting it down, I have to ssh into it, run &amp;#39;sudo poweroff&amp;#39; then type in my&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="397482.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Have WakeOnLan? Try DieOnLan / SleepOnLan&#39;" href="397482.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/have-wakeonlan-try-dieonlan-sleeponlan/397482" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/have-wakeonlan-try-dieonlan-sleeponlan/397482" />
<meta property="og:title" content="Have WakeOnLan? Try DieOnLan / SleepOnLan" />
<meta name="twitter:title" content="Have WakeOnLan? Try DieOnLan / SleepOnLan" />
<meta property="og:description" content="I’ve been using WakeOnLan with my desktop for years, it’s great that I can turn it on from anywhere to grab a file or two.  The painful part is shutting it down, I have to ssh into it, run ‘sudo poweroff’ then type in my password.  That is annoying to do, especially from my cell phone, so I came up with an idea.  This protocol follows the exact spec of WakeOnLan, except when it receives the ‘magic’ packet it shuts down the server.  This allows you to use any of the multitude of tools written for..." />
<meta name="twitter:description" content="I’ve been using WakeOnLan with my desktop for years, it’s great that I can turn it on from anywhere to grab a file or two.  The painful part is shutting it down, I have to ssh into it, run ‘sudo poweroff’ then type in my password.  That is annoying to do, especially from my cell phone, so I came up with an idea.  This protocol follows the exact spec of WakeOnLan, except when it receives the ‘magic’ packet it shuts down the server.  This allows you to use any of the multitude of tools written for..." />
<meta property="article:published_time" content="2011-06-02T03:16:42+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="397482.html">Have WakeOnLan? Try DieOnLan / SleepOnLan</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/technology.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Technology</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-02T03:16:42Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:09:36Z' class='post-time'>
              August 1, 2016, 12:09pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’ve been using WakeOnLan with my desktop for years, it’s great that I can turn it on from anywhere to grab a file or two.  The painful part is shutting it down, I have to ssh into it, run ‘sudo poweroff’ then type in my password.  That is annoying to do, especially from my cell phone, so I came up with an idea.</p>
<p>This protocol follows the exact spec of WakeOnLan, except when it receives the ‘magic’ packet it shuts down the server.  This allows you to use any of the multitude of tools written for WakeOnLan, I just make it listen on a different port than my card listens to for the WakeOnLan packet (9 instead of 7 for me, you can make it listen on any port though).</p>
<p>Anyway, I didn’t want to program anything, and found a pretty decent way to do it as a shell script.  You need the programs ‘socat’ and ‘xxd’, but otherwise you should have everything else.  If you have any problems, or suggestions, feel free to post them:</p>
<pre><code class="lang-auto">#!/bin/bash
iface="eth1"
death_port="9"

shutdown_cmd="poweroff"
#                                     remove before mac   | remove after mac | remove colons
mac=$(ifconfig $iface | grep HWaddr | sed "s/.*HWaddr //" | sed "s/ .*//" | sed "s/://g")
#echo "mac: '$mac'"
expected_string="ffffffffffff"
for i in {1..16}
do
	expected_string="$expected_string$mac"
done
#echo "expected_string: $expected_string"
while true; do 
	recieved_packet=$(socat -T1 UDP-LISTEN:$death_port - | xxd -p | tr -d '\n')
#	echo "recieved_packet: $recieved_packet"
	if [ "$recieved_packet" == "$expected_string" ]
	then
		echo "DOL packet recieved, shutting down..."
		$shutdown_cmd
	fi
done</code></pre>
<p>The shutdown command generally needs root access, so you might as well run the whole thing as root, but if you don’t want to you can set up sudo to allow that specific command, and then make the port one of the non-privileged ones, since you need root to listen on low ports like 9 as well.</p>
      </div>

      <meta itemprop='headline' content='Have WakeOnLan? Try DieOnLan / SleepOnLan'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/have-wakeonlan-try-dieonlan-sleeponlan/397482 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:18 GMT -->
</html>
