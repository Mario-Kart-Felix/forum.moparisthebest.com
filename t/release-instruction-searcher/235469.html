<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/release-instruction-searcher/235469 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 09 Aug 2019 04:40:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[RELEASE] Instruction Searcher - Runescape - moparisthebest.com</title>
    <meta name="description" content="Since I&amp;#39;m moving to asm, this will be useless (well most of it). It is a BCEL instruction searcher. It has some nice features, which you haven&amp;#39;t seen before, just read information above methods to know how to use it. If &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="235469.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[RELEASE] Instruction Searcher&#39;" href="235469.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/release-instruction-searcher/235469" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/release-instruction-searcher/235469" />
<meta property="og:title" content="[RELEASE] Instruction Searcher" />
<meta name="twitter:title" content="[RELEASE] Instruction Searcher" />
<meta property="og:description" content="Since I’m moving to asm, this will be useless (well most of it).  It is a BCEL instruction searcher.  It has some nice features, which you haven’t seen before, just read information above methods to know how to use it.  If you got questions just ask  /***********************************  * This is created by Qauters,			     *  * You may use it as long as you give credit!	*  ***********************************/ package com.qp.rs.updater;  import java.util.ArrayList;  import org.apache.bcel.Consta..." />
<meta name="twitter:description" content="Since I’m moving to asm, this will be useless (well most of it).  It is a BCEL instruction searcher.  It has some nice features, which you haven’t seen before, just read information above methods to know how to use it.  If you got questions just ask  /***********************************  * This is created by Qauters,			     *  * You may use it as long as you give credit!	*  ***********************************/ package com.qp.rs.updater;  import java.util.ArrayList;  import org.apache.bcel.Consta..." />
<meta property="article:published_time" content="2008-10-07T15:37:33+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="235469.html">[RELEASE] Instruction Searcher</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/qauters.html'><span itemprop='name'>qauters</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-07T15:37:33Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:10:23Z' class='post-time'>
              July 31, 2016,  2:10am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Since I’m moving to asm, this will be useless (well most of it).<br>
It is a BCEL instruction searcher.<br>
It has some nice features, which you haven’t seen before, just read information above methods to know how to use it.<br>
If you got questions just ask</p>
<pre><code class="lang-auto">/***********************************
 * This is created by Qauters,			     *
 * You may use it as long as you give credit!	*
 ***********************************/
package com.qp.rs.updater;

import java.util.ArrayList;

import org.apache.bcel.Constants;
import org.apache.bcel.classfile.LocalVariable;
import org.apache.bcel.classfile.Method;
import org.apache.bcel.generic.BranchHandle;
import org.apache.bcel.generic.CHECKCAST;
import org.apache.bcel.generic.CPInstruction;
import org.apache.bcel.generic.ClassGen;
import org.apache.bcel.generic.ConstantPoolGen;
import org.apache.bcel.generic.Instruction;
import org.apache.bcel.generic.InstructionHandle;
import org.apache.bcel.generic.InstructionList;
import org.apache.bcel.generic.LocalVariableInstruction;
import org.apache.bcel.generic.MethodGen;
import org.apache.bcel.generic.ObjectType;

/**
 * This is an instruction searcher,
 * use it to locate instructions in an easy way.
 * 
 * @author Bert
 */
public class QIS {
	private int index = -1;
	private ConstantPoolGen cp = null;
	private MethodGen mg = null;
	private InstructionList il = null;
	private InstructionHandle[] handles = null;

	/**
	 * Constructs a new QIS
	 * @param cg The ClassGen where the method belongs to.
	 * @param m The Method to search in
	 */
	public QIS(ClassGen cg, Method m)
	{
		this.cp = cg.getConstantPool();
		this.mg = new MethodGen(m, cg.getClassName(), cp);
		this.il = this.mg.getInstructionList();
		this.handles = this.il.getInstructionHandles();
	}

	/**
	 * The current instruction list, usefull if you delete instructions.
	 * Note: If you delete instructions, you may still find them when you search!!!
	 * Don't delete instructions if you reloop over it later (otherwise you're bound to get errors)
	 * @return InstructionList
	 */
	public InstructionList getInstructionList()
	{
		return il;
	}

	/**
	 * Usefull if you modified the instruction list, and want to get the modified method.
	 * @return The method
	 */
	public Method getMethod()
	{
		mg.setInstructionList(il);
		mg.stripAttributes(true);
		mg.setMaxLocals();
		mg.setMaxStack();
		return mg.getMethod();
	}

	/**
	 * Get's the current index
	 * @return current index
	 */
	public int getIndex() { return this.index; }

	/**
	 * Set's the current index
	 * @param index Index to set to
	 */
	public void setIndex(int index) { this.index = index; }

	/**
	 * Get's the constant pool index, using a given constant tag and value.
	 * @param tag Tag of the constant (Like Constants.CONSTANT_INTEGER)
	 * @param value value to search for (Like new Double(3.4)), that way you can use primatives.
	 * @return index of the constant or -1 if not found.
	 */
	public int getConstantPoolIndex(byte tag, Object value)
	{
		switch(tag)
		{
		case Constants.CONSTANT_Class:
			if(value instanceof String)
			{
				return cp.lookupClass((String) value);
			}
			break;
		case Constants.CONSTANT_Double:
			if(value instanceof Double)
			{
				return cp.lookupDouble((Double) value);
			}
			break;
		case Constants.CONSTANT_Float:
			if(value instanceof Float)
			{
				return cp.lookupFloat((Float) value);
			}
			break;
		case Constants.CONSTANT_Integer:
			if(value instanceof Integer)
			{
				return cp.lookupInteger((Integer) value);
			}
			break;
		case Constants.CONSTANT_InterfaceMethodref:
			if(value instanceof MethodGen)
			{
				return cp.lookupInterfaceMethodref((MethodGen) value);
			}
			break;
		case Constants.CONSTANT_Long:
			if(value instanceof Long)
			{
				return cp.lookupLong((Long) value);
			}
			break;
		case Constants.CONSTANT_Methodref:
			if(value instanceof MethodGen)
			{
				return cp.lookupMethodref((MethodGen) value);
			}
			break;
		case Constants.CONSTANT_String:
			if(value instanceof String)
			{
				return cp.lookupString((String) value);
			}
			break;
		case Constants.CONSTANT_Utf8:
			if(value instanceof String)
			{
				return cp.lookupUtf8((String) value);
			}
		}

		return -1;
	}

	/**
	 * Get's the argument instructions of the current instruction.
	 * First dimension will be the number of arguments.
	 * Second dimension the instructions related to that argument.
	 * &lt;p/&gt;
	 * Example:
	 * &lt;br&gt;
	 * IfInstructions have two arguments. But one of them could be (GETSTATIC ICONST_M1 IXOR) etc.
	 * @return
	 */
	public InstructionHandle[][] getArgumentInstructions()
	{
		int stackConsuming = this.handles[this.index].getInstruction().consumeStack(cp);
		ArrayList&lt;InstructionHandle[]&gt; args = new ArrayList&lt;InstructionHandle[]&gt;();
		int t_index = this.index;

		while(stackConsuming &gt; 0)
		{
			ArrayList&lt;InstructionHandle&gt; instructions = new ArrayList&lt;InstructionHandle&gt;();
			
			int t_consuming = 0;
			while(t_consuming &gt;= 0)
			{
				//Previous instruction
				t_index--;
				if(t_index &lt; 0) throw new RuntimeException("Stack calculation error! More produced then consumed.");
				
				int produceStack = this.handles[t_index].getInstruction().produceStack(cp);
				int consumeStack = this.handles[t_index].getInstruction().consumeStack(cp);

				if(produceStack == Constants.UNDEFINED || consumeStack == Constants.UNDEFINED) throw new RuntimeException("Undefined instruction error!");
				if(produceStack == Constants.UNPREDICTABLE || consumeStack == Constants.UNPREDICTABLE) throw new RuntimeException("Unpredictable stack error!");
				
				instructions.add(this.handles[t_index]);
				t_consuming -= produceStack;
				t_consuming += consumeStack;
			}
			stackConsuming += t_consuming;
			args.add(instructions.toArray(new InstructionHandle[0]));
		}

		//Inverse arrays!
		InstructionHandle[][] values = args.toArray(new InstructionHandle[0][]);
		InstructionHandle[][] returnValues = new InstructionHandle[values.length][];

		for(int off = 0; off &lt; values.length; off++)
		{
			int vOff = values.length - off - 1;
			returnValues[off] = new InstructionHandle[values[vOff].length];

			for(int off2 = 0; off2 &lt; values[vOff].length; off2++)
			{
				int vOff2 = values[vOff].length - off2 - 1;
				returnValues[off][off2] = values[vOff][vOff2];
			}
		}

		return returnValues;
	}

	/**
	 * Get's the current instruction
	 * @return The current instruction or null if none
	 */
	public Instruction current()
	{
		if(this.index &lt; 0 || this.index &gt;= handles.length) return null;
		return this.handles[this.index].getInstruction();
	}

	/**
	 * Get's the current instruction handle.
	 * Usefull for getting the target etc,
	 * because bcel doesn't copy it, into the instruction.
	 * @return The current instruction handle or null if none
	 */
	public InstructionHandle currentHandle()
	{
		if(this.index &lt; 0 || this.index &gt;= handles.length) return null;
		return this.handles[this.index];
	}

	/**
	 * Get's the next instruction
	 * @return The next instruction or null if none
	 */
	public Instruction next()
	{
		this.index++;
		return current();
	}

	/**
	 * Get's previous instruction or null if none
	 * @return
	 */
	public Instruction previous()
	{
		this.index--;
		return current();
	}

	/**
	 * Get's the next instruction, using the given type.
	 * Like next(AALOAD.class) will return an AALOAD instruction!
	 * @param type the type of the instruction to find (like AALOAD.class)
	 * @return The next instruction, using the given type or null if none
	 */
	public &lt;T&gt; T next(Class&lt;T&gt; type)
	{
		for(int off = this.index + 1; off &lt; this.handles.length; off++)
		{
			if(this.handles[off].getInstruction() == null) continue; //instruction has been deleted!
			
			if(type.isAssignableFrom(this.handles[off].getInstruction().getClass()))
			{
				this.index = off;
				return type.cast(this.handles[off].getInstruction());
			}
		}
		return null;
	}

	/**
	 * Get's the previous instruction, using the given type.
	 * Like previous(AALOAD.class) will return an AALOAD instruction!
	 * @param type the type of the instruction to find (like AALOAD.class)
	 * @return The previous instruction, using the given type or null if none
	 */
	public &lt;T&gt; T previous(Class&lt;T&gt; type)
	{
		for(int off = this.index - 1; off &gt;= 0; off--)
		{
			if(this.handles[off].getInstruction() == null) continue; //instruction has been deleted!
			
			if(type.isAssignableFrom(this.handles[off].getInstruction().getClass()))
			{
				this.index = off;
				return type.cast(this.handles[off].getInstruction());
			}
		}
		return null;
	}

	/**
	 * Get's the target of the current instruction
	 * @return Index of the target, or -1 if none!
	 */
	public int getTargetIndex()
	{
		if(current() == null) return -1;
		if(!(this.handles[this.index] instanceof BranchHandle)) return -1;

		InstructionHandle target = ((BranchHandle) this.handles[this.index]).getTarget();
		if(target == null) return -1;

		for(int hOff = 0; hOff &lt; this.handles.length; hOff++)
		{
			if(this.handles[hOff].equals(target)) return hOff;
		}

		return -1;
	}

	/**
	 * Get's the next constantpool instruction using the given index
	 * @param index Index to search for
	 * @return the found CPInstruction or null
	 */
	public CPInstruction nextConstantPoolInstruction(int index)
	{
		for(int off = this.index + 1; off &lt; this.handles.length; off++)
		{
			if(this.handles[off].getInstruction() == null) continue; //instruction has been deleted!
			
			if(this.handles[off].getInstruction() instanceof CPInstruction)
			{
				if(((CPInstruction) this.handles[off].getInstruction()).getIndex() == index)
				{
					this.index = off;
					return (CPInstruction) this.handles[off].getInstruction();
				}
			}
		}

		return null;
	}

	/**
	 * Get's the previous constantpool instruction using the given index
	 * @param index Index to search for
	 * @return the found CPInstruction or null
	 */
	public CPInstruction previousConstantPoolInstruction(int index)
	{
		for(int off = this.index - 1; off &gt;= 0; off--)
		{
			if(this.handles[off].getInstruction() == null) continue; //instruction has been deleted!
			
			if(this.handles[off].getInstruction() instanceof CPInstruction)
			{
				if(((CPInstruction) this.handles[off].getInstruction()).getIndex() == index)
				{
					this.index = off;
					return (CPInstruction) this.handles[off].getInstruction();
				}
			}
		}

		return null;
	}

	/**
	 * Get's the next Local Variable Instruction, using given index and name
	 * @param index Index of the local variabel
	 * @param name Name of the instruction, or 0 if any (Constants.ILOAD etc)
	 * @return the LocalVariableInstruction or null
	 */
	public LocalVariableInstruction nextLocalVariableInstruction(int index, short name )
	{
		for(int off = this.index + 1; off &lt; this.handles.length; off++)
		{
			if(this.handles[off].getInstruction() == null) continue; //instruction has been deleted!
			
			if(this.handles[off].getInstruction() instanceof LocalVariableInstruction)
			{
				LocalVariableInstruction lvi = (LocalVariableInstruction) this.handles[off].getInstruction();
				if((name == 0 || lvi.getOpcode() == name) &amp;&amp; lvi.getIndex() == index)
				{
					this.index = off;
					return (LocalVariableInstruction) this.handles[off].getInstruction();
				}
			}
		}

		return null;
	}
	/**
	 * Get's the next local variable instruction, using the given instruction's index and name
	 * @param i The instruction containing the index
	 * @param name Name of the instruction, or 0 if any (Constants.ILOAD etc)
	 * @return The local variable instruction or null
	 * @see nextLocalVariableInstruction(int index, String name)
	 */
	public LocalVariableInstruction nextLocalVariableInstruction(Instruction i, short name)
	{
		if(!(i instanceof LocalVariableInstruction)) return null;
		return nextLocalVariableInstruction(((LocalVariableInstruction) i).getIndex(), name);
	}

	/**
	 * Get's the previous Local Variable Instruction, using given index and name
	 * @param index Index of the local variabel
	 * @param name Name of the instruction, or 0 if any (Constants.ILOAD etc)
	 * @return the LocalVariableInstruction or null
	 */
	public LocalVariableInstruction previousLocalVariableInstruction(int index, short name)
	{
		for(int off = this.index - 1; off &gt;= 0; off--)
		{
			if(this.handles[off].getInstruction() == null) continue; //instruction has been deleted!
			
			if(this.handles[off].getInstruction() instanceof LocalVariableInstruction)
			{
				LocalVariableInstruction lvi = (LocalVariableInstruction) this.handles[off].getInstruction();
				if((name == 0 || lvi.getOpcode() == name) &amp;&amp; lvi.getIndex() == index)
				{
					this.index = off;
					return (LocalVariableInstruction) this.handles[off].getInstruction();
				}
			}
		}

		return null;
	}
	/**
	 * Get's the previous local variable instruction, using the given instruction's index and name
	 * @param i The instruction containing the index
	 * @param name Name of the instruction, or 0 if any (Constants.ILOAD etc)
	 * @return The local variable instruction or null
	 * @see previousLocalVariableInstruction(int index, String name)
	 */
	public LocalVariableInstruction previousLocalVariableInstruction(Instruction i, short name)
	{
		if(!(i instanceof LocalVariableInstruction)) return null;
		return previousLocalVariableInstruction(((LocalVariableInstruction) i).getIndex(), name);
	}

	/**
	 * Get's the next CheckCast using given object type.
	 * @param type ObjectType to search for. Using null, will return null!
	 * @return the found checkcast, or null if not found.
	 */
	public CHECKCAST nextCheckCast(ObjectType type)
	{
		if(type == null) return null;

		for(int off = this.index + 1; off &lt; this.handles.length; off++)
		{
			if(handles[off].getInstruction() instanceof CHECKCAST &amp;&amp; 
					((CHECKCAST) this.handles[off].getInstruction()).getLoadClassType(this.cp).equals(type))
			{
				this.index = off;
				return (CHECKCAST) this.handles[off].getInstruction();
			}
		}

		return null;
	}

	/**
	 * Get's the previous CheckCast using given object type.
	 * @param type ObjectType to search for. Using null, will return null!
	 * @return the found checkcast, or null if not found.
	 */
	public CHECKCAST previousCheckCast(ObjectType type)
	{
		if(type == null) return null;

		for(int off = this.index - 1; off &gt;= 0; off--)
		{
			if(this.handles[off].getInstruction() instanceof CHECKCAST &amp;&amp; 
					((CHECKCAST) this.handles[off].getInstruction()).getLoadClassType(this.cp).equals(type))
			{
				this.index = off;
				return (CHECKCAST) this.handles[off].getInstruction();
			}
		}

		return null;
	}
}</code></pre>
<p>Example:</p>
<pre><code class="lang-auto">if(s.nextConstantPoolInstruction(s.getConstantPoolIndex(Constants.CONSTANT_String, "js5crc")) == null) continue;
if(s.nextCheckCast(new ObjectType("java.net.Socket")) == null) continue;
if(s.next(INVOKEVIRTUAL.class) == null) continue;
IfInstruction i = s.next(GETSTATIC.class);
InstructionHandle[][] args = s.getArgumentInstructions();</code></pre>
<p>You may want to extend it a bit (search for numbers etc), cause I didn’t need more then this so far.</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-07T15:42:25Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:10:24Z' class='post-time'>
              July 31, 2016,  2:10am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>it is trying to do too much, it also looks terrible to use</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pwnd.html'><span itemprop='name'>Pwnd</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-07T15:57:33Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:10:25Z' class='post-time'>
              July 31, 2016,  2:10am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“frank_, post:2, topic:235469”]it is trying to do too much, it also looks terrible to use[/quote]Look at BCEL in general; it’s fucking annoying to use.</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/qauters.html'><span itemprop='name'>qauters</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-07T16:35:51Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:10:26Z' class='post-time'>
              July 31, 2016,  2:10am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="2" data-topic="235469">
<div class="title">
<div class="quote-controls"></div>
 frank_:</div>
<blockquote>
<p>it is trying to do too much, it also looks terrible to use</p>
</blockquote>
</aside>
<p>Why would that be, bcel is complicated. This makes it a hell lot easier.<br>
Also it’s meant for people, who start their updater.<br>
It’s a lot better then previous released instruction searchers.<br>
Could you explain why you think s.nextFieldInstruction() is better then s.next(FieldInstruction.class). Cause you need tons of methods to find all of them.</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/yakman.html'><span itemprop='name'>yakman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-07T17:04:46Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:10:29Z' class='post-time'>
              July 31, 2016,  2:10am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i like it, especially the generic method for next(Class type)</p>
<p>i might as well post mines from ages ago, quite similar in some ways,<br>
i actually have a TODO to try to add generic methods, i just casted the return values</p>
<p>i use the linked list from InstructionHandle, while you use array indexing. any thoughts/comments?</p>
<pre><code class="lang-auto">import org.apache.bcel.classfile.*;
import org.apache.bcel.generic.*;
import java.util.NoSuchElementException;

/**
 * a class which searches through instruction lists, has a lot of overloaded methods
 * it saves its current position, so multiple calls of its method find differant instructions
 * 
 * for the methods which iterate (eg. nextFieldInstruction()), if they return dont find
 * and return null, the current instruction will be at the first/last of the list, so more
 * searching wont work, to save the current position, use getCurrentIndex()
 * and setCurrentIndex(), or resetToStart() and resetToEnd()
 * 
 * for methods which iterate (eg. nextFieldInstruction()), they start searching from the next
 * instruction, not the current one. so if you're at a field instruction, nextFieldInstruction wont
 * find it, but carry on.
 */
public class InstructionSearcher {
	
	public static final byte MODE_START = 0x01;
	public static final byte MODE_END = 0x02;
	
	protected InstructionList list;
	protected InstructionHandle current;
	protected ConstantPoolGen theCPool;
	
	/* Constructors */
	/**
	 * @param mode Whether to have the current be the first, or last in the list
	 */
	public InstructionSearcher(InstructionList list, ConstantPoolGen theCPool, byte mode) {
		if(list == null)
			throw new IllegalArgumentException("list cant be null");
		if(theCPool == null)
			throw new IllegalArgumentException("theCPool cant be null");
		if(mode != MODE_START &amp;&amp; mode != MODE_END)
			throw new IllegalArgumentException("mode has to be MODE_START or MODE_END");
		current = (mode == MODE_START ? list.getStart() : list.getEnd()); 
		this.list = list;
		this.theCPool = theCPool;
	}
	
	public InstructionSearcher(InstructionList list, ConstantPoolGen theCPool) {
		this(list, theCPool, MODE_START);
	}
	
	public InstructionSearcher(Method theMethod, String className, ConstantPoolGen theCPool, byte mode) {
		this(new MethodGen(theMethod, className, theCPool).getInstructionList(), theCPool, mode);
	}
	
	public InstructionSearcher(Method theMethod, String className, ConstantPoolGen theCPool) {
		this(theMethod, className, theCPool, MODE_START);
	}
	
	public InstructionSearcher(Method theMethod, ClassGen theClassGen, byte mode) {
		this(theMethod, theClassGen.getClassName(), theClassGen.getConstantPool(), mode);
	}

	public InstructionSearcher(Method theMethod, ClassGen theClassGen) {
		this(theMethod, theClassGen, MODE_START);
	}
	
	/* Little useful methods */

	public InstructionList getList() { return list; }
	public ConstantPoolGen getConstantPoolGen() { return theCPool; }

	public String toString() {
		return getClass().getName() + " index = " + getCurrentIndex() + " current = " + current.getPosition() + ": " + current().toString(theCPool.getConstantPool());
	}
	
	private boolean hasNext() {
		return current != list.getEnd();
	}
	
	private boolean hasPrev() {
		return current != list.getStart();
	}
	
	private void checkNext() {
		if(!hasNext())
			throw new NoSuchElementException("No more instructions in " + this);
	}
	
	private void checkPrev() {
		if(!hasPrev())
			throw new NoSuchElementException("No more instructions in " + this);
	}
	
	/* set/get methods */
	/**
	 * sets a new current, must be contained in the InstructionList
	 */
	public void setCurrent(InstructionHandle handle) {
		if(!list.contains(handle))
			throw new IllegalArgumentException("handle not contained in list");
		current = handle;
	}

	/**
	 * throws ArrayIndexOutOfBoundsException if needed
	 */
	public void setCurrentIndex(int index) {
		setCurrent(list.getInstructionHandles()[index]);
	}

	/**
	 * gets the index of the current instruction
	 * uses a linear search
	 */
	public int getCurrentIndex() {
		InstructionHandle c = list.getStart();
		for(int f = 0;; f++, c = c.getNext()) {
			if(c == current)
				return f;
			else
			if(c == list.getEnd())
				break;
		}
		throw new IndexOutOfBoundsException("current handle is not contained in list!");
		//should be not possible
	}
	
	public void resetToStart() {
		current = list.getStart();
	}
	
	public void resetToEnd() {
		current = list.getEnd();
	}
	
	public Instruction current() {
		return current.getInstruction();
	}
	
	public Instruction next() {
		checkNext();
		current = current.getNext();
		return current.getInstruction();
	}
	
	public Instruction prev() {
		checkPrev();
		current = current.getPrev();
		return current.getInstruction();
	}
	
	public Instruction next(int hopCount) {
		for(int f = 1; f &lt; hopCount; f++)
			next();
		return next();
	}
	
	public Instruction prev(int hopCount) {
		for(int f = 1; f &lt; hopCount; f++)
			prev();
		return prev();
	}
	
	/* Searching methods */
	/**
	 * Is passed to methods nextConstraint and prevConstraint.
	 */
	public static interface Constraint {
		
		boolean matches(InstructionHandle current, ConstantPoolGen theCPool);
	}
	
	public Instruction nextConstraint(Constraint con) {
		while(hasNext()) {
			current = current.getNext();
			if(con.matches(current, theCPool))
				return current.getInstruction();
		}
		return null;
	}
	
	public Instruction prevConstraint(Constraint con) {
		while(hasPrev()) {
			current = current.getPrev();
			if(con.matches(current, theCPool))
				return current.getInstruction();
		}
		return null;
	}
	
	/**
	 * starts at the beginning and searchs the entire InstructionList for
	 * the Constraint, returns its index or -1 if not found
	 */
	public int containsConstraint(Constraint con) {
		InstructionHandle c = list.getStart();
		for(int f = 0;;f++, c = c.getNext()) {
			if(con.matches(c, theCPool))
				return f;
			if(c == list.getEnd())
				break;
		}
		return -1;
	}
	
	/**
	 * iterates until it finds the next instruction which is an instance of the param
	 * or null if not found
	 * note: it is not  Class&lt;? extends Instruction&gt; to allow for searching for
	 * interfaces such as ConstantPushInstruction
	 * @param instructionClass The class to check instance for
	 */
	public Instruction nextOfType(Class&lt;?&gt; instructionClass) {
		//TODO try using generic methods here, it might work
		while(hasNext()) {
			Instruction i = next();
			if(instructionClass.isInstance(i))
				return i;
		}
		return null;
	}
	
	/**
	 * iterates until it finds the prev instruction which is an instance of the param
	 * or null if not found
	 * note: it is not  Class&lt;? extends Instruction&gt; to allow for searching for
	 * interfaces such as ConstantPushInstruction
	 * @param instructionClass The class to check instance for
	 */
	public Instruction prevOfType(Class&lt;?&gt; instructionClass) {
		while(hasPrev()) {
			Instruction i = prev();
			if(instructionClass.isInstance(i))
				return i;
		}
		return null;
	}
	
	/**
	 * iterates until it finds the next fieldinstruction which points to the
	 * constant pool index parameter
	 */
	public FieldInstruction nextFieldInstruction(int cpIndex) {
		while(hasNext()) {
			Instruction i = next();
			if(i instanceof FieldInstruction &amp;&amp; ((FieldInstruction)i).getIndex() == cpIndex)
				return (FieldInstruction)i;
		}
		return null;
	}
	
	/**
	 * iterates until it finds the prev fieldinstruction which points to the
	 * constant pool index parameter
	 */
	public FieldInstruction prevFieldInstruction(int cpIndex) {
		while(hasPrev()) {
			Instruction i = prev();
			if(i instanceof FieldInstruction &amp;&amp; ((FieldInstruction)i).getIndex() == cpIndex)
				return (FieldInstruction)i;
		}
		return null;
	}
	
	/**
	 * iterates until it finds the next fieldinstruction which has the classname, 
	 * fieldname and signature of the parameters, if the constant pool fieldref of those
	 * parameters does not exist, null is returned
	 */
	public FieldInstruction nextFieldInstruction(String class_name, String field_name, String signature) {
		int index = theCPool.lookupFieldref(class_name, field_name, signature);
		if(index == -1)
			return null;
		return nextFieldInstruction(index);
	}
	
	/**
	 * iterates until it finds the prev fieldinstruction which has the classname, 
	 * fieldname and signature of the parameters, if the constant pool fieldref of those
	 * parameters does not exist, null is returned
	 */
	public FieldInstruction prevFieldInstruction(String class_name, String field_name, String signature) {
		int index = theCPool.lookupFieldref(class_name, field_name, signature);
		if(index == -1)
			return null;
		return prevFieldInstruction(index);
	}
	
	/**
	 * iterates until it finds the next fieldinstruction which has the type signature, 
	 * of the parameter
	 */
	public FieldInstruction nextFieldInstruction(String typeSignature) {
		while(hasNext()) {
			Instruction i = next();
			if(i instanceof FieldInstruction &amp;&amp; ((FieldInstruction)i).getType(theCPool).getSignature().equals(typeSignature))
				return (FieldInstruction)i;
		}
		return null;
	}
	
	/**
	 * iterates until it finds the prev fieldinstruction which has the type signature, 
	 * of the parameter
	 */
	public FieldInstruction prevFieldInstruction(String typeSignature) {
		while(hasPrev()) {
			Instruction i = prev();
			if(i instanceof FieldInstruction &amp;&amp; ((FieldInstruction)i).getType(theCPool).getSignature().equals(typeSignature))
				return (FieldInstruction)i;
		}
		return null;
	}
	
	public FieldInstruction nextFieldInstruction(Type type) {
		return nextFieldInstruction(type.getSignature());
	}
	
	public FieldInstruction prevFieldInstruction(Type type) {
		return prevFieldInstruction(type.getSignature());
	}
	
	/**
	 * iterates until it finds the next invokeinstruction which points to the
	 * constant pool index parameter
	 * note: this family of method doesnt have nextInvokeInstruction(ClassName, MethodName, Signature)
	 * because INVOKEINTERFACE works slightly differantly, its better the user just does a lookupMethodref
	 */
	public InvokeInstruction nextInvokeInstruction(int cpIndex) {
		while(hasNext()) {
			Instruction i = next();
			if(i instanceof InvokeInstruction &amp;&amp; ((InvokeInstruction)i).getIndex() == cpIndex)
				return (InvokeInstruction)i;
		}
		return null;
	}
	
	public InvokeInstruction prevInvokeInstruction(int cpIndex) {
		while(hasPrev()) {
			Instruction i = prev();
			if(i instanceof InvokeInstruction &amp;&amp; ((InvokeInstruction)i).getIndex() == cpIndex)
				return (InvokeInstruction)i;
		}
		return null;
	}
	
	public InvokeInstruction nextInvokeInstruction(Type returnType) {
		while(hasNext()) {
			Instruction i = next();
			if(i instanceof InvokeInstruction &amp;&amp; ((InvokeInstruction)i).getReturnType(theCPool).equals(returnType))
				return (InvokeInstruction)i;
		}
		return null;
	}
	
	public InvokeInstruction prevInvokeInstruction(Type returnType) {
		while(hasPrev()) {
			Instruction i = prev();
			if(i instanceof InvokeInstruction &amp;&amp; ((InvokeInstruction)i).getReturnType(theCPool).equals(returnType))
				return (InvokeInstruction)i;
		}
		return null;
	}
	
	public ConstantPushInstruction nextConstantPushInstruction(Number value) {
		while(hasNext()) {
			Instruction i = next();
			if(i instanceof ConstantPushInstruction &amp;&amp; ((ConstantPushInstruction)i).getValue().equals(value))
				return (ConstantPushInstruction)i;
		}
		return null;
	}
	
	public ConstantPushInstruction prevConstantPushInstruction(Number value) {
		while(hasPrev()) {
			Instruction i = prev();
			if(i instanceof ConstantPushInstruction &amp;&amp; ((ConstantPushInstruction)i).getValue().equals(value))
				return (ConstantPushInstruction)i;
		}
		return null;
	}
	
	/**
	 * finds the next LDC which has the value
	 * it can be of type String, Integer, Float ect..
	 */
	public LDC nextLDC(Object value) {
		while(hasNext()) {
			Instruction i = next();
			if(i instanceof LDC &amp;&amp; ((LDC)i).getValue(theCPool).equals(value))
				return (LDC)i;
		}
		return null;
	}
	
	public LDC prevLDC(Object value) {
		while(hasPrev()) {
			Instruction i = prev();
			if(i instanceof LDC &amp;&amp; ((LDC)i).getValue(theCPool).equals(value))
				return (LDC)i;
		}
		return null;
	}
	
	public CPInstruction nextCPInstruction(int index) {
		while(hasNext()) {
			Instruction i = next();
			if(i instanceof CPInstruction &amp;&amp; ((CPInstruction)i).getIndex() == index)
				return (CPInstruction)i;
		}
		return null;
	}
	
	public CPInstruction prevCPInstruction(int index) {
		while(hasPrev()) {
			Instruction i = prev();
			if(i instanceof CPInstruction &amp;&amp; ((CPInstruction)i).getIndex() == index)
				return (CPInstruction)i;
		}
		return null;
	}
	
	public LocalVariableInstruction nextLocalVariableInstruction(int index) {
		while(hasNext()) {
			Instruction i = next();
			if(i instanceof LocalVariableInstruction &amp;&amp; ((LocalVariableInstruction)i).getIndex() == index)
				return (LocalVariableInstruction)i;
		}
		return null;
	}
	
	public LocalVariableInstruction prevLocalVariableInstruction(int index) {
		while(hasPrev()) {
			Instruction i = prev();
			if(i instanceof LocalVariableInstruction &amp;&amp; ((LocalVariableInstruction)i).getIndex() == index)
				return (LocalVariableInstruction)i;
		}
		return null;
	}
}</code></pre>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/qauters.html'><span itemprop='name'>qauters</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-07T20:12:58Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:10:43Z' class='post-time'>
              July 31, 2016,  2:10am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“yakman, post:5, topic:235469”]i like it, especially the generic method for next(Class type)</p>
<p>i might as well post mines from ages ago, quite similar in some ways,<br>
i actually have a TODO to try to add generic methods, i just casted the return values</p>
<p>i use the linked list from InstructionHandle, while you use array indexing. any thoughts/comments?</p>
<p>…[/quote]<br>
It depends on how you use it, if you often store the current instruction and reset back to it, then array indexing is faster.<br>
Every time you call getCurrentIndex, setCurrentIndex, setCurrent etc BCEL has to loop through all instructions. While indexing is just storing it.<br>
As you don’t reset the position when a search fails, you have to do it manually. Which means a full loop every time.</p>
<p>That’s why I like indexed one better. But it still remains a question of taste.</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/the_bank.html'><span itemprop='name'>the_bank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-07T20:28:07Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:10:45Z' class='post-time'>
              July 31, 2016,  2:10am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>+1<br>
Also, one thing that I added to Silver Lining’s searcher (it is the one I use) is the ability to grab the class name and field name via a single method call.  I believe it looks something like this (from memory)</p>
<p><code>
public String getClassName() {
   return ((FieldInstruction) current()).getClassName(cPool);
}
</code>I did that simply because it made the rest of the classes a little neater, and so I didn’t have to always cast to FieldInstruction whenever is came time to print the output.</p>
<p>This of course will only work if the current instruction is a FieldInstruction, so about 90% of the time.</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/qauters.html'><span itemprop='name'>qauters</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-07T20:31:14Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:10:46Z' class='post-time'>
              July 31, 2016,  2:10am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“the bank, post:7, topic:235469”]+1<br>
Also, one thing that I added to Silver Lining’s searcher (it is the one I use) is the ability to grab the class name and field name via a single method call.  I believe it looks something like this (from memory)</p>
<p><code>
public String getClassName() {
   return ((FieldInstruction) current()).getClassName(cPool);
}
</code>I did that simply because it made the rest of the classes a little neater, and so I didn’t have to always cast to FieldInstruction whenever is came time to print the output.</p>
<p>This of course will only work if the current instruction is a FieldInstruction, so about 90% of the time.[/quote]<br>
Yea, but since you are using s.next(FieldInstruction.class), you already have a FieldInstruction. So you can just call fi.getClassName(cpg) without casting first.<br>
Ofcourse, that didn’t work on Silver Lining’s one <img src="../../images/emoji/twitter/wink1bce.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ollie.html'><span itemprop='name'>Ollie</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-13T22:21:02Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:18:38Z' class='post-time'>
              July 31, 2016,  2:18am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>looks rather messy to implement, i prefer a simplistic way which maybe requires more thinking?</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/qauters.html'><span itemprop='name'>qauters</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-13T22:55:57Z'>
            <time itemprop='dateModified' datetime='2019-01-21T22:04:15Z' class='post-time'>
              January 21, 2019, 10:04pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I think s.next(FieldInstruction.class) is better then s.nextFieldInstruction(). Since you have to create tons of unneeded methods.<br>
It’s a lot easier to implement in that way, since you call the same method. Ofcourse this instruction searcher was far from complete.<br>
You would still have to implement the specific invoke instructions etc (search for signature/classname/methodname)</p>
<p>But still BCEL is pretty messy itself, ASM is much cleaner and easier to use.</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ollie.html'><span itemprop='name'>Ollie</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-14T16:44:19Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:19:37Z' class='post-time'>
              July 31, 2016,  2:19am
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i was thinking more along the lines of</p>
<p>for(Instruction i = searcher.current; searcher.patternFound; i = searcher.lookup(“FieldInstruction ILOAD ALOAD”)) {<br>
//…<br>
searcher.patternFound((FieldInstruction)i, “client”);//method injects and finalises the forloop<br>
}</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/qauters.html'><span itemprop='name'>qauters</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-14T22:29:53Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:20:07Z' class='post-time'>
              July 31, 2016,  2:20am
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Ollie, post:11, topic:235469”]i was thinking more along the lines of</p>
<p>for(Instruction i = searcher.current; searcher.patternFound; i = searcher.lookup(“FieldInstruction ILOAD ALOAD”)) {<br>
//…<br>
searcher.patternFound((FieldInstruction)i, “client”);//method injects and finalises the forloop<br>
}[/quote]<br>
How would you cast 3 instructions into 1 ^^. Also BCEL comes with an instruction finder which does it mostly like that, but also accepts basic regex.</p>
<p>It’s kinda what you like really. Anyway I had to change it quite a lot for my move to ASM which I succeeded just a minute ago <img src="../../images/emoji/twitter/stuck_out_tongue1bce.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"><br>
BCEL gave me some weird error when hooking the HD client.<br>
It managed to throw an invalid opcode exception when casting cg.replace(m, mg.getMethod()); where the mg.getMethod() is exactly the same as the m -.-</p>
<pre><code class="lang-auto"> - Downloading RuneScape - took 9235ms.
 - Deobfuscating RuneScape - took 531ms.
 - Hooking RuneScape version: 513 - took 109ms.
 - Dumping RuneScape.jar - took 266ms.
 - Downloading Loader - took 12547ms.
 - Deobfuscating Loader - took 0ms.
 - Hooking Loader - took 0ms.
 - Dumping Loader.jar - took 16ms.

 - Downloading RuneScape HD - took 7093ms.
 - Deobfuscating RuneScape HD - took 485ms.
 - Hooking RuneScape HD version: 513 - took 109ms.
 - Dumping RuneScape.jar - took 469ms.
 - Downloading Loader HD - took 3656ms.
 - Deobfuscating Loader HD - took 0ms.
 - Hooking Loader - took 0ms.
 - Dumping Loader.jar - took 31ms.</code></pre>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ollie.html'><span itemprop='name'>Ollie</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-14T22:37:40Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:20:08Z' class='post-time'>
              July 31, 2016,  2:20am
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>quaters it selects the first instruction, unless told otherwise</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/qauters.html'><span itemprop='name'>qauters</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-14T22:51:08Z'>
            <time itemprop='dateModified' datetime='2019-01-21T19:02:41Z' class='post-time'>
              January 21, 2019,  7:02pm
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>It still remains a personal thing. It just depends on how you like to work, when writing transforms.</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ollie.html'><span itemprop='name'>Ollie</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-14T23:06:47Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:20:16Z' class='post-time'>
              July 31, 2016,  2:20am
            </time>
        <span itemprop='position'>#15</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>your method looks very procedural and dire to use. you want something more dynamic and looks abit nicer to code.</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/henry.html'><span itemprop='name'>henry</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-10-15T15:56:52Z'>
            <time itemprop='dateModified' datetime='2016-07-31T02:21:03Z' class='post-time'>
              July 31, 2016,  2:21am
            </time>
        <span itemprop='position'>#16</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“qauters, post:12, topic:235469”][quote author=Ollie link=topic=310539.msg2488988#msg2488988 date=1224002659]<br>
i was thinking more along the lines of</p>
<p>for(Instruction i = searcher.current; searcher.patternFound; i = searcher.lookup(“FieldInstruction ILOAD ALOAD”)) {<br>
//…<br>
searcher.patternFound((FieldInstruction)i, “client”);//method injects and finalises the forloop<br>
}<br>
[/quote]<br>
How would you cast 3 instructions into 1 ^^. Also BCEL comes with an instruction finder which does it mostly like that, but also accepts basic regex.</p>
<p>It’s kinda what you like really. Anyway I had to change it quite a lot for my move to ASM which I succeeded just a minute ago <img src="../../images/emoji/twitter/stuck_out_tongue1bce.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"><br>
BCEL gave me some weird error when hooking the HD client.<br>
It managed to throw an invalid opcode exception when casting cg.replace(m, mg.getMethod()); where the mg.getMethod() is exactly the same as the m -.-</p>
<p>[code]</p>
<ul>
<li>
<p>Downloading RuneScape - took 9235ms.</p>
</li>
<li>
<p>Deobfuscating RuneScape - took 531ms.</p>
</li>
<li>
<p>Hooking RuneScape version: 513 - took 109ms.</p>
</li>
<li>
<p>Dumping RuneScape.jar - took 266ms.</p>
</li>
<li>
<p>Downloading Loader - took 12547ms.</p>
</li>
<li>
<p>Deobfuscating Loader - took 0ms.</p>
</li>
<li>
<p>Hooking Loader - took 0ms.</p>
</li>
<li>
<p>Dumping Loader.jar - took 16ms.</p>
</li>
<li>
<p>Downloading RuneScape HD - took 7093ms.</p>
</li>
<li>
<p>Deobfuscating RuneScape HD - took 485ms.</p>
</li>
<li>
<p>Hooking RuneScape HD version: 513 - took 109ms.</p>
</li>
<li>
<p>Dumping RuneScape.jar - took 469ms.</p>
</li>
<li>
<p>Downloading Loader HD - took 3656ms.</p>
</li>
<li>
<p>Deobfuscating Loader HD - took 0ms.</p>
</li>
<li>
<p>Hooking Loader - took 0ms.</p>
</li>
<li>
<p>Dumping Loader.jar - took 31ms.<br>
[/code][/quote]</p>
</li>
</ul>
<p>Nice work with the HD, :).  I haven’t even looked at HD yet, but I plan on making my bot use HD (or atleast have support for it, IF I make one that is lol.)</p>
      </div>

      <meta itemprop='headline' content='[RELEASE] Instruction Searcher'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/release-instruction-searcher/235469 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 09 Aug 2019 04:40:33 GMT -->
</html>
