<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/java-sound-music-player/540337 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Java sound/music player - General Programming - moparisthebest.com</title>
    <meta name="description" content="This is just a snippet showing you how you can play music using Java. This can be used for quiet a few things such as playing sound in a GUI etc. Note: The idea came from the 317 client :rolleyes: 

Since Clip.java is re&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="540337.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Java sound/music player&#39;" href="540337.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/java-sound-music-player/540337" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/java-sound-music-player/540337" />
<meta property="og:title" content="Java sound/music player" />
<meta name="twitter:title" content="Java sound/music player" />
<meta property="og:description" content="This is just a snippet showing you how you can play music using Java. This can be used for quiet a few things such as playing sound in a GUI etc.  Note: The idea came from the 317 client :rolleyes:  Since Clip.java is really rubbish and does not work and sun.audio was not an option for me I’ve made my own implementation to allow you to play sound. This method does not load the sound into memory like Clip did causing outOfMemoryExceptions (or whatever its called), and there is no delay in playing..." />
<meta name="twitter:description" content="This is just a snippet showing you how you can play music using Java. This can be used for quiet a few things such as playing sound in a GUI etc.  Note: The idea came from the 317 client :rolleyes:  Since Clip.java is really rubbish and does not work and sun.audio was not an option for me I’ve made my own implementation to allow you to play sound. This method does not load the sound into memory like Clip did causing outOfMemoryExceptions (or whatever its called), and there is no delay in playing..." />
<meta property="article:published_time" content="2014-02-19T13:13:12+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="540337.html">Java sound/music player</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ashi.html'><span itemprop='name'>Ashi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-02-19T13:13:12Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:47:24Z' class='post-time'>
              August 4, 2016, 11:47am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This is just a snippet showing you how you can play music using Java. This can be used for quiet a few things such as playing sound in a GUI etc.<br>
Note: The idea came from the 317 client :rolleyes:</p>
<p>Since Clip.java is really rubbish and does not work and sun.audio was not an option for me I’ve made my own implementation to allow you to play sound. This method does not load the sound into memory like Clip did causing outOfMemoryExceptions (or whatever its called), and there is no delay in playing the sound.</p>
<p>If you want a cheap fading system you can use setVolume() then sleep it whilst decrementing it to create a fading effect,</p>
<p>Sound.java</p>
<p>[code=java]package com.music;</p>
<p>import java.io.ByteArrayInputStream;<br>
import java.io.DataInputStream;<br>
import java.io.File;<br>
import java.io.IOException;<br>
import java.io.InputStream;<br>
import java.text.DecimalFormat;</p>
<p>import javax.sound.sampled.AudioFormat;<br>
import javax.sound.sampled.AudioInputStream;<br>
import javax.sound.sampled.AudioSystem;<br>
import javax.sound.sampled.DataLine;<br>
import javax.sound.sampled.DataLine.Info;<br>
import javax.sound.sampled.FloatControl;<br>
import javax.sound.sampled.SourceDataLine;<br>
import javax.sound.sampled.UnsupportedAudioFileException;</p>
<p>/**</p>
<ul>
<li>A simple way to play sound using Java</li>
<li>
</li>
<li>
<span class="mention">@author</span> Victoria Connelly <a href="mailto:haiix@littlevicky.net">haiix@littlevicky.net</a>
</li>
<li>
</li>
</ul>
<p><em>/<br>
public class Sound implements Runnable {<br>
/</em>*<br>
* Frame rate of the sound file<br>
*/<br>
private byte[] frames;</p>
<pre><code>/**
 * THe path of the sound file
 */
private String sound;

/**
 * If the sound is playing
 */
private boolean playing;

/**
 * The volume of the sound playing
 * range: -40F - 6F
 */
private float volume = 1F;

/**
 * The file object for the sound file
 */
private File file;


private AudioFormat format;
private AudioInputStream audioStream;
private SourceDataLine line;
private Info info;

/**
 * The thread for the sound to play on
 */
private Thread thread;

@Override
public void run() {
	start();
}

private byte[] getFrames(AudioInputStream audioStream) {
	int length = (int) (audioStream.getFrameLength() * format.getFrameSize());
	byte[] samples = new byte[length];
	
	DataInputStream input = new DataInputStream(audioStream);
	
	try {
		input.readFully(samples);
	} catch (IOException e) {
		e.printStackTrace();
	}
	
	return samples;
}

/**
 * Initiate the sound 
 */
private void start() {
	System.out.println("Started...");
	setPlaying(true);
	try {
		InputStream stream = new ByteArrayInputStream(getFrames());
		int bufferSize = format.getFrameSize() * Math.round(format.getSampleRate() / 10);
		byte[] buffer = new byte[bufferSize];
		
		info = new DataLine.Info(SourceDataLine.class, format);
        line = (SourceDataLine)AudioSystem.getLine(info);
        line.open(format, bufferSize);
        
        line.start();
        FloatControl volume = (FloatControl) line.getControl(FloatControl.Type.MASTER_GAIN);
		volume.setValue(getVolume());
       
		System.out.println("Length: " + getLength());
		
		int bytes = 0;
        while (bytes != -1) {
            bytes = stream.read(buffer, 0, buffer.length);
            if (bytes != -1) {
               line.write(buffer, 0, bytes);
            }
            volume.setValue(getVolume());
        }
	} catch (Exception e) {
		System.err.println("Error: There was an error playing " + sound);
	} finally {
        line.drain();
        line.close();
        
        try {
			audioStream.close();
		} catch (IOException e) {
			e.printStackTrace();
		}
        
        /**
         * This is here for the sake of resetting everything to null
         * after we are done with the objects.
             * - Probably not even needed lol
         */
        file = null;
        sound = null;
        info = null;
        line = null;
        thread = null;
        frames = null;
        audioStream = null;
        format = null;
        
        System.out.println("Music finished!");
        setPlaying(false);
	}
}

/**
 * Play a sound
 * 
 * @param sound
 * 	The path to the sound file
 */
public void play(String sound) {
	this.sound = sound;
	file = new File(sound);
	
	try {
		audioStream = AudioSystem.getAudioInputStream(file);
	} catch (UnsupportedAudioFileException | IOException e) {
		System.err.println("Error: There was an error playing: " + sound);
		e.printStackTrace();
	}
	
	this.format = audioStream.getFormat();
	setFrames(getFrames(audioStream));
	
	if (isPlaying()) {
		System.err.println("There is music already playing!");
		return;
	}
	thread = new Thread(this);
	thread.start();
	
}

/**
 * Inaccurate (close enough) method to get the length of the playing sound
 */
public double getLength() {
	AudioFormat format = audioStream.getFormat();
	long frames = audioStream.getFrameLength();
	
	double time = (double) frames / format.getFrameRate() / 60; 
	
	DecimalFormat df2 = new DecimalFormat("###.##");
    return Double.valueOf(df2.format(time));
}

private byte[] setFrames(byte[] frames) {
	return this.frames = frames;
}

private byte[] getFrames() {
	return frames;
}

public boolean setPlaying(boolean playing) {
	return this.playing = playing;
}

public boolean isPlaying() {
	return playing;
}

/**
 * Sets the volume of the sound
 */
public float setVolume(float volume) {
	if (volume &gt; 6F) {
		return this.volume = 7;
	}
	if (volume &lt; -40F) {
		return this.volume = -40F;
	}
	return this.volume = volume;
}

public float getVolume() {
	if (volume &gt; 6) {
		volume = 6;
	}
	return volume;
}
</code></pre>
<p>}<br>
[/code]</p>
<p>Usage:</p>
<p><code>Sound sound = new Sound();
sound.play("./Feel.wav");</code></p>
<p>Only one Sound object is needed but If you want to play more then one sound at a time you will need to create another sound instance.<br>
Note: You can use an enum or something to hold your sound files.</p>
<p>Open to suggestions on making this better.</p>
<p>Edit: FloatControl.java may not be supported on Linux or Mac. If you get a problem playing it just comment out the times related in the start() method.<br>
FloatControl is being used for the volume.</p>
      </div>

      <meta itemprop='headline' content='Java sound/music player'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/java-sound-music-player/540337 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:36 GMT -->
</html>
