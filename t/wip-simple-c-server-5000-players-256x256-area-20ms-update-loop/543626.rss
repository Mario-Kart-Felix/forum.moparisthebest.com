<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
    <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626</link>
    <description>It&#39;s not done, but it&#39;s a wip. Had an idea for fast player lookups and spent a day doing tons of micro-optimizations. Here are 5001 players in a 256x256 area simultaneously talking. Still needs more optimization. Without talking it&#39;s ~5ms. I want it 0, like RR&#39;s.

This isn&#39;t going to be anything. I just wanted to see how fast I get could make a server as a programming exercise and to test an idea. Will be completely open source when I&#39;m done, but note the source looks really bad and a lot of things are really dumb. For example, update masks are stored in an array, separate from players, to allow for faster lookups and more frequent cache hits. That alone gave me ~3ms. Stuff like that is what allows this to be as fast as it is. AMD FX-8350 @ 4.00GHz, updating running on one thread.

[img]http://i.imgur.com/X3Smghj.png[/img]

~Lin</description>
    
    <lastBuildDate>Fri, 06 Jun 2014 19:38:39 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@pure2ownage Pure_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pure2ownage">@pure2ownage</a> wrote:</p>
          <blockquote>
              <p>[quote=“jummppy, post:12, topic:543626”]Good thing I started learning c++. Now Lin my question is could i convert this to c++ or is it better to keep the c#, and add everything else in c++[/quote]C++ would obviously make it execute faster but only if implemented properly. I’d say it’s too much of a hassle, just leave it in C#.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/13</link>
        <pubDate>Fri, 06 Jun 2014 19:38:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-13</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@jummppy jummppy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/jummppy">@jummppy</a> wrote:</p>
          <blockquote>
              <p>Good thing I started learning c++. Now Lin my question is could i convert this to c++ or is it better to keep the c#, and add everything else in c++</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/12</link>
        <pubDate>Fri, 06 Jun 2014 18:31:58 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-12</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>[quote=“Lin, post:10, topic:543626”][quote author=sk8rdude461 link=topic=662508.msg4428177#msg4428177 date=1401845042]<br>
I’d go continue learning C# for this…<br>
[/quote]Don’t. If this was written in C++, it would be much faster. There are way too many overhead issues. This was going to be in C++ but C++ networking and threading is more annoying.[/quote]<br>
I learned the very basics when in school. The biggest program we did was hangman, and that code was out of a book. I was always “that guy” in class that would do extra stuff to the project. Oh god once I found out how to change colors and stuff on there, my teacher was like “the fuck you doing?”. lol.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/11</link>
        <pubDate>Wed, 04 Jun 2014 16:51:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-11</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@Lin Lin]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lin">@Lin</a> wrote:</p>
          <blockquote>
              <p>[quote=“Pure_, post:2, topic:543626”]I’ll definitely contribute to this once you git it.</p>
<p>edit: What libraries are you using, if any?[/quote]Just the .NET Framework. Asynchronous networking for sending, synchronous for receiving.</p>
<p>[quote=“lare69, post:6, topic:543626”][quote author=Jmood link=topic=662508.msg4428074#msg4428074 date=1401804067]<br>
lin you’re still alive?<br>
[/quote]<br>
^^</p>
<p>you planning on making a repository?[/quote]No.</p>
<p>[quote=“sk8rdude461, post:7, topic:543626”]I’d go continue learning C# for this…[/quote]Don’t. If this was written in C++, it would be much faster. There are way too many overhead issues. This was going to be in C++ but C++ networking and threading is more annoying.</p>
<p>[quote=“Jmood, post:8, topic:543626”]Explain some of the big changes you made to get it to run so well![/quote]Nothing big. A quad tree for neighboring player lookups, caching as much as possible (includes the whole update block, appearance block, text chat block - everything that can be done once and used again), inlining functions (again, overhead issue that wouldn’t be present in C++ because the code to inline functions isn’t fucking stupid), not using lists, optimizing bit writes, utilizing cpu cache hits, and just tweaking every little bit of code to be as optimal as possible. There are no big secrets here (although multi-threaded updating would KILL). I’ve profiled the code over 70 times and addressed everything, with work to be done. When I started, 2000 players took ~130ms.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/10</link>
        <pubDate>Wed, 04 Jun 2014 07:12:48 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-10</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@arham_4 arham 4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/arham_4">@arham_4</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="5" data-topic="543626">
<div class="title">
<div class="quote-controls"></div>
 Jmood:</div>
<blockquote>
<p>lin you’re still alive?</p>
</blockquote>
</aside>
<p>this</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/9</link>
        <pubDate>Wed, 04 Jun 2014 04:00:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-9</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@doom_j doom_j]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/doom_j">@doom_j</a> wrote:</p>
          <blockquote>
              <p>Explain some of the big changes you made to get it to run so well!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/8</link>
        <pubDate>Wed, 04 Jun 2014 01:38:12 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-8</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>I’d go continue learning C# for this…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/7</link>
        <pubDate>Wed, 04 Jun 2014 01:24:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-7</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@Clawz_fury lare69]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/clawz_fury">@Clawz_fury</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="5" data-topic="543626">
<div class="title">
<div class="quote-controls"></div>
 Jmood:</div>
<blockquote>
<p>lin you’re still alive?</p>
</blockquote>
</aside>
<p>^^</p>
<p>you planning on making a repository?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/6</link>
        <pubDate>Tue, 03 Jun 2014 22:17:14 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-6</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@doom_j doom_j]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/doom_j">@doom_j</a> wrote:</p>
          <blockquote>
              <p>lin you’re still alive?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/5</link>
        <pubDate>Tue, 03 Jun 2014 14:01:07 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-5</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@silabsoft RuneAgent]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/silabsoft">@silabsoft</a> wrote:</p>
          <blockquote>
              <p>lin out of nowhere</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/4</link>
        <pubDate>Tue, 03 Jun 2014 13:59:07 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-4</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@Encryption Encryption]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/encryption">@Encryption</a> wrote:</p>
          <blockquote>
              <p>Ouu snazzy.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/3</link>
        <pubDate>Tue, 03 Jun 2014 10:30:14 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-3</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@pure2ownage Pure_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pure2ownage">@pure2ownage</a> wrote:</p>
          <blockquote>
              <p>I’ll definitely contribute to this once you git it.</p>
<p>edit: What libraries are you using, if any?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/2</link>
        <pubDate>Tue, 03 Jun 2014 08:39:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-2</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
      <item>
        <title>[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</title>
        <dc:creator><![CDATA[@Lin Lin]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lin">@Lin</a> wrote:</p>
          <blockquote>
              <p>It’s not done, but it’s a wip. Had an idea for fast player lookups and spent a day doing tons of micro-optimizations. Here are 5001 players in a 256x256 area simultaneously talking. Still needs more optimization. Without talking it’s ~5ms. I want it 0, like RR’s.</p>
<p>This isn’t going to be anything. I just wanted to see how fast I get could make a server as a programming exercise and to test an idea. Will be completely open source when I’m done, but note the source looks really bad and a lot of things are really dumb. For example, update masks are stored in an array, separate from players, to allow for faster lookups and more frequent cache hits. That alone gave me ~3ms. Stuff like that is what allows this to be as fast as it is. AMD FX-8350 @ 4.00GHz, updating running on one thread.</p>
<p><img src="http://i.imgur.com/X3Smghj.png" alt width="" height=""></p>
<p>~Lin</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626/1</link>
        <pubDate>Tue, 03 Jun 2014 08:27:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-543626-1</guid>
        <source url="https://forum.moparisthebest.com/t/wip-simple-c-server-5000-players-256x256-area-20ms-update-loop/543626.rss">[wip] simple c# server - 5000 players, 256x256 area, ~20ms update loop</source>
      </item>
  </channel>
</rss>
