<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/minecraft-potential-map-optimization/436482 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Minecraft Potential Map Optimization - Minecraft - moparisthebest.com</title>
    <meta name="description" content="I have just been thinking about a potential map optimization, and if would really be an optimization. I don&amp;#39;t know how the client manages maps (all I know is that they went from the NBT format to Anvil) but thought about&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="436482.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Minecraft Potential Map Optimization&#39;" href="436482.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/minecraft-potential-map-optimization/436482" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/minecraft-potential-map-optimization/436482" />
<meta property="og:title" content="Minecraft Potential Map Optimization" />
<meta name="twitter:title" content="Minecraft Potential Map Optimization" />
<meta property="og:description" content="I have just been thinking about a potential map optimization, and if would really be an optimization. I don’t know how the client manages maps (all I know is that they went from the NBT format to Anvil) but thought about one way I would do it.  Since the maps are generated with biomes, then there’s really no need to store all of the blocks by their id. All you would need is to have each chunk (or chunk group) have a palette, and then have each block represent an index in that palette. This could..." />
<meta name="twitter:description" content="I have just been thinking about a potential map optimization, and if would really be an optimization. I don’t know how the client manages maps (all I know is that they went from the NBT format to Anvil) but thought about one way I would do it.  Since the maps are generated with biomes, then there’s really no need to store all of the blocks by their id. All you would need is to have each chunk (or chunk group) have a palette, and then have each block represent an index in that palette. This could..." />
<meta property="article:published_time" content="2012-03-15T22:29:07+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="436482.html">Minecraft Potential Map Optimization</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/minecraft.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Minecraft</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-03-15T22:29:07Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:35:42Z' class='post-time'>
              August 2, 2016,  4:35pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I have just been thinking about a potential map optimization, and if would really be an optimization. I don’t know how the client manages maps (all I know is that they went from the NBT format to Anvil) but thought about one way I would do it.</p>
<p>Since the maps are generated with biomes, then there’s really no need to store all of the blocks by their id. All you would need is to have each chunk (or chunk group) have a palette, and then have each block represent an index in that palette. This could also further be improved by having large areas “mapped” (since most chunks have nothing but air at &gt;= 127, you could just say “AIR everywhere” instead of the traditional way (16 bytes for each block))</p>
<p>What are your thoughts?</p>
      </div>

      <meta itemprop='headline' content='Minecraft Potential Map Optimization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sppt.html'><span itemprop='name'>sppt</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-03-16T01:15:14Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:35:47Z' class='post-time'>
              August 2, 2016,  4:35pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“zyle1992, post:1, topic:436482”]I have just been thinking about a potential map optimization, and if would really be an optimization. I don’t know how the client manages maps (all I know is that they went from the NBT format to Anvil) but thought about one way I would do it.</p>
<p>Since the maps are generated with biomes, then there’s really no need to store all of the blocks by their id. All you would need is to have each chunk (or chunk group) have a palette, and then have each block represent an index in that palette.[/quote]<br>
That’d probably fuck up modularity, and I doubt you would save much by doing so since they need to consider mods being able to add blocks as well, so you’re stuck to using an int regardless.</p>
<aside class="quote quote-modified" data-post="1" data-topic="436482">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/zyle1992/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> zyle1992:</div>
<blockquote>
<p>This could also further be improved by having large areas “mapped” (since most chunks have nothing but air at &gt;= 127, you could just say “AIR everywhere” instead of the traditional way (16 bytes for each block))</p>
</blockquote>
</aside>
<p>Isn’t this what they do already?</p>
      </div>

      <meta itemprop='headline' content='Minecraft Potential Map Optimization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-03-16T01:36:56Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:35:50Z' class='post-time'>
              August 2, 2016,  4:35pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“sppt, post:2, topic:436482”][quote author=zyle1992 link=topic=539192.msg3945822#msg3945822 date=1331850547]<br>
I have just been thinking about a potential map optimization, and if would really be an optimization. I don’t know how the client manages maps (all I know is that they went from the NBT format to Anvil) but thought about one way I would do it.</p>
<p>Since the maps are generated with biomes, then there’s really no need to store all of the blocks by their id. All you would need is to have each chunk (or chunk group) have a palette, and then have each block represent an index in that palette.<br>
[/quote]<br>
That’d probably fuck up modularity, and I doubt you would save much by doing so since they need to consider mods being able to add blocks as well, so you’re stuck to using an int regardless.</p>
<aside class="quote">
<blockquote>
<p>This could also further be improved by having large areas “mapped” (since most chunks have nothing but air at &gt;= 127, you could just say “AIR everywhere” instead of the traditional way (16 bytes for each block))</p>
</blockquote>
</aside>
<p>Isn’t this what they do already?[/quote]</p>
<p>Not to my knowledge. If i recall, they write all of the block data, and then compress each region. So if all you had was a 8x8x128 chunk as the map, there would be 8,192 blocks; then it’s a short for the block Id (I read up on the map format) as well as 3 doubles for the location, resulting in 26 bytes per block, resulting in 212KB per chunk (raw). Now, because there is a lot more change on the horizontal plane than the vertical plane, putting the Y-values first in the location improves compression. And then when you take into account the “state” of each block, it seems like it would bloat up rather quickly. Right now, one of the regions of my map is 3MB. It might not sound like a lot, but if you were to add the multiplayer aspect (like MoparCraft) where houses can be found at +/- 8000, 8000, the world would take up a lot of space. And with the new Anvil format supporting height levels of 256, that can add to it.</p>
<p>As for the blocks in the region, neither way seems very good, due to the fact that mods are so prevalent. The only thing i could think of is something like namespaces, and store the block data in definitions in a HashMap</p>
<pre><code class="lang-auto">public class Block {
    // ...
}

public static final HashMap&lt;String, Block&gt; BLOCKS = new HashMap&lt;String, Block&gt;();

static {
    BLOCKS.put("minecraft.air", new Block(...));
    BLOCKS.put("mopar.logo", new Block(...));
}</code></pre>
      </div>

      <meta itemprop='headline' content='Minecraft Potential Map Optimization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sppt.html'><span itemprop='name'>sppt</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-03-16T01:43:48Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:35:51Z' class='post-time'>
              August 2, 2016,  4:35pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“zyle1992, post:3, topic:436482”][quote author=sppt link=topic=539192.msg3945909#msg3945909 date=1331860514]</p>
<aside class="quote">
<blockquote>
<p>I have just been thinking about a potential map optimization, and if would really be an optimization. I don’t know how the client manages maps (all I know is that they went from the NBT format to Anvil) but thought about one way I would do it.</p>
<p>Since the maps are generated with biomes, then there’s really no need to store all of the blocks by their id. All you would need is to have each chunk (or chunk group) have a palette, and then have each block represent an index in that palette.</p>
</blockquote>
</aside>
<p>That’d probably fuck up modularity, and I doubt you would save much by doing so since they need to consider mods being able to add blocks as well, so you’re stuck to using an int regardless.</p>
<aside class="quote">
<blockquote>
<p>This could also further be improved by having large areas “mapped” (since most chunks have nothing but air at &gt;= 127, you could just say “AIR everywhere” instead of the traditional way (16 bytes for each block))</p>
</blockquote>
</aside>
<p>Isn’t this what they do already?<br>
[/quote]</p>
<p>Not to my knowledge. If i recall, they write all of the block data, and then compress each region. So if all you had was a 8x8x128 chunk as the map, there would be 8,192 blocks; then it’s a short for the block Id (I read up on the map format) as well as 3 doubles for the location, resulting in 26 bytes per block, resulting in 212KB per chunk (raw). Now, because there is a lot more change on the horizontal plane than the vertical plane, putting the Y-values first in the location improves compression. And then when you take into account the “state” of each block, it seems like it would bloat up rather quickly. Right now, one of the regions of my map is 3MB. It might not sound like a lot, but if you were to add the multiplayer aspect (like MoparCraft) where houses can be found at +/- 8000, 8000, the world would take up a lot of space. And with the new Anvil format supporting height levels of 256, that can add to it.</p>
<p>As for the blocks in the region, neither way seems very good, due to the fact that mods are so prevalent. The only thing i could think of is something like namespaces, and store the block data in definitions in a HashMap</p>
<p>[code=Java]<br>
public class Block {<br>
// …<br>
}</p>
<p>public static final HashMap&lt;String, Block&gt; BLOCKS = new HashMap&lt;String, Block&gt;();</p>
<p>static {<br>
BLOCKS.put(“minecraft.air”, new Block(…));<br>
BLOCKS.put(“mopar.logo”, new Block(…));<br>
}<br>
[/code][/quote]<br>
That still doesn’t really explain to me how a palette would be better than what they’re using now.</p>
<p>Also, from the wiki</p>
<blockquote>Packets for sending chunks have been updated (a full 128-high chunk is smaller than the old format, and a chunk with lots of empty space is much smaller).</blockquote>
So, I think it's safe to say they changed it so there' s a flag stating whether a layer in a chunk is empty.
      </div>

      <meta itemprop='headline' content='Minecraft Potential Map Optimization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-03-16T01:59:31Z'>
            <time itemprop='dateModified' datetime='2016-08-02T16:35:52Z' class='post-time'>
              August 2, 2016,  4:35pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“sppt, post:4, topic:436482”][quote author=zyle1992 link=topic=539192.msg3945951#msg3945951 date=1331861816]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>I have just been thinking about a potential map optimization, and if would really be an optimization. I don’t know how the client manages maps (all I know is that they went from the NBT format to Anvil) but thought about one way I would do it.</p>
<p>Since the maps are generated with biomes, then there’s really no need to store all of the blocks by their id. All you would need is to have each chunk (or chunk group) have a palette, and then have each block represent an index in that palette.</p>
</blockquote>
</aside>
<p>That’d probably fuck up modularity, and I doubt you would save much by doing so since they need to consider mods being able to add blocks as well, so you’re stuck to using an int regardless.</p>
<aside class="quote">
<blockquote>
<p>This could also further be improved by having large areas “mapped” (since most chunks have nothing but air at &gt;= 127, you could just say “AIR everywhere” instead of the traditional way (16 bytes for each block))</p>
</blockquote>
</aside>
<p>Isn’t this what they do already?</p>
</blockquote>
</aside>
<p>Not to my knowledge. If i recall, they write all of the block data, and then compress each region. So if all you had was a 8x8x128 chunk as the map, there would be 8,192 blocks; then it’s a short for the block Id (I read up on the map format) as well as 3 doubles for the location, resulting in 26 bytes per block, resulting in 212KB per chunk (raw). Now, because there is a lot more change on the horizontal plane than the vertical plane, putting the Y-values first in the location improves compression. And then when you take into account the “state” of each block, it seems like it would bloat up rather quickly. Right now, one of the regions of my map is 3MB. It might not sound like a lot, but if you were to add the multiplayer aspect (like MoparCraft) where houses can be found at +/- 8000, 8000, the world would take up a lot of space. And with the new Anvil format supporting height levels of 256, that can add to it.</p>
<p>As for the blocks in the region, neither way seems very good, due to the fact that mods are so prevalent. The only thing i could think of is something like namespaces, and store the block data in definitions in a HashMap</p>
<pre><code class="lang-auto">public class Block {
    // ...
}

public static final HashMap&lt;String, Block&gt; BLOCKS = new HashMap&lt;String, Block&gt;();

static {
    BLOCKS.put("minecraft.air", new Block(...));
    BLOCKS.put("mopar.logo", new Block(...));
}</code></pre>
<p>[/quote]<br>
That still doesn’t really explain to me how a palette would be better than what they’re using now.</p>
<p>Also, from the wiki</p>
<aside class="quote">
<div class="title">
<div class="quote-controls"></div>
 http://www.minecraftwiki.net/wiki/Anvil_file_format:</div>
<blockquote>
<p>Packets for sending chunks have been updated (a full 128-high chunk is smaller than the old format, and a chunk with lots of empty space is much smaller).</p>
</blockquote>
</aside>
<p>So, I think it’s safe to say they changed it so there’ s a flag stating whether a layer in a chunk is empty.[/quote]</p>
<p>Ah, I didn’t see that part. That’s good to know.</p>
<p>And with the palette, my idea was that there’s probably not going to be more than 255 different block types in one chunk, so it could reduce the amount of total space necessary.</p>
      </div>

      <meta itemprop='headline' content='Minecraft Potential Map Optimization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/minecraft-potential-map-optimization/436482 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:54 GMT -->
</html>
