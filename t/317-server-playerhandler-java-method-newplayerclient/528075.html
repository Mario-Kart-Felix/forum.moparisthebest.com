<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/317-server-playerhandler-java-method-newplayerclient/528075 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 16:00:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot; - Runescape - moparisthebest.com</title>
    <meta name="description" content="Hello! 

I got a 317 Delta RSPS I am programming on, but I got a tricky method I don&amp;#39;t quite understand. 

Here is the method:  

 //A new client connected...
	public void newPlayerClient(java.net.Socket s, String connec&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="528075.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot;&#39;" href="528075.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/317-server-playerhandler-java-method-newplayerclient/528075" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/317-server-playerhandler-java-method-newplayerclient/528075" />
<meta property="og:title" content="317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot;" />
<meta name="twitter:title" content="317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot;" />
<meta property="og:description" content="Hello!  I got a 317 Delta RSPS I am programming on, but I got a tricky method I don’t quite understand.  Here is the method:  [code]//A new client connected…  public void newPlayerClient(java.net.Socket s, String connectedFrom)	{  //First, search for a free slot  // int slot = -1, i = playerSlotSearchStart;  int slot = -1;  	for (int i = 1; i &lt; players.length; i++)	{ 		if ((players[i] == null) || players[i].disconnected)	{ 			slot = i; 			break; 		}	 	} 	 	Client newClient = new Client(s, slot);..." />
<meta name="twitter:description" content="Hello!  I got a 317 Delta RSPS I am programming on, but I got a tricky method I don’t quite understand.  Here is the method:  [code]//A new client connected…  public void newPlayerClient(java.net.Socket s, String connectedFrom)	{  //First, search for a free slot  // int slot = -1, i = playerSlotSearchStart;  int slot = -1;  	for (int i = 1; i &lt; players.length; i++)	{ 		if ((players[i] == null) || players[i].disconnected)	{ 			slot = i; 			break; 		}	 	} 	 	Client newClient = new Client(s, slot);..." />
<meta property="article:published_time" content="2013-08-14T13:04:49+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="528075.html">317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot;</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ole_Kristian.html'><span itemprop='name'>Ole_Kristian</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-08-14T13:04:49Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:09:50Z' class='post-time'>
              August 4, 2016, 10:09am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hello!</p>
<p>I got a 317 Delta RSPS I am programming on, but I got a tricky method I don’t quite understand.</p>
<p>Here is the method:</p>
<p>[code]//A new client connected…<br>
public void newPlayerClient(java.net.Socket s, String connectedFrom)	{<br>
//First, search for a free slot<br>
// int slot = -1, i = playerSlotSearchStart;<br>
int slot = -1;</p>
<pre><code>	for (int i = 1; i &lt; players.length; i++)	{
		if ((players[i] == null) || players[i].disconnected)	{
			slot = i;
			break;
		}	
	}
	
	Client newClient = new Client(s, slot);
	newClient.handler = this;
	(new Thread(newClient)).start();
	
	if (slot == -1)	{
		return; //No free slot found - world is full.
	}
	
	players[slot] = newClient;
	players[slot].connectedFrom = connectedFrom;
	players[slot].ip = s.getInetAddress().hashCode();
	Player.localId = slot;
	players[slot].lastPacket = System.currentTimeMillis();
	//Start at next slot when issuing the next search to speed it up
	playerSlotSearchStart = slot + 1;
	
	if (playerSlotSearchStart &gt; maxPlayers)	{
		playerSlotSearchStart = 1;
	}
	// Note that we don't use slot 0 because playerId zero does not function
	// properly with the Client.
}[/code]
</code></pre>
<p>The method is located in a class called “PlayerHandler”.</p>
<p>Here’s what I understand:</p>
<ul>
<li>The method gets called after the client’s socket gets accepted by the server’s “clientListener”.</li>
<li>The method uses information about the connection’s socket and I believe “connectedFrom” is going<br>
to be it’s IP-address?  <img src="../../images/emoji/twitter/expressionlessae52.png?v=5" title=":expressionless:" class="emoji" alt=":expressionless:">
</li>
</ul>
<p>I believe the method tries to find an open slot in a world, and if the world is full, it wants the player to try a different world? <img src="../../images/emoji/twitter/expressionlessae52.png?v=5" title=":expressionless:" class="emoji" alt=":expressionless:"></p>
<p>Could somebody please guide me trough line by line what is going on?<br>
I’m sorry if this could be asked in a general Java forum, but I want people that understands RSPS to answer it, as they would probably understand the logic in the naming of objects, method and variables.  <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Thanks!</p>
      </div>

      <meta itemprop='headline' content='317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot;'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/IfearI.html'><span itemprop='name'>IfearI</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-08-14T13:45:09Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:09:51Z' class='post-time'>
              August 4, 2016, 10:09am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Alright so, I’ll do my best to explain it a bit. (Kinda in a rush right now.)</p>
<p><code>                for (int i = 1; i &lt; players.length; i++)        {
                        if ((players[i] == null) || players[i].disconnected)        {
                                slot = i;
                                break;
                        }       
                }
</code></p>
<p>Here it searches for an “open slot.” this means that it’ll go over the array players and when the value equals null, meaning there is no player yet in that spot it saves the index of that slot to the variable slot.<br>
So now we found which slot we’ll put this new connection in.</p>
<pre><code class="lang-auto">                Client newClient = new Client(s, slot);
                newClient.handler = this;
                (new Thread(newClient)).start();
               
                if (slot == -1)        {
                        return; //No free slot found - world is full.
                }[/code]

A new instance of Client gets made, we'll name it newClient and give it as parameter the socket and the slot where we want it to go. We assign its handler and start the thread for the newClient.
If slot was found to be -1 it would mean they hadn't found an empty slot in the players array so the world is basicly full.

[code]                players[slot] = newClient;
                players[slot].connectedFrom = connectedFrom;
                players[slot].ip = s.getInetAddress().hashCode();
                Player.localId = slot;
                players[slot].lastPacket = System.currentTimeMillis();</code></pre>
<p>First they put the Client into the players array and use the free slot as index.<br>
Then they assign the proper values to the attributes if I may call it so.</p>
<p>[code]                playerSlotSearchStart = slot + 1;</p>
<pre><code>            if (playerSlotSearchStart &gt; maxPlayers)        {
                    playerSlotSearchStart = 1;
            }[/code]
</code></pre>
<p>Basicly it just assigns the value of the slot + 1 to playerSlotSearchStart so next time we could go search from that slot and don’t have to start all over searching from slot 1.</p>
<p>Then if playerSlotSearch would’ve come above the maximum amount we get it back to 1.</p>
<p>Although, I think the for loop should have an adjustment so it would actually start searching from that new slot.</p>
<p><code>                for (int i = playerSlotSearchStart; i &lt; players.length; i++)        {
                        if ((players[i] == null) || players[i].disconnected)        {
                                slot = i;
                                break;
                        }       
                }</code></p>
      </div>

      <meta itemprop='headline' content='317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot;'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ole_Kristian.html'><span itemprop='name'>Ole_Kristian</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-08-14T14:20:49Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:09:51Z' class='post-time'>
              August 4, 2016, 10:09am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thank you IfearI!</p>
<p>I appreciate all help provided and you made me understand more of the method! <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>However, I am still not <span class="bbcode-b">totally</span> sure about the whole method and still open for further information.<br>
I especially feel uncomfortable with this line right here:</p>
<pre><code class="lang-auto"></code></pre>
<p>Is “handler” a method inside the Client-class? And what does “= this;” mean?</p>
      </div>

      <meta itemprop='headline' content='317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot;'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/IfearI.html'><span itemprop='name'>IfearI</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-08-14T15:08:08Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:09:55Z' class='post-time'>
              August 4, 2016, 10:09am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Ole Kristian, post:3, topic:528075”]Thank you IfearI!</p>
<p>I appreciate all help provided and you made me understand more of the method! <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>However, I am still not <span class="bbcode-b">totally</span> sure about the whole method and still open for further information.<br>
I especially feel uncomfortable with this line right here:</p>
<pre><code class="lang-auto"></code></pre>
<p>Is “handler” a method inside the Client-class? And what does “= this;” mean?[/quote]</p>
<p>The handler is a variable of newClient. “this” refers to the instance/file where it is in. (Some weird way to explain it)</p>
<p>If you’d go to where the handler is declared you’ll see that handler’s type is “PlayerHandler”.<br>
When you set the newClient.handler’s value to “this” it actually litterally means THIS. The instance of the playerHandler wherein this code is initiated.</p>
<p>Atleast that’s how I always understood it.</p>
      </div>

      <meta itemprop='headline' content='317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot;'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ole_Kristian.html'><span itemprop='name'>Ole_Kristian</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-08-14T16:41:14Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:10:00Z' class='post-time'>
              August 4, 2016, 10:10am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yes!<br>
I found this line in “Player.java”:</p>
<pre><code class="lang-auto"></code></pre>
<p>But why is it in the Player-class?<br>
The instance “newClient” is an instance of “Client”, not “Player”…?<br>
How can we refer to the Client-object and use a method from a total different object?  <img src="../../images/emoji/twitter/expressionlessae52.png?v=5" title=":expressionless:" class="emoji" alt=":expressionless:"></p>
      </div>

      <meta itemprop='headline' content='317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot;'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/IfearI.html'><span itemprop='name'>IfearI</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-08-14T17:07:14Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:10:01Z' class='post-time'>
              August 4, 2016, 10:10am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Ole Kristian, post:5, topic:528075”]Yes!<br>
I found this line in “Player.java”:</p>
<pre><code class="lang-auto"></code></pre>
<p>But why is it in the Player-class?<br>
The instance “newClient” is an instance of “Client”, not “Player”…?<br>
How can we refer to the Client-object and use a method from a total different object?  :|[/quote]</p>
<p>If you look at Client.java, it extends the Player class.</p>
<pre><code class="lang-auto"></code></pre>
<p>When we extend an existing class, we ‘inherit’ all of the attributes, and methods, of the parent class.</p>
      </div>

      <meta itemprop='headline' content='317 Server: (PlayerHandler.java) - Method &quot;newPlayerClient&quot;'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/317-server-playerhandler-java-method-newplayerclient/528075 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 16:00:32 GMT -->
</html>
