<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/freeing-memory-in-c/442985 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 01:00:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Freeing memory in C - General Programming - moparisthebest.com</title>
    <meta name="description" content="aight so here&amp;#39;s my situation. I have a scruct, which is using the malloc function to allocate memory. When using the free function, do I need to free all the components of the scruct, and then the struct itself. or can I&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="442985.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Freeing memory in C&#39;" href="442985.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/freeing-memory-in-c/442985" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/freeing-memory-in-c/442985" />
<meta property="og:title" content="Freeing memory in C" />
<meta name="twitter:title" content="Freeing memory in C" />
<meta property="og:description" content="aight so here’s my situation. I have a scruct, which is using the malloc function to allocate memory. When using the free function, do I need to free all the components of the scruct, and then the struct itself. or can I just free the scruct?  void free_data(struct data* d) { 	free(d); } void free_data(struct data* d) { 	free(d-&gt;some_data); 	free(d); }" />
<meta name="twitter:description" content="aight so here’s my situation. I have a scruct, which is using the malloc function to allocate memory. When using the free function, do I need to free all the components of the scruct, and then the struct itself. or can I just free the scruct?  void free_data(struct data* d) { 	free(d); } void free_data(struct data* d) { 	free(d-&gt;some_data); 	free(d); }" />
<meta property="article:published_time" content="2012-05-23T18:59:54+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="442985.html">Freeing memory in C</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/imthenull.html'><span itemprop='name'>imthenull</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-05-23T18:59:54Z'>
            <time itemprop='dateModified' datetime='2016-08-03T02:49:15Z' class='post-time'>
              August 3, 2016,  2:49am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>aight so here’s my situation. I have a scruct, which is using the malloc function to allocate memory. When using the free function, do I need to free all the components of the scruct, and then the struct itself. or can I just free the scruct?</p>
<pre><code class="lang-auto">void free_data(struct data* d)
{
	free(d);
}</code></pre>
<pre><code class="lang-auto">void free_data(struct data* d)
{
	free(d-&gt;some_data);
	free(d);
}</code></pre>
      </div>

      <meta itemprop='headline' content='Freeing memory in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Evil1.html'><span itemprop='name'>Evil1</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-05-23T21:13:50Z'>
            <time itemprop='dateModified' datetime='2016-08-03T02:49:21Z' class='post-time'>
              August 3, 2016,  2:49am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>if you allocated the data in the struct you need to free it, e.g:</p>
<pre><code class="lang-auto">typedef struct {
    char* s;
} wat;

wat* w = malloc(sizeof(wat));
w.s = malloc(512);
...
free(w.s);
free(w);</code></pre>
      </div>

      <meta itemprop='headline' content='Freeing memory in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/imthenull.html'><span itemprop='name'>imthenull</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-05-23T21:29:25Z'>
            <time itemprop='dateModified' datetime='2016-08-03T02:49:22Z' class='post-time'>
              August 3, 2016,  2:49am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Evil_, post:2, topic:442985”]if you allocated the data in the struct you need to free it, e.g:</p>
<p>[code]<br>
typedef struct {<br>
char* s;<br>
} wat;</p>
<p>wat* w = malloc(sizeof(wat));<br>
w.s = malloc(512);<br>
…<br>
free(w.s);<br>
free(w);<br>
[/code][/quote]<br>
Thank you :3</p>
      </div>

      <meta itemprop='headline' content='Freeing memory in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Disorder.html'><span itemprop='name'>Disorder</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-06-06T17:27:51Z'>
            <time itemprop='dateModified' datetime='2016-08-03T03:02:32Z' class='post-time'>
              August 3, 2016,  3:02am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>If your structs contain other structs I suggest creating alloc/free for each struct as if they were constructors and destructors.</p>
      </div>

      <meta itemprop='headline' content='Freeing memory in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/imthenull.html'><span itemprop='name'>imthenull</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-06-06T18:55:34Z'>
            <time itemprop='dateModified' datetime='2016-08-03T03:02:36Z' class='post-time'>
              August 3, 2016,  3:02am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="4" data-topic="442985">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/disorder/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> Disorder:</div>
<blockquote>
<p>If your structs contain other structs I suggest creating alloc/free for each struct as if they were constructors and destructors.</p>
</blockquote>
</aside>
<p>Thanks for the advice.</p>
      </div>

      <meta itemprop='headline' content='Freeing memory in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Touru.html'><span itemprop='name'>Touru</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-23T19:39:52Z'>
            <time itemprop='dateModified' datetime='2016-08-03T17:21:40Z' class='post-time'>
              August 3, 2016,  5:21pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This depends on specifications of said struct.<br>
If it’s a struct with plain old data, such as integers, characters, arrays, then yes- free the memory like normal.</p>
<pre><code class="lang-auto">typedef struct
{
    int myint;
    char mychar;
    char mystring[32];
} Foo;

int main()
{
    Foo * myfoo= malloc(sizeof(Foo));
    free(myfoo); //safe
}
</code></pre>
<p>However, if you dynamically allocate memory in said struct, you must use initialization and deinitialization functions to free any memory within the struct. Freeing the struct will not free the memory it allocated, and will cause a memory leak if not handled properly.</p>
<p>Assume the Foo struct allocates memory.</p>
<pre><code class="lang-auto">
int main()
{
    Foo *myfoo= malloc(sizeof(Foo));
    Foo_init(myfoo); //Foo allocates resources
    ///code
    Foo_destroy(myfoo); //Foo releases resources
    free(myfoo); //release Foo
}
</code></pre>
      </div>

      <meta itemprop='headline' content='Freeing memory in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/imthenull.html'><span itemprop='name'>imthenull</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-23T21:18:38Z'>
            <time itemprop='dateModified' datetime='2016-08-03T17:21:48Z' class='post-time'>
              August 3, 2016,  5:21pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thanks, Touru, that helped a lot.</p>
      </div>

      <meta itemprop='headline' content='Freeing memory in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/freeing-memory-in-c/442985 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 01:00:52 GMT -->
</html>
