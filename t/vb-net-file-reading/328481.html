<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/vb-net-file-reading/328481 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 07:25:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>VB .Net File reading - General Programming - moparisthebest.com</title>
    <meta name="description" content="I am trying to read a very large file, and put the contents along with some extra data into a new file. 

I am currently using   

  If patchfile &amp;lt;&amp;gt; &amp;quot;&amp;quot; Then
            backup()

        If Not File.Exists(fname) Then
  &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="328481.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;VB .Net File reading&#39;" href="328481.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/vb-net-file-reading/328481" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/vb-net-file-reading/328481" />
<meta property="og:title" content="VB .Net File reading" />
<meta name="twitter:title" content="VB .Net File reading" />
<meta property="og:description" content="I am trying to read a very large file, and put the contents along with some extra data into a new file.  I am currently using   If patchfile &lt;&gt; &quot;&quot; Then              backup()              If Not File.Exists(fname) Then                 Dim ioFile As New StreamWriter(fname)                 ioFile.Close()             End If              If File.Exists(fname) Then                  Dim ioFileR As New StreamReader(patchfile)                 Dim ioFileW As New StreamWriter(fname)                 Dim ioL..." />
<meta name="twitter:description" content="I am trying to read a very large file, and put the contents along with some extra data into a new file.  I am currently using   If patchfile &lt;&gt; &quot;&quot; Then              backup()              If Not File.Exists(fname) Then                 Dim ioFile As New StreamWriter(fname)                 ioFile.Close()             End If              If File.Exists(fname) Then                  Dim ioFileR As New StreamReader(patchfile)                 Dim ioFileW As New StreamWriter(fname)                 Dim ioL..." />
<meta property="article:published_time" content="2010-02-06T17:50:30+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="328481.html">VB .Net File reading</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Hiaburi.html'><span itemprop='name'>Hiaburi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-02-06T17:50:30Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:34:53Z' class='post-time'>
              July 31, 2016,  2:34pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I am trying to read a very large file, and put the contents along with some extra data into a new file.</p>
<p>I am currently using</p>
<pre><code class="lang-auto"> If patchfile &lt;&gt; "" Then

            backup()

            If Not File.Exists(fname) Then
                Dim ioFile As New StreamWriter(fname)
                ioFile.Close()
            End If

            If File.Exists(fname) Then

                Dim ioFileR As New StreamReader(patchfile)
                Dim ioFileW As New StreamWriter(fname)
                Dim ioLine As String
                Dim ioLines As String
                ioLine = ioFileR.ReadLine
                ioLines = "info    " &amp; ioLine

                Do
                    ioLine = ioFileR.ReadLine
                    If Not ioLine = "" Then
                        ioLines = ioLines &amp; vbCrLf &amp; "info    " &amp; ioLine
                    End If

                Loop While Not ioLine = ""

                ioFileW.Write(ioLines)

                ioFileW.Close()
                ioFileR.Close()
            Else
                MessageBox.Show("There must have been a problem " _
                                &amp; "creating or accessing the file.")
            End If
        End If</code></pre>
<p>The problem with this method is it hangs for a very very long time to open and read the file.</p>
<p>Can any one suggest/tell me a faster method? Still fairly new to vb</p>
<p>[right]Thanks a million!<br>
Anthony[/right]</p>
      </div>

      <meta itemprop='headline' content='VB .Net File reading'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Unhandled.html'><span itemprop='name'>Unhandled</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-02-06T18:37:46Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:34:58Z' class='post-time'>
              July 31, 2016,  2:34pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>StreamWriter/Reader should be pretty fast, but if the file is big enough that wonâ€™t matter. I cba reading your code in detail because VB makes me nauseous, but have you considered spawning a new thread or using a <a href="http://msdn.microsoft.com/en-us/library/8xs8549b.aspx" data-bbcode="true" rel="nofollow noopener">BackgroundWorker</a> component?</p>
      </div>

      <meta itemprop='headline' content='VB .Net File reading'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mwiebelhaus.html'><span itemprop='name'>mwiebelhaus</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-02-06T18:56:28Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:34:58Z' class='post-time'>
              July 31, 2016,  2:34pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Post the rest of your code.</p>
      </div>

      <meta itemprop='headline' content='VB .Net File reading'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Hiaburi.html'><span itemprop='name'>Hiaburi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-02-06T20:58:30Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:35:07Z' class='post-time'>
              July 31, 2016,  2:35pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="3" data-topic="328481">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/mwiebelhaus/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> mwiebelhaus:</div>
<blockquote>
<p>Post the rest of your code.</p>
</blockquote>
</aside>
<p>That is all of the relevant code, you can ignore the backup(), it works fine, just copies the old file and renames it.</p>
      </div>

      <meta itemprop='headline' content='VB .Net File reading'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mwiebelhaus.html'><span itemprop='name'>mwiebelhaus</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-02-07T05:22:29Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:35:54Z' class='post-time'>
              July 31, 2016,  2:35pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>How big is the file that your reading/writing?</p>
      </div>

      <meta itemprop='headline' content='VB .Net File reading'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Hiaburi.html'><span itemprop='name'>Hiaburi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-02-07T13:59:05Z'>
            <time itemprop='dateModified' datetime='2016-07-31T14:36:14Z' class='post-time'>
              July 31, 2016,  2:36pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>a few million lines</p>
      </div>

      <meta itemprop='headline' content='VB .Net File reading'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/vb-net-file-reading/328481 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 07:25:47 GMT -->
</html>
