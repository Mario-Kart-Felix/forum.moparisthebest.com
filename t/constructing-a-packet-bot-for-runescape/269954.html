<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/constructing-a-packet-bot-for-runescape/269954 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 17:23:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Constructing a packet bot for Runescape - Runescape - moparisthebest.com</title>
    <meta name="description" content="Constructing a packet bot for Runescape. 

This topic has been brought up quite a few times, but I&amp;#39;m going to bring it up again because I believe that a structured conversation on it with more detailed information will l&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="269954.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Constructing a packet bot for Runescape&#39;" href="269954.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/constructing-a-packet-bot-for-runescape/269954" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/constructing-a-packet-bot-for-runescape/269954" />
<meta property="og:title" content="Constructing a packet bot for Runescape" />
<meta name="twitter:title" content="Constructing a packet bot for Runescape" />
<meta property="og:description" content="Constructing a packet bot for Runescape.  This topic has been brought up quite a few times, but I’m going to bring it up again because I believe that a structured conversation on it with more detailed information will lead to advances in the field.  So that we’re all on the same page, I’ll describe cryptography in general, and then deduce how those concepts apply to the actual Runescape client. I do not profess to be a cryptography expert, but I’ll try my best to explain everything with as much ..." />
<meta name="twitter:description" content="Constructing a packet bot for Runescape.  This topic has been brought up quite a few times, but I’m going to bring it up again because I believe that a structured conversation on it with more detailed information will lead to advances in the field.  So that we’re all on the same page, I’ll describe cryptography in general, and then deduce how those concepts apply to the actual Runescape client. I do not profess to be a cryptography expert, but I’ll try my best to explain everything with as much ..." />
<meta property="article:published_time" content="2009-03-29T05:24:19+00:00" />
<meta property="og:ignore_canonical" content="true" />

      <link rel="next" href="2699544658.html?page=2">


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="269954.html">Constructing a packet bot for Runescape</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/unlimitedorb.html'><span itemprop='name'>unlimitedorb</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T05:24:19Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:31:21Z' class='post-time'>
              July 31, 2016,  6:31am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><span class="bbcode-i"><span class="bbcode-b">Constructing a packet bot for Runescape.</span></span></p>
<p>This topic has been brought up quite a few times, but I’m going to bring it up again because I believe that a structured conversation on it with more detailed information will lead to advances in the field.</p>
<p>So that we’re all on the same page, I’ll describe cryptography in general, and then deduce how those concepts apply to the actual Runescape client. I do not profess to be a cryptography expert, but I’ll try my best to explain everything with as much clarity as possible. Errors may be present in my description, so feel free to berate me until I fix them.</p>
<p>DISCLAIMER: I haven’t done shit with shit, so this is purely educational. I don’t care enough to implement any of this for Runescape. My hands are tied with certain flash games at the moment <img src="../../images/emoji/twitter/wink1bce.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
<p><span class="bbcode-b">Simple definitions to commonly used terms:</span></p>
<p><span class="bbcode-u">Cipher</span> - A cipher is an operation that, when applied to an understandable sequence of characters, will obfuscate its meaning.</p>
<p><span class="bbcode-u">Decipher</span> - The process of taking an obfuscated text, and producing its original meaning.</p>
<p><span class="bbcode-u">Plaintext</span> - Plaintext is a sequence of characters that can be understood by humans.</p>
<p><span class="bbcode-u">Ciphertext</span> - Ciphertext is a sequence of characters that cannot be understood by humans.</p>
<p><span class="bbcode-u">Keystream</span> - A keystream is combined with plaintext in order to obfuscate the meaning of the plaintext. In turn, the same keystream applied to ciphertext can bring the ciphertext back to its original (understandable) plaintext sequence.</p>
<p><span class="bbcode-u">Exclusive Or (XOR)</span> - XOR is a mathematical operation performed on individual bits. The caret (^) character is used to represent XOR in mathematical operations. The semantic meaning of XOR is “one or the other, but not both.” Ex: 1 ^ 0 = 1 neither operands are the same, so this statement evaluates to true. 1 ^ 1 = 0 both operands are the same, so this statement evaluates to false.</p>
<p><span class="bbcode-b">Conceptual Overview</span><br>
Software metaphors are a ubiquitous and powerful concept used throughout the industry. This paper will be no exception. The following metaphor describes cryptography in the context of the Runescape client using you as the server, and a crush named Patty as the client.</p>
<pre><code>Your name is Charlie Brown. You have a crush on Patty, but you don't want your current girlfriend Peggy Jean to discover your feelings for her. You like the thrill of having an affair, so you decide to turn up the heat by having Patty, your girlfriend, deliver a love letter to Peggy Jean right out in the open. The potential problem is that Patty could read the love letter and dump you.

It just so happens that your best pal Snoopy likes cryptography, so you decide to ask him for help on the problem. Snoopy agrees to this deal.
</code></pre>
<p>The next day, Snoopy hands you two letters, both of which are filled with an unintelligible string of characters. “Ok Charlie Brown, here’s the deal. The first letter I gave you is a key. I want you to XOR the key with the love letter you want to send to Peggy Jean.” Oddly enough, you learned how to XOR the other day in class, so you have no trouble XOR’ing the love letter with Snoopy’s key. “Ok Charlie Brown, next I’ll have you notice that the second letter I gave you is the same as the first letter. I want you to give the second letter to Peggy Jean along with the letter you just XOR’d, and tell her to XOR the two unintelligible pieces together.”</p>
<p>The next morning, you ask Patty to deliver two unintelligible messages to Peggy Jean. Wanda eventually delivers the message and Peggy Jean XOR’s both messages together (she remembered she learned how to do this in class the other day). She discovers that, by doing so, she can see the original love letter.</p>
<p>In this case study we saw that Charlie Brown was acting as a server and Peggy Jean as a client. Charlie Brown took his plaintext and XOR’d it with a key. He then delivered the result of that operation, along with the key, to Peggy Jean. Peggy Jean then XOR’d the ciphertext with the key to produce the original plaintext.</p>
<p>Let’s look at one more example:</p>
<p><code>1011 (plaintext) ^ 0100 (keystream) = 1111 (ciphertext) 
1111 (ciphertext) ^ 0100 (keystream) = 1011 (plaintext)</code></p>
<p>See how we are able to deduce either the plaintext or the ciphertext by combining the opposite form of text with the key? That concept underpins the cryptographical innerworkings of the Runescape client.</p>
<p><span class="bbcode-b">Generating Pseudo Random Numbers</span><br>
Before continuing with our discussion, we have to make a few basic assumptions.</p>
<p>1.) Generating random numbers is an extremely slow process.<br>
2.) There is no such things as a digitally generated random number.</p>
<p>When the Runescape developers were deciding how to encrypt communication between the client and the server so people couldn’t understand what commands the server and client were sending eachother, they needed to find a very fast and secure method of doing this. Since generating truly random numbers would require outside assistance in the form of analog data, the Runescape developers decided upon ISAAC to accomplish this instead. ISAAC is a cryptographically secure pseudo random number generator. Statistically speaking, the numbers that the ISAAC algorithm produces are so random, that it’s virtually impossible to predict the next number to be outputted in the sequence given a set of randomly generated data generated by the algorithm. In fact, if the output of ISAAC is plotted, the points on the graph would be uniformly distributed throughout the plane. The problem with choosing ISAAC is that the stream of random digits generated isn’t truly random. If we know the seeds that the algorithm started with, we are able to predict each and every random number that is generated. But, without the seeds, we are unable to predict anything about the output of ISAAC.</p>
<p>Take a look at the following C implementation of ISAAC:</p>
<h2>[code]/*</h2>
<p>readable.c: My random number generator, ISAAC.<br>
© Bob Jenkins, March 1996, Public Domain<br>
You may use this code in any way you wish, and it is free.  No warrantee.</p>
<ul>
<li>May 2008 – made it not depend on standard.h</li>
</ul>
<hr>
<p>*/<br>
<span class="hashtag">#include</span> &lt;stdio.h&gt;<br>
<span class="hashtag">#include</span> &lt;stddef.h&gt;</p>
<p>/* a ub4 is an unsigned 4-byte quantity */<br>
typedef  unsigned long int  ub4;</p>
<p>/* external results */<br>
ub4 randrsl[256], randcnt;</p>
<p>/* internal state */<br>
static    ub4 mm[256];<br>
static    ub4 aa=0, bb=0, cc=0;</p>
<p>void isaac()<br>
{<br>
register ub4 i,x,y;</p>
<p>cc = cc + 1;    /* cc just gets incremented once per 256 results <em>/<br>
bb = bb + cc;   /</em> then combined with bb */</p>
<p>for (i=0; i&lt;256; ++i)<br>
{<br>
x = mm[i];<br>
switch (i%4)<br>
{<br>
case 0: aa = aa^(aa&lt;&lt;13); break;<br>
case 1: aa = aa^(aa&gt;&gt;6); break;<br>
case 2: aa = aa^(aa&lt;&lt;2); break;<br>
case 3: aa = aa^(aa&gt;&gt;16); break;<br>
}<br>
aa              = mm[(i+128)%256] + aa;<br>
mm[i]      = y  = mm[(x&gt;&gt;2)%256] + aa + bb;<br>
randrsl[i] = bb = mm[(y&gt;&gt;10)%256] + x;</p>
<pre><code> /* Note that bits 2..9 are chosen from x but 10..17 are chosen
    from y.  The only important thing here is that 2..9 and 10..17
    don't overlap.  2..9 and 10..17 were then chosen for speed in
    the optimized version (rand.c) */
 /* See http://burtleburtle.net/bob/rand/isaac.html
    for further explanations and analysis. */
</code></pre>
<p>}<br>
}</p>
<p>/* if (flag!=0), then use the contents of randrsl[] to initialize mm[]. */<br>
<span class="hashtag">#define</span> mix(a,b,c,d,e,f,g,h) <br>
{ <br>
a^=b&lt;&lt;11; d+=a; b+=c; <br>
b^=c&gt;&gt;2;  e+=b; c+=d; <br>
c^=d&lt;&lt;8;  f+=c; d+=e; <br>
d^=e&gt;&gt;16; g+=d; e+=f; <br>
e^=f&lt;&lt;10; h+=e; f+=g; <br>
f^=g&gt;&gt;4;  a+=f; g+=h; <br>
g^=h&lt;&lt;8;  b+=g; h+=a; <br>
h^=a&gt;&gt;9;  c+=h; a+=b; <br>
}</p>
<p>void randinit(flag)<br>
int flag;<br>
{<br>
int i;<br>
ub4 a,b,c,d,e,f,g,h;<br>
aa=bb=cc=0;<br>
a=b=c=d=e=f=g=h=0x9e3779b9;  /* the golden ratio */</p>
<p>for (i=0; i&lt;4; ++i)          /* scramble it */<br>
{<br>
mix(a,b,c,d,e,f,g,h);<br>
}</p>
<p>for (i=0; i&lt;256; i+=8)   /* fill in mm[] with messy stuff <em>/<br>
{<br>
if (flag)                  /</em> use all the information in the seed */<br>
{<br>
a+=randrsl[i  ]; b+=randrsl[i+1]; c+=randrsl[i+2]; d+=randrsl[i+3];<br>
e+=randrsl[i+4]; f+=randrsl[i+5]; g+=randrsl[i+6]; h+=randrsl[i+7];<br>
}<br>
mix(a,b,c,d,e,f,g,h);<br>
mm[i  ]=a; mm[i+1]=b; mm[i+2]=c; mm[i+3]=d;<br>
mm[i+4]=e; mm[i+5]=f; mm[i+6]=g; mm[i+7]=h;<br>
}</p>
<p>if (flag)<br>
{        /* do a second pass to make all of the seed affect all of mm */<br>
for (i=0; i&lt;256; i+=8)<br>
{<br>
a+=mm[i  ]; b+=mm[i+1]; c+=mm[i+2]; d+=mm[i+3];<br>
e+=mm[i+4]; f+=mm[i+5]; g+=mm[i+6]; h+=mm[i+7];<br>
mix(a,b,c,d,e,f,g,h);<br>
mm[i  ]=a; mm[i+1]=b; mm[i+2]=c; mm[i+3]=d;<br>
mm[i+4]=e; mm[i+5]=f; mm[i+6]=g; mm[i+7]=h;<br>
}<br>
}</p>
<p>isaac();            /* fill in the first set of results <em>/<br>
randcnt=256;        /</em> prepare to use the first set of results */<br>
}</p>
<p>int main()<br>
{<br>
ub4 i,j;<br>
aa=bb=cc=(ub4)0;<br>
for (i=0; i&lt;256; ++i) mm[i]=randrsl[i]=(ub4)0;<br>
randinit(1);<br>
for (i=0; i&lt;2; ++i)<br>
{<br>
isaac();<br>
for (j=0; j&lt;256; ++j)<br>
{<br>
printf("%.8lx",randrsl[j]);<br>
if ((j&amp;7)==7) printf("\n");<br>
}<br>
}<br>
}[/code]</p>
<p>We can see that the array randrsl starts out as an array of seeds. Each seed is 32 bits in length. The seeds are then used to affect the internal state, array mm, of the algorithm. It just so happens that if we know the seeds beforehand, we can deduce the internal state of the algorithm. This is where the “pseudo” property of this algorithm comes into play. We start with 256 seeds which will produce 256 random integers. Together, these 256 integers represent a keystream. The keystream is used to encrypt up to 1024 bytes of data. In a moment, we will look at a live example of the ISAAC implementation in the Runescape client and confirm that the maximum length of a packet is indeed 1kb. In order to narrow down where the class that implements ISAAC in the client is, I searched for the golden ratio (0x9e3779b9). I haven’t analyzed ISAAC enough to know what it is mathematically, but I’ll be damned if it isn’t golden. Searching for the golden ratio yields two classes. It becomes obvious which one is ISAAC. The following is an example of ISAAC found in a relatively recent decompiled client:</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/unlimitedorb.html'><span itemprop='name'>unlimitedorb</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T05:24:48Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:31:21Z' class='post-time'>
              July 31, 2016,  6:31am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[code]import java.math.BigInteger;</p>
<p>final class Class87<br>
{</p>
<pre><code>static final Class94 method1313(int i, long l)
{
    try
    {
        anInt1427++;
        if(~l &gt;= -1L || ~l &lt;= 0xa4a4a8075675a22eL)
            return null;
        if(l % 37L == 0L)
            return null;
        long l1 = l;
        int j = 0;
        for(; l1 != 0L; l1 /= 37L)
            j++;

        byte abyte0[] = new byte[j];
        while(l != 0L) 
        {
            long l2 = l;
            l /= 37L;
            abyte0[--j] = Class39.aByteArray609[(int)(l2 + -(37L * l))];
        }
        Class94 class94 = new Class94();
        class94.aByteArray2561 = abyte0;
        int k = -110 / ((i - 1) / 63);
        class94.anInt2562 = abyte0.length;
        return class94;
    }
    catch(RuntimeException runtimeexception)
    {
        throw Class60_Sub16_Sub9.method669(runtimeexception, "ni.F(" + i + ',' + l + ')');
    }
}

final int method1314(int i)
{
    if(anInt1424-- == 0)
    {
        method1315(128);
        anInt1424 = 255;
    }
    if(i &gt; -55)
    {
        return 30;
    } else
    {
        anInt1430++;
        return anIntArray1426[anInt1424];
    }
}

private final void method1315(int i)
{
    anInt1435 += ++anInt1437;
    if(i != 128)
        anIntArray1426 = null;
    anInt1433++;
    for(int j = 0; ~j &gt; -257; j++)
    {
        int k = anIntArray1431[j];
        if((2 &amp; j) == 0)
        {
            if((j &amp; 1) != 0)
                anInt1436 ^= anInt1436 &gt;&gt;&gt; 0xc1382b66;
            else
                anInt1436 ^= anInt1436 &lt;&lt; 0x4b034b4d;
        } else
        if(~(j &amp; 1) == -1)
            anInt1436 ^= anInt1436 &lt;&lt; 0xc62147a2;
        else
            anInt1436 ^= anInt1436 &gt;&gt;&gt; 0x78523e90;
        anInt1436 += anIntArray1431[128 + j &amp; 0xff];
        int l;
        anIntArray1431[j] = l = anInt1435 + anIntArray1431[Class60_Sub16_Sub5.method646(k &gt;&gt; 0xfd988cc2, 255)] + anInt1436;
        anIntArray1426[j] = anInt1435 = anIntArray1431[Class60_Sub16_Sub5.method646(1020, l &gt;&gt; 0x8d4a3e8) &gt;&gt; 0xa6868a22] - -k;
    }

}

private final void method1316(int i)
{
    if(i != -12842)
        return;
    anInt1429++;
    int j1;
    int k1;
    int l1;
    int i2;
    int j2;
    int k2;
    int l2;
    int i1 = j1 = k1 = l1 = i2 = j2 = k2 = l2 = 0x9e3779b9;
    for(int j = 0; ~j &gt; -5; j++)
    {
        i1 ^= j1 &lt;&lt; 0x4828456b;
        l1 += i1;
        j1 += k1;
        j1 ^= k1 &gt;&gt;&gt; 0x24db1bc2;
        k1 += l1;
        i2 += j1;
        k1 ^= l1 &lt;&lt; 0xfe0a7928;
        l1 += i2;
        j2 += k1;
        l1 ^= i2 &gt;&gt;&gt; 0x5a0aebf0;
        i2 += j2;
        i2 ^= j2 &lt;&lt; 0xe75ae62a;
        k2 += l1;
        j2 += k2;
        l2 += i2;
        j2 ^= k2 &gt;&gt;&gt; 0x3ef3bd64;
        k2 += l2;
        i1 += j2;
        k2 ^= l2 &lt;&lt; 0x60943968;
        j1 += k2;
        l2 += i1;
        l2 ^= i1 &gt;&gt;&gt; 0xa7e24369;
        i1 += j1;
        k1 += l2;
    }

    for(int k = 0; k &lt; 256; k += 8)
    {
        j1 += anIntArray1426[k - -1];
        k1 += anIntArray1426[k + 2];
        i1 += anIntArray1426[k];
        l1 += anIntArray1426[k - -3];
        k2 += anIntArray1426[6 + k];
        i2 += anIntArray1426[4 + k];
        l2 += anIntArray1426[k - -7];
        j2 += anIntArray1426[k - -5];
        i1 ^= j1 &lt;&lt; 0xd9c11d0b;
        j1 += k1;
        l1 += i1;
        j1 ^= k1 &gt;&gt;&gt; 0x52a59e22;
        i2 += j1;
        k1 += l1;
        k1 ^= l1 &lt;&lt; 0x8238a928;
        l1 += i2;
        l1 ^= i2 &gt;&gt;&gt; 0x950a02d0;
        j2 += k1;
        i2 += j2;
        k2 += l1;
        i2 ^= j2 &lt;&lt; 0xd356f5ea;
        l2 += i2;
        j2 += k2;
        j2 ^= k2 &gt;&gt;&gt; 0xa1fb6e24;
        k2 += l2;
        k2 ^= l2 &lt;&lt; 0xc3c2e5c8;
        j1 += k2;
        i1 += j2;
        l2 += i1;
        l2 ^= i1 &gt;&gt;&gt; 0x898b8329;
        k1 += l2;
        i1 += j1;
        anIntArray1431[k] = i1;
        anIntArray1431[k + 1] = j1;
        anIntArray1431[2 + k] = k1;
        anIntArray1431[k + 3] = l1;
        anIntArray1431[4 + k] = i2;
        anIntArray1431[k - -5] = j2;
        anIntArray1431[k + 6] = k2;
        anIntArray1431[k + 7] = l2;
    }

    for(int l = 0; ~l &gt; -257; l += 8)
    {
        i2 += anIntArray1431[l - -4];
        j1 += anIntArray1431[1 + l];
        i1 += anIntArray1431[l];
        k2 += anIntArray1431[6 + l];
        k1 += anIntArray1431[l + 2];
        l2 += anIntArray1431[7 + l];
        j2 += anIntArray1431[l + 5];
        l1 += anIntArray1431[3 + l];
        i1 ^= j1 &lt;&lt; 0xeec80aab;
        j1 += k1;
        l1 += i1;
        j1 ^= k1 &gt;&gt;&gt; 0x70d9ade2;
        i2 += j1;
        k1 += l1;
        k1 ^= l1 &lt;&lt; 0xee161988;
        j2 += k1;
        l1 += i2;
        l1 ^= i2 &gt;&gt;&gt; 0x46279590;
        i2 += j2;
        i2 ^= j2 &lt;&lt; 0x509fb08a;
        l2 += i2;
        k2 += l1;
        j2 += k2;
        j2 ^= k2 &gt;&gt;&gt; 0x5c08bdc4;
        i1 += j2;
        k2 += l2;
        k2 ^= l2 &lt;&lt; 0xf9eeae88;
        l2 += i1;
        l2 ^= i1 &gt;&gt;&gt; 0xc3a97169;
        k1 += l2;
        j1 += k2;
        i1 += j1;
        anIntArray1431[l] = i1;
        anIntArray1431[1 + l] = j1;
        anIntArray1431[l + 2] = k1;
        anIntArray1431[l - -3] = l1;
        anIntArray1431[4 + l] = i2;
        anIntArray1431[5 + l] = j2;
        anIntArray1431[l + 6] = k2;
        anIntArray1431[l - -7] = l2;
    }

    method1315(128);
    anInt1424 = 256;
}

static final Class60_Sub18_Sub17 method1317(int i, Class123 class123, boolean flag, boolean flag1, Class123 class123_1)
{
    try
    {
        boolean flag2 = true;
        if(flag)
            aClass94_1425 = null;
        anInt1438++;
        int ai[] = class123_1.method1752(i, -1);
        for(int j = 0; j &lt; ai.length; j++)
        {
            byte abyte0[] = class123_1.method1758(ai[j], i, -22272);
            if(abyte0 == null)
            {
                flag2 = false;
            } else
            {
                int k = abyte0[0] &lt;&lt; 0xa08101e8 &amp; 0xff00 | 0xff &amp; abyte0[1];
                byte abyte1[];
                if(flag1)
                    abyte1 = class123.method1758(k, 0, -22272);
                else
                    abyte1 = class123.method1758(0, k, -22272);
                if(abyte1 == null)
                    flag2 = false;
            }
        }

        if(!flag2)
            return null;
        try
        {
            return new Class60_Sub18_Sub17(class123_1, class123, i, flag1);
        }
        catch(Exception _ex)
        {
            return null;
        }
    }
    catch(RuntimeException runtimeexception)
    {
        throw Class60_Sub16_Sub9.method669(runtimeexception, "ni.C(" + i + ',' + (class123 == null ? "null" : "{...}") + ',' + flag + ',' + flag1 + ',' + (class123_1 == null ? "null" : "{...}") + ')');
    }
}

public static void method1318(int i)
{
    aClass128_1432 = null;
    aBigInteger1439 = null;
    aClass94_1425 = null;
    int j = 120 % ((-28 - i) / 59);
}

static final int method1319(int i, int j)
{
    anInt1434++;
    if(i &lt; 28)
        method1320(-22);
    return j &gt;&gt;&gt; 0xbf91f48;
}

static final void method1320(int i)
{
    if(i != -21306)
        anInt1441 = -29;
    anInt1423++;
    Class33.aClass114_531.method1675(false);
}

private Class87()
{
}

Class87(int ai[])
{
    anIntArray1431 = new int[256];
    anIntArray1426 = new int[256];
    for(int i = 0; ~i &gt; ~ai.length; i++)
        anIntArray1426[i] = ai[i];

    method1316(-12842);
}

static int anInt1422;
static int anInt1423;
private int anInt1424;
static Class94 aClass94_1425 = Class38.method294((byte)-125, "Number of player models in cache:");
private int anIntArray1426[];
static int anInt1427;
static int anInt1428;
static int anInt1429;
static int anInt1430;
private int anIntArray1431[];
static Class128 aClass128_1432;
static int anInt1433;
static int anInt1434;
private int anInt1435;
private int anInt1436;
private int anInt1437;
static int anInt1438;
static BigInteger aBigInteger1439 = new BigInteger("7162900525229798032761816791230527296329313291232324290237849263501208207972894053929065636522363163621000728841182238772712427862772219676577293600221789");
static int anInt1440;
static int anInt1441;
</code></pre>
<p>}<br>
[/code]<br>
We can see from the start that the class closely resembles the C implementation. We also see that the private field “anIntArray1426” is the location for the initial seed values. Let’s step away from packet bot theory for a bit to talk about a famous packet bot, and a method of resurrecting it back to life…</p>
<p><span class="bbcode-b">AutoRune</span><br>
AutoRune was arguably the first and most legendary packet bot for Runescape. The basic idea behind it was simple: Set up a proxy between the client and the server to analyze, modify, and create incoming and outgoing packets.</p>
<p>I’ve never used AutoRune, nor do I have AutoRune’s source (if anybody has it, I’d be happy if you sent it over to me for analysis) so I’m mostly making assumptions about how it works. One of the main reasons for AutoRune’s existence was the fact that incoming and outgoing packets were not encrypted. It was the equivalent of Charlie Brown telling Patty to, in turn, tell Peggy Jean that he loves her (why Charlie Brown would do that is beyond me). Instead of Patty sending the proper message to Peggy Jean, she alters it to her own discretion. Example:</p>
<p>“Patty, tell Peggy Jean if she would be interested in having a picnic with us tomorrow.” says Charlie Brown.</p>
<p>“Peggy Jean, Charlie Brown wants to let you know that he doesn’t want to see you ever again.” Patty relays to Peggy Jean.</p>
<p>“Patty, tell Charlie Brown that it doesn’t matter because I never wanted to see him in the first place!” replies Peggy Jean.</p>
<p>What Patty does with this new information is up to her, but the idea behind this example was that Patty had full control over Charlie Brown’s intended message. It follows that the proxy has full control over intended messages.</p>
<p>Fast forward some time and we see that Runescape developers got wiser and began encrypting packets. AutoRune falls apart. If we wanted to resurrect AutoRune we could do it in a variety of different ways. In fact, it would be fairly easy to do so:</p>
<p>1.) Since we know where the seed values are located, we could instrument bytecode to analyze the value of the seeds at any given moment and mimic the internal state of ISAAC.<br>
…It was mentioned on moparisthebest forums a while back that a packet bot would be hard to create because there would be synchronization issues i.e., packets become “out of step”. This problem is easily bypassed by implementing the ISAAC algorithm in the proxy, seeding it with the seeds found by bytecode analyzation, and then relying on the proxy’s ISAAC implementation for the duration of the session.</p>
<p>2.) We could analyze the packet structure of the server and find when the server sends the initial seeds. That way, there is no bytecode analysis involved.</p>
<p>The key to resurrecting AutoRune would be to emulate the internal state of ISAAC at any point in order to predict its next output. That way, we can XOR the decrypted packet with the keystream, and the server would accept it.</p>
<p><span class="bbcode-b">The Server Knows Best</span><br>
Every time the client sends a packet, the server knows exactly how to decrypt it because it sent the clients the initial seeds to start with. The server knows every single detail about past and future keystreams. It becomes a simple matter of predicting the keystream the client will send and XOR’ing it with the packet to get the client’s original message.</p>
<p>That’s all for now folks. If you have anything to add please feel free to do so. This wasn’t meant to be a tutorial, but rather a way to kickstart discussion about packet bots. Hopefully, I have not wasted my time, but even if I have, I hope you came away with something from this post.</p>
<p><span class="bbcode-b">References:</span><br>
ISAAC official website: <a href="http://burtleburtle.net/bob/rand/isaacafa.html" rel="nofollow noopener">http://burtleburtle.net/bob/rand/isaacafa.html</a><br>
Stream Ciphers: <a href="http://en.wikipedia.org/wiki/Stream_cipher" rel="nofollow noopener">http://en.wikipedia.org/wiki/Stream_cipher</a><br>
And other websites that can be found with simple Google searches…</p>
<p><span class="bbcode-b">Credits:</span><br>
Ollie (decompiled client)<br>
pplsuqbawlz (some confirmation/explanation on my basic assumptions)<br>
zstars (probably doesn’t remember this, but a while back he gave me a video of his simple packet bot on my dafan IRC nick)</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T09:52:18Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:31:26Z' class='post-time'>
              July 31, 2016,  6:31am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>this one time i thought this thread would be interesting</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/xEnt.html'><span itemprop='name'>xEnt</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T11:46:48Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:31:27Z' class='post-time'>
              July 31, 2016,  6:31am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’ve always wondered why there was no popular packet bots for rs2.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T12:00:40Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:31:28Z' class='post-time'>
              July 31, 2016,  6:31am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“xEnt, post:4, topic:269954”]I’ve always wondered why there was no popular packet bots for rs2.[/quote]i bet you are still wondering eh</p>
<p>this slightly brushes on the netcode, but doesnt give any real information</p>
<p>edit: i tried to read it, i really did. but your ghetto analogy is rather terrible (stick with the typical Alice, Bob and Cathy)</p>
<blockquote>2.) We could analyze the packet structure of the server and find when the server sends the initial seeds. That way, there is no bytecode analysis involved.</blockquote>
you obviously have no idea do you? asynchronous ciphers (eg RSA) are often used to initialise synchronous [stream] ciphers (eg ISAAC). wow, would you look at that! exactly like jagex do
<p>the real key to creating a modern packet bot is not trying to keep up with the internal state of the ciphers (good luck sending packets), it is trying to emulate the internals of the client</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lolcake.html'><span itemprop='name'>lolcake</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T15:47:48Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:31:38Z' class='post-time'>
              July 31, 2016,  6:31am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>hi guyz dis is super_ stoppin bye to say hlo. anyway dafan, i will simply tell you one thing:<br>
you barely hit the surface. all you did was use a bunch of afrojew names to create a ‘concept’ of basic encryption of messages (like how runescape lightly encrypts its ‘messages’). the resurrection of AutoRune (and the development of ANY standalone proxy bot) is IMPOSSIBLE. why? because in order to do that you need to have copies of ISAAC ciphers EXACLTY like those of the client. the ISAAC cipher’s are seeded off of the session keys (one of them has 50 added to each int inside the seed). this poses a problem. you stated you can sniff the initial seeds from a connection. FALSE. the only data you would be able to get is the server session key long which is sent after initiating the connection handshake (sending 14 which selects login server, then a strange byte derived from your username as a long). the client session key is sent inside the <span class="bbcode-b">login block</span>, which (sadly QQ) is RSA encrypted using the modulus and public key found inside the client. so unless you bruteforce jagex’s private key for RSA, a bot like this is impossible. on the other hand, completely stand-alone packet bots (that essentially emulate the client but horribly bad) like zstar’s bot PacketRune, are very possible. the fact of the matter is that jagex keeps modifying their packet opcodes and payload structure every version, and even change the login protocol from time to time (<span class="hashtag">#508-</span><span class="hashtag">#539</span> cross analysis shows that they added more shit)</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/R.I.html'><span itemprop='name'>R.I.P_RSC</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T16:09:00Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:31:39Z' class='post-time'>
              July 31, 2016,  6:31am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Please fuck off with using nigger names in analogy’s. It’s like listening to rap in a Rolls-Royce.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/unlimitedorb.html'><span itemprop='name'>unlimitedorb</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T20:04:00Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:32:01Z' class='post-time'>
              July 31, 2016,  6:32am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“frank_, post:5, topic:269954”][quote author=xEnt link=topic=356325.msg2725611#msg2725611 date=1238327208]<br>
I’ve always wondered why there was no popular packet bots for rs2.<br>
[/quote]i bet you are still wondering eh</p>
<p>this slightly brushes on the netcode, but doesnt give any real information</p>
<p>edit: i tried to read it, i really did. but your ghetto analogy is rather terrible (stick with the typical Alice, Bob and Cathy)</p>
<aside class="quote no-group">
<blockquote>
<p>2.) We could analyze the packet structure of the server and find when the server sends the initial seeds. That way, there is no bytecode analysis involved.</p>
</blockquote>
</aside>
<p>you obviously have no idea do you? asynchronous ciphers (eg RSA) are often used to initialise synchronous [stream] ciphers (eg ISAAC). wow, would you look at that! exactly like jagex do</p>
<p>the real key to creating a modern packet bot is not trying to keep up with the internal state of the ciphers (good luck sending packets), it is trying to emulate the internals of the client[/quote]</p>
<p>Ok, the metaphor in use has been changed. That is the power of peer review. But let’s make a few things clear before I continue:</p>
<p>1.) It looks like I have no idea because, for the most part, I really don’t. I’m only willing to analyze the client up to a certain extent, before I consider it a waste of time. So it’s mainly educated guesses coupled with empirical data for now.</p>
<p>2.) I’m willing to revise what I write. I will attempt to wade through as many vague descriptions (like this one) as I can and try to explain them with a bit more clarity.</p>
<p>Anyway, I didn’t know the initial seeds were distributed with RSA. That knocks out the second option, but there’s still the first to contend with. I’m in the process of updating the post with this information. This still has the potential of becoming an interesting thread, but I guess we’ll see.</p>
<p>[quote=“lolcake_, post:6, topic:269954”]hi guyz dis is super_ stoppin bye to say hlo. anyway dafan, i will simply tell you one thing:<br>
you barely hit the surface. all you did was use a bunch of afrojew names to create a ‘concept’ of basic encryption of messages (like how runescape lightly encrypts its ‘messages’). the resurrection of AutoRune (and the development of ANY standalone proxy bot) is IMPOSSIBLE. why? because in order to do that you need to have copies of ISAAC ciphers EXACLTY like those of the client. the ISAAC cipher’s are seeded off of the session keys (one of them has 50 added to each int inside the seed). this poses a problem. you stated you can sniff the initial seeds from a connection. FALSE. the only data you would be able to get is the server session key long which is sent after initiating the connection handshake (sending 14 which selects login server, then a strange byte derived from your username as a long). the client session key is sent inside the <span class="bbcode-b">login block</span>, which (sadly QQ) is RSA encrypted using the modulus and public key found inside the client. so unless you bruteforce jagex’s private key for RSA, a bot like this is impossible. on the other hand, completely stand-alone packet bots (that essentially emulate the client but horribly bad) like zstar’s bot PacketRune, are very possible. the fact of the matter is that jagex keeps modifying their packet opcodes and payload structure every version, and even change the login protocol from time to time (<span class="hashtag">#508-</span><span class="hashtag">#539</span> cross analysis shows that they added more shit)[/quote]</p>
<p>Hi super_,<br>
I think you might be making this out to be more complex than it actually is. There is no reason to brute force Jagex’s private key simply because we don’t need it. If we are looking for data that has already been deciphered, then we don’t have to look any further than the client. Instrumenting bytecode to output plaintext is well within the realm of possible. I don’t see how your argument of developing a proxy bot is “IMPOSSIBLE” can hold true? I’m aware that my 2nd assumption was semi-false, and I apologize for that, but if I didn’t make any bold statements, I would get nowhere fast.</p>
<p>Why do you keep referring to the ISAAC cipher in the plural? There is only one algorithm and there is only one point at which that algorithm is seeded. I’m going to have to say a proxy bot is possible coupled with bytecode engineering or memory analysis unless there’s some drastic piece of information that I’m missing.</p>
<aside class="quote no-group quote-modified" data-post="7" data-topic="269954">
<div class="title">
<div class="quote-controls"></div>
 R.I.P RSC:</div>
<blockquote>
<p>Please fuck off with using nigger names in analogy’s. It’s like listening to rap in a Rolls-Royce.</p>
</blockquote>
</aside>
<p>I hope you like Peanuts characters.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lolcake.html'><span itemprop='name'>lolcake</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T21:28:54Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:32:07Z' class='post-time'>
              July 31, 2016,  6:32am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>autorune didnt have access to the client’s variables etc., nor would any <span class="bbcode-b">standalone</span> (HINT KEYWORD HINT) proxy bot. i never said any plain old proxy bot that DID have access to the client data. for a standalone proxy bot to be able to send it’s own packets, it requires an ISAAC cipher for encoding its packets’ opcodes. this cipher is seeded using 2 longs which i call the <span class="bbcode-b">session keys</span>. the session keys are written as 4 ints (they are split from longs into ints) into the <span class="bbcode-b">login block</span>, which is appended to the <span class="bbcode-b">login response packet</span>. the login block is encoded using RSA and jagex’s <span class="bbcode-b">modulus</span> and <span class="bbcode-b"><span class="bbcode-i">public</span> key</span>. so in order to get the session keys to seed the ciphers (YES OMG MULTIPLE… take a look in the client. you’ll see there are two seeded: one for incoming decoding and one for outgoing encoding) without having having any access to the client’s variables and internal data, you’ll need to decode this block and parse them out. to RSA decode requires having the <span class="bbcode-b"><span class="bbcode-i">private</span> key</span>. the only way to get this key is via bruteforce.</p>
<p>P.S. if you want the partial leaked autorune source, add me on msn _cake [a to the t] <a href="http://live.com/" rel="nofollow noopener">live.com</a> and ill send you it.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zstars.html'><span itemprop='name'>zstars</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T22:44:57Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:32:15Z' class='post-time'>
              July 31, 2016,  6:32am
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>If anyone’s curious on the login packets, just found my old docs:</p>
<blockquote>Size: 2
0x0e, 0x04</blockquote>
<blockquote>Size: 9
(Byte) 0x00
(QWord) Seed (For ISAAC)</blockquote>
<blockquote>Size: 120+
<p>(byte) packet_id // 18<br>
(byte) size (not counting size or packet_id, that’s it, the packet size - 2)<br>
(dword) version (485 at the time of writting this)<br>
(byte) lowmem (1 or 0)<br>
(dword)x16 checksum of cache files<br>
(byte) data_size // size of the login data part of this packet</p>
<p>RSA Encrypted: * The following chunk is RSA encrypted, so the physical size is bigger *</p>
<p>(byte) id // 0x0A<br>
(dword)x4 (The four seeds. Client ones and server ones (from SMSG_HELLO))<br>
(dword) uid<br>
(qword) user // compressed into an uint64<br>
(ntstring) password</p>
</blockquote>
<p>CMSG_HELLO is the handshake, exact contents vary depending on connection type.</p>
<p>SMSG_HELLO is the reply to the handshake, containing the server ISAAC key. This packet is unencrypted so it would be possible to sniff it.</p>
<p>CMSG_LOGIN is the login packet, the docs above are from version 458, nowadays the packet is slightly different. There are more cache checksums and there is no UID anymore. Instead, random.dat is placed after the cache checksums.</p>
<p>The client keys are sent within the RSA chunk of the CMSG_LOGIN packet so unlike the server keys, they can’t be sniffed all that easily. For a proxy bot to work, you’d have to get the client key somehow, maybe hooking somehow Math.random(), modifying it so that you can predict the result, or so that it always returns the same number, or getting the keys directly from the client through reflection or a javaagent or whatever.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lolcake.html'><span itemprop='name'>lolcake</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-29T22:55:03Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:32:16Z' class='post-time'>
              July 31, 2016,  6:32am
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>every session starts off with a <span class="bbcode-b">handshake</span> packet. the client request packet is:</p>
<p><code>initiate_handshake {
    byte servicetype; //14 for login server
    [if servicetype == 14, byte servselectionhash]
}</code></p>
<p>if it WAS 14, server responds with:</p>
<p><code>handshake_ack {
    byte responsetype; //if it's 0, proceed onto finishing login
    [if responsetype == 0, long servsessionkey]
}</code></p>
<p>the login initiation packet is changed from time to time, so i wont post any info on it because chances are it will have changed by the time a curious member falls upon this post. but zstar’s post is correct for <span class="hashtag">#485</span>. although now, there are more bytes which involve applet size, affiliate id on which the client was run, a settings int with bits representing various flag states through out client, dummies, and more. <img src="../../images/emoji/twitter/frowning1bce.png?v=6" title=":frowning:" class="emoji" alt=":frowning:"></p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/unlimitedorb.html'><span itemprop='name'>unlimitedorb</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-30T08:34:43Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:32:31Z' class='post-time'>
              July 31, 2016,  6:32am
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Attached to this post is the deob I’m working with. This way, we’re all on the same page if anyone wants to point anything out or argue.</p>
<p>Ok, I found time to analyze the client and I’ve taken into accounts zstars and super_'s posts. I have been wrong on several points, so the entry posts are going to undergo some heavy modification. In the meantime, here’s how far I’ve gotten for anyone who’s curious:</p>
<p>I started with Class87. Class87 contains the ISAAC algorithm. I decided to begin my search by cross referencing the Runescape client’s implementation of ISAAC with the readable C implementation of ISAAC to find the equivalent of the array randrsl. The array randrsl (in the C implementation) is an array of pseudo random numbers. I think of this as the keystream used to encrypt the plaintext. I found the following loop construct in method1315:</p>
<p><code>
        for(int j = 0; ~j &gt; -257; j++)
        {
            int k = anIntArray1431[j];
            if((2 &amp; j) == 0)
            {
                if((j &amp; 1) != 0)
                    anInt1436 ^= anInt1436 &gt;&gt;&gt; 0xc1382b66;
                else
                    anInt1436 ^= anInt1436 &lt;&lt; 0x4b034b4d;
            } else
            if(~(j &amp; 1) == -1)
                anInt1436 ^= anInt1436 &lt;&lt; 0xc62147a2;
            else
                anInt1436 ^= anInt1436 &gt;&gt;&gt; 0x78523e90;
            anInt1436 += anIntArray1431[128 + j &amp; 0xff];
            int l;
            anIntArray1431[j] = l = anInt1435 + anIntArray1431[Class60_Sub16_Sub5.method646(k &gt;&gt; 0xfd988cc2, 255)] + anInt1436;
            anIntArray1426[j] = anInt1435 = anIntArray1431[Class60_Sub16_Sub5.method646(1020, l &gt;&gt; 0x8d4a3e8) &gt;&gt; 0xa6868a22] - -k;
        }</code></p>
<p>Looking at the C implementation, we can see that anIntArray1426 should contain the final pseudo random number results. Next, I searched for the point at which anIntArray1426 is used to return a number from the array. It turns out that method1314 fits this bill… it contains:</p>
<p><code> else
        {
            anInt1430++;
            return anIntArray1426[anInt1424];
        }</code></p>
<p>After that, I decided to do a repository-wide search for when a new instance of Class87 (The ISAAC cipher) is created. I found that Class60_Sub20_Sub1 creates a new instance of Class87 in method1080. We can see  that method1080 initializes Class87 with array ai. Presumably, ai contains the initial seeds used for the internal state of ISAAC.</p>
<p>Next up, I did another repository-wide search, but this time I searched for all calls to method1080. By doing so, I will find every single instance of ISAAC. Low and behold, in Class29 method245, I found the following:</p>
<pre><code class="lang-auto">                Class132.aClass60_Sub20_Sub1_2378.method1080(0, ai);
                for(int k = 0; k &lt; 4; k++)
                    ai[k] += 50;

                Class15.aClass60_Sub20_Sub1_302.method1080(0, ai);[/code]
It turns out that super_ was correct. There are two instances of ISAAC. One instance is seeded normally, and the other instance has 50 added to each seed. Thanks super_!

I figured it was time to see when method1314 is called. By finding this, I am able to see the routine that XORs the plaintext with the number generated by ISAAC. Once again, I do a repository-wide search. This time, I find that Class60_Sub20_Sub1 contains 3 methods that make use of ISAAC's randomly generated numbers. The first method, method1081, is probably used as a convenience method for deciphering. The second method, method1083, is used to encrypt one byte from the plaintext. And the third method, method1084, is used to cycle through an entire array of bytes and encrypt each byte.

I was surprised to find that [b]the client does not XOR the plaintext with the keystream generated by ISAAC[/b].
[code]    final void method1081(int i, boolean flag)
    {
        super.aByteArray3042[super.anInt3048++] = (byte)(i + aClass87_4769.method1314(-77));
        anInt4782++;
        if(!flag)
            aByteArrayArrayArray4792 = null;
    }

    final int method1083(int i)
    {
        anInt4788++;
        if(i &lt; 47)
            method1086(-31);
        return super.aByteArray3042[super.anInt3048++] - aClass87_4769.method1314(-126) &amp; 0xff;
    }

    final void method1084(byte abyte0[], int i, int j, int k)
    {
        for(int l = 0; l &lt; j; l++)
            abyte0[k + l] = (byte)(super.aByteArray3042[super.anInt3048++] + -aClass87_4769.method1314(-104));

        if(i &lt;= 30)
            method1081(76, true);
        anInt4780++;
    }</code></pre>
<p>It looks like we’ve hit a jackpot of sorts! I previously thought that the client would use a XOR operation, but I was wrong. We can see that the client subtracts the randomly generated number from the plaintext instead of XOR’ing. We can deduce from this that the server does the opposite, when the time comes, and adds its predicted number to the ciphertext. The real gem here is <span class="bbcode-b">aByteArray3042</span>. If we dump this field at runtime, we should be able to see the plaintext the client is trying to encrypt with ISAAC.</p>
<p>aByteArray3042 is located in the super class of Class60_Sub20_Sub1, so I opened up Class60_Sub20 to see what all the fuss was about. It seems as though Class60_Sub20 is initialized with an array of bytes. Those bytes are then assigned to aByteArray3042. In other words, Class60_Sub20 represents a packet generated by the client.</p>
<p>I decided to backtrack a bit and find when the static method Class29.method245 is called. If you’ll recall, method245 is the point where the two instances of ISAAC are initialized. This search brought up the class client…</p>
<p>That’s all for now, I’m tired of writing.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zstars.html'><span itemprop='name'>zstars</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-30T09:56:36Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:32:32Z' class='post-time'>
              July 31, 2016,  6:32am
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>If I remember well, easiest way to find the login procedure was to regex for a “.mod” call on a BigNumber. That will land you on the applyRSA method, which is only called from within the login procedure. At the login procedure you can see how the two server seeds are received, how the two client seeds are generated, and how they are all gathered in a four elements array and used to initialize the ISAAC cyphers.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-30T10:04:01Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:32:32Z' class='post-time'>
              July 31, 2016,  6:32am
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“unlimitedorb, post:12, topic:269954”]I was surprised to find that <span class="bbcode-b">the client does not XOR the plaintext with the keystream generated by ISAAC</span>.[/quote]how big is the value generated by isaac? how big are packet opcodes? <img src="../../images/emoji/twitter/open_mouth1bce.png?v=6" title=":open_mouth:" class="emoji" alt=":open_mouth:"></p>
<p>why dont you clean up the source before you paste it so it doesnt look like shit</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/unlimitedorb.html'><span itemprop='name'>unlimitedorb</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-30T10:22:32Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:32:32Z' class='post-time'>
              July 31, 2016,  6:32am
            </time>
        <span itemprop='position'>#15</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="13" data-topic="269954">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/zstars/40/166_1.png" class="avatar"> zstars:</div>
<blockquote>
<p>If I remember well, easiest way to find the login procedure was to regex for a “.mod” call on a BigNumber. That will land you on the applyRSA method, which is only called from within the login procedure. At the login procedure you can see how the two server seeds are received, how the two client seeds are generated, and how they are all gathered in a four elements array and used to initialize the ISAAC cyphers.</p>
</blockquote>
</aside>
<p>I found it as well as some other things I will explain in another relatively large post. Thanks <img src="../../images/emoji/twitter/slight_smile1bce.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>[quote=“frank_, post:14, topic:269954”][quote author=unlimitedorb link=topic=356325.msg2726647#msg2726647 date=1238402083]<br>
I was surprised to find that <span class="bbcode-b">the client does not XOR the plaintext with the keystream generated by ISAAC</span>.<br>
[/quote]how big is the value generated by isaac? how big are packet opcodes? <img src="../../images/emoji/twitter/open_mouth1bce.png?v=6" title=":open_mouth:" class="emoji" alt=":open_mouth:"></p>
<p>why dont you clean up the source before you paste it so it doesnt look like shit[/quote]<br>
ISAAC generates an array of 256 integers. I haven’t come across packet opcodes yet, but I’m going to guess they can be an arbitrary size. I can tell that post was meant to be sarcastic, but the sarcasm is completely lost on me.</p>
<p>I don’t know about you, but when there’s alot of stuff I have to wade through and I didn’t intend to spend so much time on that stuff in the first place… shit begins to look and smell really good to me.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ilyaostr9.html'><span itemprop='name'>ilyaostr9</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-30T10:54:55Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:32:33Z' class='post-time'>
              July 31, 2016,  6:32am
            </time>
        <span itemprop='position'>#16</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>“candy coated bullshit”</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lolcake.html'><span itemprop='name'>lolcake</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-30T13:33:31Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:32:36Z' class='post-time'>
              July 31, 2016,  6:32am
            </time>
        <span itemprop='position'>#17</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>to find the login method in a deob, go into the client class, look for</p>
<pre><code class="lang-auto">= new GregorianCalendar();</code></pre>
<p>you should see a method that calls Class.aRandom.setSeed() and has alot of comparisons with the gamestate field (‘loginIndex’). look for an if-statement involving the gamestate and comparing it to 40 (if it is cluttered with NOT [~ or ^ 0xffffffff] reverse it in your head). the first method invoked in that if-statement’s scope is login(). to verify, look for another instance of this method being invoked inside this method. should come up under a block of code that is run iff gamestate equals 10 (if it is cluttered with NOT [~ or ^ 0xffffffff] reverse it in your head).<br>
on <span class="hashtag">#540:</span></p>
<p>searching finds us:</p>
<p><code>    final void method25(int i)
    {
        anInt2608++;
        if(Class60_Sub24.anInt3148 == 1000)
            return;
        Class54.anInt812++;
        if(Class54.anInt812 % 1000 == 1)
        {
            GregorianCalendar gregoriancalendar = new GregorianCalendar();
            Class127.anInt2486 = 600 * gregoriancalendar.get(11) + (10 * gregoriancalendar.get(12) + gregoriancalendar.get(13) / 6);
            Class132.aRandom2385.setSeed(Class127.anInt2486);
        }
        method33(0);
        if(Class60_Sub16_Sub33.aClass6_4308 != null)
            Class60_Sub16_Sub33.aClass6_4308.method80(0);
        Class46_Sub1.method321((byte)98);
        Class106.method1495(-19552);
        Class16.method148((byte)-26);
        Class26.method228(0);
        if(Class119.aClass42_2045 != null)
        {
            int j = Class119.aClass42_2045.method304(0);
            Class51.anInt759 = j;
        }
        if(Class60_Sub24.anInt3148 != 0)
        {
            if(Class60_Sub24.anInt3148 != 5)
            {
                if(~Class60_Sub24.anInt3148 == -26 || ~Class60_Sub24.anInt3148 == -29)
                    Class73.method1192(false);
            } else
            {
                method31(-8159);
                Class112_Sub4.method1612(false);
            }
        } else
        {
            method31(-8159);
            Class112_Sub4.method1612(false);
        }
        if(i &gt; -60)
            main(null);
        if(~Class60_Sub24.anInt3148 == -11)
        {
            method35(-1);
            Class60_Sub26.method1116(-124);
            Class60_Sub18_Sub5.method883((byte)116);
            Class29.method245(-59);
            return;
        }
        if(~Class60_Sub24.anInt3148 != -31)
        {
            if(Class60_Sub24.anInt3148 == 40)
            {
                Class29.method245(-42);
                if(Class111.anInt1865 != -3)
                {
                    if(Class111.anInt1865 != 15)
                    {
                        if(~Class111.anInt1865 != -3)
                        {
                            Class60_Sub16_Sub28.method761((byte)71);
                            return;
                        }
                    } else
                    {
                        Class128.method1814((byte)-95);
                    }
                    return;
                }
            }
        } else
        {
            Class74.method1197((byte)-58);
        }
    }</code><br>
it compares against gamestate alot, so we can infer Class60_Sub24.anInt3148 is gamestate. ok now to look for a comparison to 40:</p>
<p><code>            if(Class60_Sub24.anInt3148 == 40)
            {
                Class29.method245(-42);
                if(Class111.anInt1865 != -3)
                {
                    if(Class111.anInt1865 != 15)
                    {
                        if(~Class111.anInt1865 != -3)
                        {
                            Class60_Sub16_Sub28.method761((byte)71);
                            return;
                        }
                    } else
                    {
                        Class128.method1814((byte)-95);
                    }
                    return;
                }
            }</code><br>
first invoke is the login method, so Class29.method245(int) is login. to verify, we look for another instance of it being invoked.</p>
<p><code>        if(~Class60_Sub24.anInt3148 == -11)
        {
            method35(-1);
            Class60_Sub26.method1116(-124);
            Class60_Sub18_Sub5.method883((byte)116);
            Class29.method245(-59);
            return;
        }</code><br>
found it there. oh look, that if simplifies to:</p>
<pre><code class="lang-auto">if(Class60_Sub24.anInt3148 == 10)</code></pre>
<p>and that compares gamestate to 10 as anticipated <img src="../../images/emoji/twitter/slight_smile1bce.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/unlimitedorb.html'><span itemprop='name'>unlimitedorb</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-03-31T23:32:05Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:34:55Z' class='post-time'>
              July 31, 2016,  6:34am
            </time>
        <span itemprop='position'>#18</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I found some more time to analyze the client today, so I started off by searching for all occurences of method1084. Previously, I discovered that method1084 cycles through an array of bytes and applies an encryption operation to each byte i.e., a pseudo random number generated by ISAAC is subtracted from each element in the array. It turns out that there’s only one invocation of method1084 and it happens in Class79. Taking a look at Class79, it becomes apparent that it’s a gigantic state machine. Class85.anInt1402 contains the current state at any one time (probably worth further investigation, but not now). At state 30, the following takes place:</p>
<p><code>                if(~Class85.anInt1402 == -31)
                {
                    byte abyte0[] = new byte[Class60_Sub6.anInt2779];
                    Class15.aClass60_Sub20_Sub1_302.method1084(abyte0, i + 57, Class60_Sub6.anInt2779, 0);
                    Class94 class94_2 = Class57.method416(0, abyte0, 0, Class60_Sub6.anInt2779);
                    if(Class57.aFrame853 != null || ~Class129.anInt2324 != -4 &amp;&amp; Class129.aString2312.startsWith("win") &amp;&amp; !Class7.aBoolean177)
                    {
                        Class97.aBoolean1630 = true;
                        Class133.aClass94_2393 = class94_2;
                        Class81.aClass12_1322 = Class125.aClass129_2121.method1836(i + 15815, new String(class94_2.method1404((byte)-104), "ISO-8859-1"));
                    } else
                    {
                        Class14.method137(class94_2, true, -1);
                    }
                    Class85.anInt1402 = -1;
                    return true;
                }</code></p>
<p>We can see that Class60_Sub6.anInt2779 holds the length of the plaintext to be encrypted. Class15 contains an instance of ISAAC (aClass60_Sub20_Sub1 represents an instance of ISAAC). Since there are two instances of ISAAC as noted by a previous post, and this instance is the only one in which method1084 is invoked, we can conclude that this instance of ISAAC is the only instance used for encrypting outgoing traffic i.e., it encrypts traffic being sent to the server. It’s probably worth analyzing this state further as it seems like it should be a hotbed of activity. In fact, I think that if we trace method1242 (the method that contains this state machine) far enough, we would come to the “game loop”.</p>
<p>At this point, I think a packet based proxy bot is well within reach. I’ve given it some thought, and I came up with a few benefits:<br>
1.) Client footprint would be minimal (very little bytecode engineering… if any).<br>
2.) Random event detection would be flawless.<br>
3.) Easier to maintain in the long run.<br>
4.) Can be designed to be absolutely undetectable, since we’re operating at the packet level.<br>
That’s all I can really think of off the top of my head, but there are probably a ton more benefits.</p>
<p>The bot would still need a loader to get into the same JVM instance as the client. It would still need an updater to find opcodes. The first thing to do would be to hook aByteArray3042 to see decoded traffic. Next, we could hook the array ai (ai contains the initial seeds). We could implement ISAAC inside the proxy, and block it until we’ve initialized it using the client’s seeds so we can generate/modify packets.</p>
<p>I don’t see a reason to hook any login initialization procedures, or anything like that. Just let the client do its stuff with the server up until the point of ISAAC initialization, grab seeds, hook decoded traffic, and that’s about it. Unless I’m leaving out something major…</p>
<p>Eventually, it’s natural to progress to a completely standalone packet bot, but as mentioned previously, it would become a matter of emulating the client which would be a real pain to do with any regard for quality.</p>
<p>It’s starting to look like packet analysis would work best as an extension to contemporary bytecode bots… at least in the beginning.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-04-01T00:30:38Z'>
            <time itemprop='dateModified' datetime='2016-07-31T06:34:59Z' class='post-time'>
              July 31, 2016,  6:34am
            </time>
        <span itemprop='position'>#19</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I believe that you are a genuine idiot.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/unlimitedorb.html'><span itemprop='name'>unlimitedorb</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-04-01T01:44:12Z'>
            <time itemprop='dateModified' datetime='2019-01-01T09:55:04Z' class='post-time'>
              January 1, 2019,  9:55am
            </time>
        <span itemprop='position'>#20</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>…And I believe that you rarely ever do anything productive because:</p>
<p>1.) Your English skills are sub-par.<br>
2.) You’ve made yourself out to be a “guru” when you know you don’t measure up.<br>
3.) You find yourself locked into making extremely brief messages because you believe (and wrongfully so) that their brevity will minimize any false information they entail.</p>
<p>Anybody can be a “guru” by making relevant statements that can lead anywhere. If I really wanted to, I could come back here under a new moniker and do that as well. Let’s be honest here:</p>
<p>[code]&lt;recent_quotes_from_frank_&gt;<br>
“if java had operator overloading it would be a terrible language.”</p>
<p>"what the fuck is nulling</p>
<p>ps: <a href="http://moparisthebest.com/" rel="nofollow noopener">moparisthebest.com</a>."</p>
<p>“its a shit bot, who cares”</p>
<p>“i never said it isnt helpful, but using only wikipedia is fucking dumb”<br>
&lt;/recent_quotes_from_frank_&gt;[/code]</p>
<p>Sorry frank_,  but there’s no magic in what you’re doing.</p>
<p><code>&lt;past_quote_from_frank_&gt;
LOL its amazing how little people seem to know about anything and how often they act as though they know.
&lt;/past_quote_from_frank_&gt;</code></p>
<p>You’ve changed over the years frank_… and not for the better. One of these days you’re going to have to ask yourself how people who truly know what they’re doing act, and then try your best to imitate them because, from what I’ve seen, that behavior isn’t going to come naturally for you.</p>
      </div>

      <meta itemprop='headline' content='Constructing a packet bot for Runescape'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
      <span itemprop='name'><b><a rel="next" itemprop="url" href="2699544658.html?page=2">next page →</a></b></span>
  </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/constructing-a-packet-bot-for-runescape/269954 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 17:23:52 GMT -->
</html>
