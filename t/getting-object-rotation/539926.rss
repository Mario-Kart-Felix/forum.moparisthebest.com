<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Getting Object Rotation</title>
    <link>https://forum.moparisthebest.com/t/getting-object-rotation/539926</link>
    <description>I&#39;m currently working on woodcutting and having issues with the rotation of newly spawned trees. Most servers seem to do woodcutting by loading the rotation and coordinates through a file, requiring you to manually input every &#39;cut-able&#39; tree into said file. I want to avoid doing this, because surely there&#39;s a way to retrieve the rotation of an object.

I&#39;ve been thinking that it should either be done through the relevant object click packet or the replace object method should be altered so that the rotation is left the same (if that makes any sense).

Here&#39;s the method I&#39;m using for replacing objects, if you need it for whatever reason:
[code]    /**
     * Replaces an object in the world.
     * @param p Player to replace object for.
     * @param x X-coordinate of object to replace.
     * @param y Y-coordinate of object to replace.
     * @param rot Rotation of object to replace.
     * @param id Id of new object.
     * @param type Type of object.
     */
    public void replace(Player p, int x, int y, int rot, int id, int type) {
        if (p == null || p.stream == null || p.disconnected) {
            return;
        }
        p.stream.createFrame(85);
        p.stream.writeByteC(y - (p.mapRegionY * 8));
        p.stream.writeByteC(x - (p.mapRegionX * 8));

        p.stream.createFrame(101);
        p.stream.writeByteC((type &lt;&lt; 2) + (rot &amp; 3));
        p.stream.writeByte(0);

        if (id != -1) {
            p.stream.createFrame(151);
            p.stream.writeByteS(0);
            p.stream.writeWordBigEndian(id);
            p.stream.writeByteS((type &lt;&lt; 2) + (rot &amp; 3));
        }
    }[/code]</description>
    
    <lastBuildDate>Tue, 11 Feb 2014 01:19:54 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/getting-object-rotation/539926.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Getting Object Rotation</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p><a href="https://www.moparisthebest.com/smf/index.php?topic=527173.0" data-bbcode="true" rel="nofollow noopener">This release</a> is a server-sided object clipping system.<br>
I found this code in it:</p>
<p>[code=java]	public static int getOrientation(int objectX, int objectY, int objectHeight)<br>
{<br>
if(cachedObjects.size() == 0)<br>
loadCachedObjects();<br>
int key = (objectHeight &lt;&lt; 30) + (objectX &lt;&lt; 15) + (objectY);<br>
return (cachedObjects.get(key) != null ? cachedObjects.get(key).getOrientation() : 0);<br>
}</p>
<pre><code>public static void changeOrientation(int objectX, int objectY, int objectHeight, int newO)
{
	if(cachedObjects.size() == 0)
		loadCachedObjects();
	int key = (objectHeight &lt;&lt; 30) + (objectX &lt;&lt; 15) + (objectY);
	if(cachedObjects.get(key) != null)
		cachedObjects.get(key).changeOrientation(newO);
}[/code]
</code></pre>
<p>I believe this is close to what you’re looking for, so I figured it’d help.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-object-rotation/539926/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-object-rotation/539926/5</link>
        <pubDate>Tue, 11 Feb 2014 01:19:54 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-539926-5</guid>
        <source url="https://forum.moparisthebest.com/t/getting-object-rotation/539926.rss">Getting Object Rotation</source>
      </item>
      <item>
        <title>Getting Object Rotation</title>
        <dc:creator><![CDATA[@pure2ownage Pure_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pure2ownage">@pure2ownage</a> wrote:</p>
          <blockquote>
              <p>[quote=“sinisoul, post:3, topic:539926”]That sounds like a bad idea Pure tbh</p>
<p>You should load the object data for a region and then have an object which allows you to change the type, rotation, etc. That’s the proper way of doing it.[/quote]Do you want to duke it out?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-object-rotation/539926/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-object-rotation/539926/4</link>
        <pubDate>Mon, 10 Feb 2014 18:37:58 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-539926-4</guid>
        <source url="https://forum.moparisthebest.com/t/getting-object-rotation/539926.rss">Getting Object Rotation</source>
      </item>
      <item>
        <title>Getting Object Rotation</title>
        <dc:creator><![CDATA[@sinisoul sini]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sinisoul">@sinisoul</a> wrote:</p>
          <blockquote>
              <p>That sounds like a bad idea Pure tbh</p>
<p>You should load the object data for a region and then have an object which allows you to change the type, rotation, etc. That’s the proper way of doing it.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-object-rotation/539926/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-object-rotation/539926/3</link>
        <pubDate>Mon, 10 Feb 2014 18:37:03 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-539926-3</guid>
        <source url="https://forum.moparisthebest.com/t/getting-object-rotation/539926.rss">Getting Object Rotation</source>
      </item>
      <item>
        <title>Getting Object Rotation</title>
        <dc:creator><![CDATA[@pure2ownage Pure_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pure2ownage">@pure2ownage</a> wrote:</p>
          <blockquote>
              <p>I think you’ll need to alter the packet to keep the rotation, or create a new one to get the rotation of an object in the given position. In my own experience I have found updating client objects very buggy.</p>
<p>Here is where packets 151 and 101 are intercepted (in the 317 refactored? client)</p>
<p><code>			if(pktType == 105 || pktType == 84 || pktType == 147 || pktType == 215 || pktType == 4 || pktType == 117 || pktType == 156 || pktType == 44 || pktType == 160 || pktType == 101 || pktType == 151)
			{
				method137(inStream, pktType);
				pktType = -1;
				return true;
			}</code></p>
<p>Packet 101</p>
<p><code>		if(j == 101)
		{
			int l2 = stream.method427();
			int k5 = l2 &gt;&gt; 2;
			int j8 = l2 &amp; 3;
			int i11 = anIntArray1177[k5];
			int j13 = stream.readUnsignedByte();
			int k15 = anInt1268 + (j13 &gt;&gt; 4 &amp; 7);
			int l16 = anInt1269 + (j13 &amp; 7);
			if(k15 &gt;= 0 &amp;&amp; l16 &gt;= 0 &amp;&amp; k15 &lt; 104 &amp;&amp; l16 &lt; 104)
				method130(-1, -1, j8, i11, l16, k5, plane, k15, 0);
			return;
		}</code></p>
<p>Packet 151</p>
<p>[code=java]		if(j == 151) // PACKET 151 - Replace object<br>
{<br>
int i2 = stream.method426();<br>
int l4 = anInt1268 + (i2 &gt;&gt; 4 &amp; 7);<br>
int k7 = anInt1269 + (i2 &amp; 7);<br>
int j10 = stream.method434();<br>
int k12 = stream.method428();<br>
int i15 = k12 &gt;&gt; 2;<br>
int k16 = k12 &amp; 3;<br>
int l17 = anIntArray1177[i15];</p>
<pre><code>		if(l4 &gt;= 0 &amp;&amp; k7 &gt;= 0 &amp;&amp; l4 &lt; 104 &amp;&amp; k7 &lt; 104)
			method130(-1, j10, k16, l17, k7, i15, plane, l4, 0);
		return;
	}[/code]</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-object-rotation/539926/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-object-rotation/539926/2</link>
        <pubDate>Mon, 10 Feb 2014 18:34:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-539926-2</guid>
        <source url="https://forum.moparisthebest.com/t/getting-object-rotation/539926.rss">Getting Object Rotation</source>
      </item>
      <item>
        <title>Getting Object Rotation</title>
        <dc:creator><![CDATA[@kihomura Kihomura]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/kihomura">@kihomura</a> wrote:</p>
          <blockquote>
              <p>I’m currently working on woodcutting and having issues with the rotation of newly spawned trees. Most servers seem to do woodcutting by loading the rotation and coordinates through a file, requiring you to manually input every ‘cut-able’ tree into said file. I want to avoid doing this, because surely there’s a way to retrieve the rotation of an object.</p>
<p>I’ve been thinking that it should either be done through the relevant object click packet or the replace object method should be altered so that the rotation is left the same (if that makes any sense).</p>
<p>Here’s the method I’m using for replacing objects, if you need it for whatever reason:</p>
<p>[code]    /**<br>
* Replaces an object in the world.<br>
* <a class="mention" href="/u/param">@param</a> p Player to replace object for.<br>
* <a class="mention" href="/u/param">@param</a> x X-coordinate of object to replace.<br>
* <a class="mention" href="/u/param">@param</a> y Y-coordinate of object to replace.<br>
* <a class="mention" href="/u/param">@param</a> rot Rotation of object to replace.<br>
* <a class="mention" href="/u/param">@param</a> id Id of new object.<br>
* <a class="mention" href="/u/param">@param</a> type Type of object.<br>
*/<br>
public void replace(Player p, int x, int y, int rot, int id, int type) {<br>
if (p == null || p.stream == null || p.disconnected) {<br>
return;<br>
}<br>
p.stream.createFrame(85);<br>
p.stream.writeByteC(y - (p.mapRegionY * 8));<br>
p.stream.writeByteC(x - (p.mapRegionX * 8));</p>
<pre><code>    p.stream.createFrame(101);
    p.stream.writeByteC((type &lt;&lt; 2) + (rot &amp; 3));
    p.stream.writeByte(0);

    if (id != -1) {
        p.stream.createFrame(151);
        p.stream.writeByteS(0);
        p.stream.writeWordBigEndian(id);
        p.stream.writeByteS((type &lt;&lt; 2) + (rot &amp; 3));
    }
}[/code]</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-object-rotation/539926/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-object-rotation/539926/1</link>
        <pubDate>Mon, 10 Feb 2014 17:35:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-539926-1</guid>
        <source url="https://forum.moparisthebest.com/t/getting-object-rotation/539926.rss">Getting Object Rotation</source>
      </item>
  </channel>
</rss>
