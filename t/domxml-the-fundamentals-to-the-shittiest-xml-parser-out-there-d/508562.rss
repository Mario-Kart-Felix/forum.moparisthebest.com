<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</title>
    <link>https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562</link>
    <description>So basically, I wanted to get into loading information from external sources. I discovered the best XML library to start with that is native to the default Java library. I will be teaching you how to load data to something such as your server from an XML file. 

Please leave any constructive criticism on what I could improve on. I am awhere this is probably the worst parser to use, but it is a good learning experience when you mess around with it.

In this tutorial, I will be teaching you how to spawn Global Objects via XML in PI servers. This could easily work for any other base as long as it has a global object spawning system.

So to start with, lets make an empty class and declare the package. Name the class [b]GlobalObjectSpawn.java[/b]

Be sure to add the correct package route so you don&#39;t get errors. I will add just the basic PI route though to help you out, feel free to edit.

[code=java]
package server.model.object;

public class GlobalObjectSpawn {

}
[/code]

So now that we have the empty class, we need to add the main method to actually perform the parsing. Name it [b]load[/b] and give it the parameter [b]Client[/b] so that no null pointers are given when you log in or start up server (depending on the base). Also, be sure to make the class static as we&#39;re going to be calling it statically later. Your class should now look like this:

[code=java]
package server.model.object;

public class GlobalObjectSpawn {

public static void load(Client c) {

}

}
[/code]

Now, everything that is going to come will be added in the [b]load[/b] method.

Lets start off with adding a try and catch statement so if anything happens that shouldn&#39;t, you will get a clear explanation of the problem that is happening. 

If you&#39;re not sure what a try/catch statement is, then here is what it would look like.

[code=java]package server.model.object;

public class GlobalObjectSpawn {

public static void load(Client c) {

try {

} catch (Exception e) {
e.printStackTrace();
}
}

}[/code]

If you compile now, you [b]WILL[/b] have errors as there is nothing inside the try/catch statement. So just ignore that.

Now comes the part where we set up the actual parsing of the XML data and loading of the objects.

First, make sure these are all imported:

[code=java]
import server.model.player.Client;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.DocumentBuilder;
import org.w3c.dom.Document;
import org.w3c.dom.NodeList;
import org.w3c.dom.Node;
import org.w3c.dom.Element;
import java.io.File;[/code]

Now, we have to provide the [b]load[/b] method a route to the actual XML file that contains all the data. 

Inside the try statement, declare this:

[code=java]File xmlFile = new File(&quot;./path to xml file&quot;);
DocumentBuilderFactory dbFactory = dbFactory.newDocumentBuilder();
Document doc = dBuilder.parse(xmlFile);[/code]

And finally, make sure this is declared so that the nodes don&#39;t get mixed up, as that sometimes happens with DOM when the Nodes aren&#39;t properly written in the XML file.

[code=java]doc.getDocumentElement().normalize();[/code]

Your load method should now look like this:

[code=java]
public static void load(Client c) {

		try {

			File xmlFile = new File(&quot;./path to xml file&quot;);
			DocumentBuilderFactory dbFactory = DocumentBuilderFactory
					.newInstance();
			DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
			Document doc = dBuilder.parse(xmlFile);

			doc.getDocumentElement().normalize();

				}
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
[/code]

Now comes the part where we define the name of the actual main node that you will be using in the actual XML file.

Declare this under the normalize declaration:

[code=java]NodeList nList = doc.getElementsByTagName(&quot;Object&quot;);[/code]

From the XML perspective, that would look like this, without any of the actual data loaded yet. The &#39;&#39;Object&#39; is the Node Name which we just declared.:

[code=xml]&lt;Object&gt;
&lt;/Object&gt;[/code]

Now, since you&#39;re going to want to be loading more than 1 object, we&#39;re going to have to loop through every single node. In order to do this, you will need to declare this:

[code=java]for (int i = 0; i &lt; nList.getLength(); i++) {

}[/code]

Now comes the part where we&#39;re going to parse and load the objects.

First, within the loop, add these:

[code=java]Node nNode = nList.item(i);

if (nNode.getNodeType() == Node.ELEMENT_NODE) {

Element eElement = (Element) nNode;

}[/code]

We&#39;re going to be loading the actual parsing within the if statement, under the line where we casted Element to nNode

So here is where you will need to check the base you&#39;re using if it isn&#39;t PI and edit it to fit it correctly.

In PI servers, the method to load Global Objects is in the PlayerAssistant class named &#39;checkObjectSpawn(id, x, y, face, type)&#39; or something of the sort parameter wise.

XML parsing reads all data as strings, so we will need to parse the Strings into integers in order to match int data type with int parameter. 

So first off, declare this:

[code=java]c.getPA().checkObjectSpawn(id, x, y, face, type);[/code]

Since we&#39;re going to be declaring the Object Id as a Node Attribute, we will be parsing it differently than the last 4 parameters.

Replace the Id parameter with this:

[code=java]Integer.parseInt(eElement.getAttribute(&quot;id&quot;))[/code]

So XML wise, setting an Object Id would look like this:

[code=xml]&lt;Object id = &quot;1&quot;&gt;
&lt;/Object&gt;
[/code]

Now that we&#39;re parsing the next four parameters as text contents since they&#39;re Sub-Nodes of the XML nodes, we will need to parse them differently. Remember though, that XML parses all data as strings so we will still need to convert all strings red to integers.

Replace the parameter x with this:

[code=java]Integer.parseInt(eElement.getElementsByTagName(&quot;X&quot;).item(0).getTextContent())[/code]

XML Wise, this is what it will look like:

[code=xml]&lt;Object id = &quot;1&quot;&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;/Object&gt;
[/code]

Replace the parameter y with this:

[code=java]Integer.parseInt(eElement.getElementsByTagName(&quot;Y&quot;).item(0).getTextContent())[/code]

XML wise, should look like this:

[code=xml]&lt;Object id = &quot;1&quot;&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;Y&gt;1&lt;/Y&gt;
&lt;/Object&gt;[/code]

Replace the parameter face with this:

[code=java]Integer.parseInt(eElement.getElementsByTagName(&quot;Face&quot;).item(0).getTextContent())[/code]

and now the XML should look like this:

[code=xml]&lt;Object id = &quot;1&quot;&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;Y&gt;1&lt;/Y&gt;
&lt;Face&gt;0&lt;/Face&gt;
&lt;/Object&gt;[/code]

Finally, replace the parameter type with:

[code=java]Integer.parseInt(eElement.getElementsByTagName(&quot;Type&quot;).item(0).getTextContent())[/code]

This is what a whole object spawning node should look like:

[code=xml]&lt;Object id = &quot;1&quot;&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;Y&gt;1&lt;/Y&gt;
&lt;Face&gt;0&lt;/Face&gt;
&lt;Type&gt;10&lt;/Type&gt;
&lt;/Object&gt;[/code]

If you successfully followed this tutorial, this is what the [b]GlobalObjectSpawn.java[/b] class should look like. This is properly formatted and looks prettier.  :| :

[code=java]package game.object.xml;

import game.Client;

import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.DocumentBuilder;
import org.w3c.dom.Document;
import org.w3c.dom.NodeList;
import org.w3c.dom.Node;
import org.w3c.dom.Element;
import java.io.File;

public class GlobalObjectSpawn {

	public static void load(Client c) {

		try {

			File xmlFile = new File(&quot;./path to xml file&quot;);
			DocumentBuilderFactory dbFactory = DocumentBuilderFactory
					.newInstance();
			DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
			Document doc = dBuilder.parse(xmlFile);

			doc.getDocumentElement().normalize();

			NodeList nList = doc.getElementsByTagName(&quot;Object&quot;);

			for (int i = 0; i &lt; nList.getLength(); i++) {

				Node nNode = nList.item(i);

				if (nNode.getNodeType() == Node.ELEMENT_NODE) {

					Element eElement = (Element) nNode;

						c.getPA().checkObjectSpawn(
								Integer.parseInt(eElement.getAttribute(&quot;id&quot;)),
								Integer.parseInt(eElement
										.getElementsByTagName(&quot;X&quot;).item(0)
										.getTextContent()),
								Integer.parseInt(eElement
										.getElementsByTagName(&quot;Y&quot;).item(0)
										.getTextContent()),
								Integer.parseInt(eElement
										.getElementsByTagName(&quot;Face&quot;).item(0)
										.getTextContent()),
								Integer.parseInt(eElement
										.getElementsByTagName(&quot;Type&quot;).item(0)
										.getTextContent()));
				}
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}[/code]

and here is what a finished product of the XML file would look like:

[code=xml]&lt;Objects&gt;
&lt;Object id = &quot;1&quot;&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;Y&gt;1&lt;/Y&gt;
&lt;Face&gt;0&lt;/Face&gt;
&lt;Type&gt;10&lt;/Type&gt;
&lt;/Object&gt;
&lt;/Objects&gt;[/code]

and to add more objects, just keep adding this node

[code=xml]&lt;Object id = &quot;1&quot;&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;Y&gt;1&lt;/Y&gt;
&lt;Face&gt;0&lt;/Face&gt;
&lt;Type&gt;10&lt;/Type&gt;
&lt;/Object&gt;[/code]

And add new data so new objects can be loaded in different places :D

[b]PLEASE: If you&#39;re having any trouble with this, please post for help in the &quot;Help Section&quot; found [url=http://www.moparisthebest.com/smf/index.php/board,48.0.html]here[/url]![/b]</description>
    
    <lastBuildDate>Sun, 17 Mar 2013 16:40:43 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</title>
        <dc:creator><![CDATA[@RiiPiiNFtW RiiPiiNFtW]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/riipiinftw">@RiiPiiNFtW</a> wrote:</p>
          <blockquote>
              <p>[quote=“eyeownyew, post:5, topic:508562”]So… why not XStream[/quote]External library. As I have said, this was more of a learning experience and I am well awhere of the fact that this is one of the worse parsers out there, it was just handy as DOM is a native library.</p>
<p>Here are two more classes I made for Despawning Global Objects loaded by the actual mapdata, and a global item system great for things like quests.</p>
<p>[code=java]package game.object.xml;</p>
<p>import game.Client;</p>
<p>import javax.xml.parsers.DocumentBuilderFactory;<br>
import javax.xml.parsers.DocumentBuilder;<br>
import org.w3c.dom.Document;<br>
import org.w3c.dom.NodeList;<br>
import org.w3c.dom.Node;<br>
import org.w3c.dom.Element;<br>
import java.io.File;</p>
<p>/**</p>
<ul>
<li>GlobalObjectSpawn.java</li>
<li>
</li>
<li>
<span class="mention">@author</span> RiiPiiNFtW </li>
<li>
<a class="mention" href="/u/date">@date</a> 2/22/12</li>
<li>
<a class="mention" href="/u/skype">@skype</a> stuart.perera</li>
<li>
</li>
<li>
<pre><code>   Used to read node values off the XML document and spawns global
</code></pre>
</li>
<li>
<pre><code>   objects.
</code></pre>
</li>
<li>
</li>
</ul>
<p>*/</p>
<p>public class GlobalObjectSpawn {</p>
<pre><code>public static void load(Client c) {

	try {

		File fXmlFile = new File("./data/cfg/xml/SpawnedObjects.xml");
		DocumentBuilderFactory dbFactory = DocumentBuilderFactory
				.newInstance();
		DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
		Document doc = dBuilder.parse(fXmlFile);

		doc.getDocumentElement().normalize();

		NodeList nList = doc.getElementsByTagName("Object");

		for (int i = 0; i &lt; nList.getLength(); i++) {

			Node nNode = nList.item(i);

			if (nNode.getNodeType() == Node.ELEMENT_NODE) {

				Element eElement = (Element) nNode;

					c.getPA().checkObjectSpawn(
							Integer.parseInt(eElement.getAttribute("id")),
							Integer.parseInt(eElement
									.getElementsByTagName("X").item(0)
									.getTextContent()),
							Integer.parseInt(eElement
									.getElementsByTagName("Y").item(0)
									.getTextContent()),
							Integer.parseInt(eElement
									.getElementsByTagName("Face").item(0)
									.getTextContent()),
							Integer.parseInt(eElement
									.getElementsByTagName("Type").item(0)
									.getTextContent()));
			}
		}
	} catch (Exception e) {
		e.printStackTrace();
	}
}
</code></pre>
<p>}[/code]</p>
<p>[code=java]package game.item.global;</p>
<p>import game.Client;<br>
import game.Constants;<br>
import game.item.GroundItem;<br>
import game.item.ItemHandler;<br>
import game.player.PlayerHandler;</p>
<p>import java.io.File;</p>
<p>import javax.xml.parsers.DocumentBuilder;<br>
import javax.xml.parsers.DocumentBuilderFactory;</p>
<p>import org.w3c.dom.Document;<br>
import org.w3c.dom.Element;<br>
import org.w3c.dom.Node;<br>
import org.w3c.dom.NodeList;</p>
<p>/**</p>
<ul>
<li>GlobalItemConfiguration.java</li>
<li>
</li>
<li>
<span class="mention">@author</span> Stuart Perera</li>
<li>
<a class="mention" href="/u/date">@date</a> 2/27/13</li>
<li>
<a class="mention" href="/u/skype">@skype</a> stuart.perera</li>
<li>
</li>
<li>This is used to spawn global items throughout the private server that this is used in. To spawn more</li>
<li>items, you would need to add another node into the actual XML file.</li>
<li>
</li>
</ul>
<p>*/</p>
<p>public class GlobalItemConfiguration {</p>
<pre><code>public void load(Client c) {
	try {

		File fXmlFile = new File("./data/cfg/xml/SpawnedItems.xml");
		DocumentBuilderFactory dbFactory = DocumentBuilderFactory
				.newInstance();
		DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
		Document doc = dBuilder.parse(fXmlFile);

		doc.getDocumentElement().normalize();

		NodeList nList = doc.getElementsByTagName("Item");

		for (int i = 0; i &lt; nList.getLength(); i++) {
			Node nNode = nList.item(i);
			if (nNode.getNodeType() == Node.ELEMENT_NODE) {
				Element eElement = (Element) nNode;
				for (int j = 0; j &lt; Constants.MAX_PLAYERS; j++) {
					Client client = (Client) PlayerHandler.players[j];
					if (client != null) {
						if (client.distanceToPoint(
								Integer.parseInt(eElement
										.getElementsByTagName("X").item(i)
										.getTextContent()),
								Integer.parseInt(eElement
										.getElementsByTagName("Y").item(i)
										.getTextContent())) &lt;= 60) {
							GroundItem item = new GroundItem(
									Integer.parseInt(eElement
											.getAttribute("id")),
									Integer.parseInt(eElement
											.getElementsByTagName("X")
											.item(i).getTextContent()),
									Integer.parseInt(eElement
											.getElementsByTagName("Y")
											.item(i).getTextContent()),
									Integer.parseInt(eElement
											.getElementsByTagName("Height")
											.item(i).getTextContent()),
									Integer.parseInt(eElement
											.getElementsByTagName("Amount")
											.item(i).getTextContent()), 0,
									0, "GLOBAL");
							ItemHandler.addItem(item);
						}
					}
				}
			}
		}
	} catch (Exception e) {
		e.printStackTrace();
	}
}
</code></pre>
<p>}<br>
[/code]</p>
<p><code>&lt;Objects&gt;
	&lt;Object&gt;
		&lt;X&gt;1&lt;/X&gt;
		&lt;Y&gt;1&lt;/Y&gt;
	&lt;/Object&gt;
&lt;/Objects&gt;</code></p>
<p><code>&lt;Items&gt;
	&lt;Item id="1"&gt;
		&lt;X&gt;1&lt;/X&gt;
		&lt;Y&gt;1&lt;/Y&gt;
		&lt;Height&gt;0&lt;/Height&gt;
		&lt;Amount&gt;1&lt;/Amount&gt;
	&lt;/Item&gt;
&lt;/Items&gt;</code></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/6</link>
        <pubDate>Sun, 17 Mar 2013 16:40:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-508562-6</guid>
        <source url="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562.rss">DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</source>
      </item>
      <item>
        <title>DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</title>
        <dc:creator><![CDATA[@eyeownyew Eyeownyew]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/eyeownyew">@eyeownyew</a> wrote:</p>
          <blockquote>
              <p>So… why not XStream</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/5</link>
        <pubDate>Sun, 17 Mar 2013 02:05:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-508562-5</guid>
        <source url="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562.rss">DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</source>
      </item>
      <item>
        <title>DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</title>
        <dc:creator><![CDATA[@Flame3 John]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/flame3">@Flame3</a> wrote:</p>
          <blockquote>
              <p>Good job, if I ever use PI I’ll look into this.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/4</link>
        <pubDate>Sun, 17 Mar 2013 02:03:20 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-508562-4</guid>
        <source url="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562.rss">DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</source>
      </item>
      <item>
        <title>DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</title>
        <dc:creator><![CDATA[@RiiPiiNFtW RiiPiiNFtW]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/riipiinftw">@RiiPiiNFtW</a> wrote:</p>
          <blockquote>
              <p>[quote=“Clawz fury, post:2, topic:508562”]Oh damn this even helped me lol, nice tutorial.</p>
<p>I really hate xml, but for big things like definitions I’d recommend it. I wouldn’t use XML for object spawns though.[/quote]Yea, I know. When I originally had the urge to learn, I was looking for something easy just to mess around with it and getting it to work. It could be used better, but this did help me learn. <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/3</link>
        <pubDate>Sun, 17 Mar 2013 01:57:14 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-508562-3</guid>
        <source url="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562.rss">DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</source>
      </item>
      <item>
        <title>DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</title>
        <dc:creator><![CDATA[@Clawz_fury lare69]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/clawz_fury">@Clawz_fury</a> wrote:</p>
          <blockquote>
              <p>Oh damn this even helped me lol, nice tutorial.</p>
<p>I really hate xml, but for big things like definitions I’d recommend it. I wouldn’t use XML for object spawns though.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/2</link>
        <pubDate>Sun, 17 Mar 2013 01:49:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-508562-2</guid>
        <source url="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562.rss">DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</source>
      </item>
      <item>
        <title>DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</title>
        <dc:creator><![CDATA[@RiiPiiNFtW RiiPiiNFtW]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/riipiinftw">@RiiPiiNFtW</a> wrote:</p>
          <blockquote>
              <p>So basically, I wanted to get into loading information from external sources. I discovered the best XML library to start with that is native to the default Java library. I will be teaching you how to load data to something such as your server from an XML file.</p>
<p>Please leave any constructive criticism on what I could improve on. I am awhere this is probably the worst parser to use, but it is a good learning experience when you mess around with it.</p>
<p>In this tutorial, I will be teaching you how to spawn Global Objects via XML in PI servers. This could easily work for any other base as long as it has a global object spawning system.</p>
<p>So to start with, lets make an empty class and declare the package. Name the class <span class="bbcode-b">GlobalObjectSpawn.java</span></p>
<p>Be sure to add the correct package route so you don’t get errors. I will add just the basic PI route though to help you out, feel free to edit.</p>
<pre><code class="lang-auto">package server.model.object;

public class GlobalObjectSpawn {

}</code></pre>
<p>So now that we have the empty class, we need to add the main method to actually perform the parsing. Name it <span class="bbcode-b">load</span> and give it the parameter <span class="bbcode-b">Client</span> so that no null pointers are given when you log in or start up server (depending on the base). Also, be sure to make the class static as we’re going to be calling it statically later. Your class should now look like this:</p>
<pre><code class="lang-auto">package server.model.object;

public class GlobalObjectSpawn {

public static void load(Client c) {

}

}</code></pre>
<p>Now, everything that is going to come will be added in the <span class="bbcode-b">load</span> method.</p>
<p>Lets start off with adding a try and catch statement so if anything happens that shouldn’t, you will get a clear explanation of the problem that is happening.</p>
<p>If you’re not sure what a try/catch statement is, then here is what it would look like.</p>
<p>[code=java]package server.model.object;</p>
<p>public class GlobalObjectSpawn {</p>
<p>public static void load(Client c) {</p>
<p>try {</p>
<p>} catch (Exception e) {<br>
e.printStackTrace();<br>
}<br>
}</p>
<p>}[/code]</p>
<p>If you compile now, you <span class="bbcode-b">WILL</span> have errors as there is nothing inside the try/catch statement. So just ignore that.</p>
<p>Now comes the part where we set up the actual parsing of the XML data and loading of the objects.</p>
<p>First, make sure these are all imported:</p>
<pre><code class="lang-auto">import server.model.player.Client;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.DocumentBuilder;
import org.w3c.dom.Document;
import org.w3c.dom.NodeList;
import org.w3c.dom.Node;
import org.w3c.dom.Element;
import java.io.File;[/code]

Now, we have to provide the [b]load[/b] method a route to the actual XML file that contains all the data. 

Inside the try statement, declare this:

[code=java]File xmlFile = new File("./path to xml file");
DocumentBuilderFactory dbFactory = dbFactory.newDocumentBuilder();
Document doc = dBuilder.parse(xmlFile);[/code]

And finally, make sure this is declared so that the nodes don't get mixed up, as that sometimes happens with DOM when the Nodes aren't properly written in the XML file.

[code=java]doc.getDocumentElement().normalize();[/code]

Your load method should now look like this:

[code=java]
public static void load(Client c) {

		try {

			File xmlFile = new File("./path to xml file");
			DocumentBuilderFactory dbFactory = DocumentBuilderFactory
					.newInstance();
			DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
			Document doc = dBuilder.parse(xmlFile);

			doc.getDocumentElement().normalize();

				}
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
[/code]

Now comes the part where we define the name of the actual main node that you will be using in the actual XML file.

Declare this under the normalize declaration:

[code=java]NodeList nList = doc.getElementsByTagName("Object");[/code]

From the XML perspective, that would look like this, without any of the actual data loaded yet. The ''Object' is the Node Name which we just declared.:

[code=xml]&lt;Object&gt;
&lt;/Object&gt;[/code]

Now, since you're going to want to be loading more than 1 object, we're going to have to loop through every single node. In order to do this, you will need to declare this:

[code=java]for (int i = 0; i &lt; nList.getLength(); i++) {

}[/code]

Now comes the part where we're going to parse and load the objects.

First, within the loop, add these:

[code=java]Node nNode = nList.item(i);

if (nNode.getNodeType() == Node.ELEMENT_NODE) {

Element eElement = (Element) nNode;

}[/code]

We're going to be loading the actual parsing within the if statement, under the line where we casted Element to nNode

So here is where you will need to check the base you're using if it isn't PI and edit it to fit it correctly.

In PI servers, the method to load Global Objects is in the PlayerAssistant class named 'checkObjectSpawn(id, x, y, face, type)' or something of the sort parameter wise.

XML parsing reads all data as strings, so we will need to parse the Strings into integers in order to match int data type with int parameter. 

So first off, declare this:

[code=java]c.getPA().checkObjectSpawn(id, x, y, face, type);[/code]

Since we're going to be declaring the Object Id as a Node Attribute, we will be parsing it differently than the last 4 parameters.

Replace the Id parameter with this:

[code=java]Integer.parseInt(eElement.getAttribute("id"))[/code]

So XML wise, setting an Object Id would look like this:

[code=xml]&lt;Object id = "1"&gt;
&lt;/Object&gt;</code></pre>
<p>Now that we’re parsing the next four parameters as text contents since they’re Sub-Nodes of the XML nodes, we will need to parse them differently. Remember though, that XML parses all data as strings so we will still need to convert all strings red to integers.</p>
<p>Replace the parameter x with this:</p>
<pre><code class="lang-auto"></code></pre>
<p>XML Wise, this is what it will look like:</p>
<p><code>&lt;Object id = "1"&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;/Object&gt;
</code></p>
<p>Replace the parameter y with this:</p>
<pre><code class="lang-auto"></code></pre>
<p>XML wise, should look like this:</p>
<p><code>&lt;Object id = "1"&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;Y&gt;1&lt;/Y&gt;
&lt;/Object&gt;</code></p>
<p>Replace the parameter face with this:</p>
<pre><code class="lang-auto"></code></pre>
<p>and now the XML should look like this:</p>
<p><code>&lt;Object id = "1"&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;Y&gt;1&lt;/Y&gt;
&lt;Face&gt;0&lt;/Face&gt;
&lt;/Object&gt;</code></p>
<p>Finally, replace the parameter type with:</p>
<pre><code class="lang-auto"></code></pre>
<p>This is what a whole object spawning node should look like:</p>
<p><code>&lt;Object id = "1"&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;Y&gt;1&lt;/Y&gt;
&lt;Face&gt;0&lt;/Face&gt;
&lt;Type&gt;10&lt;/Type&gt;
&lt;/Object&gt;</code></p>
<p>If you successfully followed this tutorial, this is what the <span class="bbcode-b">GlobalObjectSpawn.java</span> class should look like. This is properly formatted and looks prettier.  <img src="https://forum.moparisthebest.com/images/emoji/twitter/expressionless.png?v=5" title=":expressionless:" class="emoji" alt=":expressionless:"> :</p>
<p>[code=java]package game.object.xml;</p>
<p>import game.Client;</p>
<p>import javax.xml.parsers.DocumentBuilderFactory;<br>
import javax.xml.parsers.DocumentBuilder;<br>
import org.w3c.dom.Document;<br>
import org.w3c.dom.NodeList;<br>
import org.w3c.dom.Node;<br>
import org.w3c.dom.Element;<br>
import java.io.File;</p>
<p>public class GlobalObjectSpawn {</p>
<pre><code>public static void load(Client c) {

	try {

		File xmlFile = new File("./path to xml file");
		DocumentBuilderFactory dbFactory = DocumentBuilderFactory
				.newInstance();
		DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
		Document doc = dBuilder.parse(xmlFile);

		doc.getDocumentElement().normalize();

		NodeList nList = doc.getElementsByTagName("Object");

		for (int i = 0; i &lt; nList.getLength(); i++) {

			Node nNode = nList.item(i);

			if (nNode.getNodeType() == Node.ELEMENT_NODE) {

				Element eElement = (Element) nNode;

					c.getPA().checkObjectSpawn(
							Integer.parseInt(eElement.getAttribute("id")),
							Integer.parseInt(eElement
									.getElementsByTagName("X").item(0)
									.getTextContent()),
							Integer.parseInt(eElement
									.getElementsByTagName("Y").item(0)
									.getTextContent()),
							Integer.parseInt(eElement
									.getElementsByTagName("Face").item(0)
									.getTextContent()),
							Integer.parseInt(eElement
									.getElementsByTagName("Type").item(0)
									.getTextContent()));
			}
		}
	} catch (Exception e) {
		e.printStackTrace();
	}
}
</code></pre>
<p>}[/code]</p>
<p>and here is what a finished product of the XML file would look like:</p>
<p><code>&lt;Objects&gt;
&lt;Object id = "1"&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;Y&gt;1&lt;/Y&gt;
&lt;Face&gt;0&lt;/Face&gt;
&lt;Type&gt;10&lt;/Type&gt;
&lt;/Object&gt;
&lt;/Objects&gt;</code></p>
<p>and to add more objects, just keep adding this node</p>
<p><code>&lt;Object id = "1"&gt;
&lt;X&gt;1&lt;/X&gt;
&lt;Y&gt;1&lt;/Y&gt;
&lt;Face&gt;0&lt;/Face&gt;
&lt;Type&gt;10&lt;/Type&gt;
&lt;/Object&gt;</code></p>
<p>And add new data so new objects can be loaded in different places <img src="https://forum.moparisthebest.com/images/emoji/twitter/smiley.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p><span class="bbcode-b">PLEASE: If you’re having any trouble with this, please post for help in the “Help Section” found <a href="http://www.moparisthebest.com/smf/index.php/board,48.0.html" data-bbcode="true" rel="nofollow noopener">here</a>!</span></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562/1</link>
        <pubDate>Sun, 17 Mar 2013 01:18:18 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-508562-1</guid>
        <source url="https://forum.moparisthebest.com/t/domxml-the-fundamentals-to-the-shittiest-xml-parser-out-there-d/508562.rss">DOMXML - The Fundamentals to the Shittiest XML Parser out there! :D</source>
      </item>
  </channel>
</rss>
