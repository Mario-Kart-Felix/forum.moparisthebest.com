<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/access-denied/379954 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 21:05:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Access Denied - General Programming - moparisthebest.com</title>
    <meta name="description" content="Back when I first started making hacks for Combat Arms, I was on Windows Vista 64 bit, I&amp;#39;ve installed linux since then, and now I&amp;#39;ve just installed Windows 7 32 bit, in hopes of going back to hacking Combats Arms... 

An&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="379954.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Access Denied&#39;" href="379954.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/access-denied/379954" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/access-denied/379954" />
<meta property="og:title" content="Access Denied" />
<meta name="twitter:title" content="Access Denied" />
<meta property="og:description" content="Back when I first started making hacks for Combat Arms, I was on Windows Vista 64 bit, I’ve installed linux since then, and now I’ve just installed Windows 7 32 bit, in hopes of going back to hacking Combats Arms…  Anyway, I started making a new application and it seems like every time I try to OpenProcess or OpenThread on the Engine.exe I get access denied.  I set the SeDebugPrivlege and I run as administrator (even though I have UAC turned off), but with no success…  I’m not sure exactly how i..." />
<meta name="twitter:description" content="Back when I first started making hacks for Combat Arms, I was on Windows Vista 64 bit, I’ve installed linux since then, and now I’ve just installed Windows 7 32 bit, in hopes of going back to hacking Combats Arms…  Anyway, I started making a new application and it seems like every time I try to OpenProcess or OpenThread on the Engine.exe I get access denied.  I set the SeDebugPrivlege and I run as administrator (even though I have UAC turned off), but with no success…  I’m not sure exactly how i..." />
<meta property="article:published_time" content="2011-01-25T19:31:33+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="379954.html">Access Denied</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Evil1.html'><span itemprop='name'>Evil1</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-01-25T19:31:33Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:10:45Z' class='post-time'>
              August 1, 2016,  7:10am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Back when I first started making hacks for Combat Arms, I was on Windows Vista 64 bit, I’ve installed linux since then, and now I’ve just installed Windows 7 32 bit, in hopes of going back to hacking Combats Arms…</p>
<p>Anyway, I started making a new application and it seems like every time I try to OpenProcess or OpenThread on the Engine.exe I get access denied.  I set the SeDebugPrivlege and I run as administrator (even though I have UAC turned off), but with no success…</p>
<p>I’m not sure exactly how it’s doing it, but it’s putting itself above administrator rights, even other programs that should list information about the process aren’t working, instead it’s just showing blank screens.</p>
<p>Does anyone have any idea why this is, or better yet, how I can fix it?  I’m downloading a 64 bit version of Windows 7 now to install as a backup plan, if I can’t figure this out.</p>
      </div>

      <meta itemprop='headline' content='Access Denied'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sppt.html'><span itemprop='name'>sppt</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-01-25T21:19:48Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:10:59Z' class='post-time'>
              August 1, 2016,  7:10am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Well, couldn’t it be that the protection they use updated to prevent you from doing so?</p>
      </div>

      <meta itemprop='headline' content='Access Denied'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Evil1.html'><span itemprop='name'>Evil1</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-01-25T21:55:16Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:11:02Z' class='post-time'>
              August 1, 2016,  7:11am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“sppt, post:2, topic:379954”]Well, couldn’t it be that the protection they use updated to prevent you from doing so?[/quote]I don’t know, I’m using the same techniques I used before (for injection which the topic isn’t asking about, but it’s what made me notice), and from the other people I’ve asked my method still works for them (Simply just CreateRemoteThread) it’s kinda making me mad lol</p>
      </div>

      <meta itemprop='headline' content='Access Denied'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Mopman.html'><span itemprop='name'>Mopman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-01-25T23:27:23Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:11:07Z' class='post-time'>
              August 1, 2016,  7:11am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>coad or gtfo</p>
      </div>

      <meta itemprop='headline' content='Access Denied'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Evil1.html'><span itemprop='name'>Evil1</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-01-25T23:38:16Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:11:07Z' class='post-time'>
              August 1, 2016,  7:11am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[code=C++]// CombatArmsPauser.cpp : Defines the entry point for the console application.<br>
//</p>
<p><span class="hashtag">#include</span> &lt;Windows.h&gt;<br>
<span class="hashtag">#include</span> &lt;TlHelp32.h&gt;<br>
<span class="hashtag">#include</span> <br>
<span class="hashtag">#include</span> </p>
<p>using std::string;<br>
using std::cout;<br>
using std::endl;</p>
<p>DWORD FindProcessByExe(const std::string&amp; szExeName);<br>
bool ModifyProcess(DWORD dwProcessID, bool resume);</p>
<p>/* Yea, this is copied straight from the MSDN site. Idgaf, shoot me. lolol */<br>
BOOL SetPrivilege(<br>
HANDLE hToken,          // access token handle<br>
LPCTSTR lpszPrivilege,  // name of privilege to enable/disable<br>
BOOL bEnablePrivilege   // to enable or disable privilege<br>
)<br>
{<br>
TOKEN_PRIVILEGES tp;<br>
LUID luid;</p>
<pre><code>if ( !LookupPrivilegeValue( 
        NULL,            // lookup privilege on local system
        lpszPrivilege,   // privilege to lookup 
        &amp;luid ) )        // receives LUID of privilege
{
    printf("LookupPrivilegeValue error: %u\n", GetLastError() ); 
    return FALSE; 
}

tp.PrivilegeCount = 1;
tp.Privileges[0].Luid = luid;
if (bEnablePrivilege)
    tp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;
else
    tp.Privileges[0].Attributes = 0;

// Enable the privilege or disable all privileges.

if ( !AdjustTokenPrivileges(
       hToken, 
       FALSE, 
       &amp;tp, 
       sizeof(TOKEN_PRIVILEGES), 
       (PTOKEN_PRIVILEGES) NULL, 
       (PDWORD) NULL) )
{ 
      printf("AdjustTokenPrivileges error: %u\n", GetLastError() ); 
      return FALSE; 
} 

if (GetLastError() == ERROR_NOT_ALL_ASSIGNED)

{
      printf("The token does not have the specified privilege. \n");
      return FALSE;
} 

return TRUE;
</code></pre>
<p>}</p>
<p>int main(int argc, char* argv[])<br>
{<br>
HANDLE hCurrent;<br>
OpenProcessToken(GetCurrentProcess(), TOKEN_ALL_ACCESS, &amp;hCurrent);</p>
<pre><code>if(SetPrivilege(hCurrent, "SeDebugPrivilege", true))
{
	cout &lt;&lt; "Set." &lt;&lt; endl;
} else {
	cout &lt;&lt; "Fail." &lt;&lt; endl;
}


DWORD dwId = FindProcessByExe("engine.exe");

if(dwId &gt; 0) 
{
	ModifyProcess(dwId, false);
	std::cin.get();
	ModifyProcess(dwId, true);
}
else
{
	cout &lt;&lt; "Unable to find the process." &lt;&lt; endl;
}

std::cin.get();
return 0;
</code></pre>
<p>}</p>
<p>DWORD FindProcessByExe(const std::string&amp; szExeName)<br>
{<br>
DWORD pid = 0;<br>
HANDLE hSnap = NULL;<br>
PROCESSENTRY32 pe32;</p>
<pre><code>hSnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);

pe32.dwSize = sizeof(PROCESSENTRY32);

if(Process32First(hSnap, &amp;pe32)) 
{
	do
	{
		if(stricmp(pe32.szExeFile, szExeName.c_str()) == 0)
		{
			pid = pe32.th32ProcessID;
			break;
		}
	} while(Process32Next(hSnap, &amp;pe32));
}

CloseHandle(hSnap);

return pid;
</code></pre>
<p>}</p>
<p>bool ModifyProcess(DWORD dwProcessID, bool resume)<br>
{<br>
HANDLE hSnap = NULL;<br>
THREADENTRY32 te32;</p>
<pre><code>hSnap = CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, 0);

te32.dwSize = sizeof(THREADENTRY32);

if(Thread32First(hSnap, &amp;te32)) 
{
	do
	{
		if(te32.th32OwnerProcessID == dwProcessID) 
		{
			HANDLE hHandle = OpenThread(THREAD_SUSPEND_RESUME, FALSE, te32.th32ThreadID);
			DWORD x;
			if(resume) {
				x = ResumeThread(hHandle);
			} else {
				x = SuspendThread(hHandle);
			}
                            // x should hold the amount of threads that were suspended when the call was made, 
                            // or -1 if there was an error, I get -1 because I'm pro.
			cout &lt;&lt; "Thread: " &lt;&lt; te32.th32ThreadID &lt;&lt; ": " &lt;&lt; x &lt;&lt; endl;
		}
	} while(Thread32Next(hSnap, &amp;te32));
}

CloseHandle(hSnap);

return true;
</code></pre>
<p>}<br>
[/code]</p>
      </div>

      <meta itemprop='headline' content='Access Denied'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Tekk123.html'><span itemprop='name'>Tekk123</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-01-26T00:14:55Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:11:09Z' class='post-time'>
              August 1, 2016,  7:11am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Note that I just glanced over your code (didn’t study it in depth), but this is a function I wrote to enable the privilege when I was messing with the same stuff a few months ago, and it worked for me on Windows 7 32-bit. I leave it as an exercise to the reader to find out how this is different in any way from what you already have, LoL.</p>
<pre><code class="lang-auto">void SetSeDebug(void)
{
	HANDLE hToken;
	LUID seDebugValue;
	TOKEN_PRIVILEGES tPriv;
	
	ZeroMemory(&amp;tPriv, sizeof(tPriv));
	if(!OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken)) {
		MessageBox(NULL, "OpenProcessToken failed", "Error", MB_ICONEXCLAMATION);
		return;
	}
	
	if(!LookupPrivilegeValue(NULL, SE_DEBUG_NAME, &amp;seDebugValue)) {
		MessageBox(NULL, "LookupPrivilegeValue failed", "Error", MB_ICONEXCLAMATION);
		CloseHandle(hToken);
		return;
	}
	
	tPriv.PrivilegeCount = 1;
	tPriv.Privileges[0].Luid = seDebugValue;
	tPriv.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;
	
	if(!AdjustTokenPrivileges(hToken, FALSE, &amp;tPriv, sizeof(tPriv), NULL, NULL) || GetLastError() != 0)
		MessageBox(NULL, "AdjustTokenPrivileges failed, try running as admin?", "Error", MB_ICONEXCLAMATION);
	CloseHandle(hToken);
}</code></pre>
      </div>

      <meta itemprop='headline' content='Access Denied'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/access-denied/379954 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 21:05:01 GMT -->
</html>
