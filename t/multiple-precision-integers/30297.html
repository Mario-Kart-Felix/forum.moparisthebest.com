<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/multiple-precision-integers/30297 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 20:27:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Multiple precision integers? - General Programming - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;m trying to imitate SSH packets to gain access to another machine (don&amp;#39;t ask how, I don&amp;#39;t really know :P, [url=http://ps3.shimpinomori.net/index_en.html]but in case you&amp;#39;re interested...[/url]). I was reading some docs &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="30297.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Multiple precision integers?&#39;" href="30297.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/multiple-precision-integers/30297" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/multiple-precision-integers/30297" />
<meta property="og:title" content="Multiple precision integers?" />
<meta name="twitter:title" content="Multiple precision integers?" />
<meta property="og:description" content="I&#39;m trying to imitate SSH packets to gain access to another machine (don&#39;t ask how, I don&#39;t really know :P, [url=http://ps3.shimpinomori.net/index_en.html]but in case you&#39;re interested...[/url]). I was reading some docs on these packet types (found [url=http://www.massconfusion.com/ssh/ssh_sample.html]here[/url]) and one of the data types used is an &quot;mp-int&quot;. I did some research and turns out that this is short for a multiple precision integer. I did some [i]more[/i] researching on this, mostly ..." />
<meta name="twitter:description" content="I&#39;m trying to imitate SSH packets to gain access to another machine (don&#39;t ask how, I don&#39;t really know :P, [url=http://ps3.shimpinomori.net/index_en.html]but in case you&#39;re interested...[/url]). I was reading some docs on these packet types (found [url=http://www.massconfusion.com/ssh/ssh_sample.html]here[/url]) and one of the data types used is an &quot;mp-int&quot;. I did some research and turns out that this is short for a multiple precision integer. I did some [i]more[/i] researching on this, mostly ..." />
<meta property="article:published_time" content="2006-11-28T11:09:10+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="30297.html">Multiple precision integers?</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/White_Castle.html'><span itemprop='name'>White_Castle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-11-28T11:09:10Z'>
            <time itemprop='dateModified' datetime='2016-07-30T01:14:43Z' class='post-time'>
              July 30, 2016,  1:14am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <pre><code>I'm trying to imitate SSH packets to gain access to another machine (don't ask how, I don't really know :P, [url=http://ps3.shimpinomori.net/index_en.html]but in case you're interested...[/url]). I was reading some docs on these packet types (found [url=http://www.massconfusion.com/ssh/ssh_sample.html]here[/url]) and one of the data types used is an "mp-int". I did some research and turns out that this is short for a multiple precision integer. I did some [i]more[/i] researching on this, mostly on how to use it with Java, and I found that the java.math.BigInteger is compatible with this data type. However, I'm really not sure even how it works:
</code></pre>
<blockquote>   mpint
<pre><code>  Represents multiple precision integers in two's complement format,
  stored as a string, 8 bits per byte, MSB first.  Negative numbers
  have the value 1 as the most significant bit of the first byte of
  the data partition.  If the most significant bit would be set for
  a positive number, the number MUST be preceded by a zero byte.
  Unnecessary leading bytes with the value 0 or 255 MUST NOT be
  included.  The value zero MUST be stored as a string with zero
  bytes of data.

  By convention, a number that is used in modular computations in
  Z_n SHOULD be represented in the range 0 &lt;= x &lt; n.&lt;/blockquote&gt;

So, any sort of explanation of how this strange data type works would be greatly appreciated. :)

By the way, in case you're familiar at all with the SSH packet structure, I seem to be receiving packet type 7, when I should be receiving type 2. That doc is from 1995, and it's SSH-1 (current is SSH-2), so I wouldn't be surprised if I've got everything all wrong.

And I posted this in General Programming because it seemed like a more general question. Move it if it suits you. :)</code></pre>
</blockquote>
      </div>

      <meta itemprop='headline' content='Multiple precision integers?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/k00dr.html'><span itemprop='name'>k00dr</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-11-28T14:01:07Z'>
            <time itemprop='dateModified' datetime='2016-07-30T01:14:53Z' class='post-time'>
              July 30, 2016,  1:14am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>As you know, a long in Java, being 64 bits, is the biggest primitive. BigInteger can hold as big value as possible.<br>
This is used in e.g.  the RS client to hold an RSA key, which is a damn big prime number.</p>
      </div>

      <meta itemprop='headline' content='Multiple precision integers?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BobDole81.html'><span itemprop='name'>BobDole81</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-11-28T20:12:06Z'>
            <time itemprop='dateModified' datetime='2016-07-30T01:15:13Z' class='post-time'>
              July 30, 2016,  1:15am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“k00dr, post:2, topic:30297”]This is used in e.g.  the RS client to hold an RSA key, which is a damn big prime number.[/quote]Only 154 digits…not too bad <img src="../../images/emoji/twitter/stuck_out_tongue1bce.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>Multiple-precision and arbitrary-precision integers are pretty much the same…they allow for handling of integers of ‘virtually’ unlimited length.  Typically, arrays are used to handle each individual ‘precise’ value…it can be in the form of each individual bit in an index, a single word value (or 2 bytes) or full multi-digit integers.  The latter is more difficult to manage, but can be far more efficient (this is what BigInteger does I believe). Some mulltiple-precision integers may also use an integer representing each individual digit of the number, each multiplied by 10^n, where n is its array index, and summed, which is one of the more basic methods…This has the limitation of the size of an integer (hence the ‘virtually’ unlimited size).  So you can only have store an integer with a bit length of less than 2^31…BigInteger can do more though <img src="../../images/emoji/twitter/wink1bce.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>

      <meta itemprop='headline' content='Multiple precision integers?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/White_Castle.html'><span itemprop='name'>White_Castle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-11-28T21:22:37Z'>
            <time itemprop='dateModified' datetime='2016-07-30T01:15:17Z' class='post-time'>
              July 30, 2016,  1:15am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thank you both for the explanations :). Just one more question, how would I read this integer from an InputStream? Would you just do something like DataInputStream.readInt() and then convert that to a BigInteger?</p>
      </div>

      <meta itemprop='headline' content='Multiple precision integers?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BobDole81.html'><span itemprop='name'>BobDole81</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-11-28T21:36:04Z'>
            <time itemprop='dateModified' datetime='2016-07-30T01:15:19Z' class='post-time'>
              July 30, 2016,  1:15am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I don’t think so…I think you’d need to read it as a string and then parse it yourself (unless you read each individual byte and parse).  I wouldn’t know the exact way to do it, as that description seems quite vague.  But if you know what integer is being sent, you can probably work backwards and figure out how its split up in the mpint packet, making it easier to reverse <img src="../../images/emoji/twitter/wink1bce.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>

      <meta itemprop='headline' content='Multiple precision integers?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/White_Castle.html'><span itemprop='name'>White_Castle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-11-28T21:49:49Z'>
            <time itemprop='dateModified' datetime='2016-07-30T01:15:22Z' class='post-time'>
              July 30, 2016,  1:15am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hmm, ok. I’ll have to think this one over, because there’s no header int to tell me where to read up to. Thanks for the help :).</p>
      </div>

      <meta itemprop='headline' content='Multiple precision integers?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BobDole81.html'><span itemprop='name'>BobDole81</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-11-28T22:39:43Z'>
            <time itemprop='dateModified' datetime='2016-07-30T01:15:26Z' class='post-time'>
              July 30, 2016,  1:15am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Just took a quick look for some java ssh libraries, and the JTA library looked pretty nice (it also has support to read mp-ints): <a href="http://javassh.org/space/start" rel="nofollow noopener">http://javassh.org/space/start</a></p>
<p>Have a better look though, there several (possibly better ones) out there <img src="../../images/emoji/twitter/wink1bce.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>

      <meta itemprop='headline' content='Multiple precision integers?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/White_Castle.html'><span itemprop='name'>White_Castle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-11-29T04:21:51Z'>
            <time itemprop='dateModified' datetime='2016-07-30T01:16:17Z' class='post-time'>
              July 30, 2016,  1:16am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I did find one other, but it was obfuscated. This has source, so I’ll look at it. :)[br][size=1]Posted at: November 28, 2006, 11:22:19 AM[/size][hr]That did work out, thanks alot BobDole81. <img src="../../images/emoji/twitter/smiley1bce.png?v=6" title=":smiley:" class="emoji" alt=":smiley:"></p>
      </div>

      <meta itemprop='headline' content='Multiple precision integers?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/multiple-precision-integers/30297 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 20:27:15 GMT -->
</html>
