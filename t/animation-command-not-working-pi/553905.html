<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/animation-command-not-working-pi/553905 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:07 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Animation command not working - PI - Runescape - moparisthebest.com</title>
    <meta name="description" content="Hello, I am having an issue with this entity based animation system. I&amp;#39;m pretty new to this. This Source uses a flag system.  Here&amp;#39;s the issue when I try to do any kind of animation nothing happens, it has nothing to do &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="553905.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Animation command not working - PI&#39;" href="553905.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/animation-command-not-working-pi/553905" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/animation-command-not-working-pi/553905" />
<meta property="og:title" content="Animation command not working - PI" />
<meta name="twitter:title" content="Animation command not working - PI" />
<meta property="og:description" content="Hello, I am having an issue with this entity based animation system. I’m pretty new to this. This Source uses a flag system.  Here’s the issue when I try to do any kind of animation nothing happens, it has nothing to do with the client because i’ve used other sources on it and they worked perfect. I will rep++ here are snippet of code, please ask if you require anything else. I’ve literally spent five + hours trying to fix this and I can’t. I’ve tried everything… this is the game with my GFX com..." />
<meta name="twitter:description" content="Hello, I am having an issue with this entity based animation system. I’m pretty new to this. This Source uses a flag system.  Here’s the issue when I try to do any kind of animation nothing happens, it has nothing to do with the client because i’ve used other sources on it and they worked perfect. I will rep++ here are snippet of code, please ask if you require anything else. I’ve literally spent five + hours trying to fix this and I can’t. I’ve tried everything… this is the game with my GFX com..." />
<meta property="article:published_time" content="2015-11-21T11:50:08+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="553905.html">Animation command not working - PI</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Frantix.html'><span itemprop='name'>Frantix</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-11-21T11:50:08Z'>
            <time itemprop='dateModified' datetime='2016-08-04T16:38:08Z' class='post-time'>
              August 4, 2016,  4:38pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hello, I am having an issue with this entity based animation system. I’m pretty new to this. This Source uses a flag system.  Here’s the issue when I try to do any kind of animation nothing happens, it has nothing to do with the client because i’ve used other sources on it and they worked perfect. I will rep++ here are snippet of code, please ask if you require anything else. I’ve literally spent five + hours trying to fix this and I can’t. I’ve tried everything… this is the game with my GFX command. I’m hoping someone has already encountered this issue when they tried using an entity based animation system. Thanks guys!</p>
<p><a href="http://www.rune-server.org/runescape-development/rs2-server/downloads/506628-project-insanity-clean-w-following-more.html" data-bbcode="true" rel="nofollow noopener">http://www.rune-server.org/runescape-development/rs2-server/downloads/506628-project-insanity-clean-w-following-more.html</a></p>
<p>Server\src\org\rs2\network\packets\impl\Commands.java</p>
<p><code>
} else if (playerCommand.startsWith("anim")) {
				String[] args = playerCommand.split(" ");
				c.startAnimation(Integer.parseInt(args[1]));
				PlayerAssistant.requestUpdates(c);
			}
</code></p>
<p>Server\src\org\rs2\entity\player\Player.java</p>
<p>[CODE]	/**<br>
*Animations<br>
**/<br>
public void startAnimation(int animId) {<br>
//if (wearing2h() &amp;&amp; animId == 829)<br>
//return;<br>
if((isDead() || playerLevel[3] &lt;= 0) &amp;&amp; animId != 0x900) {<br>
return;<br>
}<br>
animationRequest = animId;<br>
animationWaitCycles = 0;<br>
updateRequired = true;<br>
}</p>
<pre><code>public void startAnimation(int animId, int time) {
	animationRequest = animId;
	animationWaitCycles = time;
	updateRequired = true;
}

public void appendAnimationRequest(Stream str) {
	synchronized(this) {
		str.writeWordBigEndian((animationRequest==-1) ? 65535 : animationRequest);
		str.writeByteC(animationWaitCycles);
	}
}[/CODE]
</code></pre>
<p>Server\src\org\rs2\entity\player\PlayerAssistant.java</p>
<p><code>
	/**
	 * Request updates
	 */
	public static void requestUpdates(Player p) {
		p.updateRequired = true;
		p.getUpdateFlag().flag(Flag.APPEARANCE);
	}
</code></p>
<p>Side note, I just can’t understand how this even calls the animation. Please explain it to me, what i see is information just getting set to variables how does any kind of function get called to tell the character to do a animation.</p>
<p>[QUOTE]	public void startAnimation(int animId) {<br>
//if (wearing2h() &amp;&amp; animId == 829)<br>
//return;<br>
if((isDead() || playerLevel[3] &lt;= 0) &amp;&amp; animId != 0x900) {<br>
return;<br>
}<br>
animationRequest = animId;<br>
animationWaitCycles = 0;<br>
updateRequired = true;<br>
}[/QUOTE]</p>
      </div>

      <meta itemprop='headline' content='Animation command not working - PI'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sk8rdude461.html'><span itemprop='name'>sk8rdude461</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-11-21T17:42:14Z'>
            <time itemprop='dateModified' datetime='2016-08-04T16:38:08Z' class='post-time'>
              August 4, 2016,  4:38pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The reason why you don’t see anything “Handling the animation” is because the animation is actually handled in the client.</p>
<p>Most <span class="bbcode-i">visual</span> elements are going to be controlled by the client. So how does the client know to start an animation when the server says? Player Updating.</p>
<p>Take a look at your startAnimation method, you see the variable “animationRequest”?</p>
<p>That variable should be used in at least two more places. One being something like this:</p>
<p><code>
	public void appendAnimationRequest(Stream str) {
		str.writeWordBigEndian((animationRequest == -1) ? 65535 : animationRequest);
		str.writeByteC(animationWaitCycles);
	}</code><br>
(That’s the code that sends the animation data to the client).</p>
<p>And this:</p>
<p><code>
		if (animationRequest != -1) {
			appendAnimationRequest(str);
		}</code></p>
<p>The second one, the if statement, is found in Player Updating. It is essentially what you need to look for to make sure your server is actually sending the animation data to the client.</p>
      </div>

      <meta itemprop='headline' content='Animation command not working - PI'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/animation-command-not-working-pi/553905 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:07 GMT -->
</html>
