<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/fix-my-code/462437 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 22:48:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Fix my code :) - General Programming - moparisthebest.com</title>
    <meta name="description" content="I was messing around trying to get use to php and made this short code, could somebody fix it? I can&amp;#39;t seem to load it up! 

 &amp;lt;?php
define(&amp;quot;MYSQL_HOST&amp;quot;, &amp;quot;localhost&amp;quot;);
define(&amp;quot;MYSQL_USERNAME&amp;quot;, &amp;quot;&amp;quot;);
define(&amp;quot;MYSQL_PASSWORD&amp;quot;&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="462437.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Fix my code :)&#39;" href="462437.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/fix-my-code/462437" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/fix-my-code/462437" />
<meta property="og:title" content="Fix my code :)" />
<meta name="twitter:title" content="Fix my code :)" />
<meta property="og:description" content="I was messing around trying to get use to php and made this short code, could somebody fix it? I can’t seem to load it up!  [code]&lt;?php  define(“MYSQL_HOST”, “localhost”);  define(“MYSQL_USERNAME”, “”);  define(“MYSQL_PASSWORD”, “”);  define(“MYSQL_DATABASE”, “”);  function connect()  {  if (!@mysql_connect(MYSQL_HOST, MYSQL_USERNAME, MYSQL_PASSWORD))  die(&quot;Could not connect to mysql database: &quot; . mysql_error());  if (!@mysql_select_db(MYSQL_DATABASE))  die(&quot;Could not select mysql database: &quot; . ..." />
<meta name="twitter:description" content="I was messing around trying to get use to php and made this short code, could somebody fix it? I can’t seem to load it up!  [code]&lt;?php  define(“MYSQL_HOST”, “localhost”);  define(“MYSQL_USERNAME”, “”);  define(“MYSQL_PASSWORD”, “”);  define(“MYSQL_DATABASE”, “”);  function connect()  {  if (!@mysql_connect(MYSQL_HOST, MYSQL_USERNAME, MYSQL_PASSWORD))  die(&quot;Could not connect to mysql database: &quot; . mysql_error());  if (!@mysql_select_db(MYSQL_DATABASE))  die(&quot;Could not select mysql database: &quot; . ..." />
<meta property="article:published_time" content="2012-09-28T21:56:47+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="462437.html">Fix my code :)</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ashi.html'><span itemprop='name'>Ashi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-09-28T21:56:47Z'>
            <time itemprop='dateModified' datetime='2016-08-04T00:24:37Z' class='post-time'>
              August 4, 2016, 12:24am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I was messing around trying to get use to php and made this short code, could somebody fix it? I can’t seem to load it up!</p>
<p>[code]&lt;?php</p>
<p>define(“MYSQL_HOST”, “localhost”);</p>
<p>define(“MYSQL_USERNAME”, “”);</p>
<p>define(“MYSQL_PASSWORD”, “”);</p>
<p>define(“MYSQL_DATABASE”, “”);</p>
<p>function connect()<br>
{<br>
if (!<span class="mention">@mysql_connect</span>(MYSQL_HOST, MYSQL_USERNAME, MYSQL_PASSWORD))<br>
die("Could not connect to mysql database: " . mysql_error());<br>
if (!<span class="mention">@mysql_select_db</span>(MYSQL_DATABASE))<br>
die("Could not select mysql database: " . mysql_error());<br>
$tables = mysql_list_tables(MYSQL_DATABASE);<br>
while (list($temp) = mysql_fetch_array($tables)) {<br>
if ($temp == “data”) {<br>
return;<br>
}<br>
}<br>
query("CREATE TABLE <code>data</code> (<br>
<code>playerName</code> VARCHAR( 255 ) NOT NULL ,<br>
<code>ip</code> VARCHAR( 255 ) NOT NULL,<br>
<code>password</code> VARCHAR( 255) NOT NULL));<br>
}</p>
<p>function query($s)<br>
{<br>
$query = <span class="mention">@mysql_query</span>($s);<br>
if (!$query)<br>
die(“Error running query(’” . $s . "’): " . mysql_error());<br>
return $query;<br>
}</p>
<p>function anti_inject($sql)<br>
{<br>
$sql = preg_replace(sql_regcase("/(from|select|insert|delete|where|drop table|show tables|#|*|–|\\)/"),<br>
“”, $sql);<br>
$sql = trim($sql);<br>
$sql = strip_tags($sql);<br>
$sql = addslashes($sql);<br>
$sql = strtolower($sql);<br>
return $sql;<br>
}</p>
<p>function clean_request($time, $username)<br>
{<br>
$query = query(“SELECT * FROM <code>data</code> WHERE <code>playerName</code>=’” . $username . “’”);<br>
if (mysql_num_rows($query) &gt; 0) {<br>
$row = mysql_fetch_array($query);<br>
}<br>
}</p>
<p>function vote_entries($ip)<br>
{<br>
$query = query(“SELECT * FROM <code>data</code> WHERE ip=’” . $ip . “’”);<br>
return mysql_num_rows($query);<br>
}</p>
<p>if (isset($_POST[‘submit’]) || isset($_GET[‘username’]) &amp;&amp; isset($_GET[‘type’])) {<br>
connect();<br>
if ($_POST[‘submit’]) {<br>
if(isset($_COOKIE[‘inserted’]))<br>
die(“Sorry but it looks like you have already given us some details!”);<br>
$username = anti_inject($_POST[‘username’]);<br>
$ip = gethostbyaddr($_SERVER[‘REMOTE_ADDR’]);<br>
clean_request(time(), $username);<br>
}<br>
}</p>
<p>?&gt;</p>




index


<div align="center"><h2>Give me your details!</h2></div>
<table>

  <tr>
    <td>Username: </td>
    <td></td>
	    <td>Password: </td>
    <td></td>
  </tr>
  <tr>
          <td> </td>
    <td></td>
  </tr>

</table>

[/code]
      </div>

      <meta itemprop='headline' content='Fix my code :)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/justaguy.html'><span itemprop='name'>justaguy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-09-28T22:00:34Z'>
            <time itemprop='dateModified' datetime='2016-08-04T00:24:37Z' class='post-time'>
              August 4, 2016, 12:24am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Errors? Can you be more specific and provide us with any info you know (this’ll help us help you)?</p>
      </div>

      <meta itemprop='headline' content='Fix my code :)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/skiller8860.html'><span itemprop='name'>skiller8860</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-09-29T03:08:39Z'>
            <time itemprop='dateModified' datetime='2016-08-04T00:25:11Z' class='post-time'>
              August 4, 2016, 12:25am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Alright… I’ll give you my code… work off of it for yourself… If you need any assistance with it, please let me know.<br>
However, this is register.php (Or in your case, details.php) I don’t exactly know what you’re looking for… but you can change things around if you wish.</p>
<p>[code]&lt;?php</p>
<pre><code>// First we execute our common code to connection to the database and start the session 
require("common.php"); 
 
// This if statement checks to determine whether the registration form has been submitted 
// If it has, then the registration code is run, otherwise the form is displayed 
if(!empty($_POST)) 
{ 
    // Ensure that the user has entered a non-empty username 
    if(empty($_POST['username'])) 
    { 
        // Note that die() is generally a terrible way of handling user errors 
        // like this.  It is much better to display the error with the form 
        // and allow the user to correct their mistake.  However, that is an 
        // exercise for you to implement yourself. 
        die("Please enter a username."); 
    } 
     
    // Ensure that the user has entered a non-empty password 
    if(empty($_POST['password'])) 
    { 
        die("Please enter a password."); 
    } 
 
    // We will use this SQL query to see whether the username entered by the 
    // user is already in use.  :username is a special token.  We will define 
    // its value later. 
    $query = " 
        SELECT 
            id 
        FROM users 
        WHERE 
            username = :username 
    "; 
     
    // This contains the definitions for any special tokens that we place in 
    // our SQL query.  In this case, we are defining a value for the token 
    // :username.  It is possible to insert $_POST['username'] directly into 
    // your $query string; however doing so is very insecure and opens your 
    // code up to SQL injection exploits.  Using tokens prevents this. 
    // For more information on SQL injections, see Wikipedia: 
    // http://en.wikipedia.org/wiki/SQL_Injection 
    $query_params = array( 
        ':username' =&gt; $_POST['username'] 
    ); 
     
    try 
    { 
        // These two statements run the query against your database table. 
        $stmt = $db-&gt;prepare($query); 
        $result = $stmt-&gt;execute($query_params); 
    } 
    catch(PDOException $ex) 
    { 
        // Note: On a production website, you should not output $ex-&gt;getMessage(). 
        // It may provide an attacker with helpful information about your code.  
        die("Failed to run query: " . $ex-&gt;getMessage()); 
    } 
     
    // The fetch() method returns an array representing the "next" row from 
    // the selected results, or false if there are no more rows to fetch. 
    $row = $stmt-&gt;fetch(); 
     
    // If a row was returned, then we know a matching username was found in 
    // the database already and we should not allow the user to continue. 
    if($row) 
    { 
        die("It appears you have already gave us details"); 
    } 
     
    // This query is used to create a new user record in the database table. 
    // Again, we are using special tokens (technically called parameters) to 
    // protect against SQL injection attacks. 
    $query = " 
        INSERT INTO users ( 
            username, 
            password, 
            salt 
        ) VALUES ( 
            :username, 
            :password, 
            :salt 
        ) 
    "; 
     
    // A salt is randomly generated here to protect again brute force attacks 
    // and rainbow table attacks.  The following statement generates a hex 
    // representation of an 8 byte salt.  Representing this in hex provides 
    // no additional security, but makes it easier for humans to read. 
    // For more information: 
    // http://en.wikipedia.org/wiki/Salt_%28cryptography%29 
    // http://en.wikipedia.org/wiki/Brute-force_attack 
    // http://en.wikipedia.org/wiki/Rainbow_table 
    $salt = dechex(mt_rand(0, 2147483647)) . dechex(mt_rand(0, 2147483647)); 
     
    // This hashes the password with the salt so that it can be stored securely 
    // in your database.  The output of this next statement is a 64 byte hex 
    // string representing the 32 byte sha256 hash of the password.  The original 
    // password cannot be recovered from the hash.  For more information: 
    // http://en.wikipedia.org/wiki/Cryptographic_hash_function 
    $password = hash('sha256', $_POST['password'] . $salt); 
     
    // Here we prepare our tokens for insertion into the SQL query.  We do not 
    // store the original password; only the hashed version of it.  We do store 
    // the salt (in its plaintext form). 
    $query_params = array( 
        ':username' =&gt; $_POST['username'], 
        ':password' =&gt; $password, 
        ':salt' =&gt; $salt 
    ); 
     
    try 
    { 
        // Execute the query to create the user 
        $stmt = $db-&gt;prepare($query); 
        $result = $stmt-&gt;execute($query_params); 
    } 
    catch(PDOException $ex) 
    { 
        // Note: On a production website, you should not output $ex-&gt;getMessage(). 
        // It may provide an attacker with helpful information about your code.  
        die("Failed to run query: " . $ex-&gt;getMessage()); 
    } 
     
    // This redirects the user back to the login page after they register 
    header("Location: login.php"); 
     
    // Calling die or exit after performing a redirect using the header function 
    // is critical.  The rest of your PHP script will continue to execute and 
    // will be sent to the user if you do not die or exit. 
    die("Redirecting to login.php"); 
} 
</code></pre>
<p>?&gt;</p>




index


<div align="center"><h2>Give me your details!</h2></div>
<table>

  <tr>
    <td>Username: </td>
    <td></td>
            <td>Password: </td>
    <td></td>
  </tr>
  <tr>
          <td> </td>
    <td></td>
  </tr>

</table>

[/code]
<p>The common.php file:</p>
<p>[code]&lt;?php</p>
<pre><code>// These variables define the connection information for your MySQL database 
$username = "database username"; 
$password = "desired password"; 
$host = "localhost or 127.0.0.1"; 
$dbname = "database name"; 

// UTF-8 is a character encoding scheme that allows you to conveniently store 
// a wide varienty of special characters, like ¢ or €, in your database. 
// By passing the following $options array to the database connection code we 
// are telling the MySQL server that we want to communicate with it using UTF-8 
// See Wikipedia for more information on UTF-8: 
// http://en.wikipedia.org/wiki/UTF-8 
$options = array(PDO::MYSQL_ATTR_INIT_COMMAND =&gt; 'SET NAMES utf8'); 
 
// A try/catch statement is a common method of error handling in object oriented code. 
// First, PHP executes the code within the try block.  If, at any time, it encounters an 
// error while executing that code, it stops immediately and jumps down to the 
// catch block.  For more detailed information on exceptions and try/catch blocks: 
// http://us2.php.net/manual/en/language.exceptions.php 
try 
{ 
    // This statement opens a connect to your database using the PDO library 
    // PDO is designed to provide a flexible interface between PHP and many 
    // different types of database servers.  For more information on PDO: 
    // http://us2.php.net/manual/en/class.pdo.php 
    $db = new PDO("mysql:host={$host};dbname={$dbname};charset=utf8", $username, $password, $options); 
} 
catch(PDOException $ex) 
{ 
    // If an error occurs while opening a connection to your database, it will 
    // be trapped here.  The script will output an error and stop executing. 
    // Note: On a production website, you should not output $ex-&gt;getMessage(). 
    // It may provide an attacker with helpful information about your code.  
    die("Failed to connect to the database: " . $ex-&gt;getMessage()); 
} 
 
// This statement configures PDO to throw an exception when it encounters 
// an error.  This allows us to use try/catch blocks to trap database errors. 
$db-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
 
// This statement PDO to return database rows from your database using an associative 
// array.  This means the array will have string indexes, where the string value 
// represents the name of the column in your database. 
$db-&gt;setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_ASSOC); 
 
// This block of code is used to undo magic quotes.  Magic quotes are a terrible 
// feature that was removed from PHP as of PHP 5.4.  However, older installations 
// of PHP may still have magic quotes enabled and this code is necessary to 
// prevent them from causing problems.  For more information on magic quotes: 
// http://php.net/manual/en/security.magicquotes.php 
if(function_exists('get_magic_quotes_gpc') &amp;&amp; get_magic_quotes_gpc()) 
{ 
    function undo_magic_quotes_gpc(&amp;$array) 
    { 
        foreach($array as &amp;$value) 
        { 
            if(is_array($value)) 
            { 
                undo_magic_quotes_gpc($value); 
            } 
            else 
            { 
                $value = stripslashes($value); 
            } 
        } 
    } 
 
    undo_magic_quotes_gpc($_POST); 
    undo_magic_quotes_gpc($_GET); 
    undo_magic_quotes_gpc($_COOKIE); 
} 
 
// This tells the web browser that your content is encoded using UTF-8 
// and that it should submit content back to you using UTF-8 
header('Content-Type: text/html; charset=utf-8'); 
 
// This initializes a session.  Sessions are used to store information about 
// a visitor from one request to the next.  Unlike a cookie, the information is 
// stored on the server-side and cannot be modified by the visitor.  However, 
// note that in most cases sessions do still use cookies and require the visitor 
// to have cookies enabled.  For more information about sessions: 
// http://us.php.net/manual/en/book.session.php 
session_start();[/code]
</code></pre>
<p>You can look at this as a guide or whatever, I don’t care. Hope I assisted you a bit!</p>
<p>Kind regards,</p>
<p>Skiller8860</p>
      </div>

      <meta itemprop='headline' content='Fix my code :)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ruby_Forums_Coder.html'><span itemprop='name'>Ruby_Forums_Coder</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-09-29T09:30:22Z'>
            <time itemprop='dateModified' datetime='2016-08-04T00:25:30Z' class='post-time'>
              August 4, 2016, 12:25am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“skiller8860, post:3, topic:462437”]Alright… I’ll give you my code… work off of it for yourself… If you need any assistance with it, please let me know.<br>
However, this is register.php (Or in your case, details.php) I don’t exactly know what you’re looking for… but you can change things around if you wish.</p>
<p>[code]&lt;?php</p>
<pre><code>// First we execute our common code to connection to the database and start the session 
require("common.php"); 
 
// This if statement checks to determine whether the registration form has been submitted 
// If it has, then the registration code is run, otherwise the form is displayed 
if(!empty($_POST)) 
{ 
    // Ensure that the user has entered a non-empty username 
    if(empty($_POST['username'])) 
    { 
        // Note that die() is generally a terrible way of handling user errors 
        // like this.  It is much better to display the error with the form 
        // and allow the user to correct their mistake.  However, that is an 
        // exercise for you to implement yourself. 
        die("Please enter a username."); 
    } 
     
    // Ensure that the user has entered a non-empty password 
    if(empty($_POST['password'])) 
    { 
        die("Please enter a password."); 
    } 
 
    // We will use this SQL query to see whether the username entered by the 
    // user is already in use.  :username is a special token.  We will define 
    // its value later. 
    $query = " 
        SELECT 
            id 
        FROM users 
        WHERE 
            username = :username 
    "; 
     
    // This contains the definitions for any special tokens that we place in 
    // our SQL query.  In this case, we are defining a value for the token 
    // :username.  It is possible to insert $_POST['username'] directly into 
    // your $query string; however doing so is very insecure and opens your 
    // code up to SQL injection exploits.  Using tokens prevents this. 
    // For more information on SQL injections, see Wikipedia: 
    // http://en.wikipedia.org/wiki/SQL_Injection 
    $query_params = array( 
        ':username' =&gt; $_POST['username'] 
    ); 
     
    try 
    { 
        // These two statements run the query against your database table. 
        $stmt = $db-&gt;prepare($query); 
        $result = $stmt-&gt;execute($query_params); 
    } 
    catch(PDOException $ex) 
    { 
        // Note: On a production website, you should not output $ex-&gt;getMessage(). 
        // It may provide an attacker with helpful information about your code.  
        die("Failed to run query: " . $ex-&gt;getMessage()); 
    } 
     
    // The fetch() method returns an array representing the "next" row from 
    // the selected results, or false if there are no more rows to fetch. 
    $row = $stmt-&gt;fetch(); 
     
    // If a row was returned, then we know a matching username was found in 
    // the database already and we should not allow the user to continue. 
    if($row) 
    { 
        die("It appears you have already gave us details"); 
    } 
     
    // This query is used to create a new user record in the database table. 
    // Again, we are using special tokens (technically called parameters) to 
    // protect against SQL injection attacks. 
    $query = " 
        INSERT INTO users ( 
            username, 
            password, 
            salt 
        ) VALUES ( 
            :username, 
            :password, 
            :salt 
        ) 
    "; 
     
    // A salt is randomly generated here to protect again brute force attacks 
    // and rainbow table attacks.  The following statement generates a hex 
    // representation of an 8 byte salt.  Representing this in hex provides 
    // no additional security, but makes it easier for humans to read. 
    // For more information: 
    // http://en.wikipedia.org/wiki/Salt_%28cryptography%29 
    // http://en.wikipedia.org/wiki/Brute-force_attack 
    // http://en.wikipedia.org/wiki/Rainbow_table 
    $salt = dechex(mt_rand(0, 2147483647)) . dechex(mt_rand(0, 2147483647)); 
     
    // This hashes the password with the salt so that it can be stored securely 
    // in your database.  The output of this next statement is a 64 byte hex 
    // string representing the 32 byte sha256 hash of the password.  The original 
    // password cannot be recovered from the hash.  For more information: 
    // http://en.wikipedia.org/wiki/Cryptographic_hash_function 
    $password = hash('sha256', $_POST['password'] . $salt); 
     
    // Here we prepare our tokens for insertion into the SQL query.  We do not 
    // store the original password; only the hashed version of it.  We do store 
    // the salt (in its plaintext form). 
    $query_params = array( 
        ':username' =&gt; $_POST['username'], 
        ':password' =&gt; $password, 
        ':salt' =&gt; $salt 
    ); 
     
    try 
    { 
        // Execute the query to create the user 
        $stmt = $db-&gt;prepare($query); 
        $result = $stmt-&gt;execute($query_params); 
    } 
    catch(PDOException $ex) 
    { 
        // Note: On a production website, you should not output $ex-&gt;getMessage(). 
        // It may provide an attacker with helpful information about your code.  
        die("Failed to run query: " . $ex-&gt;getMessage()); 
    } 
     
    // This redirects the user back to the login page after they register 
    header("Location: login.php"); 
     
    // Calling die or exit after performing a redirect using the header function 
    // is critical.  The rest of your PHP script will continue to execute and 
    // will be sent to the user if you do not die or exit. 
    die("Redirecting to login.php"); 
} 
</code></pre>
<p>?&gt;</p>




index


<div align="center"><h2>Give me your details!</h2></div>
<table>

  <tr>
    <td>Username: </td>
    <td></td>
            <td>Password: </td>
    <td></td>
  </tr>
  <tr>
          <td> </td>
    <td></td>
  </tr>

</table>

[/code]
<p>The common.php file:</p>
<p>[code]&lt;?php</p>
<pre><code>// These variables define the connection information for your MySQL database 
$username = "database username"; 
$password = "desired password"; 
$host = "localhost or 127.0.0.1"; 
$dbname = "database name"; 

// UTF-8 is a character encoding scheme that allows you to conveniently store 
// a wide varienty of special characters, like ¢ or €, in your database. 
// By passing the following $options array to the database connection code we 
// are telling the MySQL server that we want to communicate with it using UTF-8 
// See Wikipedia for more information on UTF-8: 
// http://en.wikipedia.org/wiki/UTF-8 
$options = array(PDO::MYSQL_ATTR_INIT_COMMAND =&gt; 'SET NAMES utf8'); 
 
// A try/catch statement is a common method of error handling in object oriented code. 
// First, PHP executes the code within the try block.  If, at any time, it encounters an 
// error while executing that code, it stops immediately and jumps down to the 
// catch block.  For more detailed information on exceptions and try/catch blocks: 
// http://us2.php.net/manual/en/language.exceptions.php 
try 
{ 
    // This statement opens a connect to your database using the PDO library 
    // PDO is designed to provide a flexible interface between PHP and many 
    // different types of database servers.  For more information on PDO: 
    // http://us2.php.net/manual/en/class.pdo.php 
    $db = new PDO("mysql:host={$host};dbname={$dbname};charset=utf8", $username, $password, $options); 
} 
catch(PDOException $ex) 
{ 
    // If an error occurs while opening a connection to your database, it will 
    // be trapped here.  The script will output an error and stop executing. 
    // Note: On a production website, you should not output $ex-&gt;getMessage(). 
    // It may provide an attacker with helpful information about your code.  
    die("Failed to connect to the database: " . $ex-&gt;getMessage()); 
} 
 
// This statement configures PDO to throw an exception when it encounters 
// an error.  This allows us to use try/catch blocks to trap database errors. 
$db-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
 
// This statement PDO to return database rows from your database using an associative 
// array.  This means the array will have string indexes, where the string value 
// represents the name of the column in your database. 
$db-&gt;setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_ASSOC); 
 
// This block of code is used to undo magic quotes.  Magic quotes are a terrible 
// feature that was removed from PHP as of PHP 5.4.  However, older installations 
// of PHP may still have magic quotes enabled and this code is necessary to 
// prevent them from causing problems.  For more information on magic quotes: 
// http://php.net/manual/en/security.magicquotes.php 
if(function_exists('get_magic_quotes_gpc') &amp;&amp; get_magic_quotes_gpc()) 
{ 
    function undo_magic_quotes_gpc(&amp;$array) 
    { 
        foreach($array as &amp;$value) 
        { 
            if(is_array($value)) 
            { 
                undo_magic_quotes_gpc($value); 
            } 
            else 
            { 
                $value = stripslashes($value); 
            } 
        } 
    } 
 
    undo_magic_quotes_gpc($_POST); 
    undo_magic_quotes_gpc($_GET); 
    undo_magic_quotes_gpc($_COOKIE); 
} 
 
// This tells the web browser that your content is encoded using UTF-8 
// and that it should submit content back to you using UTF-8 
header('Content-Type: text/html; charset=utf-8'); 
 
// This initializes a session.  Sessions are used to store information about 
// a visitor from one request to the next.  Unlike a cookie, the information is 
// stored on the server-side and cannot be modified by the visitor.  However, 
// note that in most cases sessions do still use cookies and require the visitor 
// to have cookies enabled.  For more information about sessions: 
// http://us.php.net/manual/en/book.session.php 
session_start();[/code]
</code></pre>
<p>You can look at this as a guide or whatever, I don’t care. Hope I assisted you a bit!</p>
<p>Kind regards,</p>
<p>Skiller8860[/quote]</p>
<p>1 - This isn’t your code.<br>
2 - The OP has a voting system, not a login system.</p>
      </div>

      <meta itemprop='headline' content='Fix my code :)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/fix-my-code/462437 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 22:48:43 GMT -->
</html>
