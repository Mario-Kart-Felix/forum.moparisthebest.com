<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Fix my code :)</title>
    <link>https://forum.moparisthebest.com/t/fix-my-code/462437</link>
    <description>I was messing around trying to get use to php and made this short code, could somebody fix it? I can&#39;t seem to load it up!

[code]&lt;?php

define(&quot;MYSQL_HOST&quot;, &quot;localhost&quot;);

define(&quot;MYSQL_USERNAME&quot;, &quot;&quot;);

define(&quot;MYSQL_PASSWORD&quot;, &quot;&quot;);

define(&quot;MYSQL_DATABASE&quot;, &quot;&quot;);

function connect()
{
    if (!@mysql_connect(MYSQL_HOST, MYSQL_USERNAME, MYSQL_PASSWORD))
        die(&quot;Could not connect to mysql database: &quot; . mysql_error());
    if (!@mysql_select_db(MYSQL_DATABASE))
        die(&quot;Could not select mysql database: &quot; . mysql_error());
    $tables = mysql_list_tables(MYSQL_DATABASE);
    while (list($temp) = mysql_fetch_array($tables)) {
        if ($temp == &quot;data&quot;) {
            return;
        }
    }
    query(&quot;CREATE TABLE `data` (
        `playerName` VARCHAR( 255 ) NOT NULL ,
        `ip` VARCHAR( 255 ) NOT NULL,
        `password` VARCHAR( 255) NOT NULL));
}

function query($s)
{
    $query = @mysql_query($s);
    if (!$query)
        die(&quot;Error running query(&#39;&quot; . $s . &quot;&#39;): &quot; . mysql_error());
    return $query;
}

function anti_inject($sql)
{
    $sql = preg_replace(sql_regcase(&quot;/(from|select|insert|delete|where|drop table|show tables|#|\*|--|\\\\)/&quot;),
        &quot;&quot;, $sql);
    $sql = trim($sql);
    $sql = strip_tags($sql);
    $sql = addslashes($sql);
    $sql = strtolower($sql);
    return $sql;
}

function clean_request($time, $username)
{
    $query = query(&quot;SELECT * FROM `data` WHERE `playerName`=&#39;&quot; . $username . &quot;&#39;&quot;);
    if (mysql_num_rows($query) &gt; 0) {
        $row = mysql_fetch_array($query);
    }
}

function vote_entries($ip)
{
    $query = query(&quot;SELECT * FROM `data` WHERE ip=&#39;&quot; . $ip . &quot;&#39;&quot;);
    return mysql_num_rows($query);
}

if (isset($_POST[&#39;submit&#39;]) || isset($_GET[&#39;username&#39;]) &amp;&amp; isset($_GET[&#39;type&#39;])) {
    connect();
    if ($_POST[&#39;submit&#39;]) {
        if(isset($_COOKIE[&#39;inserted&#39;]))
            die(&quot;Sorry but it looks like you have already given us some details!&quot;);
        $username = anti_inject($_POST[&#39;username&#39;]);
        $ip = gethostbyaddr($_SERVER[&#39;REMOTE_ADDR&#39;]);
        clean_request(time(), $username);
        }
}

?&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;title&gt;index&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div align=&quot;center&quot;&gt;&lt;h2&gt;Give me your details!&lt;/h3&gt;&lt;/div&gt;
&lt;table align=&quot;center&quot;&gt;

&lt;form action=&quot;details.php&quot; method=&quot;post&quot;&gt;
  &lt;tr&gt;
    &lt;td align=&quot;right&quot;&gt;Username: &lt;/td&gt;
    &lt;td&gt;&lt;input name=&quot;username&quot; type=&quot;text&quot; /&gt;&lt;/td&gt;
	    &lt;td align=&quot;right&quot;&gt;Password: &lt;/td&gt;
    &lt;td&gt;&lt;input name=&quot;username&quot; type=&quot;password&quot; /&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
          &lt;td&gt;&amp;nbsp;&lt;/td&gt;
    &lt;td align=&quot;center&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;submit&quot; /&gt;&lt;/td&gt;
  &lt;/tr&gt;

&lt;/form&gt;
&lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;[/code]</description>
    
    <lastBuildDate>Sat, 29 Sep 2012 09:30:22 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/fix-my-code/462437.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Fix my code :)</title>
        <dc:creator><![CDATA[@Ruby_Forums_Coder Ruby]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ruby_forums_coder">@Ruby_Forums_Coder</a> wrote:</p>
          <blockquote>
              <p>[quote=“skiller8860, post:3, topic:462437”]Alright… I’ll give you my code… work off of it for yourself… If you need any assistance with it, please let me know.<br>
However, this is register.php (Or in your case, details.php) I don’t exactly know what you’re looking for… but you can change things around if you wish.</p>
<p>[code]&lt;?php</p>
<pre><code>// First we execute our common code to connection to the database and start the session 
require("common.php"); 
 
// This if statement checks to determine whether the registration form has been submitted 
// If it has, then the registration code is run, otherwise the form is displayed 
if(!empty($_POST)) 
{ 
    // Ensure that the user has entered a non-empty username 
    if(empty($_POST['username'])) 
    { 
        // Note that die() is generally a terrible way of handling user errors 
        // like this.  It is much better to display the error with the form 
        // and allow the user to correct their mistake.  However, that is an 
        // exercise for you to implement yourself. 
        die("Please enter a username."); 
    } 
     
    // Ensure that the user has entered a non-empty password 
    if(empty($_POST['password'])) 
    { 
        die("Please enter a password."); 
    } 
 
    // We will use this SQL query to see whether the username entered by the 
    // user is already in use.  :username is a special token.  We will define 
    // its value later. 
    $query = " 
        SELECT 
            id 
        FROM users 
        WHERE 
            username = :username 
    "; 
     
    // This contains the definitions for any special tokens that we place in 
    // our SQL query.  In this case, we are defining a value for the token 
    // :username.  It is possible to insert $_POST['username'] directly into 
    // your $query string; however doing so is very insecure and opens your 
    // code up to SQL injection exploits.  Using tokens prevents this. 
    // For more information on SQL injections, see Wikipedia: 
    // http://en.wikipedia.org/wiki/SQL_Injection 
    $query_params = array( 
        ':username' =&gt; $_POST['username'] 
    ); 
     
    try 
    { 
        // These two statements run the query against your database table. 
        $stmt = $db-&gt;prepare($query); 
        $result = $stmt-&gt;execute($query_params); 
    } 
    catch(PDOException $ex) 
    { 
        // Note: On a production website, you should not output $ex-&gt;getMessage(). 
        // It may provide an attacker with helpful information about your code.  
        die("Failed to run query: " . $ex-&gt;getMessage()); 
    } 
     
    // The fetch() method returns an array representing the "next" row from 
    // the selected results, or false if there are no more rows to fetch. 
    $row = $stmt-&gt;fetch(); 
     
    // If a row was returned, then we know a matching username was found in 
    // the database already and we should not allow the user to continue. 
    if($row) 
    { 
        die("It appears you have already gave us details"); 
    } 
     
    // This query is used to create a new user record in the database table. 
    // Again, we are using special tokens (technically called parameters) to 
    // protect against SQL injection attacks. 
    $query = " 
        INSERT INTO users ( 
            username, 
            password, 
            salt 
        ) VALUES ( 
            :username, 
            :password, 
            :salt 
        ) 
    "; 
     
    // A salt is randomly generated here to protect again brute force attacks 
    // and rainbow table attacks.  The following statement generates a hex 
    // representation of an 8 byte salt.  Representing this in hex provides 
    // no additional security, but makes it easier for humans to read. 
    // For more information: 
    // http://en.wikipedia.org/wiki/Salt_%28cryptography%29 
    // http://en.wikipedia.org/wiki/Brute-force_attack 
    // http://en.wikipedia.org/wiki/Rainbow_table 
    $salt = dechex(mt_rand(0, 2147483647)) . dechex(mt_rand(0, 2147483647)); 
     
    // This hashes the password with the salt so that it can be stored securely 
    // in your database.  The output of this next statement is a 64 byte hex 
    // string representing the 32 byte sha256 hash of the password.  The original 
    // password cannot be recovered from the hash.  For more information: 
    // http://en.wikipedia.org/wiki/Cryptographic_hash_function 
    $password = hash('sha256', $_POST['password'] . $salt); 
     
    // Here we prepare our tokens for insertion into the SQL query.  We do not 
    // store the original password; only the hashed version of it.  We do store 
    // the salt (in its plaintext form). 
    $query_params = array( 
        ':username' =&gt; $_POST['username'], 
        ':password' =&gt; $password, 
        ':salt' =&gt; $salt 
    ); 
     
    try 
    { 
        // Execute the query to create the user 
        $stmt = $db-&gt;prepare($query); 
        $result = $stmt-&gt;execute($query_params); 
    } 
    catch(PDOException $ex) 
    { 
        // Note: On a production website, you should not output $ex-&gt;getMessage(). 
        // It may provide an attacker with helpful information about your code.  
        die("Failed to run query: " . $ex-&gt;getMessage()); 
    } 
     
    // This redirects the user back to the login page after they register 
    header("Location: login.php"); 
     
    // Calling die or exit after performing a redirect using the header function 
    // is critical.  The rest of your PHP script will continue to execute and 
    // will be sent to the user if you do not die or exit. 
    die("Redirecting to login.php"); 
} 
</code></pre>
<p>?&gt;</p>




index


<div align="center"><h2>Give me your details!</h2></div>
<table>

  <tr>
    <td>Username: </td>
    <td></td>
            <td>Password: </td>
    <td></td>
  </tr>
  <tr>
          <td> </td>
    <td></td>
  </tr>

</table>

[/code]
<p>The common.php file:</p>
<p>[code]&lt;?php</p>
<pre><code>// These variables define the connection information for your MySQL database 
$username = "database username"; 
$password = "desired password"; 
$host = "localhost or 127.0.0.1"; 
$dbname = "database name"; 

// UTF-8 is a character encoding scheme that allows you to conveniently store 
// a wide varienty of special characters, like ¢ or €, in your database. 
// By passing the following $options array to the database connection code we 
// are telling the MySQL server that we want to communicate with it using UTF-8 
// See Wikipedia for more information on UTF-8: 
// http://en.wikipedia.org/wiki/UTF-8 
$options = array(PDO::MYSQL_ATTR_INIT_COMMAND =&gt; 'SET NAMES utf8'); 
 
// A try/catch statement is a common method of error handling in object oriented code. 
// First, PHP executes the code within the try block.  If, at any time, it encounters an 
// error while executing that code, it stops immediately and jumps down to the 
// catch block.  For more detailed information on exceptions and try/catch blocks: 
// http://us2.php.net/manual/en/language.exceptions.php 
try 
{ 
    // This statement opens a connect to your database using the PDO library 
    // PDO is designed to provide a flexible interface between PHP and many 
    // different types of database servers.  For more information on PDO: 
    // http://us2.php.net/manual/en/class.pdo.php 
    $db = new PDO("mysql:host={$host};dbname={$dbname};charset=utf8", $username, $password, $options); 
} 
catch(PDOException $ex) 
{ 
    // If an error occurs while opening a connection to your database, it will 
    // be trapped here.  The script will output an error and stop executing. 
    // Note: On a production website, you should not output $ex-&gt;getMessage(). 
    // It may provide an attacker with helpful information about your code.  
    die("Failed to connect to the database: " . $ex-&gt;getMessage()); 
} 
 
// This statement configures PDO to throw an exception when it encounters 
// an error.  This allows us to use try/catch blocks to trap database errors. 
$db-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
 
// This statement PDO to return database rows from your database using an associative 
// array.  This means the array will have string indexes, where the string value 
// represents the name of the column in your database. 
$db-&gt;setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_ASSOC); 
 
// This block of code is used to undo magic quotes.  Magic quotes are a terrible 
// feature that was removed from PHP as of PHP 5.4.  However, older installations 
// of PHP may still have magic quotes enabled and this code is necessary to 
// prevent them from causing problems.  For more information on magic quotes: 
// http://php.net/manual/en/security.magicquotes.php 
if(function_exists('get_magic_quotes_gpc') &amp;&amp; get_magic_quotes_gpc()) 
{ 
    function undo_magic_quotes_gpc(&amp;$array) 
    { 
        foreach($array as &amp;$value) 
        { 
            if(is_array($value)) 
            { 
                undo_magic_quotes_gpc($value); 
            } 
            else 
            { 
                $value = stripslashes($value); 
            } 
        } 
    } 
 
    undo_magic_quotes_gpc($_POST); 
    undo_magic_quotes_gpc($_GET); 
    undo_magic_quotes_gpc($_COOKIE); 
} 
 
// This tells the web browser that your content is encoded using UTF-8 
// and that it should submit content back to you using UTF-8 
header('Content-Type: text/html; charset=utf-8'); 
 
// This initializes a session.  Sessions are used to store information about 
// a visitor from one request to the next.  Unlike a cookie, the information is 
// stored on the server-side and cannot be modified by the visitor.  However, 
// note that in most cases sessions do still use cookies and require the visitor 
// to have cookies enabled.  For more information about sessions: 
// http://us.php.net/manual/en/book.session.php 
session_start();[/code]
</code></pre>
<p>You can look at this as a guide or whatever, I don’t care. Hope I assisted you a bit!</p>
<p>Kind regards,</p>
<p>Skiller8860[/quote]</p>
<p>1 - This isn’t your code.<br>
2 - The OP has a voting system, not a login system.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/fix-my-code/462437/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/fix-my-code/462437/4</link>
        <pubDate>Sat, 29 Sep 2012 09:30:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-462437-4</guid>
        <source url="https://forum.moparisthebest.com/t/fix-my-code/462437.rss">Fix my code :)</source>
      </item>
      <item>
        <title>Fix my code :)</title>
        <dc:creator><![CDATA[@skiller8860 skiller8860]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/skiller8860">@skiller8860</a> wrote:</p>
          <blockquote>
              <p>Alright… I’ll give you my code… work off of it for yourself… If you need any assistance with it, please let me know.<br>
However, this is register.php (Or in your case, details.php) I don’t exactly know what you’re looking for… but you can change things around if you wish.</p>
<p>[code]&lt;?php</p>
<pre><code>// First we execute our common code to connection to the database and start the session 
require("common.php"); 
 
// This if statement checks to determine whether the registration form has been submitted 
// If it has, then the registration code is run, otherwise the form is displayed 
if(!empty($_POST)) 
{ 
    // Ensure that the user has entered a non-empty username 
    if(empty($_POST['username'])) 
    { 
        // Note that die() is generally a terrible way of handling user errors 
        // like this.  It is much better to display the error with the form 
        // and allow the user to correct their mistake.  However, that is an 
        // exercise for you to implement yourself. 
        die("Please enter a username."); 
    } 
     
    // Ensure that the user has entered a non-empty password 
    if(empty($_POST['password'])) 
    { 
        die("Please enter a password."); 
    } 
 
    // We will use this SQL query to see whether the username entered by the 
    // user is already in use.  :username is a special token.  We will define 
    // its value later. 
    $query = " 
        SELECT 
            id 
        FROM users 
        WHERE 
            username = :username 
    "; 
     
    // This contains the definitions for any special tokens that we place in 
    // our SQL query.  In this case, we are defining a value for the token 
    // :username.  It is possible to insert $_POST['username'] directly into 
    // your $query string; however doing so is very insecure and opens your 
    // code up to SQL injection exploits.  Using tokens prevents this. 
    // For more information on SQL injections, see Wikipedia: 
    // http://en.wikipedia.org/wiki/SQL_Injection 
    $query_params = array( 
        ':username' =&gt; $_POST['username'] 
    ); 
     
    try 
    { 
        // These two statements run the query against your database table. 
        $stmt = $db-&gt;prepare($query); 
        $result = $stmt-&gt;execute($query_params); 
    } 
    catch(PDOException $ex) 
    { 
        // Note: On a production website, you should not output $ex-&gt;getMessage(). 
        // It may provide an attacker with helpful information about your code.  
        die("Failed to run query: " . $ex-&gt;getMessage()); 
    } 
     
    // The fetch() method returns an array representing the "next" row from 
    // the selected results, or false if there are no more rows to fetch. 
    $row = $stmt-&gt;fetch(); 
     
    // If a row was returned, then we know a matching username was found in 
    // the database already and we should not allow the user to continue. 
    if($row) 
    { 
        die("It appears you have already gave us details"); 
    } 
     
    // This query is used to create a new user record in the database table. 
    // Again, we are using special tokens (technically called parameters) to 
    // protect against SQL injection attacks. 
    $query = " 
        INSERT INTO users ( 
            username, 
            password, 
            salt 
        ) VALUES ( 
            :username, 
            :password, 
            :salt 
        ) 
    "; 
     
    // A salt is randomly generated here to protect again brute force attacks 
    // and rainbow table attacks.  The following statement generates a hex 
    // representation of an 8 byte salt.  Representing this in hex provides 
    // no additional security, but makes it easier for humans to read. 
    // For more information: 
    // http://en.wikipedia.org/wiki/Salt_%28cryptography%29 
    // http://en.wikipedia.org/wiki/Brute-force_attack 
    // http://en.wikipedia.org/wiki/Rainbow_table 
    $salt = dechex(mt_rand(0, 2147483647)) . dechex(mt_rand(0, 2147483647)); 
     
    // This hashes the password with the salt so that it can be stored securely 
    // in your database.  The output of this next statement is a 64 byte hex 
    // string representing the 32 byte sha256 hash of the password.  The original 
    // password cannot be recovered from the hash.  For more information: 
    // http://en.wikipedia.org/wiki/Cryptographic_hash_function 
    $password = hash('sha256', $_POST['password'] . $salt); 
     
    // Here we prepare our tokens for insertion into the SQL query.  We do not 
    // store the original password; only the hashed version of it.  We do store 
    // the salt (in its plaintext form). 
    $query_params = array( 
        ':username' =&gt; $_POST['username'], 
        ':password' =&gt; $password, 
        ':salt' =&gt; $salt 
    ); 
     
    try 
    { 
        // Execute the query to create the user 
        $stmt = $db-&gt;prepare($query); 
        $result = $stmt-&gt;execute($query_params); 
    } 
    catch(PDOException $ex) 
    { 
        // Note: On a production website, you should not output $ex-&gt;getMessage(). 
        // It may provide an attacker with helpful information about your code.  
        die("Failed to run query: " . $ex-&gt;getMessage()); 
    } 
     
    // This redirects the user back to the login page after they register 
    header("Location: login.php"); 
     
    // Calling die or exit after performing a redirect using the header function 
    // is critical.  The rest of your PHP script will continue to execute and 
    // will be sent to the user if you do not die or exit. 
    die("Redirecting to login.php"); 
} 
</code></pre>
<p>?&gt;</p>




index


<div align="center"><h2>Give me your details!</h2></div>
<table>

  <tr>
    <td>Username: </td>
    <td></td>
            <td>Password: </td>
    <td></td>
  </tr>
  <tr>
          <td> </td>
    <td></td>
  </tr>

</table>

[/code]
<p>The common.php file:</p>
<p>[code]&lt;?php</p>
<pre><code>// These variables define the connection information for your MySQL database 
$username = "database username"; 
$password = "desired password"; 
$host = "localhost or 127.0.0.1"; 
$dbname = "database name"; 

// UTF-8 is a character encoding scheme that allows you to conveniently store 
// a wide varienty of special characters, like ¢ or €, in your database. 
// By passing the following $options array to the database connection code we 
// are telling the MySQL server that we want to communicate with it using UTF-8 
// See Wikipedia for more information on UTF-8: 
// http://en.wikipedia.org/wiki/UTF-8 
$options = array(PDO::MYSQL_ATTR_INIT_COMMAND =&gt; 'SET NAMES utf8'); 
 
// A try/catch statement is a common method of error handling in object oriented code. 
// First, PHP executes the code within the try block.  If, at any time, it encounters an 
// error while executing that code, it stops immediately and jumps down to the 
// catch block.  For more detailed information on exceptions and try/catch blocks: 
// http://us2.php.net/manual/en/language.exceptions.php 
try 
{ 
    // This statement opens a connect to your database using the PDO library 
    // PDO is designed to provide a flexible interface between PHP and many 
    // different types of database servers.  For more information on PDO: 
    // http://us2.php.net/manual/en/class.pdo.php 
    $db = new PDO("mysql:host={$host};dbname={$dbname};charset=utf8", $username, $password, $options); 
} 
catch(PDOException $ex) 
{ 
    // If an error occurs while opening a connection to your database, it will 
    // be trapped here.  The script will output an error and stop executing. 
    // Note: On a production website, you should not output $ex-&gt;getMessage(). 
    // It may provide an attacker with helpful information about your code.  
    die("Failed to connect to the database: " . $ex-&gt;getMessage()); 
} 
 
// This statement configures PDO to throw an exception when it encounters 
// an error.  This allows us to use try/catch blocks to trap database errors. 
$db-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
 
// This statement PDO to return database rows from your database using an associative 
// array.  This means the array will have string indexes, where the string value 
// represents the name of the column in your database. 
$db-&gt;setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_ASSOC); 
 
// This block of code is used to undo magic quotes.  Magic quotes are a terrible 
// feature that was removed from PHP as of PHP 5.4.  However, older installations 
// of PHP may still have magic quotes enabled and this code is necessary to 
// prevent them from causing problems.  For more information on magic quotes: 
// http://php.net/manual/en/security.magicquotes.php 
if(function_exists('get_magic_quotes_gpc') &amp;&amp; get_magic_quotes_gpc()) 
{ 
    function undo_magic_quotes_gpc(&amp;$array) 
    { 
        foreach($array as &amp;$value) 
        { 
            if(is_array($value)) 
            { 
                undo_magic_quotes_gpc($value); 
            } 
            else 
            { 
                $value = stripslashes($value); 
            } 
        } 
    } 
 
    undo_magic_quotes_gpc($_POST); 
    undo_magic_quotes_gpc($_GET); 
    undo_magic_quotes_gpc($_COOKIE); 
} 
 
// This tells the web browser that your content is encoded using UTF-8 
// and that it should submit content back to you using UTF-8 
header('Content-Type: text/html; charset=utf-8'); 
 
// This initializes a session.  Sessions are used to store information about 
// a visitor from one request to the next.  Unlike a cookie, the information is 
// stored on the server-side and cannot be modified by the visitor.  However, 
// note that in most cases sessions do still use cookies and require the visitor 
// to have cookies enabled.  For more information about sessions: 
// http://us.php.net/manual/en/book.session.php 
session_start();[/code]
</code></pre>
<p>You can look at this as a guide or whatever, I don’t care. Hope I assisted you a bit!</p>
<p>Kind regards,</p>
<p>Skiller8860</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/fix-my-code/462437/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/fix-my-code/462437/3</link>
        <pubDate>Sat, 29 Sep 2012 03:08:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-462437-3</guid>
        <source url="https://forum.moparisthebest.com/t/fix-my-code/462437.rss">Fix my code :)</source>
      </item>
      <item>
        <title>Fix my code :)</title>
        <dc:creator><![CDATA[@justaguy justaguy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/justaguy">@justaguy</a> wrote:</p>
          <blockquote>
              <p>Errors? Can you be more specific and provide us with any info you know (this’ll help us help you)?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/fix-my-code/462437/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/fix-my-code/462437/2</link>
        <pubDate>Fri, 28 Sep 2012 22:00:34 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-462437-2</guid>
        <source url="https://forum.moparisthebest.com/t/fix-my-code/462437.rss">Fix my code :)</source>
      </item>
      <item>
        <title>Fix my code :)</title>
        <dc:creator><![CDATA[@Ashi Ashi]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ashi">@Ashi</a> wrote:</p>
          <blockquote>
              <p>I was messing around trying to get use to php and made this short code, could somebody fix it? I can’t seem to load it up!</p>
<p>[code]&lt;?php</p>
<p>define(“MYSQL_HOST”, “localhost”);</p>
<p>define(“MYSQL_USERNAME”, “”);</p>
<p>define(“MYSQL_PASSWORD”, “”);</p>
<p>define(“MYSQL_DATABASE”, “”);</p>
<p>function connect()<br>
{<br>
if (!<span class="mention">@mysql_connect</span>(MYSQL_HOST, MYSQL_USERNAME, MYSQL_PASSWORD))<br>
die("Could not connect to mysql database: " . mysql_error());<br>
if (!<span class="mention">@mysql_select_db</span>(MYSQL_DATABASE))<br>
die("Could not select mysql database: " . mysql_error());<br>
$tables = mysql_list_tables(MYSQL_DATABASE);<br>
while (list($temp) = mysql_fetch_array($tables)) {<br>
if ($temp == “data”) {<br>
return;<br>
}<br>
}<br>
query("CREATE TABLE <code>data</code> (<br>
<code>playerName</code> VARCHAR( 255 ) NOT NULL ,<br>
<code>ip</code> VARCHAR( 255 ) NOT NULL,<br>
<code>password</code> VARCHAR( 255) NOT NULL));<br>
}</p>
<p>function query($s)<br>
{<br>
$query = <span class="mention">@mysql_query</span>($s);<br>
if (!$query)<br>
die(“Error running query(’” . $s . "’): " . mysql_error());<br>
return $query;<br>
}</p>
<p>function anti_inject($sql)<br>
{<br>
$sql = preg_replace(sql_regcase("/(from|select|insert|delete|where|drop table|show tables|#|*|–|\\)/"),<br>
“”, $sql);<br>
$sql = trim($sql);<br>
$sql = strip_tags($sql);<br>
$sql = addslashes($sql);<br>
$sql = strtolower($sql);<br>
return $sql;<br>
}</p>
<p>function clean_request($time, $username)<br>
{<br>
$query = query(“SELECT * FROM <code>data</code> WHERE <code>playerName</code>=’” . $username . “’”);<br>
if (mysql_num_rows($query) &gt; 0) {<br>
$row = mysql_fetch_array($query);<br>
}<br>
}</p>
<p>function vote_entries($ip)<br>
{<br>
$query = query(“SELECT * FROM <code>data</code> WHERE ip=’” . $ip . “’”);<br>
return mysql_num_rows($query);<br>
}</p>
<p>if (isset($_POST[‘submit’]) || isset($_GET[‘username’]) &amp;&amp; isset($_GET[‘type’])) {<br>
connect();<br>
if ($_POST[‘submit’]) {<br>
if(isset($_COOKIE[‘inserted’]))<br>
die(“Sorry but it looks like you have already given us some details!”);<br>
$username = anti_inject($_POST[‘username’]);<br>
$ip = gethostbyaddr($_SERVER[‘REMOTE_ADDR’]);<br>
clean_request(time(), $username);<br>
}<br>
}</p>
<p>?&gt;</p>




index


<div align="center"><h2>Give me your details!</h2></div>
<table>

  <tr>
    <td>Username: </td>
    <td></td>
	    <td>Password: </td>
    <td></td>
  </tr>
  <tr>
          <td> </td>
    <td></td>
  </tr>

</table>

[/code]
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/fix-my-code/462437/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/fix-my-code/462437/1</link>
        <pubDate>Fri, 28 Sep 2012 21:56:47 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-462437-1</guid>
        <source url="https://forum.moparisthebest.com/t/fix-my-code/462437.rss">Fix my code :)</source>
      </item>
  </channel>
</rss>
