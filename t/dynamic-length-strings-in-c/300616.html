<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/dynamic-length-strings-in-c/300616 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 10:08:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Dynamic length strings in C - General Programming - moparisthebest.com</title>
    <meta name="description" content="i have a bit of a problem trying to make dynamic length strings in C, my current way for doing things is : 

 int add_char(char** arr, int len, char obj)
{
    (*arr) = realloc(*arr, sizeof(char) * (len + 1));

(*arr)[le&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="300616.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Dynamic length strings in C&#39;" href="300616.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/dynamic-length-strings-in-c/300616" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/dynamic-length-strings-in-c/300616" />
<meta property="og:title" content="Dynamic length strings in C" />
<meta name="twitter:title" content="Dynamic length strings in C" />
<meta property="og:description" content="i have a bit of a problem trying to make dynamic length strings in C, my current way for doing things is :  [code]int add_char(char** arr, int len, char obj)  {  (*arr) = realloc(*arr, sizeof(char) * (len + 1));  (*arr)[len] = obj;  (*arr)[len + 1] = 0;    return len + 1;  }[/code]  and when i want to add to this string i would do :  [code]  char* etc = malloc(sizeof(char));  int len = 0;  len = add_char(&amp;etc, len, ‘a’);  len = add_char(&amp;etc, len, ‘b’);  len = add_char(&amp;etc, len, ‘c’);  len = ad..." />
<meta name="twitter:description" content="i have a bit of a problem trying to make dynamic length strings in C, my current way for doing things is :  [code]int add_char(char** arr, int len, char obj)  {  (*arr) = realloc(*arr, sizeof(char) * (len + 1));  (*arr)[len] = obj;  (*arr)[len + 1] = 0;    return len + 1;  }[/code]  and when i want to add to this string i would do :  [code]  char* etc = malloc(sizeof(char));  int len = 0;  len = add_char(&amp;etc, len, ‘a’);  len = add_char(&amp;etc, len, ‘b’);  len = add_char(&amp;etc, len, ‘c’);  len = ad..." />
<meta property="article:published_time" content="2009-09-07T00:01:01+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="300616.html">Dynamic length strings in C</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/nueb35.html'><span itemprop='name'>nueb35</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:01:01Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:04Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i have a bit of a problem trying to make dynamic length strings in C, my current way for doing things is :</p>
<p>[code]int add_char(char** arr, int len, char obj)</p>
<p>{</p>
<pre><code>(*arr) = realloc(*arr, sizeof(char) * (len + 1));

(*arr)[len] = obj;

(*arr)[len + 1] = 0;



return len + 1;
</code></pre>
<p>}[/code]</p>
<p>and when i want to add to this string i would do :</p>
<p>[code]<br>
char* etc = malloc(sizeof(char));<br>
int len = 0;</p>
<p>len = add_char(&amp;etc, len, ‘a’);<br>
len = add_char(&amp;etc, len, ‘b’);<br>
len = add_char(&amp;etc, len, ‘c’);<br>
len = add_char(&amp;etc, len, ‘d’);<br>
…[/code]</p>
<p>while doing this from time to time my program segfaults for some reason, my guess is that realloc keeps the base memory address of the selected pointer so lets say i have a pointer pointing to 0 and it has 5 bytes allocated, and i have another pointer pointing to 7 with 3 bytes allocated</p>
<p><code>[h][e][l][l][o][ ][ ][a][b][c]
 0  1  2  3  4  5  6  7  8  9 </code></p>
<p>if i tried to reallocate the first pointer to 8 bytes it would overlap the second pointer instead of finding a free address with enough bytes for the allocation</p>
<p>anyways, how would i fix that so it doesnt crash?</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:05:17Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:04Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i highly doubt what you say is your problem, but IF it is, then you can simply do something like this:</p>
<pre><code class="lang-auto">char *str = malloc(sizeof(char) * 10);
void *v = malloc(sizeof(char) * 3);
memmove(str + 9, v, sizeof(char) * 3);</code></pre>
<p>as you can see, instead of reallocating the memory block, i allocated a seperate block of memory that has no connections with the original one, and simply moved the new block of memory to the old one’s. in order so it did not replace the original block’s memory, however, i grabbed the memory address of the original block and added ‘9’ to it so it would start the copying from the 10th index</p>
<p>edit: by the way, im not 100% sure if it would work though, seeing as how ive never had this problem</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:11:57Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:05Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>You know there is something called learning a language.</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:12:19Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:05Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“oksuper_, post:3, topic:300616”]You know there is something called learning a language.[/quote]was that directed towards me?</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:13:32Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:05Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i didnt read anything, but make a struct that contains the char* and and int for the length</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:14:57Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:05Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>frank_, that wasnt his question</p>
<p>his question was concerning segmentation faults due to reallocating the same memory block over and over again</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/yakman.html'><span itemprop='name'>yakman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:16:26Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:05Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>compile with the -g3 flag and run it in gdb</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zstars.html'><span itemprop='name'>zstars</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:17:37Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:05Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Nueb35, post:1, topic:300616”]i have a bit of a problem trying to make dynamic length strings in C, my current way for doing things is :</p>
<p>[code]int add_char(char** arr, int len, char obj)</p>
<p>{</p>
<pre><code>(*arr) = realloc(*arr, sizeof(char) * (len + 1));

(*arr)[len] = obj;

(*arr)[len + 1] = 0;



return len + 1;
</code></pre>
<p>}[/code]</p>
<p>and when i want to add to this string i would do :</p>
<p>[code]<br>
char* etc = malloc(sizeof(char));<br>
int len = 0;</p>
<p>len = add_char(&amp;etc, len, ‘a’);<br>
len = add_char(&amp;etc, len, ‘b’);<br>
len = add_char(&amp;etc, len, ‘c’);<br>
len = add_char(&amp;etc, len, ‘d’);<br>
…[/code]</p>
<p>while doing this from time to time my program segfaults for some reason, my guess is that realloc keeps the base memory address of the selected pointer so lets say i have a pointer pointing to 0 and it has 5 bytes allocated, and i have another pointer pointing to 7 with 3 bytes allocated</p>
<p><code>[h][e][l][l][o][ ][ ][a][b][c]
 0  1  2  3  4  5  6  7  8  9 </code></p>
<p>if i tried to reallocate the first pointer to 8 bytes it would overlap the second pointer instead of finding a free address with enough bytes for the allocation</p>
<p>anyways, how would i fix that so it doesnt crash?[/quote]</p>
<p>-sizeof(char) is 1 by definition.<br>
-realloc can return NULL.<br>
-arr[len+1] refers to what would be the (len+2)th element of the array, and assigning to it is hence undefined.</p>
<p>Just FYI, this is what you would do in C++:</p>
<p>std::string str = “I heard u liek mudkip”;<br>
str += “z”;</p>
<p>Enjoy.</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:22:37Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:05Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“zstars, post:8, topic:300616”][quote author=Nueb35 link=topic=396868.msg2947531#msg2947531 date=1252281661]<br>
…<br>
[/quote]<br>
-arr[len+1] refers to what would be the (len+2)th element of the array, and assigning to it is hence undefined.[/quote]wouldnt that be whats causing the segfault…</p>
<p>so yes, my assumption was correct:</p>
<aside class="quote no-group" data-post="2" data-topic="300616">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/abraham2119/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> abraham2119:</div>
<blockquote>
<p>i highly doubt what you say is your problem, but IF it is, then you can simply do something like this:</p>
</blockquote>
</aside>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zstars.html'><span itemprop='name'>zstars</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:23:55Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:06Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Most likely. Either that or realloc() returning 0 <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T00:24:48Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:06Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[code]<span class="hashtag">#include</span> &lt;stdio.h&gt;<br>
<span class="hashtag">#include</span> &lt;stdlib.h&gt;</p>
<p>typedef struct _charbuf {<br>
char *buf;<br>
int pos;<br>
int len;<br>
} charbuf;</p>
<p>void charbuf_add(charbuf *pbuf, char c) {<br>
if (pbuf-&gt;pos == pbuf-&gt;len) {<br>
pbuf-&gt;buf = (char *) realloc(pbuf-&gt;buf, pbuf-&gt;pos + 1);<br>
pbuf-&gt;len++;<br>
}<br>
pbuf-&gt;buf[pbuf-&gt;pos++] = c;<br>
}</p>
<p>main() {<br>
charbuf buf;<br>
memset(&amp;buf, 0, sizeof(charbuf));</p>
<pre><code>buf.buf = (char *) malloc(1);
buf.len = 1;

int c;
for (c = 'a'; c &lt;= 'z'; ++c) {
    charbuf_add(&amp;buf, c);
}

charbuf_add(&amp;buf, 0);

printf("buf = %s\n", buf.buf);

return 0;
</code></pre>
<p>}<br>
[/code]</p>
<p>Zaboomafoo!</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T01:21:23Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:12Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>If you are going to be adding characters to the string, you shouldn’t reallocate and copy the array every time, instead you should have a bigger array than you really need and increase it only when it needs increasing.  It is much more efficient that way (like how ArrayList does it)</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/nueb35.html'><span itemprop='name'>nueb35</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T01:30:21Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:13Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="12" data-topic="300616">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/moparisthebest/40/30_1.png" class="avatar"> Moparisthebest:</div>
<blockquote>
<p>If you are going to be adding characters to the string, you shouldn’t reallocate and copy the array every time, instead you should have a bigger array than you really need and increase it only when it needs increasing.  It is much more efficient that way (like how ArrayList does it)</p>
</blockquote>
</aside>
<p>i read something like that on an article i found on google, it said to double the array every time it needed to be increased, but i thought that would be wasteful</p>
<p><a class="mention" href="../../u/zstars.html">@zstars</a> i tried printing the return value of realloc, and the program would crash before the printf was called, (meaning it crashed inside realloc)</p>
<p>ill test some of these things and see if it works</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T01:44:18Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:14Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>No, doubling actually is the best way to do it, many studies have been done on the subject.</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T01:47:30Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:47:15Z' class='post-time'>
              July 31, 2016, 10:47am
            </time>
        <span itemprop='position'>#15</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>thats exactly how my dynamic list in c works:</p>
<p>[code]void add(list *l, void *obj)<br>
{<br>
if (l-&gt;index &gt;= l-&gt;max) {<br>
realloc((l-&gt;a), sizeof(void *) * (l-&gt;max * 2));<br>
l-&gt;max *= 2;<br>
}</p>
<pre><code>l-&gt;a[l-&gt;index++] = obj;
</code></pre>
<p>}[/code]</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/xeez.html'><span itemprop='name'>xeez</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-07T20:31:50Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:48:28Z' class='post-time'>
              July 31, 2016, 10:48am
            </time>
        <span itemprop='position'>#16</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Moparisthebest, post:14, topic:300616”]No, doubling actually is the best way to do it, many studies have been done on the subject.[/quote]If I recall correctly, I read that this is exactly how java’s ArrayList class works.</p>
<p>Nueb35, it doesn’t strictly have to double the amount of memory stored. You can set up an algorithm that would minimize the amount of memory to allocate, so that if your string holds 20000 characters, it doesn’t allocate 20000 bytes more since it may come to be unneeded.</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/yakman.html'><span itemprop='name'>yakman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-08T14:23:09Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:49:38Z' class='post-time'>
              July 31, 2016, 10:49am
            </time>
        <span itemprop='position'>#17</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>moparisthebest could you post some of the studies, I’m intrested now.</p>
<p>extracts from java std api source files</p>
<p>ArrayList.java</p>
<pre><code class="lang-auto">    public void ensureCapacity(int minCapacity) {
        modCount++;
        int oldCapacity = elementData.length;
        if (minCapacity &gt; oldCapacity) {
            Object oldData[] = elementData;
            int newCapacity = (oldCapacity * 3)/2 + 1;
            if (newCapacity &lt; minCapacity)
                newCapacity = minCapacity;
            // minCapacity is usually close to size, so this is a win:
            elementData = Arrays.copyOf(elementData, newCapacity);
        }
    }</code></pre>
<p>Vector.java</p>
<pre><code class="lang-auto">    private void ensureCapacityHelper(int minCapacity) {
        int oldCapacity = elementData.length;
        if (minCapacity &gt; oldCapacity) {
            Object[] oldData = elementData;
            int newCapacity = (capacityIncrement &gt; 0) ?
                (oldCapacity + capacityIncrement) : (oldCapacity * 2);
            if (newCapacity &lt; minCapacity) {
                newCapacity = minCapacity;
            }
            elementData = Arrays.copyOf(elementData, newCapacity);
        }
    }</code></pre>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-08T15:00:23Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:49:42Z' class='post-time'>
              July 31, 2016, 10:49am
            </time>
        <span itemprop='position'>#18</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="17" data-topic="300616">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/yakman/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> yakman:</div>
<blockquote>
<p>moparisthebest could you post some of the studies, I’m intrested now.</p>
</blockquote>
</aside>
<p>I remember talking about it in a data structures class in college.  I don’t know where to start looking for the studies.</p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-09T23:17:46Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:52:05Z' class='post-time'>
              July 31, 2016, 10:52am
            </time>
        <span itemprop='position'>#19</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“yakman, post:17, topic:300616”]moparisthebest could you post some of the studies, I’m intrested now.[/quote]why need studies when you have wikipedia? <a href="http://en.wikipedia.org/wiki/Dynamic_array#Geometric_expansion_and_amortized_cost" rel="nofollow noopener">http://en.wikipedia.org/wiki/Dynamic_array#Geometric_expansion_and_amortized_cost</a></p>
      </div>

      <meta itemprop='headline' content='Dynamic length strings in C'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/dynamic-length-strings-in-c/300616 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 10:08:43 GMT -->
</html>
