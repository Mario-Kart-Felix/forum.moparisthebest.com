<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Why does not this add a method to client.class?</title>
    <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645</link>
    <description>Im trying to learn bcel!

jc is ofcourse ClassParser(...).parse()
[code]
        ClassGen cGen = new ClassGen(jc);
        ConstantPoolGen ThePool = cGen.getConstantPool();

        
        FieldGen FieldGenerated = new FieldGen(Constants.ACC_PUBLIC | Constants.ACC_FINAL, Type.INT, &quot;mc.p&quot;, ThePool);
        String MethodName = &quot;getNPCCount&quot;;

        Field fieldObject = FieldGenerated.getField();

        addReturnMethod(fieldObject, MethodName, cGen, ThePool);

       //Go through all the methods

       //save the changes to the class
       jc.setConstantPool(ThePool.getFinalConstantPool());
        try {
               System.out.println(&quot;Saving updated client.class.&quot;);
               //Again, very easy to save the &quot;compiled&quot; class back to disk with one line.
               jc.dump(&quot;./client/&quot; + jc.getClassName() + &quot;.class&quot;);
         } catch (IOException ioe) { System.out.println(&quot;Failed to save updated client.class.&quot;); }


// This is the function from the TUT thread... the one im using!
public static void addReturnMethod(Field returnField, String methodName, ClassGen cGen, ConstantPoolGen cPoolGen)
{
	InstructionList methodIList = new InstructionList();
	System.out.println(&quot;addReturnMethod-&gt;cGen.getClassName() = &quot;+cGen.getClassName()+&quot;\n&quot;);
	MethodGen getMethod = new MethodGen(Constants.ACC_PUBLIC, returnField.getType(), Type.NO_ARGS, new String[]{}, methodName, cGen.getClassName(), methodIList, cPoolGen);

	InstructionFactory iFactory = new InstructionFactory(cGen, cPoolGen);

	methodIList.append(new ALOAD(0));
  methodIList.append(iFactory.createFieldAccess(cGen.getClassName(), returnField.getName(), returnField.getType(), Constants.GETSTATIC));
	methodIList.append(InstructionFactory.createReturn(returnField.getType()));

	getMethod.setMaxStack();
	getMethod.setMaxLocals();

	cGen.addMethod(getMethod.getMethod());
  System.out.println(&quot;addReturnMethod-&gt;returnField.getType() = &quot;+returnField.getType()+&quot;\n&quot;);
	System.out.println(cGen.getClassName() + &quot; -&gt; added &quot; + methodName);


}

[/code]

When i decompile /client/client.class  - I only see the standard code :&lt; whats wrong?</description>
    
    <lastBuildDate>Sat, 10 Jan 2009 19:04:00 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@nueb35 Nueb35]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nueb35">@nueb35</a> wrote:</p>
          <blockquote>
              <p>if GETFIELD gets the content of a field, PUTFIELD will set the contents of a field.</p>
<p>[tt]new InstructionFactory(classGenOfClassContainingTheField, constantPoolOfClassReceivingTheInstruction).createPutField(classGenOfClassContainingTheField.getClassName(), “field name”, fieldType);[/tt]</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/19</link>
        <pubDate>Sat, 10 Jan 2009 19:04:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-19</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@Pker Pker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pker">@Pker</a> wrote:</p>
          <blockquote>
              <p>0 aload_0<br>
1 aload_1<br>
2 putfield <span class="hashtag">#3</span> &lt;Test/test Ljava/lang/String;&gt;<br>
5 return</p>
<p>I see this are the instructions. But im not sure what putfield or how to implement this</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/18</link>
        <pubDate>Sat, 10 Jan 2009 18:39:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-18</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@nueb35 Nueb35]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nueb35">@nueb35</a> wrote:</p>
          <blockquote>
              <p>make a test class for example :</p>
<p>[code]public class Test<br>
{<br>
String test = “”;</p>
<pre><code>public void test(String t)
{
	test = t;
}
</code></pre>
<p>}[/code]</p>
<p>then open it up on JBE and see what instructions are needed</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/17</link>
        <pubDate>Sat, 10 Jan 2009 17:43:29 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-17</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@Pker Pker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pker">@Pker</a> wrote:</p>
          <blockquote>
              <p>Thank you so much!</p>
<p>Now im allmost done, im however stressing with finding out how to add a method like this:</p>
<pre><code>public final void setCallback(Callback arg0)
{
    callback = arg0;
}
</code></pre>
<p>This is my tries:</p>
<pre><code class="lang-auto">                  // Add public void setCallback(Callback callback);
                  InstructionList il = new InstructionList();
                  MethodGen  mg = new MethodGen(Constants.ACC_FINAL | Constants.ACC_PUBLIC, // access flags
                                Type.VOID,               // return type
                                new Type[] {             // argument types
                                  Type.getType("Lcom.speljohan.rsbot.accessors.Callback;") },
                                new String[] { "arg0" }, // arg names
                                "setCallback", "client",    // method, class
                                il, cPoolGen);

                  LocalVariableGen lg = mg.addLocalVariable("callback", Type.getType("Lcom.speljohan.rsbot.accessors.Callback;"), null, null);
                  int name = lg.getIndex();
                  //InstructionFactory factory = new InstructionFactory(cGen);
                  //factory.createPutField("client","callback",Type.getType("Lcom.speljohan.rsbot.accessors.Callback;"));
                  il.append(InstructionConstants.ACONST_NULL);
                  lg.setStart(il.append(new ASTORE(name))); // "i" valid from here
                  
                  mg.setMaxStack();
                  mg.setMaxLocals();
                  mg.removeLineNumbers();
                  cGen.addMethod(mg.getMethod());</code></pre>
<p>This is what i currently get:</p>
<pre><code>public final void setCallback(Callback arg0)
{
    Object obj = null;
}
</code></pre>
<p>So i only need to change Object obj = null to callback = arg0;</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/16</link>
        <pubDate>Sat, 10 Jan 2009 17:35:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-16</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@yakman yakman]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/yakman">@yakman</a> wrote:</p>
          <blockquote>
              <p>Type.getType(“Lcom.mybot.accsessor.Callback;”)</p>
<p>or</p>
<p>new ObjectType(“com.mybot.accsessor.Callback”)</p>
<p>the first one ends up calling the second one anyway</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/15</link>
        <pubDate>Sat, 10 Jan 2009 13:11:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-15</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@Pker Pker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pker">@Pker</a> wrote:</p>
          <blockquote>
              <p>Yea.<br>
This is know, but i mean how should the field be ?<br>
This did not work!</p>
<p>new FieldGen(Constants.ACC_PUBLIC | Constants.ACC_STATIC, Type.getType(“com.mybot.accsessor.Callback”), “callback”, cPoolGen).getField()</p>
<p>Type.getType(“com.mybot.accsessor.Callback”) &lt;— This must be wrong… Dunno how to get the type right… But its the right path to the object atleast.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/14</link>
        <pubDate>Sat, 10 Jan 2009 04:15:23 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-14</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@chrisn2323 chrisn2323]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/chrisn2323">@chrisn2323</a> wrote:</p>
          <blockquote>
              <p>classGenInstance.addField(Field f);</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/13</link>
        <pubDate>Sat, 10 Jan 2009 04:00:46 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-13</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@Pker Pker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pker">@Pker</a> wrote:</p>
          <blockquote>
              <p>Ah ok thank you.</p>
<p>I was wondering, is there any easy way of adding like this:<br>
adding a variable:<br>
<span class="bbcode-b">public static Callback callback;</span></p>
<p>?</p>
<p>I tried to search for adding variable and adding implements … but its to many results of incorrect answers.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/12</link>
        <pubDate>Sat, 10 Jan 2009 03:33:05 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-12</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@ilyaostr9 io9]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilyaostr9">@ilyaostr9</a> wrote:</p>
          <blockquote>
              <p>o rite cos hes dumpin da JavaClass not da ClassGen</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/11</link>
        <pubDate>Sat, 10 Jan 2009 02:35:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-11</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@nueb35 Nueb35]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nueb35">@nueb35</a> wrote:</p>
          <blockquote>
              <p>[quote=“io9, post:9, topic:255645”][quote author=Pker link=topic=337785.msg2622224#msg2622224 date=1231541479]</p>
<aside class="quote no-group">
<blockquote>
<p>make sure you actually dump the edited classes, classGen.getJavaClass().dump(somePlace);</p>
</blockquote>
</aside>
<p>Now it works <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=6" title=":wink:" class="emoji" alt=":wink:"><br>
[/quote]<br>
Weren’t you doing that anyway? Right here:</p>
<p><code>
jc.setConstantPool(ThePool.getFinalConstantPool());
        try {
               System.out.println("Saving updated client.class.");
               //Again, very easy to save the "compiled" class back to disk with one line.
               jc.dump("./client/" + jc.getClassName() + ".class");
         } catch (IOException ioe) { System.out.println("Failed to save updated client.class."); }</code>[/quote]</p>
<p>i think the javaclass instance changes when you do getJavaClass, it creates a whole new javaclass with all the new added methods/fields/etc.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/10</link>
        <pubDate>Sat, 10 Jan 2009 02:13:48 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-10</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@ilyaostr9 io9]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilyaostr9">@ilyaostr9</a> wrote:</p>
          <blockquote>
              <p>[quote=“Pker, post:5, topic:255645”][quote author=nueb35 link=topic=337785.msg2622206#msg2622206 date=1231540862]<br>
make sure you actually dump the edited classes, classGen.getJavaClass().dump(somePlace);<br>
[/quote]<br>
Now it works ;)[/quote]<br>
Weren’t you doing that anyway? Right here:</p>
<p><code>
jc.setConstantPool(ThePool.getFinalConstantPool());
        try {
               System.out.println("Saving updated client.class.");
               //Again, very easy to save the "compiled" class back to disk with one line.
               jc.dump("./client/" + jc.getClassName() + ".class");
         } catch (IOException ioe) { System.out.println("Failed to save updated client.class."); }</code></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/9</link>
        <pubDate>Sat, 10 Jan 2009 01:53:47 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-9</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@BAsh BAsh]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/bash">@BAsh</a> wrote:</p>
          <blockquote>
              <p>You don’t import. All the fields and method descriptors are fully qualified names. Not String but java.lang.String. As such there is no need for imports.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/8</link>
        <pubDate>Sat, 10 Jan 2009 01:31:23 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-8</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@Pker Pker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pker">@Pker</a> wrote:</p>
          <blockquote>
              <p>Thank you nueb!</p>
<p>Your helping me understand big time here.</p>
<p>Edit:</p>
<p>Anyone have an idea of how to implement custom import’s ?<br>
like<br>
import com.project.*;<br>
Into the client.class file…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/7</link>
        <pubDate>Fri, 09 Jan 2009 23:04:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-7</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@nueb35 Nueb35]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nueb35">@nueb35</a> wrote:</p>
          <blockquote>
              <p>methodIList.append(new ALOAD(0)); &lt;-- ALOAD_0 adds the “this” which is not needed as it is a static field</p>
<p>EDIT that would just remove the this,</p>
<p>heres my method adding method :</p>
<p>[code]	public static void addReturn(ClassGen from, ClassGen to, String field, String method, String sig)<br>
{<br>
if (to.containsMethod(method, “()” + sig) != null)<br>
{<br>
return;<br>
}</p>
<pre><code>	Field f = from.containsField(field);
	InstructionList list = new InstructionList();

	if (!f.isStatic())
	{
		list.append(new ALOAD(0));
	}

	list.append(new InstructionFactory(from, to.getConstantPool()).createFieldAccess(from.getClassName(), field, f.getType(), f.isStatic() ? Constants.GETSTATIC : Constants.GETFIELD));
	list.append(InstructionFactory.createReturn(Type.getType(sig)));

	MethodGen gen = new MethodGen(Constants.ACC_PUBLIC, Type.getType(sig), Type.NO_ARGS, new String[] {}, method, to.getClassName(), list, to.getConstantPool());

	gen.setMaxStack();
	gen.setMaxLocals();
	gen.removeLineNumbers();
	gen.removeLocalVariables();

	to.addMethod(gen.getMethod());

	System.out.println("  - " + to.getClassName() + "." + method + "() returns " + from.getClassName() + "." + f.getName());
	fields++;
}[/code]</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/6</link>
        <pubDate>Fri, 09 Jan 2009 22:57:47 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-6</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@Pker Pker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pker">@Pker</a> wrote:</p>
          <blockquote>
              <p>Thank you man!</p>
<p>You saved my life.</p>
<p>Now it works <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
<p>Edit:</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/5</link>
        <pubDate>Fri, 09 Jan 2009 22:51:19 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-5</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@nueb35 Nueb35]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nueb35">@nueb35</a> wrote:</p>
          <blockquote>
              <p>make sure you actually dump the edited classes, classGen.getJavaClass().dump(somePlace);</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/4</link>
        <pubDate>Fri, 09 Jan 2009 22:41:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-4</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@Pker Pker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pker">@Pker</a> wrote:</p>
          <blockquote>
              <p>Im sorry, what do you mean by da statiks ?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/3</link>
        <pubDate>Fri, 09 Jan 2009 22:28:01 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-3</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@ilyaostr9 io9]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilyaostr9">@ilyaostr9</a> wrote:</p>
          <blockquote>
              <p>have you tried da statiks?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/2</link>
        <pubDate>Fri, 09 Jan 2009 22:24:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-2</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
      <item>
        <title>Why does not this add a method to client.class?</title>
        <dc:creator><![CDATA[@Pker Pker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pker">@Pker</a> wrote:</p>
          <blockquote>
              <p>Im trying to learn bcel!</p>
<p>jc is ofcourse ClassParser(…).parse()</p>
<pre><code class="lang-auto">        ClassGen cGen = new ClassGen(jc);
        ConstantPoolGen ThePool = cGen.getConstantPool();

        
        FieldGen FieldGenerated = new FieldGen(Constants.ACC_PUBLIC | Constants.ACC_FINAL, Type.INT, "mc.p", ThePool);
        String MethodName = "getNPCCount";

        Field fieldObject = FieldGenerated.getField();

        addReturnMethod(fieldObject, MethodName, cGen, ThePool);

       //Go through all the methods

       //save the changes to the class
       jc.setConstantPool(ThePool.getFinalConstantPool());
        try {
               System.out.println("Saving updated client.class.");
               //Again, very easy to save the "compiled" class back to disk with one line.
               jc.dump("./client/" + jc.getClassName() + ".class");
         } catch (IOException ioe) { System.out.println("Failed to save updated client.class."); }


// This is the function from the TUT thread... the one im using!
public static void addReturnMethod(Field returnField, String methodName, ClassGen cGen, ConstantPoolGen cPoolGen)
{
	InstructionList methodIList = new InstructionList();
	System.out.println("addReturnMethod-&gt;cGen.getClassName() = "+cGen.getClassName()+"\n");
	MethodGen getMethod = new MethodGen(Constants.ACC_PUBLIC, returnField.getType(), Type.NO_ARGS, new String[]{}, methodName, cGen.getClassName(), methodIList, cPoolGen);

	InstructionFactory iFactory = new InstructionFactory(cGen, cPoolGen);

	methodIList.append(new ALOAD(0));
  methodIList.append(iFactory.createFieldAccess(cGen.getClassName(), returnField.getName(), returnField.getType(), Constants.GETSTATIC));
	methodIList.append(InstructionFactory.createReturn(returnField.getType()));

	getMethod.setMaxStack();
	getMethod.setMaxLocals();

	cGen.addMethod(getMethod.getMethod());
  System.out.println("addReturnMethod-&gt;returnField.getType() = "+returnField.getType()+"\n");
	System.out.println(cGen.getClassName() + " -&gt; added " + methodName);


}
</code></pre>
<p>When i decompile /client/client.class  - I only see the standard code :&lt; whats wrong?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645/1</link>
        <pubDate>Fri, 09 Jan 2009 22:16:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-255645-1</guid>
        <source url="https://forum.moparisthebest.com/t/why-does-not-this-add-a-method-to-client-class/255645.rss">Why does not this add a method to client.class?</source>
      </item>
  </channel>
</rss>
