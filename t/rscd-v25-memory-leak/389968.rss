<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Rscd v25 memory leak</title>
    <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968</link>
    <description>anyone willing to share what causes it and where its at?</description>
    
    <lastBuildDate>Sat, 23 Apr 2011 13:28:18 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <blockquote>Q. Does PID exist? If so, what benefits does a low PID bring to a player?
<p>A. When the server processes players, it goes through them each in turn. If you are first in the list, you get processed first. In early versions of Classic, you always got put at the end of the list (if I remember rightly), so if you stayed logged in you would end up at the beginning of the list eventually. Being processed first meant you could catch up with people more easily when following them, which gave an advantage particularly in the wilderness with PVP. A low PID means you were at the beginning of the list, high PIDs were at the end.<br>
This is no longer true, as you are now placed in a random place in the list and everyone else is shuffled up, so you don’t retain the same PID throughout your session. This makes things much fairer.<br>
mod_jackh</p>
</blockquote>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/46">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/46</link>
        <pubDate>Sat, 23 Apr 2011 13:28:18 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-46</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@xEnt xEnt]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/xent">@xEnt</a> wrote:</p>
          <blockquote>
              <p>[quote=“IlikeArrays, post:38, topic:389968”][quote author=xEnt link=topic=485877.msg3576345#msg3576345 date=1303448136]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>If we’re making RSC private servers then it’s best to do it as close to how we know it was done on RSC. It was done via PID (well, experience sharing was anyway). You could login with someone else’s PID and get their experience.</p>
</blockquote>
</aside>
<p>PID system will never be replicated, reason being nobody knows EXACTLY how it worked. Also there were a few negatives about it which Andrew talked about and why he removed it.</p>
</blockquote>
</aside>
<p>making that system was easy. the RSC server had the same 600ms game loop that we have, therefore if pid2 talks to a banker before pid1 does, as long as they are in the same engine loop, the lower pid will be processed first.</p>
<p>the current system is much better, but getting that old system back takes 2 minutes.<br>
[/quote]</p>
<p>Your forgetting the pking sides of things, if you had a lower pid you could catch further but only in certain directions (see we don’t know) gonna have to take some research for that information. It affected more than just clicking.[/quote]</p>
<p>the reason you could 2sq at times is because PID1 who can 2square PID2: when the server loop goes around, all of PID1’s packets get processed, it sees a movement packet, it moves his location instantly server-side. at this stage he’s 1 square away (server-side) from the other player. it then processes his next packet (the attack packet) sees that hes 1 square away and attacks.</p>
<p>visually it looks 2 square but server-side it’s really 1 due to stupid game mechanics. Why this does not work in certain directions is beyond me.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/45">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/45</link>
        <pubDate>Sat, 23 Apr 2011 11:50:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-45</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@OldSkoolRSC OldSkoolRSC]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/oldskoolrsc">@OldSkoolRSC</a> wrote:</p>
          <blockquote>
              <p>Wouldnt PID be a fairer solution to pking when compared to ping? (Assuming it did affect catch)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/44">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/44</link>
        <pubDate>Sat, 23 Apr 2011 09:11:47 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-44</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@IlikeArrays IlikeArrays]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilikearrays">@IlikeArrays</a> wrote:</p>
          <blockquote>
              <p>They already took PID out of rsc…?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/43">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/43</link>
        <pubDate>Sat, 23 Apr 2011 08:36:29 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-43</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@NewbieNewty Newty]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/newbienewty">@NewbieNewty</a> wrote:</p>
          <blockquote>
              <p>[quote="-Nothing, post:41, topic:389968"][quote author=IlikeArrays link=topic=485877.msg3576985#msg3576985 date=1303497743]<br>
How did it affect ranging or maging?<br>
[/quote]<br>
EDIT: And for staking, the person with lower pID hitted first.[/quote]</p>
<p>That is still true currently in RS2 but Jagex claims they will fix the playerID System soon.</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://forum.moparisthebest.com/uploads/default/original/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a.png" class="site-icon" width="32" height="32">
      <a href="https://forum.moparisthebest.com/" target="_blank">moparisthebest.com</a>
  </header>
  <article class="onebox-body">
    <img src="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" class="thumbnail onebox-avatar" width="500" height="500">

<h3><a href="https://forum.moparisthebest.com/" target="_blank">moparisthebest.com</a></h3>

<p>programming, irc, cars</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>[quote=“Ollie, post:17, topic:388801”][quote]Q. Apparently people are using modified RS clients to be able to view their PID, and so they can log in and out until they get what they desire. Are you planning to do anything about this or how PIDs are assigned?</p>
<p>A. Whilst it may be possible to extract this with a modified client right now, we are working on updates which will make your slot in the server more or less irrelevant when it comes to action timing.[/quote]</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="http://www.runescape.com/img/global/favicon.ico?1" class="site-icon" width="32" height="32">
      <a href="http://services.runescape.com/m=forum/forums.ws?25,26,405,62276896,goto,1" target="_blank" rel="nofollow noopener">RuneScape</a>
  </header>
  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/362;"><img src="http://www.runescape.com/img/microsite/social-share-fb.jpg" class="thumbnail"></div>

<h3><a href="http://services.runescape.com/m=forum/forums.ws?25,26,405,62276896,goto,1" target="_blank" rel="nofollow noopener">RuneScape Forum - Community Forums for Clans, Feedback &amp; Discussion</a></h3>

<p>Join the discussion on the official RuneScape forum. Share your thoughts with the community, ask questions, find help, learn about events and much more.</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>my client will soon be useless[/quote]</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/42">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/42</link>
        <pubDate>Sat, 23 Apr 2011 06:51:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-42</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="40" data-topic="389968">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/ilikearrays/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> IlikeArrays:</div>
<blockquote>
<p>How did it affect ranging or maging?</p>
</blockquote>
</aside>
<p>Usually as low lvl mage, the person who casted faster &amp; lower pID won. Doesn’t affect ranging I think.</p>
<p>EDIT: And for staking, the person with lower pID hitted first.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/41">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/41</link>
        <pubDate>Fri, 22 Apr 2011 19:09:06 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-41</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@IlikeArrays IlikeArrays]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilikearrays">@IlikeArrays</a> wrote:</p>
          <blockquote>
              <p>How did it affect ranging or maging?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/40">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/40</link>
        <pubDate>Fri, 22 Apr 2011 18:42:23 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-40</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@5_1 5 1]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/5_1">@5_1</a> wrote:</p>
          <blockquote>
              <p>[quote=“IlikeArrays, post:38, topic:389968”][quote author=xEnt link=topic=485877.msg3576345#msg3576345 date=1303448136]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>If we’re making RSC private servers then it’s best to do it as close to how we know it was done on RSC. It was done via PID (well, experience sharing was anyway). You could login with someone else’s PID and get their experience.</p>
</blockquote>
</aside>
<p>PID system will never be replicated, reason being nobody knows EXACTLY how it worked. Also there were a few negatives about it which Andrew talked about and why he removed it.</p>
</blockquote>
</aside>
<p>making that system was easy. the RSC server had the same 600ms game loop that we have, therefore if pid2 talks to a banker before pid1 does, as long as they are in the same engine loop, the lower pid will be processed first.</p>
<p>the current system is much better, but getting that old system back takes 2 minutes.<br>
[/quote]</p>
<p>Your forgetting the pking sides of things, if you had a lower pid you could catch further but only in certain directions (see we don’t know) gonna have to take some research for that information. It affected more than just clicking.[/quote]<br>
If you had lower pid you can catch people who had higher pid. If you have higher pid then the person you’re fighting, you can’t catch them 2sqing if they run(only 1sq you can).</p>
<p>You couldn’t 2sq catch south east even WITH lower pid. You had to 1sq it.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/39">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/39</link>
        <pubDate>Fri, 22 Apr 2011 17:09:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-39</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@IlikeArrays IlikeArrays]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilikearrays">@IlikeArrays</a> wrote:</p>
          <blockquote>
              <p>[quote=“xEnt, post:36, topic:389968”][quote author=IlikeArrays link=topic=485877.msg3575639#msg3575639 date=1303402097]</p>
<aside class="quote">
<blockquote>
<p>If we’re making RSC private servers then it’s best to do it as close to how we know it was done on RSC. It was done via PID (well, experience sharing was anyway). You could login with someone else’s PID and get their experience.</p>
</blockquote>
</aside>
<p>PID system will never be replicated, reason being nobody knows EXACTLY how it worked. Also there were a few negatives about it which Andrew talked about and why he removed it.<br>
[/quote]</p>
<p>making that system was easy. the RSC server had the same 600ms game loop that we have, therefore if pid2 talks to a banker before pid1 does, as long as they are in the same engine loop, the lower pid will be processed first.</p>
<p>the current system is much better, but getting that old system back takes 2 minutes.[/quote]</p>
<p>Your forgetting the pking sides of things, if you had a lower pid you could catch further but only in certain directions (see we don’t know) gonna have to take some research for that information. It affected more than just clicking.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/38">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/38</link>
        <pubDate>Fri, 22 Apr 2011 16:20:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-38</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>[quote=“Kryptix, post:8, topic:390080”]On RSCE it’s constantly just increased every login (I just checked) so I presume 1,100+ logins have occurred:</p>
<p><img src="http://img821.imageshack.us/img821/4355/unleddq.png" alt width="" height=""></p>
<p>I’m not sure if Zilent changed anything in that aspect, I personally haven’t touched that side of things so no idea if it’s the same as RSCD or not to be honest.[/quote]<br>
ArrayLists are…very random it seems.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/37">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/37</link>
        <pubDate>Fri, 22 Apr 2011 10:57:51 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-37</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@xEnt xEnt]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/xent">@xEnt</a> wrote:</p>
          <blockquote>
              <p>[quote=“IlikeArrays, post:29, topic:389968”][quote author=Kryptix link=topic=485877.msg3575585#msg3575585 date=1303396910]<br>
If we’re making RSC private servers then it’s best to do it as close to how we know it was done on RSC. It was done via PID (well, experience sharing was anyway). You could login with someone else’s PID and get their experience.<br>
[/quote]</p>
<p>PID system will never be replicated, reason being nobody knows EXACTLY how it worked. Also there were a few negatives about it which Andrew talked about and why he removed it.[/quote]</p>
<p>making that system was easy. the RSC server had the same 600ms game loop that we have, therefore if pid2 talks to a banker before pid1 does, as long as they are in the same engine loop, the lower pid will be processed first.</p>
<p>the current system is much better, but getting that old system back takes 2 minutes.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/36">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/36</link>
        <pubDate>Fri, 22 Apr 2011 04:55:36 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-36</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@nacional nacional]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nacional">@nacional</a> wrote:</p>
          <blockquote>
              <p>I remember in kingpk you would get a PID in the thousands. I really don’t think it has anything to do with how many are online at the time.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/35">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/35</link>
        <pubDate>Fri, 22 Apr 2011 03:51:50 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-35</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@imthenull imthenull]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/imthenull">@imthenull</a> wrote:</p>
          <blockquote>
              <p>[quote=“Kryptix, post:8, topic:390080”]On RSCE it’s constantly just increased every login (I just checked) so I presume 1,100+ logins have occurred:</p>
<p><img src="http://img821.imageshack.us/img821/4355/unleddq.png" alt width="" height=""></p>
<p>I’m not sure if Zilent changed anything in that aspect, I personally haven’t touched that side of things so no idea if it’s the same as RSCD or not to be honest.[/quote]<br>
I’m pretty sure it is…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/34">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/34</link>
        <pubDate>Fri, 22 Apr 2011 03:01:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-34</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>Finally I see a topic where people talk about programming instead of just trolling/spamming. Keep the converstation going <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/33">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/33</link>
        <pubDate>Thu, 21 Apr 2011 21:13:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-33</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“Peeter, post:28, topic:389968”][quote author=CodeForFame link=topic=485877.msg3575529#msg3575529 date=1303393890]</p>
<aside class="quote">
<blockquote>
<p>So now you have a system where after a player does 99% damage the a NPC, lags out and comes back in and sees a guy shooting the NPC once &amp; getting all the loot. After someone makes a bug report about it, do you call it a “feature”?</p>
</blockquote>
</aside>
<p>Please learn how to read…</p>
<aside class="quote">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/codeforfame/40/3743_1.png" class="avatar"> CodeForFame:</div>
<blockquote>
<p>Also, if you’re going to complain that the initial attack[er] won’t get his shit because he logged, then who cares?  You didn’t always get it on classic, because it was given to the person who had your PID.</p>
</blockquote>
</aside>
<p>[/quote]</p>
<p>I did read, however you still didn’t answer my question.</p>
<aside class="quote">
<blockquote>
<p>At this point you’re just arguing over semantic now that I’ve made a fool out of you.</p>
<p>Let me remind you of what you said, seeing you obviously don’t remember:</p>
<aside class="quote">
<div class="title">
<div class="quote-controls"></div>
 Peeter:</div>
<blockquote>
<p><a class="mention" href="/u/edit1">@Edit1</a>: I wouldn’t use a weakhashmap as it’ll lead to some weird behavior. Person A has shot a NPC to 1 health, GC comes in and cleans your map, Person B shoots a single arrow shot to the NPC and gets the loot. Person A and B both report the bug, but you cannot reproduce it because whenever you test for it, the GC isn’t cleaning your map.</p>
</blockquote>
</aside>
<p>It doesn’t lead to ‘weird’ behavior.  It leads to nearly identical behavior of classic, minus random people getting unwanted XP.  Also, if you actually implement it correctly the people who don’t deserve the drop shouldn’t be getting it instantly.  In addition, you claimed that the GC would just come in and clear your map for no reason what-so-ever; that is not even remotely true.  Then, you had the audacity to imply that it would be difficult to debug, when according to you, that’s the expected behavior…</p>
</blockquote>
</aside>
<p>Actually I was talking about using longs as keys, not players. I assumed that longs would be automatically cleaned as primitives are passed by value and not by reference, but it turns out it’s actually the other way around - they’re never cleaned.</p>
<aside class="quote">
<blockquote>
<p>Anyway, I find it quite funny that I’m arguing for an obviously flawed system, and you can’t even point out the flaws…  Anyone who actually knows how to program would nearly instantly realize what I’ve done (just to prove you wrong) has a terrible design (like I’ve already stated), and be able to point out why it’s terrible.</p>
</blockquote>
</aside>
<p>Oeh you assume a bit too much.</p>
<p>@-Nothing: No.[/quote]</p>
<p>It depends on what you’re personally classing as a feature…  I would say, “You didn’t always get it on classic, because it was given to the person who had your PID.  So, it’s like RSC without the annoyance of unwanted XP.”</p>
<p>If you had fully read, and understood both of those posts you would see the question was already answered.  The bit about not getting unwanted XP was obvious, if you actually understood what the code was doing…</p>
<p>For one, Longs are not primitives, longs are.  You can’t store primitives in a collection like that, because whatever is being stored in it must be an object.  If you knew how autoboxing worked, then you’d realize that when something is autoboxed it’s simply wrapped in a new object.  So, what you need to do is avoid that…  When the player name is set, you can hash it, and have boxed version that is used when you need a boxed version of it.</p>
<p>So, when you actually do it properly, it behaves the same way as it would with any other type of object, because you’re storing an object, not a primitive.  Either way, you were still wrong.</p>
<p>What am I assuming?  I know for a fact that what I wrote has major design flaws, and you’re pointing out things that are completely irrelevant and trivial.  If you really noticed the flaws you’d point them out straight away, because they’re so major; you would also realize that your design shares many of the same flaws mine does, but yours has some extras tossed in.  So, if I’m really making incorrect assumptions, feel free to point out all the design flaws.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/32">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/32</link>
        <pubDate>Thu, 21 Apr 2011 19:09:53 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-32</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@IlikeArrays IlikeArrays]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilikearrays">@IlikeArrays</a> wrote:</p>
          <blockquote>
              <blockquote>On RSCD it's first click, first serve which I think is the correct approach.</blockquote>
<p>Agreed.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/31">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/31</link>
        <pubDate>Thu, 21 Apr 2011 18:30:23 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-31</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>We could do our best to replicate it. And modify it whenever we see something that was or wasn’t there in RSC</p>
<p><a class="mention" href="/u/kryptix">@Kryptix</a>:<br>
serverIndex in RSCD is just an index so clients can interact with eachother, when in RSC it was used for much more things, and serverIndex means the same as playerIndex.</p>
<p>Gonna look at how RSCD assigns the indexes…sec.</p>
<p>EDIT: RSCD just adds the player into top of the players array, and the serverindex will be their position in this array, so it’s pretty much random if you have loads of players online.</p>
<p>EDIT2: <a class="mention" href="/u/kryptix">@Kryptix</a>: Why do you get ID like ‘2,957’ if you have about 100-300 players online, that doesn’t make sense at all. Are you sure that all the players are correctly removed from the ‘players’ array on logout?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/30">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/30</link>
        <pubDate>Thu, 21 Apr 2011 17:01:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-30</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@IlikeArrays IlikeArrays]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilikearrays">@IlikeArrays</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="6" data-topic="390080">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/kryptix/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar">
</div>
<blockquote>
<p>If we’re making RSC private servers then it’s best to do it as close to how we know it was done on RSC. It was done via PID (well, experience sharing was anyway). You could login with someone else’s PID and get their experience.</p>
</blockquote>
</aside>
<p>PID system will never be replicated, reason being nobody knows EXACTLY how it worked. Also there were a few negatives about it which Andrew talked about and why he removed it.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/29">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/29</link>
        <pubDate>Thu, 21 Apr 2011 16:08:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-29</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@Peter Peeter]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/peter">@Peter</a> wrote:</p>
          <blockquote>
              <p>[quote=“CodeForFame, post:27, topic:389968”][quote author=Peeter link=topic=485877.msg3575289#msg3575289 date=1303372784]<br>
So now you have a system where after a player does 99% damage the a NPC, lags out and comes back in and sees a guy shooting the NPC once &amp; getting all the loot. After someone makes a bug report about it, do you call it a “feature”?<br>
[/quote]</p>
<p>Please learn how to read…</p>
<aside class="quote">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/codeforfame/40/3743_1.png" class="avatar"> CodeForFame:</div>
<blockquote>
<p>Also, if you’re going to complain that the initial attack[er] won’t get his shit because he logged, then who cares?  You didn’t always get it on classic, because it was given to the person who had your PID.[/quote]</p>
</blockquote>
</aside>
<p>I did read, however you still didn’t answer my question.</p>
<p>[quote=“CodeForFame, post:27, topic:389968”]At this point you’re just arguing over semantic now that I’ve made a fool out of you.</p>
<p>Let me remind you of what you said, seeing you obviously don’t remember:</p>
<aside class="quote">
<div class="title">
<div class="quote-controls"></div>
 Peeter:</div>
<blockquote>
<p><a class="mention" href="/u/edit1">@Edit1</a>: I wouldn’t use a weakhashmap as it’ll lead to some weird behavior. Person A has shot a NPC to 1 health, GC comes in and cleans your map, Person B shoots a single arrow shot to the NPC and gets the loot. Person A and B both report the bug, but you cannot reproduce it because whenever you test for it, the GC isn’t cleaning your map.</p>
</blockquote>
</aside>
<p>It doesn’t lead to ‘weird’ behavior.  It leads to nearly identical behavior of classic, minus random people getting unwanted XP.  Also, if you actually implement it correctly the people who don’t deserve the drop shouldn’t be getting it instantly.  In addition, you claimed that the GC would just come in and clear your map for no reason what-so-ever; that is not even remotely true.  Then, you had the audacity to imply that it would be difficult to debug, when according to you, that’s the expected behavior…[/quote]</p>
<p>Actually I was talking about using longs as keys, not players. I assumed that longs would be automatically cleaned as primitives are passed by value and not by reference, but it turns out it’s actually the other way around - they’re never cleaned.</p>
<aside class="quote quote-modified" data-post="27" data-topic="389968">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/codeforfame/40/3743_1.png" class="avatar"> CodeForFame:</div>
<blockquote>
<p>Anyway, I find it quite funny that I’m arguing for an obviously flawed system, and you can’t even point out the flaws…  Anyone who actually knows how to program would nearly instantly realize what I’ve done (just to prove you wrong) has a terrible design (like I’ve already stated), and be able to point out why it’s terrible.</p>
</blockquote>
</aside>
<p>Oeh you assume a bit too much.</p>
<p>@-Nothing: No.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/28">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/28</link>
        <pubDate>Thu, 21 Apr 2011 16:03:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-28</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="25" data-topic="389968">
<div class="title">
<div class="quote-controls"></div>
 Peeter:</div>
<blockquote>
<p>So now you have a system where after a player does 99% damage the a NPC, lags out and comes back in and sees a guy shooting the NPC once &amp; getting all the loot. After someone makes a bug report about it, do you call it a “feature”?</p>
</blockquote>
</aside>
<p>Please learn how to read…</p>
<blockquote>Also, if you're going to complain that the initial attack[er] won't get his shit because he logged, then who cares?  You didn't always get it on classic, because it was given to the person who had your PID.</blockquote>
<p>At this point you’re just arguing over semantic now that I’ve made a fool out of you.</p>
<p>Let me remind you of what you said, seeing you obviously don’t remember:</p>
<blockquote>@Edit1: I wouldn't use a weakhashmap as it'll lead to some weird behavior. Person A has shot a NPC to 1 health, GC comes in and cleans your map, Person B shoots a single arrow shot to the NPC and gets the loot. Person A and B both report the bug, but you cannot reproduce it because whenever you test for it, the GC isn't cleaning your map.</blockquote>
<p>It doesn’t lead to ‘weird’ behavior.  It leads to nearly identical behavior of classic, minus random people getting unwanted XP.  Also, if you actually implement it correctly the people who don’t deserve the drop shouldn’t be getting it instantly.  In addition, you claimed that the GC would just come in and clear your map for no reason what-so-ever; that is not even remotely true.  Then, you had the audacity to imply that it would be difficult to debug, when according to you, that’s the expected behavior…</p>
<p>Anyway, I find it quite funny that I’m arguing for an obviously flawed system, and you can’t even point out the flaws…  Anyone who actually knows how to program would nearly instantly realize what I’ve done (just to prove you wrong) has a terrible design (like I’ve already stated), and be able to point out why it’s terrible.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/27">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/27</link>
        <pubDate>Thu, 21 Apr 2011 13:51:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-27</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="25" data-topic="389968">
<div class="title">
<div class="quote-controls"></div>
 Peeter:</div>
<blockquote>
<p>So now you have a system where after a player does 99% damage the a NPC, lags out and comes back in and sees a guy shooting the NPC once &amp; getting all the loot. After someone makes a bug report about it, do you call it a “feature”?</p>
</blockquote>
</aside>
<p>Like your little ArrayList system doesn’t do that…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/26">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/26</link>
        <pubDate>Thu, 21 Apr 2011 10:32:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-26</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@Peter Peeter]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/peter">@Peter</a> wrote:</p>
          <blockquote>
              <p>So now you have a system where after a player does 99% damage the a NPC, lags out and comes back in and sees a guy shooting the NPC once &amp; getting all the loot. After someone makes a bug report about it, do you call it a “feature”?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/25">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/25</link>
        <pubDate>Thu, 21 Apr 2011 07:59:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-25</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“Peeter, post:22, topic:389968”][quote author=-Nothing link=topic=485877.msg3574197#msg3574197 date=1303288449]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>and to fix that, don’t use arraylist</p>
</blockquote>
</aside>
<p>What? Why?</p>
</blockquote>
</aside>
<p>Easier to use HashMap, in this case in Mob class I would do ‘HashMap&lt;Player, Integer&gt;’ and simply edit the integer when player hits again. Then upon death of NPC I would loop the HashMap and search for the Player who has hitted most and give him the drop, then clearing the HashMap.</p>
<p>Sounds easier to me, but then again, everybody has their own opinions.</p>
</blockquote>
</aside>
<p>Wrong, you just created a leak. If the player logs out he’s nolonger refrenced in the player list @ world class, but still refrenced in the hashmap. That means all the refrences the player holds are still there.</p>
<p>A better implementation can be seen at <a href="http://www.assembla.com/code/darkquest/subversion/nodes/DarkQuest/src/org/darkquest/gs/model/Npc.java?rev=80" rel="nofollow noopener">http://www.assembla.com/code/darkquest/subversion/nodes/DarkQuest/src/org/darkquest/gs/model/Npc.java?rev=80</a> (scroll to the end of the class).</p>
</blockquote>
</aside>
<p>Of course you remove it on logout. Duhh.</p>
</blockquote>
</aside>
<p>Are you going to iterate over every single NPC to remove the reference in the list each time a player logs out?</p>
</blockquote>
</aside>
<p>I could create a variable on <span class="bbcode-i">Player</span> class to know which position the <span class="bbcode-i">Player</span> is at on the <span class="bbcode-i">NPC</span>’s hit record <span class="bbcode-i">HashMap</span> and then keep track on NPCs player has hitted and remove it on logout.</p>
<pre><code class="lang-auto">for(NPC npc : hittedNPCs) {
	npc.get(this).remove();
}</code></pre>
<p>EDIT: Or just use <span class="bbcode-i">WeakHashMap</span> like CodeForFame said.</p>
<p>EDIT2: On your hit record system, why there’s <span class="bbcode-i">mageDamage</span> seperately, it should be put on <span class="bbcode-i">combatDamage</span>.</p>
<p>[/quote]</p>
<p>Reversed problem, going to iterate over players when a NPC is killed?</p>
<p><a class="mention" href="/u/edit1">@Edit1</a>: I wouldn’t use a weakhashmap as it’ll lead to some weird behavior. Person A has shot a NPC to 1 health, GC comes in and cleans your map, Person B shoots a single arrow shot to the NPC and gets the loot. Person A and B both report the bug, but you cannot reproduce it because whenever you test for it, the GC isn’t cleaning your map.</p>
<p>Edit2: You shouldn’t get combat XP from maging someone. Nor vica verca. [/quote]</p>
<p>The GC isn’t going to come in and clear your map for no reason.  If a player logs out (and is able to be cleaned up), then it can clear that entry, but it’s not going to randomly clear the map for no reason, nor will it randomly clear entries from the map.</p>
<p>Seeing you won’t understand this, here is a poorly written example (it’s not like you know the difference between poorly written code and well written code anyway…):</p>
<p>[code]import java.util.Random;<br>
import java.util.WeakHashMap;</p>
<p>public class Npc {</p>
<pre><code>private final WeakHashMap&lt;Player, Damage&gt; damage = new WeakHashMap&lt;Player, Damage&gt;();
private static final Random RAND = new Random();

public void addDamage(final Player player, final int damage,
		final int damageType) {
	final Damage PREV = this.damage.get(player);
	if (PREV != null) {
		PREV.addDamage(damage, damageType);
	} else {
		this.damage.put(player, new Damage(damage, damageType));
	}
}

public int getTotalCombatDamage() {
	int total = 0;
	for (final Player p : damage.keySet()) {
		total += damage.get(p).getCombatDamage();
	}
	return total;
}

public void populateDamage() {
	for (final Player p : Player.players)
		addDamage(p, 1, Damage.COMBAT_DAMAGE);
}

public boolean stillWorks() {
	encourageGC();
	return working();

}

private final boolean working() {
	for (final Player p : Player.players) {
		try {
			damage.get(p).getCombatDamage();
		} catch (Exception e) {
			System.out
					.println("HOLY FUCKING HELL!!!  Magic just happened!");
			return false;
		}
	}
	return true;
}

private final void encourageGC() {
	int val = RAND.nextInt(10);
	while (true) {
		if (val == 4) {
			System.gc();
			break;
		} else {
			new OtherComputation().run(val);
			System.gc();
		}
		val = RAND.nextInt(10);
	}
}
</code></pre>
<p>}<br>
[/code]</p>
<p>[code]import java.util.ArrayList;</p>
<p>public class Player {</p>
<pre><code>public static ArrayList&lt;Player&gt; players = new ArrayList&lt;Player&gt;();
public final int id;

public Player(final int id) {
	this.id = id;
}
</code></pre>
<p>}<br>
[/code]</p>
<p>[code]public class Damage {<br>
public static final int COMBAT_DAMAGE = 0;<br>
public static final int MAGIC_DAMAGE = 1;<br>
public static final int RANGE_DAMAGE = 2;</p>
<pre><code>private final int[] damage = new int[3];


public Damage(final int damage, final int type) {
	this.addDamage(damage, type);
}

public int getMagicDamage() {
	return damage[MAGIC_DAMAGE];
}

public void setMagicDamage(final int damage) {
	this.damage[MAGIC_DAMAGE] = damage;
}

public void addMagicDamage(final int damage) {
	this.damage[MAGIC_DAMAGE] += damage;
}

public int getRangeDamage() {
	return this.damage[RANGE_DAMAGE];
}

public void setRangeDamage(final int damage) {
	this.damage[RANGE_DAMAGE] = damage;
}

public void addRangeDamage(final int damage) {
	this.damage[RANGE_DAMAGE] += damage;
}

public int getCombatDamage() {
	return damage[COMBAT_DAMAGE];
}

public void setCombatDamage(final int damage) {
	this.damage[COMBAT_DAMAGE] = damage;
}

public void addCombatDamage(final int damage) {
	this.damage[COMBAT_DAMAGE] += damage;
}

public void addDamage(final int damage, final int damageType) {
	// CBF typing out legit bounds checking...
	this.damage[damageType % 3] += damage;
}
</code></pre>
<p>}<br>
[/code]</p>
<p>[code]public class OtherComputation {<br>
public final void run(final int n) {<br>
// Anything over 12 is greater than the max value for an int…<br>
factorial(n % 12);<br>
}</p>
<pre><code>	private int factorial(final int n) {
		if (n &lt;= 1) {
			return 1;
		}
		return n * factorial(n - 1);
	}
}[/code]
</code></pre>
<p>[code]public class Test {</p>
<pre><code>private static final Npc[] ns = new Npc[10];
private static final int ITERATIONS = 10;

public static void main(String[] args) {

	for (int i = 0; i &lt; 10; i++) {
		Player.players.add(new Player(i));
	}

	for (int i = 0; i &lt; ns.length; i++) {
		ns[i] = new Npc();
		ns[i].populateDamage();
	}
	System.out.println("Initial damages");
	printDamages();

	System.out.println("Initial check");
	checkForRemovedEntries();

	encourageGC();

	System.out.println("Removing some players");
	Player.players.remove(7);
	Player.players.remove(0);
	Player.players.remove(4);

	printDamages();

	encourageGC();

	System.out.println("Final check");
	checkForRemovedEntries();
}

private static final void checkForRemovedEntries() {
	for (int i = 0; i &lt; ITERATIONS; i++) {
		for (final Npc n : ns) {
			if (!n.stillWorks()) {
				return;
			}
		}
	}
	printDamages();
}

private static final void encourageGC() {
	System.out.println("Encouraging GC");
	for (int i = 0; i &lt; ITERATIONS * 10; i++) {
		new OtherComputation().run(i);
		System.gc();
	}
	printDamages();
}

private static final void printDamages() {
	for (int i = 0; i &lt; 10; i++) {
		System.out.println(i + " - " + ns[i].getTotalCombatDamage());
	}
}
</code></pre>
<p>}<br>
[/code]</p>
<p>VM args (to show it did GC, when, and to essentially force it):<br>
-verbose:gc -Xloggc:log.log -XX:+PrintGCDetails -Xmx4097k -XX:NewSize=192k</p>
<p>Output (it GC’d a few thousand times, if you want run it yourself and check the logs):</p>
<p><code>
Initial damages
0 - 10
1 - 10
2 - 10
3 - 10
4 - 10
5 - 10
6 - 10
7 - 10
8 - 10
9 - 10
Initial check
0 - 10
1 - 10
2 - 10
3 - 10
4 - 10
5 - 10
6 - 10
7 - 10
8 - 10
9 - 10
Encouraging GC
0 - 10
1 - 10
2 - 10
3 - 10
4 - 10
5 - 10
6 - 10
7 - 10
8 - 10
9 - 10
Removing some players
0 - 10
1 - 10
2 - 10
3 - 10
4 - 10
5 - 10
6 - 10
7 - 10
8 - 10
9 - 10
Encouraging GC
0 - 7
1 - 7
2 - 7
3 - 7
4 - 7
5 - 7
6 - 7
7 - 7
8 - 7
9 - 7
Final check
0 - 7
1 - 7
2 - 7
3 - 7
4 - 7
5 - 7
6 - 7
7 - 7
8 - 7
9 - 7</code></p>
<p>Also, if you’re going to complain that the initial attack won’t get his shit because he logged, then who cares?  You didn’t always get it on classic, because it was given to the person who had your PID.</p>
<p>In addition, I’m not saying it’s correct to use the player as the key, but it doesn’t fuck up when you do.  At least not in the way you’re claiming…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/24">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/24</link>
        <pubDate>Wed, 20 Apr 2011 18:31:37 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-24</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>[quote=“Peeter, post:22, topic:389968”][quote author=-Nothing link=topic=485877.msg3574197#msg3574197 date=1303288449]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>and to fix that, don’t use arraylist</p>
</blockquote>
</aside>
<p>What? Why?</p>
</blockquote>
</aside>
<p>Easier to use HashMap, in this case in Mob class I would do ‘HashMap&lt;Player, Integer&gt;’ and simply edit the integer when player hits again. Then upon death of NPC I would loop the HashMap and search for the Player who has hitted most and give him the drop, then clearing the HashMap.</p>
<p>Sounds easier to me, but then again, everybody has their own opinions.</p>
</blockquote>
</aside>
<p>Wrong, you just created a leak. If the player logs out he’s nolonger refrenced in the player list @ world class, but still refrenced in the hashmap. That means all the refrences the player holds are still there.</p>
<p>A better implementation can be seen at <a href="http://www.assembla.com/code/darkquest/subversion/nodes/DarkQuest/src/org/darkquest/gs/model/Npc.java?rev=80" rel="nofollow noopener">http://www.assembla.com/code/darkquest/subversion/nodes/DarkQuest/src/org/darkquest/gs/model/Npc.java?rev=80</a> (scroll to the end of the class).</p>
</blockquote>
</aside>
<p>Of course you remove it on logout. Duhh.</p>
</blockquote>
</aside>
<p>Are you going to iterate over every single NPC to remove the reference in the list each time a player logs out?</p>
</blockquote>
</aside>
<p>I could create a variable on <span class="bbcode-i">Player</span> class to know which position the <span class="bbcode-i">Player</span> is at on the <span class="bbcode-i">NPC</span>’s hit record <span class="bbcode-i">HashMap</span> and then keep track on NPCs player has hitted and remove it on logout.</p>
<pre><code class="lang-auto">for(NPC npc : hittedNPCs) {
	npc.get(this).remove();
}</code></pre>
<p>EDIT: Or just use <span class="bbcode-i">WeakHashMap</span> like CodeForFame said.</p>
<p>EDIT2: On your hit record system, why there’s <span class="bbcode-i">mageDamage</span> seperately, it should be put on <span class="bbcode-i">combatDamage</span>.</p>
<p>[/quote]</p>
<p>Reversed problem, going to iterate over players when a NPC is killed?</p>
<p><a class="mention" href="/u/edit1">@Edit1</a>: I wouldn’t use a weakhashmap as it’ll lead to some weird behavior. Person A has shot a NPC to 1 health, GC comes in and cleans your map, Person B shoots a single arrow shot to the NPC and gets the loot. Person A and B both report the bug, but you cannot reproduce it because whenever you test for it, the GC isn’t cleaning your map.</p>
<p>Edit2: You shouldn’t get combat XP from maging someone. Nor vica verca. [/quote]<br>
I would iterate the players that are in the HashMap in the NPC class.<br>
Alternative way for removing: I also could remove the player from the HashMap when NPC is killed, if the player doesn’t exist in world, remove it and give the drop to next person who did highest damage.</p>
<p>@ Your Edit2: Oops, that’s right, my bad.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/23">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/23</link>
        <pubDate>Wed, 20 Apr 2011 12:51:06 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-23</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
      <item>
        <title>Rscd v25 memory leak</title>
        <dc:creator><![CDATA[@Peter Peeter]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/peter">@Peter</a> wrote:</p>
          <blockquote>
              <p>[quote="-Nothing, post:21, topic:389968"][quote author=Peeter link=topic=485877.msg3574109#msg3574109 date=1303280769]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>and to fix that, don’t use arraylist</p>
</blockquote>
</aside>
<p>What? Why?</p>
</blockquote>
</aside>
<p>Easier to use HashMap, in this case in Mob class I would do ‘HashMap&lt;Player, Integer&gt;’ and simply edit the integer when player hits again. Then upon death of NPC I would loop the HashMap and search for the Player who has hitted most and give him the drop, then clearing the HashMap.</p>
<p>Sounds easier to me, but then again, everybody has their own opinions.</p>
</blockquote>
</aside>
<p>Wrong, you just created a leak. If the player logs out he’s nolonger refrenced in the player list @ world class, but still refrenced in the hashmap. That means all the refrences the player holds are still there.</p>
<p>A better implementation can be seen at <a href="http://www.assembla.com/code/darkquest/subversion/nodes/DarkQuest/src/org/darkquest/gs/model/Npc.java?rev=80">http://www.assembla.com/code/darkquest/subversion/nodes/DarkQuest/src/org/darkquest/gs/model/Npc.java?rev=80</a> (scroll to the end of the class).</p>
</blockquote>
</aside>
<p>Of course you remove it on logout. Duhh.</p>
</blockquote>
</aside>
<p>Are you going to iterate over every single NPC to remove the reference in the list each time a player logs out?<br>
[/quote]<br>
I could create a variable on <span class="bbcode-i">Player</span> class to know which position the <span class="bbcode-i">Player</span> is at on the <span class="bbcode-i">NPC</span>’s hit record <span class="bbcode-i">HashMap</span> and then keep track on NPCs player has hitted and remove it on logout.</p>
<pre><code class="lang-auto">for(NPC npc : hittedNPCs) {
	npc.get(this).remove();
}</code></pre>
<p>EDIT: Or just use <span class="bbcode-i">WeakHashMap</span> like CodeForFame said.</p>
<p>EDIT2: On your hit record system, why there’s <span class="bbcode-i">mageDamage</span> seperately, it should be put on <span class="bbcode-i">combatDamage</span>.[/quote]</p>
<p>Reversed problem, going to iterate over players when a NPC is killed?</p>
<p><a class="mention" href="/u/edit1">@Edit1</a>: I wouldn’t use a weakhashmap as it’ll lead to some weird behavior. Person A has shot a NPC to 1 health, GC comes in and cleans your map, Person B shoots a single arrow shot to the NPC and gets the loot. Person A and B both report the bug, but you cannot reproduce it because whenever you test for it, the GC isn’t cleaning your map.</p>
<p>Edit2: You shouldn’t get combat XP from maging someone. Nor vica verca.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/22">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968/22</link>
        <pubDate>Wed, 20 Apr 2011 10:44:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-389968-22</guid>
        <source url="https://forum.moparisthebest.com/t/rscd-v25-memory-leak/389968.rss">Rscd v25 memory leak</source>
      </item>
  </channel>
</rss>
