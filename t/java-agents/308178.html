<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/java-agents/308178 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 03:15:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Java Agents - Runescape - moparisthebest.com</title>
    <meta name="description" content="First of all, I want this to be a discussion about the subject matter, not a flame fest or people pretending that they know what they are talking about when they do not.  If you don&amp;#39;t know what we are discussing then ple&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="308178.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Java Agents&#39;" href="308178.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/java-agents/308178" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/java-agents/308178" />
<meta property="og:title" content="Java Agents" />
<meta name="twitter:title" content="Java Agents" />
<meta property="og:description" content="First of all, I want this to be a discussion about the subject matter, not a flame fest or people pretending that they know what they are talking about when they do not.  If you don’t know what we are discussing then please leave without posting, no one will even know you seen this.  Anyways, I am hoping to have an intelligent discussion about the use of java-agents for client hacking.  Lately there has been a somewhat larger demand for a way to hijack the currently running JVM instead of using ..." />
<meta name="twitter:description" content="First of all, I want this to be a discussion about the subject matter, not a flame fest or people pretending that they know what they are talking about when they do not.  If you don’t know what we are discussing then please leave without posting, no one will even know you seen this.  Anyways, I am hoping to have an intelligent discussion about the use of java-agents for client hacking.  Lately there has been a somewhat larger demand for a way to hijack the currently running JVM instead of using ..." />
<meta property="article:published_time" content="2009-10-12T20:19:05+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="308178.html">Java Agents</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/the_bank.html'><span itemprop='name'>the_bank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-12T20:19:05Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:44:36Z' class='post-time'>
              July 31, 2016, 11:44am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>First of all, I want this to be a discussion about the subject matter, not a flame fest or people pretending that they know what they are talking about when they do not.  If you don’t know what we are discussing then please leave without posting, no one will even know you seen this.</p>
<p>Anyways, I am hoping to have an intelligent discussion about the use of java-agents for client hacking.</p>
<p>Lately there has been a somewhat larger demand for a way to hijack the currently running JVM instead of using other more widely known methods.  The most immediate way to do this that people usually think of would be to attach a java-agent.  Even though I believe this rise in demand is only due to people wanting to stand out and appear different, I also see it as a way for people to learn to use a tool that they wouldn’t have previously had any exposure to.</p>
<p>Problem is, I always believed that java-agents are (theoretically) detectable with things like <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Package.html#getPackages%28%29" data-bbcode="true" rel="nofollow noopener">this</a>.  However, people are now saying that they are safe.  This debate is what sparked the creation of this thread.</p>
<p>Lets discuss java-agents some.  What are some means to creating safer java-agents?  What are <span class="bbcode-b">theoretical (its possible to detect)</span> and <span class="bbcode-b">factual (it is detected by the client)</span> detection schemes that Jagex could/are using.  Are there other ways which are less detectable in both manners?</p>
<p>Discuss.</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-12T20:50:04Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:44:40Z' class='post-time'>
              July 31, 2016, 11:44am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>as far as I know, there is no method that retrieves a list of java agents attached to the jvm. therefore, it’s like reflection.</p>
<p>however, like someone stated, they <span class="bbcode-i">can</span> get the class loader and detect loaded classes (which will include the java agent’s). but, can this really be a way to detect a macro? how is jagex going to know which classes are sun’s and which classes are not? they will have to keep up-to-date with each bot, so I highly doubt they will do this. we can break this completely by setting our class package to sun’s or even giving it a RuneScape-like deobfuscated name (<span class="bbcode-i">ed, as, ji, zx, lk</span>).</p>
<p>other than that [stupid, unreliable] method, I don’t see how a java agent can be detected.</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-12T21:04:41Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:44:40Z' class='post-time'>
              July 31, 2016, 11:44am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Tenen, post:2, topic:308178”]as far as I know, there is no method that retrieves a list of java agents attached to the jvm. therefore, it’s like reflection.</p>
<p>however, like someone stated, they <span class="bbcode-i">can</span> get the class loader and detect loaded classes (which will include the java agent’s). but, can this really be a way to detect a macro? how is jagex going to know which classes are sun’s and which classes are not? they will have to keep up-to-date with each bot, so I highly doubt they will do this. we can break this completely by setting our class package to sun’s or even giving it a RuneScape-like deobfuscated name (<span class="bbcode-i">ed, as, ji, zx, lk</span>).</p>
<p>other than that [stupid, unreliable] method, I don’t see how a java agent can be detected.[/quote]they could just count the amount of defined classes and compare it with the amount of classes in the current client</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ownagesbot.html'><span itemprop='name'>ownagesbot</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-12T21:09:00Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:44:41Z' class='post-time'>
              July 31, 2016, 11:44am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“abraham2119, post:3, topic:308178”][quote author=Tenen link=topic=404310.msg2992704#msg2992704 date=1255380604]<br>
as far as I know, there is no method that retrieves a list of java agents attached to the jvm. therefore, it’s like reflection.</p>
<p>however, like someone stated, they <span class="bbcode-i">can</span> get the class loader and detect loaded classes (which will include the java agent’s). but, can this really be a way to detect a macro? how is jagex going to know which classes are sun’s and which classes are not? they will have to keep up-to-date with each bot, so I highly doubt they will do this. we can break this completely by setting our class package to sun’s or even giving it a RuneScape-like deobfuscated name (<span class="bbcode-i">ed, as, ji, zx, lk</span>).</p>
<p>other than that [stupid, unreliable] method, I don’t see how a java agent can be detected.<br>
[/quote]they could just count the amount of defined classes and compare it with the amount of classes in the current client[/quote]They could, but do they do it now? If not it’s viable. I doubt this idea will kickoff but meh. It should even be possible to counter that style detection by spoofing shit. Idk. Idc. But quite frankly this wont be a big hit.</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-12T21:21:33Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:44:43Z' class='post-time'>
              July 31, 2016, 11:44am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>that’s one solution possibly ruined. but, it all comes down to the main questions: would they do this? would they go to such extremes? and, is it really a reliable source?</p>
<p>also, what about the other way? they don’t know which classes the jre loads (different OS, architecture, versions, implementations). so, we could always make up professional-sounding names…</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/the_bank.html'><span itemprop='name'>the_bank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-12T23:09:58Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:44:56Z' class='post-time'>
              July 31, 2016, 11:44am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I was thinking along the lines of Tenen.  The number of classes, and their relative names, would obviously chance according to the current java version.</p>
<p>As for whether they would go to such “extremes”.  Of course they would.  First off, it really isn’t that extreme when you think about it.  However on top of that, I’m sure they already have much more advanced systems in place for detecting other macros, a simple (in comparison) change to their systems to also find java-agents is very plausible.  I believe it is good practice to never rule anything out, no matter how far fetched it is.</p>
<p>Anyways, the obvious naming solution in my mind would be to name it a sun-related class.  However, jagex <span class="bbcode-b">could</span> (call me crazy but like I said…never rule anything out) keep track of the number of classes and/or their relative names for every java version and compare the values at runtime.</p>
<p>Which is why I believe it would be smarter to name the java-agent something more fitting of an external library.  Does anyone know of an external library which some people may have that would be included directly into the jre/jdk (yes I suppose it does defy the purpose of “external”)?</p>
<p>And on another point, are there other tools for this purpose which are more effective?</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/nueb35.html'><span itemprop='name'>nueb35</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-13T05:58:33Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:45:30Z' class='post-time'>
              July 31, 2016, 11:45am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>if jagex implements any of these, with the java agent and the bcel included with the jre, it would be very easy to remove these methods of checking so why even implement them?</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-13T07:00:47Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:45:32Z' class='post-time'>
              July 31, 2016, 11:45am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Package.getPackages() only returns the packages loaded by the calling class’ classloader and its ancestors</p>
<p>that said, to do anything useful you need to have at least one class inside their default package (thus inside their classloader)</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BAsh.html'><span itemprop='name'>BAsh</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-13T07:17:32Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:45:32Z' class='post-time'>
              July 31, 2016, 11:45am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="8" data-topic="308178">
<div class="title">
<div class="quote-controls"></div>
 frank_:</div>
<blockquote>
<p>that said, to do anything useful you need to have at least one class inside their default package (thus inside their classloader)</p>
</blockquote>
</aside>
<p>Could JNI help? Or is this a chicken and egg problem?</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-13T07:50:24Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:45:33Z' class='post-time'>
              July 31, 2016, 11:45am
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>maybe, but the classloader keeps a static vector of loaded native libraries that jagex do access when cleaning up</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/semaphore.html'><span itemprop='name'>semaphore</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-26T11:16:44Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:06:07Z' class='post-time'>
              July 31, 2016, 12:06pm
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’m failing to see any real problem here as the only mechanisms you can use to inspect the loaded classes are easily circumvented.</p>
<p>Use your own Class, Classloader, etc but masquerade as sun’s implementations. If/when they decide to take steps to use native code to inspect the jvm take appropriate measures. As far as I’ve seen (I’ve last looked at the client at 555) they don’t use any native code to do so. It’s only used to clean up after the jogl crap because if you navigate away from their application without logging out or cleanly stopping the ‘applet’ there could be a HUGE memory leak. It’s far less sinister as we imagine. This doesn’t mean that they cannot change it… it just means that they haven’t used it to detect yet. (as of 555).</p>
<p>Furthermore, why are you worried about them inspecting for packages or classes loaded in the jvm? Why do you throw your hands up and say ‘well shucks im caught’? You can control what gets returned when they query for that stuff.</p>
<p>Cloaking your own code should be the first thing you do once your bot actually does something worth cloaking. They should never be able to use standard means to detect your code from within the standard avenues. Make it a herculean effort to detect your stuff… ie. make them inspect the jvm using a custom-made native library. (Then beat that <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"> )</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BAsh.html'><span itemprop='name'>BAsh</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-26T12:06:40Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:06:09Z' class='post-time'>
              July 31, 2016, 12:06pm
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I think I can say that I know java inside and out. Bytecode, its transformation, use, loading, modifying and so on I think I’ve covered it all.</p>
<p>Native code is different however. What do you use / recommend for disassembling their native libraries?</p>
<p>I’m not looking for a crude javap look-alike. I’m looking for something that gives me as close to JODE as possible. Obviously native compiling results in a lot of information lost but a tool to inspect what is available would be nice. Some links to tutorials without being as dry as the JVM spec would be good as well.</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Mopman.html'><span itemprop='name'>Mopman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-26T12:09:21Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:06:09Z' class='post-time'>
              July 31, 2016, 12:06pm
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Learn x86 assembler.</p>
<p>(Sorry, it had to be said.)</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/semaphore.html'><span itemprop='name'>semaphore</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-26T19:02:36Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:06:37Z' class='post-time'>
              July 31, 2016, 12:06pm
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a class="mention" href="../../u/bash-2.html">@bash</a></p>
<p>To be honest, the only thing you can do with any native libs is load up IDA and grab your cold beverage of choice and start making notes…</p>
<p>I don’t have any tutorials that I can refer you to as I’ve never used any. If you open IDA and have a menial understanding of x86 assembler you can wade your way through enough to understand if they’re doing something obvious. But for very advanced inspection, which, let’s face it… if they’ve bothered to use native libs for inspection, they sure as hell better be hiding what they’re doing behind seemingly innocuous code.</p>
<p>If this is the case, you’ll have to really -really- look at what they’re doing and trace trace trace.</p>
<p>Off the top of my head, I’d be looking for places where they’re performing pretty much ANY IO and pretty much any calls to GetProcAddress would raise a hell of a red flag in my opinion. Not to mention any kind of native calls to jvm libs would make me somewhat concerned.</p>
<p>Keep in mind that they could hide things VERY easily in native code…</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BAsh.html'><span itemprop='name'>BAsh</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-27T00:32:05Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:07:17Z' class='post-time'>
              July 31, 2016, 12:07pm
            </time>
        <span itemprop='position'>#15</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thanks semaphore I’ll have a look at that.</p>
<aside class="quote no-group" data-post="10" data-topic="308178">
<div class="title">
<div class="quote-controls"></div>
 frank_:</div>
<blockquote>
<p>maybe, but the classloader keeps a static vector of loaded native libraries that jagex do access when cleaning up</p>
</blockquote>
</aside>
<p>What about if you create the JVM from native code? Or you could inject your code to find and attach to the JVM.</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Mopman.html'><span itemprop='name'>Mopman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-27T00:34:31Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:07:17Z' class='post-time'>
              July 31, 2016, 12:07pm
            </time>
        <span itemprop='position'>#16</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i do wonder how that list of native libraries is maintained, i imagine its trivial to hide from but i cant even find it</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BAsh.html'><span itemprop='name'>BAsh</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-27T01:14:31Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:07:19Z' class='post-time'>
              July 31, 2016, 12:07pm
            </time>
        <span itemprop='position'>#17</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Turns out Package.getPackages() only returns packages defined with ClassLoader.definePackage(). So if you want to hide from it make a ClassLoader in the default package to load your classes with no package. Alternatively use native code to call defineClass() (or the native equivalent).</p>
<p>URLClassLoader and eclipse both create Packages automatically.</p>
<p>Of course you could just hijack Package.getPackages().</p>
<p>ClassLoader.loadedLibraryNames is a static Vector containing all of the loaded library names. It is to prevent loading of the same library multiple times in different ClassLoaders. As such you could simply modify it and I don’t think it would cause ill effects providing you don’t try and load your library in different ClassLoaders. Otherwise native libraries are ClassLoader specific.</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-27T03:29:59Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:07:26Z' class='post-time'>
              July 31, 2016, 12:07pm
            </time>
        <span itemprop='position'>#18</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>definepackage is called even if no package name exists, hence the default package</p>
<p>theres another vector that contains the nativelibrary objects to prevent them being gc’d</p>
<p>but yes, they would all be easy enough to hijack</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Killer-99-pkz.html'><span itemprop='name'>Killer-99-pkz</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-12-30T14:24:38Z'>
            <time itemprop='dateModified' datetime='2016-07-31T13:37:46Z' class='post-time'>
              July 31, 2016,  1:37pm
            </time>
        <span itemprop='position'>#19</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>uhm we could just remove all of the code with a byte code library… there is no possible way to securly prevent it when you release something to the public like this.</p>
      </div>

      <meta itemprop='headline' content='Java Agents'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/java-agents/308178 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 03:15:29 GMT -->
</html>
