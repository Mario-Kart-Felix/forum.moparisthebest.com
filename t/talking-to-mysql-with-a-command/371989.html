<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/talking-to-mysql-with-a-command/371989 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Aug 2019 10:22:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Talking to MySQL with a command - Runescape - moparisthebest.com</title>
    <meta name="description" content="I don&amp;#39;t really like asking for help, but I&amp;#39;m somewhat stuck. 

Basically, I&amp;#39;m working on adding a vote reward system where if a player votes on a website, their information (username, ip etc) will be inserted into a tabl&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="371989.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Talking to MySQL with a command&#39;" href="371989.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/talking-to-mysql-with-a-command/371989" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/talking-to-mysql-with-a-command/371989" />
<meta property="og:title" content="Talking to MySQL with a command" />
<meta name="twitter:title" content="Talking to MySQL with a command" />
<meta property="og:description" content="I don’t really like asking for help, but I’m somewhat stuck.  Basically, I’m working on adding a vote reward system where if a player votes on a website, their information (username, ip etc) will be inserted into a table “votes” in a MySQL database. Then, when they enter a command in game to receive their reward, it will open a MySQL connection, check the table to see if they have voted, and if not give them said reward and set the “received” variable in the table to true, which will only change..." />
<meta name="twitter:description" content="I don’t really like asking for help, but I’m somewhat stuck.  Basically, I’m working on adding a vote reward system where if a player votes on a website, their information (username, ip etc) will be inserted into a table “votes” in a MySQL database. Then, when they enter a command in game to receive their reward, it will open a MySQL connection, check the table to see if they have voted, and if not give them said reward and set the “received” variable in the table to true, which will only change..." />
<meta property="article:published_time" content="2010-12-05T20:26:34+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="371989.html">Talking to MySQL with a command</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/k0_twin.html'><span itemprop='name'>k0_twin</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-12-05T20:26:34Z'>
            <time itemprop='dateModified' datetime='2016-08-01T01:22:29Z' class='post-time'>
              August 1, 2016,  1:22am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I don’t really like asking for help, but I’m somewhat stuck.</p>
<p>Basically, I’m working on adding a vote reward system where if a player votes on a website, their information (username, ip etc) will be inserted into a table “votes” in a MySQL database. Then, when they enter a command in game to receive their reward, it will open a MySQL connection, check the table to see if they have voted, and if not give them said reward and set the “received” variable in the table to true, which will only change back to false upon a specified amount of time passing. I realize I could just make it so that on login it gives the reward, but I feel that that’s unnecessary work for the server because not everyone who logs in will need to be checked for a vote reward, hence my creation of the command.</p>
<p>Here’s the command they use in game to receive their reward</p>
<p><code>if (playerCommand.equalsIgnoreCase("getvote")) 
{
	c.sendMessage("1");
	MYSQL.createConnection();
	c.sendMessage("2");
	if(MYSQL.checkVotes(c.playerName))
	{
		c.sendMessage("3");
		if(MYSQL.voteGiven(c.playerName))
		{
			c.getItems().addItem(995,5000000);
			c.sendMessage("Thank you for voting!");
		}
	} 
	MYSQL.destroyCon();
}</code></p>
<p>The various sendMessage’s are just there for me to try to isolate the problem. After I vote, I check the table in the MySQL database to see if the informations gone through (which it has, and the received variable is set to false, meaning the reward hasn’t been claimed), and then use the command in game. When I do so only “1”, and “2” show up, meaning for some reason it’s not passing the</p>
<pre><code class="lang-auto">MYSQL.checkVotes(c.playerName))</code></pre>
<p>Here’s that method</p>
<p>[code]public static boolean checkVotes(String playerName)<br>
{<br>
try {<br>
Statement statement = con.createStatement();<br>
String query = “SELECT * FROM votes WHERE username = '” + playerName + “’”;<br>
ResultSet results = statement.executeQuery(query);</p>
<pre><code>					while(results.next()) 
					{
                            int received = results.getInt("received");
                            if(received == 0)
                            {
                                return true;
                            }
                   } 
            } catch(SQLException e) {
                    e.printStackTrace();
            }
            return false;
    }[/code]
</code></pre>
<p>In PhpMyAdmin the table is displaying that “received” is in fact “0”, yet the checkVote() method is returning false…?</p>
<p><code>if(received == 0)
         {
              return true;
         }</code></p>
<p>If it was returning true then it should enter the if statement here:</p>
<p><code>if(MYSQL.voteGiven(c.playerName))
		{
			c.getItems().addItem(995,5000000);
			c.sendMessage("Thank you for voting!");
		}</code></p>
<p>Shouldn’t it?</p>
<p>So basically that’s where I’m at. I can’t seem to locate the issue that’s causing things to get caught up in the checkVote() method, or what is causing it to return false. My instinct says it’s the former.</p>
      </div>

      <meta itemprop='headline' content='Talking to MySQL with a command'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/k0_twin.html'><span itemprop='name'>k0_twin</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-12-05T20:39:40Z'>
            <time itemprop='dateModified' datetime='2016-08-01T01:22:30Z' class='post-time'>
              August 1, 2016,  1:22am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><code>public static boolean voteGiven(String playerName)
        {
                try
                {
                        query("UPDATE votes SET received = 1 WHERE username = '" + playerName + "'");
                } 
				catch (Exception e) 
				{
                        e.printStackTrace();
                        return false;
                }
                return true;
        }
}</code></p>
      </div>

      <meta itemprop='headline' content='Talking to MySQL with a command'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Fat_Cookies.html'><span itemprop='name'>Fat_Cookies</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-12-05T20:43:39Z'>
            <time itemprop='dateModified' datetime='2016-08-01T01:22:30Z' class='post-time'>
              August 1, 2016,  1:22am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This looks so vulnerable to injection.<br>
Plus, why are storing received as an integer??!?!?</p>
      </div>

      <meta itemprop='headline' content='Talking to MySQL with a command'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/k0_twin.html'><span itemprop='name'>k0_twin</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-12-05T20:59:45Z'>
            <time itemprop='dateModified' datetime='2016-08-01T01:22:31Z' class='post-time'>
              August 1, 2016,  1:22am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group">
<div class="title">
<div class="quote-controls"></div>
 I Vain I:</div>
<blockquote>
<p>In the voteGiven boolean, try returning true after the query as well.</p>
</blockquote>
</aside>
<p>No change, I don’t believe it’s reaching voteGiven().</p>
<p>[quote=“Fat Cookies, post:3, topic:371989”]This looks so vulnerable to injection.<br>
Plus, why are storing received as an integer??!?!?[/quote]</p>
<p>Luckily most people who play rsps’s have the IQ of a rabbit. And the selection of datatypes was very limited.</p>
      </div>

      <meta itemprop='headline' content='Talking to MySQL with a command'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/talking-to-mysql-with-a-command/371989 by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 07 Aug 2019 10:22:42 GMT -->
</html>
