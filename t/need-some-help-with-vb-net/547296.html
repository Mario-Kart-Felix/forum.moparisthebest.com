<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/need-some-help-with-vb-net/547296 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Need some help with VB.net - General Discussion - moparisthebest.com</title>
    <meta name="description" content="Ok so here is what I have so far: 

Default.aspx.vb class  

 Partial Class _Default
    Inherits System.Web.UI.Page
    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
    checkCookies(&amp;quot;albania&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="547296.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Need some help with VB.net&#39;" href="547296.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/need-some-help-with-vb-net/547296" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/need-some-help-with-vb-net/547296" />
<meta property="og:title" content="Need some help with VB.net" />
<meta name="twitter:title" content="Need some help with VB.net" />
<meta property="og:description" content="Ok so here is what I have so far:  Default.aspx.vb class  Partial Class _Default     Inherits System.Web.UI.Page      Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load         checkCookies(&quot;albaniaYes&quot;)         checkCookies(&quot;albaniaNo&quot;)         checkCookies(&quot;americaYes&quot;)         checkCookies(&quot;americaNo&quot;)         checkCookies(&quot;ethiopiaYes&quot;)         checkCookies(&quot;ethiopiaNo&quot;)         checkCookies(&quot;franceYes&quot;)         checkCookies(&quot;franceNo&quot;)          If PreviousPage IsNot N..." />
<meta name="twitter:description" content="Ok so here is what I have so far:  Default.aspx.vb class  Partial Class _Default     Inherits System.Web.UI.Page      Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load         checkCookies(&quot;albaniaYes&quot;)         checkCookies(&quot;albaniaNo&quot;)         checkCookies(&quot;americaYes&quot;)         checkCookies(&quot;americaNo&quot;)         checkCookies(&quot;ethiopiaYes&quot;)         checkCookies(&quot;ethiopiaNo&quot;)         checkCookies(&quot;franceYes&quot;)         checkCookies(&quot;franceNo&quot;)          If PreviousPage IsNot N..." />
<meta property="article:published_time" content="2014-10-16T18:05:38+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="547296.html">Need some help with VB.net</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-discussion.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Discussion</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/pk4pk.html'><span itemprop='name'>pk4pk</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-10-16T18:05:38Z'>
            <time itemprop='dateModified' datetime='2016-08-04T13:52:51Z' class='post-time'>
              August 4, 2016,  1:52pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Ok so here is what I have so far:</p>
<p>Default.aspx.vb class</p>
<pre><code class="lang-auto">Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        checkCookies("albaniaYes")
        checkCookies("albaniaNo")
        checkCookies("americaYes")
        checkCookies("americaNo")
        checkCookies("ethiopiaYes")
        checkCookies("ethiopiaNo")
        checkCookies("franceYes")
        checkCookies("franceNo")

        If PreviousPage IsNot Nothing Then
            Dim albanianVote, americanVote, ethiopianVote, franceVote As String
            albanianVote = CType(PreviousPage.FindControl("albanianVote"), HiddenField).Value
            americanVote = CType(PreviousPage.FindControl("americanVote"), HiddenField).Value
            ethiopianVote = CType(PreviousPage.FindControl("ethiopianVote"), HiddenField).Value
            franceVote = CType(PreviousPage.FindControl("franceVote"), HiddenField).Value

            Dim albanianCookie As HttpCookie = Request.Cookies(albanianVote)
            Dim americanCookie As HttpCookie = Request.Cookies(americanVote)
            Dim ethiopianCookie As HttpCookie = Request.Cookies(ethiopianVote)
            Dim franceCookie As HttpCookie = Request.Cookies(franceVote)

            'If albanianVote = "albaniaYes" Then
                'addOneToCookie("albaniaYes", "albaniaNo")
            'End If


            If PreviousPage IsNot Nothing Then
                If Not imgHiddenField.Value Is Nothing Then
                    imgHiddenField.Value = ""
                ElseIf imgHiddenField.Value IsNot Nothing Then
                    Dim thePickedImg As String
                    thePickedImg = CType(PreviousPage.FindControl("imgHiddenField"), HiddenField).Value
                    Dim cookie As HttpCookie = Request.Cookies(thePickedImg)
                End If
            End If
        End If
        displayResults()
    End Sub

    Protected Sub checkCookies(ByVal cookieKey As String)
        Dim cookie As HttpCookie = Request.Cookies(cookieKey)
        If cookie Is Nothing Then
            cookie = New HttpCookie(cookieKey)
            cookie(cookieKey) = 0
            cookie.Expires = DateAndTime.Now.AddYears(1)
            Response.Cookies.Add(cookie)
        End If
    End Sub

    Protected Sub displayResults()
        displayOneResult(albanianScore, "albaniaYes", "albaniaNo")
        displayOneResult(americanScore, "americaYes", "americaNo")
        displayOneResult(ethiopianScore, "ethiopiaYes", "ethiopiaNo")
        displayOneResult(frenchScore, "franceYes", "franceNo")
    End Sub

    Protected Sub displayOneResult(ByVal colorLabel As Label, ByVal YescookieKey As String, ByVal NocookieKey As String)
        Dim yesVote As HttpCookie = Request.Cookies(YescookieKey)
        Dim noVote As HttpCookie = Request.Cookies(NocookieKey)
        colorLabel.Text = CType(yesVote(YescookieKey), String)
    End Sub

    Protected Sub addOneToCookie(ByVal YescookieKey As String, ByVal NocookieKey As String)
        Dim Yescookie As HttpCookie = Request.Cookies(YescookieKey)
        Dim value As String = (CInt(Yescookie(YescookieKey)) + 1).ToString
        Dim Nocookie As HttpCookie = Request.Cookies(NocookieKey)
        Dim totalValue = value / (value + value)
        updateCookie(YescookieKey, totalValue)
    End Sub

    Protected Sub updateCookie(ByVal YescookieKey As String, ByVal value As String)
        Dim Yescookie As HttpCookie = Request.Cookies(YescookieKey)
        Yescookie(YescookieKey) = value
        Yescookie.Expires = DateAndTime.Now.AddYears(1)
        Response.Cookies.Add(Yescookie)
        displayResults()
    End Sub

    Protected Sub resetButton_Click(sender As Object, e As EventArgs) Handles resetButton.Click
        resetCookie("albaniaYes")
        resetCookie("albaniaNo")
        resetCookie("americaYes")
        resetCookie("americaNo")
        resetCookie("ethiopiaYes")
        resetCookie("ethiopiaNo")
        resetCookie("franceYes")
        resetCookie("franceNo")
    End Sub

    Protected Sub resetCookie(ByVal cookieKey As String)
        updateCookie(cookieKey, 0)
    End Sub

    Protected Sub albanianImg_Click(sender As Object, e As ImageClickEventArgs) Handles albanianImg.Click
        imgHiddenField.Value = "Albania"
    End Sub

    Protected Sub americanImg_Click(sender As Object, e As ImageClickEventArgs) Handles americanImg.Click
        imgHiddenField.Value = "America"
    End Sub

    Protected Sub ethiopianImg_Click(sender As Object, e As ImageClickEventArgs) Handles ethiopianImg.Click
        imgHiddenField.Value = "Ethiopia"
    End Sub

    Protected Sub frenchImg_Click(sender As Object, e As ImageClickEventArgs) Handles frenchImg.Click
        imgHiddenField.Value = "France"
    End Sub
End Class</code></pre>
<p>Voting.aspx.vb class</p>
<pre><code class="lang-auto">Partial Class Default2
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If PreviousPage IsNot Nothing Then
            Dim pickedImg As String
            pickedImg = CType(PreviousPage.FindControl("imgHiddenField"), HiddenField).Value
            If pickedImg = "Albania" Then
                imageHolder.ImageUrl = "Albanian-flag.png"
            ElseIf pickedImg = "America" Then
                imageHolder.ImageUrl = "2000px-Hopkinson_Flag.svg.png"
            ElseIf pickedImg = "Ethiopia" Then
                imageHolder.ImageUrl = "et-lion1.png"
            ElseIf pickedImg = "France" Then
                imageHolder.ImageUrl = "frlarge.png"
            End If
            voteHiddenField.Value = CType(PreviousPage.FindControl("imgHiddenField"), HiddenField).Value
        End If
    End Sub

    Protected Sub voteButton_Click(sender As Object, e As EventArgs) Handles voteButton.Click
        Dim pickedImg As String
        pickedImg = voteHiddenField.Value

        If pickedImg = "Albania" Then
            If yesButton.Checked Then
                albanianVote.Value = "albaniaYes"
            ElseIf noButton.Checked Then
                albanianVote.Value = "albaniaNo"
            End If
        ElseIf pickedImg = "America" Then
            If yesButton.Checked Then
                americanVote.Value = "americaYes"
            ElseIf noButton.Checked Then
                americanVote.Value = "americaNo"
            End If
        ElseIf pickedImg = "Ethiopia" Then
            If yesButton.Checked Then
                ethiopianVote.Value = "ethiopiaYes"
            ElseIf noButton.Checked Then
                americanVote.Value = "ethiopiaNo"
            End If
        ElseIf pickedImg = "France" Then
            If yesButton.Checked Then
                franceVote.Value = "franceYes"
            ElseIf noButton.Checked Then
                franceVote.Value = "franceNo"
            End If
        End If

    End Sub

End Class</code></pre>
<p>So for this assignment the user clicks on one of the four images and is taken to a second webpage which displays the image and gives you a yes and no option to vote for the image. If you hit yes it is supposed to add 1 to the yes cookie and if you hit no it adds 1 to the no cookie for the corresponding image. After hitting the vote button it takes you back to the previous page and the label under the image is updated to display the number you voted. So lets say you vote yes and then no on the same image the number is equal to 0.5. (Yes/yes+no). For some reason I can’t get the cookies to work properly and every time I run it I’m stuck at the same random value of 0.909090 when I vote yes. Any help would be appreciated.</p>
      </div>

      <meta itemprop='headline' content='Need some help with VB.net'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/need-some-help-with-vb-net/547296 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:10 GMT -->
</html>
