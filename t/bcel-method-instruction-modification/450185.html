<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/bcel-method-instruction-modification/450185 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 01:06:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>BCEL Method Instruction Modification - General Programming - moparisthebest.com</title>
    <meta name="description" content="got it">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="450185.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;BCEL Method Instruction Modification&#39;" href="450185.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/bcel-method-instruction-modification/450185" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/bcel-method-instruction-modification/450185" />
<meta property="og:title" content="BCEL Method Instruction Modification" />
<meta name="twitter:title" content="BCEL Method Instruction Modification" />
<meta property="og:description" content="got it" />
<meta name="twitter:description" content="got it" />
<meta property="article:published_time" content="2012-07-18T22:39:58+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="450185.html">BCEL Method Instruction Modification</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-18T22:39:58Z'>
            <time itemprop='dateModified' datetime='2016-08-03T15:00:34Z' class='post-time'>
              August 3, 2016,  3:00pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>got it</p>
      </div>

      <meta itemprop='headline' content='BCEL Method Instruction Modification'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-22T06:36:39Z'>
            <time itemprop='dateModified' datetime='2016-08-03T17:20:04Z' class='post-time'>
              August 3, 2016,  5:20pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote quote-modified" data-post="1" data-topic="450579">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/747/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar">
</div>
<blockquote>
<p>the push of ‘offset’ onto the stack won’t necessarily be the instruction immediately before the call to get the String (I.I), so it’s probably safer to add a pop instruction before the ldc <span class="bbcode-i">which replaces the method call</span> (than to remove the previous instruction).</p>
</blockquote>
</aside>
<ol>
<li>If it’s not directly preceding, then his transformer won’t even find the offset so there will be no way to determine the deciphered string in the first place.</li>
<li>Pretending it did manage to do that somehow, dead stack manipulation is not generally decompiler-friendly:</li>
</ol>
<p>[code].class public HelloWorld</p>
<p>.method public static main([Ljava/lang/String;)V<br>
.limit stack 2<br>
.limit locals 1</p>
<p>ldc “hello”<br>
getstatic java/lang/System/out Ljava/io/PrintStream;<br>
swap<br>
pop<br>
ldc “hi”<br>
invokevirtual java/io/PrintStream/println(Ljava/lang/String;)V<br>
return<br>
.end method<br>
[/code]</p>
<p>[code]C:\dev\scrap&gt;java -jar jasmin.jar HelloWorld.j<br>
Generated: HelloWorld.class</p>
<p>C:\dev\scrap&gt;java HelloWorld<br>
hi</p>
<p>C:\dev\scrap&gt;jad -t2 -nonlb -b HelloWorld<br>
Parsing HelloWorld… Generating HelloWorld.jad<br>
Couldn’t fully decompile method main[/code]</p>
<p>[code]// Decompiled by Jad v1.5.8g. Copyright 2001 Pavel Kouznetsov.<br>
// Jad home page: <a href="http://www.kpdus.com/jad.html" rel="nofollow noopener">http://www.kpdus.com/jad.html</a><br>
// Decompiler options: packimports(3) braces nonlb<br>
// Source File Name:   HelloWorld.j</p>
<p>import java.io.PrintStream;</p>
<p>public class HelloWorld {</p>
<p>public static void main(String args[]) {<br>
“hello”;<br>
System.out;<br>
JVM INSTR swap ;<br>
JVM INSTR pop ;<br>
“hi”;<br>
println();<br>
}<br>
}[/code]</p>
<p>If you truly needed to, one could just implement some sort of abstract interpreter to keep track of the stack, and thus determine the instructions that produce the offset so long as they’re in the local method and thus effectively deal with more heavily obfuscated code… if your curious, this is precisely what ASM’s source interpreter does… <img src="../../images/emoji/twitter/stuck_out_tongueae52.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
      </div>

      <meta itemprop='headline' content='BCEL Method Instruction Modification'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/bcel-method-instruction-modification/450185 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 01:06:31 GMT -->
</html>
