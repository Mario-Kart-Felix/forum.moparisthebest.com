<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/bug-fix-grand-exchange-price-glitch-when-buying-items/470753 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 12:02:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[Bug fix] Grand Exchange price glitch when buying items - Runescape - moparisthebest.com</title>
    <meta name="description" content="I saw a help thread (originally posted here) for a Grand Exchange item price glitch, in which increasing the amount of an expensive item (seen here with godsword hilts) to a ridiculuously high number (in a multiple of tw&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="470753.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[Bug fix] Grand Exchange price glitch when buying items&#39;" href="470753.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/bug-fix-grand-exchange-price-glitch-when-buying-items/470753" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/bug-fix-grand-exchange-price-glitch-when-buying-items/470753" />
<meta property="og:title" content="[Bug fix] Grand Exchange price glitch when buying items" />
<meta name="twitter:title" content="[Bug fix] Grand Exchange price glitch when buying items" />
<meta property="og:description" content="I saw a help thread (originally posted here) for a Grand Exchange item price glitch, in which increasing the amount of an expensive item (seen here with godsword hilts) to a ridiculuously high number (in a multiple of two) would give you the items, at a fraction of the cost.  Look in either the ExchangeHandler, or GrandExchange file (whichever deals with the buying/selling stuff), and in there you’ll see  	public void acceptOffer(Player player, Type type) { 		int amount = (int) player.geAmount; ..." />
<meta name="twitter:description" content="I saw a help thread (originally posted here) for a Grand Exchange item price glitch, in which increasing the amount of an expensive item (seen here with godsword hilts) to a ridiculuously high number (in a multiple of two) would give you the items, at a fraction of the cost.  Look in either the ExchangeHandler, or GrandExchange file (whichever deals with the buying/selling stuff), and in there you’ll see  	public void acceptOffer(Player player, Type type) { 		int amount = (int) player.geAmount; ..." />
<meta property="article:published_time" content="2012-12-02T09:56:05+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="470753.html">[Bug fix] Grand Exchange price glitch when buying items</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-02T09:56:05Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:28:30Z' class='post-time'>
              August 4, 2016,  1:28am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I saw a help thread (originally posted <a href="http://www.moparisthebest.com/smf/index.php/topic,588154.0.html" data-bbcode="true">here</a>) for a Grand Exchange item price glitch, in which increasing the amount of an expensive item (seen <a href="http://www.moparisthebest.com/smf/index.php/topic,588216.msg4171726.html" data-bbcode="true">here</a> with godsword hilts) to a ridiculuously high number (in a multiple of two) would give you the items, at a fraction of the cost.</p>
<p>Look in either the ExchangeHandler, or GrandExchange file (whichever deals with the buying/selling stuff), and in there you’ll see</p>
<pre><code class="lang-auto">	public void acceptOffer(Player player, Type type) {
		int amount = (int) player.geAmount;
		int id = (int) player.geItem;
		int price = (int) player.price;</code></pre>
<p>All you need to do, is right under price, add</p>
<pre><code class="lang-auto">long cost = (long) amount * price;
if (cost &gt; Integer.MAX_VALUE) {
    return;
}</code></pre>
<p>And that will stop the duping glitch for the moment.</p>
<p>There is one (potential) problem though. Given the right amount that is being bought, the same error could occur. The cost value (which is know 64-bits long instead of 32-bits) could eventually overflow, and become negative. For an item costing 150m, that number would be 61,489,146,912. As you can see, it is about 30x larger than the maximum value for an integer. It shouldn’t be possible to get up to such a large number, without client <span class="bbcode-b">AND</span> server protocol modification. I believe client-side it’s probably in a jagex script somewhere so that it won’t go higher than 2b anyway.</p>
<p>The strange part was that there is a duplicate set of code farther down in the function, but it was completely disregarded.</p>
<p>The code is (for those of you who care, and are still reading by this point)</p>
<pre><code class="lang-auto">long totalPrice = price * amount;
if (totalPrice &gt;= Integer.MAX_VALUE || totalPrice &lt; 0) {
    player.sm("The price is too high!");
    return;
}</code></pre>
<p>It’s a subtle problem, and it looks very close to my block of code, with one significant difference.</p>
<pre><code class="lang-auto">long cost = (long) amount * price;</code></pre>
<p>versus</p>
<pre><code class="lang-auto">long totalPrice = amount * price;</code></pre>
<p>My code casts the arithmetic to a long, which allows it’s “true” value as the result, whereas the existing code is still performing the math on integers, which allows it to wrap-around to a negative number. So, in reality, you could either add the code that I provided, or simply add</p>
<pre><code class="lang-auto">(long)</code></pre>
<p>To the existing code that calculates the total cost.</p>
<p><span class="bbcode-b">NOTE:</span> I have not tested this on every server framework with a Grand Exchange enabled. I have only tested it on Zenith (which is the only one I had available), but the process should be the same on NRS3Server or the other high-revision servers.</p>
<p><span class="bbcode-b">SIDE NOTE:</span> The problem could have probably been more easily identified, had the server only had 1 set of classes that dealt with the Grand Exchange, rather than 3.</p>
      </div>

      <meta itemprop='headline' content='[Bug fix] Grand Exchange price glitch when buying items'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/SCFTW.html'><span itemprop='name'>SCFTW</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-02T13:23:22Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:28:32Z' class='post-time'>
              August 4, 2016,  1:28am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Kool stuff.</p>
      </div>

      <meta itemprop='headline' content='[Bug fix] Grand Exchange price glitch when buying items'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mr_pker01.html'><span itemprop='name'>mr_pker01</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-03T08:45:20Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:29:37Z' class='post-time'>
              August 4, 2016,  1:29am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Very nice find! <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='[Bug fix] Grand Exchange price glitch when buying items'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Bazi.html'><span itemprop='name'>Bazi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-05T02:00:14Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:31:55Z' class='post-time'>
              August 4, 2016,  1:31am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I Cant find that code anywhere <img src="../../images/emoji/twitter/frowningae52.png?v=5" title=":frowning:" class="emoji" alt=":frowning:"> I looked like everywhere too!</p>
      </div>

      <meta itemprop='headline' content='[Bug fix] Grand Exchange price glitch when buying items'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-05T02:29:08Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:31:56Z' class='post-time'>
              August 4, 2016,  1:31am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="4" data-topic="470753">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/bazi/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> Bazi:</div>
<blockquote>
<p>I Cant find that code anywhere <img src="../../images/emoji/twitter/frowningae52.png?v=5" title=":frowning:" class="emoji" alt=":frowning:"> I looked like everywhere too!</p>
</blockquote>
</aside>
<p>Post your class that deals with Grand Exchange events (the actual class, there could be multiple, so I don’t know which one it is)</p>
      </div>

      <meta itemprop='headline' content='[Bug fix] Grand Exchange price glitch when buying items'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Bazi.html'><span itemprop='name'>Bazi</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-05T02:40:04Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:31:56Z' class='post-time'>
              August 4, 2016,  1:31am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Do you have a skype or a t.v? ill pm u mine.</p>
      </div>

      <meta itemprop='headline' content='[Bug fix] Grand Exchange price glitch when buying items'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-05T05:18:36Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:32:03Z' class='post-time'>
              August 4, 2016,  1:32am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="6" data-topic="470753">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/bazi/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> Bazi:</div>
<blockquote>
<p>Do you have a skype or a t.v? ill pm u mine.</p>
</blockquote>
</aside>
<p>I have neither installed. And I don’t really help that way.</p>
      </div>

      <meta itemprop='headline' content='[Bug fix] Grand Exchange price glitch when buying items'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Uncalled.html'><span itemprop='name'>Uncalled</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-05T08:42:35Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:32:11Z' class='post-time'>
              August 4, 2016,  1:32am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>HURRRE DUERP COMMON SENSE</p>
<p>Other than that - nice tutorial. Very well explained for those that need it. Good job!</p>
      </div>

      <meta itemprop='headline' content='[Bug fix] Grand Exchange price glitch when buying items'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Newreality.html'><span itemprop='name'>Newreality</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-14T21:46:51Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:42:32Z' class='post-time'>
              August 4, 2016,  1:42am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>this only works for Zenith can you post a fix for NRS3 V4 one please</p>
      </div>

      <meta itemprop='headline' content='[Bug fix] Grand Exchange price glitch when buying items'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/bug-fix-grand-exchange-price-glitch-when-buying-items/470753 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 12:02:05 GMT -->
</html>
