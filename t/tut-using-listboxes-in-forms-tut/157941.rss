<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[TUT]Using Listboxes in Forms[TUT]</title>
    <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941</link>
    <description>Okay,
My first tutorial on MITB,
Made by request from a friend,

Listboxes, As most people would know, Are like a TextArea(For an Example, Where you type is scar is like one) BUT You can&#39;t actually edit directly the text in there, And each line is selected when you click it.

Now although it seems very restricted, It&#39;s also very useful, In that it can hold more then one thing; Like a combo box, But you can view it all at once and it&#39;s unchangable(Directly).

Now before I bore(sp?) you or turn you off ListBoxes, Let me finally show you how to use them!




[b]Getting Started:[/b]
Now since a ListBox is used on a form, The first sensible thing to do would be make a form!
Open SCAR(If you haven&#39;t already); Go to Tools ---&gt; Form Editor.
Once in the editor, Put a listbox onto your form(It&#39;s the button right of the radio button(If your unsure hover your mouse over each one and a hint will appear))
Simply click the listbox button and click on your form.
Click on the Listbox one it&#39;s on your form until the Object Explorer on the left fills up with stuff xP
Find where it says &quot;Items    |    (TStrings)&quot;(Or Similar)
Click Items and then click the button with ... on the right of TStrings.
Enter the text you want in the form that pops up.
Resize either your form or listbox if you wish to.
Also, You must save your form once your happy with it; Remember where though XD

For help, See the movie below:
[url=http://www.freewebs.com/dafilestorage/Mitch/Tutorials/Listbox/ListboxForm.swf]http://www.freewebs.com/dafilestorage/Mitch/Tutorials/Listbox/ListboxForm.swf[/url]




[b]Getting the Form into SCAR[/b]
Once you&#39;ve finished designing and saving your form,
You&#39;ll need to put it into SCAR so that it can run it.
To do this, I use Ron&#39;s DFM Parser(http://www.moparisthebest.com/smf/index.php/topic,70887.0.html);
Once you have that, Load it into SCAR,
Hit run and wait for it to compile,
SCAR will Minimize and a form will pop up,
Click the browse button and locate the Form you saved earlier.
Click Generate Code, Wait for it to fill up the box beneath with some text,
Then click Copy to Clipboard.  That is your Form, In SCAR Form :P

For help, See the movie below:
[url=http://www.freewebs.com/dafilestorage/Mitch/Tutorials/Listbox/ParsingForm.swf]http://www.freewebs.com/dafilestorage/Mitch/Tutorials/Listbox/ParsingForm.swf[/url]

Once you have that text in SCAR, Run it and see the results.
[b][i]Congratulations ^_^; You&#39;ve just made a Listbox[/i][/b]

Now;
This is where the tutorial gets more advanced,
I&#39;ve already gone off topic ALOT in this tutorial and have barely spoken of Listboxes, Now is where you get to use the real stuff =]

The main thing you should worry about a ListBox in SCAR side of it(Like, If you click a button to show what is selected) is:
Items; The thing you used before, To add text into the box.
Items is the list of words which appear in the ListBox, ListBoxName.Items[0] is the first Piece of text in the listbox.
Clear; Deletes all values in the listbox
ItemIndex is probably the only other thing you would be using;
It is an integer which is the current Line selected.

An example of what you could do with this code is:
[code]procedure StuffToDoOnClick;
begin
  ShowMessage(ListBox1.Items[ListBox1.ItemIndex]); //Will display the current item selected
end;[/code]



[b]SCAR-Wise manipulation of the Listbox[/b](Editing the contents with the script)
[code]  Add(S: String): LongInt;
  AddStrings(Strings: TStrings);
  Append(S: String);
  CommaText: String;
  Count: LongInt;
  Delete(Index: LongInt);
  DelimitedText: String;
  Delimiter: Char;
  Equals(Strings: TStrings): Boolean;
  Exchange(Index1, Index2: LongInt);
  IndexOf(S: String): LongInt;
  Insert(Index: LongInt; S: String);
  Move(CurIndex, NewIndex: LongInt);
  Strings: Array of String;
  Text: String;[/code]
That&#39;s the only methods of Items in a listbox you will probly need to know;
Most are self explanatory, I will briefly go over most of them.

ListBox Items values are organized by Index number, Sort of like an array, Since, Strings is an array.

[i]Add(S: String): LongInt;[/i] [b]~[/b] Adds S to the end of the values of the list box, And returns the index number of it.
[i]Append(S: String);[/i] [b]~[/b] Adds S to the end of the listbox.
[i]CommaText: String;[/i] [b]~[/b] Returns all the values of the listbox in 1 string, Seperated by commas
[i]Count: LongInt;[/i] [b]~[/b] Returns the number of values in the listbox
[i]Delete(Index: LongInt);[/i] [b]~[/b] Removes the value at the index number specified
[i]Delimiter: Char;[/i] [b]~[/b] Chooses what to seperate each value by in DelimitedText
[i]DelimitedText: String;[/i] [b]~[/b] Returns a string of all values seperated by Delimiter
[i]Exchange(Index1, Index2: LongInt);[/i] [b]~[/b] Swaps 2 values specified by index numbers
[i]IndexOf(S: String): LongInt;[/i] [b]~[/b] Gets the Index number of the S, If not in the listbox will return -1
[i]Insert(Index: LongInt; S: String);[/i] [b]~[/b] Puts S in at the Index number specified
[i]Move(CurIndex, NewIndex: LongInt);[/i] [b]~[/b] Moves the value at CurIndex and inserts at NewIndex
[i]Strings: Array of String;[/i] [b]~[/b] Strings[Index] returns the value at an index
[i]Text: String[/i] [b]~[/b] Returns the exact text of the listbox, With Enter&#39;s and all, Usefull for advanced creation of listboxes and Saving &amp; Loading to files


[b]Now for an example of each of those methods[/b]
[code]program New;

var
  // InitForm variables.
  frmDesign : TForm;
  ListBox1 : TListBox;
  Buttons1 : TButton;
  
procedure DoStuffNow(Sender: TObject);
var
Index: Integer;
begin
  Buttons1.Visible := False;
  Wait(1000);
  ListBox1.Clear; //Deletes all Items from the listbox
  Wait(5000);
  Index  := ListBox1.Items.Add(&#39;Boom pop bang&#39;); //Adds &#39;Boom pop bang&#39; to the listbox and stores its index number
  Wait(5000);
  ListBox1.Items.Append(&#39;Damn, I like Rawr o_O&#39;); //Adds &#39;Damn, I like Rawr o_O&#39; to the listbox
  Wait(5000);
  ListBox1.Items.Delete(Index); //Will delete Index, Which we defined earlier as &#39;Boom pop bang&#39;
  Wait(1000);
  ListBox1.Items.Delimiter := &#39;.&#39;; //Sets the values to be seperated by &#39;.&#39; in Delimited Text
  Wait(1000);
  GetApplication.MessageBox(ListBox1.Items.DelimitedText,&#39;Rawr&#39;,0{Ignore the &#39;Rawr&#39; and 0}); //Writes the values of the listbox(Seperated by the Delimiter{&#39;.&#39;}) into the Debug
  Wait(1000);
  Index := ListBox1.Items.Add(&#39;Rawr&#39;); //Explained earlier
  Wait(1000);
  ListBox1.Items.Exchange(Index, 0{First Value}); //Will move around the last thing added to the listbox with the first item
  Wait(1000);
  Index := ListBox1.Items.IndexOf(&#39;Damn, I like Rawr o_O&#39;); //Sets the Index variable to that of &#39;Damn, I like Rawr o_O&#39;
  Wait(1000);
  ListBox1.Items.Insert(Index, &#39;=Timmae=&#39;); //Will insert &#39;=Timmae=&#39; into the Index as chosen earlier(Will put before &#39;Damn, I like Rawr o_O&#39;)
  Wait(1000);
  ListBox1.Items.Move(Index, 0); //Moves &#39;=Timmae=&#39; To the first slot in the ListBox
  Wait(1000);
  GetApplication.MessageBox(ListBox1.Items.Strings[Index],&#39;Rawr&#39;,0{Ignore the &#39;Rawr&#39; and 0}); //Will show the Value now located at Index
  Wait(1000);
  ListBox1.Items.Text := &#39;Rawr&#39; + Chr(13){Enter} + &#39;Whats up&#39; + Chr(13) + &#39;Peeps&#39;; //Edit it to understand it better
  Wait(1000);
  GetApplication.MessageBox(ListBox1.Items.CommaText,&#39;Rawr&#39;,0{Ignore the &#39;Rawr&#39; and 0}); //The values seperated by &#39;,&#39;
  Wait(1000);
end;

// This form was parsed using: DFM Form Parser v.23 by Ron.
procedure InitForm;
begin
  frmDesign := CreateForm;
  frmDesign.Left := 250;
  frmDesign.Top := 114;
  frmDesign.Width := 210;
  frmDesign.Height := 284;
  frmDesign.Caption := &#39;frmDesign&#39;;
  frmDesign.Color := clBtnFace;
  frmDesign.Font.Color := clWindowText;
  frmDesign.Font.Height := -11;
  frmDesign.Font.Name := &#39;MS Sans Serif&#39;;
  frmDesign.Font.Style := [];
  frmDesign.PixelsPerInch := 96;
  ListBox1 := TListBox.Create(frmDesign);
  ListBox1.Parent := frmDesign;
  ListBox1.Left := 0;
  ListBox1.Top := 0;
  ListBox1.Width := 201;
  ListBox1.Height := 257;
  ListBox1.ItemHeight := 13;
  ListBox1.Items.Add(&#39;Rawr&#39;);
  ListBox1.Items.Add(&#39;XD&#39;);
  ListBox1.Items.Add(&#39;Ron&#39;);
  ListBox1.Items.Add(&#39;Zapp&#39;);
  ListBox1.Items.Add(&#39;Lothy&#39;);
  ListBox1.Items.Add(&#39;Mopar&#39;);
  ListBox1.Items.Add(&#39;Bebe&#39;);
  ListBox1.Items.Add(&#39;Solar&#39;);
  ListBox1.Items.Add(&#39;Un Named&#39;);
  ListBox1.Items.Add(&#39;MAD COW!&#39;);
  ListBox1.Items.Add(&#39;Cupcakes&#39;);
  ListBox1.TabOrder := 8;
  Buttons1 := TButton.Create(frmDesign);
  Buttons1.Parent := frmDesign;
  Buttons1.left := 5;
  Buttons1.height := 15;
  buttons1.caption := &#39;Rawr&#39;;
  buttons1.TabOrder := 9;
  Buttons1.OnClick := @DoStuffNow;
end;

procedure SafeInitForm;
var
  V : TVariantArray;
begin
  SetArrayLength(V, 0);
  ThreadSafeCall(&#39;InitForm&#39;, V);
end;

procedure ShowInitFormModal;
begin
  frmDesign.ShowModal;
end;

procedure SafeShowInitFormModal;
var
  V : TVariantArray;
begin
  SetArrayLength(V, 0);
  ThreadSafeCall(&#39;ShowInitFormModal&#39;, V);
end;

procedure MainInitForm;
begin
  SafeInitForm;
  SafeShowInitFormModal;
  FreeForm(frmDesign);
end;

begin
  ClearDebug;
  MainInitForm;
end.[/code]


[code]program New;

var
  // InitForm variables.
  frmDesign : TForm;
  ListBox1 : TListBox;

procedure LeftStuff;      //Called when left clicked
begin
  GetApplication.MessageBox(ListBox1.Items[ListBox1.ItemIndex], &#39;Rawr&#39;, 16); //Displays currently selected item
end;

procedure RightStuff; //Called when right clicked
begin
  Listbox1.Items.Insert(ListBox1.ItemIndex, Readln(&#39;New Item?&#39;)); //Inserts what the user puts in at the index double clicked
  ListBox1.Items.Add(Readln(&#39;New Item?&#39;)); //Adds what you choose
end;

procedure DoStuff(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Integer);  //Called when a mouse button is down over the listbox
begin                                                                                         //I had to use MouseDown since a right click doesn&#39;t count as a click
  if IsMouseButtonDown(False) then
    RightStuff
  else
    LeftStuff;
end;

// This form was parsed using: DFM Form Parser v.23 by Ron.
procedure InitForm;
begin
  frmDesign := CreateForm;
  frmDesign.Left := 250;
  frmDesign.Top := 114;
  frmDesign.Width := 210;
  frmDesign.Height := 284;
  frmDesign.Caption := &#39;frmDesign&#39;;
  frmDesign.Color := clBtnFace;
  frmDesign.Font.Color := clWindowText;
  frmDesign.Font.Height := -11;
  frmDesign.Font.Name := &#39;MS Sans Serif&#39;;
  frmDesign.Font.Style := [];
  frmDesign.PixelsPerInch := 96;
  ListBox1 := TListBox.Create(frmDesign);
  ListBox1.Parent := frmDesign;
  ListBox1.Left := 0;
  ListBox1.Top := 0;
  ListBox1.Width := 201;
  ListBox1.Height := 257;
  ListBox1.ItemHeight := 13;
  ListBox1.Items.Add(&#39;Rawr&#39;);
  ListBox1.Items.Add(&#39;XD&#39;);
  ListBox1.Items.Add(&#39;Ron&#39;);
  ListBox1.Items.Add(&#39;Zapp&#39;);
  ListBox1.Items.Add(&#39;Lothy&#39;);
  ListBox1.Items.Add(&#39;Mopar&#39;);
  ListBox1.Items.Add(&#39;Bebe&#39;);
  ListBox1.Items.Add(&#39;Solar&#39;);
  ListBox1.Items.Add(&#39;Star&#39;);
  ListBox1.Items.Add(&#39;Un Named&#39;);
  ListBox1.Items.Add(&#39;MAD COW!&#39;);
  ListBox1.Items.Add(&#39;Nielsie is cool&#39;);
  ListBox1.Items.Add(&#39;Cupcakes&#39;);
  ListBox1.TabOrder := 8;
  Listbox1.OnMouseDown := @DoStuff
end;

procedure SafeInitForm;
var
  V : TVariantArray;
begin
  SetArrayLength(V, 0);
  ThreadSafeCall(&#39;InitForm&#39;, V);
end;

procedure ShowInitFormModal;
begin
  frmDesign.ShowModal;
end;

procedure SafeShowInitFormModal;
var
  V : TVariantArray;
begin
  SetArrayLength(V, 0);
  ThreadSafeCall(&#39;ShowInitFormModal&#39;, V);
end;

procedure MainInitForm;
begin
  SafeInitForm;
  SafeShowInitFormModal;
  FreeForm(frmDesign);
end;

begin
  ClearDebug;
  MainInitForm;
end.
[/code]
Thats how you can add stuff when clicked</description>
    
    <lastBuildDate>Sun, 18 Nov 2007 15:26:44 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@Nashi Nashi]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nashi">@Nashi</a> wrote:</p>
          <blockquote>
              <p>Right click doesn’t count as a click and you can’t use Double and single click cause it will just do onclick twice <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/15</link>
        <pubDate>Sun, 18 Nov 2007 15:26:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-15</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@sonny_bill_9 ``jason]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sonny_bill_9">@sonny_bill_9</a> wrote:</p>
          <blockquote>
              <p>Ok. I thought of that before but your inbox was full,oh why couldnt you use<br>
ListBox1.OnClick := @—; ?<br>
\</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/14</link>
        <pubDate>Sun, 18 Nov 2007 14:17:20 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-14</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@Nashi Nashi]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nashi">@Nashi</a> wrote:</p>
          <blockquote>
              <p>Send me the script in a pm</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/13</link>
        <pubDate>Sun, 18 Nov 2007 11:54:20 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-13</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@sonny_bill_9 ``jason]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sonny_bill_9">@sonny_bill_9</a> wrote:</p>
          <blockquote>
              <p>Hey nashi eh when i add this into my script it just freezes scar any suggestions.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/12</link>
        <pubDate>Fri, 16 Nov 2007 10:02:14 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-12</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@script_owned4 script_owned4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/script_owned4">@script_owned4</a> wrote:</p>
          <blockquote>
              <p>Yes, and all advance form setups such as adding backround and checkboxes, hints, etc.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/11</link>
        <pubDate>Fri, 16 Nov 2007 07:33:29 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-11</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@Nashi Nashi]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nashi">@Nashi</a> wrote:</p>
          <blockquote>
              <p>You guys reckon I should make a tutorial for all the Components of a form O_O?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/10</link>
        <pubDate>Thu, 15 Nov 2007 13:31:01 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-10</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@script_owned4 script_owned4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/script_owned4">@script_owned4</a> wrote:</p>
          <blockquote>
              <p>Now I finally know the use of them!!!</p>
<p>What’s next, checkboxes?</p>
<p>Or do I have to do them before you?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/9</link>
        <pubDate>Thu, 15 Nov 2007 06:56:50 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-9</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@sonny_bill_9 ``jason]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sonny_bill_9">@sonny_bill_9</a> wrote:</p>
          <blockquote>
              <p>Thanks Nashi, this is very useful is there any way that you can explain how to do something when you click on the item;<br>
anyway thanks again</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/8</link>
        <pubDate>Wed, 14 Nov 2007 09:55:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-8</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@Ron Ron]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ron">@Ron</a> wrote:</p>
          <blockquote>
              <p>Hey nashi, nice tutorial and thanks for including my parser.<br>
Don’t forget about sorting a listbox alphabetically by using this:<br>
<span class="bbcode-i">  ListBox1.Sorted := True;</span></p>
<p>and the flash video pointing to ParsingForm.swf is not found.<br>
And can you believe I didn’t know about the ListBox1.ItemIndex? Thanks a lot Nashi. I was using the old way to find the selected box by using a loop and checking each ListBox1.Selected[i]. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>~Ron</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/7</link>
        <pubDate>Tue, 13 Nov 2007 20:23:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-7</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@Nashi Nashi]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nashi">@Nashi</a> wrote:</p>
          <blockquote>
              <p>I just hope it’s what you needed XD<br>
I didn’t cover much SCAR wise manipulation of the contents of a ListBox.</p>
<p>I’m not very good at explaining things so I’d be better off just making a script and commenting XD.</p>
<p>Anyway I’m out</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/6</link>
        <pubDate>Sat, 10 Nov 2007 06:07:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-6</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@sonny_bill_9 ``jason]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sonny_bill_9">@sonny_bill_9</a> wrote:</p>
          <blockquote>
              <p>Thanks nashi i thought you would make a tut sooner or later <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/5</link>
        <pubDate>Sat, 10 Nov 2007 06:06:26 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-5</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@Martin Martin]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/martin">@Martin</a> wrote:</p>
          <blockquote>
              <p>Oh, sorry =\</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/4</link>
        <pubDate>Sat, 10 Nov 2007 04:26:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-4</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@The_Un-Named The Un-Named]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/the_un-named">@The_Un-Named</a> wrote:</p>
          <blockquote>
              <p>[quote=“Martin, post:2, topic:157941”]Congrats on your first tutorial.</p>
<p>But there is a tutorial section at: <a href="http://www.moparisthebest.com/smf/index.php/board,6.0.html%5B/quote%5D" rel="nofollow noopener">http://www.moparisthebest.com/smf/index.php/board,6.0.html[/quote]</a></p>
<p>Mods need to move tutorials there.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/3</link>
        <pubDate>Fri, 09 Nov 2007 22:39:33 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-3</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@Martin Martin]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/martin">@Martin</a> wrote:</p>
          <blockquote>
              <p>Congrats on your first tutorial.</p>
<p>But there is a tutorial section at: <a href="http://www.moparisthebest.com/smf/index.php/board,6.0.html" rel="nofollow noopener">http://www.moparisthebest.com/smf/index.php/board,6.0.html</a></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/2</link>
        <pubDate>Fri, 09 Nov 2007 21:07:56 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-2</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
      <item>
        <title>[TUT]Using Listboxes in Forms[TUT]</title>
        <dc:creator><![CDATA[@Nashi Nashi]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nashi">@Nashi</a> wrote:</p>
          <blockquote>
              <p>Okay,<br>
My first tutorial on MITB,<br>
Made by request from a friend,</p>
<p>Listboxes, As most people would know, Are like a TextArea(For an Example, Where you type is scar is like one) BUT You can’t actually edit directly the text in there, And each line is selected when you click it.</p>
<p>Now although it seems very restricted, It’s also very useful, In that it can hold more then one thing; Like a combo box, But you can view it all at once and it’s unchangable(Directly).</p>
<p>Now before I bore(sp?) you or turn you off ListBoxes, Let me finally show you how to use them!</p>
<p><span class="bbcode-b">Getting Started:</span><br>
Now since a ListBox is used on a form, The first sensible thing to do would be make a form!<br>
Open SCAR(If you haven’t already); Go to Tools —&gt; Form Editor.<br>
Once in the editor, Put a listbox onto your form(It’s the button right of the radio button(If your unsure hover your mouse over each one and a hint will appear))<br>
Simply click the listbox button and click on your form.<br>
Click on the Listbox one it’s on your form until the Object Explorer on the left fills up with stuff xP<br>
Find where it says “Items    |    (TStrings)”(Or Similar)<br>
Click Items and then click the button with … on the right of TStrings.<br>
Enter the text you want in the form that pops up.<br>
Resize either your form or listbox if you wish to.<br>
Also, You must save your form once your happy with it; Remember where though XD</p>
<p>For help, See the movie below:<br>
<a href="http://www.freewebs.com/dafilestorage/Mitch/Tutorials/Listbox/ListboxForm.swf" data-bbcode="true" rel="nofollow noopener">http://www.freewebs.com/dafilestorage/Mitch/Tutorials/Listbox/ListboxForm.swf</a></p>
<p><span class="bbcode-b">Getting the Form into SCAR</span><br>
Once you’ve finished designing and saving your form,<br>
You’ll need to put it into SCAR so that it can run it.<br>
To do this, I use Ron’s DFM Parser(<a href="http://www.moparisthebest.com/smf/index.php/topic,70887.0.html" rel="nofollow noopener">http://www.moparisthebest.com/smf/index.php/topic,70887.0.html</a>);<br>
Once you have that, Load it into SCAR,<br>
Hit run and wait for it to compile,<br>
SCAR will Minimize and a form will pop up,<br>
Click the browse button and locate the Form you saved earlier.<br>
Click Generate Code, Wait for it to fill up the box beneath with some text,<br>
Then click Copy to Clipboard.  That is your Form, In SCAR Form <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>For help, See the movie below:<br>
<a href="http://www.freewebs.com/dafilestorage/Mitch/Tutorials/Listbox/ParsingForm.swf" data-bbcode="true" rel="nofollow noopener">http://www.freewebs.com/dafilestorage/Mitch/Tutorials/Listbox/ParsingForm.swf</a></p>
<p>Once you have that text in SCAR, Run it and see the results.<br>
<span class="bbcode-b"><span class="bbcode-i">Congratulations ^_^; You’ve just made a Listbox</span></span></p>
<p>Now;<br>
This is where the tutorial gets more advanced,<br>
I’ve already gone off topic ALOT in this tutorial and have barely spoken of Listboxes, Now is where you get to use the real stuff =]</p>
<p>The main thing you should worry about a ListBox in SCAR side of it(Like, If you click a button to show what is selected) is:<br>
Items; The thing you used before, To add text into the box.<br>
Items is the list of words which appear in the ListBox, ListBoxName.Items[0] is the first Piece of text in the listbox.<br>
Clear; Deletes all values in the listbox<br>
ItemIndex is probably the only other thing you would be using;<br>
It is an integer which is the current Line selected.</p>
<p>An example of what you could do with this code is:</p>
<p><code>procedure StuffToDoOnClick;
begin
  ShowMessage(ListBox1.Items[ListBox1.ItemIndex]); //Will display the current item selected
end;</code></p>
<p><span class="bbcode-b">SCAR-Wise manipulation of the Listbox</span>(Editing the contents with the script)</p>
<p><code>  Add(S: String): LongInt;
  AddStrings(Strings: TStrings);
  Append(S: String);
  CommaText: String;
  Count: LongInt;
  Delete(Index: LongInt);
  DelimitedText: String;
  Delimiter: Char;
  Equals(Strings: TStrings): Boolean;
  Exchange(Index1, Index2: LongInt);
  IndexOf(S: String): LongInt;
  Insert(Index: LongInt; S: String);
  Move(CurIndex, NewIndex: LongInt);
  Strings: Array of String;
  Text: String;</code><br>
That’s the only methods of Items in a listbox you will probly need to know;<br>
Most are self explanatory, I will briefly go over most of them.</p>
<p>ListBox Items values are organized by Index number, Sort of like an array, Since, Strings is an array.</p>
<p><span class="bbcode-i">Add(S: String): LongInt;</span> <span class="bbcode-b">~</span> Adds S to the end of the values of the list box, And returns the index number of it.<br>
<span class="bbcode-i">Append(S: String);</span> <span class="bbcode-b">~</span> Adds S to the end of the listbox.<br>
<span class="bbcode-i">CommaText: String;</span> <span class="bbcode-b">~</span> Returns all the values of the listbox in 1 string, Seperated by commas<br>
<span class="bbcode-i">Count: LongInt;</span> <span class="bbcode-b">~</span> Returns the number of values in the listbox<br>
<span class="bbcode-i">Delete(Index: LongInt);</span> <span class="bbcode-b">~</span> Removes the value at the index number specified<br>
<span class="bbcode-i">Delimiter: Char;</span> <span class="bbcode-b">~</span> Chooses what to seperate each value by in DelimitedText<br>
<span class="bbcode-i">DelimitedText: String;</span> <span class="bbcode-b">~</span> Returns a string of all values seperated by Delimiter<br>
<span class="bbcode-i">Exchange(Index1, Index2: LongInt);</span> <span class="bbcode-b">~</span> Swaps 2 values specified by index numbers<br>
<span class="bbcode-i">IndexOf(S: String): LongInt;</span> <span class="bbcode-b">~</span> Gets the Index number of the S, If not in the listbox will return -1<br>
<span class="bbcode-i">Insert(Index: LongInt; S: String);</span> <span class="bbcode-b">~</span> Puts S in at the Index number specified<br>
<span class="bbcode-i">Move(CurIndex, NewIndex: LongInt);</span> <span class="bbcode-b">~</span> Moves the value at CurIndex and inserts at NewIndex<br>
<span class="bbcode-i">Strings: Array of String;</span> <span class="bbcode-b">~</span> Strings[Index] returns the value at an index<br>
<span class="bbcode-i">Text: String</span> <span class="bbcode-b">~</span> Returns the exact text of the listbox, With Enter’s and all, Usefull for advanced creation of listboxes and Saving &amp; Loading to files</p>
<p><span class="bbcode-b">Now for an example of each of those methods</span></p>
<p>[code]program New;</p>
<p>var<br>
// InitForm variables.<br>
frmDesign : TForm;<br>
ListBox1 : TListBox;<br>
Buttons1 : TButton;</p>
<p>procedure DoStuffNow(Sender: TObject);<br>
var<br>
Index: Integer;<br>
begin<br>
Buttons1.Visible := False;<br>
Wait(1000);<br>
ListBox1.Clear; //Deletes all Items from the listbox<br>
Wait(5000);<br>
Index  := ListBox1.Items.Add(‘Boom pop bang’); //Adds ‘Boom pop bang’ to the listbox and stores its index number<br>
Wait(5000);<br>
ListBox1.Items.Append(‘Damn, I like Rawr o_O’); //Adds ‘Damn, I like Rawr o_O’ to the listbox<br>
Wait(5000);<br>
ListBox1.Items.Delete(Index); //Will delete Index, Which we defined earlier as ‘Boom pop bang’<br>
Wait(1000);<br>
ListBox1.Items.Delimiter := ‘.’; //Sets the values to be seperated by ‘.’ in Delimited Text<br>
Wait(1000);<br>
GetApplication.MessageBox(ListBox1.Items.DelimitedText,‘Rawr’,0{Ignore the ‘Rawr’ and 0}); //Writes the values of the listbox(Seperated by the Delimiter{’.’}) into the Debug<br>
Wait(1000);<br>
Index := ListBox1.Items.Add(‘Rawr’); //Explained earlier<br>
Wait(1000);<br>
ListBox1.Items.Exchange(Index, 0{First Value}); //Will move around the last thing added to the listbox with the first item<br>
Wait(1000);<br>
Index := ListBox1.Items.IndexOf(‘Damn, I like Rawr o_O’); //Sets the Index variable to that of ‘Damn, I like Rawr o_O’<br>
Wait(1000);<br>
ListBox1.Items.Insert(Index, ‘=Timmae=’); //Will insert ‘=Timmae=’ into the Index as chosen earlier(Will put before ‘Damn, I like Rawr o_O’)<br>
Wait(1000);<br>
ListBox1.Items.Move(Index, 0); //Moves ‘=Timmae=’ To the first slot in the ListBox<br>
Wait(1000);<br>
GetApplication.MessageBox(ListBox1.Items.Strings[Index],‘Rawr’,0{Ignore the ‘Rawr’ and 0}); //Will show the Value now located at Index<br>
Wait(1000);<br>
ListBox1.Items.Text := ‘Rawr’ + Chr(13){Enter} + ‘Whats up’ + Chr(13) + ‘Peeps’; //Edit it to understand it better<br>
Wait(1000);<br>
GetApplication.MessageBox(ListBox1.Items.CommaText,‘Rawr’,0{Ignore the ‘Rawr’ and 0}); //The values seperated by ‘,’<br>
Wait(1000);<br>
end;</p>
<p>// This form was parsed using: DFM Form Parser v.23 by Ron.<br>
procedure InitForm;<br>
begin<br>
frmDesign := CreateForm;<br>
frmDesign.Left := 250;<br>
frmDesign.Top := 114;<br>
frmDesign.Width := 210;<br>
frmDesign.Height := 284;<br>
frmDesign.Caption := ‘frmDesign’;<br>
frmDesign.Color := clBtnFace;<br>
frmDesign.Font.Color := clWindowText;<br>
frmDesign.Font.Height := -11;<br>
frmDesign.Font.Name := ‘MS Sans Serif’;<br>
frmDesign.Font.Style := [];<br>
frmDesign.PixelsPerInch := 96;<br>
ListBox1 := TListBox.Create(frmDesign);<br>
ListBox1.Parent := frmDesign;<br>
ListBox1.Left := 0;<br>
ListBox1.Top := 0;<br>
ListBox1.Width := 201;<br>
ListBox1.Height := 257;<br>
ListBox1.ItemHeight := 13;<br>
ListBox1.Items.Add(‘Rawr’);<br>
ListBox1.Items.Add(‘XD’);<br>
ListBox1.Items.Add(‘Ron’);<br>
ListBox1.Items.Add(‘Zapp’);<br>
ListBox1.Items.Add(‘Lothy’);<br>
ListBox1.Items.Add(‘Mopar’);<br>
ListBox1.Items.Add(‘Bebe’);<br>
ListBox1.Items.Add(‘Solar’);<br>
ListBox1.Items.Add(‘Un Named’);<br>
ListBox1.Items.Add(‘MAD COW!’);<br>
ListBox1.Items.Add(‘Cupcakes’);<br>
ListBox1.TabOrder := 8;<br>
Buttons1 := TButton.Create(frmDesign);<br>
Buttons1.Parent := frmDesign;<br>
Buttons1.left := 5;<br>
Buttons1.height := 15;<br>
buttons1.caption := ‘Rawr’;<br>
buttons1.TabOrder := 9;<br>
Buttons1.OnClick := <span class="mention">@DoStuffNow</span>;<br>
end;</p>
<p>procedure SafeInitForm;<br>
var<br>
V : TVariantArray;<br>
begin<br>
SetArrayLength(V, 0);<br>
ThreadSafeCall(‘InitForm’, V);<br>
end;</p>
<p>procedure ShowInitFormModal;<br>
begin<br>
frmDesign.ShowModal;<br>
end;</p>
<p>procedure SafeShowInitFormModal;<br>
var<br>
V : TVariantArray;<br>
begin<br>
SetArrayLength(V, 0);<br>
ThreadSafeCall(‘ShowInitFormModal’, V);<br>
end;</p>
<p>procedure MainInitForm;<br>
begin<br>
SafeInitForm;<br>
SafeShowInitFormModal;<br>
FreeForm(frmDesign);<br>
end;</p>
<p>begin<br>
ClearDebug;<br>
MainInitForm;<br>
end.[/code]</p>
<p>[code]program New;</p>
<p>var<br>
// InitForm variables.<br>
frmDesign : TForm;<br>
ListBox1 : TListBox;</p>
<p>procedure LeftStuff;      //Called when left clicked<br>
begin<br>
GetApplication.MessageBox(ListBox1.Items[ListBox1.ItemIndex], ‘Rawr’, 16); //Displays currently selected item<br>
end;</p>
<p>procedure RightStuff; //Called when right clicked<br>
begin<br>
Listbox1.Items.Insert(ListBox1.ItemIndex, Readln(‘New Item?’)); //Inserts what the user puts in at the index double clicked<br>
ListBox1.Items.Add(Readln(‘New Item?’)); //Adds what you choose<br>
end;</p>
<p>procedure DoStuff(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Integer);  //Called when a mouse button is down over the listbox<br>
begin                                                                                         //I had to use MouseDown since a right click doesn’t count as a click<br>
if IsMouseButtonDown(False) then<br>
RightStuff<br>
else<br>
LeftStuff;<br>
end;</p>
<p>// This form was parsed using: DFM Form Parser v.23 by Ron.<br>
procedure InitForm;<br>
begin<br>
frmDesign := CreateForm;<br>
frmDesign.Left := 250;<br>
frmDesign.Top := 114;<br>
frmDesign.Width := 210;<br>
frmDesign.Height := 284;<br>
frmDesign.Caption := ‘frmDesign’;<br>
frmDesign.Color := clBtnFace;<br>
frmDesign.Font.Color := clWindowText;<br>
frmDesign.Font.Height := -11;<br>
frmDesign.Font.Name := ‘MS Sans Serif’;<br>
frmDesign.Font.Style := [];<br>
frmDesign.PixelsPerInch := 96;<br>
ListBox1 := TListBox.Create(frmDesign);<br>
ListBox1.Parent := frmDesign;<br>
ListBox1.Left := 0;<br>
ListBox1.Top := 0;<br>
ListBox1.Width := 201;<br>
ListBox1.Height := 257;<br>
ListBox1.ItemHeight := 13;<br>
ListBox1.Items.Add(‘Rawr’);<br>
ListBox1.Items.Add(‘XD’);<br>
ListBox1.Items.Add(‘Ron’);<br>
ListBox1.Items.Add(‘Zapp’);<br>
ListBox1.Items.Add(‘Lothy’);<br>
ListBox1.Items.Add(‘Mopar’);<br>
ListBox1.Items.Add(‘Bebe’);<br>
ListBox1.Items.Add(‘Solar’);<br>
ListBox1.Items.Add(‘Star’);<br>
ListBox1.Items.Add(‘Un Named’);<br>
ListBox1.Items.Add(‘MAD COW!’);<br>
ListBox1.Items.Add(‘Nielsie is cool’);<br>
ListBox1.Items.Add(‘Cupcakes’);<br>
ListBox1.TabOrder := 8;<br>
Listbox1.OnMouseDown := <span class="mention">@DoStuff</span><br>
end;</p>
<p>procedure SafeInitForm;<br>
var<br>
V : TVariantArray;<br>
begin<br>
SetArrayLength(V, 0);<br>
ThreadSafeCall(‘InitForm’, V);<br>
end;</p>
<p>procedure ShowInitFormModal;<br>
begin<br>
frmDesign.ShowModal;<br>
end;</p>
<p>procedure SafeShowInitFormModal;<br>
var<br>
V : TVariantArray;<br>
begin<br>
SetArrayLength(V, 0);<br>
ThreadSafeCall(‘ShowInitFormModal’, V);<br>
end;</p>
<p>procedure MainInitForm;<br>
begin<br>
SafeInitForm;<br>
SafeShowInitFormModal;<br>
FreeForm(frmDesign);<br>
end;</p>
<p>begin<br>
ClearDebug;<br>
MainInitForm;<br>
end.<br>
[/code]<br>
Thats how you can add stuff when clicked</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941/1</link>
        <pubDate>Fri, 09 Nov 2007 18:31:51 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-157941-1</guid>
        <source url="https://forum.moparisthebest.com/t/tut-using-listboxes-in-forms-tut/157941.rss">[TUT]Using Listboxes in Forms[TUT]</source>
      </item>
  </channel>
</rss>
