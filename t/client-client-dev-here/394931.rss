<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Client &amp; Client Dev Here</title>
    <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931</link>
    <description>this is the client we are gonna work off.

http://uppit.com/kwbew719poqw/Client.rar

we need a nice logo, and we gotta find that F2P landscape that we had at RSCAngel one time (who has it?)

if there are any suggestions leave them here. i personally don&#39;t think we should be changing much in the client.

right now use it for testing purposes, i&#39;m trying not to get too much things changed on the client as it&#39;s fine how it is, and since theres no structured way to share the client we will do as little to it as possible.

after you compile, open the jar file up and drag the contents of &#39;putinclient&#39; into the jar file. (for it to be able to launch).</description>
    
    <lastBuildDate>Tue, 07 Feb 2012 17:08:33 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>Personally, I would take the easy way out, to maintain compatibility with non-modified RSC clients as well, like this:</p>
<p>in org.moparscape.msc.gs.phandler.client.PlayerLogin:</p>
<pre><code class="lang-auto">// replace this:
			//username = p.readString(20).trim();
			//password = p.readString(20).trim();

// with this:
			String userPass = p.readString();

			username = userPass.substring(0, 20).trim();
			password = userPass.substring(21, userPass.length()).trim();</code></pre>
<p>It requires no other changes client or server side, doesn’t break compatibility with other RSC clients, and allows the client to send a password with any length.</p>
<p>I’ve tested it in the server and it works with or without hashing the password, including the standard 20-length password.</p>
<p>Anyone see any reasons I shouldn’t commit it?</p>
<p>edit:<br>
or maybe it would be even cleaner to do this:</p>
<pre><code class="lang-auto">// replace this:
			//username = p.readString(20).trim();
			//password = p.readString(20).trim();

// with this:
			username = p.readString(20).trim();
			password = p.readString().trim();</code></pre>
<p>?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/120">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/120</link>
        <pubDate>Tue, 07 Feb 2012 17:08:33 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-120</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“Lothy, post:118, topic:394931”]What do you mean? You’re still using the usual packet format which is:</p>
<p>size [byte]<br>
last payload byte<br>
opcode [byte]<br>
payload</p>
<p>OR</p>
<p>size [short]<br>
opcode [byte]<br>
payload</p>
<p>Nothing would change with regards to packet arrival and processing. The only change would be in the string reading function (which would iterate until it reads a NUL-byte (0) or newline character (10)).[/quote]True, I forgot that we were just changing the payload.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/119">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/119</link>
        <pubDate>Tue, 07 Feb 2012 16:39:41 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-119</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>What do you mean? You’re still using the usual packet format which is:</p>
<p>size [byte]<br>
last payload byte<br>
opcode [byte]<br>
payload</p>
<p>OR</p>
<p>size [short]<br>
opcode [byte]<br>
payload</p>
<p>Nothing would change with regards to packet arrival and processing. The only change would be in the string reading function (which would iterate until it reads a NUL-byte (0) or newline character (10)).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/118">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/118</link>
        <pubDate>Tue, 07 Feb 2012 01:46:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-118</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“Lothy, post:116, topic:394931”]You don’t need to do it that way. Use a delimiter at the end of the string (0 or 10 have been used for various versions of RS2).[/quote]How is that better?  Determining if the packet has completely arrived would probably be more annoying, and if you’re using an actual char it would take two bytes.</p>
<p>Though, the length of a string would be limited to 255 characters my way (which I don’t see happening).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/117">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/117</link>
        <pubDate>Mon, 06 Feb 2012 22:24:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-117</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>You don’t need to do it that way. Use a delimiter at the end of the string (0 or 10 have been used for various versions of RS2).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/116">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/116</link>
        <pubDate>Mon, 06 Feb 2012 22:18:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-116</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“Lothy, post:114, topic:394931”]Just change it in the client so that the password is padded to a length of n, and then read a padded password of length n server side.[/quote]That’s what it currently does.</p>
<p>Another idea would be to have the first byte be the length of the string, then read the correct amount of bytes.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/115">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/115</link>
        <pubDate>Mon, 06 Feb 2012 12:41:46 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-115</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>Just change it in the client so that the password is padded to a length of n, and then read a padded password of length n server side.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/114">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/114</link>
        <pubDate>Mon, 06 Feb 2012 08:18:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-114</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>Just another update, I’ve also implemented optional password hashing into the client, and even with sha-1 which produces 40 characters it logs into the server fine as-is, though I think the server probably only reads/saves the first 20 characters of the ‘password’.</p>
<p>Can the server be changed to work with the old client as well (where a 20 character limit is set) but also accept arbitrarily-long passwords?  I haven’t looked at it, but does anyone familiar have an idea?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/113">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/113</link>
        <pubDate>Mon, 06 Feb 2012 04:04:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-113</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>Ok, unless one of you has better ideas, I’ve decided to use the keys in Base64, url-friendly, encoded form.  Here is the class to generate them, along with all my comments and test code:</p>
<p>[code=java5]import org.moparscape.Base64;</p>
<p>import <a href="http://java.io">java.io</a>.*;<br>
import java.security.Key;<br>
import java.security.KeyPair;<br>
import java.security.KeyPairGenerator;<br>
import java.security.spec.RSAKeyGenParameterSpec;<br>
import java.util.zip.CRC32;<br>
import java.util.zip.CheckedInputStream;<br>
import java.util.zip.CheckedOutputStream;</p>
<p>public class KeyGenerator {</p>
<pre><code>public static void main(String[] args) throws Exception {
    int keyLength = 2048;
    keyLength = 4096;
    /*
    KeyFactory keyFactory = KeyFactory.getInstance("RSA");
    PublicKey pubKey = keyFactory.generatePublic(new X509EncodedKeySpec(new BigInteger("258483531987721813854435365666199783121097212864526576114955744050873252978581213214062885665119329089273296913884093898593877564098511382732309048889240854054459372263273672334107564088395710980478911359605768175143527864461996266529749955416370971506195317045377519645018157466830930794446490944537605962330090699836840861268493872513762630835769942133970804813091619416385064187784658945").toByteArray()));
    byte[] bytes = pubKey.getEncoded();
    printKeys(bytes);
    System.out.println("now with gzip compression: (worse)");
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    Downloader.writeStream(new ByteArrayInputStream(bytes), new GZIPOutputStream(baos));
    printKeys(baos.toByteArray());
    PublicKey p = keyFactory.generatePublic(new X509EncodedKeySpec(Base64.decode(Base64.encodeBytes(bytes, Base64.URL_SAFE), Base64.URL_SAFE)));
    System.out.println("Base64 implementation verified: "+p.equals(pubKey));
    Base64.encodeToFile(bytes, "./public.out");
    Base64.encodeToFile(bytes, "./public.url.out", Base64.URL_SAFE);
    p = keyFactory.generatePublic(new X509EncodedKeySpec(Base64.decodeFromFile("./public.out")));
    System.out.println("Base64 implementation verified: "+p.equals(pubKey));
    p = keyFactory.generatePublic(new X509EncodedKeySpec(Base64.decodeFromFile("./public.url.out", Base64.URL_SAFE)));
    System.out.println("Base64 implementation verified: "+p.equals(pubKey));
    */

    //System.exit(0);

    KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");

    // Generate a key that is 2048 bits long
    RSAKeyGenParameterSpec spec = new RSAKeyGenParameterSpec(keyLength, RSAKeyGenParameterSpec.F4);
    keyGen.initialize(spec);
    KeyPair pair = keyGen.generateKeyPair();
    printKeyPair(pair);
    //printKeys(pair.getPublic().getEncoded());
}

public static void printKeyPair(KeyPair kp) throws Exception {
    printKey(kp.getPrivate(), "private");
    printKey(kp.getPublic(), "public");
}

public static void printKey(Key key, String name) throws Exception {
    String encoded = Base64.encodeBytes(key.getEncoded(), Base64.URL_SAFE);
    System.out.printf("%s: %s\nlength: %d\n", name, encoded, encoded.length());
    String fileName = "./" + name + "key.txt";
    CheckedOutputStream os = new CheckedOutputStream(new FileOutputStream(fileName), new CRC32());
    writeStream(new ByteArrayInputStream(encoded.getBytes()), os);
    long crc = os.getChecksum().getValue();
    System.out.printf("%s key written to: '%s'\ncrc: '%d'\n", name, fileName, crc);
    CheckedInputStream is = new CheckedInputStream(new FileInputStream(fileName), new CRC32());
    writeStream(is, new OutputStream() {
        public void write(int b) {

        }
    });
    if(crc != is.getChecksum().getValue())
        System.out.println("ERROR: file written incorrectly, do not use these!");



}

public static void writeStream(InputStream in, OutputStream out) throws IOException {
    byte[] buffer = new byte[512];
    int len;
    while ((len = in.read(buffer)) &gt;= 0)
        out.write(buffer, 0, len);
    out.close();
}

public static void printKeys(byte[] bytes) throws Exception {
    printKeyType("dec", new java.math.BigInteger(1, bytes).toString());
    printKeyType("hex", new java.math.BigInteger(1, bytes).toString(16));
    printKeyType("b32", new org.moparscape.res.Base32().encode(bytes));
    printKeyType("b64", org.moparscape.Base64.encodeBytes(bytes));
    printKeyType("b64 url-safe", org.moparscape.Base64.encodeBytes(bytes, Base64.URL_SAFE));
    printKeyType("b64 ordered", org.moparscape.Base64.encodeBytes(bytes, Base64.ORDERED));
}

public static void printKeyType(String type, String key) {
    System.out.printf("pubKey %s: %s\nlength: %d\n", type, key, key.length());
}
</code></pre>
<p>}[/code]</p>
<p>The public domain Base64 class I used and added a couple methods to is attached to this post.</p>
<p>So you use this program to generate the privatekey.txt and then create the key on the server like this:</p>
<pre><code class="lang-auto">keyFactory.generatePrivate(new X509EncodedKeySpec(Base64.decodeFromFile("/path/to/privatekey.txt")));</code></pre>
<p>Look good?</p>
<p>edit:<br>
Oh, I also got all the permissions errors fixed with RSA and the RSC client, it was pretty painful, but I can log in and do anything now.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/112">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/112</link>
        <pubDate>Sat, 04 Feb 2012 22:05:06 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-112</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>[quote=“Lothy, post:109, topic:394931”]Public key belongs inside the client; the private key is not readily attackable given a <span class="bbcode-s">private</span> <span class="bbcode-b">public</span> key and modulo (brute force attack notwithstanding).<br>
Private key is used by the server but does not belong in the server source code.[/quote]<br>
Fixed your typo, I understood what you meant though. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/111">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/111</link>
        <pubDate>Thu, 02 Feb 2012 13:32:59 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-111</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@Rodgerwilco Rodgerwilco]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rodgerwilco">@Rodgerwilco</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="109" data-topic="394931">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/lothy/40/51_1.png" class="avatar"> Lothy:</div>
<blockquote>
<p>Private key is used by the server but does not belong in the server source code.</p>
</blockquote>
</aside>
<p>I was wondering about that… +++ can we have bot protection not be open source?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/110">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/110</link>
        <pubDate>Thu, 02 Feb 2012 04:22:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-110</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>[quote=“CodeForFame, post:107, topic:394931”][quote author=Moparisthebest link=topic=492122.msg3904384#msg3904384 date=1328068603]</p>
<p>[quote author=CodeForFame link=topic=492122.msg3903768#msg3903768 date=1328030236]</p>
<aside class="quote">
<blockquote>
<p>You do have to kind-of protect it though.  If Mr. Bad guy were to switch the public key the client receives to his own, the client wouldn’t be able to log onto the server, but Mr. Bad guy already has his password.</p>
<p>Which is why I don’t want the server to send the public key, the client (in this case MoparScape) can grab it itself over some secure or checked medium (like bittorrent or HTTPS).<br>
[/quote]You’re talking about a man-in-the-middle attack.  And at that point they already have more important info, and can get the password through the forum recovery process.</p>
</blockquote>
</aside>
<p>They shouldn’t be able to, as long as the victim uses email only over SSL as well.</p>
<p>Anyhow, as lothy said, in the official client we can simply put the cert directly in the code.  For the generic RSC client though, I’m going to make it user-settable.<br>
[/quote]It shouldn’t be constant, because they can then just work out the private key (or look at the source).[/quote]<br>
Are you serious? Cracking a 2048 bit RSA key is probably still a 20 year job. And as I’ve already said, put it into a text file that the security manager explicitly disallows access to besides the one-time access at runtime by code inside the SecurityManager to obtain the key and the problem is settled.</p>
<p>Public key belongs inside the client; the private key is not readily attackable given a private key and modulo (brute force attack notwithstanding).<br>
Private key is used by the server but does not belong in the server source code.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/109">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/109</link>
        <pubDate>Thu, 02 Feb 2012 03:31:36 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-109</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>[quote=“CodeForFame, post:107, topic:394931”][quote author=Moparisthebest link=topic=492122.msg3904384#msg3904384 date=1328068603]</p>
<p>[quote author=CodeForFame link=topic=492122.msg3903768#msg3903768 date=1328030236]</p>
<aside class="quote">
<blockquote>
<p>You do have to kind-of protect it though.  If Mr. Bad guy were to switch the public key the client receives to his own, the client wouldn’t be able to log onto the server, but Mr. Bad guy already has his password.</p>
<p>Which is why I don’t want the server to send the public key, the client (in this case MoparScape) can grab it itself over some secure or checked medium (like bittorrent or HTTPS).<br>
[/quote]You’re talking about a man-in-the-middle attack.  And at that point they already have more important info, and can get the password through the forum recovery process.</p>
</blockquote>
</aside>
<p>They shouldn’t be able to, as long as the victim uses email only over SSL as well.</p>
<p>Anyhow, as lothy said, in the official client we can simply put the cert directly in the code.  For the generic RSC client though, I’m going to make it user-settable.<br>
[/quote]It shouldn’t be constant, because they can then just work out the private key (or look at the source).[/quote]</p>
<p>It can be directly in the client, the whole point of public/private keys is that you should never be able to figure out the private key with access to only the public key.  Otherwise, encryption would be useless.</p>
<p>But the server should load it from a file.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/108">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/108</link>
        <pubDate>Wed, 01 Feb 2012 17:07:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-108</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:106, topic:394931”][quote author=CodeForFame link=topic=492122.msg3903768#msg3903768 date=1328030236]</p>
<aside class="quote">
<blockquote>
<p>You do have to kind-of protect it though.  If Mr. Bad guy were to switch the public key the client receives to his own, the client wouldn’t be able to log onto the server, but Mr. Bad guy already has his password.</p>
<p>Which is why I don’t want the server to send the public key, the client (in this case MoparScape) can grab it itself over some secure or checked medium (like bittorrent or HTTPS).<br>
[/quote]You’re talking about a man-in-the-middle attack.  And at that point they already have more important info, and can get the password through the forum recovery process.</p>
</blockquote>
</aside>
<p>They shouldn’t be able to, as long as the victim uses email only over SSL as well.</p>
<p>Anyhow, as lothy said, in the official client we can simply put the cert directly in the code.  For the generic RSC client though, I’m going to make it user-settable.[/quote]It shouldn’t be constant, because they can then just work out the private key (or look at the source).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/107">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/107</link>
        <pubDate>Wed, 01 Feb 2012 12:26:16 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-107</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>[quote=“CodeForFame, post:105, topic:394931”][quote author=Moparisthebest link=topic=492122.msg3903463#msg3903463 date=1327976924]<br>
You do have to kind-of protect it though.  If Mr. Bad guy were to switch the public key the client receives to his own, the client wouldn’t be able to log onto the server, but Mr. Bad guy already has his password.</p>
<p>Which is why I don’t want the server to send the public key, the client (in this case MoparScape) can grab it itself over some secure or checked medium (like bittorrent or HTTPS).<br>
[/quote]You’re talking about a man-in-the-middle attack.  And at that point they already have more important info, and can get the password through the forum recovery process.[/quote]<br>
They shouldn’t be able to, as long as the victim uses email only over SSL as well.</p>
<p>Anyhow, as lothy said, in the official client we can simply put the cert directly in the code.  For the generic RSC client though, I’m going to make it user-settable.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/106">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/106</link>
        <pubDate>Wed, 01 Feb 2012 03:56:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-106</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:103, topic:394931”]You do have to kind-of protect it though.  If Mr. Bad guy were to switch the public key the client receives to his own, the client wouldn’t be able to log onto the server, but Mr. Bad guy already has his password.</p>
<p>Which is why I don’t want the server to send the public key, the client (in this case MoparScape) can grab it itself over some secure or checked medium (like bittorrent or HTTPS).[/quote]You’re talking about a man-in-the-middle attack.  And at that point they already have more important info, and can get the password through the forum recovery process.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/105">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/105</link>
        <pubDate>Tue, 31 Jan 2012 17:17:16 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-105</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>If you hardcode the public key into the client (as is done at the moment) then it’s not an issue unless people don’t use the official client. There’s absolutely no reason for a secretive distribution of a public key.<br>
As suggested in one of my previous posts though, do not hard code the private key into the server source code. Use the method I suggested previously and then the security of the private key boils down to the trust placed in the server administrator.</p>
<p>If people aren’t responsible enough to use the official client then that goes beyond the scope of our obligation to protect them. You can’t protect somebody from themself.</p>
<p>EDIT: Here’s the query to create a view over the players table that will not make the password available. You can select from it just as you would the regular player table, but the results returned will not contain the password field.</p>
<pre><code class="lang-auto">CREATE VIEW vw_player_nohashes AS
SELECT `user`, `username`, `pending_deletion`, `group_id`, `owner`, `owner_username`, `sub_expires`, `combat`, `skill_total`, `x`, `y`, `fatigue`, `combatstyle`, `block_chat`, `block_private`, `block_trade`, `block_duel`, `cameraauto`, `onemouse`, `soundoff`, `showroof`, `autoscreenshot`, `combatwindow`, `haircolour`, `topcolour`, `trousercolour`, `skincolour`, `headsprite`, `bodysprite`, `male`, `skulled`, `creation_date`, `creation_ip`, `login_date`, `login_ip`, `playermod`, `loggedin`, `banned`, `muted`, `deaths`, `id`, `online`, `world`, `quest_points`, `eventcd`
FROM pk_players;</code></pre>
<p>And here is the stored procedure to perform the user credential check. The hash argument is VARBINARY instead of VARCHAR to enforce case-sensitive comparisons, otherwise strcmp will act in a case-insensitive manner.<br>
Due to the use of the COALESCE function, this function will return 0 instead of NULL when a record does not exist for the provided username, so you don’t have to worry about checking for NULLs. If it returns 1 then the credentials are valid, otherwise it returns 0 to indicate an incorrect password or non-existent username.</p>
<pre><code class="lang-auto">DELIMITER $$

CREATE FUNCTION validate_user_credentials(username VARCHAR(255), hash VARBINARY(255))
RETURNS BOOL
BEGIN
  RETURN COALESCE(
             strcmp(hash, (SELECT pass FROM pk_players WHERE user = username LIMIT 1) ) = 0, 
             0
         );
END $$</code></pre>
<p>Invoke this stored procedure like so:</p>
<pre><code class="lang-auto">SELECT validate_user_credentials('username', 'password');</code></pre>
<p>All you need to do now is set up a couple of roles in the database and give them the correct permissions. A game_server role should basically have select on every table, minus pk_players, and the view I’ve just provided a query for.<br>
It should also have execute permission on the stored procedure provided.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/104">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/104</link>
        <pubDate>Tue, 31 Jan 2012 02:44:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-104</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>You do have to kind-of protect it though.  If Mr. Bad guy were to switch the public key the client receives to his own, the client wouldn’t be able to log onto the server, but Mr. Bad guy already has his password.</p>
<p>Which is why I don’t want the server to send the public key, the client (in this case MoparScape) can grab it itself over some secure or checked medium (like bittorrent or HTTPS).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/103">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/103</link>
        <pubDate>Tue, 31 Jan 2012 02:28:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-103</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“Lothy, post:101, topic:394931”]Hold on, why are you protecting the public key? That’s safe to put in the client as a plaintext string variable. That’s the whole point of assymetric encryption; you can give the public key away, no worries.</p>
<p>It’s only protecting the private key that’s the issue. :P[/quote]Derp.  I didn’t even think about it, and was just like oh noes.</p>
<p>We can just send it to the client on connect, which really simplifies things.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/102">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/102</link>
        <pubDate>Tue, 31 Jan 2012 02:09:05 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-102</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>Hold on, why are you protecting the public key? That’s safe to put in the client as a plaintext string variable. That’s the whole point of assymetric encryption; you can give the public key away, no worries.</p>
<p>It’s only protecting the private key that’s the issue. <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/101">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/101</link>
        <pubDate>Tue, 31 Jan 2012 01:32:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-101</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>I don’t think you need to worry about the server-side of it, if someone has access to the machine and the right user permissions they already have the key.  I also think, as to getting the public key, that I’ll probably just allow people to both paste the whole thing in as a parameter (if HTTP POST allows a variable that long), or provide a URL to a text file with the key in it.  This can be a torrent or even a HTTPS URL, which should be really hard to hi-jack.</p>
<p>I’m also still going to put the option in the client to send the hash of the password instead of the password in the first place, which I want the official Mopar Classic server to use.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/100">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/100</link>
        <pubDate>Tue, 31 Jan 2012 01:02:57 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-100</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>Here’s a keypair generator for you:</p>
<pre><code class="lang-auto">import java.security.KeyPair;
import java.security.KeyPairGenerator;

/**
 * Created by IntelliJ IDEA.
 * User: dloth
 * Date: 31/01/12
 * Time: 11:21 AM
 * To change this template use File | Settings | File Templates.
 */
public class KeyGenerator {
    
    public static void main(String[] args) throws Exception {
        KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");

        // Generate a key that is 2048 bits long
        RSAKeyGenParameterSpec spec = new RSAKeyGenParameterSpec(2048, RSAKeyGenParameterSpec.F4);
        keyGen.initialize(spec);
        KeyPair pair = keyGen.generateKeyPair();
        System.out.printf("Private key: %s\n\n", pair.getPrivate());
        System.out.printf("Public key: %s\n\n", pair.getPublic());
    }
}</code></pre>
<p>[quote=“CodeForFame, post:98, topic:394931”][quote author=Moparisthebest link=topic=492122.msg3903273#msg3903273 date=1327965560]</p>
<aside class="quote">
<blockquote>
<p>We should properly implement it…  Have the keys hard-coded is not very secure from my understanding.</p>
</blockquote>
</aside>
<p>You have to hard-code the client (public) key, no other way to do that.</p>
<p>But, as you said, if the server (private) key is public, then this whole thing is useless, since anyone can use it to decrypt things.  So, ideally, the private key should be loaded from a file so the server administrator can load it (load a default key if the file doesn’t exist), then distribute a client with the public key.  (or I could have the client download the public key from a specific location…)</p>
<p>edit:<br>
Actually, I will add support in MoparScape for downloading the public key.  Just do the server-side stuff.</p>
<p>edit2:<br>
How would you generate a RSA keypair in the format the client’s use?  As in the string sent to BigInteger.</p>
<p>[/quote]You can always send a key upon login, and have it unique for each user.  This way they’d have to do a man in the middle attack, and it would need to be re-done for each person.</p>
<p>You could get around this by using certificates delivered via SSL every so often (via the website, or automatically while playing the game).  This approach would add another level of security, because then their certificate would have to be hijacked, and we can essentially lock certificates to a specific network/machine.  The system I’m describing is somewhat like GitHub.[/quote]<br>
SSL certificates are bound to an IP address, not the machine. So it’s a possibility if the service being used for hosting offers multiple static IP addresses (one for general use, one for SSL usage).</p>
<p>With that said, there’s nothing wrong with using RSA like we have been. We just need to be careful with how we do it.</p>
<p>If you’re hosting the server on a linux box then create a new user to host it under, and create a file containing the private key and modulo. Give this file 0600 permissions and change its owner to the user that the server will run under so that only the user running the server has access to the file for reading and writing, and then set the JVM security manager using the command line (I think that’s possible with the -D argument?) so that it can’t be usurped by malicious code at runtime.<br>
It should be possible to set the security manager to throw an exception if somebody attempts to access that specific file. All you need to do then is have the security manager internally store the private key and modulo, and expose a public decryption function.<br>
Done and done. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/99">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/99</link>
        <pubDate>Tue, 31 Jan 2012 00:25:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-99</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:97, topic:394931”][quote author=CodeForFame link=topic=492122.msg3903213#msg3903213 date=1327961647]<br>
We should properly implement it…  Have the keys hard-coded is not very secure from my understanding.<br>
[/quote]</p>
<p>You have to hard-code the client (public) key, no other way to do that.</p>
<p>But, as you said, if the server (private) key is public, then this whole thing is useless, since anyone can use it to decrypt things.  So, ideally, the private key should be loaded from a file so the server administrator can load it (load a default key if the file doesn’t exist), then distribute a client with the public key.  (or I could have the client download the public key from a specific location…)</p>
<p>edit:<br>
Actually, I will add support in MoparScape for downloading the public key.  Just do the server-side stuff.</p>
<p>edit2:<br>
How would you generate a RSA keypair in the format the client’s use?  As in the string sent to BigInteger.[/quote]You can always send a key upon login, and have it unique for each user.  This way they’d have to do a man in the middle attack, and it would need to be re-done for each person.</p>
<p>You could get around this by using certificates delivered via SSL every so often (via the website, or automatically while playing the game).  This approach would add another level of security, because then their certificate would have to be hijacked, and we can essentially lock certificates to a specific network/machine.  The system I’m describing is somewhat like GitHub.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/98">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/98</link>
        <pubDate>Mon, 30 Jan 2012 23:50:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-98</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="96" data-topic="394931">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/codeforfame/40/3743_1.png" class="avatar"> CodeForFame:</div>
<blockquote>
<p>We should properly implement it…  Have the keys hard-coded is not very secure from my understanding.</p>
</blockquote>
</aside>
<p>You have to hard-code the client (public) key, no other way to do that.</p>
<p>But, as you said, if the server (private) key is public, then this whole thing is useless, since anyone can use it to decrypt things.  So, ideally, the private key should be loaded from a file so the server administrator can load it (load a default key if the file doesn’t exist), then distribute a client with the public key.  (or I could have the client download the public key from a specific location…)</p>
<p>edit:<br>
Actually, I will add support in MoparScape for downloading the public key.  Just do the server-side stuff.</p>
<p>edit2:<br>
How would you generate a RSA keypair in the format the client’s use?  As in the string sent to BigInteger.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/97">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/97</link>
        <pubDate>Mon, 30 Jan 2012 23:19:20 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-97</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
      <item>
        <title>Client &amp; Client Dev Here</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>We should properly implement it…  Have the keys hard-coded is not very secure from my understanding.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/client-client-dev-here/394931/96">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/client-client-dev-here/394931/96</link>
        <pubDate>Mon, 30 Jan 2012 22:14:07 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-394931-96</guid>
        <source url="https://forum.moparisthebest.com/t/client-client-dev-here/394931.rss">Client &amp; Client Dev Here</source>
      </item>
  </channel>
</rss>
