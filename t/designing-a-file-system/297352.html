<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/designing-a-file-system/297352 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 10:35:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Designing a File System - General Programming - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;ve been looking into compression and storage lately, for a game I&amp;#39;m working on, and I&amp;#39;ve come up with a few ideas on how to create a virtual file system. By file system, I mean something similar to the RuneScape cache.&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="297352.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Designing a File System&#39;" href="297352.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/designing-a-file-system/297352" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/designing-a-file-system/297352" />
<meta property="og:title" content="Designing a File System" />
<meta name="twitter:title" content="Designing a File System" />
<meta property="og:description" content="I’ve been looking into compression and storage lately, for a game I’m working on, and I’ve come up with a few ideas on how to create a virtual file system. By file system, I mean something similar to the RuneScape cache. The goal is to compress (probably gzip) multiple files into a few large ones that can be efficiently transferred and accessed. I’m aware I’m reinventing the wheel, but this is something I would like to learn more about, so consider it an academic exercise for now.  I’ve come up ..." />
<meta name="twitter:description" content="I’ve been looking into compression and storage lately, for a game I’m working on, and I’ve come up with a few ideas on how to create a virtual file system. By file system, I mean something similar to the RuneScape cache. The goal is to compress (probably gzip) multiple files into a few large ones that can be efficiently transferred and accessed. I’m aware I’m reinventing the wheel, but this is something I would like to learn more about, so consider it an academic exercise for now.  I’ve come up ..." />
<meta property="article:published_time" content="2009-08-24T06:04:00+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="297352.html">Designing a File System</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Unhandled.html'><span itemprop='name'>Unhandled</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-24T06:04:00Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:21:49Z' class='post-time'>
              July 31, 2016, 10:21am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’ve been looking into compression and storage lately, for a game I’m working on, and I’ve come up with a few ideas on how to create a virtual file system. By file system, I mean something similar to the RuneScape cache. The goal is to compress (probably gzip) multiple files into a few large ones that can be efficiently transferred and accessed. I’m aware I’m reinventing the wheel, but this is something I would like to learn more about, so consider it an academic exercise for now.<br>
I’ve come up with two ideas so far. Both will start with my own non-gzip header.</p>
<pre><code class="lang-auto">magic : u1
version : u1</code></pre>
<p>Idea <span class="hashtag">#1</span></p>
<pre><code class="lang-auto">dircount : u4
dir
{
    path : string
    filecount : u4
    file
    {
		name : string
		length : u4
		file : byte[length]
    }
}</code></pre>
<p>As you can see it will be recursive to support theoretically limitless directory depth<br>
Then I thought, why not have the metadata at the beginning of the file, then a large blob of the data.<br>
Idea <span class="hashtag">#2</span></p>
<pre><code class="lang-auto">tablecount : u4
dirlist : string[]
filelist : string[]
table
{
	op
	{
		opcode : u1 // 0 = pushdir, 1 = pushfile
		name : string // the file or directory name
                dirptr : u4 // only if pushfile, index on dirlist
		fileptr : u8 // only if pushfile, index on filesdata
                filelen : u4 // only if pushfile, length of file in bytes
	}
}
filesdata : byte[totalfileslength]</code></pre>
<p>Of course this option limits the total length of all files to the max value of an unsigned long which could be avoided by adding blocks or something (probably not necessary, I don’t intend on having huge files).</p>
<p>Hopefully my representations make some sense, if not, is there a standard for describing file formats? The only file format spec I’ve really read is for the JVM.<br>
As you can probably see, I know shit all about this kind of stuff so any input you may have will be valuable.</p>
<p>Another thing I was wondering about is doing integrity checks, CRC32 is probably good, but how to use it…Store the hash in the file then calculate and check against the one in the file? Or send the hash separately from the file and check against that. Or perhaps do both?</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-24T06:23:03Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:21:50Z' class='post-time'>
              July 31, 2016, 10:21am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>c-like structs tend to be a standard way of describing data formats</p>
<p>in your fileheader i would store the checksum, the id of whatever compression/encoding you use for that file, permissions, etc.</p>
<p>i would be more inclined to use blocks than a contiguous stream of bytes for the storage of the data</p>
<p>keep in mind you would also need a checksum for the entire cache</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Unhandled.html'><span itemprop='name'>Unhandled</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-24T07:09:31Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:21:54Z' class='post-time'>
              July 31, 2016, 10:21am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <pre><code class="lang-auto">// the file on disk
struct filesystem
{
	byte magic;
	byte version;
	byte[] checksum;
	block[] blocks;
	cache cache;
}
// represents a constant length byte array of data
struct block
{
	byte[] data; // 1024 (8kb)?
}
// sits above the filesystem
struct cache
{
	directory[] directories;
}
// tree structure of directories, containing files
struct directory
{
	string name;
	file[] files;
	directory[] sub_directories;
}
// represents a series of blocks
struct file
{
	string name;
	int directory; // pointer to an entry in the cache's directory table
	int start_block; // pointer to an entry in the filesystem's block table
	int block_count; // number of blocks the file occupies
	byte[] checksum;
}</code></pre>
<p>EDIT: changed dependency between filesystem and cache.</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-24T21:17:21Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:08Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>in the file structure, you would also need a “block offset” which would refer to until what index in the last block the file occupies. since naturally, you cannot expect the length of the file to be divisible by your block’s length (1024)</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Unhandled.html'><span itemprop='name'>Unhandled</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-24T23:38:46Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:30Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="4" data-topic="297352">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/abraham2119/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> abraham2119:</div>
<blockquote>
<p>in the file structure, you would also need a “block offset” which would refer to until what index in the last block the file occupies. since naturally, you cannot expect the length of the file to be divisible by your block’s length (1024)</p>
</blockquote>
</aside>
<p>Why not just read to the end of the block until you find an EOF marking.</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-24T23:43:59Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:32Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Unhandled, post:5, topic:297352”][quote author=abraham2119 link=topic=393392.msg2928645#msg2928645 date=1251148641]<br>
in the file structure, you would also need a “block offset” which would refer to until what index in the last block the file occupies. since naturally, you cannot expect the length of the file to be divisible by your block’s length (1024)<br>
[/quote]<br>
Why not just read to the end of the block until you find an EOF marking.[/quote]if by an “EOF marking” you mean -1, then there may be a byte that is -1 throughout the file’s data, yet it is not meant to indicate an EOF marking.</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T00:09:13Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:33Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“abraham2119, post:6, topic:297352”][quote author=Unhandled link=topic=393392.msg2928973#msg2928973 date=1251157126]</p>
<aside class="quote no-group">
<blockquote>
<p>in the file structure, you would also need a “block offset” which would refer to until what index in the last block the file occupies. since naturally, you cannot expect the length of the file to be divisible by your block’s length (1024)</p>
</blockquote>
</aside>
<p>Why not just read to the end of the block until you find an EOF marking.<br>
[/quote]if by an “EOF marking” you mean -1, then there may be a byte that is -1 throughout the file’s data, yet it is not meant to indicate an EOF marking.[/quote]</p>
<p>… Do you know what unsigned bytes are?</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T00:12:22Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:34Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“oksuper_, post:7, topic:297352”][quote author=abraham2119 link=topic=393392.msg2928977#msg2928977 date=1251157439]</p>
<aside class="quote no-group">
<blockquote>
<aside class="quote no-group">
<blockquote>
<p>in the file structure, you would also need a “block offset” which would refer to until what index in the last block the file occupies. since naturally, you cannot expect the length of the file to be divisible by your block’s length (1024)</p>
</blockquote>
</aside>
<p>Why not just read to the end of the block until you find an EOF marking.<br>
[/quote]if by an “EOF marking” you mean -1, then there may be a byte that is -1 throughout the file’s data, yet it is not meant to indicate an EOF marking.</p>
</blockquote>
</aside>
<p>… Do you know what unsigned bytes are?[/quote]how is he supposed to read an EOF marking (assuming its -1) if hes reading only unsigned bytes?</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T00:14:55Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:34Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“abraham2119, post:8, topic:297352”][quote author=oksuper_ link=topic=393392.msg2929006#msg2929006 date=1251158953]</p>
<p>[quote author=abraham2119 link=topic=393392.msg2928977#msg2928977 date=1251157439]</p>
<aside class="quote no-group">
<blockquote>
<aside class="quote no-group">
<blockquote>
<p>in the file structure, you would also need a “block offset” which would refer to until what index in the last block the file occupies. since naturally, you cannot expect the length of the file to be divisible by your block’s length (1024)</p>
</blockquote>
</aside>
<p>Why not just read to the end of the block until you find an EOF marking.<br>
[/quote]if by an “EOF marking” you mean -1, then there may be a byte that is -1 throughout the file’s data, yet it is not meant to indicate an EOF marking.</p>
</blockquote>
</aside>
<p>… Do you know what unsigned bytes are?<br>
[/quote]how is he supposed to read an EOF marking (assuming its -1) if hes reading only unsigned bytes?[/quote]</p>
<p>Are you a troll? Or are you seriously that dumb? EOF isn’t ‘read’, it’s returned by fgetc() when the end of the file has been reached. Hence why it returns int and not unsigned char.</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T00:27:24Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:35Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“oksuper_, post:9, topic:297352”][quote author=abraham2119 link=topic=393392.msg2929008#msg2929008 date=1251159142]</p>
<p>[quote author=oksuper_ link=topic=393392.msg2929006#msg2929006 date=1251158953]</p>
<aside class="quote no-group">
<blockquote>
<aside class="quote no-group">
<blockquote>
<aside class="quote no-group">
<blockquote>
<p>in the file structure, you would also need a “block offset” which would refer to until what index in the last block the file occupies. since naturally, you cannot expect the length of the file to be divisible by your block’s length (1024)</p>
</blockquote>
</aside>
<p>Why not just read to the end of the block until you find an EOF marking.<br>
[/quote]if by an “EOF marking” you mean -1, then there may be a byte that is -1 throughout the file’s data, yet it is not meant to indicate an EOF marking.</p>
</blockquote>
</aside>
<p>… Do you know what unsigned bytes are?<br>
[/quote]how is he supposed to read an EOF marking (assuming its -1) if hes reading only unsigned bytes?</p>
</blockquote>
</aside>
<p>Are you a troll? Or are you seriously that dumb? EOF isn’t ‘read’, it’s returned by fgetc() when the end of the file has been reached. Hence why it returns int and not unsigned char.[/quote]…<br>
who said he was EVEN using c or cpp? THIS IS HIS FILE STRUCTURE. + he suggested that he wanted most of his files to be stored in a couple of big ones. which means that when finished reading the contents of one of many files in the compressed file, it does not necessarily mean it has read the end of the compressed file. the EOF markings will be written by his file packer</p>
<p>pretty fucking funny how you love to assume shit</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T00:32:20Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:35Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“abraham2119, post:10, topic:297352”][quote author=oksuper_ link=topic=393392.msg2929011#msg2929011 date=1251159295]</p>
<p>[quote author=abraham2119 link=topic=393392.msg2929008#msg2929008 date=1251159142]</p>
<p>[quote author=oksuper_ link=topic=393392.msg2929006#msg2929006 date=1251158953]</p>
<aside class="quote no-group">
<blockquote>
<aside class="quote no-group">
<blockquote>
<aside class="quote no-group">
<blockquote>
<p>in the file structure, you would also need a “block offset” which would refer to until what index in the last block the file occupies. since naturally, you cannot expect the length of the file to be divisible by your block’s length (1024)</p>
</blockquote>
</aside>
<p>Why not just read to the end of the block until you find an EOF marking.<br>
[/quote]if by an “EOF marking” you mean -1, then there may be a byte that is -1 throughout the file’s data, yet it is not meant to indicate an EOF marking.</p>
</blockquote>
</aside>
<p>… Do you know what unsigned bytes are?<br>
[/quote]how is he supposed to read an EOF marking (assuming its -1) if hes reading only unsigned bytes?</p>
</blockquote>
</aside>
<p>Are you a troll? Or are you seriously that dumb? EOF isn’t ‘read’, it’s returned by fgetc() when the end of the file has been reached. Hence why it returns int and not unsigned char.<br>
[/quote]…<br>
who said he was EVEN using c or cpp? THIS IS HIS FILE STRUCTURE. + he suggested that he wanted most of his files to be stored in a couple of big ones. which means that when finished reading the contents of one of many files in the compressed file, it does not necessarily mean it has read the end of the compressed file. the EOF markings will be written by his file packer</p>
<p>pretty fucking funny how you love to assume shit[/quote]</p>
<p>Nobody said he was using C you moron. It’s just fgetc() tells you what EOF is… /facepalm. Sure looks like you’re going to get banned very soon.</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T00:54:03Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:36Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i knew what EOF was, and in order to check for an EOF marking, you would have to read signed bytes.</p>
<p>banned for what? proving you wrong?</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T00:57:39Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:37Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“abraham2119, post:12, topic:297352”]i knew what EOF was, and in order to check for an EOF marking, you would have to read signed bytes.</p>
<p>banned for what? proving you wrong?[/quote]</p>
<p>EOF is -1 because fgetc() returns unsigned bytes, and so a negative value would be impossible for a legitimate read byte.</p>
<p>And no, you would be banned for:</p>
<p>[ul][li]Being a general moron[/li]<br>
[li]Flaming consistently[/li]<br>
[li]And more![/li][/ul]</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/abraham2119.html'><span itemprop='name'>abraham2119</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T01:02:58Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:37Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“oksuper_, post:13, topic:297352”][quote author=abraham2119 link=topic=393392.msg2929063#msg2929063 date=1251161643]<br>
i knew what EOF was, and in order to check for an EOF marking, you would have to read signed bytes.</p>
<p>banned for what? proving you wrong?<br>
[/quote][/quote]<br>
once again i say: he never stated he is using c or cpp. and as i said before, he wont depend on the input stream’s return value to recognize an EOF marking no matter what language he is using, seeing as there is more than one file archived in the file he is reading.</p>
<p>being a general moron? rifk, u get mad once someone proves you wrong.</p>
<p>edit: i never flamed, and if i did, i apologize.</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T03:06:25Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:23:57Z' class='post-time'>
              July 31, 2016, 10:23am
            </time>
        <span itemprop='position'>#15</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Appears we had some miscommunication. But that doesn’t change the fact you’re acting like a moron.</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T04:41:00Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:24:01Z' class='post-time'>
              July 31, 2016, 10:24am
            </time>
        <span itemprop='position'>#16</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>stop arguing ladies, he will have the length of the file from the header and only read that many bytes</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Unhandled.html'><span itemprop='name'>Unhandled</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-08-25T05:16:37Z'>
            <time itemprop='dateModified' datetime='2016-07-31T10:24:03Z' class='post-time'>
              July 31, 2016, 10:24am
            </time>
        <span itemprop='position'>#17</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>OK so it works (left out hash checks), here are some unit test methods:</p>
<pre><code class="lang-auto">[TestMethod]
public void TestCacheCreation()
{
	int rootDirFileCount = new DirectoryInfo("../../TestDataFiles/").GetFiles().Length
	IFileSystem fs = new NxFileSystem();
	Cache c = new Cache(fs, "../../TestDataFiles/");
	Stream output = new FileStream("UnitTestData.nx", FileMode.Create);
	c.Serialize(output);
	Assert.IsNotNull(c.RootDirectory);
	Assert.AreEqual(rootDirFileCount, c.RootDirectory.Files.Count);
}
[TestMethod]
public void TestCacheLoading()
{
	Cache c = new Cache();
	Stream input = new FileStream("UnitTestData.nx", FileMode.Open);
	c.Deserialize(input);
	int rootDirFileCount = new DirectoryInfo("../../TestDataFiles/").GetFiles().Length
	Assert.IsNotNull(c.RootDirectory);
	Assert.AreEqual(rootDirFileCount, c.RootDirectory.Files.Count);

	PrintDiretoryRecursive(c.RootDirectory);
}
private static void PrintDiretoryRecursive(SEDirectory dir)
{
	Console.WriteLine(dir.Name);
	foreach(SEFile f in dir.Files)
	{
		Console.WriteLine(f.Name);
	}
	foreach(SEDirectory d in dir.Directories)
	{
		PrintDiretoryRecursive(d);
	}
}</code></pre>
<p>That was fun. I’ll now remove it all and just use ICSharpCode.SharpZipLib.</p>
<p>Thanks for your help frank_.</p>
      </div>

      <meta itemprop='headline' content='Designing a File System'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/designing-a-file-system/297352 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 10:35:15 GMT -->
</html>
