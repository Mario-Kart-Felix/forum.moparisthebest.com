<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/667-grand-exchange-please-help/470675 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 12:56:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>667 Grand Exchange [Please Help] - Runescape - moparisthebest.com</title>
    <meta name="description" content="Hello, On my 667 server, there is a dupe going on with the grand exchange. I want to know how to eliminate the +10, +100,+1000 buttons to add the amount of the item so that people can&amp;#39;t click on them. Thanks">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="470675.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;667 Grand Exchange [Please Help]&#39;" href="470675.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/667-grand-exchange-please-help/470675" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/667-grand-exchange-please-help/470675" />
<meta property="og:title" content="667 Grand Exchange [Please Help]" />
<meta name="twitter:title" content="667 Grand Exchange [Please Help]" />
<meta property="og:description" content="Hello,  On my 667 server, there is a dupe going on with the grand exchange. I want to know how to eliminate the +10, +100,+1000 buttons to add the amount of the item so that people can’t click on them.  Thanks" />
<meta name="twitter:description" content="Hello,  On my 667 server, there is a dupe going on with the grand exchange. I want to know how to eliminate the +10, +100,+1000 buttons to add the amount of the item so that people can’t click on them.  Thanks" />
<meta property="article:published_time" content="2012-12-01T22:37:05+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="470675.html">667 Grand Exchange [Please Help]</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/pshaw177.html'><span itemprop='name'>pshaw177</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-01T22:37:05Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:28:05Z' class='post-time'>
              August 4, 2016,  1:28am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hello,<br>
On my 667 server, there is a dupe going on with the grand exchange. I want to know how to eliminate the +10, +100,+1000 buttons to add the amount of the item so that people can’t click on them.<br>
Thanks</p>
      </div>

      <meta itemprop='headline' content='667 Grand Exchange [Please Help]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/khayam.html'><span itemprop='name'>khayam</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-02T00:25:15Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:28:11Z' class='post-time'>
              August 4, 2016,  1:28am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ummm try looking through the ge files and the ge interfaces mite be somewhere there.</p>
      </div>

      <meta itemprop='headline' content='667 Grand Exchange [Please Help]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-02T02:55:07Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:28:18Z' class='post-time'>
              August 4, 2016,  1:28am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Why would you want to disable basic functionality?</p>
      </div>

      <meta itemprop='headline' content='667 Grand Exchange [Please Help]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/pshaw177.html'><span itemprop='name'>pshaw177</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-02T08:15:42Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:28:28Z' class='post-time'>
              August 4, 2016,  1:28am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Like i said, there is a dupe.</p>
      </div>

      <meta itemprop='headline' content='667 Grand Exchange [Please Help]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-02T08:17:47Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:28:28Z' class='post-time'>
              August 4, 2016,  1:28am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="4" data-topic="470675">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/pshaw177/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> pshaw177:</div>
<blockquote>
<p>Like i said, there is a dupe.</p>
</blockquote>
</aside>
<p>Then find what allows the dupe to occur, and remove that, not basic functionality.</p>
<p>Perhaps if you went into more detail about how the dupe occurs, we might be able to help.</p>
<p>After looking (briefly) over the server files that deal with handling the Grand Exchange, I believe that the error is due to repeatedly adding large number together. The limit for an item is about 2.147 billion. So what happens if you add 50 million to 2.100 billion? the number becomes negative. It’s a function of computer arithmetic for ages, and is the result of overflowing (going over) the maximum value.</p>
<p>I’m looking at the code some more, I’ll post a potential fix in just a little bit.</p>
<p>Alright, I’ve got an (acceptable) fix. Look in either the ExchangeHandler, or GrandExchange file (whichever deals with the buying/selling stuff), and in there you’ll see</p>
<pre><code class="lang-auto">	public void acceptOffer(Player player, Type type) {
		int amount = (int) player.geAmount;
		int id = (int) player.geItem;
		int price = (int) player.price;</code></pre>
<p>All you need to do, is right under price, add</p>
<pre><code class="lang-auto">long cost = (long) amount * price;
if (cost &gt; Integer.MAX_VALUE) {
    return;
}</code></pre>
<p>And that will stop the duping glitch for the moment.</p>
<p>There is one problem though. Given the right amount that is being bought, the same error could occur. The cost value (which is know 64-bits long instead of 32-bits) will eventually overflow, and become negative. For an item costing 150m, that number would be 61,489,146,912. As you can see, it is about 30x larger than the maximum value for an integer. Actually now that I think about it, it shouldn’t be possible to get up to such a large number, without client <span class="bbcode-b">AND</span> server protocol modification. I believe client-side it’s probably in a jagex script somewhere so that it won’t go higher than 2b.</p>
<p>The strange part is that there is a duplicate set of code farther down in the method, but it’s completely disregarded. I didn’t look long enough to see why.</p>
<p>EDIT: I see why now. The code is (for those of you who care, and are still reading by this point)</p>
<pre><code class="lang-auto">long totalPrice = price * amount;
if (totalPrice &gt;= Integer.MAX_VALUE || totalPrice &lt; 0) {
    player.sm("The price is too high!");
    return;
}</code></pre>
<p>It’s a subtle problem, and it looks very close to my block of code, with one significant difference.</p>
<pre><code class="lang-auto">long cost = (long) amount * price;</code></pre>
<p>versus</p>
<pre><code class="lang-auto">long total = amount * price;</code></pre>
<p>My code casts the arithmetic to a long, which allows it’s “true” value as the result, whereas the existing code is still performing the math on integers, which allows it to wrap-around to a negative number.</p>
      </div>

      <meta itemprop='headline' content='667 Grand Exchange [Please Help]'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/667-grand-exchange-please-help/470675 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 12:56:21 GMT -->
</html>
