<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Membership System [Help]</title>
    <link>https://forum.moparisthebest.com/t/membership-system-help/555280</link>
    <description>[CENTER]Could somebody help me get this working please?
The membership scroll works and gives the status.
 But only problem is that I set it for 30 seconds and after 30 seconds I could still teleport
to a member&#39;s island. I&#39;m doing something wrong here. 
I think it has something to do with my long that I am doing wrong.
Could anybody please help me out? Thnkx.[/CENTER]
[spoiler=membership system]
public class Membership {
	
	/**
	 * The amount of milliseconds in a month.
	 */
	private static final long MILLISECONDS_IN_A_MONTH = 20000l; //2592000000l
	
	public static void giveMembership(Player player) {
		if (player.getMembershipDate() == null &amp;&amp; !player.getMemRights().isMembersTrue()) {
			player.setMembershipDate(new Timestamp(System.currentTimeMillis() + (MILLISECONDS_IN_A_MONTH)));
		player.getPacketSender().sendMessage(&quot;&lt;col=255&gt;Congratulations on become a pledged member for 30 days@bla@!!!&quot;);
		player.getInventory().delete(*****, 1);
		MemberRights MemRights = null;
		MemRights = MemberRights.MEMBERSHIP_;
		if(MemRights != null &amp;&amp; MemRights != player.getMemRights()) {
			player.setMemRights(MemRights);
		}
		}
	}
	
	public static boolean isConfirmedMember(Player player) {
		checkMembership(player);
		if(player.getMembershipDate() != null &amp;&amp; player.getMembershipDate().after(new Timestamp(System.currentTimeMillis())))
			return true;
		return false;
	}
	
	public static void resetMembership(Player player) {
		player.setLongMembershipDates(null);
	}
	
	public static void checkMembership(Player player) {
		if (!isConfirmedMember(player))
			resetMembership(player);
		MemberRights MemRights = null;
		MemRights = MemberRights.NONE;
		if(MemRights != null &amp;&amp; MemRights != player.getMemRights()) {
			player.setMemRights(MemRights);
		}
	}
[/spoiler]
[spoiler=membership scroll]
case *****: //member&#39;s scroll
			//gives 30 day membership
			if(player.getAmountDonated() &gt;= 20) {
				player.getPacketSender().sendMessage(&quot;@red@You are already a Donator. You may not Redeem this scroll.&quot;);
				return;
			} else if (player.getMemRights().isMembersTrue()) {
				player.getPacketSender().sendMessage(&quot;@red@You already have a Membership ongoing. You may not Redeem this scroll.&quot;);
				return;
			}
				Membership.giveMembership(player);
			break;[/spoiler]
[spoiler=player.java]
private Timestamp membershipDate;
public Long longMembershipDate;
public Player setMembershipDate(Timestamp timestamp) {
		this.membershipDate = timestamp;
		return this;
	}

	public void setLongMembershipDates(Long longMembershipDate) {
		this.longMembershipDate = longMembershipDate;
		return;
	}
	
	public Timestamp getMembershipDate() {
		return membershipDate;
	}[/spoiler]

My problem is that after 30 seconds the player-rights for membership is still there, when it shouldn&#39;t be. I know I&#39;m missing something, but what?

Should be like this in the character&#39;s file when having membership
[code]&quot;membership&quot;: &quot;MEMBERSHIP_&quot;,[/code]
Then this once time is up
[code]&quot;membership&quot;: &quot;NONE&quot;,[/code]

How do I get the system to check when time is up?</description>
    
    <lastBuildDate>Fri, 29 Apr 2016 04:46:09 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/membership-system-help/555280.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Membership System [Help]</title>
        <dc:creator><![CDATA[@imback4more imback4more]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/imback4more">@imback4more</a> wrote:</p>
          <blockquote>
              <p>[quote=“WarTusk-RSPS, post:5, topic:555280”][quote author=imback4more link=topic=674207.msg4507490#msg4507490 date=1461710602]<br>
[CENTER]Could somebody help me get this working please?<br>
The membership scroll works and gives the status.<br>
But only problem is that I set it for 30 seconds and after 30 seconds I could still teleport<br>
to a member’s island. I’m doing something wrong here.<br>
I think it has something to do with my long that I am doing wrong.<br>
Could anybody please help me out? Thnkx.[/CENTER]<br>
[spoiler=membership system]<br>
public class Membership {</p>
<pre><code>/**
 * The amount of milliseconds in a month.
 */
private static final long MILLISECONDS_IN_A_MONTH = 20000l; //2592000000l

public static void giveMembership(Player player) {
	if (player.getMembershipDate() == null &amp;&amp; !player.getMemRights().isMembersTrue()) {
		player.setMembershipDate(new Timestamp(System.currentTimeMillis() + (MILLISECONDS_IN_A_MONTH)));
	player.getPacketSender().sendMessage("&lt;col=255&gt;Congratulations on become a pledged member for 30 days@bla@!!!");
	player.getInventory().delete(*****, 1);
	MemberRights MemRights = null;
	MemRights = MemberRights.MEMBERSHIP_;
	if(MemRights != null &amp;&amp; MemRights != player.getMemRights()) {
		player.setMemRights(MemRights);
	}
	}
}

public static boolean isConfirmedMember(Player player) {
	checkMembership(player);
	if(player.getMembershipDate() != null &amp;&amp; player.getMembershipDate().after(new Timestamp(System.currentTimeMillis())))
		return true;
	return false;
}

public static void resetMembership(Player player) {
	player.setLongMembershipDates(null);
}

public static void checkMembership(Player player) {
	if (!isConfirmedMember(player))
		resetMembership(player);
	MemberRights MemRights = null;
	MemRights = MemberRights.NONE;
	if(MemRights != null &amp;&amp; MemRights != player.getMemRights()) {
		player.setMemRights(MemRights);
	}
}
</code></pre>
<p>[/spoiler]<br>
[spoiler=membership scroll]<br>
case *****: //member’s scroll<br>
//gives 30 day membership<br>
if(player.getAmountDonated() &gt;= 20) {<br>
player.getPacketSender().sendMessage("<a class="mention" href="/u/red">@red</a>@You are already a Donator. You may not Redeem this scroll.");<br>
return;<br>
} else if (player.getMemRights().isMembersTrue()) {<br>
player.getPacketSender().sendMessage("<a class="mention" href="/u/red">@red</a>@You already have a Membership ongoing. You may not Redeem this scroll.");<br>
return;<br>
}<br>
Membership.giveMembership(player);<br>
break;[/spoiler]<br>
[spoiler=player.java]<br>
private Timestamp membershipDate;<br>
public Long longMembershipDate;<br>
public Player setMembershipDate(Timestamp timestamp) {<br>
this.membershipDate = timestamp;<br>
return this;<br>
}</p>
<pre><code>public void setLongMembershipDates(Long longMembershipDate) {
	this.longMembershipDate = longMembershipDate;
	return;
}

public Timestamp getMembershipDate() {
	return membershipDate;
}[/spoiler]
</code></pre>
<p><span class="bbcode-b">My problem is that after 30 seconds the player-rights for membership is still there, when it shouldn’t be. I know I’m missing something, but what?</span></p>
<p>Should be like this in the character’s file when having membership</p>
<pre><code class="lang-auto"></code></pre>
<p>Then this once time is up</p>
<pre><code class="lang-auto"></code></pre>
<p><span class="bbcode-b">How do I get the system to check when time is up?</span><br>
[/quote]What calls the method ‘checkMembership’?</p>
<p>Under that “checkMembership void” I can see that you already have it set so that it will turn your membership to <span class="bbcode-b">none</span>.</p>
<p>MemRights = MemberRights.NONE;</p>
<p>So the way I’d do it is to put it in the -Client ‘Login initialize’- area. So every time a player logs in it will check that player to see if they have more membership time or not. And if they don’t then it will change their membership rights to none.</p>
<p>So I would make it so it’s like:</p>
<p>If(MembershipTime &lt;= 0 {<br>
MemRights = MemberRights.NONE;<br>
}</p>
<p>It would be a good place also to add a message of how much membership time they have left every time they login.</p>
<p>Or add that code in your Client process instead so that it is constantly checking your membership time.</p>
<p>Might be better ways to do it but that’s what I think of on the top of my head.</p>
<p>Edit:Easiest might be just to add that piece of code to the teleport that is checking if you are a member or not.</p>
<p>If (membership == true) {<br>
teleportPlayer;<br>
} else {<br>
message(“You have no more membership time left”);<br>
MemRights = MemberRights.NONE;<br>
}[/quote]</p>
<p>Could you help me out? Skype me kk_killah. Name is omniscient man</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/membership-system-help/555280/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/membership-system-help/555280/6</link>
        <pubDate>Fri, 29 Apr 2016 04:46:09 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-555280-6</guid>
        <source url="https://forum.moparisthebest.com/t/membership-system-help/555280.rss">Membership System [Help]</source>
      </item>
      <item>
        <title>Membership System [Help]</title>
        <dc:creator><![CDATA[@WarTusk-RSPS WarTusk-RSPS]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/wartusk-rsps">@WarTusk-RSPS</a> wrote:</p>
          <blockquote>
              <p>[quote=“imback4more, post:1, topic:555280”][CENTER]Could somebody help me get this working please?<br>
The membership scroll works and gives the status.<br>
But only problem is that I set it for 30 seconds and after 30 seconds I could still teleport<br>
to a member’s island. I’m doing something wrong here.<br>
I think it has something to do with my long that I am doing wrong.<br>
Could anybody please help me out? Thnkx.[/CENTER]<br>
[spoiler=membership system]<br>
public class Membership {</p>
<pre><code>/**
 * The amount of milliseconds in a month.
 */
private static final long MILLISECONDS_IN_A_MONTH = 20000l; //2592000000l

public static void giveMembership(Player player) {
	if (player.getMembershipDate() == null &amp;&amp; !player.getMemRights().isMembersTrue()) {
		player.setMembershipDate(new Timestamp(System.currentTimeMillis() + (MILLISECONDS_IN_A_MONTH)));
	player.getPacketSender().sendMessage("&lt;col=255&gt;Congratulations on become a pledged member for 30 days@bla@!!!");
	player.getInventory().delete(*****, 1);
	MemberRights MemRights = null;
	MemRights = MemberRights.MEMBERSHIP_;
	if(MemRights != null &amp;&amp; MemRights != player.getMemRights()) {
		player.setMemRights(MemRights);
	}
	}
}

public static boolean isConfirmedMember(Player player) {
	checkMembership(player);
	if(player.getMembershipDate() != null &amp;&amp; player.getMembershipDate().after(new Timestamp(System.currentTimeMillis())))
		return true;
	return false;
}

public static void resetMembership(Player player) {
	player.setLongMembershipDates(null);
}

public static void checkMembership(Player player) {
	if (!isConfirmedMember(player))
		resetMembership(player);
	MemberRights MemRights = null;
	MemRights = MemberRights.NONE;
	if(MemRights != null &amp;&amp; MemRights != player.getMemRights()) {
		player.setMemRights(MemRights);
	}
}
</code></pre>
<p>[/spoiler]<br>
[spoiler=membership scroll]<br>
case *****: //member’s scroll<br>
//gives 30 day membership<br>
if(player.getAmountDonated() &gt;= 20) {<br>
player.getPacketSender().sendMessage("<a class="mention" href="/u/red">@red</a>@You are already a Donator. You may not Redeem this scroll.");<br>
return;<br>
} else if (player.getMemRights().isMembersTrue()) {<br>
player.getPacketSender().sendMessage("<a class="mention" href="/u/red">@red</a>@You already have a Membership ongoing. You may not Redeem this scroll.");<br>
return;<br>
}<br>
Membership.giveMembership(player);<br>
break;[/spoiler]<br>
[spoiler=player.java]<br>
private Timestamp membershipDate;<br>
public Long longMembershipDate;<br>
public Player setMembershipDate(Timestamp timestamp) {<br>
this.membershipDate = timestamp;<br>
return this;<br>
}</p>
<pre><code>public void setLongMembershipDates(Long longMembershipDate) {
	this.longMembershipDate = longMembershipDate;
	return;
}

public Timestamp getMembershipDate() {
	return membershipDate;
}[/spoiler]
</code></pre>
<p><span class="bbcode-b">My problem is that after 30 seconds the player-rights for membership is still there, when it shouldn’t be. I know I’m missing something, but what?</span></p>
<p>Should be like this in the character’s file when having membership</p>
<pre><code class="lang-auto"></code></pre>
<p>Then this once time is up</p>
<pre><code class="lang-auto"></code></pre>
<p><span class="bbcode-b">How do I get the system to check when time is up?</span>[/quote]What calls the method ‘checkMembership’?</p>
<p>Under that “checkMembership void” I can see that you already have it set so that it will turn your membership to <span class="bbcode-b">none</span>.</p>
<p>MemRights = MemberRights.NONE;</p>
<p>So the way I’d do it is to put it in the -Client ‘Login initialize’- area. So every time a player logs in it will check that player to see if they have more membership time or not. And if they don’t then it will change their membership rights to none.</p>
<p>So I would make it so it’s like:</p>
<p>If(MembershipTime &lt;= 0 {<br>
MemRights = MemberRights.NONE;<br>
}</p>
<p>It would be a good place also to add a message of how much membership time they have left every time they login.</p>
<p>Or add that code in your Client process instead so that it is constantly checking your membership time.</p>
<p>Might be better ways to do it but that’s what I think of on the top of my head.</p>
<p>Edit:Easiest might be just to add that piece of code to the teleport that is checking if you are a member or not.</p>
<p>If (membership == true) {<br>
teleportPlayer;<br>
} else {<br>
message(“You have no more membership time left”);<br>
MemRights = MemberRights.NONE;<br>
}</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/membership-system-help/555280/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/membership-system-help/555280/5</link>
        <pubDate>Wed, 27 Apr 2016 19:00:37 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-555280-5</guid>
        <source url="https://forum.moparisthebest.com/t/membership-system-help/555280.rss">Membership System [Help]</source>
      </item>
      <item>
        <title>Membership System [Help]</title>
        <dc:creator><![CDATA[@imback4more imback4more]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/imback4more">@imback4more</a> wrote:</p>
          <blockquote>
              <p>[quote=“matzie, post:3, topic:555280”]Umm…</p>
<p>[quote]Init:isConfirmedMember(steve);</p>
<blockquote>
<p>isConfirmedMember(steve)<br>
call to checkMembership(steve)<br>
checkMembership(steve)<br>
call to isConfirmedMember(steve)<br>
isConfirmedMember(steve)<br>
call to checkMembership(steve)<br>
checkMembership(steve)<br>
call to isConfirmedMember(steve)<br>
isConfirmedMember(steve)<br>
call to checkMembership(steve)<br>
checkMembership(steve)<br>
call to isConfirmedMember(steve)<br>
isConfirmedMember(steve)<br>
call to checkMembership(steve)<br>
checkMembership(steve)<br>
call to isConfirmedMember(steve)<br>
…</p>
</blockquote>
<p>[/quote]</p>
<p>There might be something wrong with that code…[/quote]<br>
lol you did isConfirmedMember(player) in the givemembership method.</p>
<p>[quote=“Soulxs, post:2, topic:555280”]I’d say check it when someone is trying to perform a member-only action (to save memory).<br>
So in the teleportation spell to the member island, do something like:</p>
<p><code>
if(!Membership.isConfirmedMember(player)) {
   return;
}
</code>[/quote]</p>
<p>I already have it checked if they are a member or not when they teleport. My problem is the membership status won’t go away. How to fix this?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/membership-system-help/555280/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/membership-system-help/555280/4</link>
        <pubDate>Wed, 27 Apr 2016 17:51:53 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-555280-4</guid>
        <source url="https://forum.moparisthebest.com/t/membership-system-help/555280.rss">Membership System [Help]</source>
      </item>
      <item>
        <title>Membership System [Help]</title>
        <dc:creator><![CDATA[@matzie matzie]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/matzie">@matzie</a> wrote:</p>
          <blockquote>
              <p>Umm…</p>
<blockquote>Init:isConfirmedMember(steve);
&gt;isConfirmedMember(steve)
&gt;call to checkMembership(steve)
&gt;checkMembership(steve)
&gt;call to isConfirmedMember(steve)
&gt;isConfirmedMember(steve)
&gt;call to checkMembership(steve)
&gt;checkMembership(steve)
&gt;call to isConfirmedMember(steve)
&gt;isConfirmedMember(steve)
&gt;call to checkMembership(steve)
&gt;checkMembership(steve)
&gt;call to isConfirmedMember(steve)
&gt;isConfirmedMember(steve)
&gt;call to checkMembership(steve)
&gt;checkMembership(steve)
&gt;call to isConfirmedMember(steve)
...</blockquote>
<p>There might be something wrong with that code…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/membership-system-help/555280/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/membership-system-help/555280/3</link>
        <pubDate>Wed, 27 Apr 2016 17:30:06 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-555280-3</guid>
        <source url="https://forum.moparisthebest.com/t/membership-system-help/555280.rss">Membership System [Help]</source>
      </item>
      <item>
        <title>Membership System [Help]</title>
        <dc:creator><![CDATA[@Soulxs Soulxs]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/soulxs">@Soulxs</a> wrote:</p>
          <blockquote>
              <p>I’d say check it when someone is trying to perform a member-only action (to save memory).<br>
So in the teleportation spell to the member island, do something like:</p>
<pre><code class="lang-auto">if(!Membership.isConfirmedMember(player)) {
   return;
}</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/membership-system-help/555280/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/membership-system-help/555280/2</link>
        <pubDate>Wed, 27 Apr 2016 12:36:01 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-555280-2</guid>
        <source url="https://forum.moparisthebest.com/t/membership-system-help/555280.rss">Membership System [Help]</source>
      </item>
      <item>
        <title>Membership System [Help]</title>
        <dc:creator><![CDATA[@imback4more imback4more]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/imback4more">@imback4more</a> wrote:</p>
          <blockquote>
              <p>[CENTER]Could somebody help me get this working please?<br>
The membership scroll works and gives the status.<br>
But only problem is that I set it for 30 seconds and after 30 seconds I could still teleport<br>
to a member’s island. I’m doing something wrong here.<br>
I think it has something to do with my long that I am doing wrong.<br>
Could anybody please help me out? Thnkx.[/CENTER]<br>
[spoiler=membership system]<br>
public class Membership {</p>
<pre><code>/**
 * The amount of milliseconds in a month.
 */
private static final long MILLISECONDS_IN_A_MONTH = 20000l; //2592000000l

public static void giveMembership(Player player) {
	if (player.getMembershipDate() == null &amp;&amp; !player.getMemRights().isMembersTrue()) {
		player.setMembershipDate(new Timestamp(System.currentTimeMillis() + (MILLISECONDS_IN_A_MONTH)));
	player.getPacketSender().sendMessage("&lt;col=255&gt;Congratulations on become a pledged member for 30 days@bla@!!!");
	player.getInventory().delete(*****, 1);
	MemberRights MemRights = null;
	MemRights = MemberRights.MEMBERSHIP_;
	if(MemRights != null &amp;&amp; MemRights != player.getMemRights()) {
		player.setMemRights(MemRights);
	}
	}
}

public static boolean isConfirmedMember(Player player) {
	checkMembership(player);
	if(player.getMembershipDate() != null &amp;&amp; player.getMembershipDate().after(new Timestamp(System.currentTimeMillis())))
		return true;
	return false;
}

public static void resetMembership(Player player) {
	player.setLongMembershipDates(null);
}

public static void checkMembership(Player player) {
	if (!isConfirmedMember(player))
		resetMembership(player);
	MemberRights MemRights = null;
	MemRights = MemberRights.NONE;
	if(MemRights != null &amp;&amp; MemRights != player.getMemRights()) {
		player.setMemRights(MemRights);
	}
}
</code></pre>
<p>[/spoiler]<br>
[spoiler=membership scroll]<br>
case *****: //member’s scroll<br>
//gives 30 day membership<br>
if(player.getAmountDonated() &gt;= 20) {<br>
player.getPacketSender().sendMessage("<a class="mention" href="/u/red">@red</a>@You are already a Donator. You may not Redeem this scroll.");<br>
return;<br>
} else if (player.getMemRights().isMembersTrue()) {<br>
player.getPacketSender().sendMessage("<a class="mention" href="/u/red">@red</a>@You already have a Membership ongoing. You may not Redeem this scroll.");<br>
return;<br>
}<br>
Membership.giveMembership(player);<br>
break;[/spoiler]<br>
[spoiler=player.java]<br>
private Timestamp membershipDate;<br>
public Long longMembershipDate;<br>
public Player setMembershipDate(Timestamp timestamp) {<br>
this.membershipDate = timestamp;<br>
return this;<br>
}</p>
<pre><code>public void setLongMembershipDates(Long longMembershipDate) {
	this.longMembershipDate = longMembershipDate;
	return;
}

public Timestamp getMembershipDate() {
	return membershipDate;
}[/spoiler]
</code></pre>
<p>My problem is that after 30 seconds the player-rights for membership is still there, when it shouldn’t be. I know I’m missing something, but what?</p>
<p>Should be like this in the character’s file when having membership</p>
<pre><code class="lang-auto"></code></pre>
<p>Then this once time is up</p>
<pre><code class="lang-auto"></code></pre>
<p>How do I get the system to check when time is up?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/membership-system-help/555280/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/membership-system-help/555280/1</link>
        <pubDate>Tue, 26 Apr 2016 22:43:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-555280-1</guid>
        <source url="https://forum.moparisthebest.com/t/membership-system-help/555280.rss">Membership System [Help]</source>
      </item>
  </channel>
</rss>
