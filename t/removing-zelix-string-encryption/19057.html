<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/removing-zelix-string-encryption/19057 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Removing Zelix string encryption - Community Inside Talk - moparisthebest.com</title>
    <meta name="description" content="Out of nostalgia and dismay at the lack of Classic knowledge left in the community, I have been trying to retrieve the source code of old RuneScape Classic bots. Saevion&amp;#39;s deobfuscator is woefully inadequate to the task;&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="19057.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Removing Zelix string encryption&#39;" href="19057.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://img95.imageshack.us/img95/2641/beforexv8.th.png" />
<meta property="og:image" content="http://img95.imageshack.us/img95/2641/beforexv8.th.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/removing-zelix-string-encryption/19057" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/removing-zelix-string-encryption/19057" />
<meta property="og:title" content="Removing Zelix string encryption" />
<meta name="twitter:title" content="Removing Zelix string encryption" />
<meta property="og:description" content="Out of nostalgia and dismay at the lack of Classic knowledge left in the community, I have been trying to retrieve the source code of old RuneScape Classic bots. Saevion’s deobfuscator is woefully inadequate to the task; I hacked it beyond the point of reason before deciding that it would be simpler to write my own program. Having overcome my colossal apathy toward potentially time-consuming projects, I wrote a string decryption component last night.  Everyone knows that the official RuneScape c..." />
<meta name="twitter:description" content="Out of nostalgia and dismay at the lack of Classic knowledge left in the community, I have been trying to retrieve the source code of old RuneScape Classic bots. Saevion’s deobfuscator is woefully inadequate to the task; I hacked it beyond the point of reason before deciding that it would be simpler to write my own program. Having overcome my colossal apathy toward potentially time-consuming projects, I wrote a string decryption component last night.  Everyone knows that the official RuneScape c..." />
<meta property="article:published_time" content="2006-10-20T07:49:30+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="19057.html">Removing Zelix string encryption</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/community-inside-talk.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Community Inside Talk</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Krichevskoy.html'><span itemprop='name'>Krichevskoy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-10-20T07:49:30Z'>
            <time itemprop='dateModified' datetime='2016-07-29T22:53:54Z' class='post-time'>
              July 29, 2016, 10:53pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Out of nostalgia and dismay at the lack of Classic knowledge left in the community, I have been trying to retrieve the source code of old RuneScape Classic bots. Saevion’s deobfuscator is woefully inadequate to the task; I hacked it beyond the point of reason before deciding that it would be simpler to write my own program. Having overcome my colossal apathy toward potentially time-consuming projects, I wrote a string decryption component last night.</p>
<p>Everyone knows that the official RuneScape client is subjected to minimal obfuscation in the interest of compatibility. You are probably aware that Zelix Klassmaster has various options for encrypting constant strings within a class, and that cheat authors often use this in conjunction with the highest control-flow mangling. If you have made a particular study, you are most likely aware that it is a weak XOR cipher.</p>
<p>Usually, ZKM copies all string constants to a static String array and runs them through an XOR algorithm using a randomly generated key array. It then replaces string push instructions with references to the static array. The array is initialized and decrypted inside a static initializer, which contains ZKM’s inlined decryption code. My program works against classes mangled in this way: it copies the keys and strings from the initializer, decrypts them, and replaces the array references with push instructions for whatever string.</p>
<p><a href="http://img95.imageshack.us/my.php?image=beforexv8.png" data-bbcode="true" rel="nofollow noopener"><img src="http://img95.imageshack.us/img95/2641/beforexv8.th.png" alt width="" height=""></a><a href="http://img150.imageshack.us/my.php?image=aftervf6.png" data-bbcode="true" rel="nofollow noopener"><img src="http://img150.imageshack.us/img150/8524/aftervf6.th.png" alt width="" height=""></a></p>
<p>First problem: some classes have multiple string arrays or use a decryption method instead of inlining. I don’t know what triggers Zelix to use these, but countering them should be trivial once I know how to detect them efficiently. I doubt anyone has looked at Zelix in depth, but if you happen to know what distiguishes classes to the string encryption routine, I would appreciate the information.</p>
<p>Secondly, a side effect of including decrypted string constants is a bloated constant pool - the now-unused encrypted constants remain in the pool, sometimes adding kilobytes of size. I know of no efficient method for removing a pool entry and correcting reference indicies. If there is a better way to compress a constant pool than comparing a list of all reference indicies with the constant pool itself, I would appreciate that information as well.</p>
<p>Finally, I have attached the source code to this post - just in case anyone feels like commenting on, improving upon, or using my code <img src="../../images/emoji/twitter/stuck_out_tonguec164.png?v=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
      </div>

      <meta itemprop='headline' content='Removing Zelix string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/pplsuqbawlz.html'><span itemprop='name'>pplsuqbawlz</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-10-20T16:10:11Z'>
            <time itemprop='dateModified' datetime='2016-07-29T22:54:23Z' class='post-time'>
              July 29, 2016, 10:54pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Kriche, gj. That’s not encryption… but alot of +, -, and equals lol!</p>
<p>And krich, there’s an easier way? LOL I know it’s xor’ed 3 ways in the static initiliazer… I’ve cracked this ages ago.</p>
<p>Now, why not reflect the decryptor method? Lol, and replace the method call with it? Doesn’t that just seem more clever and less dependant on that silly array that if anyone with a brain would change in some way to mangle that? Hell BCEL can execute code, cal the code grab the array values and put er der.</p>
<p>ZKM also mangles strings in another  way by replacing strings with a method call to a hashtable, ever tried that one or are you only working on RSC?</p>
      </div>

      <meta itemprop='headline' content='Removing Zelix string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ruler.html'><span itemprop='name'>ruler</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-10-20T16:58:37Z'>
            <time itemprop='dateModified' datetime='2016-07-29T22:54:26Z' class='post-time'>
              July 29, 2016, 10:54pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>“That’s not encryption… but alot of +, -, and equals lol!”<br>
you need to read up encryption, encripytion involves theses!</p>
<p>I think this is for RSC.</p>
      </div>

      <meta itemprop='headline' content='Removing Zelix string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/pplsuqbawlz.html'><span itemprop='name'>pplsuqbawlz</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-10-20T18:11:53Z'>
            <time itemprop='dateModified' datetime='2016-07-29T22:54:34Z' class='post-time'>
              July 29, 2016, 10:54pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Obfuscation does, encryption? Not so much. :-p krypta latin meaning hidden? Cryptology, the field im going into, the study of secret writing.</p>
      </div>

      <meta itemprop='headline' content='Removing Zelix string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BobDole81.html'><span itemprop='name'>BobDole81</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-10-20T18:20:48Z'>
            <time itemprop='dateModified' datetime='2016-07-29T22:54:35Z' class='post-time'>
              July 29, 2016, 10:54pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Looks good Krichevskoy, nice job.  I did something like this a long while ago, but it simply modified the pre-decompiled source instead of the actual class files like yours.  I think the bcel method is nicer though <img src="../../images/emoji/twitter/slight_smilec164.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='Removing Zelix string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/pplsuqbawlz.html'><span itemprop='name'>pplsuqbawlz</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-10-20T18:46:25Z'>
            <time itemprop='dateModified' datetime='2016-07-29T22:54:36Z' class='post-time'>
              July 29, 2016, 10:54pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Agreed! &lt;3</p>
      </div>

      <meta itemprop='headline' content='Removing Zelix string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Krichevskoy.html'><span itemprop='name'>Krichevskoy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-10-21T11:23:11Z'>
            <time itemprop='dateModified' datetime='2016-07-29T22:56:16Z' class='post-time'>
              July 29, 2016, 10:56pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="2" data-topic="19057">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/pplsuqbawlz/40/5_6259e4fa9dfe0dec282fb0955bb1974c.png" class="avatar"> pplsuqbawlz:</div>
<blockquote>
<p>Kriche, gj. That’s not encryption… but alot of +, -, and equals lol!</p>
</blockquote>
</aside>
<p>I assumed it was brainfuck <img src="../../images/emoji/twitter/stuck_out_tonguec164.png?v=9" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>[quote=“pplsuqbawlz, post:2, topic:19057”]Now, why not reflect the decryptor method? Lol, and replace the method call with it? Doesn’t that just seem more clever and less dependant on that silly array that if anyone with a brain would change in some way to mangle that? Hell BCEL can execute code, cal the code grab the array values and put er der.</p>
<p>ZKM also mangles strings in another  way by replacing strings with a method call to a hashtable, ever tried that one or are you only working on RSC?[/quote]</p>
<p>It’s supposed to be a static tool, so reflection doesn’t seem applicable (perhaps I misunderstood you).</p>
<p>Agreed, this is a vulnerable solution - but so is any hack for which someone creates a specific countermeasure. It’s intended to be part of my larger general-anti-Zelix suite, but for now I’m mostly developing this against the playray game applets (I find it easier to analyse Zelix techniques outside the confusion of RuneScape code; also I want to hack minigolf :P) and I haven’t come across any hashtables. What version of ZKM began using it?</p>
<p>Thanks for all the comments.</p>
      </div>

      <meta itemprop='headline' content='Removing Zelix string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-07-12T22:04:55Z'>
            <time itemprop='dateModified' datetime='2016-08-01T13:07:26Z' class='post-time'>
              August 1, 2016,  1:07pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>bumped for usefulness</p>
      </div>

      <meta itemprop='headline' content='Removing Zelix string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-07-13T05:15:35Z'>
            <time itemprop='dateModified' datetime='2016-08-01T13:07:55Z' class='post-time'>
              August 1, 2016,  1:07pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>useful it is.</p>
      </div>

      <meta itemprop='headline' content='Removing Zelix string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/removing-zelix-string-encryption/19057 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:09 GMT -->
</html>
