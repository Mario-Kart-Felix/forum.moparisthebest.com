<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/numberformatexception-cache-updater-please-help/546877 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>NumberFormatException cache updater Please Help! - Game Development - moparisthebest.com</title>
    <meta name="description" content="Hey guys I am in need of deperate help. I am trying to use dropbox to host my cache and cacheversion.text file to download my cache for my RSPS. Dropbox&amp;#39;s serve for some reason gives an error when uploading the text docu&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="546877.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;NumberFormatException cache updater Please Help!&#39;" href="546877.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png" />
<meta property="og:image" content="https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/numberformatexception-cache-updater-please-help/546877" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/numberformatexception-cache-updater-please-help/546877" />
<meta property="og:title" content="NumberFormatException cache updater Please Help!" />
<meta name="twitter:title" content="NumberFormatException cache updater Please Help!" />
<meta property="og:description" content="Hey guys I am in need of deperate help. I am trying to use dropbox to host my cache and cacheversion.text file to download my cache for my RSPS. Dropbox’s serve for some reason gives an error when uploading the text document in ANSI coding. I changed it to UTF-8 and now it works. (note the cacheversion.text is in UTF-8 coding) I dont know if that matters. But now when my cacheupdater loads the file i get a NumberFormatException error when trying to convert the string to an integer. The text docu..." />
<meta name="twitter:description" content="Hey guys I am in need of deperate help. I am trying to use dropbox to host my cache and cacheversion.text file to download my cache for my RSPS. Dropbox’s serve for some reason gives an error when uploading the text document in ANSI coding. I changed it to UTF-8 and now it works. (note the cacheversion.text is in UTF-8 coding) I dont know if that matters. But now when my cacheupdater loads the file i get a NumberFormatException error when trying to convert the string to an integer. The text docu..." />
<meta property="article:published_time" content="2014-09-20T19:16:40+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="546877.html">NumberFormatException cache updater Please Help!</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming/game-development.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Game Development</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/freaxx.html'><span itemprop='name'>freaxx</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-09-20T19:16:40Z'>
            <time itemprop='dateModified' datetime='2016-08-04T13:48:29Z' class='post-time'>
              August 4, 2016,  1:48pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hey guys I am in need of deperate help. I am trying to use dropbox to host my cache and cacheversion.text file to download my cache for my RSPS. Dropbox’s serve for some reason gives an error when uploading the text document in ANSI coding. I changed it to UTF-8 and now it works. (note the cacheversion.text is in UTF-8 coding) I dont know if that matters. But now when my cacheupdater loads the file i get a NumberFormatException error when trying to convert the string to an integer. The text document only has the characters 1.0 saved inside. I cannot understand why it wont work!</p>
<p>I get a 460 error when the document wont get hosted under ANSI coding. With UTF-8 coding it works fine on server just get the number format exception.</p>
<p>Please help me and request code for my cachedownloader/client/whatever you need and I will post it!</p>
<p>Your help is immensely appreciated!<br>
photos:</p>
<p><a href="https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png" data-bbcode="true" rel="nofollow noopener">https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png</a><br>
<a href="https://www.dropbox.com/s/co6xlgw9pf9n838/22222.png" data-bbcode="true" rel="nofollow noopener">https://www.dropbox.com/s/co6xlgw9pf9n838/22222.png</a><br>
<a href="https://www.dropbox.com/s/6je0do4po0grume/222.png" data-bbcode="true" rel="nofollow noopener">https://www.dropbox.com/s/6je0do4po0grume/222.png</a></p>
<p><img src="https://www.dropbox.com/s/0mrw9ml1vrug41n/151.png" alt width="" height=""><br>
<img src="https://www.dropbox.com/s/co6xlgw9pf9n838/22222.png" alt width="" height=""><br>
<img src="https://www.dropbox.com/s/6je0do4po0grume/222.png?dl=0" alt width="" height=""></p>
<p><span class="bbcode-b">UPDATE! - I put dl. in front of the file and now it downloads the .text file but since its not ANSI coding its getting a string like $;'1.0 or something like that instead of just 1.0. Does anyone have a host site that works just like dropbox where you can make it DIRECTLY download without clicking a button because dropbox gives me a 460 error if the documents in ANSI coding? Which is default?</span></p>
<p>updatecache.java file -</p>
<p>[code]import java.net.URL;<br>
import java.net.URLConnection;<br>
import java.util.zip.<em>;<br>
import sign.signlink;<br>
import <a href="http://java.io/" rel="nofollow noopener">java.io</a>.</em>;<br>
import javax.swing.JOptionPane;</p>
<p>public class UpdateCache implements Runnable {</p>
<pre><code>    public static final String ZIP_URL = "https://www.dropbox.com/s/hsnkfyohgofpbrv/------------.zip";
    public static final String VERSION_URL = "https://www.dropbox.com/s/zoexsmc6ddgsa0j/cacheVersion.text";
    public static final String VERSION_FILE = sign.signlink.findcachedir()+"cacheVersion.dat";
    private client client;
    client frame;
public UpdateCache(client client) {
            this.client = client;
}
            
private void drawLoadingText(int amount, String text) {
            client.drawLoadingText(amount, text);
}
    
    public double getCurrentVersion(){
            try {
                    BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(VERSION_FILE)));
                    return Double.parseDouble(br.readLine());
            } catch (Exception e) {
                    return 0.1;
            }
    }
    
    public double getNewestVersion(){
            try {
                    URL tmp = new URL(VERSION_URL);
                    BufferedReader br = new BufferedReader(new InputStreamReader(tmp.openStream()));
                    return Double.parseDouble(br.readLine());
            } catch (Exception e) {
                    handleException(e);
                    return -1;
            }
    }
    
    private void handleException(Exception e){
            StringBuilder strBuff = new StringBuilder();
            strBuff.append("Please Screenshot this message, and send it to an admin!\r\n\r\n");
    StringBuilder append = strBuff.append(e.getClass().getName()).append(" \"").append(e.getMessage()).append("\"\r\n");
            for(StackTraceElement s : e.getStackTrace())
                    strBuff.append(s.toString()).append("\r\n");
            alert("Exception [" + e.getClass().getSimpleName() + "]",strBuff.toString(),true);
    }
    
    private void alert(String msg){
            alert("Message",msg,false);
    }
    
    private void alert(String title,String msg,boolean error){
            JOptionPane.showMessageDialog(null,
                       msg,
                       title,
                        (error ? JOptionPane.ERROR_MESSAGE : JOptionPane.PLAIN_MESSAGE));
    }
    
    @Override
    public void run() {
    drawLoadingText(0, "Checking Versions");
            try{
            double newest = getNewestVersion();
            if(newest &gt; this.getCurrentVersion()){
                    int n = JOptionPane.showConfirmDialog(
                                null,
                                "There is an update to version " + newest + "\n" +
                                    "Would you like to update?",
                                "Current version: "+ getCurrentVersion(),
                                JOptionPane.YES_NO_OPTION);
                    if(n == 0){
                            updateClient();
                            drawLoadingText(0, "Cache has been updated, please restart the client!");
                            alert("Cache has been updated, please restart the client!");
                            OutputStream out = new FileOutputStream(VERSION_FILE);
                            out.write(String.valueOf(newest).getBytes());;
                            System.exit(0);
                    }else{
                            alert(" Your client may not load correct " +
                            getCurrentVersion());
                            //System.exit(0);
                    }
            }
            }catch(Exception e){
                    handleException(e);
            }
    }
    
    private void updateClient() {
            File clientZip = downloadClient();
            if(clientZip != null){
            unZip(clientZip);
            }
    }
    
    private void unZip(File clientZip) {
            try {
                    unZipFile(clientZip,new File(sign.signlink.findcachedir()));
                    clientZip.delete();
            } catch (IOException e) {
                    handleException(e);
            }
    }
    
    private void unZipFile(File zipFile,File outFile) throws IOException{
            ZipInputStream zin = new ZipInputStream(new BufferedInputStream(new FileInputStream(zipFile)));
            ZipEntry e;
            long max = 0;
            long curr = 0;
            while((e = zin.getNextEntry()) != null)
                    max += e.getSize();
            zin.close();
            ZipInputStream in = new ZipInputStream(new BufferedInputStream(new FileInputStream(zipFile)));
            while((e = in.getNextEntry()) != null){
                    if(e.isDirectory())
                            new File(outFile,e.getName()).mkdirs();
                    else{
                            FileOutputStream out = new FileOutputStream(new File(outFile,e.getName()));
                            byte[] b = new byte[1024];
                            int len;
                            while((len = in.read(b,0,b.length)) &gt; -1){
                                    curr += len;
                                            out.write(b, 0, len);
                                            setUnzipPercent((int)((curr * 100) / max));
                            }
                            out.flush();
                            out.close();
                    }
            }
    }

    public int percent = 0;
    
    public void setDownloadPercent(int amount){
            percent = amount;
                    drawLoadingText(amount, "Downloading Cache" + " - " + amount + "%");
    }
    
    public int percent2 = 0;
    
    public void setUnzipPercent(int amount2){
            percent2 = amount2;
                    drawLoadingText(amount2, "Extracting Cache" + " - " + amount2 + "%");
    }

    private File downloadClient(){
            File ret = new File(signlink.findcachedir()+"cache.zip");
            try{
            OutputStream out = new FileOutputStream(ret);
            URLConnection conn = new URL(ZIP_URL).openConnection();
            InputStream in = conn.getInputStream();
            long max = conn.getContentLength();
            long curr = 0;
            byte[] b = new byte[1024];
            int len;
            while((len = in.read(b, 0, b.length)) &gt; -1){
                    out.write(b,0,len);
                    curr += len;
                    setDownloadPercent((int)((curr * 100) / max));
            }
            out.flush();
            out.close();
            in.close();
            return ret;
            }catch(Exception e){
                    handleException(e);
                            ret.delete();
                    return null;
            }
    }
</code></pre>
<p>}<br>
[/code]</p>
      </div>

      <meta itemprop='headline' content='NumberFormatException cache updater Please Help!'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/numberformatexception-cache-updater-please-help/546877 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:47 GMT -->
</html>
