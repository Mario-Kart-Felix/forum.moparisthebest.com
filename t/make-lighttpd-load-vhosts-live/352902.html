<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/make-lighttpd-load-vhosts-live/352902 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:30 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Make lighttpd load vhosts live? - Technology - moparisthebest.com</title>
    <meta name="description" content="My site lets people add their own vhost entries that all point to the same directory, but are handled differently by a PHP script. The domains are stored in a MySQL table and are loaded when lighttpd starts, by automatic&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="352902.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Make lighttpd load vhosts live?&#39;" href="352902.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/make-lighttpd-load-vhosts-live/352902" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/make-lighttpd-load-vhosts-live/352902" />
<meta property="og:title" content="Make lighttpd load vhosts live?" />
<meta name="twitter:title" content="Make lighttpd load vhosts live?" />
<meta property="og:description" content="My site lets people add their own vhost entries that all point to the same directory, but are handled differently by a PHP script. The domains are stored in a MySQL table and are loaded when lighttpd starts, by automatically running a python script referenced in the lighttpd config file.  But yeah, when someone adds a new vhost, it only works when I manually restart lighttpd. Is there a way to make lighttpd check for new vhosts, or read them live?  I thought of making a script that checks for ne..." />
<meta name="twitter:description" content="My site lets people add their own vhost entries that all point to the same directory, but are handled differently by a PHP script. The domains are stored in a MySQL table and are loaded when lighttpd starts, by automatically running a python script referenced in the lighttpd config file.  But yeah, when someone adds a new vhost, it only works when I manually restart lighttpd. Is there a way to make lighttpd check for new vhosts, or read them live?  I thought of making a script that checks for ne..." />
<meta property="article:published_time" content="2010-08-04T14:32:08+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="352902.html">Make lighttpd load vhosts live?</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/technology.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Technology</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/xx_matty_xx.html'><span itemprop='name'>xx_matty_xx</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-08-04T14:32:08Z'>
            <time itemprop='dateModified' datetime='2016-07-31T18:20:39Z' class='post-time'>
              July 31, 2016,  6:20pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>My site lets people add their own vhost entries that all point to the same directory, but are handled differently by a PHP script. The domains are stored in a MySQL table and are loaded when lighttpd starts, by automatically running a python script referenced in the lighttpd config file.</p>
<p>But yeah, when someone adds a new vhost, it only works when I manually restart lighttpd. Is there a way to make lighttpd check for new vhosts, or read them live?</p>
<p>I thought of making a script that checks for new vhosts and restarts lighttpd when a change is detected, but that’s probably a bad thing to do?</p>
      </div>

      <meta itemprop='headline' content='Make lighttpd load vhosts live?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Mopman.html'><span itemprop='name'>Mopman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-08-04T15:51:24Z'>
            <time itemprop='dateModified' datetime='2016-07-31T18:20:43Z' class='post-time'>
              July 31, 2016,  6:20pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>That’s what the control panels such as CPanel do. Though you don’t need to restart, just reload. There’s also no need to make it a separate script, just do it when you add one.</p>
      </div>

      <meta itemprop='headline' content='Make lighttpd load vhosts live?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/xx_matty_xx.html'><span itemprop='name'>xx_matty_xx</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-08-04T16:46:31Z'>
            <time itemprop='dateModified' datetime='2016-07-31T18:20:45Z' class='post-time'>
              July 31, 2016,  6:20pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Omg I didn’t know there was a parameter to just reload the config, I’ll do that instead. About the script though - I thought restarting (or reloading) the server directly from PHP would be problematic, because it wouldn’t be root. Executing scripts as root from PHP also scares me a little…</p>
      </div>

      <meta itemprop='headline' content='Make lighttpd load vhosts live?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Mopman.html'><span itemprop='name'>Mopman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-08-04T16:57:02Z'>
            <time itemprop='dateModified' datetime='2016-07-31T18:20:46Z' class='post-time'>
              July 31, 2016,  6:20pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Well, with cpanel the process which makes the changes isn’t the frontend iirc, the frontend passes stuff into a queue that the backend picks up on.</p>
<p>You could also run the php script as a user who is allowed to do what it needs to do via sudo but nothing else.</p>
      </div>

      <meta itemprop='headline' content='Make lighttpd load vhosts live?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-08-05T03:45:29Z'>
            <time itemprop='dateModified' datetime='2016-07-31T18:21:22Z' class='post-time'>
              July 31, 2016,  6:21pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’d basically do what you said in a cronjob.  Detect whether new vhosts have been added and then reload the config, it would be such a light job you could do it every minute even.</p>
      </div>

      <meta itemprop='headline' content='Make lighttpd load vhosts live?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/xx_matty_xx.html'><span itemprop='name'>xx_matty_xx</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-08-05T10:54:58Z'>
            <time itemprop='dateModified' datetime='2016-07-31T18:21:47Z' class='post-time'>
              July 31, 2016,  6:21pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Alright, I thought I’d have a go at doing it in python -</p>
<pre><code class="lang-auto">#!/usr/bin/python

import MySQLdb
import time
import os

# Establish a connection

db = MySQLdb.connection(host="localhost",
                user="lighttpd",
                passwd="bacon",
                db="lighttpd")

latestTime = 0

while 1:
  # Get the time of the last domain added
  db.query("""SELECT time_added FROM domains ORDER BY time_added DESC LIMIT 1""")
  r = db.store_result()
  row = r.fetch_row()
  thisTime = row[0][0]
  # Has the latest time changed?
  if thisTime != latestTime:
    latestTime = thisTime
    print "Reloading vhosts"
    result = os.popen("sudo /etc/init.d/lighttpd reload", "r").read()
    print result
  else:
    print "No new vhosts"
  time.sleep(60)</code></pre>
<p>Is that as efficient as I can make it?</p>
      </div>

      <meta itemprop='headline' content='Make lighttpd load vhosts live?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-08-05T18:10:24Z'>
            <time itemprop='dateModified' datetime='2016-07-31T18:22:09Z' class='post-time'>
              July 31, 2016,  6:22pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>That looks about efficient as you can make it by querying the database, I probably would have echo’d the latest update time to a file and just read it in from there, but both methods are good.</p>
      </div>

      <meta itemprop='headline' content='Make lighttpd load vhosts live?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Wizzup.html'><span itemprop='name'>Wizzup</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-09-04T21:28:52Z'>
            <time itemprop='dateModified' datetime='2016-07-31T19:06:41Z' class='post-time'>
              July 31, 2016,  7:06pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Sorry for the slight bump but if your OS for some reason does not have the reload option or you do not want to use it, you can still just send lighttpd the HUP signal (SIGHUP) and it will reload the config files similar to sshd.</p>
      </div>

      <meta itemprop='headline' content='Make lighttpd load vhosts live?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/KO9.html'><span itemprop='name'>KO9</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-09-26T10:02:53Z'>
            <time itemprop='dateModified' datetime='2016-08-01T00:03:04Z' class='post-time'>
              August 1, 2016, 12:03am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This looks really useful. I’ve been using lighttpd for about a year now. Do you mind posting the relevant part of the lighttpd config file?</p>
      </div>

      <meta itemprop='headline' content='Make lighttpd load vhosts live?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Wizzup.html'><span itemprop='name'>Wizzup</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-10-06T15:35:47Z'>
            <time itemprop='dateModified' datetime='2016-08-01T00:13:06Z' class='post-time'>
              August 1, 2016, 12:13am
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>AFAIK live reloading doesn’t require a specific config file, you just send it the HUP signal and it reloads the config.</p>
      </div>

      <meta itemprop='headline' content='Make lighttpd load vhosts live?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/make-lighttpd-load-vhosts-live/352902 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:30 GMT -->
</html>
