<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>My working version of InPin() [ InPinEx() ]</title>
    <link>https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162</link>
    <description>Well I didn&#39;t know where to post this.

SRL&#39;s 2.01 InPin() isn&#39;t working, at least for me, so I decided to make my own InPin function.

I haven&#39;t tested it too much yet but it seems to work well. Feel free to use it and if you find any bug or it doesn&#39;t work for you post here or send a PM (hopefully with enough info for me to know what&#39;s happenning). TY :)

Semi Off-Topic: I&#39;m still wanting to join SRL :(


Edit: Forgot to say (kinda obvious but...) that it is not a stand-alone script, it&#39;s just a function, and that it requires SRL (tested with version 2.01).
Also, feel free to suggest improvements.

[code]
// Function: bool InPinEx(int)
// Author: zstars
// Purpose &amp; Usage:
//         This function will check if the pin window is open. If it is, it will
//         try to insert the pin. It will use the question marks to check if it
//         was inserted. However, the last digit can&#39;t really be checked and
//         it is a non-blocking function, so it is your duty to check whether the
//         bank was successfully opened or not. (Use BankScreen())
function InPinEx(pin : String) : Boolean;
var
  i: Integer;
  x, y: Integer;
  b : array [0..10] of Integer;
  bres: boolean;
begin

  b[0] := BitmapFromString(8, 11, &#39;z78DA33304000370C60800360AAC1&#39; +
       &#39;A58B187152CDC1AF9E1859F2D413E33B52D5931A9E0664C517F10&#39; +
       &#39;000287879B1&#39;);
  b[1] := BitmapFromString(7, 11, &#39;z78DA333040003724608003B86100&#39; +
       &#39;62D4E0379378DB87934A372280018900008525648D&#39;);
  b[2] := BitmapFromString(7, 11, &#39;z78DA33300001371CC00009902A8E&#39; +
       &#39;0B10AF9E189543518D01DE30C71F0BF801008CB06595&#39;);
  b[4] := BitmapFromString(8, 11, &#39;z78DA73734300032280DBA0578FDF&#39; +
       &#39;047AAAC70F062AC4F00300632B72FD&#39;);
  b[3] := BitmapFromString(7, 11, &#39;z78DA33300001371CC00009902A8E&#39; +
       &#39;092857498C3B69673B312A29093D527D840900A4FD6619&#39;);
  b[5] := BitmapFromString(8, 11, &#39;z78DA7373230C0C90002E715C8012&#39; +
       &#39;F5A4EA25CF46FAFB8B12716A85122E000093B47279&#39;);
  b[6] := BitmapFromString(8, 11, &#39;z78DA33304000370C60800360AAC1&#39; +
       &#39;A58B18D3A8A59E18F7E352439EFB893787545B488D05E2430C3F0&#39; +
       &#39;000E75E7591&#39;);
  b[7] := BitmapFromString(7, 11, &#39;z78DA7373230C0CF00262548E9A46&#39; +
       &#39;894AE2010048E26301&#39;);
  b[8] := BitmapFromString(8, 11, &#39;z78DA33304000370C60800360AAC1&#39; +
       &#39;A50BBF69C4EB22D55503E5FEC1E95FE20100FFAB7615&#39;);
  b[9] := BitmapFromString(8, 11, &#39;z78DA3330000137BCC00009E012C7&#39; +
       &#39;254B6BF5E4891B90E86B5C60A8ABC70400AAA87489&#39;);


  // If there is no red where there should or if the bank screen is already open.
  if (GetColor(136, 40) &lt;&gt; 255) and (GetColor(202, 39) &lt;&gt; 255) or (BankScreen) then
   begin
    Result := True;
    Exit;
   end;
   
   
  for i := 1 to Length(Pin) do
  begin
    // just in case.
    x := 395;
    y := 175;
    MMouse(395, 175, 10, 10);
    Wait(100+Random(200));
    bres := false;
    
    // Try to find the digit bitmap.
    bres := FindBitmapMaskTolerance(b[strtoint(Pin[i])], x, y,  26, 97, 423, 322, 10, 40);
    if(bres = false) then
     begin
        bres := false;
        // A second try.
        bres := FindBitmapMaskTolerance(b[strtoint(Pin[i])], x, y,  26, 97, 423, 322, 10, 40);
        if(bres = false) then
         begin
          Result := false;
          Exit;
         end;
     end;
    Wait(500 + Random(500));
    
    
    // If the bitmap was found.
    if(bres = true) then
     begin
     
         // Hit twice, fast, because otherwise sometimes it seems to fail.
         Mouse(x+Random(2), y + Random(2), 2 , 0, True);
         Sleep(25+Random(25));
         Mouse(x+Random(2), y + Random(2), 2 , 0, True);
         
         Wait(600+Random(100));
         
         // Make sure the last digit was in fact entered.
         // Note: Can&#39;t really check whether the last one was entered or not.
         //       It assumes it did, but you have to check whether the bank opened.
         
         if(i = 1) then
          begin
            if(GetColor(435, 35) = 65535) then
             begin
              writeln(&#39;First digit failed&#39;);
              Exit;
             end;
          end
          
         else if(i = 2) then
          begin
            if(GetColor(452, 35) = 65535) then
              begin
              writeln(&#39;Second digit failed&#39;);
              Exit;
             end;
          end
          
         else if(i = 3) then
          begin
            if(GetColor(468, 35) = 65535) then
             begin
               writeln(&#39;Third digit failed&#39;);
             end
            else
              begin
                Result := true;
              end;
          end


     end;
     
    Wait(200+Random(200));
     
  end;
end;
[/code]</description>
    
    <lastBuildDate>Mon, 22 May 2006 15:51:42 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>My working version of InPin() [ InPinEx() ]</title>
        <dc:creator><![CDATA[@zstars zstars]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zstars">@zstars</a> wrote:</p>
          <blockquote>
              <p>I used to use and script scar before Aryan, now that it’s dead I do again <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162/3</link>
        <pubDate>Mon, 22 May 2006 15:51:42 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-3162-3</guid>
        <source url="https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162.rss">My working version of InPin() [ InPinEx() ]</source>
      </item>
      <item>
        <title>My working version of InPin() [ InPinEx() ]</title>
        <dc:creator><![CDATA[@inferno inferno]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/inferno">@inferno</a> wrote:</p>
          <blockquote>
              <p>Good work. <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=9" title=":wink:" class="emoji" alt=":wink:"> How long have you been scripting?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162/2</link>
        <pubDate>Mon, 22 May 2006 13:36:03 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-3162-2</guid>
        <source url="https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162.rss">My working version of InPin() [ InPinEx() ]</source>
      </item>
      <item>
        <title>My working version of InPin() [ InPinEx() ]</title>
        <dc:creator><![CDATA[@zstars zstars]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zstars">@zstars</a> wrote:</p>
          <blockquote>
              <p>Well I didn’t know where to post this.</p>
<p>SRL’s 2.01 InPin() isn’t working, at least for me, so I decided to make my own InPin function.</p>
<p>I haven’t tested it too much yet but it seems to work well. Feel free to use it and if you find any bug or it doesn’t work for you post here or send a PM (hopefully with enough info for me to know what’s happenning). TY <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Semi Off-Topic: I’m still wanting to join SRL <img src="https://forum.moparisthebest.com/images/emoji/twitter/frowning.png?v=9" title=":frowning:" class="emoji" alt=":frowning:"></p>
<p>Edit: Forgot to say (kinda obvious but…) that it is not a stand-alone script, it’s just a function, and that it requires SRL (tested with version 2.01).<br>
Also, feel free to suggest improvements.</p>
<pre><code class="lang-auto">// Function: bool InPinEx(int)
// Author: zstars
// Purpose &amp; Usage:
//         This function will check if the pin window is open. If it is, it will
//         try to insert the pin. It will use the question marks to check if it
//         was inserted. However, the last digit can't really be checked and
//         it is a non-blocking function, so it is your duty to check whether the
//         bank was successfully opened or not. (Use BankScreen())
function InPinEx(pin : String) : Boolean;
var
  i: Integer;
  x, y: Integer;
  b : array [0..10] of Integer;
  bres: boolean;
begin

  b[0] := BitmapFromString(8, 11, 'z78DA33304000370C60800360AAC1' +
       'A58B187152CDC1AF9E1859F2D413E33B52D5931A9E0664C517F10' +
       '000287879B1');
  b[1] := BitmapFromString(7, 11, 'z78DA333040003724608003B86100' +
       '62D4E0379378DB87934A372280018900008525648D');
  b[2] := BitmapFromString(7, 11, 'z78DA33300001371CC00009902A8E' +
       '0B10AF9E189543518D01DE30C71F0BF801008CB06595');
  b[4] := BitmapFromString(8, 11, 'z78DA73734300032280DBA0578FDF' +
       '047AAAC70F062AC4F00300632B72FD');
  b[3] := BitmapFromString(7, 11, 'z78DA33300001371CC00009902A8E' +
       '092857498C3B69673B312A29093D527D840900A4FD6619');
  b[5] := BitmapFromString(8, 11, 'z78DA7373230C0C90002E715C8012' +
       'F5A4EA25CF46FAFB8B12716A85122E000093B47279');
  b[6] := BitmapFromString(8, 11, 'z78DA33304000370C60800360AAC1' +
       'A58B18D3A8A59E18F7E352439EFB893787545B488D05E2430C3F0' +
       '000E75E7591');
  b[7] := BitmapFromString(7, 11, 'z78DA7373230C0CF00262548E9A46' +
       '894AE2010048E26301');
  b[8] := BitmapFromString(8, 11, 'z78DA33304000370C60800360AAC1' +
       'A50BBF69C4EB22D55503E5FEC1E95FE20100FFAB7615');
  b[9] := BitmapFromString(8, 11, 'z78DA3330000137BCC00009E012C7' +
       '254B6BF5E4891B90E86B5C60A8ABC70400AAA87489');


  // If there is no red where there should or if the bank screen is already open.
  if (GetColor(136, 40) &lt;&gt; 255) and (GetColor(202, 39) &lt;&gt; 255) or (BankScreen) then
   begin
    Result := True;
    Exit;
   end;
   
   
  for i := 1 to Length(Pin) do
  begin
    // just in case.
    x := 395;
    y := 175;
    MMouse(395, 175, 10, 10);
    Wait(100+Random(200));
    bres := false;
    
    // Try to find the digit bitmap.
    bres := FindBitmapMaskTolerance(b[strtoint(Pin[i])], x, y,  26, 97, 423, 322, 10, 40);
    if(bres = false) then
     begin
        bres := false;
        // A second try.
        bres := FindBitmapMaskTolerance(b[strtoint(Pin[i])], x, y,  26, 97, 423, 322, 10, 40);
        if(bres = false) then
         begin
          Result := false;
          Exit;
         end;
     end;
    Wait(500 + Random(500));
    
    
    // If the bitmap was found.
    if(bres = true) then
     begin
     
         // Hit twice, fast, because otherwise sometimes it seems to fail.
         Mouse(x+Random(2), y + Random(2), 2 , 0, True);
         Sleep(25+Random(25));
         Mouse(x+Random(2), y + Random(2), 2 , 0, True);
         
         Wait(600+Random(100));
         
         // Make sure the last digit was in fact entered.
         // Note: Can't really check whether the last one was entered or not.
         //       It assumes it did, but you have to check whether the bank opened.
         
         if(i = 1) then
          begin
            if(GetColor(435, 35) = 65535) then
             begin
              writeln('First digit failed');
              Exit;
             end;
          end
          
         else if(i = 2) then
          begin
            if(GetColor(452, 35) = 65535) then
              begin
              writeln('Second digit failed');
              Exit;
             end;
          end
          
         else if(i = 3) then
          begin
            if(GetColor(468, 35) = 65535) then
             begin
               writeln('Third digit failed');
             end
            else
              begin
                Result := true;
              end;
          end


     end;
     
    Wait(200+Random(200));
     
  end;
end;</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162/1</link>
        <pubDate>Mon, 22 May 2006 12:58:10 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-3162-1</guid>
        <source url="https://forum.moparisthebest.com/t/my-working-version-of-inpin-inpinex/3162.rss">My working version of InPin() [ InPinEx() ]</source>
      </item>
  </channel>
</rss>
