<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/java-packets/413207 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 12:05:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[Java] Packets? - General Programming - moparisthebest.com</title>
    <meta name="description" content="Could someone please explain packets to me, and how to start them in Java? I made an IRC that sends messages to a database then recieves the messages from that database, but its about a 4 second delay (which if I really &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="413207.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[Java] Packets?&#39;" href="413207.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/java-packets/413207" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/java-packets/413207" />
<meta property="og:title" content="[Java] Packets?" />
<meta name="twitter:title" content="[Java] Packets?" />
<meta property="og:description" content="Could someone please explain packets to me, and how to start them in Java? I made an IRC that sends messages to a database then recieves the messages from that database, but its about a 4 second delay (which if I really needed i’d get a better webhost though, lower it down to about 1) but I believe sending packets would be more efficient.   How do you send a packet in Java? How do you recieve a packet in Java? How do you get the info from the users machine to send the packets to?  Thanks, sorry ..." />
<meta name="twitter:description" content="Could someone please explain packets to me, and how to start them in Java? I made an IRC that sends messages to a database then recieves the messages from that database, but its about a 4 second delay (which if I really needed i’d get a better webhost though, lower it down to about 1) but I believe sending packets would be more efficient.   How do you send a packet in Java? How do you recieve a packet in Java? How do you get the info from the users machine to send the packets to?  Thanks, sorry ..." />
<meta property="article:published_time" content="2011-09-02T22:35:14+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="413207.html">[Java] Packets?</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/walkineagle.html'><span itemprop='name'>walkineagle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-02T22:35:14Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:38:02Z' class='post-time'>
              August 1, 2016,  2:38pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Could someone please explain packets to me, and how to start them in Java? I made an IRC that sends messages to a database then recieves the messages from that database, but its about a 4 second delay (which if I really needed i’d get a better webhost though, lower it down to about 1) but I believe sending packets would be more efficient.</p>
<ol>
<li>How do you send a packet in Java?</li>
<li>How do you recieve a packet in Java?</li>
<li>How do you get the info from the users machine to send the packets to?</li>
</ol>
<p>Thanks, sorry if im asking for to much.</p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Int_Bauk.html'><span itemprop='name'>Int_Bauk</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-03T01:20:22Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:38:15Z' class='post-time'>
              August 1, 2016,  2:38pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Are you looking for something like;</p>
<p>[code]import socket</p>
<p>HOST = “127.0.0.1”<br>
PORT = 5000</p>
<p>mySocket = socket.socket( socket.AF_INET, socket.SOCK_DGRAM )</p>
<p>while 1:<br>
packet = raw_input( “Packet&gt;&gt;&gt;” )<br>
print “\nSending packet containing:”, packet<br>
mySocket.sendto( packet, ( HOST, PORT ) )<br>
print “Packet sent\n”</p>
<h1>step 3: receive packet back from server</h1>
<p>packet, address = mySocket.recvfrom( 1024 )<br>
print “Packet received:”<br>
print “From host:”, address[ 0 ]<br>
print “Host port:”, address[ 1 ]<br>
print “Length:”, len( packet )<br>
print “Containing:”<br>
print “\t” + packet + “\n”</p>
<p>mySocket.close()<br>
[/code]</p>
<p>I’m not 100% sure if that’s why you’re looking for, but it could help. <span class="bbcode-b">Don’t use it, it’s just an example</span>.</p>
<p>UDP packets, WIN-LAN, IP … list goes on.</p>
<p><a href="http://download.oracle.com/javase/tutorial/networking/overview/networking.html" class="onebox" target="_blank" rel="nofollow noopener">http://download.oracle.com/javase/tutorial/networking/overview/networking.html</a></p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mod_taharok.html'><span itemprop='name'>mod_taharok</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-03T02:40:02Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:38:22Z' class='post-time'>
              August 1, 2016,  2:38pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Packets are messages sent between a server and a client (at least, that’s the simplest way of putting it right now :P). Packets typically are headed with some sort of UID (Unique/Universal ID), which determines <span class="bbcode-i">which</span> packet it is. They may also have a length and a payload (which basically means how much data is in the packet and the data itself). The data can be encoded in various ways, such as delimited text or raw data such as bytes or words.</p>
<p>TCP and UDP are popular examples of lower level protocols you can use to transmit data and for the sake of simplicity, you might as well think they are the only ones. UDP is basically a much more basic version of TCP, but the differences shouldn’t really matter to you yet, so we’ll just ignore that. TCP is the protocol you should use, as it has 100% reliability and integrity (so long as the connection is kept!) Using the old <a href="http://java.net/" rel="nofollow noopener">java.net</a> framework, sending/receiving messages with TCP is rather simple:</p>
<p><a href="http://systembash.com/content/a-simple-java-tcp-server-and-tcp-client/" class="onebox" target="_blank" rel="nofollow noopener">http://systembash.com/content/a-simple-java-tcp-server-and-tcp-client/</a></p>
<p>If you have any questions, be sure to ask. <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/HcoJustin.html'><span itemprop='name'>HcoJustin</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-03T09:14:37Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:38:39Z' class='post-time'>
              August 1, 2016,  2:38pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>If you’re sending it to your webhost, you couldn’t use a server-client connection. At least not on one of those standard reseller hosts. If you had a VPS or dedicated server you could write your own protocol to use between the two</p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Drain.html'><span itemprop='name'>Drain</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-04T07:02:16Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:41:30Z' class='post-time'>
              August 1, 2016,  2:41pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The way Rsps’s do it???</p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/DannyC.html'><span itemprop='name'>DannyC</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-04T07:28:54Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:41:31Z' class='post-time'>
              August 1, 2016,  2:41pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Drain who made Drainscape?</p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Drain.html'><span itemprop='name'>Drain</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-05T06:43:16Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:41:48Z' class='post-time'>
              August 1, 2016,  2:41pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Drainscape? Definetly not me :S</p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/walkineagle.html'><span itemprop='name'>walkineagle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-06T00:13:11Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:42:50Z' class='post-time'>
              August 1, 2016,  2:42pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Okay, I have most of it solved, I am using a server-client system (the server will listen and the client will connect) I can have the client send packets to the server and I was told I could send messages back to the client as long as the socket doesn’t close, how do I do this?<br>
This is my current code which requires portforwarding on both sides (client: 59933, server: 59932).</p>
<p>Client:</p>
<p>[code]import java.io.BufferedReader;<br>
import java.io.InputStreamReader;<br>
import java.io.PrintWriter;<br>
import java.net.HttpURLConnection;<br>
import java.net.ServerSocket;<br>
import java.net.Socket;<br>
import java.util.Scanner;</p>
<p>public class client {<br>
public static void main(String[] args){<br>
try{<br>
Socket sock = new Socket(“MyIP”, 59932);<br>
PrintWriter out = new PrintWriter(sock.getOutputStream(), true);<br>
recieve runnable2 = new recieve();Thread thread = new Thread(runnable2.r1);thread.start();<br>
java.net.URL URL = new java.net.URL(“<a href="http://www.whatismyip.org/" rel="nofollow noopener">http://www.whatismyip.org/</a>”);<br>
java.net.HttpURLConnection Conn = (HttpURLConnection)URL.openConnection();<br>
java.io.InputStream InStream = Conn.getInputStream();<br>
java.io.InputStreamReader Isr = new java.io.InputStreamReader(InStream);<br>
java.io.BufferedReader Br = new java.io.BufferedReader(Isr);<br>
String lol = Br.readLine();<br>
while(true){<br>
Scanner sendmsg = new Scanner(System.in);<br>
out.println(lol+":GettingIntADDR: "+sendmsg.nextLine());<br>
sock.close();<br>
out.close();<br>
sock = new Socket(“MyIP”, 59932);<br>
out = new PrintWriter(sock.getOutputStream(), true);<br>
}<br>
}catch(Exception e){e.printStackTrace();}<br>
}<br>
}<br>
[/code]</p>
<p>Recieve (client receive):</p>
<p>[code]import java.io.BufferedReader;<br>
import java.io.InputStreamReader;<br>
import java.net.ServerSocket;<br>
import java.net.Socket;</p>
<p>public class recieve {<br>
public recieve()<br>
{<br>
r1 = new Runnable() {</p>
<pre><code>        public void run()
        {
        	try{
			while(true){
    		ServerSocket serv = new ServerSocket(59933);
			Socket sock2 = serv.accept();
			BufferedReader in = new BufferedReader(new InputStreamReader(sock2.getInputStream()));
			System.out.println(in.readLine());
			sock2.close();
			serv.close();
			}
        	}catch(Exception e){e.printStackTrace();}
        }
    }
</code></pre>
<p>;<br>
}<br>
Runnable r1;<br>
}<br>
[/code]</p>
<p>Server:</p>
<p>[code]import java.io.BufferedReader;<br>
import java.io.InputStreamReader;<br>
import java.io.PrintWriter;<br>
import java.net.ServerSocket;<br>
import java.net.Socket;</p>
<p>public class server {<br>
public static void main(String[] args){<br>
try{</p>
<pre><code>		ServerSocket serv = new ServerSocket(59932);
		Socket sock = serv.accept();
		BufferedReader in = new BufferedReader(new InputStreamReader(sock.getInputStream()));
		Socket sock2 = new Socket("MyIP", 59933);
		PrintWriter out = new PrintWriter(sock2.getOutputStream(), true);
		sock2.close();
		out.close();
		while(true){
		String message = in.readLine();
		String ip = message.substring(0, message.indexOf(":GettingIntADDR: "));
		message = message.substring(message.indexOf(":GettingIntADDR: ")+17);
		sock2 = new Socket(ip, 59933);
		out = new PrintWriter(sock2.getOutputStream(), true);
		if(message.equalsIgnoreCase("ips")){
			for(int x = 1; x &lt; ip1.length; x++){
				if(ip1[x].length() &gt; 5){
				System.out.println(ip1[x]);
				out.println("Read IP's");
				}
			}
		}
		else{
			System.out.println("MSG: "+message+" - "+ip);
			for(int x = 0; x &lt; ip1.length; x++){
				sock2.close();
				out.close();
				sock2 = new Socket(ip1[x], 59933);
				out = new PrintWriter(sock2.getOutputStream(), true);
				out.println("Server: "+message);
			}
		}
		for(int x = 0; x &lt; ip1.length; x++){
			if(ip1[x].length() &lt;= 5){
				if(x &gt;= 1){
					if(!ip1[x - 1].equalsIgnoreCase(ip)){
						ip1[x] = ip;
					}
				}
				else{
					ip1[x] = ip;
				}
			}
		}
		sock.close();
		serv.close();
		out.close();
		sock2.close();
		in.close();
		serv = new ServerSocket(59932);
		sock = serv.accept();
		in = new BufferedReader(new InputStreamReader(sock.getInputStream()));
		}
	}catch(Exception e){e.printStackTrace();}
}
public static String[] ip1;
</code></pre>
<p>}<br>
[/code]</p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zyle1992.html'><span itemprop='name'>zyle1992</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-06T00:32:07Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:42:52Z' class='post-time'>
              August 1, 2016,  2:42pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The client doesn’t need a server socket, because it is not a server. It is a client. In the client connect to the server</p>
<pre><code class="lang-auto">final Socket socket = new Socket("127.0.0.1", 59932);</code></pre>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pure_Slay.html'><span itemprop='name'>Pure_Slay</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-11T02:56:24Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:49:21Z' class='post-time'>
              August 1, 2016,  2:49pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Identifying Packets &amp; Rewriting for Server Use:</p>
<p>Starting off in the Client:<br>
You will first need to identify the ‘PacketParser’ as it is called commonly now, or the class that handles incoming packets.<br>
Searching:</p>
<pre><code class="lang-auto"></code></pre>
<p>Should help you to identify this class.</p>
<p>Now, finding a packet:<br>
Packets are easy to find, but maybe challenging to refract and implement in your server.<br>
A packet will look like this:</p>
<pre><code class="lang-auto">if (Class318.aClass354_2585 == Class26.currentIncommingPacket) {
        int i_48_ = Class274.serverOutBuffer.readInt_V1();
        int i_49_ = Class274.serverOutBuffer.readUByte(true);
        int i_50_ = Class274.serverOutBuffer.readUByteC();
        Class186_Sub44_Sub6.anIntArray6246[i_49_] = i_48_;
        Class186_Sub41_Sub12.anIntArray6066[i_49_] = i_50_;
        OutputStream_Sub1.anIntArray48[i_49_] = 1;
        int i_51_ = Class186_Sub41_Sub12.anIntArray6064[i_49_] - 1;
        for (int i_52_ = 0; i_52_ &lt; i_51_; i_52_++) {
        if (Class186_Sub36.anIntArray4713[i_52_] &lt;= i_48_)
            OutputStream_Sub1.anIntArray48[i_49_] = i_52_ + 2;
        }
        Class162.anIntArray1398[Class186_Sub41_Sub36.method2377(31, Class248.anInt2086++)] = i_49_;
        Class26.currentIncommingPacket = null;
        return true;
    }</code></pre>
<p>Looking at first glance you may be over taken by it, but actually it is very simple to figure out.<br>
Lets first look at individual parts and see what we can come up with:</p>
<pre><code class="lang-auto">Class274.serverOutBuffer.readInt_V1();</code></pre>
<p>Although the naming of this maybe different in your client, the method still holds<br>
This snippet is a readInt1, meaning server sided it would be:</p>
<pre><code class="lang-auto">buffer.writeInt1(value);</code></pre>
<p>This:</p>
<pre><code class="lang-auto"></code></pre>
<p>Is a read unsigned byte, Click the spoiler below to learn about bytes, integers, ect</p>
<pre><code class="lang-auto">buffer.writeByte(value);</code></pre>
<p>Computers store information/memory using: bytes, shorts integers, long integers, and double integers.<br>
These are broken up as follows:<br>
Byte - 8 bits<br>
Short - 16 bits<br>
Long - 64 bits<br>
Double - 64 bits</p>
<p>Bytes are used to store values between 0 and 255 (also known as (2^8)-1)<br>
Shorts are used to store values between 0 and 65535 (also known as (2^16)-1)<br>
Longs are used to store values between 0 and 9,223,372,036,854,775,807<br>
Doubles are used to store values between 0 and 18,446,744,073,709,551,615 (also known as (2^64)-1)</p>
<p>If you aren’t see the pattern, to find the max value that each type can hold, you take 2 to the power of the bits it can hold, and subtract 1.</p>
<p>Signed types can hold both negative and positive values, while Unsigned can only hold positive and 0 values.</p>
<pre><code class="lang-auto">int i_50_ = Class274.serverOutBuffer.readUByteC();</code></pre>
<p>Is a read unsigned byte C<br>
Which translates to:</p>
<pre><code class="lang-auto"></code></pre>
<p>Now we know that this Packet contains:<br>
writeInt1<br>
writeByte<br>
writeByteC</p>
<p>At this present time, I would say you couldn’t say which packet that is off the top of your head. (Some can, but as stated above, if you can. This thread isn’t really for you).</p>
<p>Let’s compare it to another sources packets.<br>
Dementhium:</p>
<pre><code class="lang-auto">public static void sendSkillLevel(Player player, int skill) {
        MessageBuilder bldr = new MessageBuilder(85);
        bldr.writeInt((int) player.getSkills().getXp(skill));
        bldr.writeByte(player.getSkills().getLevel(skill));
        bldr.writeByteS(skill);
        player.getConnection().write(bldr.toMessage());

    }</code></pre>
<p>Looks pretty close, other then the byteS.</p>
<p>Emberscape:</p>
<pre><code class="lang-auto">public void sendSkillLevel(int skill) {
        player.getSession().write(new StaticPacketBuilder().setId(38)
                .addByteA(player.getSkills().getLevel(skill))
                .addInt1((int) player.getSkills().getXp(skill))
                .addByteC(skill)
                .toPacket());
    }</code></pre>
<p>Looks pretty close, other then the ByteA. So let’s assume it is something possibly dealing with sendSkills?</p>
<p>Let’s refractor the client a bit.</p>
<pre><code class="lang-auto"></code></pre>
<p>Becomes…</p>
<pre><code class="lang-auto"></code></pre>
<pre><code class="lang-auto"></code></pre>
<p>Becomes…</p>
<pre><code class="lang-auto"></code></pre>
<pre><code class="lang-auto"></code></pre>
<p>Becomes…</p>
<pre><code class="lang-auto"></code></pre>
<p>So now our method looks something like this:</p>
<pre><code class="lang-auto">if (Class318.aClass354_2585 == Class26.currentIncommingPacket) {
        int xp = Class274.packet.readInt1();
        int skill = Class274.packet.readUByte();
        int level = Class274.packet.readUByteC();
        Class186_Sub44_Sub6.anIntArray6246[skill] = xp;
        Class186_Sub41_Sub12.anIntArray6066[skill] = level;
        OutputStream_Sub1.anIntArray48[skill] = 1;
        int i_51_ = Class186_Sub41_Sub12.anIntArray6064[skill] - 1;
        for (int i_52_ = 0; i_52_ &lt; i_51_; i_52_++) {
        if (Class186_Sub36.anIntArray4713[i_52_] &lt;= xp)
            OutputStream_Sub1.anIntArray48[skill] = i_52_ + 2;
        }
        Class162.anIntArray1398[Class186_Sub41_Sub36.method2377(31, Class248.anInt2086++)] = skill;
        Class26.currentIncommingPacket = null;
        return true;
    }</code></pre>
<p>Let’s do two final things, lets make i_52_ = value, and i_51_ = skillsCount</p>
<p>So now, our finish method:</p>
<pre><code class="lang-auto">if (Class318.aClass354_2585 == Class26.currentIncommingPacket) {
        int xp = Class274.packet.readInt1();
        int skill = Class274.packet.readUByte();
        int level = Class274.packet.readUByteC();
        Class186_Sub44_Sub6.anIntArray6246[skill] = xp;
        Class186_Sub41_Sub12.anIntArray6066[skill] = level;
        OutputStream_Sub1.anIntArray48[skill] = 1;
        int skillsCount = Class186_Sub41_Sub12.anIntArray6064[skill] - 1;
        for (int value = 0; value &lt; skillsCount; value++) {
        if (Class186_Sub36.anIntArray4713[value] &lt;= xp)
            OutputStream_Sub1.anIntArray48[skill] = value + 2;
        }
        Class162.anIntArray1398[Class186_Sub41_Sub36.method2377(31, Class248.anInt2086++)] = skill;
        Class26.currentIncommingPacket = null;
        return true;
    }</code></pre>
<p>Ok, big deal? Doesn’t affect anything client sided, lets write the server sided portion. I’m going to write it using 647’s files, since that is what is convenient on my eclipse at the current time. (Also the method is from 647 client).</p>
<p>The header:</p>
<pre><code class="lang-auto">public static void sendSkilllLevel(Player player, double xp, int skill, int level) {</code></pre>
<p>Why the double? Well looking at extend information we know that bytes &amp; shorts can’t hold xp since it goes up to 200million.</p>
<p>Next, we need to find the packetId, you can either search this portion of the code:</p>
<pre><code class="lang-auto"></code></pre>
<p>Or, use eclipse and click open declaration.<br>
Regardless you will come upon this:</p>
<pre><code class="lang-auto">static IncomingPacket aClass354_2585 = new IncomingPacket(101, 6);</code></pre>
<p>101 = PacketId<br>
6 = PacketSize</p>
<p>So continuing our method:</p>
<pre><code class="lang-auto">public static void sendSkillLevel(Player player, double xp, int skill, int lvl) {
        PacketBuilder pb = new PacketBuilder(101);</code></pre>
<p>Next, we have a writeInt1 , which relates to xp.<br>
So lets write it as:</p>
<pre><code class="lang-auto">pb.writeInt1((int) xp);</code></pre>
<p>We cast (int) to xp, since it is a double.</p>
<p>Next, we have a write unsigned byte for skill<br>
So lets write it as:</p>
<pre><code class="lang-auto">pb.writeByte(skill);</code></pre>
<p>Finally, we have a write unsigned byte C for level.<br>
So lets write it as:</p>
<pre><code class="lang-auto">pb.writeByteC(level);</code></pre>
<p>Then finish with writing out our channel;</p>
<pre><code class="lang-auto">pb.write(player.getChannel());</code></pre>
<p>Finished packet will look similar to this:</p>
<pre><code class="lang-auto">public static void sendSkillLevel(Player player, double xp, int skill, int level) {
        PacketBuilder pb = new PacketBuilder(101);
        pb.writeInt1((int) xp);
        pb.writeByte(skill);
        pb.writeByteC(level);
        pb.write(player.getChannel());
    }</code></pre>
<p>Not so hard?<br>
[/Spoiler]</p>
<p>Identifying Masks:<br>
[Spoiler]<br>
To start, you need to find the file that contains the mask, I’ve checked in the newer revisions and searching:</p>
<pre><code class="lang-auto">== '~')</code></pre>
<p>Will provide the class with the masks, you can also search for hexadecimal numbers that are products of 2^X as Sinisoul stated in a response post.<br>
Ex: 0x1, 0x2, 0x4</p>
<p>Ok, so lets say you found your class, now lets get to the masks.<br>
Similar to identifying packets, it is easier to find specific masks if you know either their packet structure or methods that are attached. For this example we will use animation mask.</p>
<p>Conveniently some masks do not change, in this case animation mask has not changed from 614 so it is relative easy to identify.<br>
The maskId is:</p>
<p>[code 0x80[/code]</p>
<p>So this is our method: (Excuse the refracted method, as I don’t have the old naming of this available)</p>
<pre><code class="lang-auto">if ((i &amp; 0x80) != 0) {
        int[] is = new int[4];
        for (int index = 0; index &lt; 4; index++) {
        is[index] = packet.readUnsignedShort();
        if (is[index] == 65535)
            is[index] = -1;
        }
        int i_11_ = packet.readSignedByteA_();
        Class257.applyAnimationUpdate(is, i_11_, player);
    }</code></pre>
<p>We can ignore:</p>
<pre><code class="lang-auto">if (is[index] == 65535)
            is[index] = -1;</code></pre>
<p>Since that is telling us if the value is equal to 65535 for the Short then it will return -1. This is due to the fact that shorts have a maximum holding value of 0 - 65535.</p>
<p>So by reading this we know we have a:</p>
<pre><code class="lang-auto"></code></pre>
<p>and:</p>
<pre><code class="lang-auto"></code></pre>
<p>Pay attention to the loop as well, as that will be carried over when we write the server sided method.</p>
<p>Now lets move to the actual server related shizniz.<br>
We need to locate our Player updating file, in the case of 647 it is PlayerUpdateManager.java</p>
<p>We need to find our playerUpdate block which contains masks, so just earch for “0x” and you will find it.</p>
<pre><code class="lang-auto">if(flags.get(UpdateFlag.ANIMATION) || multi) {
                mask |= 0x80;
            }</code></pre>
<p>If there is an Animation update needed, we return the mask 0x80.</p>
<p>Then we apply the method:</p>
<pre><code class="lang-auto">if(flags.get(UpdateFlag.ANIMATION) || multi) {
                applyAnimationUpdate(block, otherPlayer);
            }</code></pre>
<p>Now writing the actual method:<br>
Your first line will look something similar to:</p>
<pre><code class="lang-auto"></code></pre>
<p>Now, remember this section from the client?</p>
<pre><code class="lang-auto"> for (int index = 0; index &lt; 4; index++) {</code></pre>
<p>We are going to write it exactly the same.<br>
So your first section of the method will look like this.</p>
<pre><code class="lang-auto">private static void applyAnimationUpdate(PacketBuilder packet, Player otherPlayer) {
        for(int index = 0; index &lt; 4; index++) {
            packet.writeShort(otherPlayer.getLastAnimation().getId());
        }</code></pre>
<p>Now, we still have that writeByteA, which we include after the closing bracket of the for loop. So now your finished method is:</p>
<pre><code class="lang-auto">private static void applyAnimationUpdate(PacketBuilder packet, Player otherPlayer) {
        for(int index = 0; index &lt; 4; index++) {
            packet.writeShort(otherPlayer.getLastAnimation().getId());
        }
        packet.writeByteA(otherPlayer.getLastAnimation().getDelay());
    }
    </code></pre>
<p>The same for rsps applies true for IRC or anything really. The client sends packets to the server, and the server sends packets to the client. The client sending packets to the client( Ex: Send skills - rsps) are then broken up into write byte,short, long, ect. Where as in the client they are read byte, long, short.</p>
<p>For all of those that are going to go screaming that’s Emily’s work. I am Emily.</p>
<p>If you don’t understand still, I can explain it in IRC terms lol.</p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/_s11.html'><span itemprop='name'>_s11</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-11T13:51:49Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:50:20Z' class='post-time'>
              August 1, 2016,  2:50pm
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>yay, completely wrong section for something that we can’t give a fuck about.</p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/eyeownyew.html'><span itemprop='name'>eyeownyew</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-11T14:04:09Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:50:20Z' class='post-time'>
              August 1, 2016,  2:50pm
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote quote-modified" data-post="11" data-topic="413207">
<div class="title">
<div class="quote-controls"></div>
 _s:</div>
<blockquote>
<p>yay, completely wrong section for something that we can’t give a fuck about.</p>
</blockquote>
</aside>
<p>Naw… It’s the right section.</p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/_s11.html'><span itemprop='name'>_s11</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-11T22:04:51Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:51:34Z' class='post-time'>
              August 1, 2016,  2:51pm
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“eyeownyew, post:12, topic:413207”][quote author=_s link=topic=514677.msg3746522#msg3746522 date=1315749109]<br>
yay, completely wrong section for something that we can’t give a fuck about.<br>
[/quote]<br>
Naw… It’s the right section.[/quote]<br>
<span class="bbcode-b">it’s runescape client/server specific</span>, emily’s/pure slay’s post is oriented around identifying packets in the runescape client; i can only see relevance to this thread in the actual adapting for server usage, and even then, it’s still a bit far off what op wants. it involves more reverse engineering than actually understanding the underlying structure of packets and what they actually are as well as how to play with them. post would be a hell of a lot more useful in the client section.</p>
      </div>

      <meta itemprop='headline' content='[Java] Packets?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/java-packets/413207 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 12:05:49 GMT -->
</html>
