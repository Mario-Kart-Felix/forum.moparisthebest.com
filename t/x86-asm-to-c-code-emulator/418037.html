<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/x86-asm-to-c-code-emulator/418037 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 08:13:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>X86 ASM To C++ Code emulator - General Programming - moparisthebest.com</title>
    <meta name="description" content="Do any of these exist? I&amp;#39;m not talking about ASM to C Code decompilers. like hexrays. 

I&amp;#39;m trying to emulate the actual instructions in C code for a bigger project. 

Some assembly CALL&amp;#39;s are relative which gives me a p&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="418037.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;X86 ASM To C++ Code emulator&#39;" href="418037.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/x86-asm-to-c-code-emulator/418037" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/x86-asm-to-c-code-emulator/418037" />
<meta property="og:title" content="X86 ASM To C++ Code emulator" />
<meta name="twitter:title" content="X86 ASM To C++ Code emulator" />
<meta property="og:description" content="Do any of these exist? I’m not talking about ASM to C Code decompilers. like hexrays.  I’m trying to emulate the actual instructions in C code for a bigger project.  Some assembly CALL’s are relative which gives me a problem… If i try to rip some serial generation/packet encryption/decryption functions. They often have something like this.  004346CA   . C745 F8 DB5325&gt;MOV DWORD PTR SS:[EBP-8],862553DB                    ;&lt;-This is start 004346D1   . C745 FC CEE6DC&gt;MOV DWORD PTR SS:[EBP-4],0EDCE6..." />
<meta name="twitter:description" content="Do any of these exist? I’m not talking about ASM to C Code decompilers. like hexrays.  I’m trying to emulate the actual instructions in C code for a bigger project.  Some assembly CALL’s are relative which gives me a problem… If i try to rip some serial generation/packet encryption/decryption functions. They often have something like this.  004346CA   . C745 F8 DB5325&gt;MOV DWORD PTR SS:[EBP-8],862553DB                    ;&lt;-This is start 004346D1   . C745 FC CEE6DC&gt;MOV DWORD PTR SS:[EBP-4],0EDCE6..." />
<meta property="article:published_time" content="2011-10-13T02:27:42+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="418037.html">X86 ASM To C++ Code emulator</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sspoke.html'><span itemprop='name'>sspoke</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-10-13T02:27:42Z'>
            <time itemprop='dateModified' datetime='2016-08-01T15:32:59Z' class='post-time'>
              August 1, 2016,  3:32pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Do any of these exist? I’m not talking about ASM to C Code decompilers. like hexrays.</p>
<p>I’m trying to emulate the actual instructions in C code for a bigger project.</p>
<p>Some assembly CALL’s are relative which gives me a problem… If i try to rip some serial generation/packet encryption/decryption functions. They often have something like this.</p>
<pre><code class="lang-auto">004346CA   . C745 F8 DB5325&gt;MOV DWORD PTR SS:[EBP-8],862553DB                    ;&lt;-This is start
004346D1   . C745 FC CEE6DC&gt;MOV DWORD PTR SS:[EBP-4],0EDCE6CE
004346D8   . 8B45 F8            MOV EAX,DWORD PTR SS:[EBP-8]                              ;&lt;- Then here
004346DB   . BA BD15696F        MOV EDX,6F6915BD
004346E0   . 8BCE                  MOV ECX,ESI
004346E2   . 05 859A1E7A        ADD EAX,7A1E9A85                                                                ;&lt;- This finally this
004346E7   . FFD0                  CALL EAX                                                                              ;&lt;- Any automatic way for CodeRipper to find this function
 
004346E9   . 2945 FC            SUB DWORD PTR SS:[EBP-4],EAX ;&lt;- Answer from CALL EAX.. make next call
004346EC   . C745 F8 E599B8&gt;MOV DWORD PTR SS:[EBP-8],25B899E5
004346F3   . BA 9A6ED45D        MOV EDX,5DD46E9A
004346F8   . 8BCE                  MOV ECX,ESI
004346FA   . FF55 FC            CALL DWORD PTR SS:[EBP-4]       ;&lt;-- Call from previous answer</code></pre>
<p>I couldn’t find any ollydbg script or ida pro plugin which is able to transform relative address to absolute address…</p>
<p>Relative -&gt; Absolute.</p>
<pre><code class="lang-auto">CALL DWORD PTR SS:[EBP-4] -&gt; CALL 493881</code></pre>
<p>As you can see in the snippet above. First call<br>
CALL EAX which is relative… is actually generated… from 4 instructions above which makes it absolute then.</p>
<p>Then the next call  CALL DWORD PTR SS:[EBP-4] is also relative… but is generated to absolute by the result of the previous call.</p>
<p>I asked in a reversing forum… they said nothing like this exists… They say just breakpoint every call and get the absolute addresses… This would mean to me removing the protection or gameguard from the game for example. Just to be able to attach a debugger… or assemble a JMP to some area… rewrite the code there to call the function I want to step just to get the absolute function addresses.</p>
<p>I figured i’d make a assembly emulator which would emulate a piece of asm code running in C code… then collect all the absolute addresses… replace the previous relative ones. Then finally remove any unused assembly code… to make it as minimal as possible.</p>
<p>I Found a few open source dissemblers. All were a overkill for what I wanted to do… but I managed to strip one down to it’s bare workings.</p>
<p>Here is one it produced something like this.</p>
<pre><code class="lang-auto">401000	PUSH ESI
401001	MOV ESI,DWORD PTR [ESP+8]
401005	MOV EDX,ECX
401007	PUSH EDI
401008	MOV EDI,ESI
40100A	OR ECX,FFFFFFFF
40100D	XOR EAX,EAX
40100F	REPNE SCAS BYTE PTR [EDI]
401011	NOT ECX
401013	DEC ECX
401014	MOV EAX,ECX
401016	DEC ECX
401017	TEST EAX,EAX
401019	JE 401035
40101B	PUSH EBX
40101C	LEA EAX,[ECX+1]
40101F	XOR ECX,ECX
401021	XOR EBX,EBX
401023	MOV CL,BYTE PTR [ESI]
401025	MOV BL,BYTE PTR [EDX]
401027	XOR ECX,EBX
401029	DEC EAX
40102A	MOV CL,BYTE PTR [ECX+45FA1C]
401030	MOV BYTE PTR [EDX],CL
401032	JNE 40101F
401034	POP EBX
401035	POP EDI
401036	POP ESI
401037	RET 4</code></pre>
<p>So I started writing a second parser that runs each instruction line by line and give a C code equivalent.</p>
<p>ATM when ran against the top snippet it would generate this… still not runnable, but getting there.</p>
<pre><code class="lang-auto">regs.d.esp -= 4;
*(unsigned int *)(regs.d.esp) = regs.d.esi;
regs.d.esi = *(unsigned int *)(regs.d.esp+0x00000008);
regs.d.edx = regs.d.ecx;
regs.d.esp -= 4;
*(unsigned int *)(regs.d.esp) = regs.d.edi;
regs.d.edi = regs.d.esi;
regs.d.ecx |= 0xFFFFFFFF;
regs.d.eax ^= regs.d.eax;
REPNE SCAS BYTE PTR [EDI]
regs.d.ecx ~= regs.d.ecx;
regs.d.ecx--;
regs.d.eax = regs.d.ecx;
regs.d.ecx--;
if(regs.d.eax == 0)
    goto label_401035;
regs.d.esp -= 4;
*(unsigned int *)(regs.d.esp) = regs.d.ebx;
regs.d.eax = (regs.d.ecx+0x00000001);
regs.d.ecx ^= regs.d.ecx;
regs.d.ebx ^= regs.d.ebx;
regs.x.cl = *(unsigned char *)(regs.d.esi);
regs.x.bl = *(unsigned char *)(regs.d.edx);
regs.d.ecx ^= regs.d.ebx;
regs.d.eax--;
regs.x.cl = *(unsigned char *)(regs.d.ecx+0x0045FA1C);
*(unsigned char *)(regs.d.edx) = regs.x.cl;
JNE 40101F
regs.d.ebx = *(unsigned int *)(regs.d.esp);
regs.d.esp += 4;
label_401035:
regs.d.edi = *(unsigned int *)(regs.d.esp);
regs.d.esp += 4;
regs.d.esi = *(unsigned int *)(regs.d.esp);
regs.d.esp += 4;
return 0x4;</code></pre>
<p>I got the most basic if(statements) working…</p>
<p>some like that<br>
JNE 40101F<br>
without a CMP or TEST above it… most likely a loop, I cannot yet do.</p>
<p>Anyways what I am asking if anyone knows of any software that does something like what I am trying to do, could save me alot of time.</p>
<p>Thanks… well if nothing like this exists maybe someone can help me out.</p>
<p>Thanks again.</p>
      </div>

      <meta itemprop='headline' content='X86 ASM To C++ Code emulator'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-10-13T03:24:10Z'>
            <time itemprop='dateModified' datetime='2016-08-01T15:33:13Z' class='post-time'>
              August 1, 2016,  3:33pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Without reading the entire thread, it sounds like you are talking about an x86 CPU emulator written in C or C++, in which case there are many.  The one I would start with would be qemu.</p>
      </div>

      <meta itemprop='headline' content='X86 ASM To C++ Code emulator'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ownagesbot.html'><span itemprop='name'>ownagesbot</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-01-02T00:45:09Z'>
            <time itemprop='dateModified' datetime='2016-08-02T14:59:00Z' class='post-time'>
              August 2, 2016,  2:59pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Did you manage to find a solution?</p>
<p>Your thread isn’t entirely clear but I doubt you’ll find anything much to help you, I think you might also be thinking about this incorrectly, but your original post is a bit hard to interpret.</p>
      </div>

      <meta itemprop='headline' content='X86 ASM To C++ Code emulator'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sspoke.html'><span itemprop='name'>sspoke</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-01-03T19:41:25Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:01:59Z' class='post-time'>
              August 2, 2016,  3:01pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The purpose i was doing this for is to fix, static addresses in assembly so it can easily be ripped and keygenned. For me this just was going to be used for decryption/encryption of a 2d shooting game’s protocol.</p>
<p>Rumors say the encryption/decryption was written by hand in assembly… but then again could be just some unknown ASM obfuscation/optimization process.</p>
<p>What i mean by static addresses, if I copy/paste the assembly code using OllyDBG’s CodeRipper into C++ ASM interpreter and fix other simple errors, it still wouldn’t run, since some ASM code is calculated by mathematical equation.</p>
<p>As you can see from the code posted above.</p>
<pre><code class="lang-auto">4346CA   . C745 F8 DB5325&gt;MOV DWORD PTR SS:[EBP-8],862553DB                    ;&lt;-This is start
004346D1   . C745 FC CEE6DC&gt;MOV DWORD PTR SS:[EBP-4],0EDCE6CE
004346D8   . 8B45 F8            MOV EAX,DWORD PTR SS:[EBP-8]                              ;&lt;- Then here
004346DB   . BA BD15696F        MOV EDX,6F6915BD
004346E0   . 8BCE                  MOV ECX,ESI
004346E2   . 05 859A1E7A        ADD EAX,7A1E9A85                                                                ;&lt;- This finally this
004346E7   . FFD0                  CALL EAX                                                                              ;&lt;- Any automatic way for CodeRipper to find this function</code></pre>
<p>EBP-8 becomes 0x862553DB          ;C745 F8 DB5325&gt;MOV DWORD PTR SS:[EBP-8],862553DB<br>
EAX now becomes 0x862553DB      ;MOV EAX,DWORD PTR SS:[EBP-8]<br>
EAX += 7A1E9A85;                      ;ADD EAX,7A1E9A85<br>
CALL [Calculated math of 0x862553DB + 7A1E9A85] ;CALL EAX</p>
<p>I solved the problem of changing all CALL EAX’s into CALL ######'s by writing a little script in OLLYDBG which set breakpoints to all CALL EAX/CALL EDX… etc… and once a breakpoint was triggered it would write a comment of the evaluated math equations… some CALL EAX’s are for regular API calls so the address it may calculate may be out of the scope of the game’s code base, I just ignored those.</p>
<p>Here is the screenshot of the Script in progress<br>
<div class="lightbox-wrapper"><a class="lightbox" href="http://i.imgur.com/YJQbe.png" title="YJQbe.png" rel="nofollow noopener"><img src="http://i.imgur.com/YJQbe.png" alt width="562" height="500"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">YJQbe.png</span><span class="informations">747×664</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>Yeah I pretty much managed to make my own Code Ripper which follows all CALL [Calculated Values] and rips those out too until a RETN is detected… then it does a second pass to find out if any JMPS pass the first RETN… if extending is needed to the next RETN…</p>
<p>I got pretty far… I managed to get the packet encryption work half the time…</p>
<p>One of the other obfuscations the game had was inserted Try/Catch Exceptions which would stop OllyDBG as each of the Exceptions would get triggered… the Exceptions really make no sense… and should just be removed… in OllyDBG options you can set option to ignore all exceptions and thats how I stepped the encryption.</p>
<p>Here is how it used to be</p>
<pre><code class="lang-auto">00419F50  PUSH EBP
00419F51  MOV EBP,ESP
00419F53  PUSH ECX
00419F54  MOV EAX,0EBB58D5
00419F59  PUSH ESI
00419F5A  MOV ESI,DWORD PTR DS:[ECX+24]
00419F5D  SUB EAX,EDX
00419F5F  ADD ESI,EAX
00419F61  MOV DWORD PTR DS:[ECX+24],ESI
00419F64  MOV ECX,ESI
00419F66  AND ECX,1
00419F69  POP ESI
00419F6A  CMP CL,1  ;&lt;--- the compare okay, could this be injected? or coded by app maker himself?
00419F6D  JNZ SHORT Unmodifi.00419F86 ;&lt;--- must trigger this, to go to good side.
00419F6F  ADD EDX,0B4408B
00419F75  PUSH Unmodifi.004B2338
00419F7A  MOV DWORD PTR SS:[EBP-4],EDX
00419F7D  LEA EDX,DWORD PTR SS:[EBP-4]
00419F80  PUSH EDX
00419F81  CALL Unmodifi.0046CA73 ;&lt;--- Exception fail, on purpose wtf?
00419F86  TEST EAX,EAX
00419F88  JNB SHORT Unmodifi.00419F8D    ;&lt;-- This solves the HMM below, already know this one
00419F8A  MOV DWORD PTR DS:[EDI+EAX*8+FFC2828D],CE354613 ;&lt;--- from JNB mess
00419F95  PUSH EDX
00419F96  PUSH EAX
00419F97  SBB CL,BYTE PTR DS:[EBX+90C35DE5]</code></pre>
<p>And the decompiled version</p>
<pre><code class="lang-auto">int __fastcall sub_419F50(int a1, int a2)
{
  int v2; // esi@1
  int v4; // [sp+4h] [bp-4h]@2

  v2 = 247158997 - a2 + *(_DWORD *)(a1 + 36);  //&lt;- Good perfect.
  *(_DWORD *)(a1 + 36) = v2; //&lt;- Good sets the array
  if ( (v2 &amp; 1) == 1 ) //&lt;-- no needed
  {
        v4 = a2 + 11813003; //&lt;- not needed
        _CxxThrowException(&amp;v4, &amp;unk_4B2338); //&lt;- not needed
  }
  return (a2 + 1175715778) ^ 0x1A5052CE; //&lt;- excellent
}</code></pre>
<p>There is another obfuscation in the ASM code which I couldn’t defeat, this is where I pretty much gave up, from talking on reversing forums they said this part of obfuscation is called Obsidium.</p>
<p>pretty much it looks like this</p>
<pre><code class="lang-auto">0041C8DA   . 7B 02        JPO SHORT Unmodifi.0041C8DE              &lt;- NOP (jump not taken)
0041C8DC         B8                DB B8                          &lt;- reassemble
0041C8DD         00                      DB 00                    &lt;- reassemble
0041C8DE   . 8BC7                MOV EAX,EDI   &lt;-reassemble
0041C8E0   ? F7                  ???                              ;  Unknown command  &lt;- reassemble</code></pre>
<p>DB’s shouldn’t be in any ASM Code base, being here that makes the code kinda re-write itself… say the JPO above isn’t taken… it would re-assemble  B8 00 [8B C7] into a new assembly command, well it’s not re-writing itself… it’s just making ollydbg parse the ASM improperly. Also that command 0xF7 probably is a dummy byte which does no purpose just ignored I guess.</p>
<p>Here is the script I attempted to remove this kind of Obfuscations.<br>
<a href="http://pastebin.com/SxnwVN2Y" class="onebox" target="_blank" rel="nofollow noopener">http://pastebin.com/SxnwVN2Y</a></p>
<p>the script was a big fail… because it ran by pattern matching rather then following the results of JPO’s etc… so I didn’t know whether the jump was taken or not… I just regarded some patterns like the above never is taken and others always taken… this didn’t work well, this is probably where I realized the idea I was going for is only for simple programs with no obfuscation/packers… if I work on something like this, it has to be done by hand no automation tools.</p>
<p>There was another obfuscation which wasn’t too bad… it’s in the script above too.</p>
<pre><code class="lang-auto">0041D20B   . C745 FC 00000000              MOV DWORD PTR SS:[EBP-4],0
0041D212   . [E8 01 00 00 00]                    CALL Unmodifi.0041D218    &lt;- NOP CALL
0041D217         [8B]                                                     DB 8B          &lt;- NOP Trash
0041D218   . [58]                                                         POP EAX       &lt;- NOP for CALL
0041D219   . 8B46 48                                             MOV EAX,DWORD PTR DS:[ESI+48]</code></pre>
<p>pretty much as you can see it does a CALL method into the same function it’s already into… instead of going into a new function… it splits the current function into a sub-function. pretty much to get rid of this obfuscation you just remove the CALL which has bytes [01 00 00 00] which means CALL +1 byte and also get rid of the POP EAX which is holding the return address for the CALL, not sure anymore, it jumps over the DB 8B which is just garbage added to add more manual work with assembly hackers pretty much.</p>
<p>Other then that I pretty much gave up on this game.</p>
      </div>

      <meta itemprop='headline' content='X86 ASM To C++ Code emulator'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/x86-asm-to-c-code-emulator/418037 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 08:13:10 GMT -->
</html>
