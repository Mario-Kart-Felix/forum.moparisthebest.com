<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Brainstorm: The ideal server?</title>
    <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546</link>
    <description>Hey guys, I did some thinking and came up with some ideas for the ideal server for RuneScape private servers - something global, community-independent, that would eliminate the need for people to write their own server bases and the other problems with developing and hosting private servers.

This project would follow the ideas and values of the [url=http://opensource.org/]Open Source Initiative[/url] without question. It would ideally be developed under the [url=http://www.gnu.org/licenses/gpl.html]GNU General Public License v3[/url]. The basic idea is to develop the &quot;final&quot; server base that would eliminate any reason to use another source.

This is all cliche information that you are all familiar with, however. I want to instead, discuss and brainstorm with you the design of such a server. I have been talking with many people (mainly Taharok) and been reading quite a bit of posts in this section and have been able to come up with a pretty awesome design and I want to run it over you guys, as well as get your design ideas and hopefully we can have a very constructive thread going on here.

[b]My Design Idea[/b]
In my opinion, the ideal server would be something ideal for developers - seeing as we are a hacking community, we don&#39;t need to worry about making fancy GUI applications or incredibly user-friendly things; instead we can focus on programmer-friendly things.

My design would be one where the entire server is build from modular, interchangable parts - designed for different hardware setups and client revisions. Every operating part of the server will be built under an interface system - systems for networking, different engine designs, different protocol encoders/decoders, etc. that could all be developed and distributed along with the source, built under a default configuration (&quot;this&quot; networking system, with &quot;this&quot; engine, and &quot;these&quot; encoder/decoders, etc) but allowing the user to select different pieces and &quot;build&quot; their server from the existing modules, or even write their own modules of the server for ultimate configuration of how it operates. The resulting server would be an [i]incredibly[/i] flexible, yet (hopefully) reliable and scalable base. As for content, the content system would be written in a scripting language, and the content will be separated from the internals of the server as to make the content protocol independent. Ideally, the server would be able to run under multiple protocols, and multiple worlds simultaneously - while retaining the same independent content system across every world and client revision.
As for scalability, the incredibly object-oriented nature of such a design would provide a challenge. I believe, however, that private servers will never grow to the point where there are several thousand players in one server, and if so possibly the server could have an intuitive clustering system build-in using [url=http://java.sun.com/docs/books/tutorial/rmi/index.html]Java RMI[/url] to make up for such a performance loss.
As for benefits of such a design, you could have multiple parts of the different server that are optimized for different hardware setups - what is the point in having a complicated, thread-pooled system (which requires appropriate synchronization) if you only have one CPU to run it on? In that case, you&#39;d want to go with a single-threaded engine approach because there would be no benefit in multi-threading, and you&#39;d still suffer from synchronization bottlenecks. However, what if you have an 8-core system but the engine only runs on one thread? In this case, you&#39;re only using 12.5% (1/8) of your processing power - here you would want to use a thread-pooled engine module instead of a single threaded one. A similar approach could be done with networking. Another benefit would be the codec system modules - you could easily swap them for a different server operating protocol, or even use them together to make a protocol-hybrid server (multiple different revision clients playing together at the same time). You could also have separate worlds with world instancing, it would all be very easy to do due to the modular, flexible design of the server.

Discuss your thoughts of my design, and please post your own design ideas.
Let&#39;s get a good brainstorming thread going on here!</description>
    
    <lastBuildDate>Tue, 27 Oct 2009 00:28:27 +0000</lastBuildDate>
    <category>Community Inside Talk</category>
    <atom:link href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group quote-modified" data-post="16" data-topic="310546">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/budda/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> Budda:</div>
<blockquote>
<p>Stop making threads like this, it makes this community seem organized and working towards a goal…its not right.</p>
</blockquote>
</aside>
<p>Well Graham’s project is still going pretty well.</p>
<p>I think that these threads are great because they give people ideas and insight into what works, what doesn’t, and what hasn’t been tried.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/18</link>
        <pubDate>Tue, 27 Oct 2009 00:28:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-18</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@system system]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/system">@system</a> wrote:</p>
          <blockquote>
              <p>[quote=“Budda, post:16, topic:310546”]Stop making threads like this, it makes this community seem organized and working towards a goal…its not right.[/quote]It’s simply a brainstorming thread, and if you want to say that it’s not right, you can talk to Moparisthebest about how he is willing to pay for someone to contribute greatly to the community.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/17</link>
        <pubDate>Mon, 26 Oct 2009 23:11:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-17</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@Budda Budda]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/budda">@Budda</a> wrote:</p>
          <blockquote>
              <p>Stop making threads like this, it makes this community seem organized and working towards a goal…its not right.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/16</link>
        <pubDate>Mon, 26 Oct 2009 22:10:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-16</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@Jython super_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/jython">@Jython</a> wrote:</p>
          <blockquote>
              <p>[quote=“la­wl, post:10, topic:310546”]imo if you’re going to have scripting javascript is a good choice; most people will know how to use it because of its similarity to java and its easy to implement. but of course python should be available too</p>
<aside class="quote no-group">
<blockquote>
<p>[quote]One of the interesting things in that other topic was the mention of decoder implementations handling the entirety of server version implementation.<br>
Now that I think about it, I suppose that is entirely possible if each PacketHandler was provided with an Object[] of the values returned by the packet.<br>
Currently GameEngine iteratively delegates Packet objects to PacketHandlers so that they can be decoded and handled.<br>
What if there was a middleman, PacketDecoder, which parsed the packet’s data based on the version’s structure, and then delegated to the PacketHandler by passing each value read from the packet as a value in the aforementioned Object[]. PacketHandlers would, for the most part, remain entirely static from release to release while only the middleman adapters would have to be reimplemented for different versions.</p>
</blockquote>
</aside>
<p>done it:</p>
<p><code>&lt;messages&gt;
    &lt;message name="LOGIN" opcode="22" direction="incoming"&gt;
        &lt;field name="username" type="string" /&gt;
        &lt;field name="password" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="MOVEMENT_UPDATE" opcode="24" direction="incoming"&gt;
        &lt;field name="posX" type="short" /&gt;
        &lt;field name="posY" type="short" /&gt;
        &lt;field name="direction" type="byte" /&gt;
    &lt;/message&gt;
    &lt;message name="KEY_DOWN" opcode="0" direction="incoming" /&gt;
    &lt;message name="CHAT_MESSAGE" opcode="23" direction="incoming"&gt;
        &lt;field name="message" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="SERVER_MESSAGE" opcode="45" direction="outgoing"&gt;
        &lt;field name="message" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="CHAT_MESSAGE" opcode="46" direction="outgoing"&gt;
        &lt;field name="username" type="string" /&gt;
        &lt;field name="message" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="LOGIN" opcode="15" direction="outgoing"&gt;
        &lt;field name="username" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="LOGOUT" opcode="16" direction="outgoing"&gt;
        &lt;field name="reason" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="MOB_UPDATE" opcode="17" direction="outgoing"&gt;
        &lt;field name="count" type="ushort" /&gt;
        &lt;field name="mobInfoBlocks" type="block"&gt;
            &lt;field name="name" type="string" /&gt;
            &lt;field name="posX" type="ushort" /&gt;
            &lt;field name="posY" type="ushort" /&gt;
            &lt;field name="direction" type="byte" /&gt;
        &lt;/field&gt;
    &lt;/message&gt;
&lt;/messages&gt;</code></p>
<p>this is for a dummy, simple protocol, but the idea…<br>
[/quote]<br>
did you consider doing … …<br>
i think it would be more organized, but maybe the way you did it is better cause you can see related packets all together[/quote]</p>
<p>no, i actually didnt <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> but its pretty cool cuz the netty MessageEncoder/Decoder turn the raw ChannelBuffer into a Message based on the specification of the MessageStructure which is a java-representation of a single  element in the xml file; the SimpleUpstreamChannelHandler for the listener channel simply posts the Message to a message queue which is being checked every 600 ms via a ScheduledService that simply looks up the MessageListenerChain for each Message.Type and dispatch()s it to it</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/15</link>
        <pubDate>Mon, 26 Oct 2009 12:14:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-15</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@lawl lawl]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lawl">@lawl</a> wrote:</p>
          <blockquote>
              <p>the thing is most if not all modern servers run on quad core cpus, and if someone is serious about hosting a server they are going to use a proper server, and if they arent serious, then speed is hardly going to be an issue for them.</p>
<p>in summary, its not a big deal</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/14</link>
        <pubDate>Mon, 26 Oct 2009 03:05:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-14</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>Well with script abstraction we can have scripts written in all of the languages that are desired.</p>
<p><a class="mention" href="/u/blake">@Blake</a>: I disagree with your point on single core processors. Most computers that have been sold over the last few years (here in Australia at least) have featured at least a dual core processor.<br>
In fact, I haven’t seen any desktop computers that featured a single core processor (Pentium 4) for a couple of years.</p>
<p>[quote=“Moparisthebest, post:9, topic:310546”][quote author=Lothy link=topic=406978.msg3007002#msg3007002 date=1256487032]<br>
The only downside to using a Map is that HashMaps are far more expensive to create than an Object[] with maybe a length of 4 or 5 for the average packet. The benefit of course is that you can acquire the values by a name rather than knowledge of an index.<br>
But if the PacketHandler only has to be implemented once then is that such a problem?<br>
[/quote]</p>
<p>Don’t keep creating and destroying the Map object, borrow them and return them to and from a MapPool object, reusing the same objects over and over is much faster and has no downsides.[/quote]<br>
Yeah, that could work I suppose.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/13</link>
        <pubDate>Mon, 26 Oct 2009 01:54:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-13</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@system system]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/system">@system</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:11, topic:310546”][quote author=la­wl link=topic=406978.msg3007530#msg3007530 date=1256512673]<br>
imo if you’re going to have scripting javascript is a good choice; most people will know how to use it because of its similarity to java and its easy to implement. but of course python should be available too<br>
[/quote]<br>
Agreed 100%.[/quote]<br>
With the <a href="https://scripting.dev.java.net/" data-bbcode="true">JSR223</a> engines, over a dozen scripting languages could easily be supported.<br>
I’d probably use engines for JavaScript, Python, and Ruby.<br>
Also, I’d be very interested in using Taharok’s Iron scripting language project.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/12</link>
        <pubDate>Mon, 26 Oct 2009 00:13:12 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-12</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group quote-modified" data-post="10" data-topic="310546">
<div class="title">
<div class="quote-controls"></div>
 la­wl:</div>
<blockquote>
<p>imo if you’re going to have scripting javascript is a good choice; most people will know how to use it because of its similarity to java and its easy to implement. but of course python should be available too</p>
</blockquote>
</aside>
<p>Agreed 100%.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/11</link>
        <pubDate>Mon, 26 Oct 2009 00:11:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-11</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@lawl lawl]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lawl">@lawl</a> wrote:</p>
          <blockquote>
              <p>imo if you’re going to have scripting javascript is a good choice; most people will know how to use it because of its similarity to java and its easy to implement. but of course python should be available too</p>
<p>[quote=“oksuper_, post:8, topic:310546”][quote]One of the interesting things in that other topic was the mention of decoder implementations handling the entirety of server version implementation.<br>
Now that I think about it, I suppose that is entirely possible if each PacketHandler was provided with an Object[] of the values returned by the packet.<br>
Currently GameEngine iteratively delegates Packet objects to PacketHandlers so that they can be decoded and handled.<br>
What if there was a middleman, PacketDecoder, which parsed the packet’s data based on the version’s structure, and then delegated to the PacketHandler by passing each value read from the packet as a value in the aforementioned Object[]. PacketHandlers would, for the most part, remain entirely static from release to release while only the middleman adapters would have to be reimplemented for different versions.<br>
[/quote]<br>
done it:</p>
<p><code>&lt;messages&gt;
    &lt;message name="LOGIN" opcode="22" direction="incoming"&gt;
        &lt;field name="username" type="string" /&gt;
        &lt;field name="password" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="MOVEMENT_UPDATE" opcode="24" direction="incoming"&gt;
        &lt;field name="posX" type="short" /&gt;
        &lt;field name="posY" type="short" /&gt;
        &lt;field name="direction" type="byte" /&gt;
    &lt;/message&gt;
    &lt;message name="KEY_DOWN" opcode="0" direction="incoming" /&gt;
    &lt;message name="CHAT_MESSAGE" opcode="23" direction="incoming"&gt;
        &lt;field name="message" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="SERVER_MESSAGE" opcode="45" direction="outgoing"&gt;
        &lt;field name="message" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="CHAT_MESSAGE" opcode="46" direction="outgoing"&gt;
        &lt;field name="username" type="string" /&gt;
        &lt;field name="message" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="LOGIN" opcode="15" direction="outgoing"&gt;
        &lt;field name="username" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="LOGOUT" opcode="16" direction="outgoing"&gt;
        &lt;field name="reason" type="string" /&gt;
    &lt;/message&gt;
    &lt;message name="MOB_UPDATE" opcode="17" direction="outgoing"&gt;
        &lt;field name="count" type="ushort" /&gt;
        &lt;field name="mobInfoBlocks" type="block"&gt;
            &lt;field name="name" type="string" /&gt;
            &lt;field name="posX" type="ushort" /&gt;
            &lt;field name="posY" type="ushort" /&gt;
            &lt;field name="direction" type="byte" /&gt;
        &lt;/field&gt;
    &lt;/message&gt;
&lt;/messages&gt;</code></p>
<p>this is for a dummy, simple protocol, but the idea…[/quote]<br>
did you consider doing … …<br>
i think it would be more organized, but maybe the way you did it is better cause you can see related packets all together</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/10</link>
        <pubDate>Sun, 25 Oct 2009 23:17:53 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-10</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>[quote=“Lothy, post:6, topic:310546”]The only downside to using a Map is that HashMaps are far more expensive to create than an Object[] with maybe a length of 4 or 5 for the average packet. The benefit of course is that you can acquire the values by a name rather than knowledge of an index.<br>
But if the PacketHandler only has to be implemented once then is that such a problem?[/quote]</p>
<p>Don’t keep creating and destroying the Map object, borrow them and return them to and from a MapPool object, reusing the same objects over and over is much faster and has no downsides.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/9</link>
        <pubDate>Sun, 25 Oct 2009 22:01:46 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-9</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@Jython super_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/jython">@Jython</a> wrote:</p>
          <blockquote>
              <blockquote>One of the interesting things in that other topic was the mention of decoder implementations handling the entirety of server version implementation.
Now that I think about it, I suppose that is entirely possible if each PacketHandler was provided with an Object[] of the values returned by the packet.
Currently GameEngine iteratively delegates Packet objects to PacketHandlers so that they can be decoded and handled.
What if there was a middleman, PacketDecoder, which parsed the packet's data based on the version's structure, and then delegated to the PacketHandler by passing each value read from the packet as a value in the aforementioned Object[]. PacketHandlers would, for the most part, remain entirely static from release to release while only the middleman adapters would have to be reimplemented for different versions.</blockquote>
done it:
[code]
    
        
        
    
    
        
        
        
    
    
    
        
    
    
        
    
    
        
        
    
    
        
    
    
        
    
    
        
        
            
            
            
            
        
    
[/code]
<p>this is for a dummy, simple protocol, but the idea…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/8</link>
        <pubDate>Sun, 25 Oct 2009 20:24:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-8</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@system system]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/system">@system</a> wrote:</p>
          <blockquote>
              <p>[quote=“la­wl, post:5, topic:310546”]this is all very vague, doesnt sound like you have a strong idea of what your design looks like[/quote]That’s why I’m posting it here, to get your guys’ input. <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
<p>[quote=“Lothy, post:3, topic:310546”]Your point about threading is ridiculously dated. There’s no reason in this day and age for any program, especially a program that is meant to offer as much throughput as possible, to use a single thread model.<br>
You can reduce overhead anyway by designing the application properly in the first place, thus minimising contention between threads. Also know that thread context switches are not unreasonable, as threads are pretty light-weight.<br>
Plus why design something for dated hardware? We aren’t running a company where we’re looking to support minimal hardware requirements; if people can run it then they can run it, if not then better luck next time. As if there aren’t enough Runescape emulation servers being hosted anyway.[/quote]<br>
There is <span class="bbcode-b">no</span> benefit of using multiple threads on a single-core machine except for the ability to control which segments of instructions run at which time, and for avoiding the drawbacks of blocking procedures. Let me remind you that multiple threads does not multiply CPU power, it simply distributes it along the program. When you use multiple threads, synchronization (by default) is needed at some points, and when you do not have the benefit of multiple cores but you have the drawbacks of synchronization coupled with the fact that threads use a lot of memory (they aren’t too lightweight) and that the kernel must save and load thread states on every context switch, then the entire system will run slower than it would if it was just on one thread.<br>
Also, remember my idea behind this server - the final, ideal base for everyone to use. And single-core CPUs are not out-dated, they are still in production (non-legacy) afaik. Not to mention some people may not be able to afford multi-core hosting machines.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/7</link>
        <pubDate>Sun, 25 Oct 2009 18:55:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-7</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>The only downside to using a Map is that HashMaps are far more expensive to create than an Object[] with maybe a length of 4 or 5 for the average packet. The benefit of course is that you can acquire the values by a name rather than knowledge of an index.<br>
But if the PacketHandler only has to be implemented once then is that such a problem?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/6</link>
        <pubDate>Sun, 25 Oct 2009 16:10:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-6</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@lawl lawl]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lawl">@lawl</a> wrote:</p>
          <blockquote>
              <p>this is all very vague, doesnt sound like you have a strong idea of what your design looks like</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/5</link>
        <pubDate>Sun, 25 Oct 2009 15:47:14 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-5</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@Stork Stork]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/stork">@Stork</a> wrote:</p>
          <blockquote>
              <p>[quote=“Lothy, post:3, topic:310546”]Your point about threading is ridiculously dated. There’s no reason in this day and age for any program, especially a program that is meant to offer as much throughput as possible, to use a single thread model.<br>
You can reduce overhead anyway by designing the application properly in the first place, thus minimising contention between threads. Also know that thread context switches are not unreasonable, as threads are pretty light-weight.[/quote]<br>
Trouble is figuring out where the contentions are. That’s not easy to do IMO, especially for new users.</p>
<aside class="quote no-group quote-modified" data-post="3" data-topic="310546">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/lothy/40/51_1.png" class="avatar"> Lothy:</div>
<blockquote>
<p>Plus why design something for dated hardware? We aren’t running a company where we’re looking to support minimal hardware requirements; if people can run it then they can run it, if not then better luck next time. As if there aren’t enough Runescape emulation servers being hosted anyway.</p>
</blockquote>
</aside>
<p>x2. Just design it to run with x&gt;=1 threads, it doesn’t have to scale perfectly (though that’d be the goal).</p>
<aside class="quote no-group quote-modified" data-post="3" data-topic="310546">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/lothy/40/51_1.png" class="avatar"> Lothy:</div>
<blockquote>
<p>You might find the discussion in Stork’s thread of some interest to you (although I think you’ve already discovered it).</p>
</blockquote>
</aside>
<p>Yeah, I’m great.</p>
<aside class="quote no-group" data-post="3" data-topic="310546">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/lothy/40/51_1.png" class="avatar"> Lothy:</div>
<blockquote>
<p>It would be nice if a server had both database abstraction and script abstraction. If that was to be implemented for numerous DBMS and numerous scripting languages then epeen++, amirite?</p>
</blockquote>
</aside>
<p>We should aim to support sqlite and mysql out of the box.</p>
<p>JDBC is pretty pluggable - all we need to do is initialize the JDBC register class (e.g. for mysql it’s com.mysql.jdbc.JDBCDriver or something) and then the rest of the code is the same, so as long as the user passes the driver class file name and places the .jar on the classpath it should work.</p>
<p>[quote=“Lothy, post:3, topic:310546”]One of the interesting things in that other topic was the mention of decoder implementations handling the entirety of server version implementation.<br>
Now that I think about it, I suppose that is entirely possible if each PacketHandler was provided with an Object[] of the values returned by the packet.<br>
Currently GameEngine iteratively delegates Packet objects to PacketHandlers so that they can be decoded and handled.<br>
What if there was a middleman, PacketDecoder, which parsed the packet’s data based on the version’s structure, and then delegated to the PacketHandler by passing each value read from the packet as a value in the aforementioned Object[]. PacketHandlers would, for the most part, remain entirely static from release to release while only the middleman adapters would have to be reimplemented for different versions.[/quote]<br>
Kinda like this idea, but I’d rather use a map than an Object[] (or do it the way ResultSet does and use both).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/4</link>
        <pubDate>Sun, 25 Oct 2009 15:37:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-4</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>Your point about threading is ridiculously dated. There’s no reason in this day and age for any program, especially a program that is meant to offer as much throughput as possible, to use a single thread model.<br>
You can reduce overhead anyway by designing the application properly in the first place, thus minimising contention between threads. Also know that thread context switches are not unreasonable, as threads are pretty light-weight.<br>
Plus why design something for dated hardware? We aren’t running a company where we’re looking to support minimal hardware requirements; if people can run it then they can run it, if not then better luck next time. As if there aren’t enough Runescape emulation servers being hosted anyway.</p>
<p>You might find the discussion in Stork’s thread of some interest to you (although I think you’ve already discovered it).<br>
It would be nice if a server had both database abstraction and script abstraction. If that was to be implemented for numerous DBMS and numerous scripting languages then epeen++, amirite?</p>
<p>One of the interesting things in that other topic was the mention of decoder implementations handling the entirety of server version implementation.<br>
Now that I think about it, I suppose that is entirely possible if each PacketHandler was provided with an Object[] of the values returned by the packet.<br>
Currently GameEngine iteratively delegates Packet objects to PacketHandlers so that they can be decoded and handled.<br>
What if there was a middleman, PacketDecoder, which parsed the packet’s data based on the version’s structure, and then delegated to the PacketHandler by passing each value read from the packet as a value in the aforementioned Object[]. PacketHandlers would, for the most part, remain entirely static from release to release while only the middleman adapters would have to be reimplemented for different versions.</p>
<p>Just my thoughts.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/3</link>
        <pubDate>Sun, 25 Oct 2009 15:02:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-3</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@thiefmn6092 thiefmn6092]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/thiefmn6092">@thiefmn6092</a> wrote:</p>
          <blockquote>
              <p>Sounds like what we had talked about on AIM. When you say optimized for different hardware setups; does this mean on the processor level, like changing the target CPU when compiling (like if you used C and GCC as the compiler) or just to available processor count and memory.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/2</link>
        <pubDate>Sun, 25 Oct 2009 12:41:37 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-2</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
      <item>
        <title>Brainstorm: The ideal server?</title>
        <dc:creator><![CDATA[@system system]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/system">@system</a> wrote:</p>
          <blockquote>
              <p>Hey guys, I did some thinking and came up with some ideas for the ideal server for RuneScape private servers - something global, community-independent, that would eliminate the need for people to write their own server bases and the other problems with developing and hosting private servers.</p>
<p>This project would follow the ideas and values of the <a href="http://opensource.org/" data-bbcode="true">Open Source Initiative</a> without question. It would ideally be developed under the <a href="http://www.gnu.org/licenses/gpl.html" data-bbcode="true">GNU General Public License v3</a>. The basic idea is to develop the “final” server base that would eliminate any reason to use another source.</p>
<p>This is all cliche information that you are all familiar with, however. I want to instead, discuss and brainstorm with you the design of such a server. I have been talking with many people (mainly Taharok) and been reading quite a bit of posts in this section and have been able to come up with a pretty awesome design and I want to run it over you guys, as well as get your design ideas and hopefully we can have a very constructive thread going on here.</p>
<p><span class="bbcode-b">My Design Idea</span><br>
In my opinion, the ideal server would be something ideal for developers - seeing as we are a hacking community, we don’t need to worry about making fancy GUI applications or incredibly user-friendly things; instead we can focus on programmer-friendly things.</p>
<p>My design would be one where the entire server is build from modular, interchangable parts - designed for different hardware setups and client revisions. Every operating part of the server will be built under an interface system - systems for networking, different engine designs, different protocol encoders/decoders, etc. that could all be developed and distributed along with the source, built under a default configuration (“this” networking system, with “this” engine, and “these” encoder/decoders, etc) but allowing the user to select different pieces and “build” their server from the existing modules, or even write their own modules of the server for ultimate configuration of how it operates. The resulting server would be an <span class="bbcode-i">incredibly</span> flexible, yet (hopefully) reliable and scalable base. As for content, the content system would be written in a scripting language, and the content will be separated from the internals of the server as to make the content protocol independent. Ideally, the server would be able to run under multiple protocols, and multiple worlds simultaneously - while retaining the same independent content system across every world and client revision.<br>
As for scalability, the incredibly object-oriented nature of such a design would provide a challenge. I believe, however, that private servers will never grow to the point where there are several thousand players in one server, and if so possibly the server could have an intuitive clustering system build-in using <a href="http://java.sun.com/docs/books/tutorial/rmi/index.html" data-bbcode="true">Java RMI</a> to make up for such a performance loss.<br>
As for benefits of such a design, you could have multiple parts of the different server that are optimized for different hardware setups - what is the point in having a complicated, thread-pooled system (which requires appropriate synchronization) if you only have one CPU to run it on? In that case, you’d want to go with a single-threaded engine approach because there would be no benefit in multi-threading, and you’d still suffer from synchronization bottlenecks. However, what if you have an 8-core system but the engine only runs on one thread? In this case, you’re only using 12.5% (1/8) of your processing power - here you would want to use a thread-pooled engine module instead of a single threaded one. A similar approach could be done with networking. Another benefit would be the codec system modules - you could easily swap them for a different server operating protocol, or even use them together to make a protocol-hybrid server (multiple different revision clients playing together at the same time). You could also have separate worlds with world instancing, it would all be very easy to do due to the modular, flexible design of the server.</p>
<p>Discuss your thoughts of my design, and please post your own design ideas.<br>
Let’s get a good brainstorming thread going on here!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546/1</link>
        <pubDate>Sun, 25 Oct 2009 05:40:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-310546-1</guid>
        <source url="https://forum.moparisthebest.com/t/brainstorm-the-ideal-server/310546.rss">Brainstorm: The ideal server?</source>
      </item>
  </channel>
</rss>
