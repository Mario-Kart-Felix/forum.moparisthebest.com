<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
    <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640</link>
    <description>So, since I have lost interested in finishing this, I thought it&#39;d be cool to release the code for someone else to make use of it. There will be things you need to fix yourself such as setting a condition to check the rarity of the drop so that a message is sent for if its rare. Also, I know its not the best, but it works and it works specifically for Galkon&#39;s Clan Chat, so you&#39;d need a clan chat system similar in design to it for this to work, or you&#39;d need to edit it a lot. This will work for the clan chat in Krithium (eeewwwwwwwwwwwwwwwwwwww disgusting), Virtue, and any other Virtue based server.

If you want more information on this system before using, if you can, then visit this show off thread I made awhile ago: [url=http://www.rune-server.org/runescape-development/google/show-off/504276-my-lootshare-system.html]http://www.rune-server.org/runescape-development/google/show-off/504276-my-lootshare-system.html[/url] (Includes a Video Demo)

[B]NOTE: You will need to fix the imports since the packaging in my server is different.[/B]

[B][U]Server Sided:[/U][/B]

So first, add this class in the clan package

[code=java]package com.vicious.revolution.game.content.clan;

import java.util.Iterator;

import com.vicious.revolution.event.Event;
import com.vicious.revolution.event.EventContainer;
import com.vicious.revolution.event.EventManager;
import com.vicious.revolution.game.model.player.Client;
import com.vicious.revolution.game.model.player.PlayerHandler;

/**
 * LootShare.java
 * 
 * @author Stuart Perera &lt;RiiPiiNFtW&gt;
 * @date 8/12/13
 * 
 *       LootShare designed specifically to work with Galkon&#39;s Clan Chat and
 *       RiiPiiNFtW&#39;s Drop System. Can be modified to work with other drop
 *       systems, however, it&#39;d require more work.
 * 
 */

public final class LootShare
{

	public static void findStatus(final Client c)
	{
		c.getPA().sendConfig(542, c.getClan().lootshareEnabled ? 0 : 1);
	}

	/**
	 * Activate and deactivate the lootshare
	 * 
	 * @param c
	 *            the {@link Client}
	 */
	public static void checkStatus(final Client c)
	{
		// He is not in any clan
		if (c.getClan() == null)
		{
			return;
		}
		// Now we dont need to loop for every player in the game
		// thats why galkon made a list for the players in the clan
		// so we simply iterate over them
		/**
		 * Is faster too cause we simply &#39;loop&#39; for the players in the team
		 */
		final Iterator&lt;String&gt; iterator = c.getClan().activeMembers.iterator();
		final boolean enabled = !c.getClan().lootshareEnabled;
		while (iterator.hasNext())
		{
			final Client playerInClan = (Client) PlayerHandler
					.getPlayer(iterator.next());

			if (c.getClan().canToggleLS(c.playerName))
			{
				if (enabled)
				{
					playerInClan
							.getPA()
							.sendClan(
									&quot;Clan&quot;,
									&quot;Lootshare has been toggled and will turn on in 1 minute!&quot;,
									c.clan.getTitle(), 2);

					EventManager.getSingleton().addEvent(new Event()
					{
						@Override
						public void execute(final EventContainer e)
						{
							final String message = &quot;LootShare has been turned on.&quot;;

							playerInClan.getPA().sendClan(&quot;Clan&quot;, message,
									c.clan.getTitle(), 2);

							playerInClan.getPA().sendConfig(542, 0);
							e.stop();
						}
					}, 60000);
				}
				else
				{
					final String message = &quot;LootShare has been turned off.&quot;;

					playerInClan.getPA().sendClan(&quot;Clan&quot;, message,
							c.clan.getTitle(), 2);

					playerInClan.getPA().sendConfig(542, 1);

				}
			}
			else
			{
				c.sendMessage(&quot;You do not have significant rights to toggle this feature!&quot;);
			}
		}
		// Then we proceed to set the lootshare state to the opposite state
		c.getClan().lootshareEnabled = enabled;
	}

	/**
	 * Announces a rare/very rare drop to the clan.
	 * 
	 * @param c
	 *            the {@link Client}
	 * @param drop
	 * 
	 * @return item name
	 */
	public static void announceDrop(final Client c, final String drop)
	{
		final Iterator&lt;String&gt; iterator = c.getClan().activeMembers.iterator();
		while (iterator.hasNext())
		{
			final Client playerInClan = (Client) PlayerHandler
					.getPlayer(iterator.next());

			playerInClan.getPA().sendClan(&quot;Clan&quot;, drop, c.clan.getTitle(), 2);
		}
	}

	/**
	 * Turns off lootshare upon logout of clan leader.
	 * 
	 * @param c
	 *            the {@link Client}
	 * @return
	 */
	public static boolean destroy(final Client c)
	{
		if (c.getClan() != null)
		{
			if (c.getClan().isFounder(c.playerName))
			{
				if (c.getClan().lootshareEnabled)
				{
					LootShare.checkStatus(c);
					return true;
				}
			}
		}
		return false;
	}
}
[/code]

Add this to the Clan.java class:

[code=java]/**
	 * Can they toggle LootShare?
	 * 
	 * @param name
	 * @return
	 */
	public boolean canToggleLS(final String name)
	{
		if (this.isFounder(name))
		{
			return true;
		}
		if (this.getRank(name) &gt;= this.whoCanToggleLS)
		{
			return true;
		}
		return false;
	}[/code]

and

[code=java]public int whoCanToggleLS = Rank.CAPTAIN; //Edit this for the rank you want to have the ability to toggle LS
public boolean lootshareEnabled = false;[/code]

Add this case into your Button Clicking packet:

[code=java]case 195198:
			LootShare.checkStatus(c);
			break;[/code]

So this is where I leave it to you, but I will leave you an example for how I announce my drops:

Note that this is an example, this will not be spoonfed to you because I wrote this to be handled on my own personal drop system.

[code=java]if (c.clan != null &amp;&amp; c.getClan().lootshareEnabled)
		{
			if (table == Rarity.COMMON || table == Rarity.VERY_RARE)
			{
				LootShare.announceDrop(
						c,
						Misc.optimizeText(c.playerName)
								+ &quot; recieved: X&quot;
								+ amount
								+ &quot; &quot;
								+ Misc.optimizeText(c.getItems()
										.getItemName(id)) + &quot;.&quot;);
			}
		}[/code]

[B][U]Client/Cache Sided:[/U][/B]

Download these two sprites: 
[url=http://uppit.com/2jo4a76q2rn3/LootShare_0.png]Download Loot.Share.png @ UppIT[/url]
[url=http://uppit.com/qggjmu7q7096/Lootshare_1.png]Download Lootshare.png @ UppIT[/url]

Place them into: &quot;cache/Sprites/Clan Chat/&quot;

Now for the interface edits:

Note that I did change the childInterfaceIds on my current clanChatTab interface because they intervened with my skill tab, so you may need to change them which is easy.

Add this to the clanChatTab method

[code=java]addConfigButton(50118, 50000, 1, 0, &quot;/Clan Chat/LOOTSHARE&quot;, 34, 29, &quot;Toggle Lootshare&quot;, 1, 5, 542);[/code]

then we need to extend the value of the array so change

[code=java]tab.totalChildren(13);[/code]

to

[code=java]tab.totalChildren(14);[/code]

and under

[code=java]tab.child(12, 50012, 25, 38); //50012 will be different just so you know[/code]

add

[code=java]tab.child(13, 50118, 145, 15); //50018 will be different, but is the same as to what you changed up above.[/code]

Also, if you do not have the &quot;sendConfig(int, int)&quot; method, add it into PlayerAssistant.java:

[code=java]public void sendConfig(final int id, final int state)
	{
		if (this.c.getOutStream() != null &amp;&amp; this.c != null)
		{
			if (state &lt; 128)
			{
				this.c.getOutStream().createFrame(36);
				this.c.getOutStream().writeWordBigEndian(id);
				this.c.getOutStream().writeByte(state);
			}
			else
			{
				this.c.getOutStream().createFrame(87);
				this.c.getOutStream().writeWordBigEndian_dup(id);
				this.c.getOutStream().writeDWord_v1(state);
			}
			this.c.flushOutStream();
		}
	}[/code]

If this doesn&#39;t work for you still, let me know. I may of easily forgotten something.</description>
    
    <lastBuildDate>Tue, 05 Nov 2013 08:31:53 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@blackflag1 blackflag_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/blackflag1">@blackflag1</a> wrote:</p>
          <blockquote>
              <p>kool, and btw that toggle method</p>
<p><code>   public static boolean toggle(final String name) {
        return isFounder(name) || getRank(name) &gt;= this.whoCanToggleLS;
    }</code></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/12</link>
        <pubDate>Tue, 05 Nov 2013 08:31:53 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-12</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@dawsonsmokes dawsonsmokes]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/dawsonsmokes">@dawsonsmokes</a> wrote:</p>
          <blockquote>
              <p>Re Upload the sprites (y)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/11</link>
        <pubDate>Tue, 05 Nov 2013 06:25:03 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-11</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@RiiPiiNFtW RiiPiiNFtW]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/riipiinftw">@RiiPiiNFtW</a> wrote:</p>
          <blockquote>
              <p>[quote=“ta1nt3d, post:9, topic:528640”]not bad but you really do need to work on your conventions :D[/quote]Oh you’re one to talk mister. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/10</link>
        <pubDate>Thu, 29 Aug 2013 02:54:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-10</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@ta1nt3d ta1nt3d]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ta1nt3d">@ta1nt3d</a> wrote:</p>
          <blockquote>
              <p>not bad but you really do need to work on your conventions <img src="https://forum.moparisthebest.com/images/emoji/twitter/smiley.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/9</link>
        <pubDate>Thu, 29 Aug 2013 01:34:05 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-9</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@RiiPiiNFtW RiiPiiNFtW]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/riipiinftw">@RiiPiiNFtW</a> wrote:</p>
          <blockquote>
              <p>Awh man. It got cleaned. <img src="https://forum.moparisthebest.com/images/emoji/twitter/frowning.png?v=5" title=":frowning:" class="emoji" alt=":frowning:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/8</link>
        <pubDate>Sun, 25 Aug 2013 16:03:20 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-8</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@Vain1 Vain_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/vain1">@Vain1</a> wrote:</p>
          <blockquote>
              <p>[quote=“Agent Jugz, post:6, topic:528640”]i would not do all of this for a lootshare button[/quote]i wouldn’t add a login protocol just for a login button</p>
<p>don’t judge something by its length of code, and there’s no need to comment if you won’t use it.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/7</link>
        <pubDate>Sun, 25 Aug 2013 13:11:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-7</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@Agent_Jugz Agent Jugz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/agent_jugz">@Agent_Jugz</a> wrote:</p>
          <blockquote>
              <p>i would not do all of this for a lootshare button</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/6</link>
        <pubDate>Sun, 25 Aug 2013 12:14:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-6</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@RiiPiiNFtW RiiPiiNFtW]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/riipiinftw">@RiiPiiNFtW</a> wrote:</p>
          <blockquote>
              <p>[quote=“sinisoul, post:2, topic:528640”]<code>
c.clan != null
</code></p>
<p>ew. <a href="https://code.google.com/p/guava-libraries/wiki/UsingAndAvoidingNullExplained" rel="nofollow noopener">https://code.google.com/p/guava-libraries/wiki/UsingAndAvoidingNullExplained</a></p>
<pre><code class="lang-auto">     while (iterator.hasNext())
                {</code></pre>
<p>Don’t need to use an iterator.</p>
<pre><code class="lang-auto"> if (...)
                        {</code></pre>
<p>Your conventions suck.</p>
<pre><code class="lang-auto"> LootShare.checkStatus(c);</code></pre>
<p>You should move this into the clan object (all the methods listed in the LootShare object actually).</p>
<p>Room for lots of improvement![/quote]Oooh. Thanks for posting something for me to improve on. I will read up on it now. <img src="https://forum.moparisthebest.com/images/emoji/twitter/smiley.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/5</link>
        <pubDate>Thu, 22 Aug 2013 15:44:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-5</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@Java-RSPS-Noob Java-RSPS-Noob]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/java-rsps-noob">@Java-RSPS-Noob</a> wrote:</p>
          <blockquote>
              <p><a class="mention" href="/u/sini">@Sini</a>,</p>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://assets-cdn.github.com/favicon.ico" class="site-icon" width="32" height="32">
      <a href="https://github.com/google/guava" target="_blank" rel="nofollow noopener">GitHub</a>
  </header>
  <article class="onebox-body">
    <img src="https://avatars0.githubusercontent.com/u/1342004?s=400&amp;v=4" class="thumbnail onebox-avatar" width="400" height="400">

<h3><a href="https://github.com/google/guava" target="_blank" rel="nofollow noopener">google/guava</a></h3>

<p>guava - Google core libraries for Java</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>thanks babe I actually learned something &lt;3</p>
<p>Thanks for the contrib Stuart <em>thumbs up</em></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/4</link>
        <pubDate>Thu, 22 Aug 2013 13:36:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-4</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@xxx123xxx xxx123xxx]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/xxx123xxx">@xxx123xxx</a> wrote:</p>
          <blockquote>
              <p>Hey man, good job.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/3</link>
        <pubDate>Thu, 22 Aug 2013 08:40:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-3</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@sinisoul sini]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sinisoul">@sinisoul</a> wrote:</p>
          <blockquote>
              <pre><code class="lang-auto">c.clan != null</code></pre>
<p>ew. <a href="https://code.google.com/p/guava-libraries/wiki/UsingAndAvoidingNullExplained" rel="nofollow noopener">https://code.google.com/p/guava-libraries/wiki/UsingAndAvoidingNullExplained</a></p>
<pre><code class="lang-auto">     while (iterator.hasNext())
                {</code></pre>
<p>Don’t need to use an iterator.</p>
<pre><code class="lang-auto"> if (...)
                        {</code></pre>
<p>Your conventions suck.</p>
<pre><code class="lang-auto"> LootShare.checkStatus(c);</code></pre>
<p>You should move this into the clan object (all the methods listed in the LootShare object actually).</p>
<p>Room for lots of improvement!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/2</link>
        <pubDate>Thu, 22 Aug 2013 07:15:19 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-2</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
      <item>
        <title>RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</title>
        <dc:creator><![CDATA[@RiiPiiNFtW RiiPiiNFtW]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/riipiinftw">@RiiPiiNFtW</a> wrote:</p>
          <blockquote>
              <p>So, since I have lost interested in finishing this, I thought it’d be cool to release the code for someone else to make use of it. There will be things you need to fix yourself such as setting a condition to check the rarity of the drop so that a message is sent for if its rare. Also, I know its not the best, but it works and it works specifically for Galkon’s Clan Chat, so you’d need a clan chat system similar in design to it for this to work, or you’d need to edit it a lot. This will work for the clan chat in Krithium (eeewwwwwwwwwwwwwwwwwwww disgusting), Virtue, and any other Virtue based server.</p>
<p>If you want more information on this system before using, if you can, then visit this show off thread I made awhile ago: <a href="http://www.rune-server.org/runescape-development/google/show-off/504276-my-lootshare-system.html" data-bbcode="true" rel="nofollow noopener">http://www.rune-server.org/runescape-development/google/show-off/504276-my-lootshare-system.html</a> (Includes a Video Demo)</p>
<p><span class="bbcode-b">NOTE: You will need to fix the imports since the packaging in my server is different.</span></p>
<p><span class="bbcode-b"><span class="bbcode-u">Server Sided:</span></span></p>
<p>So first, add this class in the clan package</p>
<p>[code=java]package com.vicious.revolution.game.content.clan;</p>
<p>import java.util.Iterator;</p>
<p>import com.vicious.revolution.event.Event;<br>
import com.vicious.revolution.event.EventContainer;<br>
import com.vicious.revolution.event.EventManager;<br>
import com.vicious.revolution.game.model.player.Client;<br>
import com.vicious.revolution.game.model.player.PlayerHandler;</p>
<p>/**</p>
<ul>
<li>LootShare.java</li>
<li>
</li>
<li>
<span class="mention">@author</span> Stuart Perera </li>
<li>
<a class="mention" href="/u/date">@date</a> 8/12/13</li>
<li>
</li>
<li>
<pre><code>  LootShare designed specifically to work with Galkon's Clan Chat and
</code></pre>
</li>
<li>
<pre><code>  RiiPiiNFtW's Drop System. Can be modified to work with other drop
</code></pre>
</li>
<li>
<pre><code>  systems, however, it'd require more work.
</code></pre>
</li>
<li>
</li>
</ul>
<p>*/</p>
<p>public final class LootShare<br>
{</p>
<pre><code>public static void findStatus(final Client c)
{
	c.getPA().sendConfig(542, c.getClan().lootshareEnabled ? 0 : 1);
}

/**
 * Activate and deactivate the lootshare
 * 
 * @param c
 *            the {@link Client}
 */
public static void checkStatus(final Client c)
{
	// He is not in any clan
	if (c.getClan() == null)
	{
		return;
	}
	// Now we dont need to loop for every player in the game
	// thats why galkon made a list for the players in the clan
	// so we simply iterate over them
	/**
	 * Is faster too cause we simply 'loop' for the players in the team
	 */
	final Iterator&lt;String&gt; iterator = c.getClan().activeMembers.iterator();
	final boolean enabled = !c.getClan().lootshareEnabled;
	while (iterator.hasNext())
	{
		final Client playerInClan = (Client) PlayerHandler
				.getPlayer(iterator.next());

		if (c.getClan().canToggleLS(c.playerName))
		{
			if (enabled)
			{
				playerInClan
						.getPA()
						.sendClan(
								"Clan",
								"Lootshare has been toggled and will turn on in 1 minute!",
								c.clan.getTitle(), 2);

				EventManager.getSingleton().addEvent(new Event()
				{
					@Override
					public void execute(final EventContainer e)
					{
						final String message = "LootShare has been turned on.";

						playerInClan.getPA().sendClan("Clan", message,
								c.clan.getTitle(), 2);

						playerInClan.getPA().sendConfig(542, 0);
						e.stop();
					}
				}, 60000);
			}
			else
			{
				final String message = "LootShare has been turned off.";

				playerInClan.getPA().sendClan("Clan", message,
						c.clan.getTitle(), 2);

				playerInClan.getPA().sendConfig(542, 1);

			}
		}
		else
		{
			c.sendMessage("You do not have significant rights to toggle this feature!");
		}
	}
	// Then we proceed to set the lootshare state to the opposite state
	c.getClan().lootshareEnabled = enabled;
}

/**
 * Announces a rare/very rare drop to the clan.
 * 
 * @param c
 *            the {@link Client}
 * @param drop
 * 
 * @return item name
 */
public static void announceDrop(final Client c, final String drop)
{
	final Iterator&lt;String&gt; iterator = c.getClan().activeMembers.iterator();
	while (iterator.hasNext())
	{
		final Client playerInClan = (Client) PlayerHandler
				.getPlayer(iterator.next());

		playerInClan.getPA().sendClan("Clan", drop, c.clan.getTitle(), 2);
	}
}

/**
 * Turns off lootshare upon logout of clan leader.
 * 
 * @param c
 *            the {@link Client}
 * @return
 */
public static boolean destroy(final Client c)
{
	if (c.getClan() != null)
	{
		if (c.getClan().isFounder(c.playerName))
		{
			if (c.getClan().lootshareEnabled)
			{
				LootShare.checkStatus(c);
				return true;
			}
		}
	}
	return false;
}
</code></pre>
<p>}<br>
[/code]</p>
<p>Add this to the Clan.java class:</p>
<p><code>/**
	 * Can they toggle LootShare?
	 * 
	 * @param name
	 * @return
	 */
	public boolean canToggleLS(final String name)
	{
		if (this.isFounder(name))
		{
			return true;
		}
		if (this.getRank(name) &gt;= this.whoCanToggleLS)
		{
			return true;
		}
		return false;
	}</code></p>
<p>and</p>
<p><code>public int whoCanToggleLS = Rank.CAPTAIN; //Edit this for the rank you want to have the ability to toggle LS
public boolean lootshareEnabled = false;</code></p>
<p>Add this case into your Button Clicking packet:</p>
<p><code>case 195198:
			LootShare.checkStatus(c);
			break;</code></p>
<p>So this is where I leave it to you, but I will leave you an example for how I announce my drops:</p>
<p>Note that this is an example, this will not be spoonfed to you because I wrote this to be handled on my own personal drop system.</p>
<p><code>if (c.clan != null &amp;&amp; c.getClan().lootshareEnabled)
		{
			if (table == Rarity.COMMON || table == Rarity.VERY_RARE)
			{
				LootShare.announceDrop(
						c,
						Misc.optimizeText(c.playerName)
								+ " recieved: X"
								+ amount
								+ " "
								+ Misc.optimizeText(c.getItems()
										.getItemName(id)) + ".");
			}
		}</code></p>
<p><span class="bbcode-b"><span class="bbcode-u">Client/Cache Sided:</span></span></p>
<p>Download these two sprites:<br>
<a href="http://uppit.com/2jo4a76q2rn3/LootShare_0.png" data-bbcode="true" rel="nofollow noopener">Download Loot.Share.png @ UppIT</a><br>
<a href="http://uppit.com/qggjmu7q7096/Lootshare_1.png" data-bbcode="true" rel="nofollow noopener">Download Lootshare.png @ UppIT</a></p>
<p>Place them into: “cache/Sprites/Clan Chat/”</p>
<p>Now for the interface edits:</p>
<p>Note that I did change the childInterfaceIds on my current clanChatTab interface because they intervened with my skill tab, so you may need to change them which is easy.</p>
<p>Add this to the clanChatTab method</p>
<pre><code class="lang-auto"></code></pre>
<p>then we need to extend the value of the array so change</p>
<pre><code class="lang-auto"></code></pre>
<p>to</p>
<pre><code class="lang-auto"></code></pre>
<p>and under</p>
<pre><code class="lang-auto"></code></pre>
<p>add</p>
<pre><code class="lang-auto"></code></pre>
<p>Also, if you do not have the “sendConfig(int, int)” method, add it into PlayerAssistant.java:</p>
<p><code>public void sendConfig(final int id, final int state)
	{
		if (this.c.getOutStream() != null &amp;&amp; this.c != null)
		{
			if (state &lt; 128)
			{
				this.c.getOutStream().createFrame(36);
				this.c.getOutStream().writeWordBigEndian(id);
				this.c.getOutStream().writeByte(state);
			}
			else
			{
				this.c.getOutStream().createFrame(87);
				this.c.getOutStream().writeWordBigEndian_dup(id);
				this.c.getOutStream().writeDWord_v1(state);
			}
			this.c.flushOutStream();
		}
	}</code></p>
<p>If this doesn’t work for you still, let me know. I may of easily forgotten something.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640/1</link>
        <pubDate>Thu, 22 Aug 2013 05:11:37 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-528640-1</guid>
        <source url="https://forum.moparisthebest.com/t/riipiinftws-lootshare-system-addition-to-galkons-clan-chat/528640.rss">RiiPiiNFtW&#39;s LootShare System - Addition to Galkon&#39;s Clan Chat</source>
      </item>
  </channel>
</rss>
