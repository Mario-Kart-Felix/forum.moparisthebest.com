<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/astexj-cfg-and-more/337092 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 06:02:44 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Astexj (CFG and ... more?) - General Programming - moparisthebest.com</title>
    <meta name="description" content="Hello comrades,     I&amp;#39;m not sure how particularly useful you guys&amp;#39;ll find this, but I&amp;#39;m in the midst of a broad redesign of my Java bytecode &amp;quot;decompiler&amp;quot;, and I thought that I&amp;#39;d share what I&amp;#39;ve done so far. The goal is t&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="337092.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Astexj (CFG and ... more?)&#39;" href="337092.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/astexj-cfg-and-more/337092" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/astexj-cfg-and-more/337092" />
<meta property="og:title" content="Astexj (CFG and ... more?)" />
<meta name="twitter:title" content="Astexj (CFG and ... more?)" />
<meta property="og:description" content="Hello comrades,  I’m not sure how particularly useful you guys’ll find this, but I’m in the midst of a broad redesign of my Java bytecode “decompiler”, and I thought that I’d share what I’ve done so far. The goal is to work it up to an AST builder that will require little extension to use it as a decompiler. I’ve lamely called it (a) Statement-Expression Library for Java.  What you get here is a control-flow graph builder (mostly courtesy of ASM) and an… uh… “instruction consumption analyzer”. T..." />
<meta name="twitter:description" content="Hello comrades,  I’m not sure how particularly useful you guys’ll find this, but I’m in the midst of a broad redesign of my Java bytecode “decompiler”, and I thought that I’d share what I’ve done so far. The goal is to work it up to an AST builder that will require little extension to use it as a decompiler. I’ve lamely called it (a) Statement-Expression Library for Java.  What you get here is a control-flow graph builder (mostly courtesy of ASM) and an… uh… “instruction consumption analyzer”. T..." />
<meta property="article:published_time" content="2010-04-17T05:39:32+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="337092.html">Astexj (CFG and ... more?)</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/White_Castle.html'><span itemprop='name'>White_Castle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-17T05:39:32Z'>
            <time itemprop='dateModified' datetime='2016-07-31T15:58:59Z' class='post-time'>
              July 31, 2016,  3:58pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hello comrades,<br>
I’m not sure how particularly useful you guys’ll find this, but I’m in the midst of a broad redesign of my Java bytecode “decompiler”, and I thought that I’d share what I’ve done so far. The goal is to work it up to an AST builder that will require little extension to use it as a decompiler. I’ve lamely called it (<span class="bbcode-b">a</span>) <span class="bbcode-b">St</span>atement-<span class="bbcode-b">Ex</span>pression Library for <span class="bbcode-b">J</span>ava.<br>
What you get here is a control-flow graph builder (mostly courtesy of ASM) and an… uh… “instruction consumption analyzer”. The latter allows you to examine which instructions (or rather their resultant values) are used by other instructions. It’s pretty rudimentary, but I think some people might find it useful.<br>
The documentation is sparse because I hate writing javadocs, so I’ll just give a brief rundown here.</p>
<p><span class="bbcode-b">com.astexj.ClassRepository</span>: provides the ability to load and examine the contents of classfiles (will be used later to track call stacks and such).<br>
<span class="bbcode-b">com.astexj.ConcreteFieldRef</span>: a reference to a field that is associated with an org.asm.tree.FieldNode.<br>
<span class="bbcode-b">com.astexj.ConcreteMethodRef</span>: same as above, but with a method.<br>
<span class="bbcode-b">com.astexj.FieldRef</span>: a reference to a field that is not associated with an org.asm.tree.FieldNode. This is necessary because com.astexj.ClassRepository.resolveField(String,String,String) may or may not be able to resolve a concrete field (i.e. a field in the Standard API; you’re probably not going to be loading rt.jar).<br>
<span class="bbcode-b">com.astexj.MethodRef</span>: same as above, but with a method.<br>
<span class="bbcode-b">com.astexj.cf.Block</span>: a “basic block,” i.e. a straightaway section of code that contains no jumps not at the end(org.asm.tree.JumpInsnNode) or jump targets not at the beginning (org.asm.tree.LabelNode).<br>
<span class="bbcode-b">com.astexj.cf.ConsumedValue</span>: a “value” that corresponds to instructions consumed by another instruction. Interface.<br>
<span class="bbcode-b">com.astexj.cf.ControlFlowAnalyzer</span>: the heart of the operation. Extends org.asm.tree.analysis.Analyzer. ~.analyze() will build the CFG and analyze the instructions.<br>
<span class="bbcode-b">com.astexj.cf.InvariableConsumedValue</span>: a “value” that corresponds to <span class="bbcode-i">one</span> instruction consumed by another instruction.<br>
<span class="bbcode-b">com.astexj.cf.VariableConsumedValue</span>: a “value” that corresponds to <span class="bbcode-i">two</span> instructions consumed by another instruction. I think only ternary expressions (e.g. condition ? val1 : val2) cause this.</p>
<p>I hope you guys find this useful, or at least find it interesting. Thanks for reading.</p>
<p><span class="bbcode-i">edit</span></p>
<p>I should probably give an example. The snippet:</p>
<p><code>      int i = 10;
      if(i == 10)
        System.out.println(i == 5 ? "true" : "false");</code></p>
<p>will be interpreted thusly:</p>
<p><code>#0
[] -&gt; (0-8) {
 0: org.objectweb.asm.tree.LabelNode
 1: org.objectweb.asm.tree.LineNumberNode
 2: bipush (consumed by [3]) (10)
 3: istore (consumes [2]) (var 0)
 4: org.objectweb.asm.tree.LabelNode
 5: org.objectweb.asm.tree.LineNumberNode
 6: iload (consumed by [8]) (var 0)
 7: bipush (consumed by [8]) (10)
 8: if_icmpne (consumes [6, 7])
} -&gt; [1, 5]
#1
[0] -&gt; (9-14) {
 9: org.objectweb.asm.tree.LabelNode
 10: org.objectweb.asm.tree.LineNumberNode
 11: getstatic (consumed by [20]) (java.lang.System.out)
 12: iload (consumed by [14]) (var 0)
 13: iconst_5 (consumed by [14])
 14: if_icmpne (consumes [12, 13])
} -&gt; [2, 3]
#2
[1] -&gt; (15-16) {
 15: ldc (consumed by [20]) ("true")
 16: goto
} -&gt; [4]
#3
[1] -&gt; (17-18) {
 17: org.objectweb.asm.tree.LabelNode
 18: ldc (consumed by [20]) ("false")
} -&gt; [4]
#4
[2, 3] -&gt; (19-20) {
 19: org.objectweb.asm.tree.LabelNode
 20: invokevirtual (consumes [11, 15~18]) (java.io.PrintStream.println)
} -&gt; [5]
#5
[0, 4] -&gt; (21-26) {
 21: org.objectweb.asm.tree.LabelNode
 22: org.objectweb.asm.tree.LineNumberNode
 ...</code></p>
<p>I added a few clarifications to the printout after the “consumes” or “consumed by” within parentheses. When the invokevirtual <span class="mention">@20</span> is states as consuming instructions 15~18, it means that it may consume either 15 or 18 (“true” or “false” respectively).</p>
      </div>

      <meta itemprop='headline' content='Astexj (CFG and ... more?)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BAsh.html'><span itemprop='name'>BAsh</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-17T06:20:21Z'>
            <time itemprop='dateModified' datetime='2016-07-31T15:59:01Z' class='post-time'>
              July 31, 2016,  3:59pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Looks good.</p>
<p>Bit of advice though:<br>
Analyzer with SourceInterpretor is slow as hell. You have two options. Either don’t use it which is probably best given that you aren’t using all of the information it generates. Or you can speed it up (it makes a copy of SourceValue for everything) (this requires quite a lot of effort).</p>
      </div>

      <meta itemprop='headline' content='Astexj (CFG and ... more?)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/White_Castle.html'><span itemprop='name'>White_Castle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-17T06:35:20Z'>
            <time itemprop='dateModified' datetime='2016-07-31T15:59:02Z' class='post-time'>
              July 31, 2016,  3:59pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I did try making my own implementation of Interpreter, but scrapped it halfway through. Speed isn’t that great of a concern at the moment, but I wasn’t aware that SourceInterpreter is particularly slow. Thanks!</p>
      </div>

      <meta itemprop='headline' content='Astexj (CFG and ... more?)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BAsh.html'><span itemprop='name'>BAsh</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-17T06:38:45Z'>
            <time itemprop='dateModified' datetime='2016-07-31T15:59:03Z' class='post-time'>
              July 31, 2016,  3:59pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="3" data-topic="337092">
<div class="title">
<div class="quote-controls"></div>
 White Castle:</div>
<blockquote>
<p>I did try making my own implementation of Interpreter, but scrapped it halfway through. Speed isn’t that great of a concern at the moment, but I wasn’t aware that SourceInterpreter is particularly slow. Thanks!</p>
</blockquote>
</aside>
<p>Its because it analyzes the variables as well. Since you only need stack you should be able to optimize it.</p>
      </div>

      <meta itemprop='headline' content='Astexj (CFG and ... more?)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/White_Castle.html'><span itemprop='name'>White_Castle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-17T06:56:33Z'>
            <time itemprop='dateModified' datetime='2016-07-31T15:59:04Z' class='post-time'>
              July 31, 2016,  3:59pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>True. However, I might be dealing with the variables later on, so I think I’ll handle optimization last. Thanks for your input!</p>
      </div>

      <meta itemprop='headline' content='Astexj (CFG and ... more?)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-17T07:34:17Z'>
            <time itemprop='dateModified' datetime='2016-07-31T15:59:05Z' class='post-time'>
              July 31, 2016,  3:59pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“BAsh, post:2, topic:337092”]Analyzer with SourceInterpretor is slow as hell[/quote]it isnt though, it used to be when i was using it but for whatever reason now, it isnt <img src="../../images/emoji/twitter/confusedae52.png?v=5" title=":confused:" class="emoji" alt=":confused:"></p>
<p>dont only conduct dataflow analysis on the stack, do locals too</p>
      </div>

      <meta itemprop='headline' content='Astexj (CFG and ... more?)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2010-04-17T13:59:22Z'>
            <time itemprop='dateModified' datetime='2016-07-31T15:59:14Z' class='post-time'>
              July 31, 2016,  3:59pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>good work you’ve got there, whitecastle.</p>
      </div>

      <meta itemprop='headline' content='Astexj (CFG and ... more?)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/astexj-cfg-and-more/337092 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 06:02:45 GMT -->
</html>
