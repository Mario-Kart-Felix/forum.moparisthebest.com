<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/stopwatch-class-for-throttling-actions/548696 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:07:27 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Stopwatch class for throttling actions - Runescape - moparisthebest.com</title>
    <meta name="description" content="Much easier and more accurate than the way wL servers do it. Any criticism is appreciated! 

Stopwatch class 

[code=java]package com.asteria.utility; 

import java.util.concurrent.TimeUnit; import java.util.function.Con&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="548696.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Stopwatch class for throttling actions&#39;" href="548696.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/stopwatch-class-for-throttling-actions/548696" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/stopwatch-class-for-throttling-actions/548696" />
<meta property="og:title" content="Stopwatch class for throttling actions" />
<meta name="twitter:title" content="Stopwatch class for throttling actions" />
<meta property="og:description" content="Much easier and more accurate than the way wL servers do it. Any criticism is appreciated!  Stopwatch class  [code=java]package com.asteria.utility;  import java.util.concurrent.TimeUnit;  import java.util.function.Consumer;  import com.google.common.base.MoreObjects;  /**    A utility class that provides functionality for measuring the elapsed time    between two different time periods.      @author lare96 http://www.rune-server.org/members/lare96/  */  public final class Stopwatch {  /**   The..." />
<meta name="twitter:description" content="Much easier and more accurate than the way wL servers do it. Any criticism is appreciated!  Stopwatch class  [code=java]package com.asteria.utility;  import java.util.concurrent.TimeUnit;  import java.util.function.Consumer;  import com.google.common.base.MoreObjects;  /**    A utility class that provides functionality for measuring the elapsed time    between two different time periods.      @author lare96 http://www.rune-server.org/members/lare96/  */  public final class Stopwatch {  /**   The..." />
<meta property="article:published_time" content="2014-12-24T07:38:25+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="548696.html">Stopwatch class for throttling actions</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Clawz_fury.html'><span itemprop='name'>Clawz_fury</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-24T07:38:25Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:08:27Z' class='post-time'>
              August 4, 2016,  2:08pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Much easier and more accurate than the way wL servers do it. Any criticism is appreciated!</p>
<p><span class="bbcode-u">Stopwatch class</span></p>
<p>[code=java]package com.asteria.utility;</p>
<p>import java.util.concurrent.TimeUnit;<br>
import java.util.function.Consumer;</p>
<p>import com.google.common.base.MoreObjects;</p>
<p>/**</p>
<ul>
<li>
<p>A utility class that provides functionality for measuring the elapsed time</p>
</li>
<li>
<p>between two different time periods.</p>
</li>
<li>
</li>
<li>
<p><span class="mention">@author</span> lare96 <a href="http://www.rune-server.org/members/lare96/" rel="nofollow noopener">http://www.rune-server.org/members/lare96/</a><br>
*/<br>
public final class Stopwatch {</p>
<p>/**</p>
<ul>
<li>The internal cached time that acts as a time stamp.<br>
*/<br>
private long cachedTime = Utility.currentTime();</li>
</ul>
<p>/**</p>
<ul>
<li>The current state of this stopwatch.<br>
*/<br>
private State state = State.STOPPED;</li>
</ul>
<p><a class="mention" href="../../u/override.html">@Override</a><br>
public String toString() {<br>
boolean stopped = (state == State.STOPPED);<br>
return MoreObjects.toStringHelper(this).add(“running”, !stopped).add(“elapsed”, !stopped ? elapsedTime() : 0).toString();<br>
}</p>
<p>/**</p>
<ul>
<li>Sets the internal cached time to {<a class="mention" href="../../u/link.html">@link</a> Utility#currentTime()},</li>
<li>effectively making {<a class="mention" href="../../u/link.html">@link</a> Stopwatch#elapsedTime()} and</li>
<li>{<a class="mention" href="../../u/link.html">@link</a> Stopwatch#elapsed(long, TimeUnit)} return 0. If this</li>
<li>stopwatch is in a {<a class="mention" href="../../u/link.html">@link</a> State#STOPPED} state, invocation of this method</li>
<li>will change it to a {<a class="mention" href="../../u/link.html">@link</a> State#RUNNING} state.</li>
<li>
</li>
<li>
<a class="mention" href="../../u/return.html">@return</a> an instance of this stopwatch.<br>
*/<br>
public Stopwatch reset() {<br>
cachedTime = Utility.currentTime();<br>
state = State.RUNNING;<br>
return this;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Sets the internal cached time to 0 effectively putting this</li>
<li>stopwatch in a {<a class="mention" href="../../u/link.html">@link</a> State#STOPPED} state.</li>
<li>
</li>
<li>
<a class="mention" href="../../u/return.html">@return</a> an instance of this stopwatch.<br>
*/<br>
public Stopwatch stop() {<br>
state = State.STOPPED;<br>
return this;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Retrieves the elapsed time in {<a class="mention" href="../../u/code.html">@code</a> unit}. If this stopwatch is stopped</li>
<li>invocation of this method will throw an exception.</li>
<li>
</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> unit</li>
<li>
<pre><code>       the time unit to retrieve the elapsed time in.
</code></pre>
</li>
<li>
<a class="mention" href="../../u/return.html">@return</a> the elapsed time.</li>
<li>
<span class="mention">@throws</span> IllegalStateException</li>
<li>
<pre><code>        if this stopwatch has been stopped.
</code></pre>
</li>
</ul>
<p>*/<br>
public long elapsedTime(TimeUnit unit) {<br>
if (state == State.STOPPED)<br>
throw new IllegalStateException(“The timer has been stopped!”);<br>
return unit.convert((Utility.currentTime() - cachedTime), TimeUnit.MILLISECONDS);<br>
}</p>
<p>/**</p>
<ul>
<li>Retrieves the elapsed time in {<a class="mention" href="../../u/link.html">@link</a> TimeUnit#MILLISECONDS}. If this</li>
<li>stopwatch is stopped invocation of this method will throw an exception.</li>
<li>
</li>
<li>
<a class="mention" href="../../u/return.html">@return</a> the elapsed time.</li>
<li>
<span class="mention">@throws</span> IllegalStateException</li>
<li>
<pre><code>        if this stopwatch has been stopped.
</code></pre>
</li>
</ul>
<p>*/<br>
public long elapsedTime() {<br>
return elapsedTime(TimeUnit.MILLISECONDS);<br>
}</p>
<p>/**</p>
<ul>
<li>Determines if the elapsed time is greater than {<a class="mention" href="../../u/code.html">@code</a> time} in</li>
<li>{<a class="mention" href="../../u/code.html">@code</a> unit}. If this stopwatch is stopped invocation of this method will</li>
<li>automatically return {<a class="mention" href="../../u/code.html">@code</a> true}.</li>
<li>
</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> time</li>
<li>
<pre><code>       the time to check if greater than the elapsed time.
</code></pre>
</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> unit</li>
<li>
<pre><code>       the time unit to check in.
</code></pre>
</li>
<li>
<a class="mention" href="../../u/return.html">@return</a> {<a class="mention" href="../../u/code.html">@code</a> true} if the elapsed time has passed or this stopwatch has</li>
<li>
<pre><code>    been stopped, {@code false} otherwise.
</code></pre>
</li>
</ul>
<p>*/<br>
public boolean elapsed(long time, TimeUnit unit) {<br>
if (state == State.STOPPED)<br>
return true;<br>
return elapsedTime(unit) &gt;= time;<br>
}</p>
<p>/**</p>
<ul>
<li>Determines if the elapsed time is greater than {<a class="mention" href="../../u/code.html">@code</a> time} in</li>
<li>{<a class="mention" href="../../u/link.html">@link</a> TimeUnit#MILLISECONDS}. If this stopwatch is stopped invocation of</li>
<li>this method will automatically return {<a class="mention" href="../../u/code.html">@code</a> true}.</li>
<li>
</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> time</li>
<li>
<pre><code>       the time to check if greater than the elapsed time.
</code></pre>
</li>
<li>
<a class="mention" href="../../u/return.html">@return</a> {<a class="mention" href="../../u/code.html">@code</a> true} if the elapsed time has passed or this stopwatch has</li>
<li>
<pre><code>    been stopped, {@code false} otherwise.
</code></pre>
</li>
</ul>
<p>*/<br>
public boolean elapsed(long time) {<br>
return elapsed(time, TimeUnit.MILLISECONDS);<br>
}</p>
<p>/**</p>
<ul>
<li>Executes {<a class="mention" href="../../u/code.html">@code</a> action} if the elapsed time is greater than {<a class="mention" href="../../u/code.html">@code</a> time}</li>
<li>in {<a class="mention" href="../../u/code.html">@code</a> unit}. If this stopwatch is stopped invocation of this method</li>
<li>will automatically execute {<a class="mention" href="../../u/code.html">@code</a> action}.</li>
<li>
</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> time</li>
<li>
<pre><code>       the time to check if greater than the elapsed time.
</code></pre>
</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> action</li>
<li>
<pre><code>       the action to execute if satisfied.
</code></pre>
</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> unit</li>
<li>
<pre><code>       the time unit to check in.
</code></pre>
</li>
</ul>
<p>*/<br>
public void ifElapsed(long time, Consumer&lt;? super Long&gt; action, TimeUnit unit) {<br>
if (state == State.STOPPED) {<br>
action.accept((long) 0);<br>
return;<br>
}</p>
<pre><code> long elapsed = elapsedTime(unit);
 if (elapsed &gt;= time) {
     action.accept(elapsed);
 }
</code></pre>
<p>}</p>
<p>/**</p>
<ul>
<li>Executes {<a class="mention" href="../../u/code.html">@code</a> action} if the elapsed time is greater than {<a class="mention" href="../../u/code.html">@code</a> time}</li>
<li>in {<a class="mention" href="../../u/link.html">@link</a> TimeUnit#MILLISECONDS}. If this stopwatch is stopped invocation</li>
<li>of this method will automatically execute {<a class="mention" href="../../u/code.html">@code</a> action}.</li>
<li>
</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> time</li>
<li>
<pre><code>       the time to check if greater than the elapsed time.
</code></pre>
</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> action</li>
<li>
<pre><code>       the action to execute if satisfied.
</code></pre>
</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> unit</li>
<li>
<pre><code>       the time unit to check in.
</code></pre>
</li>
</ul>
<p>*/<br>
public void ifElapsed(long timePassed, Consumer&lt;? super Long&gt; action) {<br>
ifElapsed(timePassed, action, TimeUnit.MILLISECONDS);<br>
}</p>
<p>/**</p>
<ul>
<li>The enumerated type representing all possible states of this stopwatch.</li>
<li>
</li>
<li>
<span class="mention">@author</span> lare96 <a href="http://www.rune-server.org/members/lare96/" rel="nofollow noopener">http://www.rune-server.org/members/lare96/</a><br>
*/<br>
private enum State {<br>
RUNNING,<br>
STOPPED<br>
}<br>
}[/code]</li>
</ul>
</li>
</ul>
<p><span class="bbcode-u">Utility#currentTime()</span></p>
<p><code>    /**
     * Gets the current time in {@link TimeUnit#MILLISECONDS}. This method is
     * more accurate than {@link System#currentTimeMillis()} and does not rely
     * on the underlying OS.
     * 
     * @return the current time in milliseconds.
     */
    public static long currentTime() {
        return TimeUnit.MILLISECONDS.convert(System.nanoTime(), TimeUnit.NANOSECONDS);
    }</code></p>
<p><span class="bbcode-u">And a few examples of usage…</span></p>
<p>[code=java]private final Stopwatch eatingTimer = new Stopwatch();</p>
<p>private void eatFood(Food food) {<br>
if(!eatingTimer.elapsed(1800))<br>
return;<br>
food.execute();<br>
eatingTimer.reset();<br>
}[/code]</p>
<p>[code=java]private final Stopwatch logoutTimer = new Stopwatch();</p>
<p>private void logout() {<br>
logoutTimer.ifElapsed(10, l -&gt; disconnect(), TimeUnit.SECONDS);<br>
}</p>
<p>private void attack(Entity entity) {<br>
…<br>
…<br>
…<br>
logoutTimer.reset();<br>
}[/code]</p>
      </div>

      <meta itemprop='headline' content='Stopwatch class for throttling actions'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ExtremeX-Scape.html'><span itemprop='name'>ExtremeX-Scape</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-24T12:46:51Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:08:28Z' class='post-time'>
              August 4, 2016,  2:08pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Why are you negating this:</p>
<p><code>
 boolean stopped = (state == State.STOPPED);
        return MoreObjects.toStringHelper(this).add("running", !stopped).add("elapsed", !stopped ? elapsedTime() : 0).toString();</code></p>
<p>Why not just check if it is running (that state exists)? You’re just making that hard to read.</p>
<h2>Also toStringHelper makes that looks pretty ugly IMO</h2>
<p>Seems a little redundant to use this to cache your current time, what’s wrong with just using nanotime?</p>
<p><code>
    /**
     * Gets the current time in {@link TimeUnit#MILLISECONDS}. This method is
     * more accurate than {@link System#currentTimeMillis()} and does not rely
     * on the underlying OS.
     * 
     * @return the current time in milliseconds.
     */
    public static long currentTime() {
        return TimeUnit.MILLISECONDS.convert(System.nanoTime(), TimeUnit.NANOSECONDS);
    }</code></p>
      </div>

      <meta itemprop='headline' content='Stopwatch class for throttling actions'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/wildskiller.html'><span itemprop='name'>wildskiller</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-24T21:50:30Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:08:33Z' class='post-time'>
              August 4, 2016,  2:08pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“AtomicInt_, post:2, topic:548696”]Why are you negating this:</p>
<p><code>
 boolean stopped = (state == State.STOPPED);
        return MoreObjects.toStringHelper(this).add("running", !stopped).add("elapsed", !stopped ? elapsedTime() : 0).toString();</code></p>
<p>Why not just check if it is running (that state exists)? You’re just making that hard to read.</p>
<h2>Also toStringHelper makes that looks pretty ugly IMO</h2>
<p>Seems a little redundant to use this to cache your current time, what’s wrong with just using nanotime?</p>
<p><code>
    /**
     * Gets the current time in {@link TimeUnit#MILLISECONDS}. This method is
     * more accurate than {@link System#currentTimeMillis()} and does not rely
     * on the underlying OS.
     * 
     * @return the current time in milliseconds.
     */
    public static long currentTime() {
        return TimeUnit.MILLISECONDS.convert(System.nanoTime(), TimeUnit.NANOSECONDS);
    }</code>[/quote]<br>
I’m just making an assumption here, but since System.nanoTime() and System.currentTimeMillis() depend on the operating system’s current time, wouldn’t changing the OS time change that method’s time?</p>
<p>Maybe you have a value ‘A’, and the current starting time ‘B’ and you need to subtract ‘B’ from ‘A’ to get the current elapsed time. Well, if the user changes their current time backwards by 5 hours, will that affect anything?</p>
      </div>

      <meta itemprop='headline' content='Stopwatch class for throttling actions'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/bowserjr2.html'><span itemprop='name'>bowserjr2</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-25T01:09:25Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:08:35Z' class='post-time'>
              August 4, 2016,  2:08pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>wildskiller: This is supposed to be used on a server, why would you change the server clock for no reason?</p>
      </div>

      <meta itemprop='headline' content='Stopwatch class for throttling actions'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/wildskiller.html'><span itemprop='name'>wildskiller</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-25T01:31:41Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:08:35Z' class='post-time'>
              August 4, 2016,  2:08pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="4" data-topic="548696">
<div class="title">
<div class="quote-controls"></div>
 Bowser jr:</div>
<blockquote>
<p>wildskiller: This is supposed to be used on a server, why would you change the server clock for no reason?</p>
</blockquote>
</aside>
<p>There are quite a bit of single player games that use the system’s clock for time lapses. Look at CSR Racing, they use the system’s time to evaluate the gas re-charge and rewards. So, I can just change the clock and my gas will be re-filled. Having other options other than System.currentTimeMillis() or System.nanoTime() will be virtue.</p>
      </div>

      <meta itemprop='headline' content='Stopwatch class for throttling actions'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Clawz_fury.html'><span itemprop='name'>Clawz_fury</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-25T02:43:33Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:08:35Z' class='post-time'>
              August 4, 2016,  2:08pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“AtomicInt_, post:2, topic:548696”]Why are you negating this:</p>
<p><code>
 boolean stopped = (state == State.STOPPED);
        return MoreObjects.toStringHelper(this).add("running", !stopped).add("elapsed", !stopped ? elapsedTime() : 0).toString();</code></p>
<p>Why not just check if it is running (that state exists)? You’re just making that hard to read.</p>
<h2>Also toStringHelper makes that looks pretty ugly IMO</h2>
<p>Seems a little redundant to use this to cache your current time, what’s wrong with just using nanotime?</p>
<p><code>
    /**
     * Gets the current time in {@link TimeUnit#MILLISECONDS}. This method is
     * more accurate than {@link System#currentTimeMillis()} and does not rely
     * on the underlying OS.
     * 
     * @return the current time in milliseconds.
     */
    public static long currentTime() {
        return TimeUnit.MILLISECONDS.convert(System.nanoTime(), TimeUnit.NANOSECONDS);
    }</code>[/quote]<br>
Thanks for the advice Ryley <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>[quote=“wildskiller, post:3, topic:548696”]I’m just making an assumption here, but since System.nanoTime() and System.currentTimeMillis() depend on the operating system’s current time, wouldn’t changing the OS time change that method’s time?</p>
<p>Maybe you have a value ‘A’, and the current starting time ‘B’ and you need to subtract ‘B’ from ‘A’ to get the current elapsed time. Well, if the user changes their current time backwards by 5 hours, will that affect anything?[/quote]<br>
Actually <span class="bbcode-i">System.nanoTime()</span> doesn’t depend on the OS time, which is why it’s used. Proof from javadocs:</p>
<p><span class="bbcode-u">System#currentTimeMillis</span></p>
<blockquote>Returns the current time in milliseconds. Note that while the unit of time of the return value is a millisecond, [b]the granularity of the value depends on the underlying operating system[/b] and may be larger. For example, many operating systems measure time in units of tens of milliseconds.
See the description of the class Date for a discussion of slight discrepancies that may arise between "computer time" and coordinated universal time (UTC).</blockquote>
<p><span class="bbcode-u">System#nanoTime</span></p>
<blockquote>Returns the current value of the running Java Virtual Machine's high-resolution time source, in nanoseconds.
[b]This method can only be used to measure elapsed time and is not related to any other notion of system or wall-clock time.[/b] The value returned represents nanoseconds since some fixed but arbitrary origin time (perhaps in the future, so values may be negative). The same origin is used by all invocations of this method in an instance of a Java virtual machine; other virtual machine instances are likely to use a different origin.
<p>This method provides nanosecond precision, but not necessarily nanosecond resolution (that is, how frequently the value changes) - no guarantees are made except that the resolution is at least as good as that of currentTimeMillis().</p>
<p>Differences in successive calls that span greater than approximately 292 years (263 nanoseconds) will not correctly compute elapsed time due to numerical overflow.</p>
<p>The values returned by this method become meaningful only when the difference between two such values, obtained within the same instance of a Java virtual machine, is computed.</p>
<p>For example, to measure how long some code takes to execute:</p>
<p>long startTime = System.nanoTime();<br>
// … the code being measured …<br>
long estimatedTime = System.nanoTime() - startTime;<br>
To compare two nanoTime values</p>
<p>long t0 = System.nanoTime();<br>
…<br>
long t1 = System.nanoTime();<br>
one should use t1 - t0 &lt; 0, not t1 &lt; t0, because of the possibility of numerical overflow.</p>
</blockquote>
      </div>

      <meta itemprop='headline' content='Stopwatch class for throttling actions'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-25T20:49:48Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:08:41Z' class='post-time'>
              August 4, 2016,  2:08pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <blockquote>This method provides nanosecond precision, but not necessarily nanosecond resolution (that is, how frequently the value changes) - no guarantees are made except that the resolution is at least as good as that of currentTimeMillis().</blockquote>
<p>lol</p>
      </div>

      <meta itemprop='headline' content='Stopwatch class for throttling actions'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Clawz_fury.html'><span itemprop='name'>Clawz_fury</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-26T00:18:09Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:08:43Z' class='post-time'>
              August 4, 2016,  2:08pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="7" data-topic="548696">
<div class="title">
<div class="quote-controls"></div>
 t4:</div>
<blockquote>
<p>[quote]This method provides nanosecond precision, but not necessarily nanosecond resolution (that is, how frequently the value changes) - no guarantees are made except that the resolution is at least as good as that of currentTimeMillis().</p>
</blockquote>
</aside>
<p>lol[/quote]<br>
It should still be used for benchmarking over <span class="bbcode-i">System.currentTimeMillis()</span> though?</p>
      </div>

      <meta itemprop='headline' content='Stopwatch class for throttling actions'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-26T03:10:37Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:08:44Z' class='post-time'>
              August 4, 2016,  2:08pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Most benchmarks are CPU time, not wall time.</p>
      </div>

      <meta itemprop='headline' content='Stopwatch class for throttling actions'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/stopwatch-class-for-throttling-actions/548696 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:07:27 GMT -->
</html>
