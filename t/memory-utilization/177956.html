<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/memory-utilization/177956 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 16:21:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Memory utilization - General Programming - moparisthebest.com</title>
    <meta name="description" content="I was trying to profile the following piece of code using NetBeans:

 public static void main(String[] args)
{
Map&amp;lt;String, String&amp;gt; map = new HashMap&amp;lt;String, String&amp;gt;();
for( int i = 0; i &amp;lt; Integer.MAX_VALUE; ++i )
{
map.p&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="177956.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Memory utilization&#39;" href="177956.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/memory-utilization/177956" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/memory-utilization/177956" />
<meta property="og:title" content="Memory utilization" />
<meta name="twitter:title" content="Memory utilization" />
<meta property="og:description" content="I was trying to profile the following piece of code using NetBeans:  public static void main(String[] args) { Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;(); for( int i = 0; i &lt; Integer.MAX_VALUE; ++i ) { map.put(Integer.val­ueOf(i).toString(), Integer.valueOf(i).­toString()); } }   I set my max and min heap size to be 1GB. I find that the program dies after having created 4M entries (at which point the heap used is at 1GB) although the memory used by the objects as indicated by the Net..." />
<meta name="twitter:description" content="I was trying to profile the following piece of code using NetBeans:  public static void main(String[] args) { Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;(); for( int i = 0; i &lt; Integer.MAX_VALUE; ++i ) { map.put(Integer.val­ueOf(i).toString(), Integer.valueOf(i).­toString()); } }   I set my max and min heap size to be 1GB. I find that the program dies after having created 4M entries (at which point the heap used is at 1GB) although the memory used by the objects as indicated by the Net..." />
<meta property="article:published_time" content="2008-02-03T00:34:29+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="177956.html">Memory utilization</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zilchuary.html'><span itemprop='name'>zilchuary</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T00:34:29Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:20:06Z' class='post-time'>
              July 30, 2016,  7:20pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <pre><code>I was trying to profile the following piece of code using NetBeans:
</code></pre>
<p><code>public static void main(String[] args)
{
Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();
for( int i = 0; i &lt; Integer.MAX_VALUE; ++i )
{
map.put(Integer.val­ueOf(i).toString(), Integer.valueOf(i).­toString());
}
}
</code></p>
<p>I set my max and min heap size to be 1GB. I find that the program dies after having created 4M entries (at which point the heap used is at 1GB) although the memory used by the objects as indicated by the Netbeans memory profiler is the following:</p>
<p>String – 48MB<br>
char[] – 48 MB<br>
HeapCharBuffer – 45MB<br>
Integer – 19MB<br>
HashMap$Entry – 19MB</p>
<p>This totals to less than 200 MB and the rest of the objects are at 0% of the total used memory. How come the heap usage is at 1GB at this point of time? I am extremely confused. Could someone please explain what might be going on?</p>
<p>Thanks</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Yz85Racer.html'><span itemprop='name'>Yz85Racer</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T03:28:58Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:20:27Z' class='post-time'>
              July 30, 2016,  7:20pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>First, please indent your code.<br>
Second, to do these types of things in masses of the sort, pause the thread for 1 millisecond.<br>
I tried iterating through an array of size around 5000… It would constantly cause heap out of space, as it would.<br>
In the loop try something like;<br>
for(int i = 0; i &lt; Integer.MAX_VALUE; i++) {<br>
// Do the stuff<br>
Thread.sleep(1);<br>
}</p>
<p>It made a massive differance when I tried it, it was at 98-94 cpu usage, with that call of java.lang.Thread.sleep it was down to about 1…</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Interdit.html'><span itemprop='name'>Interdit</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T06:31:27Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:20:51Z' class='post-time'>
              July 30, 2016,  7:20pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Firstly, he is benchmarking, so sleeping would not do anything. The heap is not dependant on “time”.</p>
<p>I suggest you explore this for yourself. The Java Heap can be complex to understand, but luckily there are tools to both dump and analyze the heap. You can dump the Java heap with:</p>
<p><code>E:\&gt;java -Xrunhprof:format=b,file=snapshot1.hprof Bmark
Dumping Java heap ... allocation sites ... done.</code><br>
and then use HeapAnalyzer from IBM to explore the memory state.</p>
<p>I suggest you create a HashMap sizeof 500 and then see exactly how much memory it takes.<br>
<img src="http://img82.imageshack.us/img82/8991/heapng7.png" alt width="" height=""><br>
as you can see those results make absolutely 0 sense given I added 500 objects to the hashmap. yay.</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Yz85Racer.html'><span itemprop='name'>Yz85Racer</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T06:49:05Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:20:53Z' class='post-time'>
              July 30, 2016,  7:20pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Interdit, post:3, topic:177956”]Firstly, he is benchmarking, so sleeping would not do anything. The heap is not dependant on “time”.</p>
<p>I suggest you explore this for yourself. The Java Heap can be complex to understand, but luckily there are tools to both dump and analyze the heap. You can dump the Java heap with:</p>
<p><code>E:\&gt;java -Xrunhprof:format=b,file=snapshot1.hprof Bmark
Dumping Java heap ... allocation sites ... done.</code><br>
and then use HeapAnalyzer from IBM to explore the memory state.</p>
<p>I suggest you create a HashMap sizeof 500 and then see exactly how much memory it takes.<br>
<img src="http://img82.imageshack.us/img82/8991/heapng7.png" alt width="" height=""><br>
as you can see those results make absolutely 0 sense given I added 500 objects to the hashmap. yay.[/quote]<br>
Oh, should of thought he was benchmarking <img src="../../images/emoji/twitter/frowning1bce.png?v=6" title=":frowning:" class="emoji" alt=":frowning:"></p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ruler.html'><span itemprop='name'>ruler</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T08:04:25Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:21:06Z' class='post-time'>
              July 30, 2016,  7:21pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>About 70% is used it by String Objects.</p>
<p>You could get twice that if you used int wrappers known as Interger.</p>
<p>You could probably get x10 that if you used C# which supports int’s in generics.</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Exception.html'><span itemprop='name'>Exception</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T08:18:23Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:21:07Z' class='post-time'>
              July 30, 2016,  7:21pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="5" data-topic="177956">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/ruler/40/5_6bca9977b612b7aeef77ba1ec1cd67b3.png" class="avatar"> ruler:</div>
<blockquote>
<p>You could probably get x10 that if you used C# which supports int’s in generics</p>
</blockquote>
</aside>
<p>He’s not lying, I swear it’s true <img src="../../images/emoji/twitter/wink1bce.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Yz85Racer.html'><span itemprop='name'>Yz85Racer</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T08:21:50Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:21:07Z' class='post-time'>
              July 30, 2016,  7:21pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“ruler, post:5, topic:177956”]About 70% is used it by String Objects.</p>
<p>You could get twice that if you used int wrappers known as Interger.</p>
<p>You could probably get x10 that if you used C# which supports int’s in generics.[/quote]<br>
Poor ruler, always trying to justify his view on .net… Even though that may be true.</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Interdit.html'><span itemprop='name'>Interdit</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T09:11:27Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:21:11Z' class='post-time'>
              July 30, 2016,  7:21pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Well, since everybody (ruler) is flaunting memory efficiencies in languages, C++ is da king plz:</p>
<p>In 60 seconds (we create 54576054 entries, nowhere near the “maximum”, it is already eating a lot of RAM :o), we have 0.023kb per entry average for our little “map”, not much relative usage at all! (over 1.2gb total though).</p>
<p>[code]<span class="hashtag">#include</span> <br>
<span class="hashtag">#include</span> “windows.h”</p>
<p><span class="hashtag">#define</span> RUN_FOR_TICKS 60 * 1000</p>
<p>class Node<br>
{<br>
public:<br>
Node(unsigned int a, unsigned int b);<br>
Node* prev;<br>
Node* next;<br>
unsigned int i;<br>
unsigned int i2;<br>
};</p>
<p>Node::Node(unsigned int a, unsigned int b)<br>
{<br>
i = a;<br>
i2 = b;<br>
}</p>
<p>int main(char* argv)<br>
{<br>
int startTick = GetTickCount();<br>
Node *n = new Node(0, 0);<br>
for (unsigned int i = 1; ; i++)<br>
{<br>
n-&gt;next = new Node(i, i);<br>
n-&gt;next-&gt;prev = n;<br>
n = n-&gt;next;<br>
if (GetTickCount() - startTick &gt; RUN_FOR_TICKS)<br>
{<br>
printf(“Created %d entries in %d ticks\n”, i, GetTickCount() - startTick);<br>
system(“pause”);<br>
// Om, where did my ram go?<br>
while (n &amp;&amp; n-&gt;prev)<br>
{<br>
n = n-&gt;prev;<br>
delete n-&gt;next;<br>
}<br>
system(“pause”);<br>
break;<br>
}</p>
<p>}<br>
return 0;<br>
}[/code]</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BAsh_CntLgn.html'><span itemprop='name'>BAsh_CntLgn</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T12:29:03Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:21:34Z' class='post-time'>
              July 30, 2016,  7:21pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Try storing them as strings rather than integers. I think the idea is to test the limits of a language’s storage of strings rather than simple 32bit values.</p>
<p>As for java the test is a little unfair. One of the essential features is that you can point multiple times to the same object.<br>
map.put(Integer.val­ueOf(i).toString(), Integer.valueOf(i).­toString());<br>
Should be:<br>
String s = Integer.val­ueOf(i).toString();<br>
map.put(s,s);<br>
Half the space.</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zilchuary.html'><span itemprop='name'>zilchuary</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T16:44:07Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:21:46Z' class='post-time'>
              July 30, 2016,  7:21pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“BAsh(CntLgn), post:9, topic:177956”]Try storing them as strings rather than integers. I think the idea is to test the limits of a language’s storage of strings rather than simple 32bit values.</p>
<p>As for java the test is a little unfair. One of the essential features is that you can point multiple times to the same object.<br>
map.put(Integer.val­ueOf(i).toString(), Integer.valueOf(i).­toString());<br>
Should be:<br>
String s = Integer.val­ueOf(i).toString();<br>
map.put(s,s);<br>
Half the space.[/quote]</p>
<p>Okay Thanks</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zstars.html'><span itemprop='name'>zstars</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-06T19:47:44Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:26:47Z' class='post-time'>
              July 30, 2016,  7:26pm
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[NOT OPTIMIZED VERSION]<br>
In 60 seconds:<br>
14,727,313 elements</p>
<p>Memory Usage: Around 1.1 gb</p>
<pre><code class="lang-auto">#include &lt;iostream&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;boost/thread.hpp&gt;

using namespace std;

volatile bool exittest = false;

void timecontrol()
{
	Sleep(60000);
	exittest = true;
};

void test()
{

	unsigned i;
	try
	{
		char cbuf[15];
		map&lt;string, string&gt; mp;
		for(i = 0; !exittest; ++i)
		{
			itoa(i, cbuf, 10);
			mp[cbuf] = cbuf;
		}

		cout &lt;&lt; "We have completed " &lt;&lt; i &lt;&lt; " iterations." &lt;&lt; endl;
		system("pause");
	}
	catch(std::exception &amp; ex)
	{
		cout &lt;&lt; "Exception caught after " &lt;&lt; i &lt;&lt; " iterations: " &lt;&lt; ex.what() &lt;&lt; endl;
	}
}


int main()
{
	boost::thread th(&amp;timecontrol);
	test();
}</code></pre>
<p>[OPTIMIZED VERSION]<br>
(Note that it could be further optimized by making our own optimized shortstring class)</p>
<p>OWNAGE</p>
<p>In 30 seconds:<br>
12,882,867 elements</p>
<p>Memory Usage: Around 1.1 gb</p>
<p>(It gets out of memory before getting to 60 so I lowered it down lol)</p>
<pre><code class="lang-auto">#include &lt;iostream&gt;
#include &lt;boost/pool/pool.hpp&gt;
#include &lt;boost/pool/object_pool.hpp&gt;
#include &lt;boost/pool/pool_alloc.hpp&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;boost/thread.hpp&gt;

using namespace std;

volatile bool exittest = false;

void timecontrol()
{
	Sleep(30000);
	exittest = true;
};

void test()
{

	typedef basic_string&lt;char, char_traits&lt;char&gt;, boost::fast_pool_allocator&lt;char&gt; &gt; astring;
	unsigned i;
	try
	{
		char cbuf[15];
		map&lt;astring, astring, std::less&lt;astring&gt;, boost::fast_pool_allocator&lt;astring&gt; &gt; mp;
		for(i = 0; !exittest; ++i)
		{
			itoa(i, cbuf, 10);
			mp[cbuf] = cbuf;
		}

		cout &lt;&lt; "We have completed " &lt;&lt; i &lt;&lt; " iterations." &lt;&lt; endl;
		system("pause");
	}
	catch(std::exception &amp; ex)
	{
		cout &lt;&lt; "Exception caught after " &lt;&lt; i &lt;&lt; " iterations: " &lt;&lt; ex.what() &lt;&lt; endl;
	}
}


int main()
{
	boost::thread th(&amp;timecontrol);
	test();
}</code></pre>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/newbiehacker.html'><span itemprop='name'>newbiehacker</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-06T21:25:50Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:26:50Z' class='post-time'>
              July 30, 2016,  7:26pm
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Well, there are 2 ways to dramatically increase the performance of the java benchmark.<br>
Firstly, if you set the size of the hashmap before running the tests then it would not have to increase dynamically, thus the performance would be dramatically increased.  Secondly, if you created a string wrapper that only contains the things you actually need in a string (e.g. a char[]), then memory space would be decreased dramatically (and probably also string initialisation time).</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/zstars.html'><span itemprop='name'>zstars</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-06T22:17:09Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:26:52Z' class='post-time'>
              July 30, 2016,  7:26pm
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Of course we are <img src="../../images/emoji/twitter/slight_smile1bce.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
I am just following the line of the thread by posting yet another version of the same test program, in this case, as close to the original as possible, in a different language so as to compare with the original Java test.</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Exception.html'><span itemprop='name'>Exception</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-06T23:10:20Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:26:56Z' class='post-time'>
              July 30, 2016,  7:26pm
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I got to 7 million entries and was using only 500mb of heap, in C#.net 3.5, following the original code posted by zilchuary.<br>
Of course, if you actually wanted to maintain a million+ entry hashmap, a language like Haskell would be perfect, due to it’s lazy evaluation techniques.</p>
      </div>

      <meta itemprop='headline' content='Memory utilization'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/memory-utilization/177956 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 16:21:56 GMT -->
</html>
