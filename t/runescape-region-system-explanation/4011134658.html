<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/runescape-region-system-explanation/401113?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Aug 2019 21:56:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Runescape Region System Explanation - Runescape - moparisthebest.com</title>
    <meta name="description" content="*">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="4011134658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Runescape Region System Explanation&#39;" href="401113.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/runescape-region-system-explanation/401113?page=2" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/runescape-region-system-explanation/401113?page=2" />
<meta property="og:title" content="Runescape Region System Explanation" />
<meta name="twitter:title" content="Runescape Region System Explanation" />
<meta property="og:description" content="[quote=“T4_, post:20, topic:401113”][quote author=sinisoul link=topic=498172.msg3644106#msg3644106 date=1309235702]   The local position on the map is calculated this way:  int maplocalx = x - (getChunkX(formated) &lt;&lt; 3); Because the client uses the calculation to center the chunk on the 13 x 13 chunk map.  The orange is just a reminder to me that the rendering range may or may not extend to that place. Its also the threshold of sending a region update.  The 2nd map region packet can be used to s..." />
<meta name="twitter:description" content="[quote=“T4_, post:20, topic:401113”][quote author=sinisoul link=topic=498172.msg3644106#msg3644106 date=1309235702]   The local position on the map is calculated this way:  int maplocalx = x - (getChunkX(formated) &lt;&lt; 3); Because the client uses the calculation to center the chunk on the 13 x 13 chunk map.  The orange is just a reminder to me that the rendering range may or may not extend to that place. Its also the threshold of sending a region update.  The 2nd map region packet can be used to s..." />
<meta property="article:published_time" content="2011-06-28T04:51:19+00:00" />
<meta property="og:ignore_canonical" content="true" />

      <link rel="prev" href="401113.html">


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="401113.html">Runescape Region System Explanation</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sinisoul.html'><span itemprop='name'>sinisoul</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-28T04:51:19Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:44:24Z' class='post-time'>
              August 1, 2016, 12:44pm
            </time>
        <span itemprop='position'>#21</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“T4_, post:20, topic:401113”][quote author=sinisoul link=topic=498172.msg3644106#msg3644106 date=1309235702]</p>
<aside class="quote">
<blockquote>
<p>Do you know if there’s any significance to the ± 6 from the absolute location?</p>
<p>Also possibly include the “local” position. I can’t remember if there’s any special significance to it.</p>
</blockquote>
</aside>
<p>The local position on the map is calculated this way:</p>
<pre><code class="lang-auto">int maplocalx = x - (getChunkX(formated) &lt;&lt; 3);</code></pre>
<p>Because the client uses the calculation to center the chunk on the 13 x 13 chunk map.<br>
The orange is just a reminder to me that the rendering range may or may not extend to that place. Its also the threshold of sending a region update.</p>
<p>The 2nd map region packet can be used to send clipping flags for objects that have been sent to the client so that the client can recognize the object.</p>
<p><span class="mention">@T4_</span></p>
<p>Yeah it would, credits are always nice though <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
[/quote]<br>
The post on the wiki would say contributed by ACCOUNT_NAMEHERE?[/quote]</p>
<p>Fair nuff, <span class="mention">@Davidii</span></p>
<p>Cause I figured out how regions load, I am sure not a lot of people knew that.</p>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-28T04:53:19Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:44:25Z' class='post-time'>
              August 1, 2016, 12:44pm
            </time>
        <span itemprop='position'>#22</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“sinisoul, post:21, topic:401113”][quote author=T4_ link=topic=498172.msg3644112#msg3644112 date=1309236488]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>Do you know if there’s any significance to the ± 6 from the absolute location?</p>
<p>Also possibly include the “local” position. I can’t remember if there’s any special significance to it.</p>
</blockquote>
</aside>
<p>The local position on the map is calculated this way:</p>
<pre><code class="lang-auto">int maplocalx = x - (getChunkX(formated) &lt;&lt; 3);</code></pre>
<p>Because the client uses the calculation to center the chunk on the 13 x 13 chunk map.<br>
The orange is just a reminder to me that the rendering range may or may not extend to that place. Its also the threshold of sending a region update.</p>
<p>The 2nd map region packet can be used to send clipping flags for objects that have been sent to the client so that the client can recognize the object.</p>
<p><span class="mention">@T4_</span></p>
<p>Yeah it would, credits are always nice though <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</blockquote>
</aside>
<p>The post on the wiki would say contributed by ACCOUNT_NAMEHERE?<br>
[/quote]</p>
<p>Fair nuff, <span class="mention">@Davidii</span></p>
<p>Cause I figured out how regions load, I am sure not a lot of people knew that.[/quote]<br>
As an example:</p>
<blockquote>(diff | hist) . . N Category:Archive Format‎; 18:19 . . (+5,303) . . [b]Admin[/b] (Talk | contribs | block) (Created page with "== Introduction == Since 194 all way up until 377, all the files in cache 0 have an archive-like format which contains a collection of named files (e.g. '''BADENC.TXT''' is a fi...")</blockquote>
<p>A wiki keeps a history of all edits done to a page and who contributed what and how much.</p>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/davidi2.html'><span itemprop='name'>davidi2</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-28T05:05:39Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:44:25Z' class='post-time'>
              August 1, 2016, 12:44pm
            </time>
        <span itemprop='position'>#23</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <ul>
<li>you can still keep your credits on the pictures of course</li>
</ul>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sinisoul.html'><span itemprop='name'>sinisoul</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-28T05:13:11Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:44:25Z' class='post-time'>
              August 1, 2016, 12:44pm
            </time>
        <span itemprop='position'>#24</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote quote-modified" data-post="23" data-topic="401113">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/davidi2/40/2579_1.png" class="avatar"> Davidi2:</div>
<blockquote>
<p>+ you can still keep your credits on the pictures of course</p>
</blockquote>
</aside>
<p>Here is my region system if anyone was interested on how to do one, you just get the ‘Map’ cause the rest was fairly hard to do and contains some trade secrets:</p>
<pre><code class="lang-auto">package net.forge.content.entities.player;

import net.forge.content.entities.Player;
import net.forge.content.region.Region;
import net.forge.content.region.RegionChunk;
import net.forge.content.region.RegionManager;

/**
 * RuneForge | 317
 * Map.java
 * @version 1.0.0
 * @author SiniSoul (SiniSoul@live.com)
 */
public final class Map {
    
    /**
     * The owner of this map.
     */
    private Player player;
    
    private int lastchunkx = 0,
                lastchunky = 0;
    
    /**
     * The maps chunks.
     */
    private RegionChunk[][][] chunks
                            = new RegionChunk[4][13][13];
    
    /**
     * 
     * @param h The height of the chunk to fetch.
     * @param x The chunks X coordinate.
     * @param y The chunks Y coordinate.
     * @return 
     */
    private RegionChunk fetch(int h, int x, int y) {
        int chunkx = lastchunkx + (x - 6);
        int chunky = lastchunky + (y - 6);
        int x_ = chunkx - (chunkx &amp; ~0x7);
        int y_ = chunky - (chunky &amp; ~0x7);
        Region region = RegionManager.get(chunkx &gt;&gt; 3, chunky &gt;&gt; 3);
        return region.get(h, x_, y_);
    }
    
    /**
     * Re-populates the chunks.
     */
    public void populate() {
        /* Update the last region x */
        lastchunkx = player.getLocation().calculateChunkX(false);
        lastchunky = player.getLocation().calculateChunkY(false);
        for(int x = 0; x &lt; 13; x++) {
            for(int y = 0; y &lt; 13; y++) {
                for(int h = 0; h &lt; 4; h++)
                    chunks[h][x][y] = fetch(h, x, y);
            }
        }
    }
    
    /**
     * Rebuilds the map.
     */
    public void rebuild() {
        /* int regionbasex = (player.getRegion().regionHash() &gt;&gt; 10) &amp; ~0x3F;
        regionbasex += player.getChunk().chunkHash() &amp; 0x7;
        int regionx = regionbasex &gt;&gt; 3;*/
        int deltaX = player.getLocation().calculateChunkX(true) - lastchunkx; 
        int deltaY = player.getLocation().calculateChunkY(true) - lastchunky;  
        lastchunkx += deltaX;
        lastchunky += deltaY;
        /* Check if a total map repopulation is needed. */
        if(Math.abs(deltaX) &gt; 6 || Math.abs(deltaY) &gt; 6)
            populate();
        else {
            for(int h = 0; h &lt; 4; h++)
                for(int x = 0; x &lt; 13; x++)
                    for(int y = 0; y &lt; 13; y++)
                        if(x - deltaX &gt;= 13 || x - deltaX &lt; 0 || y - deltaY &gt;= 13 || y - deltaY &lt; 0)
                            chunks[h][x][y] = fetch(h, x, y);
                        else
                            chunks[h][x][y] = chunks[h][x - deltaX][y - deltaY];      
        }      
    }
    
    public Map(Player player) {
        this.player = player;
        populate();
    }
}
</code></pre>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-28T05:19:06Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:44:25Z' class='post-time'>
              August 1, 2016, 12:44pm
            </time>
        <span itemprop='position'>#25</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“sinisoul, post:24, topic:401113”][quote author=Davidi2 link=topic=498172.msg3644121#msg3644121 date=1309237539]</p>
<ul>
<li>you can still keep your credits on the pictures of course<br>
[/quote]</li>
</ul>
<p>Here is my region system if anyone was interested on how to do one, you just get the ‘Map’ cause the rest was fairly hard to do and contains some trade secrets:</p>
<p>[code]<br>
package net.forge.content.entities.player;</p>
<p>import net.forge.content.entities.Player;<br>
import net.forge.content.region.Region;<br>
import net.forge.content.region.RegionChunk;<br>
import net.forge.content.region.RegionManager;</p>
<p>/**</p>
<ul>
<li>
<p>RuneForge | 317</p>
</li>
<li>
<p>Map.java</p>
</li>
<li>
<p><a class="mention" href="../../u/version.html">@version</a> 1.0.0</p>
</li>
<li>
<p><span class="mention">@author</span> SiniSoul (<a href="mailto:SiniSoul@live.com">SiniSoul@live.com</a>)<br>
*/<br>
public final class Map {</p>
<p>/**</p>
<ul>
<li>The owner of this map.<br>
*/<br>
private Player player;</li>
</ul>
<p>private int lastchunkx = 0,<br>
lastchunky = 0;</p>
<p>/**</p>
<ul>
<li>The maps chunks.<br>
*/<br>
private RegionChunk[][][] chunks<br>
= new RegionChunk[4][13][13];</li>
</ul>
<p>/**<br>
*</p>
<ul>
<li>
<a class="mention" href="../../u/param.html">@param</a> h The height of the chunk to fetch.</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> x The chunks X coordinate.</li>
<li>
<a class="mention" href="../../u/param.html">@param</a> y The chunks Y coordinate.</li>
<li>
<a class="mention" href="../../u/return.html">@return</a><br>
*/<br>
private RegionChunk fetch(int h, int x, int y) {<br>
int chunkx = lastchunkx + (x - 6);<br>
int chunky = lastchunky + (y - 6);<br>
int x_ = chunkx - (chunkx &amp; ~0x7);<br>
int y_ = chunky - (chunky &amp; ~0x7);<br>
Region region = RegionManager.get(chunkx &gt;&gt; 3, chunky &gt;&gt; 3);<br>
return region.get(h, x_, y_);<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Re-populates the chunks.<br>
<em>/<br>
public void populate() {<br>
/</em> Update the last region x */<br>
lastchunkx = player.getLocation().calculateChunkX(false);<br>
lastchunky = player.getLocation().calculateChunkY(false);<br>
for(int x = 0; x &lt; 13; x++) {<br>
for(int y = 0; y &lt; 13; y++) {<br>
for(int h = 0; h &lt; 4; h++)<br>
chunks[h][x][y] = fetch(h, x, y);<br>
}<br>
}<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Rebuilds the map.<br>
<em>/<br>
public void rebuild() {<br>
/</em> int regionbasex = (player.getRegion().regionHash() &gt;&gt; 10) &amp; ~0x3F;<br>
regionbasex += player.getChunk().chunkHash() &amp; 0x7;<br>
int regionx = regionbasex &gt;&gt; 3;<em>/<br>
int deltaX = player.getLocation().calculateChunkX(true) - lastchunkx;<br>
int deltaY = player.getLocation().calculateChunkY(true) - lastchunky;<br>
lastchunkx += deltaX;<br>
lastchunky += deltaY;<br>
/</em> Check if a total map repopulation is needed. */<br>
if(Math.abs(deltaX) &gt; 6 || Math.abs(deltaY) &gt; 6)<br>
populate();<br>
else {<br>
for(int h = 0; h &lt; 4; h++)<br>
for(int x = 0; x &lt; 13; x++)<br>
for(int y = 0; y &lt; 13; y++)<br>
if(x - deltaX &gt;= 13 || x - deltaX &lt; 0 || y - deltaY &gt;= 13 || y - deltaY &lt; 0)<br>
chunks[h][x][y] = fetch(h, x, y);<br>
else<br>
chunks[h][x][y] = chunks[h][x - deltaX][y - deltaY];<br>
}<br>
}</li>
</ul>
<p>public Map(Player player) {<br>
this.player = player;<br>
populate();<br>
}<br>
}</p>
</li>
</ul>
<p>[/code][/quote]<br>
wiki’s support code tags too and soon syntax highlighting!</p>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sinisoul.html'><span itemprop='name'>sinisoul</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-28T05:24:03Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:44:26Z' class='post-time'>
              August 1, 2016, 12:44pm
            </time>
        <span itemprop='position'>#26</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“T4_, post:25, topic:401113”][quote author=sinisoul link=topic=498172.msg3644126#msg3644126 date=1309237991]</p>
<aside class="quote">
<blockquote>
<ul>
<li>you can still keep your credits on the pictures of course</li>
</ul>
</blockquote>
</aside>
<p>Here is my region system if anyone was interested on how to do one, you just get the ‘Map’ cause the rest was fairly hard to do and contains some trade secrets:</p>
<pre><code class="lang-auto">package net.forge.content.entities.player;

import net.forge.content.entities.Player;
import net.forge.content.region.Region;
import net.forge.content.region.RegionChunk;
import net.forge.content.region.RegionManager;

/**
 * RuneForge | 317
 * Map.java
 * @version 1.0.0
 * @author SiniSoul (SiniSoul@live.com)
 */
public final class Map {
    
    /**
     * The owner of this map.
     */
    private Player player;
    
    private int lastchunkx = 0,
                lastchunky = 0;
    
    /**
     * The maps chunks.
     */
    private RegionChunk[][][] chunks
                            = new RegionChunk[4][13][13];
    
    /**
     * 
     * @param h The height of the chunk to fetch.
     * @param x The chunks X coordinate.
     * @param y The chunks Y coordinate.
     * @return 
     */
    private RegionChunk fetch(int h, int x, int y) {
        int chunkx = lastchunkx + (x - 6);
        int chunky = lastchunky + (y - 6);
        int x_ = chunkx - (chunkx &amp; ~0x7);
        int y_ = chunky - (chunky &amp; ~0x7);
        Region region = RegionManager.get(chunkx &gt;&gt; 3, chunky &gt;&gt; 3);
        return region.get(h, x_, y_);
    }
    
    /**
     * Re-populates the chunks.
     */
    public void populate() {
        /* Update the last region x */
        lastchunkx = player.getLocation().calculateChunkX(false);
        lastchunky = player.getLocation().calculateChunkY(false);
        for(int x = 0; x &lt; 13; x++) {
            for(int y = 0; y &lt; 13; y++) {
                for(int h = 0; h &lt; 4; h++)
                    chunks[h][x][y] = fetch(h, x, y);
            }
        }
    }
    
    /**
     * Rebuilds the map.
     */
    public void rebuild() {
        /* int regionbasex = (player.getRegion().regionHash() &gt;&gt; 10) &amp; ~0x3F;
        regionbasex += player.getChunk().chunkHash() &amp; 0x7;
        int regionx = regionbasex &gt;&gt; 3;*/
        int deltaX = player.getLocation().calculateChunkX(true) - lastchunkx; 
        int deltaY = player.getLocation().calculateChunkY(true) - lastchunky;  
        lastchunkx += deltaX;
        lastchunky += deltaY;
        /* Check if a total map repopulation is needed. */
        if(Math.abs(deltaX) &gt; 6 || Math.abs(deltaY) &gt; 6)
            populate();
        else {
            for(int h = 0; h &lt; 4; h++)
                for(int x = 0; x &lt; 13; x++)
                    for(int y = 0; y &lt; 13; y++)
                        if(x - deltaX &gt;= 13 || x - deltaX &lt; 0 || y - deltaY &gt;= 13 || y - deltaY &lt; 0)
                            chunks[h][x][y] = fetch(h, x, y);
                        else
                            chunks[h][x][y] = chunks[h][x - deltaX][y - deltaY];      
        }      
    }
    
    public Map(Player player) {
        this.player = player;
        populate();
    }
}
</code></pre>
<p>[/quote]<br>
wiki’s support code tags too and soon syntax highlighting![/quote]</p>
<p>Uh, if someone wants to post that then fine. I wasn’t going to because I don’t really think its wiki material.</p>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-28T17:47:41Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:44:53Z' class='post-time'>
              August 1, 2016, 12:44pm
            </time>
        <span itemprop='position'>#27</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“sinisoul, post:26, topic:401113”][quote author=T4_ link=topic=498172.msg3644131#msg3644131 date=1309238346]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<ul>
<li>you can still keep your credits on the pictures of course</li>
</ul>
</blockquote>
</aside>
<p>Here is my region system if anyone was interested on how to do one, you just get the ‘Map’ cause the rest was fairly hard to do and contains some trade secrets:</p>
<pre><code class="lang-auto">package net.forge.content.entities.player;

import net.forge.content.entities.Player;
import net.forge.content.region.Region;
import net.forge.content.region.RegionChunk;
import net.forge.content.region.RegionManager;

/**
 * RuneForge | 317
 * Map.java
 * @version 1.0.0
 * @author SiniSoul (SiniSoul@live.com)
 */
public final class Map {
    
    /**
     * The owner of this map.
     */
    private Player player;
    
    private int lastchunkx = 0,
                lastchunky = 0;
    
    /**
     * The maps chunks.
     */
    private RegionChunk[][][] chunks
                            = new RegionChunk[4][13][13];
    
    /**
     * 
     * @param h The height of the chunk to fetch.
     * @param x The chunks X coordinate.
     * @param y The chunks Y coordinate.
     * @return 
     */
    private RegionChunk fetch(int h, int x, int y) {
        int chunkx = lastchunkx + (x - 6);
        int chunky = lastchunky + (y - 6);
        int x_ = chunkx - (chunkx &amp; ~0x7);
        int y_ = chunky - (chunky &amp; ~0x7);
        Region region = RegionManager.get(chunkx &gt;&gt; 3, chunky &gt;&gt; 3);
        return region.get(h, x_, y_);
    }
    
    /**
     * Re-populates the chunks.
     */
    public void populate() {
        /* Update the last region x */
        lastchunkx = player.getLocation().calculateChunkX(false);
        lastchunky = player.getLocation().calculateChunkY(false);
        for(int x = 0; x &lt; 13; x++) {
            for(int y = 0; y &lt; 13; y++) {
                for(int h = 0; h &lt; 4; h++)
                    chunks[h][x][y] = fetch(h, x, y);
            }
        }
    }
    
    /**
     * Rebuilds the map.
     */
    public void rebuild() {
        /* int regionbasex = (player.getRegion().regionHash() &gt;&gt; 10) &amp; ~0x3F;
        regionbasex += player.getChunk().chunkHash() &amp; 0x7;
        int regionx = regionbasex &gt;&gt; 3;*/
        int deltaX = player.getLocation().calculateChunkX(true) - lastchunkx; 
        int deltaY = player.getLocation().calculateChunkY(true) - lastchunky;  
        lastchunkx += deltaX;
        lastchunky += deltaY;
        /* Check if a total map repopulation is needed. */
        if(Math.abs(deltaX) &gt; 6 || Math.abs(deltaY) &gt; 6)
            populate();
        else {
            for(int h = 0; h &lt; 4; h++)
                for(int x = 0; x &lt; 13; x++)
                    for(int y = 0; y &lt; 13; y++)
                        if(x - deltaX &gt;= 13 || x - deltaX &lt; 0 || y - deltaY &gt;= 13 || y - deltaY &lt; 0)
                            chunks[h][x][y] = fetch(h, x, y);
                        else
                            chunks[h][x][y] = chunks[h][x - deltaX][y - deltaY];      
        }      
    }
    
    public Map(Player player) {
        this.player = player;
        populate();
    }
}
</code></pre>
</blockquote>
</aside>
<p>wiki’s support code tags too and soon syntax highlighting!<br>
[/quote]</p>
<p>Uh, if someone wants to post that then fine. I wasn’t going to because I don’t really think its wiki material.[/quote]<br>
It does belong, it has to do with game mechanics.</p>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sinisoul.html'><span itemprop='name'>sinisoul</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-06-28T18:11:04Z'>
            <time itemprop='dateModified' datetime='2016-08-01T12:44:54Z' class='post-time'>
              August 1, 2016, 12:44pm
            </time>
        <span itemprop='position'>#28</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“T4_, post:27, topic:401113”][quote author=sinisoul link=topic=498172.msg3644133#msg3644133 date=1309238643]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<ul>
<li>you can still keep your credits on the pictures of course</li>
</ul>
</blockquote>
</aside>
<p>Here is my region system if anyone was interested on how to do one, you just get the ‘Map’ cause the rest was fairly hard to do and contains some trade secrets:</p>
<pre><code class="lang-auto">package net.forge.content.entities.player;

import net.forge.content.entities.Player;
import net.forge.content.region.Region;
import net.forge.content.region.RegionChunk;
import net.forge.content.region.RegionManager;

/**
 * RuneForge | 317
 * Map.java
 * @version 1.0.0
 * @author SiniSoul (SiniSoul@live.com)
 */
public final class Map {
    
    /**
     * The owner of this map.
     */
    private Player player;
    
    private int lastchunkx = 0,
                lastchunky = 0;
    
    /**
     * The maps chunks.
     */
    private RegionChunk[][][] chunks
                            = new RegionChunk[4][13][13];
    
    /**
     * 
     * @param h The height of the chunk to fetch.
     * @param x The chunks X coordinate.
     * @param y The chunks Y coordinate.
     * @return 
     */
    private RegionChunk fetch(int h, int x, int y) {
        int chunkx = lastchunkx + (x - 6);
        int chunky = lastchunky + (y - 6);
        int x_ = chunkx - (chunkx &amp; ~0x7);
        int y_ = chunky - (chunky &amp; ~0x7);
        Region region = RegionManager.get(chunkx &gt;&gt; 3, chunky &gt;&gt; 3);
        return region.get(h, x_, y_);
    }
    
    /**
     * Re-populates the chunks.
     */
    public void populate() {
        /* Update the last region x */
        lastchunkx = player.getLocation().calculateChunkX(false);
        lastchunky = player.getLocation().calculateChunkY(false);
        for(int x = 0; x &lt; 13; x++) {
            for(int y = 0; y &lt; 13; y++) {
                for(int h = 0; h &lt; 4; h++)
                    chunks[h][x][y] = fetch(h, x, y);
            }
        }
    }
    
    /**
     * Rebuilds the map.
     */
    public void rebuild() {
        /* int regionbasex = (player.getRegion().regionHash() &gt;&gt; 10) &amp; ~0x3F;
        regionbasex += player.getChunk().chunkHash() &amp; 0x7;
        int regionx = regionbasex &gt;&gt; 3;*/
        int deltaX = player.getLocation().calculateChunkX(true) - lastchunkx; 
        int deltaY = player.getLocation().calculateChunkY(true) - lastchunky;  
        lastchunkx += deltaX;
        lastchunky += deltaY;
        /* Check if a total map repopulation is needed. */
        if(Math.abs(deltaX) &gt; 6 || Math.abs(deltaY) &gt; 6)
            populate();
        else {
            for(int h = 0; h &lt; 4; h++)
                for(int x = 0; x &lt; 13; x++)
                    for(int y = 0; y &lt; 13; y++)
                        if(x - deltaX &gt;= 13 || x - deltaX &lt; 0 || y - deltaY &gt;= 13 || y - deltaY &lt; 0)
                            chunks[h][x][y] = fetch(h, x, y);
                        else
                            chunks[h][x][y] = chunks[h][x - deltaX][y - deltaY];      
        }      
    }
    
    public Map(Player player) {
        this.player = player;
        populate();
    }
}
</code></pre>
</blockquote>
</aside>
<p>wiki’s support code tags too and soon syntax highlighting!</p>
</blockquote>
</aside>
<p>Uh, if someone wants to post that then fine. I wasn’t going to because I don’t really think its wiki material.<br>
[/quote]<br>
It does belong, it has to do with game mechanics.[/quote]</p>
<p>If I have time, I will post it on the Wiki. Atm I need to finish some bits of my server so not right now &gt;_&lt;</p>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/davidi2.html'><span itemprop='name'>davidi2</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-08-13T20:26:06Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:03:19Z' class='post-time'>
              August 1, 2016,  2:03pm
            </time>
        <span itemprop='position'>#29</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I find it funny. While I was reading this the first time, I was like ‘this is awesome, too bad I’ll probably never use it’</p>
<p>And now today I used it as reference when I was fixing an object placement issue in my server <img src="../../images/emoji/twitter/stuck_out_tongueae52.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/m1lkman.html'><span itemprop='name'>m1lkman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-08-13T20:46:30Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:03:21Z' class='post-time'>
              August 1, 2016,  2:03pm
            </time>
        <span itemprop='position'>#30</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This is over my head.  <img src="../../images/emoji/twitter/frowningae52.png?v=5" title=":frowning:" class="emoji" alt=":frowning:"></p>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Native1.html'><span itemprop='name'>Native1</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-08-14T19:43:22Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:05:03Z' class='post-time'>
              August 1, 2016,  2:05pm
            </time>
        <span itemprop='position'>#31</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Good tutorial, didn’t knew this.</p>
      </div>

      <meta itemprop='headline' content='Runescape Region System Explanation'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
      <span itemprop='name'><a rel="prev" itemprop="url" href="401113.html">← previous page</a></span>
  </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/runescape-region-system-explanation/401113?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Aug 2019 21:56:09 GMT -->
</html>
