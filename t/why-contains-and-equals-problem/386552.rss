<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Why? (contains and equals problem)</title>
    <link>https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552</link>
    <description>The Javadocs say:
&lt;blockquote&gt;returns true if and only if this collection contains at least one element e such that (o==null ? e==null : o.equals(e))&lt;/blockquote&gt;

But apparently not, because the .equals() method is never even called on the first two calls to .contains():

[code=java5]
import java.util.ArrayList;
import java.util.List;

public class ALTest {

    public static void main(String[] args) throws Exception {
        final List&lt;Object&gt; downloadItems = new ArrayList&lt;Object&gt;(5);
        int uid = 0;
        downloadItems.add(new ALTest(uid));
        System.out.println(&quot;downloads size: &quot;+downloadItems.size());
        System.out.println(&quot;downloads contains(uid): &quot;+downloadItems.contains(uid));
        System.out.println(&quot;downloads contains(Integer(uid)): &quot;+downloadItems.contains(new Integer(uid)));
        System.out.println(&quot;downloads contains(ALTest): &quot;+downloadItems.contains(new ALTest(uid)));
    }

    private int uid;

    public ALTest(int uid) {
        this.uid = uid;
    }

    @Override
    public boolean equals(Object other) {
        System.out.println(&quot;ALTest equals: &quot; + other);
        return ((other instanceof ALTest) &amp;&amp; ((ALTest) other).uid == this.uid) ||
                ((other instanceof Integer) &amp;&amp; other.equals(this.uid));
    }
}
[/code]

Output:
[code]
downloads size: 1
downloads contains(uid): false
downloads contains(Integer(uid)): false
ALTest equals: org.moparscape.res.ALTest@7b11a3ac
downloads contains(ALTest): true
[/code]

It&#39;s really late I think this code should work, can anyone please tell me why it is not?  And hopefully how to get around it?</description>
    
    <lastBuildDate>Wed, 23 Mar 2011 22:53:41 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Why? (contains and equals problem)</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="8" data-topic="386552">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/newbiehacker/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> newbiehacker:</div>
<blockquote>
<p>Your equals method breaks the equality contract ALTest.equals(Integer) != Integer.equals(ALTest), revise.</p>
</blockquote>
</aside>
<p>I can’t fix Integer without extending it, and then autoboxing doesn’t work and I might as well not even do it this way.</p>
<p>Anyhow, I’m not even doing it like this anymore, but I appreciate the help. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/9</link>
        <pubDate>Wed, 23 Mar 2011 22:53:41 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-386552-9</guid>
        <source url="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552.rss">Why? (contains and equals problem)</source>
      </item>
      <item>
        <title>Why? (contains and equals problem)</title>
        <dc:creator><![CDATA[@newbiehacker newbiehacker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/newbiehacker">@newbiehacker</a> wrote:</p>
          <blockquote>
              <p>Your equals method breaks the equality contract ALTest.equals(Integer) != Integer.equals(ALTest), revise.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/8</link>
        <pubDate>Wed, 23 Mar 2011 22:31:26 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-386552-8</guid>
        <source url="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552.rss">Why? (contains and equals problem)</source>
      </item>
      <item>
        <title>Why? (contains and equals problem)</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>[quote=“Fat Cookies, post:4, topic:386552”]Although it’s slightly unrelated I would suggest making sure you are reading 1.6 Javadocs. Yesterday I googled a class, clicked on the first link and it turned out to be java 1.4.2 doc so I was puzzled for a while why a certain method didn’t exist!</p>
<p>It doesn’t affect this problem in particular, but it’s just a word of thought.[/quote]</p>
<p>I try not to, since I am programming for 1.5. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/7</link>
        <pubDate>Thu, 17 Mar 2011 02:20:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-386552-7</guid>
        <source url="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552.rss">Why? (contains and equals problem)</source>
      </item>
      <item>
        <title>Why? (contains and equals problem)</title>
        <dc:creator><![CDATA[@The_Un-Named The Un-Named]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/the_un-named">@The_Un-Named</a> wrote:</p>
          <blockquote>
              <p>[quote=“Greeny, post:5, topic:386552”][quote author=Moparisthebest link=topic=482310.msg3532480#msg3532480 date=1300291881]<br>
Aha, good call.  And that’s why you shouldn’t program when you are very tired. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Thanks.<br>
[/quote]</p>
<p>Or just drink a half bottle of whisky to neutralise the effects of tiredness.[/quote]</p>
<p><em>insert xkcd winme image here</em></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/6</link>
        <pubDate>Wed, 16 Mar 2011 18:44:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-386552-6</guid>
        <source url="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552.rss">Why? (contains and equals problem)</source>
      </item>
      <item>
        <title>Why? (contains and equals problem)</title>
        <dc:creator><![CDATA[@Greeny Greeny]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/greeny">@Greeny</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:3, topic:386552”]Aha, good call.  And that’s why you shouldn’t program when you are very tired. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Thanks.[/quote]</p>
<p>Or just drink a half bottle of whisky to neutralise the effects of tiredness.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/5</link>
        <pubDate>Wed, 16 Mar 2011 17:45:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-386552-5</guid>
        <source url="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552.rss">Why? (contains and equals problem)</source>
      </item>
      <item>
        <title>Why? (contains and equals problem)</title>
        <dc:creator><![CDATA[@Fat_Cookies Fat Cookies]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/fat_cookies">@Fat_Cookies</a> wrote:</p>
          <blockquote>
              <p>Although it’s slightly unrelated I would suggest making sure you are reading 1.6 Javadocs. Yesterday I googled a class, clicked on the first link and it turned out to be java 1.4.2 doc so I was puzzled for a while why a certain method didn’t exist!</p>
<p>It doesn’t affect this problem in particular, but it’s just a word of thought.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/4</link>
        <pubDate>Wed, 16 Mar 2011 16:31:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-386552-4</guid>
        <source url="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552.rss">Why? (contains and equals problem)</source>
      </item>
      <item>
        <title>Why? (contains and equals problem)</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>Aha, good call.  And that’s why you shouldn’t program when you are very tired. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Thanks.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/3</link>
        <pubDate>Wed, 16 Mar 2011 16:11:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-386552-3</guid>
        <source url="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552.rss">Why? (contains and equals problem)</source>
      </item>
      <item>
        <title>Why? (contains and equals problem)</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>reread the documentation, it calls equals() on the object that you pass, not the object in the collection</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/2</link>
        <pubDate>Wed, 16 Mar 2011 08:49:29 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-386552-2</guid>
        <source url="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552.rss">Why? (contains and equals problem)</source>
      </item>
      <item>
        <title>Why? (contains and equals problem)</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>The Javadocs say:</p>
<blockquote>returns true if and only if this collection contains at least one element e such that (o==null ? e==null : o.equals(e))</blockquote>
<p>But apparently not, because the .equals() method is never even called on the first two calls to .contains():</p>
<pre><code class="lang-auto">import java.util.ArrayList;
import java.util.List;

public class ALTest {

    public static void main(String[] args) throws Exception {
        final List&lt;Object&gt; downloadItems = new ArrayList&lt;Object&gt;(5);
        int uid = 0;
        downloadItems.add(new ALTest(uid));
        System.out.println("downloads size: "+downloadItems.size());
        System.out.println("downloads contains(uid): "+downloadItems.contains(uid));
        System.out.println("downloads contains(Integer(uid)): "+downloadItems.contains(new Integer(uid)));
        System.out.println("downloads contains(ALTest): "+downloadItems.contains(new ALTest(uid)));
    }

    private int uid;

    public ALTest(int uid) {
        this.uid = uid;
    }

    @Override
    public boolean equals(Object other) {
        System.out.println("ALTest equals: " + other);
        return ((other instanceof ALTest) &amp;&amp; ((ALTest) other).uid == this.uid) ||
                ((other instanceof Integer) &amp;&amp; other.equals(this.uid));
    }
}</code></pre>
<p>Output:</p>
<pre><code class="lang-auto">downloads size: 1
downloads contains(uid): false
downloads contains(Integer(uid)): false
ALTest equals: org.moparscape.res.ALTest@7b11a3ac
downloads contains(ALTest): true</code></pre>
<p>It’s really late I think this code should work, can anyone please tell me why it is not?  And hopefully how to get around it?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552/1</link>
        <pubDate>Wed, 16 Mar 2011 07:20:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-386552-1</guid>
        <source url="https://forum.moparisthebest.com/t/why-contains-and-equals-problem/386552.rss">Why? (contains and equals problem)</source>
      </item>
  </channel>
</rss>
