<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/using-tcp-in-java-tcp-vs-udp-in-java/172227 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 16:33:30 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Using TCP in Java &amp; TCP vs. UDP in Java - General Programming - moparisthebest.com</title>
    <meta name="description" content="I am having a load of problems with all my server-client based applications, and I can&amp;#39;t seem to figure out why. 

On one side, I can have a perfectly working system (or so it seems), but then when I add in the need for &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="172227.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Using TCP in Java &amp; TCP vs. UDP in Java&#39;" href="172227.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/using-tcp-in-java-tcp-vs-udp-in-java/172227" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/using-tcp-in-java-tcp-vs-udp-in-java/172227" />
<meta property="og:title" content="Using TCP in Java &amp; TCP vs. UDP in Java" />
<meta name="twitter:title" content="Using TCP in Java &amp; TCP vs. UDP in Java" />
<meta property="og:description" content="I am having a load of problems with all my server-client based applications, and I can’t seem to figure out why.  On one side, I can have a perfectly working system (or so it seems), but then when I add in the need for many packets in a shorter time frame, I get huge lag issues and slow receiving. I know that TCP packets are quite a load larger than UDP mainly because they have large headers that make sure the packets stay in order and do not become truncated or malformed in some way. But is the..." />
<meta name="twitter:description" content="I am having a load of problems with all my server-client based applications, and I can’t seem to figure out why.  On one side, I can have a perfectly working system (or so it seems), but then when I add in the need for many packets in a shorter time frame, I get huge lag issues and slow receiving. I know that TCP packets are quite a load larger than UDP mainly because they have large headers that make sure the packets stay in order and do not become truncated or malformed in some way. But is the..." />
<meta property="article:published_time" content="2008-01-10T05:28:53+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="172227.html">Using TCP in Java &amp; TCP vs. UDP in Java</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mod_taharok.html'><span itemprop='name'>mod_taharok</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-01-10T05:28:53Z'>
            <time itemprop='dateModified' datetime='2016-07-30T18:40:46Z' class='post-time'>
              July 30, 2016,  6:40pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I am having a load of problems with all my server-client based applications, and I can’t seem to figure out why.</p>
<p>On one side, I can have a perfectly working system (or so it seems), but then when I add in the need for many packets in a shorter time frame, I get huge lag issues and slow receiving. I know that TCP packets are quite a load larger than UDP mainly because they have large headers that make sure the packets stay in order and do not become truncated or malformed in some way. But is the large header actually work the long wait, or am I just using TCP wrong? If either or, could someone please provide a way to use UDP and/or TCP (I have used DatagramPackets and DatagramSockets in the past, but I personally do not like them as much. =) Thanks.</p>
      </div>

      <meta itemprop='headline' content='Using TCP in Java &amp; TCP vs. UDP in Java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pwnd.html'><span itemprop='name'>Pwnd</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-01-10T06:18:29Z'>
            <time itemprop='dateModified' datetime='2016-07-30T18:40:52Z' class='post-time'>
              July 30, 2016,  6:40pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>There’s a reason why they have a header.</p>
      </div>

      <meta itemprop='headline' content='Using TCP in Java &amp; TCP vs. UDP in Java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mod_taharok.html'><span itemprop='name'>mod_taharok</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-01-10T07:47:33Z'>
            <time itemprop='dateModified' datetime='2019-03-02T18:04:17Z' class='post-time'>
              March 2, 2019,  6:04pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="2" data-topic="172227">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/pwnd/40/5_6bca9977b612b7aeef77ba1ec1cd67b3.png" class="avatar"> Pwnd:</div>
<blockquote>
<p>There’s a reason why they have a header.</p>
</blockquote>
</aside>
<p>I know there is. But you can also make your own headers in a udp packet that is probably a lot smaller than the default one in the tcp packet. I just want to know a good way for tcp transfer in Java.</p>
      </div>

      <meta itemprop='headline' content='Using TCP in Java &amp; TCP vs. UDP in Java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/yakman.html'><span itemprop='name'>yakman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-01-10T16:06:31Z'>
            <time itemprop='dateModified' datetime='2016-07-30T18:41:31Z' class='post-time'>
              July 30, 2016,  6:41pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>well i assume you’re making a server, we haven’t really seen any sourcecode from it, but this is how i would handle the incoming data, but for all i know, you already do this.</p>
<pre><code class="lang-auto">//inputList is an instance of List&lt;DataInputStream&gt;
for(DataInputStream in : inputList) {
     if(in.avaliable() &gt; 0) {
          //the protocol says the first two bytes are the length of rest of the buffer
          int len = in.readUnsignedShort();
          byte[] buffer = new byte[len];
          in.readFully(buffer, 0, len);

          //incomingQueue is an instance of Queue&lt;byte[]&gt;
          synchronized(incomingQueue) {
               incomingQueue.offer(buffer);
               incomingQueue.notify();
          }
          //there is another thread which handles the parsing of the packets
          //it gets the lock of incomingQueue and takes out a byte[], when there is no more, it wait()
          //until woken up again
     }
}</code></pre>
<p>tbh, iv never made a program which only behaves as a server like this, but i think this would work out alright, maybe you could optimise some parts.<br>
beware that this setup gives a lot of trust to the client, a malicious client could try to crash your server by sending a small length and large amounts of data.<br>
but you could do some bounds checking or something, and disconnect the badly behaving client if you need to</p>
      </div>

      <meta itemprop='headline' content='Using TCP in Java &amp; TCP vs. UDP in Java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mod_taharok.html'><span itemprop='name'>mod_taharok</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-01-10T17:32:32Z'>
            <time itemprop='dateModified' datetime='2016-07-30T18:41:33Z' class='post-time'>
              July 30, 2016,  6:41pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“yakman, post:4, topic:172227”]well i assume you’re making a server, we haven’t really seen any sourcecode from it, but this is how i would handle the incoming data, but for all i know, you already do this.</p>
<pre><code class="lang-auto">//inputList is an instance of List&lt;DataInputStream&gt;
for(DataInputStream in : inputList) {
     if(in.avaliable() &gt; 0) {
          //the protocol says the first two bytes are the length of rest of the buffer
          int len = in.readUnsignedShort();
          byte[] buffer = new byte[len];
          in.readFully(buffer, 0, len);

          //incomingQueue is an instance of Queue&lt;byte[]&gt;
          synchronized(incomingQueue) {
               incomingQueue.offer(buffer);
               incomingQueue.notify();
          }
          //there is another thread which handles the parsing of the packets
          //it gets the lock of incomingQueue and takes out a byte[], when there is no more, it wait()
          //until woken up again
     }
}</code></pre>
<p>tbh, iv never made a program which only behaves as a server like this, but i think this would work out alright, maybe you could optimise some parts.<br>
beware that this setup gives a lot of trust to the client, a malicious client could try to crash your server by sending a small length and large amounts of data.<br>
but you could do some bounds checking or something, and disconnect the badly behaving client if you need to[/quote]</p>
<p>Okay thanks a lot for that. To be fully honest, I never used a DataInputStream before, but I have known of its existence. I mainly just used my own methods which probably is not the best idea. =S</p>
      </div>

      <meta itemprop='headline' content='Using TCP in Java &amp; TCP vs. UDP in Java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/yakman.html'><span itemprop='name'>yakman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-01-10T21:42:44Z'>
            <time itemprop='dateModified' datetime='2016-07-30T18:41:48Z' class='post-time'>
              July 30, 2016,  6:41pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ah well data input stream is just a useful shortcut for some things,<br>
i like it cause all its methods throw EOFException if needed, so you don’t have to constants check the return value.<br>
if you’re going to use it, look through the source <span class="bbcode-i">and understand it</span></p>
<p>like readUnsignedShort() is something like this</p>
<pre><code class="lang-auto">public int readUnsignedShort() {
     int i1 = in.read();
     int i2 = in.read();
     if(i1 | i2 &lt; 0)
          throw new EOFException();
     return (i1 &lt;&lt; 8) | (i2);
}</code></pre>
<p>^^ probably got that a big wrong, but its the general idea</p>
      </div>

      <meta itemprop='headline' content='Using TCP in Java &amp; TCP vs. UDP in Java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/using-tcp-in-java-tcp-vs-udp-in-java/172227 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 16:33:30 GMT -->
</html>
