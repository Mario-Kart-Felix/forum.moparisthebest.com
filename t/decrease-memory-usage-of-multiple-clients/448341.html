<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/decrease-memory-usage-of-multiple-clients/448341 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Aug 2019 03:39:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Decrease memory usage of multiple clients - Runescape - moparisthebest.com</title>
    <meta name="description" content="Hey, so I developed a pretty simple client that downloads the runescape loader, and loads multiple instances of the Rs2Applet class into a JTabbedPane.  I do some basic manipulation of the Canvas&amp;#39;s within the Applets, bu&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="448341.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Decrease memory usage of multiple clients&#39;" href="448341.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/decrease-memory-usage-of-multiple-clients/448341" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/decrease-memory-usage-of-multiple-clients/448341" />
<meta property="og:title" content="Decrease memory usage of multiple clients" />
<meta name="twitter:title" content="Decrease memory usage of multiple clients" />
<meta property="og:description" content="Hey, so I developed a pretty simple client that downloads the runescape loader, and loads multiple instances of the Rs2Applet class into a JTabbedPane.  I do some basic manipulation of the Canvas’s within the Applets, but my main problem is that each additional tab takes 300mb+ of memory, and significantly slows down the others.  Running 2 clients eventually ends up using over a gb of memory, and both are veeeery slow.  I can’t run more than 3 clients simultaneously without them lagging so bad t..." />
<meta name="twitter:description" content="Hey, so I developed a pretty simple client that downloads the runescape loader, and loads multiple instances of the Rs2Applet class into a JTabbedPane.  I do some basic manipulation of the Canvas’s within the Applets, but my main problem is that each additional tab takes 300mb+ of memory, and significantly slows down the others.  Running 2 clients eventually ends up using over a gb of memory, and both are veeeery slow.  I can’t run more than 3 clients simultaneously without them lagging so bad t..." />
<meta property="article:published_time" content="2012-07-05T03:43:48+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="448341.html">Decrease memory usage of multiple clients</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/michael879.html'><span itemprop='name'>michael879</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-05T03:43:48Z'>
            <time itemprop='dateModified' datetime='2016-08-03T10:04:38Z' class='post-time'>
              August 3, 2016, 10:04am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hey, so I developed a pretty simple client that downloads the runescape loader, and loads multiple instances of the Rs2Applet class into a JTabbedPane.  I do some basic manipulation of the Canvas’s within the Applets, but my main problem is that each additional tab takes 300mb+ of memory, and significantly slows down the others.  Running 2 clients eventually ends up using over a gb of memory, and both are veeeery slow.  I can’t run more than 3 clients simultaneously without them lagging so bad they lobby.</p>
<p>I’ve looked into it, and correct me if I’m wrong, but I believe the problem stems from the fact that each instance of Rs2Applet unpacked its own version of the encrypted gamepack and reloads the runescape classes into the JVM.</p>
<p>I am a very good programmer, but I’m completely new to BCEL and ASM.  Could someone please point me to some resources that could help me with THIS specific problem?  I’ve done a lot of research and all I’ve been able to find is tutorials for creating single clients, and none of them seem to load the client in any better way than I do.</p>
<p>*edit: just to clarify, I am not interested in making an intelligent BOT.  This program is merely a swiftkit-type client, with a few “illegal” additions (autotyper, autoclicker, multilog feature).  I have not had to dive into bytecode manipulation for any of this, but I believe I might have to in order to fix this issue.  If I’m wrong in that belief, PLEASE share</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-05T08:29:31Z'>
            <time itemprop='dateModified' datetime='2016-08-03T10:04:51Z' class='post-time'>
              August 3, 2016, 10:04am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The client is heavy with global state and attempting to use a single class loader will fail pretty quickly… you’ll be unintentionally sharing state between two instances of the client, which (logically) is a <span class="bbcode-i">bad idea</span>. Consider a simple dummy case where some rendering mechanism requires configuration of some static fields</p>
<pre><code class="lang-auto">class Client {
  ...
  Scene scene;
  Surface surface;
  ...
  void init() {
    ...
    Renderer.configure(scene, surface.raster());
    ...
  }
  ...
  void render() {
    ...
    Renderer.render();
    ...
  }
}</code></pre>
<pre><code class="lang-auto">Client client_a = createClient(...);
client_a.init();
...
Client client_b = createClient(...);
client_b.init();
...
client_a.render(); /* rendering using client_b's scene and surface! */</code></pre>
<p>You must keep the game clients independent and unaware of one another. Experiment with multi-VM approaches and see how that works for you. (added bonus: attaching to browser applet VMs with a debugging agent, work without an explicit loader)</p>
<p>If you’re interested in truly decreasing memory usage of the client, there’s not much you can really do that won’t require at least <span class="bbcode-i">modest</span> re-engineering of the game code. I haven’t looked at client’s more than about 2 or 3 years old now so my advice may be dated, so hopefully someone with more up-to-date advice may provide some assistance here.</p>
<p>Cheers.</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/michael879.html'><span itemprop='name'>michael879</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-05T22:27:21Z'>
            <time itemprop='dateModified' datetime='2016-08-03T10:05:29Z' class='post-time'>
              August 3, 2016, 10:05am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>thanks, so I guess I was wrong about what I thought the solution was.  However, I have seen runescape bots out there capable of running 10+ clients with little to no CPU or memory problems!  So there must be some solution…</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Uncalled.html'><span itemprop='name'>Uncalled</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-07T10:47:22Z'>
            <time itemprop='dateModified' datetime='2016-08-03T10:07:54Z' class='post-time'>
              August 3, 2016, 10:07am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“michael879, post:3, topic:448341”]thanks, so I guess I was wrong about what I thought the solution was.  However, I have seen runescape bots out there capable of running 10+ clients with little to no CPU or memory problems!  So there must be some solution…[/quote]that’s because those bots [like veer said] keep the clients unaware of the other(s).</p>
<p>but veer, just reading your code [correct me if i’m wrong], your <span class="bbcode-i">client_a; client_b</span> statements are what delivers the clients? if so, that’s a very bad way to provide the user with multiple clients. requiring different methods for every client possible to open just is not the way to approach that. again, please correct me if i’m mistaken.</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/unlimitedorb.html'><span itemprop='name'>unlimitedorb</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-07T13:09:32Z'>
            <time itemprop='dateModified' datetime='2016-08-03T10:07:57Z' class='post-time'>
              August 3, 2016, 10:07am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Uncalled, post:4, topic:448341”][quote author=michael879 link=topic=551233.msg4040006#msg4040006 date=1341527241]<br>
thanks, so I guess I was wrong about what I thought the solution was.  However, I have seen runescape bots out there capable of running 10+ clients with little to no CPU or memory problems!  So there must be some solution…<br>
[/quote]that’s because those bots [like veer said] keep the clients unaware of the other(s).</p>
<p>but veer, just reading your code [correct me if i’m wrong], your <span class="bbcode-i">client_a; client_b</span> statements are what delivers the clients? if so, that’s a very bad way to provide the user with multiple clients. requiring different methods for every client possible to open just is not the way to approach that. again, please correct me if i’m mistaken.[/quote]<br>
how would you do it?</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/michael879.html'><span itemprop='name'>michael879</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-07T21:06:49Z'>
            <time itemprop='dateModified' datetime='2016-08-03T12:25:40Z' class='post-time'>
              August 3, 2016, 12:25pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>ok… My client’s are unaware of eachother as well, and for some reason if I load more than 1 client they become so slow they’re unusable.  I even went so far as to replace the graphics object used to paint each client so that only the current client is actually drawn (if the graphics object is turned “off” it just does nothing on drawImage calls etc).  I can’t really seem to figure out why they are so slow…</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-07T22:17:20Z'>
            <time itemprop='dateModified' datetime='2016-08-03T12:25:42Z' class='post-time'>
              August 3, 2016, 12:25pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Uncalled, post:4, topic:448341”][quote author=michael879 link=topic=551233.msg4040006#msg4040006 date=1341527241]<br>
thanks, so I guess I was wrong about what I thought the solution was.  However, I have seen runescape bots out there capable of running 10+ clients with little to no CPU or memory problems!  So there must be some solution…<br>
[/quote]that’s because those bots [like veer said] keep the clients unaware of the other(s).</p>
<p>but veer, just reading your code [correct me if i’m wrong], your <span class="bbcode-i">client_a; client_b</span> statements are what delivers the clients? if so, that’s a very bad way to provide the user with multiple clients. requiring different methods for every client possible to open just is not the way to approach that. again, please correct me if i’m mistaken.[/quote]</p>
<p><span class="bbcode-b">Every functional polyclient bot keeps clients strictly separated from others.</span><br>
The game won’t work otherwise. Using separate class loaders is fine until both clients attempt loading the same native libraries.</p>
<p>Aside from that, I have no idea what you’re even talking about. Neither of those definitions “deliver” anything. It’s a placeholder for however a bot would acquire two distinct instances of the game client.<br>
Who is this <span class="bbcode-i">user</span> you’re referring to, and where exactly do you see “different methods for every client possible to open”? There is one method, <span class="bbcode-i">createClient</span>, which does exactly what I just said… act as a <span class="bbcode-b">placeholder for however a bot would acquire two distinct instances of the game client</span>.<br>
Unfortunately, I can’t correct you on any misunderstandings if I don’t even understand your post in the first place. Feel free to clarify whatever it is you intended to say.</p>
<aside class="quote quote-modified" data-post="6" data-topic="448341">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/michael879/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> michael879:</div>
<blockquote>
<p>ok… My client’s are unaware of eachother as well, and for some reason if I load more than 1 client they become so slow they’re unusable.  I even went so far as to replace the graphics object used to paint each client so that only the current client is actually drawn (if the graphics object is turned “off” it just does nothing on drawImage calls etc).  I can’t really seem to figure out why they are so slow…</p>
</blockquote>
</aside>
<p>Preventing the client from copying it’s rendered image onto the canvas does not prevent it from going through all the rasterization steps in the first place. I don’t know what you expect from running two heavy monolithic clients in the same VM without understanding how they work internally.</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/michael879.html'><span itemprop='name'>michael879</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-08T00:01:43Z'>
            <time itemprop='dateModified' datetime='2016-08-03T12:25:48Z' class='post-time'>
              August 3, 2016, 12:25pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“veer, post:7, topic:448341”]<span class="bbcode-b">Every functional polyclient bot keeps clients strictly separated from others.</span><br>
The game won’t work otherwise. Using separate class loaders is fine until both clients attempt loading the same native libraries.</p>
<p>Aside from that, I have no idea what you’re even talking about. Neither of those definitions “deliver” anything. It’s a placeholder for however a bot would acquire two distinct instances of the game client.<br>
Who is this <span class="bbcode-i">user</span> you’re referring to, and where exactly do you see “different methods for every client possible to open”? There is one method, <span class="bbcode-i">createClient</span>, which does exactly what I just said… act as a <span class="bbcode-b">placeholder for however a bot would acquire two distinct instances of the game client</span>.<br>
Unfortunately, I can’t correct you on any misunderstandings if I don’t even understand your post in the first place. Feel free to clarify whatever it is you intended to say.[/quote]<br>
Could you guys please take this discussion/argument somewhere else?  I think we can all agree that the clients need to be separate…</p>
<aside class="quote quote-modified" data-post="7" data-topic="448341">
<div class="title">
<div class="quote-controls"></div>
 veer:</div>
<blockquote>
<p>Preventing the client from copying it’s rendered image onto the canvas does not prevent it from going through all the rasterization steps in the first place. I don’t know what you expect from running two heavy monolithic clients in the same VM without understanding how they work internally.</p>
</blockquote>
</aside>
<p>I’m not surprised it didn’t work, I’m just telling you guys what I have tried.  I’ve been completely unable to trace the obfuscated code back from the Graphics.drawImage call to the actual processing.  So if either of you have any information that can help me narrow down where the CPU-intensive code is, that would be great.</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-08T02:46:00Z'>
            <time itemprop='dateModified' datetime='2016-08-03T12:26:04Z' class='post-time'>
              August 3, 2016, 12:26pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Assuming the modern safe-mode rendering is essentially the same as the old client’s software rendering, the Graphics.drawImage() call uses an Image produced (I believe using ImageProducer) from a raster of pixels which is written to when rendering the scene. This rendering phase is where all the projection math is done, along with the scanline-conversion and what not. Assuming you find the raster (it was an int[] in the older clients), you should be able to trace that to find the code that uses it. If you can disable the entire rendering process, you’ll find the client runs much faster.</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/michael879.html'><span itemprop='name'>michael879</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-08T04:21:14Z'>
            <time itemprop='dateModified' datetime='2016-08-03T12:26:09Z' class='post-time'>
              August 3, 2016, 12:26pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>thanks <img src="../../images/emoji/twitter/smileyae52.png?v=5" title=":smiley:" class="emoji" alt=":smiley:">  That gives me a place to start.  I actually did make a little progess by using a memory analyzing program to identify where CPU was spending most of its time.  I managed to cut out about 50% of the cpu load by disabling a high level function in the client class.  That remaining 50% has keyboard events integrated somewhere into it though, so its not nearly as simple (my autotyper stops working when I disable it).</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Uncalled.html'><span itemprop='name'>Uncalled</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-09T09:06:02Z'>
            <time itemprop='dateModified' datetime='2016-08-03T12:27:43Z' class='post-time'>
              August 3, 2016, 12:27pm
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i see your point, veer. i’ve just never tried to add multiple clients. usually when i need multiple “clients” rendered, it’s irrelevant to RuneScape.</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/michael879.html'><span itemprop='name'>michael879</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-07-09T15:52:25Z'>
            <time itemprop='dateModified' datetime='2016-08-03T12:27:57Z' class='post-time'>
              August 3, 2016, 12:27pm
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>so in case anyone else wants the answer here it is:</p>
<p>I ran jvisualvm (comes free with JDK) and had it monitor my client.  I had tried JProfiler earlier (the free trial) and apparently it must suck because it gave completely different results, and did not help me successfully shut off rendering.  However, using jvisualvm I was quickly able to find the opengl (directx on windows probly) calls that were hogging the CPU.  I managed to trace the majority of these calls back to a function with over 6000 lines of bytecode, and the signature: ([L**;IIIIIIIIZI)V, where ** is some obfuscated class name that doesnt really matter.  It turns out there are only 2 functions with this signature in the entire runescape jar, and the other one is much much smaller.  Insert a “hook” (I’m new to hacking idk the terminology) to the beginning of this function that just exits when you disable rendering, and you will cut your CPU usage down by a factor of 2!</p>
<p>Looking a little further, there were still calls to OpenGL.swapBuffers that were hogging a lot of the CPU time.  I traced these calls back to 1 function, but just for the sake of redundancy, I ended up inserting my “hook” into every function with any OpenGL code.  Here is the code I’m using to do this:</p>
<pre><code class="lang-auto">	public void insertGraphicsHooks(ClassGen cg)
	{
		if(cg.getClassName().contains("jaggl") || cg.getClassName().contains("jagdx") || cg.getClassName().contains("jagtheora"))
			return;
		ConstantPoolGen cpg = cg.getConstantPool();
		for(Method m: cg.getMethods())
		{
			MethodGen mg = new MethodGen(m, cg.getClassName(), cpg);
			if(mg.getInstructionList() == null)
				continue;
			Iterator iter = mg.getInstructionList().iterator();
			while(iter.hasNext())
			{
				InstructionHandle handle = (InstructionHandle)iter.next();
				if(handle.getInstruction() instanceof InvokeInstruction)
				{
					InvokeInstruction inst = (InvokeInstruction)handle.getInstruction();
					if(inst.getLoadClassType(cpg).getSignature().contains("jaggl") ||
							inst.getLoadClassType(cpg).getSignature().contains("jagdx") ||
							inst.getLoadClassType(cpg).getSignature().contains("jagtheora"))
					{
						insertHook(cg,cpg,mg);
						break;
					}
				}
			}
		}
	}</code></pre>
<p>This, along with the higher level hook successfully cut the CPU usage down by about 80%.  The only remaining resource hog is a call to InputStream.read, which is coming from the threads receiving input from the runescape server.  Although you can’t simply cut this call out, you might be able to slow it down to reduce the load even more…</p>
      </div>

      <meta itemprop='headline' content='Decrease memory usage of multiple clients'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/decrease-memory-usage-of-multiple-clients/448341 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Aug 2019 03:39:26 GMT -->
</html>
