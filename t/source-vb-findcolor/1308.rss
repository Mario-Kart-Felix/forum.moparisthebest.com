<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[Source][VB] FindColor</title>
    <link>https://forum.moparisthebest.com/t/source-vb-findcolor/1308</link>
    <description>Remember, this returns the coordinates of the color in a window, not the position on the screen, you&#39;ll have to use GetWindowRect to get the rect and add the needed numbers to the coordinates for the position on the screen.

[code]Private Declare Function GetWindowRect Lib &quot;user32&quot; (ByVal hwnd As Long, lpRect As RECT) As Long
Private Declare Function GetDC Lib &quot;user32&quot; (ByVal hwnd As Long) As Long
Private Declare Function GetPixel Lib &quot;gdi32&quot; (ByVal hdc As Long, ByVal X As Long, ByVal Y As Long) As Long

Private Type POINTAPI
    X As Long
    Y As Long
End Type

Function FindColor(Color As Long, X1 As Long, Y1 As Long, X2 As Long, Y2 As Long, _
                            Window As Long) As POINTAPI
Dim xx As Long, yy As Long, TestDC As Long, WndRECT As RECT, temp As POINTAPI
    TestDC = GetDC(Window)
    For yy = Y1 To Y2
        For xx = X1 To X2
            If GetPixel(TestDC, xx, yy) = Color Then
                temp.X = xx
                temp.Y = yy
                FindColor = temp
                Exit Function
            End If
            DoEvents
        Next xx
    Next yy
    FindColor.X = -1
    FindColor.Y = -1
End Function[/code]

Enjoy  :cool:</description>
    
    <lastBuildDate>Thu, 10 Aug 2006 01:24:50 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/source-vb-findcolor/1308.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[Source][VB] FindColor</title>
        <dc:creator><![CDATA[@oblivian oblivian]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/oblivian">@oblivian</a> wrote:</p>
          <blockquote>
              <p>wow man thx alot iv been searching for this for like 2 years lol</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/source-vb-findcolor/1308/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/source-vb-findcolor/1308/4</link>
        <pubDate>Thu, 10 Aug 2006 01:24:50 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1308-4</guid>
        <source url="https://forum.moparisthebest.com/t/source-vb-findcolor/1308.rss">[Source][VB] FindColor</source>
      </item>
      <item>
        <title>[Source][VB] FindColor</title>
        <dc:creator><![CDATA[@Freddy1990 Freddy1990]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/freddy1990">@Freddy1990</a> wrote:</p>
          <blockquote>
              <p>Yeah, well i just tought, there's so little vb sources on this forum, why add some <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/slight_smile.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/source-vb-findcolor/1308/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/source-vb-findcolor/1308/3</link>
        <pubDate>Tue, 11 Apr 2006 13:46:42 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1308-3</guid>
        <source url="https://forum.moparisthebest.com/t/source-vb-findcolor/1308.rss">[Source][VB] FindColor</source>
      </item>
      <item>
        <title>[Source][VB] FindColor</title>
        <dc:creator><![CDATA[@Mmmk Mmmk]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mmmk">@Mmmk</a> wrote:</p>
          <blockquote>
              <p>Youve been busy <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/smiley.png?v=3" title=":smiley:" class="emoji" alt=":smiley:"> gj hopefully people will find this cool.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/source-vb-findcolor/1308/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/source-vb-findcolor/1308/2</link>
        <pubDate>Tue, 11 Apr 2006 13:43:41 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1308-2</guid>
        <source url="https://forum.moparisthebest.com/t/source-vb-findcolor/1308.rss">[Source][VB] FindColor</source>
      </item>
      <item>
        <title>[Source][VB] FindColor</title>
        <dc:creator><![CDATA[@Freddy1990 Freddy1990]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/freddy1990">@Freddy1990</a> wrote:</p>
          <blockquote>
              <p>Remember, this returns the coordinates of the color in a window, not the position on the screen, you'll have to use GetWindowRect to get the rect and add the needed numbers to the coordinates for the position on the screen.</p>

<p></p><pre><code class="lang-auto">Private Declare Function GetWindowRect Lib "user32" (ByVal hwnd As Long, lpRect As RECT) As Long
Private Declare Function GetDC Lib "user32" (ByVal hwnd As Long) As Long
Private Declare Function GetPixel Lib "gdi32" (ByVal hdc As Long, ByVal X As Long, ByVal Y As Long) As Long
Private Type POINTAPI
    X As Long
    Y As Long
End Type
Function FindColor(Color As Long, X1 As Long, Y1 As Long, X2 As Long, Y2 As Long, _
                            Window As Long) As POINTAPI
Dim xx As Long, yy As Long, TestDC As Long, WndRECT As RECT, temp As POINTAPI
    TestDC = GetDC(Window)
    For yy = Y1 To Y2
        For xx = X1 To X2
            If GetPixel(TestDC, xx, yy) = Color Then
                temp.X = xx
                temp.Y = yy
                FindColor = temp
                Exit Function
            End If
            DoEvents
        Next xx
    Next yy
    FindColor.X = -1
    FindColor.Y = -1
End Function</code></pre>

<p>Enjoy  <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/cool.png?v=3" title=":cool:" class="emoji" alt=":cool:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/source-vb-findcolor/1308/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/source-vb-findcolor/1308/1</link>
        <pubDate>Tue, 11 Apr 2006 11:12:47 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1308-1</guid>
        <source url="https://forum.moparisthebest.com/t/source-vb-findcolor/1308.rss">[Source][VB] FindColor</source>
      </item>
  </channel>
</rss>
