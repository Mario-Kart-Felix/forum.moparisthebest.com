<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>NPC following after being spawned</title>
    <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447</link>
    <description>Salutations!

I have spent this afternoon going through the various methods within the DarkQuest and RSCA sources looking for the best way to implement automatic NPC following but have not found a solution yet.

I have created a plugin minigame that allows the capture and spawning of specific NPCs using an inventory item. Yes it sounds like some Pokemans but the goal is a summoning ability with a pet combat panel. It only spawns a single NPC currently while I finish getting the rest of the process constructed. The formatting of this WYSIWYG text box seems to be incorrectly spacing some of the the code below.

[code]
public class Pets {

    /**
     * World instance
     */

    public static final World world = World.getWorld();
	
    static int[] emptyPetItemID = {
		1231 // Charged crystal without a pet inside
    };
	static int[] fullPetItemID = {
		1222 // Red crystal with pet inside
    };
    static int[] petNpcID = {
		203 // Baby Blue Dragon
    }; 
	public static void summonPet(final Player player, final InvItem item) {
      if(item.getDef().getCommand().equalsIgnoreCase(&quot;inspect&quot;)) {
			player.getActionSender().sendMessage(&quot;You summon your pet.&quot;);
			world.getDelayedEventHandler().add(new ShortEvent(player) {
				public void action() {
					player.getInventory().remove(fullPetItemID[0], 1);
					player.getInventory().add(new InvItem(emptyPetItemID[0], 1));
					player.getActionSender().sendInventory();
					Npc petDragon = new Npc(player.getLocation(), petNpcID[0],  player.getUsername());
					petDragon.shouldRespawn = false;
					world.registerNpc(petDragon);
				}
			});
		}
	}
}
[/code]

InvUseOnNPC:

[code]case 203: // Baby blue dragon
		    if (!itemId(new int[] { 1231 })) {
			owner.getActionSender().sendMessage(&quot;Nothing interesting happens.&quot;);
			return;
		    }
		    owner.setBusy(true);
		    affectedNpc.blockedBy(owner);
		    affectedNpc.resetPath();
		    showBubble();
		    owner.getActionSender().sendMessage(&quot;You attempt to put the baby blue dragon in the crystal.&quot;);
		    World.getWorld().getDelayedEventHandler().add(new ShortEvent(owner) {
			public void action() {
			    if (DataConversions.random(0, 4) != 0) {
				owner.getActionSender().sendMessage(&quot;You catch the dragon in the crystal.&quot;);
				owner.getInventory().remove(new InvItem(1231, 1));
				owner.getInventory().add(new InvItem(1222, 1));
				owner.getActionSender().sendInventory();
			    owner.setBusy(false);
				affectedNpc.unblock();
				world.unregisterNpc(affectedNpc);
				affectedNpc.remove();
				} else {
				owner.getActionSender().sendMessage(&quot;The baby blue dragon manages to get away from you!&quot;);
			    owner.setBusy(false);
				affectedNpc.unblock();
				}
			}
		    });
		    break;[/code]

InvActionHandler:

[code]case 1222: // Red Crystal
						Pets.summonPet(player, item);
						break;[/code]

NPCLoc:

[code]/**
    * Npc Owner
    */
	public String owner = null;
    public NPCLoc(int id, int startX, int startY, String owner) {
		this.id = id;
		this.startX = startX;
		this.startY = startY;
		this.owner = owner;
    }
	public String getOwner() {
      return owner;
	}[/code]

Npc:

[code]/**
    * Npc Owner
    */		
	private String owner = null;
	public Npc(NPCLoc loc, String owners) {
		for (int i : Constants.GameServer.UNDEAD_NPCS) {
			if (loc.getId() == i) {
				this.undead = true;
			}
		}
		for (int i : Constants.GameServer.ARMOR_NPCS) {
			if (loc.getId() == i) {
				this.hasArmor = true;
			}
		}
		def = EntityHandler.getNpcDef(loc.getId());
		curHits = def.getHits();

		this.loc = loc;
		this.owner = owners;
		super.setID(loc.getId());
		super.setLocation(Point.location(loc.startX(), loc.startY()), true);
		super.setCombatLevel(Formulae.getCombatLevel(def.getAtt(), def.getDef(), def.getStr(), def.getHits(), 0, 0, 0));
		if (this.loc.getId() == 189 || this.loc.getId() == 53) {
			this.def.aggressive = true;
		}
	}
   public Npc(Point location, int id, String owner) {
      this(new NPCLoc(id, location.getX(), location.getY(), owner));
   }
   public String getOwner() {
      return loc.owner;
   }[/code]


I have tried to use the setChasing method within the Npc class within the Pets class under the summonPet method as:

[code]petDragon.setChasing(player);[/code]

and I have also tried using the follow method for players:

[code]petDragon.following = player;[/code]


Neither cause the NPC to follow the player around the map after it has been spawned. I am thinking that either there should be a follow event created or that there should be a NPC version of the player follow method created within the Player class. I am not sure how to write such an event and need some help.</description>
    
    <lastBuildDate>Sat, 12 Oct 2013 15:01:24 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@cleako cleako]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/cleako">@cleako</a> wrote:</p>
          <blockquote>
              <p>[quote=“KO9, post:23, topic:393447”][quote author=Kryptix link=topic=490618.msg3588835#msg3588835 date=1304400344]</p>
<aside class="quote">
<blockquote>
<p>It never actually showed the cat following you. Just saying.</p>
</blockquote>
</aside>
<p>Yeah I just realised that it was someone on RSCA that made the sprites for walkable kittens.<br>
[/quote]</p>
<p>yer i still have the sprites if anyone wants[/quote]</p>
<p>Do you have these sprites anymore?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/25">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/25</link>
        <pubDate>Sat, 12 Oct 2013 15:01:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-25</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@iPhone4 iPhone4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/iphone4">@iPhone4</a> wrote:</p>
          <blockquote>
              <p>Yes please</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/24">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/24</link>
        <pubDate>Sat, 21 May 2011 12:46:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-24</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@KO9 KO9]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ko9">@KO9</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="4" data-topic="393457">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/kryptix/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar">
</div>
<blockquote>
<p>[quote author=imthenull link=topic=490618.msg3587723#msg3587723 date=1304312150]It never actually showed the cat following you. Just saying.</p>
</blockquote>
</aside>
<p>Yeah I just realised that it was someone on RSCA that made the sprites for walkable kittens.[/quote]</p>
<p>yer i still have the sprites if anyone wants</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/23">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/23</link>
        <pubDate>Sat, 21 May 2011 12:32:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-23</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="21" data-topic="393447">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/moparisthebest/40/30_1.png" class="avatar"> Moparisthebest:</div>
<blockquote>
<p>Regardless, you still can’t just cast the mob object to Player without checking, you must at least do “mob instanceof Player” first.  I still don’t think that is the right way to do it though.</p>
</blockquote>
</aside>
<p>If you really want to make Mob based following, you should make a new class for it to make it easier, so NPCs can follow NPCs, Players can follow NPCs, NPCs can follow Players etc, see FightEvent for example.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/22">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/22</link>
        <pubDate>Thu, 19 May 2011 20:03:20 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-22</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>Regardless, you still can’t just cast the mob object to Player without checking, you must at least do “mob instanceof Player” first.  I still don’t think that is the right way to do it though.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/21">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/21</link>
        <pubDate>Thu, 19 May 2011 18:39:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-21</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:18, topic:393447”][quote author=-Nothing link=topic=490618.msg3600007#msg3600007 date=1305477854]<br>
you could do DelayedEvent((Player) mob, time) instead so you won’t need to change the delayedevent system.(This is what I would do)<br>
[/quote]</p>
<p>But that would fail hard anytime you tried to do it on an NPC, so it wouldn’t work for what he wanted at all.[/quote]<br>
Why would the event run on the NPC? It should be ran on the player the npc is following, or even null, but personally I would never mess around with the DelayedEvent class.</p>
<pre><code class="lang-auto">final NPC npc = n;
new DelayedEvent(500, null) {
public void run() {
//n.blabla();
}
}</code></pre>
<aside class="quote quote-modified" data-post="19" data-topic="393447">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/iphone4/40/6759_1.png" class="avatar"> iPhone4:</div>
<blockquote>
<p>Yes, the goal is to have the pet NPC follow the player around until it is put back into it’s crystal or if the player logs out. How did RSCA handle the pet kitten with the walkable sprite?</p>
</blockquote>
</aside>
<p>The public RSCA source doesn’t contain anything related to it :s</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/20">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/20</link>
        <pubDate>Mon, 16 May 2011 09:10:14 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-20</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@iPhone4 iPhone4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/iphone4">@iPhone4</a> wrote:</p>
          <blockquote>
              <p>Yes, the goal is to have the pet NPC follow the player around until it is put back into it’s crystal or if the player logs out. How did RSCA handle the pet kitten with the walkable sprite?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/19</link>
        <pubDate>Sun, 15 May 2011 17:06:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-19</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="17" data-topic="393447">
<div class="title">
<div class="quote-controls"></div>
 -Nothing:</div>
<blockquote>
<p>you could do DelayedEvent((Player) mob, time) instead so you won’t need to change the delayedevent system.(This is what I would do)</p>
</blockquote>
</aside>
<p>But that would fail hard anytime you tried to do it on an NPC, so it wouldn’t work for what he wanted at all.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/18</link>
        <pubDate>Sun, 15 May 2011 16:58:03 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-18</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:16, topic:393447”]It should not be in the NPC or the Player class, but instead should be permanently moved to the Mob class.  (which, through inheritance, makes it work on both Player and NPC classes)</p>
<p>From a quick look at what you posted, DelayedEvent needs to be changed to accept Mob instead of Player?[/quote]<br>
Yup I know, but if you want to do it fast you could do it the way I told you.<br>
Or you could do DelayedEvent((Player) mob, time) instead so you won’t need to change the delayedevent system.(This is what I would do)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/17</link>
        <pubDate>Sun, 15 May 2011 16:44:14 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-17</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>It should not be in the NPC or the Player class, but instead should be permanently moved to the Mob class.  (which, through inheritance, makes it work on both Player and NPC classes)</p>
<p>From a quick look at what you posted, DelayedEvent needs to be changed to accept Mob instead of Player?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/16</link>
        <pubDate>Sat, 14 May 2011 23:07:29 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-16</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@iPhone4 iPhone4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/iphone4">@iPhone4</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="14" data-topic="393447">
<div class="title">
<div class="quote-controls"></div>
 -Nothing:</div>
<blockquote>
<p>If you don’t want to mess around with it, because it obviously needs lots of changing, you should add it into the NPC class.</p>
</blockquote>
</aside>
<p>The same error results there too.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/15</link>
        <pubDate>Sat, 14 May 2011 22:34:16 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-15</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>If you don’t want to mess around with it, because it obviously needs lots of changing, you should add it into the NPC class.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/14</link>
        <pubDate>Sat, 14 May 2011 22:33:01 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-14</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@iPhone4 iPhone4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/iphone4">@iPhone4</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="12" data-topic="393447">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/moparisthebest/40/30_1.png" class="avatar"> Moparisthebest:</div>
<blockquote>
<p>A good IDE would probably be able to do it for you automatically.  Without that though, you basically cut the whole setFollowing() method out of the Player class, paste it into the Mob class, then move everything else that it needs to function up from the Player class to the Mob class as well, then you can use it on anything extending Mob (Player and NPC).</p>
</blockquote>
</aside>
<p>Ah, the mob class. I tried using the setFollowing() method from the Player class in the NPC class using NetBeans 7 IDE as NPC extends Mob. Player extends Mob. Copied the methods from the Player class into the Mob class:</p>
<p>Added in the Mob class:</p>
<pre><code class="lang-auto">/*
	 *Set Following taken from Player class
	 */
	
	public void setStatus(Action a) {
		status = a;
	}
	
	/**
	 * The current status of the player
	 */
	private Action status = Action.IDLE;
	
	/**
	 * Event to handle following
	 */
	private DelayedEvent followEvent;
	/**
	 * Who we are currently following (if anyone)
	 */
	private Mob following;
	/**
	 * Map of players on players friend list
	 */
	 
	public boolean isFollowing() {
		return followEvent != null &amp;&amp; following != null;
	}
	
	private void resetAllExceptTradeOrDuel() {
		if (isFollowing()) {
			resetFollowing();
		}
		setStatus(Action.IDLE);
	}
	
	public void resetFollowing() {
		following = null;
		if (followEvent != null) {
			followEvent.stop();
			followEvent = null;
		}
		resetPath();
	}
	
	public void setFollowing(Mob mob) {
		setFollowing(mob, 0);
	}
	
	public DelayedEvent getFollowEvent() {
		return followEvent;
	}

	public void setFollowEvent(DelayedEvent followEvent) {
		this.followEvent = followEvent;
	}
	
	public void setFollowing(final Mob mob, final int radius) {
		if (isFollowing()) {
			resetFollowing();
		}
		following = mob;
		followEvent = new DelayedEvent(this, 500) {

			public void run() {
				if (!owner.withinRange(mob) || mob.isRemoved()
						|| (owner.isBusy() &amp;&amp; !owner.isDueling())) {
					resetFollowing();
				} else if (!owner.finishedPath()
						&amp;&amp; owner.withinRange(mob, radius)) {
					owner.resetPath();
				} else if (owner.finishedPath()
						&amp;&amp; !owner.withinRange(mob, radius + 1)) {
					owner.setPath(new Path(owner.getX(), owner.getY(), mob
							.getX(), mob.getY()));
				}
			}
		};
		World.getWorld().getDelayedEventHandler().add(followEvent);
	}
	
	public Mob getFollowing() {
		return following;
	}
	
	//-----------------------</code></pre>
<p>I am calling it with the Pets class:</p>
<pre><code class="lang-auto">public void action() {
					player.getInventory().remove(fullPetItemID[0], 1);
					player.getInventory().add(new InvItem(emptyPetItemID[0], 1));
					player.getActionSender().sendInventory();
					Npc petDragon = new Npc(player.getLocation(), petNpcID[0],  player.getUsername());
					petDragon.shouldRespawn = false;
					petDragon.setFollowing(player);
					world.registerNpc(petDragon);
				}</code></pre>
<p>Compile error:</p>
<pre><code class="lang-auto">    [javac] Compiling 350 source files to C:\Users\iPhone4\Desktop\Server\build
    [javac] C:\Users\iPhone4\Desktop\Server\src\org\darkquest\gs\model\Mob.java:241: cannot find symbol
    [javac] symbol  : constructor DelayedEvent(org.darkquest.gs.model.Mob,int)
    [javac] location: class org.darkquest.gs.event.DelayedEvent
    [javac] 		followEvent = new DelayedEvent(this, 500) {
    [javac] 		              ^
    [javac] C:\Users\iPhone4\Desktop\Server\src\org\darkquest\gs\model\Mob.java:241: cannot find symbol
    [javac] symbol  : constructor DelayedEvent()
    [javac] location: class org.darkquest.gs.event.DelayedEvent
    [javac] 		followEvent = new DelayedEvent(this, 500) {
    [javac] 		                                          ^</code></pre>
<p>The only way I can get it to compile is by setting new DelayedEvent(this, 500) to new DelayedEvent(<span class="bbcode-i">null</span>, 500)</p>
<p>The problem with setting the follow event to null is that the game server errors this repeatedly and the NPC ceases to move and is set to busy:</p>
<pre><code class="lang-auto">[java] java.lang.NullPointerException
     [java] 	at org.dragonannihilators.gs.model.Mob$1.run(Mob.java:244)
     [java] 	at org.dragonannihilators.gs.core.DelayedEventHandler.doEvents(DelayedEventHandler.java:48)
     [java] 	at org.dragonannihilators.gs.core.GameEngine.processEvents(GameEngine.java:146)
     [java] 	at org.dragonannihilators.gs.core.GameEngine.run(GameEngine.java:250)</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/13</link>
        <pubDate>Sat, 14 May 2011 19:55:29 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-13</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>A good IDE would probably be able to do it for you automatically.  Without that though, you basically cut the whole setFollowing() method out of the Player class, paste it into the Mob class, then move everything else that it needs to function up from the Player class to the Mob class as well, then you can use it on anything extending Mob (Player and NPC).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/12</link>
        <pubDate>Tue, 03 May 2011 04:09:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-12</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@NotPro NotPro]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/notpro">@NotPro</a> wrote:</p>
          <blockquote>
              <p>How would you start It though, I tried using any way I could possibly think of, but with no success. If someone could possibly point me In the right direction I’d appreciate It.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/11</link>
        <pubDate>Tue, 03 May 2011 03:28:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-11</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>[quote=“Kryptix, post:3, topic:393457”][quote author=Moparisthebest link=topic=490618.msg3587635#msg3587635 date=1304306880]<br>
Shouldn’t Player and NPC extend the same class?  Sometimes called Entity or similar?  Because the setFollowing() method should belong to the super class and then it can be used the same way with either Player or with NPC.<br>
[/quote]<br>
They both extend the Mob class but I believe only player following player was added into RSCD. You’re right though it should allow either a player or NPC to follow a player or NPC but I don’t think it was added like that at the time. On RSC you could have a pet kitten/cat follow you so it would be beneficial to make it work for either.[/quote]</p>
<p>Well in that case the following method(s) should just be refactored up from Player to the Mob class, then your problem should be solved.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/10</link>
        <pubDate>Mon, 02 May 2011 20:46:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-10</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@iPhone4 iPhone4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/iphone4">@iPhone4</a> wrote:</p>
          <blockquote>
              <p>With enough effort and skill, much can still be added. I like the RSC engine for it’s simplicity and usage of sprites for learning Java but it is not fun writing things from scratch without a formal education in advanced OOP. I may take a break and finally just read through both of my Java books before continuing.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/9</link>
        <pubDate>Mon, 02 May 2011 07:09:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-9</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@IlikeArrays IlikeArrays]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilikearrays">@IlikeArrays</a> wrote:</p>
          <blockquote>
              <p>Ahh he was already making rs2, he didn’t care. RSC engine obviously was unable to have summoning/npc following. I have never seen the cats animations in the client cache so I doubt they attempted to add it.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/8</link>
        <pubDate>Mon, 02 May 2011 07:02:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-8</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@iPhone4 iPhone4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/iphone4">@iPhone4</a> wrote:</p>
          <blockquote>
              <p>28 July 2003 (Update) <a href="http://runescape.wikia.com/wiki/Gertrude's_Cat" rel="nofollow noopener">http://runescape.wikia.com/wiki/Gertrude’s_Cat</a></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/7</link>
        <pubDate>Mon, 02 May 2011 06:56:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-7</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@IlikeArrays IlikeArrays]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilikearrays">@IlikeArrays</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="4" data-topic="393447">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/imthenull/40/1273_1.png" class="avatar"> imthenull:</div>
<blockquote>
<p>It never actually showed the cat following you. Just saying.</p>
</blockquote>
</aside>
<p>He never played it so he wouldn’t know.</p>
<p><a class="mention" href="/u/iphone">@Iphone</a></p>
<p>I am sure Andrew never decided to bother with it. Anybody know what what time of rsc that cats were released? 2002?2003?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/6</link>
        <pubDate>Mon, 02 May 2011 06:36:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-6</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@iPhone4 iPhone4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/iphone4">@iPhone4</a> wrote:</p>
          <blockquote>
              <p>It has been so many years that the memories blended with RS2 317 kittens and cats!</p>
<p>I found a video of RSC cats in action:<br>
<div class="lazyYT" data-youtube-id="995IFBgcWuw" data-youtube-title="Mining Kitty - Runescape Classic" data-width="480" data-height="270" data-parameters="feature=oembed&amp;wmode=opaque"></div></p>
<p>Looks like Andrew Gower never accomplished it in RSC!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/5</link>
        <pubDate>Mon, 02 May 2011 06:08:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-5</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@imthenull imthenull]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/imthenull">@imthenull</a> wrote:</p>
          <blockquote>
              <p>[quote=“Kryptix, post:3, topic:393457”][quote author=Moparisthebest link=topic=490618.msg3587635#msg3587635 date=1304306880]<br>
Shouldn’t Player and NPC extend the same class?  Sometimes called Entity or similar?  Because the setFollowing() method should belong to the super class and then it can be used the same way with either Player or with NPC.<br>
[/quote]<br>
They both extend the Mob class but I believe only player following player was added into RSCD. You’re right though it should allow either a player or NPC to follow a player or NPC but I don’t think it was added like that at the time. On RSC you could have a pet kitten/cat follow you so it would be beneficial to make it work for either.[/quote]<br>
It never actually showed the cat following you. Just saying.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/4</link>
        <pubDate>Mon, 02 May 2011 04:55:50 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-4</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>Shouldn’t Player and NPC extend the same class?  Sometimes called Entity or similar?  Because the setFollowing() method should belong to the super class and then it can be used the same way with either Player or with NPC.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/3</link>
        <pubDate>Mon, 02 May 2011 03:28:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-3</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@iPhone4 iPhone4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/iphone4">@iPhone4</a> wrote:</p>
          <blockquote>
              <p>I am currently looking at that and it seems to be perfect.</p>
<p>Player:</p>
<p>[code]public void setFollowing(Mob mob) {<br>
setFollowing(mob, 0);<br>
}</p>
<pre><code>public void setFollowing(final Mob mob, final int radius) {
	if (isFollowing()) {
		resetFollowing();
	}
	following = mob;
	followEvent = new DelayedEvent(this, 500) {

		public void run() {
			if (!owner.withinRange(mob) || mob.isRemoved()
					|| (owner.isBusy() &amp;&amp; !owner.isDueling())) {
				resetFollowing();
			} else if (!owner.finishedPath()
					&amp;&amp; owner.withinRange(mob, radius)) {
				owner.resetPath();
			} else if (owner.finishedPath()
					&amp;&amp; !owner.withinRange(mob, radius + 1)) {
				owner.setPath(new Path(owner.getX(), owner.getY(), mob
						.getX(), mob.getY()));
			}
		}
	};
	World.getWorld().getDelayedEventHandler().add(followEvent);
}[/code]
</code></pre>
<p>The line that reads “World.getWorld().getDelayedEventHandler().add(followEvent);” seems to be what I am looking for but I am not sure how to put that into the summonPet method.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/2</link>
        <pubDate>Sun, 01 May 2011 22:46:23 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-2</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
      <item>
        <title>NPC following after being spawned</title>
        <dc:creator><![CDATA[@iPhone4 iPhone4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/iphone4">@iPhone4</a> wrote:</p>
          <blockquote>
              <p>Salutations!</p>
<p>I have spent this afternoon going through the various methods within the DarkQuest and RSCA sources looking for the best way to implement automatic NPC following but have not found a solution yet.</p>
<p>I have created a plugin minigame that allows the capture and spawning of specific NPCs using an inventory item. Yes it sounds like some Pokemans but the goal is a summoning ability with a pet combat panel. It only spawns a single NPC currently while I finish getting the rest of the process constructed. The formatting of this WYSIWYG text box seems to be incorrectly spacing some of the the code below.</p>
<pre><code class="lang-auto">public class Pets {

    /**
     * World instance
     */

    public static final World world = World.getWorld();
	
    static int[] emptyPetItemID = {
		1231 // Charged crystal without a pet inside
    };
	static int[] fullPetItemID = {
		1222 // Red crystal with pet inside
    };
    static int[] petNpcID = {
		203 // Baby Blue Dragon
    }; 
	public static void summonPet(final Player player, final InvItem item) {
      if(item.getDef().getCommand().equalsIgnoreCase("inspect")) {
			player.getActionSender().sendMessage("You summon your pet.");
			world.getDelayedEventHandler().add(new ShortEvent(player) {
				public void action() {
					player.getInventory().remove(fullPetItemID[0], 1);
					player.getInventory().add(new InvItem(emptyPetItemID[0], 1));
					player.getActionSender().sendInventory();
					Npc petDragon = new Npc(player.getLocation(), petNpcID[0],  player.getUsername());
					petDragon.shouldRespawn = false;
					world.registerNpc(petDragon);
				}
			});
		}
	}
}</code></pre>
<p>InvUseOnNPC:</p>
<p><code>case 203: // Baby blue dragon
		    if (!itemId(new int[] { 1231 })) {
			owner.getActionSender().sendMessage("Nothing interesting happens.");
			return;
		    }
		    owner.setBusy(true);
		    affectedNpc.blockedBy(owner);
		    affectedNpc.resetPath();
		    showBubble();
		    owner.getActionSender().sendMessage("You attempt to put the baby blue dragon in the crystal.");
		    World.getWorld().getDelayedEventHandler().add(new ShortEvent(owner) {
			public void action() {
			    if (DataConversions.random(0, 4) != 0) {
				owner.getActionSender().sendMessage("You catch the dragon in the crystal.");
				owner.getInventory().remove(new InvItem(1231, 1));
				owner.getInventory().add(new InvItem(1222, 1));
				owner.getActionSender().sendInventory();
			    owner.setBusy(false);
				affectedNpc.unblock();
				world.unregisterNpc(affectedNpc);
				affectedNpc.remove();
				} else {
				owner.getActionSender().sendMessage("The baby blue dragon manages to get away from you!");
			    owner.setBusy(false);
				affectedNpc.unblock();
				}
			}
		    });
		    break;</code></p>
<p>InvActionHandler:</p>
<p><code>case 1222: // Red Crystal
						Pets.summonPet(player, item);
						break;</code></p>
<p>NPCLoc:</p>
<p><code>/**
    * Npc Owner
    */
	public String owner = null;
    public NPCLoc(int id, int startX, int startY, String owner) {
		this.id = id;
		this.startX = startX;
		this.startY = startY;
		this.owner = owner;
    }
	public String getOwner() {
      return owner;
	}</code></p>
<p>Npc:</p>
<p>[code]/**<br>
* Npc Owner<br>
*/		<br>
private String owner = null;<br>
public Npc(NPCLoc loc, String owners) {<br>
for (int i : Constants.GameServer.UNDEAD_NPCS) {<br>
if (loc.getId() == i) {<br>
this.undead = true;<br>
}<br>
}<br>
for (int i : Constants.GameServer.ARMOR_NPCS) {<br>
if (loc.getId() == i) {<br>
this.hasArmor = true;<br>
}<br>
}<br>
def = EntityHandler.getNpcDef(loc.getId());<br>
curHits = def.getHits();</p>
<pre><code>	this.loc = loc;
	this.owner = owners;
	super.setID(loc.getId());
	super.setLocation(Point.location(loc.startX(), loc.startY()), true);
	super.setCombatLevel(Formulae.getCombatLevel(def.getAtt(), def.getDef(), def.getStr(), def.getHits(), 0, 0, 0));
	if (this.loc.getId() == 189 || this.loc.getId() == 53) {
		this.def.aggressive = true;
	}
}
</code></pre>
<p>public Npc(Point location, int id, String owner) {<br>
this(new NPCLoc(id, location.getX(), location.getY(), owner));<br>
}<br>
public String getOwner() {<br>
return loc.owner;<br>
}[/code]</p>
<p>I have tried to use the setChasing method within the Npc class within the Pets class under the summonPet method as:</p>
<pre><code class="lang-auto"></code></pre>
<p>and I have also tried using the follow method for players:</p>
<pre><code class="lang-auto"></code></pre>
<p>Neither cause the NPC to follow the player around the map after it has been spawned. I am thinking that either there should be a follow event created or that there should be a NPC version of the player follow method created within the Player class. I am not sure how to write such an event and need some help.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447/1</link>
        <pubDate>Sun, 01 May 2011 21:57:35 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-393447-1</guid>
        <source url="https://forum.moparisthebest.com/t/npc-following-after-being-spawned/393447.rss">NPC following after being spawned</source>
      </item>
  </channel>
</rss>
