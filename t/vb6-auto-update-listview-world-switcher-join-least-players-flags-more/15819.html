<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/vb6-auto-update-listview-world-switcher-join-least-players-flags-more/15819 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 21:01:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[VB6] Auto-Update ListView World Switcher (Join least, Players, Flags + more!) - General Programming - moparisthebest.com</title>
    <meta name="description" content="Anywayz, I decided to start posting here on Mopars forum because Mopar owns all!!! xD But I&amp;#39;m only stupid enuf to make stuff in VB6 :frowning: 

Anyway, this is the source of an auto updating world switcher using ListVie&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="15819.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[VB6] Auto-Update ListView World Switcher (Join least, Players, Flags + more!)&#39;" href="15819.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://img79.imageshack.us/img79/4792/newbitmapimagero1.jpg" />
<meta property="og:image" content="http://img79.imageshack.us/img79/4792/newbitmapimagero1.jpg" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/vb6-auto-update-listview-world-switcher-join-least-players-flags-more/15819" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/vb6-auto-update-listview-world-switcher-join-least-players-flags-more/15819" />
<meta property="og:title" content="[VB6] Auto-Update ListView World Switcher (Join least, Players, Flags + more!)" />
<meta name="twitter:title" content="[VB6] Auto-Update ListView World Switcher (Join least, Players, Flags + more!)" />
<meta property="og:description" content="Anywayz, I decided to start posting here on Mopars forum because Mopar owns all!!! xD But Iâ€™m only stupid enuf to make stuff in VB6 ðŸ˜¦  Anyway, this is the source of an auto updating world switcher using ListView. It is well commented and you can probably learn somethings from it xD    Download at:  http://uppit.com/0hKg  Features:  -&gt; ListView with World Number, Players, URL, Type and Location  -&gt; Least Players option (Automatically join the lowest population world)  -&gt; Join World By Nu..." />
<meta name="twitter:description" content="Anywayz, I decided to start posting here on Mopars forum because Mopar owns all!!! xD But Iâ€™m only stupid enuf to make stuff in VB6 ðŸ˜¦  Anyway, this is the source of an auto updating world switcher using ListView. It is well commented and you can probably learn somethings from it xD    Download at:  http://uppit.com/0hKg  Features:  -&gt; ListView with World Number, Players, URL, Type and Location  -&gt; Least Players option (Automatically join the lowest population world)  -&gt; Join World By Nu..." />
<meta property="article:published_time" content="2006-09-23T05:44:36+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="15819.html">[VB6] Auto-Update ListView World Switcher (Join least, Players, Flags + more!)</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Sap-2.html'><span itemprop='name'>Sap</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-09-23T05:44:36Z'>
            <time itemprop='dateModified' datetime='2016-07-29T22:13:29Z' class='post-time'>
              July 29, 2016, 10:13pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Anywayz, I decided to start posting here on Mopars forum because Mopar owns all!!! xD But Iâ€™m only stupid enuf to make stuff in VB6 <img src="../../images/emoji/twitter/frowningc164.png?v=9" title=":frowning:" class="emoji" alt=":frowning:"></p>
<p>Anyway, this is the source of an auto updating world switcher using ListView. It is well commented and you can probably learn somethings from it xD</p>
<p><img src="http://img79.imageshack.us/img79/4792/newbitmapimagero1.jpg" alt width="" height=""></p>
<p><span class="bbcode-b">Download at:<br>
<a href="http://uppit.com/0hKg" data-bbcode="true" rel="nofollow noopener">http://uppit.com/0hKg</a></span></p>
<p>Features:</p>
<p>-&gt; ListView with World Number, Players, URL, Type and Location<br>
-&gt; Least Players option (Automatically join the lowest population world)<br>
-&gt; Join World By Number (Type in a world number and join!)<br>
-&gt; Client that loads Runescape using StealRS2<br>
-&gt; Auto Updates with new RS Worlds<br>
-&gt; Auto Updates Flag Picture. If in a new country, it uses a manual flag.</p>
<p>Cons (Go make them yourself lol):<br>
-&gt; Offline worlds appear as Full<br>
-&gt; No member/free sorting<br>
-&gt; Full worlds have this | line thingy. Sometimes you can only split to a certain extent <img src="../../images/emoji/twitter/confusedc164.png?v=9" title=":confused:" class="emoji" alt=":confused:"></p>
<p>Sample Code (xD):</p>
<p>[code]Private Sub cmdClick_Click()<br>
ListView1.ColumnHeaders.Clear 'Reset the ListView<br>
ListView1.ListItems.Clear 'Reset the listview items</p>
<pre><code>'Column = Every column in ListView. Row = Every row in ListView
Dim Column As ColumnHeader, Row As ListItem

'HTML = HTML Code of the world picking page.
'SplitSec() = The array that contains splitted sections of strings
'rSec = The variable that contains temporary strings needed
'nStart = The number that indicates where we should start searching (to
'		 avoid reading previous things again)
'Flag = The temporary variable that holds the current flag name
'NotURL = The temporary boolean that tells the code after if a world
'		 is offline or not

Dim HTML As String, splitSec() As String, rSec As String, nStart As Long, _
Flag As String, NotURL As Boolean

ListView1.View = lvwReport 'Sets listview to a row/column style
'ListView1.FullRowSelect = True 'When you select a world, it highlights the whole line

'Store the HTML code of the world select page
HTML = Inet1.OpenURL( _
"http://www.runescape.com/lang/en/aff/runescape/serverlist.ws?plugin=0&amp;lores.x=156&amp;lores.y=92")

'Now this part's just confusing. Don't bother if you're a newb :P

'Finds "&amp;nbsp;Type" and changes HTML into what's after that
splitSec() = Split(HTML, "&amp;nbsp;Type")
HTML = splitSec(1)
nStart = 1

'ReDim Worlds(0 To 0)

'Adds each of the four columns to ListView
With ListView1.ColumnHeaders
	Set Column = .Add(, , "Name")
	Set Column = .Add(, , "Type")
	Set Column = .Add(, , "Location", 134)
	Set Column = .Add(, , "Players")
	Set Column = .Add(, , "URL", 0) 'Width: 0 to make it invisible
End With

'Loops through all the worlds
Do
	
	'Boolean that tells us if a world's full or not because
	'full worlds/offline worlds have a different HTML layout
	
	NotURL = False 'Right now, we are assuming the world is not full/offline
	
   'ReDim Worlds(0 To UBound(Worlds) + 1) 'Increase the array of worlds
	
	'Ok, you won't understand the following unless you know how to split.
	'There's no way of just writing things down. It's based on experimenting..
	
	'Basically, there's the same layout of HTML code for each world.
	'So we find unique phrases in the code and use those phrases
	'as a base area to locate other information such as world numbers etc.
	
	'Splitting Functions Used: InStr, Mid, Split
	
	'InStr = Returns a number that tells you where a string is.. inside
	'another longer string.
	
	'Mid = Returns a string inside another longer string
	'based on how long the string was and where
	
	'Split = Takes a string and splits it in half based on a delimiter.
	'Then it stores both halves separately in an array
	
	'Not gonna write a tutorial here, so go research those functions..
	'or... go figure :D

	'The following is based on experimenting.. and won't be explained.
	
	'-&gt; Check if this is the end of the HTML code
		If InStr(nStart, HTML, "flag", vbTextCompare) = 0 Then Exit Do
		
	'-&gt; Find flag word (a word that represents what flag picture to show)
		rSec = Mid(HTML, InStr(nStart, HTML, "&lt;/a&gt; &lt;/td&gt;", vbTextCompare) + 30, 30)
		splitSec() = Split(rSec, """&gt;")
		splitSec() = Split(splitSec(0), "class=""")
		Flag = splitSec(1)
		
	'-&gt; Find world number
		rSec = Mid(HTML, InStr(nStart, HTML, "World ", vbTextCompare) + 6, 15)
		splitSec() = Split(rSec, "&lt;/a&gt; &lt;/td&gt;")
		
		'If not found (which means the world is full/offline)...
		If UBound(splitSec) = 0 Then
			splitSec() = Split(rSec, "&lt;") 'Find it differently
			NotURL = True 'NotURL becomes true to tell the code below
						  'to find the things differently
		End If
		
		'Add world to listview based on the name of the flag in the HTML.
		'The flags appear on the ListView because they are..
		'1. Added to the ImageList control in the Form_Intialize() sub
		'2. The ImageList is added to the ListView thru the Property Pages (Click ListView &gt; Custom..)
		'3. The ListView can now use the ImageList pictures as icons!
		
		Select Case Flag
			Case "usflag"
				Set Row = ListView1.ListItems.Add(, , _
				"World " &amp; splitSec(0), 1, 1)
			Case "ukflag"
				Set Row = ListView1.ListItems.Add(, , _
				"World " &amp; splitSec(0), 2, 2)
			Case "caflag"
				 Set Row = ListView1.ListItems.Add(, , _
				"World " &amp; splitSec(0), 3, 3)
			Case "sweflag"
				Set Row = ListView1.ListItems.Add(, , _
				"World " &amp; splitSec(0), 4, 4)
			Case "auflag"
				Set Row = ListView1.ListItems.Add(, , _
				"World " &amp; splitSec(0), 5, 5)
			Case "nlflag"
				Set Row = ListView1.ListItems.Add(, , _
				"World " &amp; splitSec(0), 6, 6)
			Case Else
				Set Row = ListView1.ListItems.Add(, , _
				"World " &amp; splitSec(0), 7, 7)
		End Select
		
		'Worlds(UBound(Worlds)).WorldNumber = CInt(splitSec(0))
	
	'-&gt; Find URL and store into listview
		
		'If the world is full/offline
		If NotURL = True Then
			Row.SubItems(4) = "FULL"
		Else
			rSec = Mid(HTML, InStr(nStart, HTML, "&lt;a href=""", vbTextCompare) + 9, 95)
			splitSec() = Split(rSec, """&gt;World ")
			
			Row.SubItems(4) = splitSec(0)
		'Worlds(UBound(Worlds)).URL = splitSec(0)
		End If
		
	'-&gt; Find if it's a free world of a member and add to ListView
		rSec = Mid(HTML, InStr(nStart, HTML, "class=""", vbTextCompare) + 23, 8)
		splitSec() = Split(rSec, """")
		
		If splitSec(0) = "free" Then
			Row.SubItems(1) = "Free"
		ElseIf splitSec(0) = "members" Then
			Row.SubItems(1) = "Members"
		End If
		
		'If splitSec(0) = "free" Then Worlds(UBound(Worlds)).IsFree = True
		
	'-&gt; Find location and add to ListView
		
		rSec = Mid(HTML, InStr(nStart, HTML, "flag""&gt;", vbTextCompare) + 6, 18)
		splitSec() = Split(rSec, "&lt;/td&gt;")
		
		Row.SubItems(2) = splitSec(0)
		
		'Add to array
		'Worlds(UBound(Worlds)).Location = splitSec(0)
		
	'-&gt; Find players and add to ListView
		
		'If the world is offline/full, make the label "FULL"
		If NotURL = True Then
			Row.SubItems(3) = "FULL"
		Else 'If the world isn't offline/full then find the player number
			rSec = Mid(HTML, InStr(nStart, HTML, "&lt;/a&gt; &lt;/td&gt;", vbTextCompare) + 15, 14)
			splitSec() = Split(rSec, " Players")
			
			Row.SubItems(3) = CInt(splitSec(0))
		
		'Worlds(UBound(Worlds)).Players = splitSec(0)
		End If
		
	'Go on to the next world.
	'This will search for a special string in the HTML that represents
	'the end of the code for each world. The following will find where
	'that string is.. And store it inside nStart. When this goes on to
	'the next world, it starts searching on nStart. Or else this will
	'just keep adding the same, previous world for infinite years until
	'the world blows up and this computer is gone :P
		
		Dim rtNum As Long
		rtNum = InStr(nStart, HTML, "Free&lt;/td&gt;", vbTextCompare)
		
		If rtNum = 0 Then
			rtNum = InStr(nStart, HTML, "Members&lt;/td&gt;", vbTextCompare)
			If rtNum = 0 Then
				MsgBox "WTF!" 'lol, is this happens. Jagex changed da code.
			Else
				nStart = InStr(nStart, HTML, "Members&lt;/td&gt;", vbTextCompare) + 12
			End If
		Else
			nStart = InStr(nStart, HTML, "Free&lt;/td&gt;", vbTextCompare) + 12
		End If
		
Loop
</code></pre>
<p>End Sub[/code]</p>
      </div>

      <meta itemprop='headline' content='[VB6] Auto-Update ListView World Switcher (Join least, Players, Flags + more!)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Freddy1990.html'><span itemprop='name'>Freddy1990</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-09-24T13:15:24Z'>
            <time itemprop='dateModified' datetime='2016-07-29T22:16:06Z' class='post-time'>
              July 29, 2016, 10:16pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This looks alot like a part of my delphi project <img src="../../images/emoji/twitter/slight_smilec164.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Good job tough</p>
      </div>

      <meta itemprop='headline' content='[VB6] Auto-Update ListView World Switcher (Join least, Players, Flags + more!)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/papetowe.html'><span itemprop='name'>papetowe</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-09-24T19:22:25Z'>
            <time itemprop='dateModified' datetime='2016-07-29T22:16:24Z' class='post-time'>
              July 29, 2016, 10:16pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Nice job, visual basic is also the only thing i knowâ€¦</p>
      </div>

      <meta itemprop='headline' content='[VB6] Auto-Update ListView World Switcher (Join least, Players, Flags + more!)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/vb6-auto-update-listview-world-switcher-join-least-players-flags-more/15819 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 21:01:14 GMT -->
</html>
