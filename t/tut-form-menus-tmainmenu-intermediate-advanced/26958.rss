<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[Tut]Form menus (TMainMenu) (Intermediate-Advanced)</title>
    <link>https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958</link>
    <description>In this tutorial we will learn how to add and use the TMainMenu component in SCAR forms.
We begin with a basic script that shows a form:
[code]program MenuTest;

var
  frmDesign: TForm;

procedure InitForm;
begin
  frmDesign := CreateForm;
  frmDesign.Left := 259;
  frmDesign.Top := 132;
  frmDesign.Width := 354;
  frmDesign.Height := 254;
  frmDesign.Caption := &#39;Menu Testing Form&#39;;
  frmDesign.Color := clBtnFace;
  frmDesign.Font.Color := clWindowText;
  frmDesign.Font.Height := -11;
  frmDesign.Font.Name := &#39;MS Sans Serif&#39;;
  frmDesign.Font.Style := [];
  frmDesign.Visible := False;
  frmDesign.PixelsPerInch := 96;
end;

procedure SafeInitForm;
var
  v: TVariantArray;
begin
  SetArrayLength(v, 0);
  ThreadSafeCall(&#39;InitForm&#39;, v);
end;

procedure ShowFormModal;
begin
  frmDesign.ShowModal;
end;

procedure SafeShowFormModal;
var
  v: TVariantArray;
begin
  SetArrayLength(v, 0);
  ThreadSafeCall(&#39;ShowFormModal&#39;, v);
end;

begin
  SafeInitForm;
  SafeShowFormModal;
end.[/code]
[img]http://stuart.existhost.com/freddy/tutimages/menu1.PNG[/img]

Now the menu we are going to build is going to look like this:
[code](Menu1)(Menu2)(Menu3)[/code]
We&#39;re going to give menu1 a submenu and that we give another submenu, menu2 we elso give a submenu.
First we are going to add out 3 menus, to do that we need a menu bar first, so we add the following to the variable declaration:
[code]mnu: TMainMenu;[/code]
Now we add this to our form by adding the following code to the InitForm procedure which will add the menubar to the form:
[code]mnu := TMainMenu.Create(frmDesign);[/code]
So far we have:
[code]program MenuTest;

var
  frmDesign: TForm;
  mnu: TMainMenu;

procedure InitForm;
begin
  frmDesign := CreateForm;
  frmDesign.Left := 259;
  frmDesign.Top := 132;
  frmDesign.Width := 354;
  frmDesign.Height := 254;
  frmDesign.Caption := &#39;Menu Testing Form&#39;;
  frmDesign.Color := clBtnFace;
  frmDesign.Font.Color := clWindowText;
  frmDesign.Font.Height := -11;
  frmDesign.Font.Name := &#39;MS Sans Serif&#39;;
  frmDesign.Font.Style := [];
  frmDesign.Visible := False;
  frmDesign.PixelsPerInch := 96;
  
  mnu := TMainMenu.Create(frmDesign);
end;

procedure SafeInitForm;
var
  v: TVariantArray;
begin
  SetArrayLength(v, 0);
  ThreadSafeCall(&#39;InitForm&#39;, v);
end;

procedure ShowFormModal;
begin
  frmDesign.ShowModal;
end;

procedure SafeShowFormModal;
var
  v: TVariantArray;
begin
  SetArrayLength(v, 0);
  ThreadSafeCall(&#39;ShowFormModal&#39;, v);
end;

begin
  SafeInitForm;
  SafeShowFormModal;
end.[/code]

If you wonder why you don&#39;t see anything special when running this, thats because there aren&#39;t any items on the bar so it won&#39;t display.
So we&#39;ll add some!

First we add the items to the variable declaration:
[code]mnuMenu1, mnuMenu2, mnuMenu3: TMenuItem;[/code]

Before we can add these items to the menubar we have to create them, we do by adding the following lines to the initform procedure:
[code]mnuMenu1 := TMenuItem.Create(frmDesign);
mnuMenu2 := TMenuItem.Create(frmDesign);
mnuMenu3 := TMenuItem.Create(frmDesign);[/code]
This will create the items inside the form.

Of course we have to add some text to the items before adding them, we do this by putting text into their Caption property:
[code]mnuMenu1.Caption := &#39;Menu1&#39;;
mnuMenu2.Caption := &#39;Menu2&#39;;
mnuMenu3.Caption := &#39;Menu3&#39;;[/code]

Now we add them to the menubar by putting the following code in the initform procedure:
[code]mnu.Items.Add(mnuMenu1);
mnu.Items.Add(mnuMenu2);
mnu.Items.Add(mnuMenu3);[/code]
As you can propably see, this adds the menuitems to the itemslist of the menubar.

We now have the following script:
[code]program MenuTest;

var
  frmDesign: TForm;
  mnu: TMainMenu;
  mnuMenu1, mnuMenu2, mnuMenu3: TMenuItem;

procedure InitForm;
begin
  frmDesign := CreateForm;
  frmDesign.Left := 259;
  frmDesign.Top := 132;
  frmDesign.Width := 354;
  frmDesign.Height := 254;
  frmDesign.Caption := &#39;Menu Testing Form&#39;;
  frmDesign.Color := clBtnFace;
  frmDesign.Font.Color := clWindowText;
  frmDesign.Font.Height := -11;
  frmDesign.Font.Name := &#39;MS Sans Serif&#39;;
  frmDesign.Font.Style := [];
  frmDesign.Visible := False;
  frmDesign.PixelsPerInch := 96;
  
  mnu := TMainMenu.Create(frmDesign);
  mnuMenu1 := TMenuItem.Create(frmDesign);
  mnuMenu1.Caption := &#39;Menu1&#39;;
  mnu.Items.Add(mnuMenu1);
  mnuMenu2 := TMenuItem.Create(frmDesign);
  mnuMenu2.Caption := &#39;Menu2&#39;;
  mnu.Items.Add(mnuMenu2);
  mnuMenu3 := TMenuItem.Create(frmDesign);
  mnuMenu3.Caption := &#39;Menu3&#39;;
  mnu.Items.Add(mnuMenu3);
end;

procedure SafeInitForm;
var
  v: TVariantArray;
begin
  setarraylength(v, 0);
  ThreadSafeCall(&#39;InitForm&#39;, v);
end;

procedure ShowFormModal;
begin
  frmDesign.ShowModal;
end;

procedure SafeShowFormModal;
var
  v: TVariantArray;
begin
  setarraylength(v, 0);
  ThreadSafeCall(&#39;ShowFormModal&#39;, v);
end;

begin
  SafeInitForm;
  SafeShowFormModal;
  FreeForm(frmDesign);
end.[/code]
[img]http://stuart.existhost.com/freddy/tutimages/menu2.PNG[/img]

Now we run our script and we see that a menu bar with our 3 items has appeared at the top of the form.

We were going to add some subitems, we create them like our other menuitems with the variabledeclarations:
[code]mnuSub1, mnuSub2, mnuSub3: TMenuItem;[/code]

And we add the following code to the initform procedure to create the items and give them some text:
[code]mnuSub1 := TMenuItem.Create(frmDesign);
mnuSub1.Caption := &#39;Sub1&#39;;
mnuSub2 := TMenuItem.Create(frmDesign);
mnuSub2.Caption := &#39;Sub2&#39;;
mnuSub3 := TMenuItem.Create(frmDesign);
mnuSub3.Caption := &#39;Sub3&#39;;[/code]

Adding the subitems to the menu is a bit different than adding the main items. Each main item is given an indox in the items list, like an array, item 1 would have index 0, item 2,index 1 and item 3,index 2.

to add a subitem to an item we use the item&#39;s property &#39;items&#39; with the index we want to add an item to using the add property, for the first item we do this as followed:
[code]mnu.Items.Items[0].Add(mnuSub1);[/code]
The subitem has been given index 0 in the itemslist of the first menuitem, so we do the same with the subitem for adding the 2nd subitem as it&#39;s subitem with the following code:
[code]mnu.Items.Items[0].Items[0].Add(mnuSub2);[/code]
Finally we add the last subitem to the second menuitem:
[code]mnu.Items.Items[2].Add(mnuSub3);[/code]

This results in the following script:
[code]program MenuTest;

var
  frmDesign: TForm;
  mnu: TMainMenu;
  mnuMenu1, mnuMenu2, mnuMenu3: TMenuItem;
  mnuSub1, mnuSub2, mnuSub3: TMenuItem;

procedure InitForm;
begin
  frmDesign := CreateForm;
  frmDesign.Left := 259;
  frmDesign.Top := 132;
  frmDesign.Width := 354;
  frmDesign.Height := 254;
  frmDesign.Caption := &#39;Menu Testing Form&#39;;
  frmDesign.Color := clBtnFace;
  frmDesign.Font.Color := clWindowText;
  frmDesign.Font.Height := -11;
  frmDesign.Font.Name := &#39;MS Sans Serif&#39;;
  frmDesign.Font.Style := [];
  frmDesign.Visible := False;
  frmDesign.PixelsPerInch := 96;
  
  mnu := TMainMenu.Create(frmDesign);
  mnuMenu1 := TMenuItem.Create(frmDesign);
  mnuMenu1.Caption := &#39;Menu1&#39;;
  mnu.Items.Add(mnuMenu1);
  mnuMenu2 := TMenuItem.Create(frmDesign);
  mnuMenu2.Caption := &#39;Menu2&#39;;
  mnu.Items.Add(mnuMenu2);
  mnuMenu3 := TMenuItem.Create(frmDesign);
  mnuMenu3.Caption := &#39;Menu3&#39;;
  mnu.Items.Add(mnuMenu3);
  
  mnuSub1 := TMenuItem.Create(frmDesign);
  mnuSub1.Caption := &#39;Sub1&#39;;
  mnu.Items.Items[0].Add(mnuSub1);
  mnuSub2 := TMenuItem.Create(frmDesign);
  mnuSub2.Caption := &#39;Sub2&#39;;
  mnu.Items.Items[0].Items[0].Add(mnuSub2);
  mnuSub3 := TMenuItem.Create(frmDesign);
  mnuSub3.Caption := &#39;Sub3&#39;;
  mnu.Items.Items[1].Add(mnuSub3);
end;

procedure SafeInitForm;
var
  v: TVariantArray;
begin
  setarraylength(v, 0);
  ThreadSafeCall(&#39;InitForm&#39;, v);
end;

procedure ShowFormModal;
begin
  frmDesign.ShowModal;
end;

procedure SafeShowFormModal;
var
  v: TVariantArray;
begin
  setarraylength(v, 0);
  ThreadSafeCall(&#39;ShowFormModal&#39;, v);
end;

begin
  SafeInitForm;
  SafeShowFormModal;
  FreeForm(frmDesign);
end.[/code]
[img]http://stuart.existhost.com/freddy/tutimages/menu3.PNG[/img]

For adding events after clicking an item we just use the onclick property like for buttons or other components:
[code]program MenuTest;

var
  frmDesign: TForm;
  mnu: TMainMenu;
  mnuMenu1, mnuMenu2, mnuMenu3: TMenuItem;
  mnuSub1, mnuSub2, mnuSub3: TMenuItem;
  
procedure Sub2Click(sender: TObject);
begin
  WriteLn(&#39;You clicked mnuSub2.&#39;);
end;

procedure Sub3Click(sender: TObject);
begin
  WriteLn(&#39;You clicked mnuSub3.&#39;);
end;

procedure Mnu3Click(sender: TObject);
begin
  WriteLn(&#39;You clicked mnuMenu3.&#39;);
end;

procedure InitForm;
begin
  frmDesign := CreateForm;
  frmDesign.Left := 259;
  frmDesign.Top := 132;
  frmDesign.Width := 354;
  frmDesign.Height := 254;
  frmDesign.Caption := &#39;Menu Testing Form&#39;;
  frmDesign.Color := clBtnFace;
  frmDesign.Font.Color := clWindowText;
  frmDesign.Font.Height := -11;
  frmDesign.Font.Name := &#39;MS Sans Serif&#39;;
  frmDesign.Font.Style := [];
  frmDesign.Visible := False;
  frmDesign.PixelsPerInch := 96;
  
  mnu := TMainMenu.Create(frmDesign);
  mnuMenu1 := TMenuItem.Create(frmDesign);
  mnuMenu1.Caption := &#39;Menu1&#39;;
  mnu.Items.Add(mnuMenu1);
  mnuMenu2 := TMenuItem.Create(frmDesign);
  mnuMenu2.Caption := &#39;Menu2&#39;;
  mnu.Items.Add(mnuMenu2);
  mnuMenu3 := TMenuItem.Create(frmDesign);
  mnuMenu3.Caption := &#39;Menu3&#39;;
  mnuMenu3.OnClick := @Mnu3Click;
  mnu.Items.Add(mnuMenu3);
  
  mnuSub1 := TMenuItem.Create(frmDesign);
  mnuSub1.Caption := &#39;Sub1&#39;;
  mnu.Items.Items[0].Add(mnuSub1);
  mnuSub2 := TMenuItem.Create(frmDesign);
  mnuSub2.Caption := &#39;Sub2&#39;;
  mnuSub2.OnClick := @Sub2Click;
  mnu.Items.Items[0].Items[0].Add(mnuSub2);
  mnuSub3 := TMenuItem.Create(frmDesign);
  mnuSub3.Caption := &#39;Sub3&#39;;
  mnuSub3.OnClick := @Sub3Click;
  mnu.Items.Items[1].Add(mnuSub3);
end;

procedure SafeInitForm;
var
  v: TVariantArray;
begin
  setarraylength(v, 0);
  ThreadSafeCall(&#39;InitForm&#39;, v);
end;

procedure ShowFormModal;
begin
  frmDesign.ShowModal;
end;

procedure SafeShowFormModal;
var
  v: TVariantArray;
begin
  setarraylength(v, 0);
  ThreadSafeCall(&#39;ShowFormModal&#39;, v);
end;

begin
  SafeInitForm;
  SafeShowFormModal;
  FreeForm(frmDesign);
end.[/code]

And that concludes this tutorial, have fun.</description>
    
    <lastBuildDate>Wed, 22 Nov 2006 02:53:13 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[Tut]Form menus (TMainMenu) (Intermediate-Advanced)</title>
        <dc:creator><![CDATA[@LaBo LaBo]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/labo">@LaBo</a> wrote:</p>
          <blockquote>
              <p>Great tutorial Freddy <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue_winking_eye.png?v=6" title=":stuck_out_tongue_winking_eye:" class="emoji" alt=":stuck_out_tongue_winking_eye:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958/4</link>
        <pubDate>Wed, 22 Nov 2006 02:53:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-26958-4</guid>
        <source url="https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958.rss">[Tut]Form menus (TMainMenu) (Intermediate-Advanced)</source>
      </item>
      <item>
        <title>[Tut]Form menus (TMainMenu) (Intermediate-Advanced)</title>
        <dc:creator><![CDATA[@Weibs Weibs]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/weibs">@Weibs</a> wrote:</p>
          <blockquote>
              <p>Awesome! I’m definitely using this from now on.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958/3</link>
        <pubDate>Mon, 20 Nov 2006 03:45:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-26958-3</guid>
        <source url="https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958.rss">[Tut]Form menus (TMainMenu) (Intermediate-Advanced)</source>
      </item>
      <item>
        <title>[Tut]Form menus (TMainMenu) (Intermediate-Advanced)</title>
        <dc:creator><![CDATA[@The_Un-Named The Un-Named]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/the_un-named">@The_Un-Named</a> wrote:</p>
          <blockquote>
              <p>Oh very, very nice Freddy!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958/2</link>
        <pubDate>Mon, 20 Nov 2006 00:59:35 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-26958-2</guid>
        <source url="https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958.rss">[Tut]Form menus (TMainMenu) (Intermediate-Advanced)</source>
      </item>
      <item>
        <title>[Tut]Form menus (TMainMenu) (Intermediate-Advanced)</title>
        <dc:creator><![CDATA[@Freddy1990 Freddy1990]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/freddy1990">@Freddy1990</a> wrote:</p>
          <blockquote>
              <p>In this tutorial we will learn how to add and use the TMainMenu component in SCAR forms.<br>
We begin with a basic script that shows a form:</p>
<p>[code]program MenuTest;</p>
<p>var<br>
frmDesign: TForm;</p>
<p>procedure InitForm;<br>
begin<br>
frmDesign := CreateForm;<br>
frmDesign.Left := 259;<br>
frmDesign.Top := 132;<br>
frmDesign.Width := 354;<br>
frmDesign.Height := 254;<br>
frmDesign.Caption := ‘Menu Testing Form’;<br>
frmDesign.Color := clBtnFace;<br>
frmDesign.Font.Color := clWindowText;<br>
frmDesign.Font.Height := -11;<br>
frmDesign.Font.Name := ‘MS Sans Serif’;<br>
frmDesign.Font.Style := [];<br>
frmDesign.Visible := False;<br>
frmDesign.PixelsPerInch := 96;<br>
end;</p>
<p>procedure SafeInitForm;<br>
var<br>
v: TVariantArray;<br>
begin<br>
SetArrayLength(v, 0);<br>
ThreadSafeCall(‘InitForm’, v);<br>
end;</p>
<p>procedure ShowFormModal;<br>
begin<br>
frmDesign.ShowModal;<br>
end;</p>
<p>procedure SafeShowFormModal;<br>
var<br>
v: TVariantArray;<br>
begin<br>
SetArrayLength(v, 0);<br>
ThreadSafeCall(‘ShowFormModal’, v);<br>
end;</p>
<p>begin<br>
SafeInitForm;<br>
SafeShowFormModal;<br>
end.[/code]<br>
<img src="http://stuart.existhost.com/freddy/tutimages/menu1.PNG" alt width="374" height="53"></p>
<p>Now the menu we are going to build is going to look like this:</p>
<pre><code class="lang-auto">(Menu1)(Menu2)(Menu3)</code></pre>
<p>We’re going to give menu1 a submenu and that we give another submenu, menu2 we elso give a submenu.<br>
First we are going to add out 3 menus, to do that we need a menu bar first, so we add the following to the variable declaration:</p>
<pre><code class="lang-auto">mnu: TMainMenu;</code></pre>
<p>Now we add this to our form by adding the following code to the InitForm procedure which will add the menubar to the form:</p>
<pre><code class="lang-auto">mnu := TMainMenu.Create(frmDesign);</code></pre>
<p>So far we have:</p>
<p>[code]program MenuTest;</p>
<p>var<br>
frmDesign: TForm;<br>
mnu: TMainMenu;</p>
<p>procedure InitForm;<br>
begin<br>
frmDesign := CreateForm;<br>
frmDesign.Left := 259;<br>
frmDesign.Top := 132;<br>
frmDesign.Width := 354;<br>
frmDesign.Height := 254;<br>
frmDesign.Caption := ‘Menu Testing Form’;<br>
frmDesign.Color := clBtnFace;<br>
frmDesign.Font.Color := clWindowText;<br>
frmDesign.Font.Height := -11;<br>
frmDesign.Font.Name := ‘MS Sans Serif’;<br>
frmDesign.Font.Style := [];<br>
frmDesign.Visible := False;<br>
frmDesign.PixelsPerInch := 96;</p>
<p>mnu := TMainMenu.Create(frmDesign);<br>
end;</p>
<p>procedure SafeInitForm;<br>
var<br>
v: TVariantArray;<br>
begin<br>
SetArrayLength(v, 0);<br>
ThreadSafeCall(‘InitForm’, v);<br>
end;</p>
<p>procedure ShowFormModal;<br>
begin<br>
frmDesign.ShowModal;<br>
end;</p>
<p>procedure SafeShowFormModal;<br>
var<br>
v: TVariantArray;<br>
begin<br>
SetArrayLength(v, 0);<br>
ThreadSafeCall(‘ShowFormModal’, v);<br>
end;</p>
<p>begin<br>
SafeInitForm;<br>
SafeShowFormModal;<br>
end.[/code]</p>
<p>If you wonder why you don’t see anything special when running this, thats because there aren’t any items on the bar so it won’t display.<br>
So we’ll add some!</p>
<p>First we add the items to the variable declaration:</p>
<pre><code class="lang-auto">mnuMenu1, mnuMenu2, mnuMenu3: TMenuItem;</code></pre>
<p>Before we can add these items to the menubar we have to create them, we do by adding the following lines to the initform procedure:</p>
<p><code>mnuMenu1 := TMenuItem.Create(frmDesign);
mnuMenu2 := TMenuItem.Create(frmDesign);
mnuMenu3 := TMenuItem.Create(frmDesign);</code><br>
This will create the items inside the form.</p>
<p>Of course we have to add some text to the items before adding them, we do this by putting text into their Caption property:</p>
<p><code>mnuMenu1.Caption := 'Menu1';
mnuMenu2.Caption := 'Menu2';
mnuMenu3.Caption := 'Menu3';</code></p>
<p>Now we add them to the menubar by putting the following code in the initform procedure:</p>
<p><code>mnu.Items.Add(mnuMenu1);
mnu.Items.Add(mnuMenu2);
mnu.Items.Add(mnuMenu3);</code><br>
As you can propably see, this adds the menuitems to the itemslist of the menubar.</p>
<p>We now have the following script:</p>
<p>[code]program MenuTest;</p>
<p>var<br>
frmDesign: TForm;<br>
mnu: TMainMenu;<br>
mnuMenu1, mnuMenu2, mnuMenu3: TMenuItem;</p>
<p>procedure InitForm;<br>
begin<br>
frmDesign := CreateForm;<br>
frmDesign.Left := 259;<br>
frmDesign.Top := 132;<br>
frmDesign.Width := 354;<br>
frmDesign.Height := 254;<br>
frmDesign.Caption := ‘Menu Testing Form’;<br>
frmDesign.Color := clBtnFace;<br>
frmDesign.Font.Color := clWindowText;<br>
frmDesign.Font.Height := -11;<br>
frmDesign.Font.Name := ‘MS Sans Serif’;<br>
frmDesign.Font.Style := [];<br>
frmDesign.Visible := False;<br>
frmDesign.PixelsPerInch := 96;</p>
<p>mnu := TMainMenu.Create(frmDesign);<br>
mnuMenu1 := TMenuItem.Create(frmDesign);<br>
mnuMenu1.Caption := ‘Menu1’;<br>
mnu.Items.Add(mnuMenu1);<br>
mnuMenu2 := TMenuItem.Create(frmDesign);<br>
mnuMenu2.Caption := ‘Menu2’;<br>
mnu.Items.Add(mnuMenu2);<br>
mnuMenu3 := TMenuItem.Create(frmDesign);<br>
mnuMenu3.Caption := ‘Menu3’;<br>
mnu.Items.Add(mnuMenu3);<br>
end;</p>
<p>procedure SafeInitForm;<br>
var<br>
v: TVariantArray;<br>
begin<br>
setarraylength(v, 0);<br>
ThreadSafeCall(‘InitForm’, v);<br>
end;</p>
<p>procedure ShowFormModal;<br>
begin<br>
frmDesign.ShowModal;<br>
end;</p>
<p>procedure SafeShowFormModal;<br>
var<br>
v: TVariantArray;<br>
begin<br>
setarraylength(v, 0);<br>
ThreadSafeCall(‘ShowFormModal’, v);<br>
end;</p>
<p>begin<br>
SafeInitForm;<br>
SafeShowFormModal;<br>
FreeForm(frmDesign);<br>
end.[/code]<br>
<img src="http://stuart.existhost.com/freddy/tutimages/menu2.PNG" alt width="374" height="53"></p>
<p>Now we run our script and we see that a menu bar with our 3 items has appeared at the top of the form.</p>
<p>We were going to add some subitems, we create them like our other menuitems with the variabledeclarations:</p>
<pre><code class="lang-auto">mnuSub1, mnuSub2, mnuSub3: TMenuItem;</code></pre>
<p>And we add the following code to the initform procedure to create the items and give them some text:</p>
<p><code>mnuSub1 := TMenuItem.Create(frmDesign);
mnuSub1.Caption := 'Sub1';
mnuSub2 := TMenuItem.Create(frmDesign);
mnuSub2.Caption := 'Sub2';
mnuSub3 := TMenuItem.Create(frmDesign);
mnuSub3.Caption := 'Sub3';</code></p>
<p>Adding the subitems to the menu is a bit different than adding the main items. Each main item is given an indox in the items list, like an array, item 1 would have index 0, item 2,index 1 and item 3,index 2.</p>
<p>to add a subitem to an item we use the item’s property ‘items’ with the index we want to add an item to using the add property, for the first item we do this as followed:</p>
<pre><code class="lang-auto">mnu.Items.Items[0].Add(mnuSub1);</code></pre>
<p>The subitem has been given index 0 in the itemslist of the first menuitem, so we do the same with the subitem for adding the 2nd subitem as it’s subitem with the following code:</p>
<pre><code class="lang-auto">mnu.Items.Items[0].Items[0].Add(mnuSub2);</code></pre>
<p>Finally we add the last subitem to the second menuitem:</p>
<pre><code class="lang-auto">mnu.Items.Items[2].Add(mnuSub3);</code></pre>
<p>This results in the following script:</p>
<p>[code]program MenuTest;</p>
<p>var<br>
frmDesign: TForm;<br>
mnu: TMainMenu;<br>
mnuMenu1, mnuMenu2, mnuMenu3: TMenuItem;<br>
mnuSub1, mnuSub2, mnuSub3: TMenuItem;</p>
<p>procedure InitForm;<br>
begin<br>
frmDesign := CreateForm;<br>
frmDesign.Left := 259;<br>
frmDesign.Top := 132;<br>
frmDesign.Width := 354;<br>
frmDesign.Height := 254;<br>
frmDesign.Caption := ‘Menu Testing Form’;<br>
frmDesign.Color := clBtnFace;<br>
frmDesign.Font.Color := clWindowText;<br>
frmDesign.Font.Height := -11;<br>
frmDesign.Font.Name := ‘MS Sans Serif’;<br>
frmDesign.Font.Style := [];<br>
frmDesign.Visible := False;<br>
frmDesign.PixelsPerInch := 96;</p>
<p>mnu := TMainMenu.Create(frmDesign);<br>
mnuMenu1 := TMenuItem.Create(frmDesign);<br>
mnuMenu1.Caption := ‘Menu1’;<br>
mnu.Items.Add(mnuMenu1);<br>
mnuMenu2 := TMenuItem.Create(frmDesign);<br>
mnuMenu2.Caption := ‘Menu2’;<br>
mnu.Items.Add(mnuMenu2);<br>
mnuMenu3 := TMenuItem.Create(frmDesign);<br>
mnuMenu3.Caption := ‘Menu3’;<br>
mnu.Items.Add(mnuMenu3);</p>
<p>mnuSub1 := TMenuItem.Create(frmDesign);<br>
mnuSub1.Caption := ‘Sub1’;<br>
mnu.Items.Items[0].Add(mnuSub1);<br>
mnuSub2 := TMenuItem.Create(frmDesign);<br>
mnuSub2.Caption := ‘Sub2’;<br>
mnu.Items.Items[0].Items[0].Add(mnuSub2);<br>
mnuSub3 := TMenuItem.Create(frmDesign);<br>
mnuSub3.Caption := ‘Sub3’;<br>
mnu.Items.Items[1].Add(mnuSub3);<br>
end;</p>
<p>procedure SafeInitForm;<br>
var<br>
v: TVariantArray;<br>
begin<br>
setarraylength(v, 0);<br>
ThreadSafeCall(‘InitForm’, v);<br>
end;</p>
<p>procedure ShowFormModal;<br>
begin<br>
frmDesign.ShowModal;<br>
end;</p>
<p>procedure SafeShowFormModal;<br>
var<br>
v: TVariantArray;<br>
begin<br>
setarraylength(v, 0);<br>
ThreadSafeCall(‘ShowFormModal’, v);<br>
end;</p>
<p>begin<br>
SafeInitForm;<br>
SafeShowFormModal;<br>
FreeForm(frmDesign);<br>
end.[/code]<br>
<img src="http://stuart.existhost.com/freddy/tutimages/menu3.PNG" alt width="374" height="53"></p>
<p>For adding events after clicking an item we just use the onclick property like for buttons or other components:</p>
<p>[code]program MenuTest;</p>
<p>var<br>
frmDesign: TForm;<br>
mnu: TMainMenu;<br>
mnuMenu1, mnuMenu2, mnuMenu3: TMenuItem;<br>
mnuSub1, mnuSub2, mnuSub3: TMenuItem;</p>
<p>procedure Sub2Click(sender: TObject);<br>
begin<br>
WriteLn(‘You clicked mnuSub2.’);<br>
end;</p>
<p>procedure Sub3Click(sender: TObject);<br>
begin<br>
WriteLn(‘You clicked mnuSub3.’);<br>
end;</p>
<p>procedure Mnu3Click(sender: TObject);<br>
begin<br>
WriteLn(‘You clicked mnuMenu3.’);<br>
end;</p>
<p>procedure InitForm;<br>
begin<br>
frmDesign := CreateForm;<br>
frmDesign.Left := 259;<br>
frmDesign.Top := 132;<br>
frmDesign.Width := 354;<br>
frmDesign.Height := 254;<br>
frmDesign.Caption := ‘Menu Testing Form’;<br>
frmDesign.Color := clBtnFace;<br>
frmDesign.Font.Color := clWindowText;<br>
frmDesign.Font.Height := -11;<br>
frmDesign.Font.Name := ‘MS Sans Serif’;<br>
frmDesign.Font.Style := [];<br>
frmDesign.Visible := False;<br>
frmDesign.PixelsPerInch := 96;</p>
<p>mnu := TMainMenu.Create(frmDesign);<br>
mnuMenu1 := TMenuItem.Create(frmDesign);<br>
mnuMenu1.Caption := ‘Menu1’;<br>
mnu.Items.Add(mnuMenu1);<br>
mnuMenu2 := TMenuItem.Create(frmDesign);<br>
mnuMenu2.Caption := ‘Menu2’;<br>
mnu.Items.Add(mnuMenu2);<br>
mnuMenu3 := TMenuItem.Create(frmDesign);<br>
mnuMenu3.Caption := ‘Menu3’;<br>
mnuMenu3.OnClick := <span class="mention">@Mnu3Click</span>;<br>
mnu.Items.Add(mnuMenu3);</p>
<p>mnuSub1 := TMenuItem.Create(frmDesign);<br>
mnuSub1.Caption := ‘Sub1’;<br>
mnu.Items.Items[0].Add(mnuSub1);<br>
mnuSub2 := TMenuItem.Create(frmDesign);<br>
mnuSub2.Caption := ‘Sub2’;<br>
mnuSub2.OnClick := <span class="mention">@Sub2Click</span>;<br>
mnu.Items.Items[0].Items[0].Add(mnuSub2);<br>
mnuSub3 := TMenuItem.Create(frmDesign);<br>
mnuSub3.Caption := ‘Sub3’;<br>
mnuSub3.OnClick := <span class="mention">@Sub3Click</span>;<br>
mnu.Items.Items[1].Add(mnuSub3);<br>
end;</p>
<p>procedure SafeInitForm;<br>
var<br>
v: TVariantArray;<br>
begin<br>
setarraylength(v, 0);<br>
ThreadSafeCall(‘InitForm’, v);<br>
end;</p>
<p>procedure ShowFormModal;<br>
begin<br>
frmDesign.ShowModal;<br>
end;</p>
<p>procedure SafeShowFormModal;<br>
var<br>
v: TVariantArray;<br>
begin<br>
setarraylength(v, 0);<br>
ThreadSafeCall(‘ShowFormModal’, v);<br>
end;</p>
<p>begin<br>
SafeInitForm;<br>
SafeShowFormModal;<br>
FreeForm(frmDesign);<br>
end.[/code]</p>
<p>And that concludes this tutorial, have fun.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958/1</link>
        <pubDate>Mon, 20 Nov 2006 00:35:42 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-26958-1</guid>
        <source url="https://forum.moparisthebest.com/t/tut-form-menus-tmainmenu-intermediate-advanced/26958.rss">[Tut]Form menus (TMainMenu) (Intermediate-Advanced)</source>
      </item>
  </channel>
</rss>
