<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/streamloader-java/307287 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 07:02:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>StreamLoader.java - Runescape - moparisthebest.com</title>
    <meta name="description" content="package rs.stream;
public final class StreamLoader {
    public StreamLoader(byte abyte0[]) {
    Stream stream = new Stream(abyte0);
    int i = stream.read3Bytes();//length if uncompressed
    int j = stream.read3Byte&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="307287.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;StreamLoader.java&#39;" href="307287.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/streamloader-java/307287" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/streamloader-java/307287" />
<meta property="og:title" content="StreamLoader.java" />
<meta name="twitter:title" content="StreamLoader.java" />
<meta property="og:description" content="[code]package rs.stream;  public final class StreamLoader {  public StreamLoader(byte abyte0[]) {     Stream stream = new Stream(abyte0);     int i = stream.read3Bytes();//length if uncompressed     int j = stream.read3Bytes();//normal block length, same as abyte0.length - 6     if (j != i) {//i==j if isnt compressed, i!=j if it is compressed         byte abyte1[] = new byte[i];         Class13.method225(abyte1, i, abyte0, j, 6);//decompress the data?         aByteArray726 = abyte1;//decompresse..." />
<meta name="twitter:description" content="[code]package rs.stream;  public final class StreamLoader {  public StreamLoader(byte abyte0[]) {     Stream stream = new Stream(abyte0);     int i = stream.read3Bytes();//length if uncompressed     int j = stream.read3Bytes();//normal block length, same as abyte0.length - 6     if (j != i) {//i==j if isnt compressed, i!=j if it is compressed         byte abyte1[] = new byte[i];         Class13.method225(abyte1, i, abyte0, j, 6);//decompress the data?         aByteArray726 = abyte1;//decompresse..." />
<meta property="article:published_time" content="2009-10-09T17:57:38+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="307287.html">StreamLoader.java</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/light232.html'><span itemprop='name'>light232</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-09T17:57:38Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:37:34Z' class='post-time'>
              July 31, 2016, 11:37am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[code]package rs.stream;</p>
<p>public final class StreamLoader {</p>
<pre><code>public StreamLoader(byte abyte0[]) {
    Stream stream = new Stream(abyte0);
    int i = stream.read3Bytes();//length if uncompressed
    int j = stream.read3Bytes();//normal block length, same as abyte0.length - 6
    if (j != i) {//i==j if isnt compressed, i!=j if it is compressed
        byte abyte1[] = new byte[i];
        Class13.method225(abyte1, i, abyte0, j, 6);//decompress the data?
        aByteArray726 = abyte1;//decompressed
        stream = new Stream(aByteArray726);
        aBoolean732 = true;//is compressed
    } else {
        aByteArray726 = abyte0;
        aBoolean732 = false;//isnt compressed 
    }
    dataSize = stream.readUnsignedWord();
    anIntArray728 = new int[dataSize];//names?
    anIntArray729 = new int[dataSize];//lengths
    anIntArray730 = new int[dataSize];//end offsets
    anIntArray731 = new int[dataSize];//start offsets
    int k = stream.currentOffset + dataSize * 10;
    for (int l = 0; l &lt; dataSize; l++) {
        anIntArray728[l] = stream.readDWord();
        anIntArray729[l] = stream.read3Bytes();
        anIntArray730[l] = stream.read3Bytes();
        anIntArray731[l] = k;
        k += anIntArray730[l];
    }
}

public byte[] getDataForName(String s) {
    byte abyte0[] = null; //was a parameter
    int i = 0;
    s = s.toUpperCase();
    for (int j = 0; j &lt; s.length(); j++)
        i = (i * 61 + s.charAt(j)) - 32;

    for (int k = 0; k &lt; dataSize; k++)
        if (anIntArray728[k] == i) {
            if (abyte0 == null)
                abyte0 = new byte[anIntArray729[k]/*length of the requested data*/];
            if (!aBoolean732) {
				//requires decompression?
                Class13.method225(abyte0, anIntArray729[k], aByteArray726, anIntArray730[k], anIntArray731[k]);
            } else {
				//already decompressed?
                System.arraycopy(aByteArray726, anIntArray731[k], abyte0, 0, anIntArray729[k]);
            }
            return abyte0;
        }

    return null;
}

private final byte[] aByteArray726;
private final int dataSize;
private final int[] anIntArray728;
private final int[] anIntArray729;
private final int[] anIntArray730;
private final int[] anIntArray731;
private final boolean aBoolean732;
</code></pre>
<p>}<br>
[/code]<br>
from the packaged 317 client, is this a correct analysis?</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mod_taharok.html'><span itemprop='name'>mod_taharok</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-09T18:48:04Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:37:37Z' class='post-time'>
              July 31, 2016, 11:37am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>This is my refactored Archive.java from the 194 client. It’s no different from the one in the 317 client:</p>
<pre><code class="lang-auto">package com.jag.io;

import com.jag.util.BZ2Decompressor;

public final class Archive {

	public byte[] archivedData;
	public int entryCount;
	public int[] identifiers;
	public int[] entrySizes;
	public int[] compressedSizes;
	public int[] entryOffsets;

	public Archive(byte[] data) {
		unpack(data);
	}

	private void unpack(byte[] archive) {
		ByteBuffer buffer = new ByteBuffer(archive);

		int archiveSize = buffer.get3Bytes();
		int decompressedSize = buffer.get3Bytes();

		if (decompressedSize != archiveSize) {
			byte[] decompressed = new byte[archiveSize];
			BZ2Decompressor.decompress(archive, 6, archiveSize, decompressed, decompressedSize);
			archivedData = decompressed;
			buffer = new ByteBuffer(archivedData);
		} else archivedData = archive;

		entryCount = buffer.getShort();
		identifiers = new int[entryCount];
		entrySizes = new int[entryCount];
		compressedSizes = new int[entryCount];
		entryOffsets = new int[entryCount];

		int cumulatedLength = buffer.position + entryCount * 10;
		for (int i = 0; i &lt; entryCount; i++) {
			identifiers[i] = buffer.getInt();
			entrySizes[i] = buffer.get3Bytes();
			compressedSizes[i] = buffer.get3Bytes();
			entryOffsets[i] = cumulatedLength;
			cumulatedLength += compressedSizes[i];
		}
	}

	public byte[] getEntry(byte[] array, String name) {
		int identifier = 0;
		name = name.toUpperCase();
		for (int i = 0; i &lt; name.length(); i++)
			identifier = identifier * 61 + name.charAt(i) - 32;
		for (int i = 0; i &lt; entryCount; i++) {
			if (identifiers[i] == identifier) {
				if (array == null)
					array = new byte[entrySizes[i]];
				if (entrySizes[i] != compressedSizes[i])
					BZ2Decompressor.decompress(archivedData, entryOffsets[i], entrySizes[i],
							array, compressedSizes[i]);
				else for (int j = 0; j &lt; entrySizes[i]; j++)
					array[j] = archivedData[entryOffsets[i] + j];
				return array;
			}
		}
		return null;
	}
}</code></pre>
<p>I suppose naming is one’s preference. I used ‘identifiers’ whereas you used ‘names’, etc. In my opinion, most of your analysis is correct, yes.</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/light232.html'><span itemprop='name'>light232</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-09T19:04:14Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:37:38Z' class='post-time'>
              July 31, 2016, 11:37am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Taharok, post:2, topic:307287”]This is my refactored Archive.java from the 194 client. It’s no different from the one in the 317 client:</p>
<pre><code class="lang-auto">package com.jag.io;

import com.jag.util.BZ2Decompressor;

public final class Archive {

	public byte[] archivedData;
	public int entryCount;
	public int[] identifiers;
	public int[] entrySizes;
	public int[] compressedSizes;
	public int[] entryOffsets;

	public Archive(byte[] data) {
		unpack(data);
	}

	private void unpack(byte[] archive) {
		ByteBuffer buffer = new ByteBuffer(archive);

		int archiveSize = buffer.get3Bytes();
		int decompressedSize = buffer.get3Bytes();

		if (decompressedSize != archiveSize) {
			byte[] decompressed = new byte[archiveSize];
			BZ2Decompressor.decompress(archive, 6, archiveSize, decompressed, decompressedSize);
			archivedData = decompressed;
			buffer = new ByteBuffer(archivedData);
		} else archivedData = archive;

		entryCount = buffer.getShort();
		identifiers = new int[entryCount];
		entrySizes = new int[entryCount];
		compressedSizes = new int[entryCount];
		entryOffsets = new int[entryCount];

		int cumulatedLength = buffer.position + entryCount * 10;
		for (int i = 0; i &lt; entryCount; i++) {
			identifiers[i] = buffer.getInt();
			entrySizes[i] = buffer.get3Bytes();
			compressedSizes[i] = buffer.get3Bytes();
			entryOffsets[i] = cumulatedLength;
			cumulatedLength += compressedSizes[i];
		}
	}

	public byte[] getEntry(byte[] array, String name) {
		int identifier = 0;
		name = name.toUpperCase();
		for (int i = 0; i &lt; name.length(); i++)
			identifier = identifier * 61 + name.charAt(i) - 32;
		for (int i = 0; i &lt; entryCount; i++) {
			if (identifiers[i] == identifier) {
				if (array == null)
					array = new byte[entrySizes[i]];
				if (entrySizes[i] != compressedSizes[i])
					BZ2Decompressor.decompress(archivedData, entryOffsets[i], entrySizes[i],
							array, compressedSizes[i]);
				else for (int j = 0; j &lt; entrySizes[i]; j++)
					array[j] = archivedData[entryOffsets[i] + j];
				return array;
			}
		}
		return null;
	}
}</code></pre>
<p>I suppose naming is one’s preference. I used ‘identifiers’ whereas you used ‘names’, etc. In my opinion, most of your analysis is correct, yes.[/quote]<br>
alright thanks</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/system.html'><span itemprop='name'>system</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-09T20:48:53Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:37:49Z' class='post-time'>
              July 31, 2016, 11:37am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Taharok, post:2, topic:307287”]This is my refactored Archive.java from the 194 client. It’s no different from the one in the 317 client:</p>
<pre><code class="lang-auto">package com.jag.io;

import com.jag.util.BZ2Decompressor;

public final class Archive {

	public byte[] archivedData;
	public int entryCount;
	public int[] identifiers;
	public int[] entrySizes;
	public int[] compressedSizes;
	public int[] entryOffsets;

	public Archive(byte[] data) {
		unpack(data);
	}

	private void unpack(byte[] archive) {
		ByteBuffer buffer = new ByteBuffer(archive);

		int archiveSize = buffer.get3Bytes();
		int decompressedSize = buffer.get3Bytes();

		if (decompressedSize != archiveSize) {
			byte[] decompressed = new byte[archiveSize];
			BZ2Decompressor.decompress(archive, 6, archiveSize, decompressed, decompressedSize);
			archivedData = decompressed;
			buffer = new ByteBuffer(archivedData);
		} else archivedData = archive;

		entryCount = buffer.getShort();
		identifiers = new int[entryCount];
		entrySizes = new int[entryCount];
		compressedSizes = new int[entryCount];
		entryOffsets = new int[entryCount];

		int cumulatedLength = buffer.position + entryCount * 10;
		for (int i = 0; i &lt; entryCount; i++) {
			identifiers[i] = buffer.getInt();
			entrySizes[i] = buffer.get3Bytes();
			compressedSizes[i] = buffer.get3Bytes();
			entryOffsets[i] = cumulatedLength;
			cumulatedLength += compressedSizes[i];
		}
	}

	public byte[] getEntry(byte[] array, String name) {
		int identifier = 0;
		name = name.toUpperCase();
		for (int i = 0; i &lt; name.length(); i++)
			identifier = identifier * 61 + name.charAt(i) - 32;
		for (int i = 0; i &lt; entryCount; i++) {
			if (identifiers[i] == identifier) {
				if (array == null)
					array = new byte[entrySizes[i]];
				if (entrySizes[i] != compressedSizes[i])
					BZ2Decompressor.decompress(archivedData, entryOffsets[i], entrySizes[i],
							array, compressedSizes[i]);
				else for (int j = 0; j &lt; entrySizes[i]; j++)
					array[j] = archivedData[entryOffsets[i] + j];
				return array;
			}
		}
		return null;
	}
}</code></pre>
<p>I suppose naming is one’s preference. I used ‘identifiers’ whereas you used ‘names’, etc. In my opinion, most of your analysis is correct, yes.[/quote]<br>
IIRC, There is one small difference between the rs2 format and the rsc (194 atleast) format. The RSC implementation allowed for both compression as a whole, and compression of individual files. This could cause problems when loading RSC archives with the rs2 unpacker, as the rs2 one assumes if the archive isn’t compressed as a whole, then individual files will be compressed, which may not be the case.</p>
<p>See this fact highlighted here:<br>
317</p>
<pre><code class="lang-auto">                if (!aBoolean732) {
					//requires decompression?
                    Class13.method225(abyte0, anIntArray729[k], aByteArray726, anIntArray730[k], anIntArray731[k]);
                } else {
					//already decompressed?
                    System.arraycopy(aByteArray726, anIntArray731[k], abyte0, 0, anIntArray729[k]);
                }</code></pre>
<p>194</p>
<pre><code class="lang-auto">				if (entrySizes[i] != compressedSizes[i])
					BZ2Decompressor.decompress(archivedData, entryOffsets[i], entrySizes[i],
							array, compressedSizes[i]);
				else for (int j = 0; j &lt; entrySizes[i]; j++)
					array[j] = archivedData[entryOffsets[i] + j];</code></pre>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-09T21:41:53Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:37:54Z' class='post-time'>
              July 31, 2016, 11:37am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>thats a poor fucking name</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/light232.html'><span itemprop='name'>light232</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-09T22:32:30Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:37:57Z' class='post-time'>
              July 31, 2016, 11:37am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="5" data-topic="307287">
<div class="title">
<div class="quote-controls"></div>
 oksuper_:</div>
<blockquote>
<p>thats a poor fucking name</p>
</blockquote>
</aside>
<p>tell whoever refactored the client<br>
<a href="http://www.moparisthebest.com/downloads/srcPackaged.tar.gz" class="onebox" target="_blank" rel="nofollow noopener">http://www.moparisthebest.com/downloads/srcPackaged.tar.gz</a></p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mod_taharok.html'><span itemprop='name'>mod_taharok</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-10T00:22:56Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:38:05Z' class='post-time'>
              July 31, 2016, 11:38am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“AuraDevil, post:4, topic:307287”][quote author=Taharok link=topic=403439.msg2987627#msg2987627 date=1255114084]<br>
This is my refactored Archive.java from the 194 client. It’s no different from the one in the 317 client:</p>
<pre><code class="lang-auto">package com.jag.io;

import com.jag.util.BZ2Decompressor;

public final class Archive {

	public byte[] archivedData;
	public int entryCount;
	public int[] identifiers;
	public int[] entrySizes;
	public int[] compressedSizes;
	public int[] entryOffsets;

	public Archive(byte[] data) {
		unpack(data);
	}

	private void unpack(byte[] archive) {
		ByteBuffer buffer = new ByteBuffer(archive);

		int archiveSize = buffer.get3Bytes();
		int decompressedSize = buffer.get3Bytes();

		if (decompressedSize != archiveSize) {
			byte[] decompressed = new byte[archiveSize];
			BZ2Decompressor.decompress(archive, 6, archiveSize, decompressed, decompressedSize);
			archivedData = decompressed;
			buffer = new ByteBuffer(archivedData);
		} else archivedData = archive;

		entryCount = buffer.getShort();
		identifiers = new int[entryCount];
		entrySizes = new int[entryCount];
		compressedSizes = new int[entryCount];
		entryOffsets = new int[entryCount];

		int cumulatedLength = buffer.position + entryCount * 10;
		for (int i = 0; i &lt; entryCount; i++) {
			identifiers[i] = buffer.getInt();
			entrySizes[i] = buffer.get3Bytes();
			compressedSizes[i] = buffer.get3Bytes();
			entryOffsets[i] = cumulatedLength;
			cumulatedLength += compressedSizes[i];
		}
	}

	public byte[] getEntry(byte[] array, String name) {
		int identifier = 0;
		name = name.toUpperCase();
		for (int i = 0; i &lt; name.length(); i++)
			identifier = identifier * 61 + name.charAt(i) - 32;
		for (int i = 0; i &lt; entryCount; i++) {
			if (identifiers[i] == identifier) {
				if (array == null)
					array = new byte[entrySizes[i]];
				if (entrySizes[i] != compressedSizes[i])
					BZ2Decompressor.decompress(archivedData, entryOffsets[i], entrySizes[i],
							array, compressedSizes[i]);
				else for (int j = 0; j &lt; entrySizes[i]; j++)
					array[j] = archivedData[entryOffsets[i] + j];
				return array;
			}
		}
		return null;
	}
}</code></pre>
<p>I suppose naming is one’s preference. I used ‘identifiers’ whereas you used ‘names’, etc. In my opinion, most of your analysis is correct, yes.<br>
[/quote]<br>
IIRC, There is one small difference between the rs2 format and the rsc (194 atleast) format. The RSC implementation allowed for both compression as a whole, and compression of individual files. This could cause problems when loading RSC archives with the rs2 unpacker, as the rs2 one assumes if the archive isn’t compressed as a whole, then individual files will be compressed, which may not be the case.</p>
<p>See this fact highlighted here:<br>
317</p>
<pre><code class="lang-auto">                if (!aBoolean732) {
					//requires decompression?
                    Class13.method225(abyte0, anIntArray729[k], aByteArray726, anIntArray730[k], anIntArray731[k]);
                } else {
					//already decompressed?
                    System.arraycopy(aByteArray726, anIntArray731[k], abyte0, 0, anIntArray729[k]);
                }</code></pre>
<p>194</p>
<p><code>
				if (entrySizes[i] != compressedSizes[i])
					BZ2Decompressor.decompress(archivedData, entryOffsets[i], entrySizes[i],
							array, compressedSizes[i]);
				else for (int j = 0; j &lt; entrySizes[i]; j++)
					array[j] = archivedData[entryOffsets[i] + j];
</code>[/quote]</p>
<p>My 194 is the rs2 beta client.</p>
<p>[quote=“light232, post:6, topic:307287”][quote author=oksuper_ link=topic=403439.msg2987834#msg2987834 date=1255124513]<br>
thats a poor fucking name<br>
[/quote]<br>
tell whoever refactored the client<br>
<a href="http://www.moparisthebest.com/downloads/srcPackaged.tar.gz%5B/quote%5D" class="onebox" target="_blank" rel="nofollow noopener">http://www.moparisthebest.com/downloads/srcPackaged.tar.gz[/quote]</a></p>
<p>Mopar ran that deob through the aryan updater. All he did with it was remove all of the dummies.</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-10T00:47:58Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:38:09Z' class='post-time'>
              July 31, 2016, 11:38am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“light232, post:6, topic:307287”][quote author=oksuper_ link=topic=403439.msg2987834#msg2987834 date=1255124513]<br>
thats a poor fucking name<br>
[/quote]<br>
tell whoever refactored the client<br>
<a href="http://www.moparisthebest.com/downloads/srcPackaged.tar.gz%5B/quote%5D" class="onebox" target="_blank" rel="nofollow noopener">http://www.moparisthebest.com/downloads/srcPackaged.tar.gz[/quote]</a></p>
<p>done it before… it IS a poor fucking name; don’t blame the place you got the name from for how poor it is, blame yourself for not choosing a better name.</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/light232.html'><span itemprop='name'>light232</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-10T01:12:31Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:38:15Z' class='post-time'>
              July 31, 2016, 11:38am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“oksuper_, post:8, topic:307287”][quote author=light232 link=topic=403439.msg2987898#msg2987898 date=1255127550]</p>
<aside class="quote no-group">
<blockquote>
<p>thats a poor fucking name</p>
</blockquote>
</aside>
<p>tell whoever refactored the client<br>
<a href="http://www.moparisthebest.com/downloads/srcPackaged.tar.gz" class="onebox" target="_blank" rel="nofollow noopener">http://www.moparisthebest.com/downloads/srcPackaged.tar.gz</a><br>
[/quote]</p>
<p>done it before… it IS a poor fucking name; don’t blame the place you got the name from for how poor it is, blame yourself for not choosing a better name.[/quote]<br>
the client was downloaded from there about 10-12 minutes before i had posted this topic as a normal person could have guessed i was refactoring it, grow a dick then talk please it turns out alot better, cheers!</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/spankjava.html'><span itemprop='name'>spankjava</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-10T09:04:11Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:38:38Z' class='post-time'>
              July 31, 2016, 11:38am
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“light232, post:9, topic:307287”][quote author=oksuper_ link=topic=403439.msg2988054#msg2988054 date=1255135678]</p>
<aside class="quote no-group">
<blockquote>
<aside class="quote no-group">
<blockquote>
<p>thats a poor fucking name</p>
</blockquote>
</aside>
<p>tell whoever refactored the client<br>
<a href="http://www.moparisthebest.com/downloads/srcPackaged.tar.gz" rel="nofollow noopener">http://www.moparisthebest.com/downloads/srcPackaged.tar.gz</a></p>
</blockquote>
</aside>
<p>done it before… it IS a poor fucking name; don’t blame the place you got the name from for how poor it is, blame yourself for not choosing a better name.<br>
[/quote]<br>
the client was downloaded from there about 10-12 minutes before i had posted this topic as a normal person could have guessed i was refactoring it, grow a dick then talk please it turns out alot better, cheers![/quote]</p>
<p>what has growing a dick got anything.</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-10T13:25:28Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:38:52Z' class='post-time'>
              July 31, 2016, 11:38am
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“light232, post:9, topic:307287”]the client was downloaded from there about 10-12 minutes before i had posted this topic as a normal person could have guessed i was refactoring it, grow a dick then talk please it turns out alot better, cheers![/quote]i got adhd from reading this post</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Mopman.html'><span itemprop='name'>Mopman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-10T18:47:10Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:39:40Z' class='post-time'>
              July 31, 2016, 11:39am
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>naming, srs buisness</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/peterbjornx.html'><span itemprop='name'>peterbjornx</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-13T17:08:52Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:46:00Z' class='post-time'>
              July 31, 2016, 11:46am
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>yes, the person who renamed 317 (i guess that was mopar) did use a quite bad naming scheme</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lothy.html'><span itemprop='name'>lothy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-13T17:33:55Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:46:02Z' class='post-time'>
              July 31, 2016, 11:46am
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="12" data-topic="307287">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/mopman/40/33_1.svg" class="avatar"> Mopman:</div>
<blockquote>
<p>naming, srs buisness</p>
</blockquote>
</aside>
<p>Agreed. Naming is more important than you, me, even Morpheus.</p>
<p>:rolleyes:</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/moparisthebest.html'><span itemprop='name'>moparisthebest</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-10-13T18:01:56Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:46:04Z' class='post-time'>
              July 31, 2016, 11:46am
            </time>
        <span itemprop='position'>#15</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="13" data-topic="307287">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/peterbjornx/40/2671_1.png" class="avatar"> peterbjornx:</div>
<blockquote>
<p>yes, the person who renamed 317 (i guess that was mopar) did use a quite bad naming scheme</p>
</blockquote>
</aside>
<p>I renamed it, but I renamed it the same as philodespostos’ bytecode renamer did.</p>
      </div>

      <meta itemprop='headline' content='StreamLoader.java'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/streamloader-java/307287 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 07:02:19 GMT -->
</html>
