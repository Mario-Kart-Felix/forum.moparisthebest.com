<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/cracking-jagexs-hash-algorithms/534334 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 09:36:11 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Cracking Jagex&#39;s Hash Algorithms - Runescape - moparisthebest.com</title>
    <meta name="description" content="Was wondering if anyone had a better way to decode the file hash algorithm used by JAGeX in the years 2001-2004. 

I have two decode methods, however both have severe data loss. 

The encode method is [code=java]public s&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="534334.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Cracking Jagex&#39;s Hash Algorithms&#39;" href="534334.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/cracking-jagexs-hash-algorithms/534334" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/cracking-jagexs-hash-algorithms/534334" />
<meta property="og:title" content="Cracking Jagex&#39;s Hash Algorithms" />
<meta name="twitter:title" content="Cracking Jagex&#39;s Hash Algorithms" />
<meta property="og:description" content="Was wondering if anyone had a better way to decode the file hash algorithm used by JAGeX in the years 2001-2004.  I have two decode methods, however both have severe data loss.  The encode method is  [code=java]public static int encode(String file) {  int hash = 0;  file = file.toUpperCase();  	for(int i = 0; i &lt; file.length(); i++) { 		hash = (hash * 61 + file.charAt(i)) - 32; 	} 	return hash; }[/code]  1st attempt to decode  [code=java]public static String decode(int hash) {  long realHash = (..." />
<meta name="twitter:description" content="Was wondering if anyone had a better way to decode the file hash algorithm used by JAGeX in the years 2001-2004.  I have two decode methods, however both have severe data loss.  The encode method is  [code=java]public static int encode(String file) {  int hash = 0;  file = file.toUpperCase();  	for(int i = 0; i &lt; file.length(); i++) { 		hash = (hash * 61 + file.charAt(i)) - 32; 	} 	return hash; }[/code]  1st attempt to decode  [code=java]public static String decode(int hash) {  long realHash = (..." />
<meta property="article:published_time" content="2013-10-19T14:26:13+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="534334.html">Cracking Jagex&#39;s Hash Algorithms</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Methods.html'><span itemprop='name'>Methods</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-19T14:26:13Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:17Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Was wondering if anyone had a better way to decode the file hash algorithm used by JAGeX in the years 2001-2004.</p>
<p>I have two decode methods, however both have severe data loss.</p>
<p>The encode method is</p>
<p>[code=java]public static int encode(String file) {<br>
int hash = 0;<br>
file = file.toUpperCase();</p>
<pre><code>	for(int i = 0; i &lt; file.length(); i++) {
		hash = (hash * 61 + file.charAt(i)) - 32;
	}
	return hash;
}[/code]
</code></pre>
<p>1st attempt to decode</p>
<p>[code=java]public static String decode(int hash) {<br>
long realHash = (hash &lt; 0 ? Integer.MAX_VALUE + Math.abs(hash) : hash);<br>
ByteBuffer buffer = ByteBuffer.allocate(50);</p>
<pre><code>	while (realHash &gt; 0) {
		buffer.put((byte) ((realHash % 61) + 32));
		realHash = (realHash - 32) / 61;
	}
	buffer.flip();
	return new String(buffer.array()).trim();
}[/code]
</code></pre>
<p>Second attempt</p>
<p>[code=java]public static String decode(int hash) {<br>
int strLen = 0;<br>
int tmpHash = hash;<br>
int lastSolve = 0;<br>
while (tmpHash &gt;= 32) {<br>
tmpHash /= 61;<br>
tmpHash += 31;<br>
strLen++;<br>
}<br>
strLen–;<br>
char[] out = new char[strLen];<br>
for (int x = 0; x &lt; strLen; x++) {<br>
tmpHash = hash;<br>
for(int i = x+1; i &lt; strLen; i++) {<br>
tmpHash /= 61;<br>
tmpHash += 31;<br>
}</p>
<pre><code>        int res = tmpHash-32;

        lastSolve *= 61;
        if (lastSolve != 0) {
            res -= lastSolve;
        }
        res += 32;

        lastSolve = tmpHash-32;
        out[x] = (char)res;
        if (x == strLen-2) {
            out[x]++;
        }
    }
    return String.valueOf(out);
}[/code]</code></pre>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/imthenull.html'><span itemprop='name'>imthenull</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-19T17:36:37Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:20Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>they can’t be decoded. there was a topic on this before, but i’m not gonna find it for you. lol</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/waj.html'><span itemprop='name'>waj</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-19T17:45:13Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:20Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="2" data-topic="534334">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/imthenull/40/1273_1.png" class="avatar"> imthenull:</div>
<blockquote>
<p>they can’t be decoded. there was a topic on this before, but i’m not gonna find it for you. lol</p>
</blockquote>
</aside>
<p>Y u such a bitch lately  :palm:</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/imthenull.html'><span itemprop='name'>imthenull</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-19T17:59:59Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:21Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“waj, post:3, topic:534334”][quote author=imthenull link=topic=653131.msg4376466#msg4376466 date=1382204197]<br>
they can’t be decoded. there was a topic on this before, but i’m not gonna find it for you. lol<br>
[/quote]<br>
Y u such a bitch lately  :palm:[/quote]how was i being bitchy…? because i don’t want to use the search button? lol</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/RSCShadow.html'><span itemprop='name'>RSCShadow</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-19T18:03:15Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:21Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <pre><code class="lang-auto">function encode(message) {
    message = message.toUpperCase().split('');

    return message.reduce(function(hash, character) {
        character = character.charCodeAt(0);

        return ((hash * 61) + character) - 32;
    }, 0);
}

function decode(hash) {
    var result = [];

    while(hash !== 0) {
        result.unshift(String.fromCharCode((hash % 61) + 32));
        hash = Math.floor(hash / 61);
    }

    return result.join('');
}

console.log(decode(encode('faggot')));</code></pre>
<pre><code class="lang-auto">$ node rsc.js
FAGGOT</code></pre>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/strucker.html'><span itemprop='name'>strucker</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-19T18:08:23Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:21Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>reverse engineering lolol</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/imthenull.html'><span itemprop='name'>imthenull</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-19T18:13:20Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:21Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Strucker, post:6, topic:534334”]reverse engineering lolol[/quote]i don’t think you know what that term means</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/strucker.html'><span itemprop='name'>strucker</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-19T18:14:11Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:21Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“imthenull, post:7, topic:534334”][quote author=Strucker link=topic=653131.msg4376486#msg4376486 date=1382206103]<br>
reverse engineering lolol</p>
<p>[/quote]i don’t think you know what that term means[/quote]Your right <img src="../../images/emoji/twitter/stuck_out_tongueae52.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/The_Enforcer.html'><span itemprop='name'>The_Enforcer</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-20T07:32:56Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:32Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Always use the right language for the right job. C++ would have been a better choice here.</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/da_real_hype.html'><span itemprop='name'>da_real_hype</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-20T15:10:55Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:37Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="9" data-topic="534334">
<div class="title">
<div class="quote-controls"></div>
 The Enforcer:</div>
<blockquote>
<p>Always use the right language for the right job. C++ would have been a better choice here.</p>
</blockquote>
</aside>
<p>i concur with aforementioned</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/silabsoft.html'><span itemprop='name'>silabsoft</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-20T22:14:59Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:42Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I don’t think you can fully unhash longer text data due to the overflow of the integer.</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lothy.html'><span itemprop='name'>lothy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-20T23:50:28Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:43Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yeah, that would be the case. Are you sure they used this algorithm to encode filenames? Multiplying the hash value by 61 each time is going to cause pretty fast growth of the value.</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ExtremeX-Scape.html'><span itemprop='name'>ExtremeX-Scape</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-21T00:20:23Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:52:44Z' class='post-time'>
              August 4, 2016, 10:52am
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a href="http://en.wikipedia.org/wiki/Entropy_(information_theory)" data-bbcode="true" rel="nofollow noopener">Shannon entropy</a></p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-11-09T08:27:51Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:00:37Z' class='post-time'>
              August 4, 2016, 11:00am
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>while that encoding function isnt implemented as a hash, it ends up being the case because of the previously mentioned integer overflow</p>
<pre><code class="lang-auto">    static String decode(int i) {
        int len = 0;
        for (int j = i; j != 0; j /= 61, len++);
        byte[] b = new byte[len];
        while (len-- &gt; 0) {
            b[len] = (byte) (i % 61 + 32);
            i /= 61;
        }
        return new String(b);
    }</code></pre>
<p>the above code will decode short strings</p>
<p>when the integer has overflowed, you will have to search for collisions (there are lots). if you want meaningful names that makes the task harder</p>
<p>here is a list of all of the sound file names with their respective hashes</p>
<pre><code class="lang-auto">     -944574080 combat2b.pcm
     -113823620 combat3a.pcm
      -99977779 combat3b.pcm
    -1186349966 takeobject.pcm
      392086718 prayeron.pcm
      987662119 recharge.pcm
     1011236428 death.pcm
     1739029983 filljug.pcm
     2113588344 eat.pcm
     -794191332 closedoor.pcm
    -1857503751 retreat.pcm
     -318268426 victory.pcm
     -503721012 cooking.pcm
      583574622 chisel.pcm
      181941996 mix.pcm
    -1739494056 fish.pcm
     1996669315 shoot.pcm
    -1331683753 mine.pcm
     1583524721 outofammo.pcm
      -58020302 coins.pcm
    -1448150580 underattack.pcm
     1249701696 spellok.pcm
    -1644705092 click.pcm
       90965556 opendoor.pcm
      -76182372 secretdoor.pcm
    -2055242872 anvil.pcm
     1464421627 mechanical.pcm
      281719196 advance.pcm
    -1517451494 prospect.pcm
     1915154831 foundgem.pcm
     2120975450 spellfail.pcm
     -714130183 potato.pcm
      206547322 dropobject.pcm
      305280844 prayeroff.pcm
    -1803016222 combat1a.pcm
    -1789170381 combat1b.pcm
     -958419921 combat2a.pcm</code></pre>
<p>edit: heres the c code i used to dump collisions, it uses iterative deepening and just prints everything it sees</p>
<p>[code]<span class="hashtag">#include</span> &lt;stdlib.h&gt;<br>
<span class="hashtag">#include</span> &lt;stdio.h&gt;<br>
<span class="hashtag">#include</span> &lt;string.h&gt;<br>
<span class="hashtag">#include</span> &lt;ctype.h&gt;</p>
<p>struct context_s {<br>
int range;<br>
int inverse;</p>
<pre><code>int offset;
int num_chars;
char* allowed_chars;
</code></pre>
<p>};</p>
<p>typedef struct context_s context;</p>
<p>int inverse(int value)<br>
{<br>
/* a few rounds of newtons method */<br>
int x = 2 - value;<br>
x = x * (2 - value * x);<br>
x = x * (2 - value * x);<br>
x = x * (2 - value * x);<br>
x = x * (2 - value * x);<br>
return x;<br>
}</p>
<p>void init_search(int* value, char* suffix, context* ctx)<br>
{<br>
int local = <em>value;<br>
char</em> end = suffix;<br>
while (*++end);<br>
end–;<br>
while (end &gt;= suffix)<br>
{<br>
local = local - *end-- + ctx-&gt;offset;<br>
local *= ctx-&gt;inverse;<br>
}<br>
*value = local;<br>
}</p>
<p>void recusive_search(int value, int depth, char* suffix, context* ctx)<br>
{<br>
if (!value)<br>
{<br>
printf("%s\n", suffix);<br>
}<br>
else if (depth–)<br>
{<br>
for (int i = 0; i &lt; ctx-&gt;num_chars; i++)<br>
{<br>
int ch = ctx-&gt;allowed_chars[i];<br>
int newval = (value - ch + ctx-&gt;offset) * ctx-&gt;inverse;<br>
suffix[-1] = ch;<br>
recusive_search(newval, depth, suffix - 1, ctx);<br>
}<br>
}<br>
else if (value &gt; 0)<br>
{<br>
char fast_decode_buf[10] = “”;<br>
int len = 0;<br>
for (int i = value; i; i /= ctx-&gt;range, len++);<br>
fast_decode_buf[len] = ‘\0’;<br>
while (len–)<br>
{<br>
int ch = (value % ctx-&gt;range) + ctx-&gt;offset;<br>
if (!strchr(ctx-&gt;allowed_chars, ch)) return;<br>
fast_decode_buf[len] = ch;<br>
value /= ctx-&gt;range;<br>
}<br>
printf("%s%s\n", fast_decode_buf, suffix);<br>
}<br>
}</p>
<p>void deepening_search(int value, char* suffix, context* ctx, int max_depth)<br>
{<br>
int depth = 1;<br>
char* string = malloc(max_depth + strlen(suffix) + 1);<br>
init_search(&amp;value, suffix, ctx);<br>
strcpy(string + max_depth - depth, suffix);<br>
while (depth &lt; max_depth)<br>
{<br>
recusive_search(value, depth, string+max_depth-1, ctx);<br>
depth++;<br>
}<br>
free(string);<br>
}</p>
<p>int encode(char* str, int range, int offset)<br>
{<br>
int code = 0;<br>
while (*str)<br>
code = code * range + toupper(*str++) - offset;<br>
return code;<br>
}</p>
<p>/*<br>
program  &lt;suffix (upper case)&gt; <code><br>
eg: program 3 .PCM -1331683753<br>
<em>/<br>
int main(int argc, char</em>* argv)<br>
{<br>
context ctx;<br>
ctx.range = 61;<br>
ctx.offset = 32;<br>
ctx.allowed_chars = “ABCDEFGHIJKLMNOPQRSTUVWXYZ”;<br>
ctx.inverse = inverse(ctx.range);<br>
ctx.num_chars = strlen(ctx.allowed_chars);<br>
int code = atoi(argv[3]);<br>
deepening_search(code, argv[2], &amp;ctx, atoi(argv[1]));<br>
}<br>
[/code]</code></p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/silabsoft.html'><span itemprop='name'>silabsoft</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-11-26T05:08:48Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:06:52Z' class='post-time'>
              August 4, 2016, 11:06am
            </time>
        <span itemprop='position'>#15</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>thanks frank</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Methods.html'><span itemprop='name'>Methods</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-11-26T15:25:32Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:06:54Z' class='post-time'>
              August 4, 2016, 11:06am
            </time>
        <span itemprop='position'>#16</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Ya thanks for that reply.</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lothy.html'><span itemprop='name'>lothy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-11-27T01:40:03Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:07:02Z' class='post-time'>
              August 4, 2016, 11:07am
            </time>
        <span itemprop='position'>#17</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yeah, frankly that post is worthy of thanks. So thanks frank.</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-12-16T00:09:50Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:15:06Z' class='post-time'>
              August 4, 2016, 11:15am
            </time>
        <span itemprop='position'>#18</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>when the hell did all of you become idiots</p>
<p>also way to post code you didn’t even write<br>
<a href="http://www.moparisthebest.com/smf/index.php?topic=349074.0;wap" class="onebox" target="_blank" rel="nofollow noopener">http://www.moparisthebest.com/smf/index.php?topic=349074.0;wap</a></p>
<p>ps frank is that the same code from 2009 because i asked you if you still had it like over a year ago</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/frank.html'><span itemprop='name'>frank</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-12-16T01:26:47Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:15:08Z' class='post-time'>
              August 4, 2016, 11:15am
            </time>
        <span itemprop='position'>#19</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“veer, post:18, topic:534334”]also way to post code you didn’t even write<br>
<a href="http://www.moparisthebest.com/smf/index.php?topic=349074.0;wap%5B/quote%5Dwas" rel="nofollow noopener">http://www.moparisthebest.com/smf/index.php?topic=349074.0;wap[/quote]was</a> that directed at me?</p>
<p>[quote=“veer, post:18, topic:534334”]ps frank is that the same code from 2009 because i asked you if you still had it like over a year ago[/quote]i wrote that in c recently, based on the java version years ago. so indirectly it is the same</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-12-16T01:56:49Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:15:33Z' class='post-time'>
              August 4, 2016, 11:15am
            </time>
        <span itemprop='position'>#20</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>no it was directed to OP btw i like invert it’s a lot less opaque than MAGIC</p>
      </div>

      <meta itemprop='headline' content='Cracking Jagex&#39;s Hash Algorithms'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/cracking-jagexs-hash-algorithms/534334 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 09:36:12 GMT -->
</html>
