<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Lottery</title>
    <link>https://forum.moparisthebest.com/t/lottery/391393</link>
    <description>I&#39;m ripping this piece of shit out, if anyone wants to use it feel free...

CommandHandler:

[code]} else if (cmd.equals(&quot;lottery&quot;)) {
	if (World.lotteryRunning())
		World.buyTicket(player);
	else
		player.sendMessage(&quot;@gre@RSCE:@whi@ There&#39;s no lottery running right now&quot;);


} else if (cmd.equals(&quot;lotterypot&quot;)) {
	World.getLotteryPot(player);
	
	
} else if (cmd.equals(&quot;startlottery&quot;) &amp;&amp; player.isAdmin() &amp;&amp; player.unlockAdmin()) {
	if (!World.lotteryRunning())
		if (args.length != 1)
			player.sendMessage(&quot;@gre@RSCE:@whi@ Invalid args. Syntax: STARTLOTTERY [price]&quot;);
		else
			try {
				World.startLottery(Integer.parseInt(args[0]));
			} catch (Exception e) {}	
			
			
} else if (cmd.equals(&quot;stoplottery&quot;) &amp;&amp; player.isAdmin() &amp;&amp; player.unlockAdmin()) {
	if (World.lotteryRunning())
		World.stopLottery();
	else
		player.sendMessage(&quot;@gre@RSCE:@whi@ There&#39;s no lottery running right now&quot;);
}[/code]

World:

[code]private static boolean lotteryRunning = false;
private static int lotteryPrice, lotteryPot, lotteryNotify = 0;
private static ArrayList&lt;Player&gt; lotteryEntries, lotterySent = new ArrayList&lt;Player&gt;();

public static boolean lotteryRunning() {
	return lotteryRunning;
}

public static void getLotteryPot(Player player) {
	if (lotteryRunning)
		player.sendMessage(&quot;@gre@RSCE:@whi@ The lottery pot is now at @gre@&quot; + DataConversions.insertCommas(&quot;&quot; + lotteryPot) + &quot; GP@whi@!&quot;);
	else
		player.sendMessage(&quot;@gre@RSCE:@whi@ There&#39;s currently no lottery running&quot;);
}

public static void startLottery(int price) {
	lotteryRunning = true;
	lotteryPrice = price;
	lotteryPot = lotteryNotify = 0;
	lotteryEntries = lotterySent = new ArrayList&lt;Player&gt;();
	
	for (Player informee : World.getPlayers()) {
		informee.getActionSender().sendServerNotification(&quot;@gre@Lottery:@whi@ Each entry is @gre@&quot; + DataConversions.insertCommas(&quot;&quot; + lotteryPrice) + &quot; GP@whi@. Type @gre@::LOTTERY@whi@ to purchase a ticket!&quot;);
		informee.getActionSender().sendServerNotification(&quot;@gre@Lottery:@whi@ RSCEmulation Lottery is now running!&quot;);
	}		
}

public static void findLotteryWinner() {
	Player p = null;
	p = lotteryEntries.get(lotteryEntries.size() == 1 ? 0 : Formulae.rand(0, lotteryEntries.size() - 1));
	if (p != null) {
		InvItem coins = new InvItem(10);
		coins.setAmount(lotteryPot);
		p.getInventory().add(coins);
		p.getActionSender().sendInventory();
		p.getActionSender().sendAlert(&quot;Congratulations! You have won the lottery! % % @gre@&quot; + DataConversions.insertCommas(&quot;&quot; + lotteryPot) + &quot; GP@whi@ has been added to your inventory. Thanks for playing!&quot;, false);

		for (Player informee : World.getPlayers())
			informee.getActionSender().sendServerNotification(&quot;@gre@Lottery:@whi@ &quot; + p.getUsername() + &quot; has won the lottery and is now @gre@&quot; + DataConversions.insertCommas(&quot;&quot; + lotteryPot) + &quot; GP@whi@ richer!&quot;);
		
		for (Player informee : lotteryEntries) {
			if (informee != p &amp;&amp; !informee.getLocation().inWilderness() &amp;&amp; !lotterySent.contains(informee)) {
				informee.getActionSender().sendAlert(p.getUsername() + &quot; has won the lottery and is now @gre@&quot; + DataConversions.insertCommas(&quot;&quot; + lotteryPot) + &quot; GP@whi@ richer! % % Thanks for playing and better luck next time.&quot;, false);
				lotterySent.add(informee);
			}
		}
		lotterySent = new ArrayList&lt;Player&gt;();						
	}
	return;
}

public static void stopLottery() {
	if (lotteryEntries.size() &gt; 0)
		findLotteryWinner();		
	else
		for (Player informee : World.getPlayers())
			informee.getActionSender().sendServerNotification(&quot;@gre@Lottery:@whi@ The lottery has been stopped. No-one entered.&quot;);	
	lotteryRunning = false;
	lotteryPrice = lotteryPot = lotteryNotify = 0;
	lotteryEntries = lotterySent = new ArrayList&lt;Player&gt;();		
}	

public static void buyTicket(Player player) {
	if (player.getBank().countId(10) &lt; lotteryPrice &amp;&amp; player.getInventory().countId(10) &lt; lotteryPrice) {
		player.sendMessage(&quot;@gre@RSCE:@whi@ It seems that you don&#39;t have enough to buy a lottery ticket...&quot;);
		player.sendMessage(&quot;@gre@RSCE:@whi@ Please ensure that you have @gre@&quot; + DataConversions.insertCommas(&quot;&quot; + lotteryPrice) + &quot; GP@whi@ in your inventory or bank and try again&quot;);
	} else if (player.getLocation().inWilderness())
		player.sendMessage(&quot;@gre@RSCE:@whi@ You cannot enter the lottery whilst in the wilderness&quot;);
	else if (player.isDueling())
		player.sendMessage(&quot;@gre@RSCE:@whi@ You cannot enter the lottery whilst you are dueling&quot;);
	else if (player.isTrading())
		player.sendMessage(&quot;@gre@RSCE:@whi@ You cannot enter the lottery whilst you are trading&quot;);
	else if (player.isBusy())
		player.sendMessage(&quot;@gre@RSCE:@whi@ You cannot enter the lottery whilst you&#39;re set as busy&quot;);
	else if (player.accessingBank())
		player.sendMessage(&quot;@gre@RSCE:@whi@ You cannot enter the lottery whilst you&#39;re banking&quot;);
	else if (player.isPMod())
		player.sendMessage(&quot;@gre@RSCE:@whi@ You cannot enter the lottery on a staff character&quot;);
	else if (player.accessingShop())
		player.sendMessage(&quot;@gre@RSCE:@whi@ You cannot enter the lottery whilst you&#39;re in a shop&quot;);
	else {
		if (player.getInventory().countId(10) &gt;= lotteryPrice) {
			if (player.getInventory().remove(new InvItem(10, lotteryPrice)) == -1)
				return;
		} else if (player.getBank().countId(10) &gt;= lotteryPrice) {
			if (player.getBank().remove(10, lotteryPrice) == -1)
				return;
		}
		player.getActionSender().sendInventory();
		lotteryPot += (lotteryPrice - (lotteryPrice / 4));
		lotteryEntries.add(player);
		player.getActionSender().sendAlert(&quot;You have successfully bought a lottery ticket for &quot; + DataConversions.insertCommas(&quot;&quot; + lotteryPrice) + &quot; GP % % @red@Note:@whi@ If you logout during the lottery you will be removed from the draw with no refund!&quot;, false);
		lotterySent = new ArrayList&lt;Player&gt;();
		if (lotteryNotify &lt; 10)
			lotteryNotify++;
		else {
			for (Player informee : World.getPlayers())
				informee.getActionSender().sendServerNotification(&quot;@gre@Lottery:@whi@ The lottery pot is now at @gre@&quot; + DataConversions.insertCommas(&quot;&quot; + lotteryPot) + &quot; GP@whi@! Type @gre@::LOTTERY@whi@ to enter.&quot;);					
			lotteryNotify = 0;
		}				
	}		
}[/code]</description>
    
    <lastBuildDate>Wed, 04 May 2011 17:10:09 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/lottery/391393.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@AlCoHoLiC AlCoHoLiC]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/alcoholic">@AlCoHoLiC</a> wrote:</p>
          <blockquote>
              <p>whos cares about how good of a coder he is, he can only get better and im sure there are plenty of ceo’s/admins/bosses who dont have a clue about coding and pay people todo it</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/22">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/22</link>
        <pubDate>Wed, 04 May 2011 17:10:09 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-22</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@XxIneedhelpxX XxIneedhelpxX]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/xxineedhelpxx">@XxIneedhelpxX</a> wrote:</p>
          <blockquote>
              <p>Thanks for this!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/21">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/21</link>
        <pubDate>Sat, 23 Apr 2011 16:58:05 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-21</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“JUMPHIM, post:19, topic:391393”][quote author=-Nothing link=topic=487340.msg3573410#msg3573410 date=1303233062]</p>
<aside class="quote">
<blockquote>
<pre><code class="lang-auto">if (player.getInventory().countId(10) &gt;= lotteryPrice) {
                        if (player.getInventory().remove(new InvItem(10, lotteryPrice)) == -1)
                                return;
                } else if (player.getBank().countId(10) &gt;= lotteryPrice) {
                        if (player.getBank().remove(10, lotteryPrice) == -1)
                                return;
                }</code></pre>
<pre><code class="lang-auto">if(player.getInventory().remove(new InvItem(10, lotteryPrice)) == -1)
   if(player.getBank().remove(10, lotteryPrice) == -1)
      return;</code></pre>
</blockquote>
</aside>
<p>Finally Kryptix gave out some of the code from RSCE, now we can all judge his coding skills <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
[/quote]<br>
its funny every one talks crap about his coding but hes still stays  the number one rsc  server that speaks for its self.[/quote]</p>
<p>Obviously it’s <span class="hashtag">#1</span> seeing it’s the only one…  Even when another comes along it’s still <span class="hashtag">#1</span> out of 2…  That’s not hard to do when you’re competing with people like Anc13nts…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/20">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/20</link>
        <pubDate>Sat, 23 Apr 2011 03:53:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-20</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@JUMPHIM JUMPHIM]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/jumphim">@JUMPHIM</a> wrote:</p>
          <blockquote>
              <p>[quote="-Nothing, post:10, topic:391393"][quote author=meatstick link=topic=487340.msg3573179#msg3573179 date=1303211484]</p>
<pre><code class="lang-auto">if (player.getInventory().countId(10) &gt;= lotteryPrice) {
                        if (player.getInventory().remove(new InvItem(10, lotteryPrice)) == -1)
                                return;
                } else if (player.getBank().countId(10) &gt;= lotteryPrice) {
                        if (player.getBank().remove(10, lotteryPrice) == -1)
                                return;
                }</code></pre>
<pre><code class="lang-auto">if(player.getInventory().remove(new InvItem(10, lotteryPrice)) == -1)
   if(player.getBank().remove(10, lotteryPrice) == -1)
      return;</code></pre>
<p>[/quote]<br>
Finally Kryptix gave out some of the code from RSCE, now we can all judge his coding skills :)[/quote]<br>
its funny every one talks crap about his coding but hes still stays  the number one rsc  server that speaks for its self.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/19</link>
        <pubDate>Sat, 23 Apr 2011 00:58:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-19</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote="-Nothing, post:17, topic:391393"][quote author=Pluvia link=topic=487340.msg3573789#msg3573789 date=1303255735]</p>
<aside class="quote">
<blockquote>
<p>I thought lottery is based on random numbers? That’s more like…gambling.</p>
</blockquote>
</aside>
<p>They lottery is gambling… You buy a 5$ ticket and hope to get millions. If your numbers are wrong then you just lost 5$.<br>
[/quote]<br>
It is gambling yes, but I meant that this isn’t lottery. In lottery you set random numbers top of your head, and you have like 0.000000000000005 chance to get them all right and win millions.[/quote][quote="-Nothing, post:17, topic:391393"][quote author=Pluvia link=topic=487340.msg3573789#msg3573789 date=1303255735]</p>
<aside class="quote">
<blockquote>
<p>I thought lottery is based on random numbers? That’s more like…gambling.</p>
</blockquote>
</aside>
<p>They lottery is gambling… You buy a 5$ ticket and hope to get millions. If your numbers are wrong then you just lost 5$.<br>
[/quote]<br>
It is gambling yes, but I meant that this isn’t lottery. In lottery you set random numbers top of your head, and you have like 0.000000000000005 chance to get them all right and win millions.[/quote]</p>
<p>You’re describing the common type of lottery…  The odds can be anything, and so can the jackpot.  Most lotteries only give you a portion (usually 50% or less) if you win.</p>
<p>It’s also a lottery, not a raffle, Chinese auction, etc.  Raffles and Chinese auctions have multiple prizes…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/18</link>
        <pubDate>Sat, 23 Apr 2011 00:39:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-18</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>[quote=“Pluvia, post:16, topic:391393”][quote author=-Nothing link=topic=487340.msg3572467#msg3572467 date=1303158851]<br>
I thought lottery is based on random numbers? That’s more like…gambling.<br>
[/quote]<br>
They lottery is gambling… You buy a 5$ ticket and hope to get millions. If your numbers are wrong then you just lost 5$.[/quote]<br>
It is gambling yes, but I meant that this isn’t lottery. In lottery you set random numbers top of your head, and you have like 0.000000000000005 chance to get them all right and win millions.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/17</link>
        <pubDate>Fri, 22 Apr 2011 17:33:36 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-17</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@Pluvia Pluvia]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pluvia">@Pluvia</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="2" data-topic="391393">
<div class="title">
<div class="quote-controls"></div>
 -Nothing:</div>
<blockquote>
<p>I thought lottery is based on random numbers? That’s more like…gambling.</p>
</blockquote>
</aside>
<p>They lottery is gambling… You buy a 5$ ticket and hope to get millions. If your numbers are wrong then you just lost 5$.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/16</link>
        <pubDate>Tue, 19 Apr 2011 23:28:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-16</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“The_AFKer, post:14, topic:391393”][quote author=CodeForFame link=topic=487340.msg3573615#msg3573615 date=1303245917]</p>
<aside class="quote">
<blockquote>
<p>Re-write the command handler, use enums rather than long blocks of if/else chains. Vrunk released something like this a while back, but was ignored. Makes for easier-to-read code blocks and faster execution.</p>
<p>Something random I noticed, but you could just use player’s names rather than throwing the entire entity into collections and append them to string array, and you can ideally shorten/organize the code by a lot if you used a single object instance, there’s a lot of useless/lazy checks.</p>
</blockquote>
</aside>
<p>Do you even know what enumerations are, and what they’re used for?</p>
<p>Also, it wouldn’t be any faster…  It has to make more comparisons…</p>
<p>BTW Kryptix:  You suck at programming.  Now come up with a new argument, as you know full well I don’t fit into your current argument.<br>
[/quote]</p>
<p>It would execute faster than traversing through a huge list of conditional statements, since it would compare against a list of constants provided you put them in a switch block.</p>
<p>Feel free to provide a benchmark of a “speed” comparison.</p>
<p>On another note: I find it hilarious when you need to come to the rescue to try and play ‘hero’ on nearly every thread I post on. It just reassures the fact that you’re over compensating your intelligence to everyone.[/quote]</p>
<p>When you get the enumeration that corresponds with the correct string you’re doing the comparisons there…  Also, you can make strings constant as well, pretending like they’re unable to be made constant is just retarded.</p>
<p>As for a benchmark here is on I tossed together, feel free to make a better one:</p>
<p>[code]import java.util.concurrent.ExecutorService;<br>
import java.util.concurrent.Executors;<br>
import java.util.regex.Pattern;</p>
<p>public class IfElseIfVsSwitch {</p>
<pre><code>private static final ExecutorService exec = Executors.newFixedThreadPool(2);

private static enum COMMAND {
	SKULL, STUCK, OFFER, STAFF;
}

/**
 * @param args
 */
public static void main(String[] args) {

	final int ITERATIONS = Integer.MAX_VALUE / 300;
	final String[] USER_INPUT = { "skull", "stuck", "offer 10 999",
			"staff", "stuc" };

	exec.execute(new Runnable() {

		@Override
		public void run() {
			final long T1 = System.nanoTime();
			// Oh shit, we need to regex the string to deal with
			// commands that have parameters...
			// I'll be nice and make it compile each time the 'server'
			// starts instead of for each command like using the split
			// method of the string class would do.
			final Pattern p = Pattern.compile(" ");
			for (int i = ITERATIONS; i &gt;= 0; i--) {

				for (final String cmd : USER_INPUT) {
					final String[] args1 = p.split(cmd);
					try {
						// Damn, we need to make sure it's upper case to
						// make sure it matches...
						switch (COMMAND.valueOf(args1[0].toUpperCase())) {
						case SKULL:
							break;
						case STUCK:
							break;
						case OFFER:
							break;
						case STAFF:
							break;

						}
					} catch (final IllegalArgumentException e) {
						// Darn, we have to catch this because people can
						// enter invalid commands...
					}
				}
			}
			final long T2 = System.nanoTime();
			System.out.println("T1 - " + (T2 - T1) / 1000000);
		}

	});

	exec.execute(new Runnable() {

		@Override
		public void run() {
			final long T1 = System.nanoTime();
			for (int i = ITERATIONS; i &gt;= 0; i--) {
				for (final String cmd : USER_INPUT) {
					if (cmd.equals("skull")) {
						continue;
					}
					if (cmd.equals("stuck")) {
						continue;
					}
					if (cmd.startsWith("offer")) {
						continue;
					}
					if (cmd.equals("staff")) {
						continue;
					}
				}
			}
			final long T2 = System.nanoTime();
			System.out.println("T2 - " + (T2 - T1) / 1000000);
		}

	});

	exec.shutdown();
}
</code></pre>
<p>}<br>
[/code]</p>
<p>The divide by 1000000 is to turn it into milliseconds…</p>
<p>Anyway, I did it quite a few time and some average results are:<br>
T2 - 402<br>
T1 - 29265</p>
<p>I would have it do more iterations but one is way too slow for me to waste the time.</p>
<p>As for your other note…  I don’t play ‘hero’ I simply post when I feel there is either incorrect information, and I can offer more accurate information, or I feel like expressing an opinion.  It isn’t my fault if I happen to have more accurate information than you on ‘nearly every thread’, or I feel like expressing my opinion because mine isn’t being represented…</p>
<p>Also, I don’t see how I can be overcompensating my intelligence…  But I’ll just take that as “I’m displaying my intelligence to compensate for lack of something else”…<br>
I don’t see how posting a correction confirms the alleged reason behind posting.  Anyway, I don’t post because I care what others think about me, I post because I want to help others learn, and become less retarded.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/15</link>
        <pubDate>Tue, 19 Apr 2011 23:07:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-15</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@The_AFKer The_AFKer]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/the_afker">@The_AFKer</a> wrote:</p>
          <blockquote>
              <p>[quote=“CodeForFame, post:13, topic:391393”][quote author=The_AFKer link=topic=487340.msg3573543#msg3573543 date=1303242478]<br>
Re-write the command handler, use enums rather than long blocks of if/else chains. Vrunk released something like this a while back, but was ignored. Makes for easier-to-read code blocks and faster execution.</p>
<p>Something random I noticed, but you could just use player’s names rather than throwing the entire entity into collections and append them to string array, and you can ideally shorten/organize the code by a lot if you used a single object instance, there’s a lot of useless/lazy checks.<br>
[/quote]</p>
<p>Do you even know what enumerations are, and what they’re used for?</p>
<p>Also, it wouldn’t be any faster…  It has to make more comparisons…</p>
<p>BTW Kryptix:  You suck at programming.  Now come up with a new argument, as you know full well I don’t fit into your current argument.[/quote]</p>
<p>It would execute faster than traversing through a huge list of conditional statements, since it would compare against a list of constants provided you put them in a switch block.</p>
<p>Feel free to provide a benchmark of a “speed” comparison.</p>
<p>On another note: I find it hilarious when you need to come to the rescue to try and play ‘hero’ on nearly every thread I post on. It just reassures the fact that you’re over compensating your intelligence to everyone.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/14</link>
        <pubDate>Tue, 19 Apr 2011 21:22:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-14</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“The_AFKer, post:12, topic:391393”]Re-write the command handler, use enums rather than long blocks of if/else chains. Vrunk released something like this a while back, but was ignored. Makes for easier-to-read code blocks and faster execution.</p>
<p>Something random I noticed, but you could just use player’s names rather than throwing the entire entity into collections and append them to string array, and you can ideally shorten/organize the code by a lot if you used a single object instance, there’s a lot of useless/lazy checks.[/quote]</p>
<p>Do you even know what enumerations are, and what they’re used for?</p>
<p>Also, it wouldn’t be any faster…  It has to make more comparisons…</p>
<p>BTW Kryptix:  You suck at programming.  Now come up with a new argument, as you know full well I don’t fit into your current argument.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/13</link>
        <pubDate>Tue, 19 Apr 2011 20:45:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-13</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@The_AFKer The_AFKer]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/the_afker">@The_AFKer</a> wrote:</p>
          <blockquote>
              <p>Re-write the command handler, use enums rather than long blocks of if/else chains. Vrunk released something like this a while back, but was ignored. Makes for easier-to-read code blocks and faster execution.</p>
<p>Something random I noticed, but you could just use player’s names rather than throwing the entire entity into collections and append them to string array, and you can ideally shorten/organize the code by a lot if you used a single object instance, there’s a lot of useless/lazy checks.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/12</link>
        <pubDate>Tue, 19 Apr 2011 19:47:58 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-12</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>You can easily see how good somebody is within 100 lines. And I saw exactly how good you are by this “lottery” snippet. I don’t personally care my previous post was a sarcasm, but it seems that lots of people care, I see them posting ‘Kryptix can’t code’ on almost every topic.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/11</link>
        <pubDate>Tue, 19 Apr 2011 19:04:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-11</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>[quote=“meatstick, post:9, topic:391393”]<code>
if (player.getInventory().countId(10) &gt;= lotteryPrice) {
                        if (player.getInventory().remove(new InvItem(10, lotteryPrice)) == -1)
                                return;
                } else if (player.getBank().countId(10) &gt;= lotteryPrice) {
                        if (player.getBank().remove(10, lotteryPrice) == -1)
                                return;
                }
</code></p>
<p><code>
if(player.getInventory().remove(new InvItem(10, lotteryPrice)) == -1)
   if(player.getBank().remove(10, lotteryPrice) == -1)
      return;
</code>[/quote]<br>
Finally Kryptix gave out some of the code from RSCE, now we can all judge his coding skills <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/10</link>
        <pubDate>Tue, 19 Apr 2011 17:11:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-10</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@meatstick meatstick]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/meatstick">@meatstick</a> wrote:</p>
          <blockquote>
              <pre><code class="lang-auto">if (player.getInventory().countId(10) &gt;= lotteryPrice) {
                        if (player.getInventory().remove(new InvItem(10, lotteryPrice)) == -1)
                                return;
                } else if (player.getBank().countId(10) &gt;= lotteryPrice) {
                        if (player.getBank().remove(10, lotteryPrice) == -1)
                                return;
                }</code></pre>
<pre><code class="lang-auto">if(player.getInventory().remove(new InvItem(10, lotteryPrice)) == -1)
   if(player.getBank().remove(10, lotteryPrice) == -1)
      return;</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/9</link>
        <pubDate>Tue, 19 Apr 2011 11:11:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-9</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@uberpk3r uberpk3r]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/uberpk3r">@uberpk3r</a> wrote:</p>
          <blockquote>
              <p>No 1 said snipped code is allowed though</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/8</link>
        <pubDate>Tue, 19 Apr 2011 08:28:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-8</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@Ecko Ecko]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ecko">@Ecko</a> wrote:</p>
          <blockquote>
              <p>raffle*</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/7</link>
        <pubDate>Tue, 19 Apr 2011 03:03:58 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-7</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@roflcopterofl roflcopterofl]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/roflcopterofl">@roflcopterofl</a> wrote:</p>
          <blockquote>
              <p>K I understand thnx</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/6</link>
        <pubDate>Tue, 19 Apr 2011 02:25:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-6</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@IlikeArrays IlikeArrays]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ilikearrays">@IlikeArrays</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="4" data-topic="391393">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/roflcopterofl/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> roflcopterofl:</div>
<blockquote>
<p>The lottery</p>
</blockquote>
</aside>
<p>Read da code.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/5</link>
        <pubDate>Tue, 19 Apr 2011 02:20:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-5</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@roflcopterofl roflcopterofl]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/roflcopterofl">@roflcopterofl</a> wrote:</p>
          <blockquote>
              <p>The lottery</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/4</link>
        <pubDate>Tue, 19 Apr 2011 02:17:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-4</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@roflcopterofl roflcopterofl]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/roflcopterofl">@roflcopterofl</a> wrote:</p>
          <blockquote>
              <p>Explain Please</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/3</link>
        <pubDate>Tue, 19 Apr 2011 00:50:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-3</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@Nothing1 -Nothing]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nothing1">@Nothing1</a> wrote:</p>
          <blockquote>
              <p>I thought lottery is based on random numbers? That’s more like…gambling.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/2</link>
        <pubDate>Mon, 18 Apr 2011 20:34:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-2</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
      <item>
        <title>Lottery</title>
        <dc:creator><![CDATA[@Kryptix Kryptix]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/kryptix">@Kryptix</a> wrote:</p>
          <blockquote>
              <p>I’m ripping this piece of shit out, if anyone wants to use it feel free…</p>
<p>CommandHandler:</p>
<p>[code]} else if (cmd.equals(“lottery”)) {<br>
if (World.lotteryRunning())<br>
World.buyTicket(player);<br>
else<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ There’s no lottery running right now");</p>
<p>} else if (cmd.equals(“lotterypot”)) {<br>
World.getLotteryPot(player);</p>
<p>} else if (cmd.equals(“startlottery”) &amp;&amp; player.isAdmin() &amp;&amp; player.unlockAdmin()) {<br>
if (!World.lotteryRunning())<br>
if (args.length != 1)<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ Invalid args. Syntax: STARTLOTTERY [price]");<br>
else<br>
try {<br>
World.startLottery(Integer.parseInt(args[0]));<br>
} catch (Exception e) {}</p>
<p>} else if (cmd.equals(“stoplottery”) &amp;&amp; player.isAdmin() &amp;&amp; player.unlockAdmin()) {<br>
if (World.lotteryRunning())<br>
World.stopLottery();<br>
else<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ There’s no lottery running right now");<br>
}[/code]</p>
<p>World:</p>
<p>[code]private static boolean lotteryRunning = false;<br>
private static int lotteryPrice, lotteryPot, lotteryNotify = 0;<br>
private static ArrayList lotteryEntries, lotterySent = new ArrayList();</p>
<p>public static boolean lotteryRunning() {<br>
return lotteryRunning;<br>
}</p>
<p>public static void getLotteryPot(Player player) {<br>
if (lotteryRunning)<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ The lottery pot is now at <span class="mention">@gre</span>@" + DataConversions.insertCommas("" + lotteryPot) + " GP@whi@!");<br>
else<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ There’s currently no lottery running");<br>
}</p>
<p>public static void startLottery(int price) {<br>
lotteryRunning = true;<br>
lotteryPrice = price;<br>
lotteryPot = lotteryNotify = 0;<br>
lotteryEntries = lotterySent = new ArrayList();</p>
<pre><code>for (Player informee : World.getPlayers()) {
	informee.getActionSender().sendServerNotification("@gre@Lottery:@whi@ Each entry is @gre@" + DataConversions.insertCommas("" + lotteryPrice) + " GP@whi@. Type @gre@::LOTTERY@whi@ to purchase a ticket!");
	informee.getActionSender().sendServerNotification("@gre@Lottery:@whi@ RSCEmulation Lottery is now running!");
}		
</code></pre>
<p>}</p>
<p>public static void findLotteryWinner() {<br>
Player p = null;<br>
p = lotteryEntries.get(lotteryEntries.size() == 1 ? 0 : Formulae.rand(0, lotteryEntries.size() - 1));<br>
if (p != null) {<br>
InvItem coins = new InvItem(10);<br>
coins.setAmount(lotteryPot);<br>
p.getInventory().add(coins);<br>
p.getActionSender().sendInventory();<br>
p.getActionSender().sendAlert(“Congratulations! You have won the lottery! % % <span class="mention">@gre</span>@” + DataConversions.insertCommas("" + lotteryPot) + " GP@whi@ has been added to your inventory. Thanks for playing!", false);</p>
<pre><code>	for (Player informee : World.getPlayers())
		informee.getActionSender().sendServerNotification("@gre@Lottery:@whi@ " + p.getUsername() + " has won the lottery and is now @gre@" + DataConversions.insertCommas("" + lotteryPot) + " GP@whi@ richer!");
	
	for (Player informee : lotteryEntries) {
		if (informee != p &amp;&amp; !informee.getLocation().inWilderness() &amp;&amp; !lotterySent.contains(informee)) {
			informee.getActionSender().sendAlert(p.getUsername() + " has won the lottery and is now @gre@" + DataConversions.insertCommas("" + lotteryPot) + " GP@whi@ richer! % % Thanks for playing and better luck next time.", false);
			lotterySent.add(informee);
		}
	}
	lotterySent = new ArrayList&lt;Player&gt;();						
}
return;
</code></pre>
<p>}</p>
<p>public static void stopLottery() {<br>
if (lotteryEntries.size() &gt; 0)<br>
findLotteryWinner();		<br>
else<br>
for (Player informee : World.getPlayers())<br>
informee.getActionSender().sendServerNotification("<span class="mention">@gre</span>@Lottery:<span class="mention">@whi</span>@ The lottery has been stopped. No-one entered.");	<br>
lotteryRunning = false;<br>
lotteryPrice = lotteryPot = lotteryNotify = 0;<br>
lotteryEntries = lotterySent = new ArrayList();		<br>
}</p>
<p>public static void buyTicket(Player player) {<br>
if (player.getBank().countId(10) &lt; lotteryPrice &amp;&amp; player.getInventory().countId(10) &lt; lotteryPrice) {<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ It seems that you don’t have enough to buy a lottery ticket…");<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ Please ensure that you have <span class="mention">@gre</span>@" + DataConversions.insertCommas("" + lotteryPrice) + " GP@whi@ in your inventory or bank and try again");<br>
} else if (player.getLocation().inWilderness())<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ You cannot enter the lottery whilst in the wilderness");<br>
else if (player.isDueling())<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ You cannot enter the lottery whilst you are dueling");<br>
else if (player.isTrading())<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ You cannot enter the lottery whilst you are trading");<br>
else if (player.isBusy())<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ You cannot enter the lottery whilst you’re set as busy");<br>
else if (player.accessingBank())<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ You cannot enter the lottery whilst you’re banking");<br>
else if (player.isPMod())<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ You cannot enter the lottery on a staff character");<br>
else if (player.accessingShop())<br>
player.sendMessage("<span class="mention">@gre</span>@RSCE:<span class="mention">@whi</span>@ You cannot enter the lottery whilst you’re in a shop");<br>
else {<br>
if (player.getInventory().countId(10) &gt;= lotteryPrice) {<br>
if (player.getInventory().remove(new InvItem(10, lotteryPrice)) == -1)<br>
return;<br>
} else if (player.getBank().countId(10) &gt;= lotteryPrice) {<br>
if (player.getBank().remove(10, lotteryPrice) == -1)<br>
return;<br>
}<br>
player.getActionSender().sendInventory();<br>
lotteryPot += (lotteryPrice - (lotteryPrice / 4));<br>
lotteryEntries.add(player);<br>
player.getActionSender().sendAlert(“You have successfully bought a lottery ticket for " + DataConversions.insertCommas(”" + lotteryPrice) + " GP % % <a class="mention" href="/u/red">@red</a>@Note:<span class="mention">@whi</span>@ If you logout during the lottery you will be removed from the draw with no refund!", false);<br>
lotterySent = new ArrayList();<br>
if (lotteryNotify &lt; 10)<br>
lotteryNotify++;<br>
else {<br>
for (Player informee : World.getPlayers())<br>
informee.getActionSender().sendServerNotification("<span class="mention">@gre</span>@Lottery:<span class="mention">@whi</span>@ The lottery pot is now at <span class="mention">@gre</span>@" + DataConversions.insertCommas("" + lotteryPot) + " GP@whi@! Type <span class="mention">@gre</span>@::LOTTERY@whi@ to enter.");					<br>
lotteryNotify = 0;<br>
}				<br>
}		<br>
}[/code]</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/lottery/391393/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/lottery/391393/1</link>
        <pubDate>Sun, 17 Apr 2011 23:59:37 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-391393-1</guid>
        <source url="https://forum.moparisthebest.com/t/lottery/391393.rss">Lottery</source>
      </item>
  </channel>
</rss>
