<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Prayer drain fix</title>
    <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244</link>
    <description>Currently in RSCDv25 you can stop prayer being drained via an exploit.

I here is a nasty way of fixing it:
[code]
        public void addPrayerDrain(int prayerID) {
                drainRate = 0;
                for(int x = 0; x &lt; 13; x++) {
                        PrayerDef prayer = EntityHandler.getPrayerDef(x);
                        drainRate += prayer.getDrainRate();
                }
                drainRate = drainRate - getPrayerPoints();
                drainer.setDelay((int)(240000 / drainRate));
                }
[/code]

A better way would probably be to have a var of the activated prayers instead of looping through them all but this will work anyway...

You need to replace the current method in model/Player.java</description>
    
    <lastBuildDate>Sun, 08 Feb 2009 10:30:55 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Prayer drain fix</title>
        <dc:creator><![CDATA[@KO9 KO9]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ko9">@KO9</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group quote-modified" data-post="9" data-topic="258244">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/woooooo/40/5_6bca9977b612b7aeef77ba1ec1cd67b3.png" class="avatar"> woooooo:</div>
<blockquote>
<p>All this would do is drain as if all prayers are activated, it doesn’t fix anything, it causes more of a mess.  Pets’ way works, but also causes another problem where if they activate, say steel skin, then they activate all other prays they want, they’re prayer won’t drain until after the steel skin’s first drain…soo yea, Pets’ works, but has a bug, and KO9’s doesn’t work, and has a huge bug.</p>
</blockquote>
</aside>
<p>I missed a bit of code off. Here is what I currently have and works fine:</p>
<pre><code class="lang-auto">        public void addPrayerDrain(int prayerID) {
                drainRate = 0;
                PrayerDef prayer = EntityHandler.getPrayerDef(prayerID);
                for(int x = 0; x &lt;= 13; x++) {
                        prayer = EntityHandler.getPrayerDef(x);
                        if(super.isPrayerActivated(x)) { drainRate += prayer.getDrainRate(); }
                }
                drainRate = drainRate - getPrayerPoints();
                if(drainRate &gt; 0) { drainer.setDelay((int)(240000 / drainRate)); }
                else if(drainRate &lt;= 0) { drainRate = 0; drainer.setDelay(Integer.MAX_VALUE); }
                }

        public void removePrayerDrain(int prayerID) {
                addPrayerDrain(prayerID);
        }</code></pre>
<p>You need to make a change in the PrayerHandler so that the prayer is activated before it adds the drain and likewise for when you die.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244/10</link>
        <pubDate>Sun, 08 Feb 2009 10:30:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-258244-10</guid>
        <source url="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss">Prayer drain fix</source>
      </item>
      <item>
        <title>Prayer drain fix</title>
        <dc:creator><![CDATA[@woooooo woooooo]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/woooooo">@woooooo</a> wrote:</p>
          <blockquote>
              <p>All this would do is drain as if all prayers are activated, it doesn’t fix anything, it causes more of a mess.  Pets’ way works, but also causes another problem where if they activate, say steel skin, then they activate all other prays they want, they’re prayer won’t drain until after the steel skin’s first drain…soo yea, Pets’ works, but has a bug, and KO9’s doesn’t work, and has a huge bug.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244/9</link>
        <pubDate>Sat, 07 Feb 2009 15:47:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-258244-9</guid>
        <source url="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss">Prayer drain fix</source>
      </item>
      <item>
        <title>Prayer drain fix</title>
        <dc:creator><![CDATA[@lothy Lothy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/lothy">@lothy</a> wrote:</p>
          <blockquote>
              <p>RS2 section rules are irrelevant here, as this is the RSC section.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244/8</link>
        <pubDate>Sun, 25 Jan 2009 08:15:45 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-258244-8</guid>
        <source url="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss">Prayer drain fix</source>
      </item>
      <item>
        <title>Prayer drain fix</title>
        <dc:creator><![CDATA[@gs_pk_pure gs pk pure]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/gs_pk_pure">@gs_pk_pure</a> wrote:</p>
          <blockquote>
              <p>This isnt that much of a good tutorial, you havent explained it that much this is really just a c+p, you should be better seeing as your a moderator</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244/7</link>
        <pubDate>Sun, 25 Jan 2009 07:55:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-258244-7</guid>
        <source url="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss">Prayer drain fix</source>
      </item>
      <item>
        <title>Prayer drain fix</title>
        <dc:creator><![CDATA[@propker propker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/propker">@propker</a> wrote:</p>
          <blockquote>
              <p>Do you mean the one where u can click on it 3 times ( in a certain time spaced or some shit) and u can keep prayer on and not drain? If so that has been fixed on mine ( probably the Only exploit fixed on mine) lol</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244/6</link>
        <pubDate>Sun, 25 Jan 2009 03:42:04 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-258244-6</guid>
        <source url="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss">Prayer drain fix</source>
      </item>
      <item>
        <title>Prayer drain fix</title>
        <dc:creator><![CDATA[@xEnt xEnt]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/xent">@xEnt</a> wrote:</p>
          <blockquote>
              <p>I don’t get the exploit in the first place.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244/5</link>
        <pubDate>Sun, 25 Jan 2009 00:19:07 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-258244-5</guid>
        <source url="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss">Prayer drain fix</source>
      </item>
      <item>
        <title>Prayer drain fix</title>
        <dc:creator><![CDATA[@Peter Peeter]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/peter">@Peter</a> wrote:</p>
          <blockquote>
              <pre><code class="lang-auto">	public void addPrayerDrain(int prayerID) {
		PrayerDef prayer = EntityHandler.getPrayerDef(prayerID);
		drainRate += prayer.getDrainRate();
		if(drainer.getDelay() != Integer.MAX_VALUE)
			{
			int newDelay = 0;
			int newRate = (int)(240000 / drainRate);
			if(newRate &lt; drainer.getDelay()) 
				{
				newDelay = drainer.getDelay() - newRate;
				}
			else
				{
				newDelay = drainer.getDelay() + (newRate - drainer.getDelay());
				}
			drainer.setDelay(newDelay);
			}
		else { drainer.setDelay((int)(240000 / drainRate)); }
		}

	public void removePrayerDrain(int prayerID) 
		{
		PrayerDef prayer = EntityHandler.getPrayerDef(prayerID);
		drainRate -= prayer.getDrainRate();
		if(drainRate &lt;= 0) 
			{
			drainRate = 0;
			drainer.setDelay(Integer.MAX_VALUE);
			}
		else 
			{
			if(drainer.getDelay() != Integer.MAX_VALUE)
			{
			int newDelay = 0;
			int newRate = (int)(240000 / drainRate);
			if(newRate &lt; drainer.getDelay()) 
				{
				newDelay = drainer.getDelay() - newRate;
				}
			else
				{
				newDelay = drainer.getDelay() + (newRate - drainer.getDelay());
				}
			drainer.setDelay(newDelay);
			}
		else { drainer.setDelay((int)(240000 / drainRate)); }
		}
	}</code></pre>
<pre><code class="lang-auto">drainer = new DelayedEvent(this, Integer.MAX_VALUE)
			{
			public void run() 
				{
				int curPrayer = getCurStat(5);
				if(getDrainRate() &gt; 0 &amp;&amp; curPrayer &gt; 0) {	
					incCurStat(5, -1);
					getActionSender().sendStat(5);
					if(curPrayer &lt;= 1) {
						for(int prayerID = 0;prayerID &lt; 14;prayerID++) {
							setPrayer(prayerID, false);
						}
						setDrainRate(0);
						setDelay(Integer.MAX_VALUE);
						getActionSender().sendMessage("You have run out of prayer points. Return to a church to recharge");
						getActionSender().sendPrayers();
					}
				}
				if(drainRate != 0) 
					{
					setDelay((int)(240000 / drainRate));
					}
				}
			};</code></pre>
<p>I don’t get how your code stops the exploit… <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=6" title=":confused:" class="emoji" alt=":confused:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244/4</link>
        <pubDate>Sat, 24 Jan 2009 17:45:54 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-258244-4</guid>
        <source url="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss">Prayer drain fix</source>
      </item>
      <item>
        <title>Prayer drain fix</title>
        <dc:creator><![CDATA[@KO9 KO9]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ko9">@KO9</a> wrote:</p>
          <blockquote>
              <p>Reluctant to do so publically because of people exploiting unpatched servers, but if you highlight my in <span class="hashtag">#rscdev</span> I’ll PM you the details.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244/3</link>
        <pubDate>Sat, 24 Jan 2009 17:24:50 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-258244-3</guid>
        <source url="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss">Prayer drain fix</source>
      </item>
      <item>
        <title>Prayer drain fix</title>
        <dc:creator><![CDATA[@Vrunk Vrunk]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/vrunk">@Vrunk</a> wrote:</p>
          <blockquote>
              <p>Could you explain the exploit a little bit more clearly so that I can understand the fix?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244/2</link>
        <pubDate>Sat, 24 Jan 2009 17:14:37 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-258244-2</guid>
        <source url="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss">Prayer drain fix</source>
      </item>
      <item>
        <title>Prayer drain fix</title>
        <dc:creator><![CDATA[@KO9 KO9]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ko9">@KO9</a> wrote:</p>
          <blockquote>
              <p>Currently in RSCDv25 you can stop prayer being drained via an exploit.</p>
<p>I here is a nasty way of fixing it:</p>
<pre><code class="lang-auto">        public void addPrayerDrain(int prayerID) {
                drainRate = 0;
                for(int x = 0; x &lt; 13; x++) {
                        PrayerDef prayer = EntityHandler.getPrayerDef(x);
                        drainRate += prayer.getDrainRate();
                }
                drainRate = drainRate - getPrayerPoints();
                drainer.setDelay((int)(240000 / drainRate));
                }</code></pre>
<p>A better way would probably be to have a var of the activated prayers instead of looping through them all but this will work anyway…</p>
<p>You need to replace the current method in model/Player.java</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/prayer-drain-fix/258244/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/prayer-drain-fix/258244/1</link>
        <pubDate>Sat, 24 Jan 2009 16:55:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-258244-1</guid>
        <source url="https://forum.moparisthebest.com/t/prayer-drain-fix/258244.rss">Prayer drain fix</source>
      </item>
  </channel>
</rss>
