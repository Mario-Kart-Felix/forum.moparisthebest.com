<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Moderator Lock / Problem Solved</title>
    <link>https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283</link>
    <description>Solved. Mod Lock</description>
    
    <lastBuildDate>Tue, 05 Jul 2011 08:19:55 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Moderator Lock / Problem Solved</title>
        <dc:creator><![CDATA[@davidi2 Davidi2]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/davidi2">@davidi2</a> wrote:</p>
          <blockquote>
              <p>Rather than removing your question, post how you solved it to help others.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283/5</link>
        <pubDate>Tue, 05 Jul 2011 08:19:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-402283-5</guid>
        <source url="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283.rss">Moderator Lock / Problem Solved</source>
      </item>
      <item>
        <title>Moderator Lock / Problem Solved</title>
        <dc:creator><![CDATA[@voetbal645 voetbal645]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/voetbal645">@voetbal645</a> wrote:</p>
          <blockquote>
              <p>no problem :d</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283/4</link>
        <pubDate>Tue, 05 Jul 2011 08:12:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-402283-4</guid>
        <source url="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283.rss">Moderator Lock / Problem Solved</source>
      </item>
      <item>
        <title>Moderator Lock / Problem Solved</title>
        <dc:creator><![CDATA[@nicke924 nicke924]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nicke924">@nicke924</a> wrote:</p>
          <blockquote>
              <p>Thx but i fixed it ill rep u 2morow</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283/3</link>
        <pubDate>Mon, 04 Jul 2011 23:05:26 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-402283-3</guid>
        <source url="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283.rss">Moderator Lock / Problem Solved</source>
      </item>
      <item>
        <title>Moderator Lock / Problem Solved</title>
        <dc:creator><![CDATA[@voetbal645 voetbal645]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/voetbal645">@voetbal645</a> wrote:</p>
          <blockquote>
              <p>make a backup of that text document and try to replace that whole method with this one</p>
<p>[code]	public CopyOnWriteArrayList otherStakedItems = new CopyOnWriteArrayList();<br>
public CopyOnWriteArrayList stakedItems = new CopyOnWriteArrayList();</p>
<pre><code>public void requestDuel(int id) {
	try {
		if (id == c.playerId)
			return;
		resetDuel();
		resetDuelItems();
		c.duelingWith = id;
		Client o = (Client) Server.playerHandler.players[id];
		if(o == null) {
			return;
		}
		c.duelRequested = true;
		if(c.duelStatus == 0 &amp;&amp; o.duelStatus == 0 &amp;&amp; c.duelRequested &amp;&amp; o.duelRequested &amp;&amp; c.duelingWith == o.getId() &amp;&amp; o.duelingWith == c.getId()) {
			if(c.goodDistance(c.getX(), c.getY(), o.getX(), o.getY(), 1)) {			
				c.getTradeAndDuel().openDuel();
				o.getTradeAndDuel().openDuel();
			} else {
				c.sendMessage("You need to get closer to your opponent to start the duel.");
			}

		} else {
			c.sendMessage("Sending duel request...");
			o.sendMessage(c.playerName+":duelreq:");		
		}
	} catch (Exception e) {
		Misc.println("Error requesting duel.");
	}
}


public void openDuel() {
	Client o = (Client) Server.playerHandler.players[c.duelingWith];
	if(o == null) {
		return;
	}	
	c.duelStatus = 1;
	refreshduelRules();
	refreshDuelScreen();
	c.canOffer = true;
	for (int i = 0; i &lt; c.playerEquipment.length; i++) {
		sendDuelEquipment(c.playerEquipment[i], c.playerEquipmentN[i], i);
	}
	c.getPA().sendFrame126("Dueling with: " + o.playerName + " (level-" + o.combatLevel + ")", 6671);
	c.getPA().sendFrame126("", 6684);
	c.getPA().sendFrame248(6575, 3321);
	c.getItems().resetItems(3322);
}

public void sendDuelEquipment(int itemId, int amount, int slot) {
	synchronized(c) {
		if(itemId != 0) {
			c.getOutStream().createFrameVarSizeWord(34);
			c.getOutStream().writeWord(13824);
			c.getOutStream().writeByte(slot);
			c.getOutStream().writeWord(itemId+1);

			if (amount &gt; 254) {
				c.getOutStream().writeByte(255);
				c.getOutStream().writeDWord(amount);
			} else {
				c.getOutStream().writeByte(amount);
			}
			c.getOutStream().endFrameVarSizeWord();
			c.flushOutStream();
		}
	}
}

public void refreshduelRules() {
	for(int i = 0; i &lt; c.duelRule.length; i++) {	
		c.duelRule[i] = false;
	}
	c.getPA().sendFrame87(286, 0);
	c.duelOption = 0;
}

public void refreshDuelScreen() {
	synchronized(c) {
		Client o = (Client) Server.playerHandler.players[c.duelingWith];
		if(o == null) {
			return;
		}
		c.getOutStream().createFrameVarSizeWord(53);
		c.getOutStream().writeWord(6669);
		c.getOutStream().writeWord(stakedItems.toArray().length);
		int current = 0;
		for(GameItem item : stakedItems) {
			if (item.amount &gt; 254) {
				c.getOutStream().writeByte(255); 
				c.getOutStream().writeDWord_v2(item.amount);	
			} else  {
				c.getOutStream().writeByte(item.amount);
			}
			if (item.id &gt; Config.ITEM_LIMIT || item.id &lt; 0) {
				item.id = Config.ITEM_LIMIT;
			}
			c.getOutStream().writeWordBigEndianA(item.id + 1);
			
			current++;
		}
		
		if(current &lt; 27) {
			for(int i = current; i &lt; 28; i++) {
				c.getOutStream().writeByte(1);
				c.getOutStream().writeWordBigEndianA(-1);
			}
		}
		c.getOutStream().endFrameVarSizeWord();
		c.flushOutStream();
		
		c.getOutStream().createFrameVarSizeWord(53);
		c.getOutStream().writeWord(6670);
		c.getOutStream().writeWord(o.getTradeAndDuel().stakedItems.toArray().length);
		current = 0;	
		for (GameItem item : o.getTradeAndDuel().stakedItems) {
			if (item.amount &gt; 254) {
				c.getOutStream().writeByte(255);
				c.getOutStream().writeDWord_v2(item.amount);
			}  else  {
				c.getOutStream().writeByte(item.amount);
			}
			if (item.id &gt; Config.ITEM_LIMIT || item.id &lt; 0) {
				item.id = Config.ITEM_LIMIT;
			}
			c.getOutStream().writeWordBigEndianA(item.id + 1);
			current++;
		}
		
		if(current &lt; 27) {
			for(int i = current; i &lt; 28; i++) {
				c.getOutStream().writeByte(1);
				c.getOutStream().writeWordBigEndianA(-1);
			}
		}
		c.getOutStream().endFrameVarSizeWord();
		c.flushOutStream();
	}
}


public boolean stakeItem(int itemID, int fromSlot, int amount) {
	
	for (int i : Config.ITEM_TRADEABLE) {
	if(i == itemID) {
			return true;
		}	
	}
	if (amount &lt;= 0)
		return false;
	Client o = (Client) Server.playerHandler.players[c.duelingWith];
	if (o == null ) {
		declineDuel();
		return false;
	}
	if (o.duelStatus &lt;= 0 || c.duelStatus &lt;= 0) {
		declineDuel();
		o.getTradeAndDuel().declineDuel();
		return false;
	}
	if (!c.canOffer) {
		return false;
	}
	changeDuelStuff();
	if(!Item.itemStackable[itemID]) {
		for(int a = 0; a &lt; amount; a++) {
			if(c.getItems().playerHasItem(itemID, 1)) {
				stakedItems.add(new GameItem(itemID, 1));	
				c.getItems().deleteItem(itemID, c.getItems().getItemSlot(itemID), 1);
			}
		}		
		c.getItems().resetItems(3214);
		c.getItems().resetItems(3322);
		o.getItems().resetItems(3214);
		o.getItems().resetItems(3322);
		refreshDuelScreen();
		o.getTradeAndDuel().refreshDuelScreen();
		c.getPA().sendFrame126("", 6684);
		o.getPA().sendFrame126("", 6684);
	}
	
	if(!c.getItems().playerHasItem(itemID, amount)) {
		return false;
	}
	if (Item.itemStackable[itemID] || Item.itemIsNote[itemID]) {
		boolean found = false;
		for (GameItem item : stakedItems) {
			if (item.id == itemID) {
				found = true;
				item.amount += amount;
				c.getItems().deleteItem(itemID, fromSlot, amount);
				break;
			}
		}
		if (!found) {
			c.getItems().deleteItem(itemID, fromSlot, amount);
			stakedItems.add(new GameItem(itemID, amount));
		}
	}
	
	c.getItems().resetItems(3214);
	c.getItems().resetItems(3322);
	o.getItems().resetItems(3214);
	o.getItems().resetItems(3322);
	refreshDuelScreen();
	o.getTradeAndDuel().refreshDuelScreen();
	c.getPA().sendFrame126("", 6684);
	o.getPA().sendFrame126("", 6684);
	return true;
}[/code]</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283/2</link>
        <pubDate>Mon, 04 Jul 2011 14:08:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-402283-2</guid>
        <source url="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283.rss">Moderator Lock / Problem Solved</source>
      </item>
      <item>
        <title>Moderator Lock / Problem Solved</title>
        <dc:creator><![CDATA[@nicke924 nicke924]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nicke924">@nicke924</a> wrote:</p>
          <blockquote>
              <p>Solved. Mod Lock</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283/1</link>
        <pubDate>Mon, 04 Jul 2011 12:02:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-402283-1</guid>
        <source url="https://forum.moparisthebest.com/t/moderator-lock-problem-solved/402283.rss">Moderator Lock / Problem Solved</source>
      </item>
  </channel>
</rss>
