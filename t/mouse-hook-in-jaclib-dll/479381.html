<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/mouse-hook-in-jaclib-dll/479381 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 06:42:30 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Mouse hook in jaclib.dll - Runescape - moparisthebest.com</title>
    <meta name="description" content="So, there&amp;#39;s a function in jaclib.dll that is named as if it is some sort of wrapper around ping. Currently it&amp;#39;s exported as _stdcall Javajaclib_ping_IcmpService_run. 

But, it does some things that are very much not as i&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="479381.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Mouse hook in jaclib.dll&#39;" href="479381.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/mouse-hook-in-jaclib-dll/479381" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/mouse-hook-in-jaclib-dll/479381" />
<meta property="og:title" content="Mouse hook in jaclib.dll" />
<meta name="twitter:title" content="Mouse hook in jaclib.dll" />
<meta property="og:description" content="So, there’s a function in jaclib.dll that is named as if it is some sort of wrapper around ping. Currently it’s exported as __stdcall Java_jaclib_ping_IcmpService_run.  But, it does some things that are very much not as it’s named.  Firstly, it does some JNI stuff to get a handle to a function named ‘notify’ in the client with signature (I)V. Then it installs a message hook to all windows capturing low level mouse events and sits in a loop plucking messages:  v5 = SetWindowsHookExA(14, fn, hmod,..." />
<meta name="twitter:description" content="So, there’s a function in jaclib.dll that is named as if it is some sort of wrapper around ping. Currently it’s exported as __stdcall Java_jaclib_ping_IcmpService_run.  But, it does some things that are very much not as it’s named.  Firstly, it does some JNI stuff to get a handle to a function named ‘notify’ in the client with signature (I)V. Then it installs a message hook to all windows capturing low level mouse events and sits in a loop plucking messages:  v5 = SetWindowsHookExA(14, fn, hmod,..." />
<meta property="article:published_time" content="2013-01-25T00:02:35+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="479381.html">Mouse hook in jaclib.dll</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Mopman.html'><span itemprop='name'>Mopman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-01-25T00:02:35Z'>
            <time itemprop='dateModified' datetime='2016-08-04T02:19:43Z' class='post-time'>
              August 4, 2016,  2:19am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>So, there’s a function in jaclib.dll that is named as if it is some sort of wrapper around ping. Currently it’s exported as __stdcall Java_jaclib_ping_IcmpService_run.</p>
<p>But, it does some things that are very much not as it’s named.</p>
<p>Firstly, it does some JNI stuff to get a handle to a function named ‘notify’ in the client with signature (I)V. Then it installs a message hook to all windows capturing low level mouse events and sits in a loop plucking messages:</p>
<pre><code class="lang-auto">v5 = SetWindowsHookExA(14, fn, hmod, 0);
/* some stuff /*
while ( GetMessageA(&amp;Msg, 0, 0, 0) )
{
  TranslateMessage(&amp;Msg);
  DispatchMessageA(&amp;Msg);
}
UnhookWindowsHookEx(hhk);</code></pre>
<p>The messages go to a callback that basically just calls the notify function mentioned earlier with the only interesting parameter being a pointer into the MSLLHOOKSTRUCT Windows gives you with that message.</p>
<p>I know I’m not the first to discover this (well, I found it ages ago actually, so I might have been, but I know others know about it now since if you google the method there is a pastebin result) but what I don’t know is what its for.</p>
<p>MSLLHOOKSTRUCT contains some innocuous data like the point info, but more importantly it contains the LLMHF_INJECTED flag, which if set = this event was artificially created using SendInput or similar rather than through hardware. This makes this function a potential Simba/RiD trap, no?</p>
<p>If it is, though, why haven’t they been using it? Does anyone with more intimate knowledge of the client know what the notify method does?</p>
<p>It’s perhaps possible that they use this just for input on their Window I guess, but why hook all windows (they have the handle at this point) and why name it as if its something its not?</p>
      </div>

      <meta itemprop='headline' content='Mouse hook in jaclib.dll'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Echo3.html'><span itemprop='name'>Echo3</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-01-25T05:33:26Z'>
            <time itemprop='dateModified' datetime='2016-08-04T02:20:17Z' class='post-time'>
              August 4, 2016,  2:20am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>BenLand100’s opinion:</p>
<blockquote>Someone posts some scary looking source code with a few renamed variables to 'mouse_hook' and everyone shits themselves.
DID ANYONE CONSIDER THAT THIS IS RELATED TO FULLSCREEN RS WHICH REQUIRES SPECIAL HANDLING OF MOUSE EVENTS if it's even real at all? lol
It's all complete fodder imho, nothing to see here, move along.</blockquote>
      </div>

      <meta itemprop='headline' content='Mouse hook in jaclib.dll'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Mopman.html'><span itemprop='name'>Mopman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-01-25T08:07:28Z'>
            <time itemprop='dateModified' datetime='2016-08-04T02:20:26Z' class='post-time'>
              August 4, 2016,  2:20am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I didn’t rename anything actually - a couple of things IDA renamed, most of it is unnamed. And yes, I did consider that - because I said it, in my post. But yes, he is free to speculate and assume that they don’t make use of the obvious detection avenue there, as I am free to speculate that they do.</p>
<p>As for ‘if its even real at all’ - open up a disassembler, stick it on jaclib.dll, search the import table for SetWindowsHookEx and display usages.</p>
<p>EDIT Ah he was referring to the one on pastebin (probably super_s) which was more heavily renamed, I see. He’s still dumb, though.</p>
<p>I hate you in the face Echo_ - I just read that thread and now my head hurts <img src="../../images/emoji/twitter/smileyae52.png?v=5" title=":smiley:" class="emoji" alt=":smiley:"></p>
<p>(But srsly, thanks for referencing it anyway)</p>
<p>EDIT2 So Benland thinks its for full screen, Super thinks its for blocking awt events with no matching os event - both kinda valid theories, and luckily both testable. I’ll have a play after work today and post results.</p>
<p>Also, can someone point me in the direction of people still playing with this goddamn client :[</p>
      </div>

      <meta itemprop='headline' content='Mouse hook in jaclib.dll'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Metho_D.html'><span itemprop='name'>Metho_D</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-01-25T18:30:42Z'>
            <time itemprop='dateModified' datetime='2016-08-04T02:21:12Z' class='post-time'>
              August 4, 2016,  2:21am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Is the three-argument notify method used natively at all? I remember tracing the code for that and saw the client sending the data off to the server.</p>
      </div>

      <meta itemprop='headline' content='Mouse hook in jaclib.dll'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Echo3.html'><span itemprop='name'>Echo3</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-01-26T00:37:27Z'>
            <time itemprop='dateModified' datetime='2016-08-04T02:21:34Z' class='post-time'>
              August 4, 2016,  2:21am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="4" data-topic="479381">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/method/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> Method:</div>
<blockquote>
<p>Is the three-argument notify method used natively at all? I remember tracing the code for that and saw the client sending the data off to the server.</p>
</blockquote>
</aside>
<p>It must, notify(I)V is called natively but the code for it in the client doesn’t do anything.</p>
<p>[code=java]   protected void notify(int var1) {<br>
try {<br>
Iterator var2 = this.m.iterator();</p>
<pre><code>     while(var2.hasNext()) {
        sn var3 = (sn)var2.next();
        var3.i(var1 == 0, 417041762);
     }

  } catch (RuntimeException var4) {
     throw abn.m(var4, "afh.notify(" + ')');
  }
</code></pre>
<p>}</p>
<pre><code>// sn is an interface, the only class that implements it defines i(ZI)V as this:
</code></pre>
<p>public void i(boolean var1, int var2) {<br>
try {<br>
;<br>
} catch (RuntimeException var3) {<br>
throw abn.m(var3, “ri.i(” + ‘)’);<br>
}<br>
}[/code]</p>
<p>Although I guess they could do something like:</p>
<p>[code=java]sn element = new sn() {<br>
<a class="mention" href="../../u/override.html">@Override</a><br>
public void i(boolean var1, int var2) {<br>
// implementation<br>
}<br>
};</p>
<p>//add element to list[/code]</p>
      </div>

      <meta itemprop='headline' content='Mouse hook in jaclib.dll'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/silabsoft.html'><span itemprop='name'>silabsoft</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-01-27T19:22:07Z'>
            <time itemprop='dateModified' datetime='2016-08-04T02:24:31Z' class='post-time'>
              August 4, 2016,  2:24am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>this is <a href="http://moparisthebest.com/" rel="nofollow noopener">moparisthebest.com</a> being productive is not allowed</p>
      </div>

      <meta itemprop='headline' content='Mouse hook in jaclib.dll'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/n3ss3s.html'><span itemprop='name'>n3ss3s</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-02-02T07:50:36Z'>
            <time itemprop='dateModified' datetime='2016-08-04T02:31:56Z' class='post-time'>
              August 4, 2016,  2:31am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Can you find fn?</p>
      </div>

      <meta itemprop='headline' content='Mouse hook in jaclib.dll'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-02-23T05:35:02Z'>
            <time itemprop='dateModified' datetime='2016-08-04T03:55:04Z' class='post-time'>
              August 4, 2016,  3:55am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>GG Mopman I showed you this several months back. Benland100 wouldn’t be so quick to shoot this down if he knew it sent mouse data (position, time) collected from both the native hook and an AWT listener to the server for comparison… a cheat which doesn’t use the real mouse would easily be detected.</p>
      </div>

      <meta itemprop='headline' content='Mouse hook in jaclib.dll'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pwnd.html'><span itemprop='name'>Pwnd</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-03-01T17:39:02Z'>
            <time itemprop='dateModified' datetime='2016-08-04T04:54:54Z' class='post-time'>
              August 4, 2016,  4:54am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Miss Silabsoft, post:6, topic:479381”]this is <a href="http://moparisthebest.com/" rel="nofollow noopener">moparisthebest.com</a> being productive is not allowed[/quote]Stop spamming you stupid cunt</p>
      </div>

      <meta itemprop='headline' content='Mouse hook in jaclib.dll'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/mouse-hook-in-jaclib-dll/479381 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 06:42:31 GMT -->
</html>
