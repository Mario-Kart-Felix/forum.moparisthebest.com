<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Deob quality</title>
    <link>https://forum.moparisthebest.com/t/deob-quality/1518</link>
    <description>I&#39;m talking about things like false arguments, unnecessary code, and shifting orders. Has anyone worked on eliminating these sorts of things? I have a small example (based on some really mystifying code in a few RS2 client methods)

Before
[code]
public class Test {
    public static void main(String args[]) {
        int i = meth((byte)45, 32, &quot;system&quot;);
        System.out.println(&quot;Result: &quot; + i);
    }

    public static int meth(byte byte0, int i, String s) {
        if(byte0 != 45) {
            throw new NullPointerException();
        } else {
            System.out.println(s + i);
            return i + 37;
        }
    }
}
[/code]

After
[code]
public class Test {
    public static void main(String args[]) {
        int i = meth(32, &quot;system&quot;);
        System.out.println(&quot;Result: &quot; + i);
    }

    public static int meth(int i, String s) {
        System.out.println(s + i);
        return i + 37;
    }
}
[/code]

Also, if I released some new transformers for saevion&#39;s deobfuscator, would anyone know what to do with them?</description>
    
    <lastBuildDate>Tue, 16 May 2006 03:24:08 +0000</lastBuildDate>
    <category>Community Inside Talk</category>
    <atom:link href="https://forum.moparisthebest.com/t/deob-quality/1518.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="18" data-topic="1518"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forum.moparisthebest.mopar/letter_avatar_proxy/v2/letter/p/67e7ee/40.png" class="avatar">philodespotos:</div>
<blockquote>
<p>When I first started writing factor, I wanted to eventually be able to produce a fully stripped + renamed client. Obviously, that never happened, but I did get around to writing a completely broken and useless garbage stripper. Actually, it was written almost a month before any of the other parts of factor were produced. I've since svn rm'd it, as it was my first time to touch BCEL and didn't amount to much, but I co'd revision 1 of factor so I could provide it here, in case someone finds it useful.</p>
<p>The code is very ugly, a complete cludge, and was never intended to see the light of day. At least not in this condition. I abandoned it for good reason.</p>
<p>You've been forewarned.</p>
<p>Posted it on the easybake site. <a href="http://easyFFSbakeCENSORSjewsAREEVIL.com/smf/index.php?action=tpmod;dl=item4" rel="nofollow">http://easyFFSbakeCENSORSjewsAREEVIL.com/smf/index.php?action=tpmod;dl=item4</a></p>
<p>There's a useless README which details the problems I ran into, but like I said, it was my first time in BCEL, which isn't exactly a prime example of a well documented library. Beyond the obvious bugs I list, the problem that made me straight give up was trying to figure out a clean way to fix the method calls.</p>
<p>It's been many months since I wrote this, and I haven't bothered to look back at the code, but maybe I will after this new "big update" is released.</p>
</blockquote></aside>

<p>thanks Ill take a look at it</p>

<p>and lol, it was exemplar that asked me to add the censor because too many newbs were going to your forums, I can remove it if you would like <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/wink.png?v=3" title=":wink:" class="emoji" alt=":wink:"> <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/smiley.png?v=3" title=":smiley:" class="emoji" alt=":smiley:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/20">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/20</link>
        <pubDate>Tue, 16 May 2006 03:24:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-20</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="17" data-topic="1518"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forum.moparisthebest.mopar/letter_avatar_proxy/v2/letter/f/a4c791/40.png" class="avatar">Freddy1990:</div>
<blockquote><p>That would be the vb and delphi cup, lol<br>and btw, r u printing a 500 pages ebook? <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/stuck_out_tongue.png?v=3" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p></blockquote></aside>

<p>I've read it already xD</p>

<p>Link is dead, by the way <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/smiley.png?v=3" title=":smiley:" class="emoji" alt=":smiley:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/19</link>
        <pubDate>Tue, 16 May 2006 01:36:16 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-19</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@philodespotos philodespotos]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/philodespotos">@philodespotos</a> wrote:</p>
          <blockquote>
              <p>When I first started writing factor, I wanted to eventually be able to produce a fully stripped + renamed client. Obviously, that never happened, but I did get around to writing a completely broken and useless garbage stripper. Actually, it was written almost a month before any of the other parts of factor were produced. I've since svn rm'd it, as it was my first time to touch BCEL and didn't amount to much, but I co'd revision 1 of factor so I could provide it here, in case someone finds it useful.</p>

<p>The code is very ugly, a complete cludge, and was never intended to see the light of day. At least not in this condition. I abandoned it for good reason.</p>

<p>You've been forewarned.</p>

<p>Posted it on the easybake site. <a href="http://easyFFSbakeCENSORSjewsAREEVIL.com/smf/index.php?action=tpmod;dl=item4" rel="nofollow">http://easyFFSbakeCENSORSjewsAREEVIL.com/smf/index.php?action=tpmod;dl=item4</a></p>

<p>There's a useless README which details the problems I ran into, but like I said, it was my first time in BCEL, which isn't exactly a prime example of a well documented library. Beyond the obvious bugs I list, the problem that made me straight give up was trying to figure out a clean way to fix the method calls.</p>

<p>It's been many months since I wrote this, and I haven't bothered to look back at the code, but maybe I will after this new "big update" is released.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/18</link>
        <pubDate>Tue, 16 May 2006 01:30:35 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-18</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Freddy1990 Freddy1990]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/freddy1990">@Freddy1990</a> wrote:</p>
          <blockquote>
              <p>That would be the vb and delphi cup, lol<br>and btw, r u printing a 500 pages ebook? <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/stuck_out_tongue.png?v=3" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/17</link>
        <pubDate>Sun, 23 Apr 2006 17:08:58 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-17</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <p>Freddy, what the fuck are those two awards under your scripters cup? <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/open_mouth.png?v=3" title=":open_mouth:" class="emoji" alt=":open_mouth:"></p>

<p>Also, I'm going to hold off on java until I get the rest of this e-book printed.  It's helped an assload so far.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/16</link>
        <pubDate>Sun, 23 Apr 2006 17:01:01 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-16</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Freddy1990 Freddy1990]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/freddy1990">@Freddy1990</a> wrote:</p>
          <blockquote>
              <p>Ok, i've tried this, after puzzling a bit for like half an hour i was able to get rid of all compile errors and most of the running errors (i aven had to extract the bcel and regexp jar etc..., lol) but now i can't seem to get any further =/<br><img src="http://img170.imageshack.us/img170/8207/errorlol5gx.png" width="" height=""><br>But atleast i tried <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/slight_smile.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/15</link>
        <pubDate>Sun, 23 Apr 2006 14:59:06 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-15</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>no you didnt sound unappreciated, I just figured thats how you probably felt, doing all that work and noone saying anything and all <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/wink.png?v=3" title=":wink:" class="emoji" alt=":wink:"> <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/smiley.png?v=3" title=":smiley:" class="emoji" alt=":smiley:"></p>

<p>and I dont post much for the same reason Freddy1990, hopefully not for long though <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/wink.png?v=3" title=":wink:" class="emoji" alt=":wink:"> <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/smiley.png?v=3" title=":smiley:" class="emoji" alt=":smiley:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/14</link>
        <pubDate>Sun, 23 Apr 2006 05:32:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-14</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Freddy1990 Freddy1990]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/freddy1990">@Freddy1990</a> wrote:</p>
          <blockquote>
              <p>Actually the reason why i dun post too much is because i dunno how to work bcel</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/13</link>
        <pubDate>Sat, 22 Apr 2006 20:48:25 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-13</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <p>Did I give off an "oh-so-unappreciated" vibe with that last one? If so, I apologize to pplsuqbawlz for stealing his lines <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/stuck_out_tongue.png?v=3" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> I wasn't really talking about you as in "THIS MEANS YOU, MOPAR" but more you as in "people in general who might want something before I go off on an irrelevant tangent"</p>

<p>Upon rereading, that paragraph sounds just barely coherent to me, and I know what I'm trying to talk about.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/12</link>
        <pubDate>Sat, 22 Apr 2006 19:11:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-12</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>Im sorry if the lack of posting replies makes you feel unappreciated Krichevskoy, I personally think its awesome, and I understand the general premise of what you are doing but at the moment the last big paragraph you posted might as well be in greek or somthing, one day I will understand it though, Im learning <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/wink.png?v=3" title=":wink:" class="emoji" alt=":wink:"> <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/smiley.png?v=3" title=":smiley:" class="emoji" alt=":smiley:"></p>

<p>Thanks alot, and it sounds awesome <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/slight_smile.png?v=3" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/11</link>
        <pubDate>Sat, 22 Apr 2006 00:00:51 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-11</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="7" data-topic="1518"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/moparisthebest/40/30_1.png" class="avatar">moparisthebest:</div>
<blockquote><p>constant argument order would be like a dream come true, you have no idea how hard it is to update even somthing as simple as the 2 parameter doaction() with its ever changing order if you havent done so before <img src="https://forum.moparisthebest.com/images/emoji/emoji_one/stuck_out_tongue.png?v=3" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> <img src="https://forum.moparisthebest.com/images/emoji/emoji_one/smiley.png?v=3" title=":smiley:" class="emoji" alt=":smiley:"></p></blockquote></aside>

<p>Heh, for doAction() I think I can do better than constant order <img src="https://forum.moparisthebest.com/images/emoji/emoji_one/smiley.png?v=3" title=":smiley:" class="emoji" alt=":smiley:"></p>

<p>Take a look at that method across several versions. Notice anything?  </p>

<p></p><pre><code class="lang-auto">public void method60(byte byte0, int i)
    {
        if(i &lt; 0)
            return;</code></pre>

<p></p><pre><code class="lang-auto">    public final void method120(int i, boolean flag)
    {
        if(i &lt; 0)
            return;</code></pre>

<p></p><pre><code class="lang-auto">    public void doAction(int i, int j)
    {
        j = 90 / j;
        if(i &lt; 0)
            return;</code></pre>

<p>Well, that's not all the code, but it's a big method. Point is, one of the arguments is always bogus. The CORRECT argument will be the one whose zero value would kill the method. With that detected, it would be fairly simple to pick the argument index from the load command in that conditional. The trick is eliminating the other one - I can remove it from the method itself and change the signature, but how to handle the method calls' now-extraneous PUSH commands?</p>

<p>[time passes in which I do homework and figure this out]</p>

<p>This isn't the pretty solution I'd hoped for but it's caused me to develop some useful methods for my growing BCEL toolkit class. The main criterion here is that it appears to work. I haven't tested it yet but it accomplishes its primary goal (removing the argument) even if it might break something in the client (don't know yet). I present to you...DoActionFixer!</p>

<p></p><pre><code class="lang-auto">/**
 * Date: Apr 19, 2006
 * Time: 07:58:37 PM
 *
 * A BCEL demo, essentially. It removes the useless argument from the "doAction"
 * method in the RuneScape 2 client. Uses saevion's MethodID class because I needed
 * something like it and didn't want to write a useless copy.
 * Built and tested in release #372, not guaranteed to work with further versions.
 * @author Krichevskoy
 */
import org.apache.bcel.classfile.*;
import org.apache.bcel.generic.*;
import org.apache.bcel.Repository;
import org.apache.bcel.util.InstructionFinder;
import org.apache.bcel.util.InstructionFinder.CodeConstraint;
import java.util.Iterator;
import java.util.ArrayList;
public class DoActionFixer {
    private static MethodID doAction = null;

public static void main(String[] args) throws java.io.IOException {
 try {
    JavaClass clazz = Repository.lookupClass("client");
    Method[] methods = clazz.getMethods();
    ConstantPoolGen cpg = new ConstantPoolGen(clazz.getConstantPool());

    //edit loop
    for(int i = 0; i &lt; methods.length; i++) {
        MethodGen mg = new MethodGen(methods[i], clazz.getClassName(), cpg);
        if(mg.getName().equals("method60")) {
            mg = deleteCodeBlockPattern(infiniteLoopTrapPattern,mg);
            mg = fixDoActionArguments(mg);
        }
        if(mg.getMethod() != null)
            methods[i] = mg.getMethod();
    }

    //cleanup loop
    for(int i = 0; i &lt; methods.length; i++) {
        MethodGen mg = new MethodGen(methods[i], clazz.getClassName(), cpg);
        mg = cleanupDoActionRefs(mg);
        mg.stripAttributes(true);
        if(mg.getMethod() != null)
            methods[i] = mg.getMethod();
    }

    clazz.setConstantPool(cpg.getFinalConstantPool());
    clazz.dump(clazz.getClassName() + "_edit.class");
 } catch (ClassNotFoundException e) {e.printStackTrace();}
}

public static MethodGen fixDoActionArguments(MethodGen mg) {
    InstructionList il = mg.getInstructionList();
    InstructionFinder finder = new InstructionFinder(il);
    ConstantPoolGen cpg = mg.getConstantPool();
    int realArgIdx = -1;
    int fakeArgIdx = -1;

    for(Iterator&lt;InstructionHandle[]&gt; iter = finder.search("ILOAD IFGE RETURN"); iter.hasNext();) {
        InstructionHandle[] match = iter.next();
        InstructionHandle ih = match[0];
        LocalVariableInstruction lvi = (LocalVariableInstruction)ih.getInstruction();
        realArgIdx = lvi.getIndex();
        System.out.println("real idx = "+realArgIdx);
    }

    if(realArgIdx == 1)
        fakeArgIdx = 2;
    else if(realArgIdx == 2)
        fakeArgIdx = 1;

    int index = cpg.lookupMethodref(mg);
    ConstantMethodref cmr = (ConstantMethodref)cpg.getConstant(index);
    ConstantNameAndType cnat = (ConstantNameAndType)cpg.getConstant(cmr.getNameAndTypeIndex());
    ConstantUtf8 sig = (ConstantUtf8)cpg.getConstant(cnat.getSignatureIndex());
    String rawSig = sig.getBytes();
    //This allows you to handle the signature by index and reassemble it easily.
    ArrayList&lt;String&gt; parsedSig = parseMethodSignature(rawSig);
    System.out.println(parsedSig);
    parsedSig.remove(fakeArgIdx-1);
    StringBuilder sb = new StringBuilder("(");
    for(Iterator&lt;String&gt; it = parsedSig.iterator(); it.hasNext();) {
        sb.append(it.next());
    }
    sb.append(rawSig.substring(rawSig.indexOf(")")));
    sig.setBytes(sb.toString());
    if(realArgIdx == 2)
        mg = decLocalVarIndex(realArgIdx,mg);
    doAction = new MethodID(mg.getName(),sb.toString(),mg.getClassName());
    return mg;
}

public static MethodGen cleanupDoActionRefs(MethodGen mg) {
    InstructionList il = mg.getInstructionList();
    InstructionFinder finder = new InstructionFinder(il);
    final ConstantPoolGen cpg = mg.getConstantPool();

    for(Iterator&lt;InstructionHandle[]&gt; i = finder.search("InvokeInstruction", new CodeConstraint() {
        public boolean checkCode(InstructionHandle[] match) {
            InvokeInstruction invoke = (InvokeInstruction)(match[0].getInstruction());
            if(invoke.getMethodName(cpg).equals(doAction.getName())) {
                return true;
            } else {
                return false;
            }
        }
    }); i.hasNext();) {
        InstructionHandle[] match = i.next();
        InstructionHandle ih = match[match.length-1];
        //could also use instanceof PushInstruction perhaps
        while(!(ih.getInstruction() instanceof BIPUSH)) {
            ih = ih.getPrev();
        }
        try {
            il.delete(ih);
        } catch(TargetLostException e) {
            InstructionHandle[] targets = e.getTargets();
                for(int c = 0; c &lt; targets.length; c++) {
                    InstructionTargeter[] targeters = targets[c].getTargeters();
                    for(int j = 0; j &lt; targeters.length; j++)
                        targeters[j].updateTarget(targets[c], match[match.length - 1].getNext());
                }
        }
    }
    return mg;
}

public static MethodGen decLocalVarIndex(int idx, MethodGen mg) {
    InstructionList il = mg.getInstructionList();
    InstructionHandle[] handles = il.getInstructionHandles();
    for(int i = 0; i &lt; handles.length; i++) {
        InstructionHandle ih = handles[i];
        Instruction in = ih.getInstruction();
        if(in instanceof LocalVariableInstruction) {
            LocalVariableInstruction lvi = (LocalVariableInstruction)in;
            if(lvi.getIndex() == idx)
                lvi.setIndex(lvi.getIndex() - 1);
        }
    }
    return mg;
}

//the magic behind objectified signatures
public static ArrayList&lt;String&gt; parseMethodSignature(String sig) {
    ArrayList&lt;String&gt; parts = new ArrayList&lt;String&gt;();
    StringBuilder sb = new StringBuilder(sig);
    boolean isArray = false;
    for(int c = 0; c &lt; sb.length(); c++) {
        char ch = sb.charAt(c);
        switch(ch) {
            case '(':
                continue;
            case ')':
                break;
            case '[':
                isArray = true;
                continue;
            case 'L':
                String s = sb.substring(c,sb.indexOf(";",c)) + ";";
                if(isArray) {
                    s = "[" + s;
                    parts.add(s);
                    c += s.length() - 1;
                    isArray = false;
                    continue;
                }
                parts.add(s);
                c += s.length();
                continue;
            default:
                if(isArray) {
                    parts.add("["+String.valueOf(ch));
                    c += 2;
                    isArray = false;
                } else
                    parts.add(String.valueOf(ch));
        }
    }
    parts.remove(parts.size()-1);
    return parts;
}

public static MethodGen deleteCodeBlockPattern(String pattern, MethodGen mg) {
    InstructionList il = mg.getInstructionList();
    InstructionFinder finder = new InstructionFinder(il);
    InstructionHandle next = null;

    for(Iterator i = finder.search(pattern); i.hasNext(); ) {
        InstructionHandle[] match = (InstructionHandle[])i.next();
        InstructionHandle   first = match[0];
        InstructionHandle   last  = match[match.length - 1];

        if((next = last.getNext()) == null)
            break;

        try {
            il.delete(first, last);
        } catch(TargetLostException e) {
            InstructionHandle[] targets = e.getTargets();
            for(int c = 0; c &lt; targets.length; c++) {
                InstructionTargeter[] targeters = targets[c].getTargeters();

                for(int j = 0; j &lt; targeters.length; j++)
                    targeters[j].updateTarget(targets[c], next);
            }
        }
    }
    return mg;
}

static String infiniteLoopTrapPattern = "ILOAD BIPUSH IF_ICMPEQ ICONST ISTORE ILOAD IFLE IINC GOTO";
}</code></pre>

<p>Of course it should be trivial to replace the "method60" string with a method for identifying that method via bytecode pattern.</p>

<p><a href="http://www.upit.be/download.php?id=199" rel="nofollow">Download Source + MethodID</a></p>

<p>[br][size=1]Posted at: April 19, 2006, 06:38:44 pm[/size][hr]What are the odds there would be an update today?<br>Time to version-proof it I guess. [br][size=1]Posted at: April 20, 2006, 02:10:10 pm[/size][hr]So this is obviously a more cumbersome task than I had originally imagined (almost 300 lines of code to remove one argument from one method that's only called three times), but it's also not as impossibly difficult as I thought it might turn out to be. I plan to create a method for manipulating stack instructions prior to an invoke in a similar manner to my current signature parsing method. Then it would be simple to rearrange arguments and the method references' stacks, which could be made constant with some additional identification. As of right now I don't think a wholesale stabilization program is feasable (I see how it could be done, I just don't want to do it :P) so I might be developing this thing on a request basis, at least for a little while. If you have any particular method(s) you want an argument fixer for, post here and I'll see if I can make it work. Otherwise, I'm going to continue with my stack instruction parsing thing which may or may not turn out to be relevant to anything you, as a developer, might want.</p>

<p>Also, I think I might have to modify saevion's program a bit to get this sort of thing to work as a transformer. internalTransform()'s MethodGen access just isn't enough, reference cleanup needs the whole JavaClass.</p>

<p>Updated to release <span class="hashtag">#373</span></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/10</link>
        <pubDate>Fri, 21 Apr 2006 22:16:57 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-10</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <p>Ppl, you don't know any java, silly ;D</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/9</link>
        <pubDate>Wed, 19 Apr 2006 19:14:48 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-9</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@pplsuqbawlz pplsuqbawlz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pplsuqbawlz">@pplsuqbawlz</a> wrote:</p>
          <blockquote>
              <p><em>Teases</em> I wouldnt.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/8</link>
        <pubDate>Wed, 19 Apr 2006 15:48:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-8</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="6" data-topic="1518"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forum.moparisthebest.mopar/letter_avatar_proxy/v2/letter/k/96bed5/40.png" class="avatar">Krichevskoy:</div>
<blockquote><p>Right, well, nice to see a positive response. I've got several ideas that I'd like to try. Code stripping, making argument orders constant, perhaps trying to support higher levels of obfuscation, stuff like that. It remains to be seen whether I'll get any of it to a level I'm happy with, but it's something to work on that's more interesting than scripting methods.</p></blockquote></aside>

<p>constant argument order would be like a dream come true, you have no idea how hard it is to update even somthing as simple as the 2 parameter doaction() with its ever changing order if you havent done so before <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/stuck_out_tongue.png?v=3" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/smiley.png?v=3" title=":smiley:" class="emoji" alt=":smiley:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/7</link>
        <pubDate>Wed, 19 Apr 2006 01:49:36 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-7</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <p>Right, well, nice to see a positive response. I've got several ideas that I'd like to try. Code stripping, making argument orders constant, perhaps trying to support higher levels of obfuscation, stuff like that. It remains to be seen whether I'll get any of it to a level I'm happy with, but it's something to work on that's more interesting than scripting methods.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/6</link>
        <pubDate>Wed, 19 Apr 2006 00:05:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-6</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <p>I'd sure as hell lke to try as well.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/5</link>
        <pubDate>Tue, 18 Apr 2006 22:22:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-5</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Freddy1990 Freddy1990]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/freddy1990">@Freddy1990</a> wrote:</p>
          <blockquote>
              <p>hmm, dunno how to use em, but i'm sure i could find out =P</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/4</link>
        <pubDate>Tue, 18 Apr 2006 19:14:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-4</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Nerice Nerice]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nerice">@Nerice</a> wrote:</p>
          <blockquote>
              <p>Yeah i could use transforms... would I depended upon what they was for?</p>

<p>My current updater I use i could have it search for useless stuff and remove it all. Like variables assigned but never used, method parameters that are never used etc...</p>

<p>I just dont do it since it would A. take more time to analyze and remove the code and. B. dont see a problem with leaving it there.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/3</link>
        <pubDate>Tue, 18 Apr 2006 06:50:10 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-3</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="1" data-topic="1518"><div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="//forum.moparisthebest.mopar/letter_avatar_proxy/v2/letter/k/96bed5/40.png" class="avatar">Krichevskoy:</div>
<blockquote><p>Also, if I released some new transformers for saevion's deobfuscator, would anyone know what to do with them?</p></blockquote></aside>

<p>I WOULD I WOULD!!!!! <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/stuck_out_tongue.png?v=3" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>

<p>I would add them to my auto-deob maker, but dont bother making one that publicizes everything, because I already got one of those <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/wink.png?v=3" title=":wink:" class="emoji" alt=":wink:"> <img src="//forum.moparisthebest.mopar/images/emoji/emoji_one/smiley.png?v=3" title=":smiley:" class="emoji" alt=":smiley:"> (edit: that apparantly was written by SeanWT)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/2</link>
        <pubDate>Tue, 18 Apr 2006 04:18:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-2</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
      <item>
        <title>Deob quality</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <p>I'm talking about things like false arguments, unnecessary code, and shifting orders. Has anyone worked on eliminating these sorts of things? I have a small example (based on some really mystifying code in a few RS2 client methods)</p>

<p>Before<br></p>

<p></p><pre><code class="lang-auto">public class Test {
    public static void main(String args[]) {
        int i = meth((byte)45, 32, "system");
        System.out.println("Result: " + i);
    }
    public static int meth(byte byte0, int i, String s) {
    if(byte0 != 45) {
        throw new NullPointerException();
    } else {
        System.out.println(s + i);
        return i + 37;
    }
}
}</code></pre>

<p>After<br></p>

<p></p><pre><code class="lang-auto">public class Test {
    public static void main(String args[]) {
        int i = meth(32, "system");
        System.out.println("Result: " + i);
    }
    public static int meth(int i, String s) {
    System.out.println(s + i);
    return i + 37;
}
}</code></pre>

<p>Also, if I released some new transformers for saevion's deobfuscator, would anyone know what to do with them?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/deob-quality/1518/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/deob-quality/1518/1</link>
        <pubDate>Tue, 18 Apr 2006 00:50:35 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-1518-1</guid>
        <source url="https://forum.moparisthebest.com/t/deob-quality/1518.rss">Deob quality</source>
      </item>
  </channel>
</rss>
