<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/cracking-the-allatori-string-encryption/177659 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 12:16:17 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Cracking the Allatori string encryption - General Programming - moparisthebest.com</title>
    <meta name="description" content="Alright, so I noticed a Java application obfuscated with a obfuscator called &amp;quot;Allatori&amp;quot;, and I wanted to see if the string encryption is hard to reverse. Well, it wasn&amp;#39;t :stuck_out_tongue: 

Let&amp;#39;s download the applicatio&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="177659.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Cracking the Allatori string encryption&#39;" href="177659.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/cracking-the-allatori-string-encryption/177659" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/cracking-the-allatori-string-encryption/177659" />
<meta property="og:title" content="Cracking the Allatori string encryption" />
<meta name="twitter:title" content="Cracking the Allatori string encryption" />
<meta property="og:description" content="Alright, so I noticed a Java application obfuscated with a obfuscator called ‚ÄúAllatori‚Äù, and I wanted to see if the string encryption is hard to reverse. Well, it wasn‚Äôt üòõ  Let‚Äôs download the application at http://www.allatori.com/downloads/Allatori-1.8-Demo.zip and extract the archive. The classes are at lib/allatori.jar. Now let‚Äôs pick a random class and hope that it has encrypted strings in it (I picked the class ‚Äòcom.allatori.Watermark‚Äô).  I found this:          if(ks.A() ==..." />
<meta name="twitter:description" content="Alright, so I noticed a Java application obfuscated with a obfuscator called ‚ÄúAllatori‚Äù, and I wanted to see if the string encryption is hard to reverse. Well, it wasn‚Äôt üòõ  Let‚Äôs download the application at http://www.allatori.com/downloads/Allatori-1.8-Demo.zip and extract the archive. The classes are at lib/allatori.jar. Now let‚Äôs pick a random class and hope that it has encrypted strings in it (I picked the class ‚Äòcom.allatori.Watermark‚Äô).  I found this:          if(ks.A() ==..." />
<meta property="article:published_time" content="2008-02-02T02:47:35+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="177659.html">Cracking the Allatori string encryption</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/k00dr.html'><span itemprop='name'>k00dr</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-02T02:47:35Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:18:16Z' class='post-time'>
              July 30, 2016,  7:18pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Alright, so I noticed a Java application obfuscated with a obfuscator called ‚ÄúAllatori‚Äù, and I wanted to see if the string encryption is hard to reverse. Well, it wasn‚Äôt <img src="../../images/emoji/twitter/stuck_out_tongue1bce.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>Let‚Äôs download the application at <a href="http://www.allatori.com/downloads/Allatori-1.8-Demo.zip" data-bbcode="true" rel="nofollow noopener">http://www.allatori.com/downloads/Allatori-1.8-Demo.zip</a> and extract the archive. The classes are at lib/allatori.jar. Now let‚Äôs pick a random class and hope that it has encrypted strings in it (I picked the class ‚Äòcom.allatori.Watermark‚Äô).</p>
<p>I found this:</p>
<blockquote>        if(ks.A() == null) {
          lr.b([b]tp.a[/b]([b]"Wzyryrff}av{v5~fvzu: Bb`igbuz~+\177Ql\027}C5]{H5LqL{"[/b]));
          System.exit(0);
        }</blockquote>
Ok, we found a string and the static decryption method [i]a[/i] in the class [i]tp[/i]. Now let‚Äôs get back to the archive root and decompile the class tp. Like expected, the control flow is fucked and decompiling produces a mess, so we‚Äôll fire up the Sun java disassembler (javap).
<pre><code class="lang-auto">public static java.lang.String a(java.lang.String);
  Code:
   0:   new     #6; //class java/lang/String
   3:   dup
   4:   aload_0
   5:   invokevirtual   #10; //Method java/lang/String.length:()I
   8:   newarray char
   10:  bipush  85
   12:  swap
   13:  dup
   14:  arraylength
   15:  iconst_1
   16:  isub
   17:  dup_x2
   18:  istore_3
   19:  astore_1
   20:  istore_2
   21:  iflt    80
   24:  aload_1
   25:  iload_3
   26:  aload_0
   27:  iload_3
   28:  invokevirtual   #14; //Method java/lang/String.charAt:(I)C
   31:  iload_2
   32:  ixor
   33:  i2c
   34:  swap
   35:  dup_x1
   36:  iload_2
   37:  ixor
   38:  i2c
   39:  bipush  63
   41:  iand
   42:  i2c
   43:  istore_2
   44:  castore
   45:  iinc    3, -1
   48:  iload_3
   49:  iflt    80
   52:  aload_1
   53:  iload_3
   54:  aload_0
   55:  iload_3
   56:  invokevirtual   #14; //Method java/lang/String.charAt:(I)C
   59:  iload_2
   60:  ixor
   61:  i2c
   62:  swap
   63:  dup_x1
   64:  iload_2
   65:  ixor
   66:  i2c
   67:  bipush  63
   69:  iand
   70:  i2c
   71:  istore_2
   72:  castore
   73:  iinc    3, -1
   76:  iload_3
   77:  goto    21
   80:  aload_1
   81:  invokespecial   #18; //Method java/lang/String."&lt;init&gt;":([C)V
   84:  areturn</code></pre>
<p>Now let‚Äôs see how the magic happens. A new string object is allocated in the beginning and left to the stack, then a char array of the length of the source string is allocated. After this, a mysterious integer <span class="bbcode-b">85</span> is pushed on the stack, assumably it is a key used in the decryption, let‚Äôs call it <span class="bbcode-b">KEY0</span>. Next, the length of the array is pushed and subtracted by one, and by the looks of it, the source string contents will be iterated backwards.</p>
<p>Alright, the next imporant part is how the stack is saved to local variables, it is important so that we‚Äôll know what the variables in the slots represent. At slot 0, there‚Äôs the source string which was passed as an argument, then the array, KEY0 and iterator position in slot 3. On the stack, there is now the new string object, uninitialized, and a copy of the current iterator position.</p>
<p>Next there‚Äôs a conditional branch, to check if the iteration is done and if the string is fully decrypted. The stack is filled again with the local variables and a char is read from the source string and XORed with KEY0. After this, KEY0 is XORed with the current iterator position and ANDed with a new mysterious integer of <span class="bbcode-b">63</span>, which we‚Äôll call <span class="bbcode-b">KEY1</span> from now on. The char read from the source string, and XORed with KEY0 is written to the array and iterator position is decremented by one.</p>
<p>Then there‚Äôs a conditional branch, and things are looking scarily familiar. Could this be a copy of the previous code block? Yep, I don‚Äôt know why, but it is. Alright, so the procedure is repeated until every character is decrypted and the iterator position has reached -1. We‚Äôve finished analyzing the decryption code. Now we‚Äôre left wondering if KEY0 and KEY1 are dynamic, are they different for every obfuscated program? After trying the obfuscator, we notice that the keys are constant.</p>
<p>85 and 63.<br>
85 in binary is 1010101, so it seems like an ok bitmask for XORing.<br>
63 is 00111111, as a bitmask in a AND operation it nulls the 2 high bits.<br>
KEY0 is kept below 64 to keep the UTF8 constant valid when XORed.</p>
<p>So now we can decrypt strings crypted by Allatori! (and crypt new ones to replace the old)</p>
<pre><code class="lang-auto">  public final static String decrypt(String encrypted) {
    char[] array = encrypted.toCharArray();
    decrypt(array);
    return new String(array);
  }

  public final static void decrypt(char[] source) {
    final int KEY0 = 0x55;
    final int KEY1 = 0x3f;
    int pos = source.length - 1;
    int xor = KEY0;
    while(pos &gt;= 0) {
      source[pos] ^= xor;
      xor = pos ^ xor &amp; KEY1;
      pos--;
    }
  }</code></pre>
<p>Oh yeah, and:</p>
<pre><code class="lang-auto">"Wzyryrff}av{v5~fvzu: Bb`igbuz~+\177Ql\027}C5]{H5LqL{"

stands for

‚ÄùConfiguration error. Watermark key is not set.‚Äù</code></pre>
<pre><code class="lang-auto">What's this
"dY_U\25\34TRB\34QR\21XW^_E^I\11HBRVY\6PNHJXoZk^rYhN{"</code></pre>
<p>(I just whipped this topic up, my english probably sucks, after all I‚Äôm not native english speaker‚Ä¶ And not every instruction of the code is explained.)</p>
<p>Enjoy!</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Ollie.html'><span itemprop='name'>Ollie</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-02T04:45:52Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:18:31Z' class='post-time'>
              July 30, 2016,  7:18pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i wont use this, but i enjoyed the explaination.<br>
if i ever come across string encryption i can referance this =]<br>
thanks</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/White_Castle.html'><span itemprop='name'>White_Castle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-02T05:13:11Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:18:34Z' class='post-time'>
              July 30, 2016,  7:18pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Heh, a while back I tried to crack ZKM‚Äôs string obfuscation scheme (looks similar to that, but somewhat more complex). In the end, I resorted to loading the class in question along with a bytecode representation, and grabbing the decoded strings from memory. Creds for not doing what I did :).</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/yakman.html'><span itemprop='name'>yakman</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-02T23:36:18Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:20:01Z' class='post-time'>
              July 30, 2016,  7:20pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i like this a lot, very intresting read <img src="../../images/emoji/twitter/slight_smile1bce.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/BAsh_CntLgn.html'><span itemprop='name'>BAsh_CntLgn</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2008-02-03T12:30:39Z'>
            <time itemprop='dateModified' datetime='2016-07-30T19:21:34Z' class='post-time'>
              July 30, 2016,  7:21pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Interesting. One of the key things about string encryption is that somewhere, somehow the string has to be decrypted in order to be displayed in a meaningful way to the user. That is how I beat ruler‚Äôs pathetic string encryption in ibot (also alltori i believe). You had calls to I.I(123) where I is a class and the next I (capital i) is a static method. The method would extract the string from a file that was called an image file (but wasn‚Äôt) which contained all the strings in the program. The number passed to the method was an index and at that index it would read the length and then the string. The way to beat it was to simply make the calls to I.I ourselves. Go through the source of the program looking for pushint invokestatic then call I.I with the appropriate argument and simply replace it with an ldc instruction. Easy.</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jacmob.html'><span itemprop='name'>Jacmob</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-11-01T00:31:04Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:13:10Z' class='post-time'>
              July 31, 2016, 12:13pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group quote-modified" data-post="5" data-topic="177659">
<div class="title">
<div class="quote-controls"></div>
 BAsh(CntLgn):</div>
<blockquote>
<p>Interesting. One of the key things about string encryption is that somewhere, somehow the string has to be decrypted in order to be displayed in a meaningful way to the user. That is how I beat ruler‚Äôs pathetic string encryption in ibot (also alltori i believe). You had calls to I.I(123) where I is a class and the next I (capital i) is a static method. The method would extract the string from a file that was called an image file (but wasn‚Äôt) which contained all the strings in the program. The number passed to the method was an index and at that index it would read the length and then the string. The way to beat it was to simply make the calls to I.I ourselves. Go through the source of the program looking for pushint invokestatic then call I.I with the appropriate argument and simply replace it with an ldc instruction. Easy.</p>
</blockquote>
</aside>
<p>JShrink does that - ruler uses allatori + jshrink, neither of which go far to conceal the strings.</p>
<p>Nice explanation, thanks <img src="../../images/emoji/twitter/slight_smileae52.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Cheese_Police.html'><span itemprop='name'>Cheese_Police</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-11-01T03:38:35Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:13:18Z' class='post-time'>
              July 31, 2016, 12:13pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=‚ÄúJacmob, post:6, topic:177659‚Äù][quote author=BAsh(CntLgn) link=topic=238584.msg2030114#msg2030114 date=1202041839]<br>
Interesting. One of the key things about string encryption is that somewhere, somehow the string has to be decrypted in order to be displayed in a meaningful way to the user. That is how I beat ruler‚Äôs pathetic string encryption in ibot (also alltori i believe). You had calls to I.I(123) where I is a class and the next I (capital i) is a static method. The method would extract the string from a file that was called an image file (but wasn‚Äôt) which contained all the strings in the program. The number passed to the method was an index and at that index it would read the length and then the string. The way to beat it was to simply make the calls to I.I ourselves. Go through the source of the program looking for pushint invokestatic then call I.I with the appropriate argument and simply replace it with an ldc instruction. Easy.<br>
[/quote]<br>
JShrink does that - ruler uses allatori + jshrink, neither of which go far to conceal the strings.</p>
<p>Nice explanation, thanks :)[/quote]</p>
<p>shameless bump?</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/CheatoX.html'><span itemprop='name'>CheatoX</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-11-01T13:46:25Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:13:47Z' class='post-time'>
              July 31, 2016, 12:13pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>for some reason this ain‚Äôt correct, after a certain amount of chars of a string, it starts to fuck up</p>
<p>Example</p>
<pre><code class="lang-auto">hO[tSONPaUTY^YSGFSGJRJNNNYp]nxR~p]uU1U|YdJgY|]fgSr7eSw_QY^UUYV^YIZ]O
QKS\6NOD[JNNNY=QM9HuvTwSvY2KdYy7mNkZ%^iI!HmRL[S]PPRCFUFU
S^I@SDNSHUTCI=Pq^xHsR;</code></pre>
<p>get‚Äôs decrypted to:</p>
<pre><code class="lang-auto"> se Mouse Wheel to zoom on worldmap and each individual bot
dou",%`#,)#+`"/4`&amp;/2`-%.5J$2!'`7/2,$`-!0`4/`#(!.'%`6)%7J$2!'`"/4`4/ √Ø√∞√•√Æ √° √≠√•√Æ√µ √∑√©√¥√® √Ø√∞√¥√©√Ø√Æ√≥ √Ø√Æ √¥√®√°√¥ √¨√Ø√£√°√¥√©√Øn</code></pre>
<p>i guess that‚Äôs not how it should be</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jacmob.html'><span itemprop='name'>Jacmob</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-11-01T14:05:00Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:13:49Z' class='post-time'>
              July 31, 2016, 12:13pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote no-group" data-post="7" data-topic="177659">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/cheese_police/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> Cheese_Police:</div>
<blockquote>
<p>shameless bump?</p>
</blockquote>
</aside>
<p>moar deob threads<br>
!!</p>
<p>Nah, I was just too retarded to read the dates when I was linked last night.</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-11-01T14:10:12Z'>
            <time itemprop='dateModified' datetime='2016-07-31T12:13:49Z' class='post-time'>
              July 31, 2016, 12:13pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=‚ÄúJacmob, post:6, topic:177659‚Äù][quote author=BAsh(CntLgn) link=topic=238584.msg2030114#msg2030114 date=1202041839]<br>
Interesting. One of the key things about string encryption is that somewhere, somehow the string has to be decrypted in order to be displayed in a meaningful way to the user. That is how I beat ruler‚Äôs pathetic string encryption in ibot (also alltori i believe). You had calls to I.I(123) where I is a class and the next I (capital i) is a static method. The method would extract the string from a file that was called an image file (but wasn‚Äôt) which contained all the strings in the program. The number passed to the method was an index and at that index it would read the length and then the string. The way to beat it was to simply make the calls to I.I ourselves. Go through the source of the program looking for pushint invokestatic then call I.I with the appropriate argument and simply replace it with an ldc instruction. Easy.<br>
[/quote]<br>
JShrink does that - ruler uses allatori + jshrink, neither of which go far to conceal the strings.</p>
<p>Nice explanation, thanks :)[/quote]</p>
<p>nice, something i found out in 2007 and have since made common knowledge‚Ä¶ very nice</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/cidiom.html'><span itemprop='name'>cidiom</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-08-27T17:21:59Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:27:08Z' class='post-time'>
              August 1, 2016,  2:27pm
            </time>
        <span itemprop='position'>#11</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I realize this topic has not been updated for a couple years, but just in case anyone stumbles across the code posted by k00dr, there is one slight issue.  Because of operator precedence in Java, bitwise ANDs get executed before bitwise XORs.</p>
<p>You will need to substitute this line:<br>
xor = pos ^ xor &amp; KEY1;<br>
for this instead:<br>
xor = (pos ^ xor) &amp; KEY1;</p>
<p>Have fun!</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-08-27T18:28:39Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:27:19Z' class='post-time'>
              August 1, 2016,  2:27pm
            </time>
        <span itemprop='position'>#12</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=‚Äúcidiom, post:11, topic:177659‚Äù]I realize this topic has not been updated for a couple years, but just in case anyone stumbles across the code posted by k00dr, there is one slight issue.  Because of operator precedence in Java, bitwise ANDs get executed before bitwise XORs.</p>
<p>You will need to substitute this line:<br>
xor = pos ^ xor &amp; KEY1;<br>
for this instead:<br>
xor = (pos ^ xor) &amp; KEY1;</p>
<p>Have fun![/quote]</p>
<p>Is this why k00dr‚Äôs method works on only select strings?</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="2" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/cidiom.html'><span itemprop='name'>cidiom</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-08-28T00:00:59Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:27:51Z' class='post-time'>
              August 1, 2016,  2:27pm
            </time>
        <span itemprop='position'>#13</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote quote-modified" data-post="12" data-topic="177659">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/slavemaster/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> slavemaster:</div>
<blockquote>
<p>Is this why k00dr‚Äôs method works on only select strings?</p>
</blockquote>
</aside>
<p>Yes, I believe that is correct.  It appeared to work for smaller strings, but had issues for longer ones.  This update should resolve that issue.</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-08-28T00:03:36Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:27:51Z' class='post-time'>
              August 1, 2016,  2:27pm
            </time>
        <span itemprop='position'>#14</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=‚Äúcidiom, post:13, topic:177659‚Äù][quote author=slavemaster link=topic=238584.msg3728603#msg3728603 date=1314469719]<br>
Is this why k00dr‚Äôs method works on only select strings?<br>
[/quote]</p>
<p>Yes, I believe that is correct.  It appeared to work for smaller strings, but had issues for longer ones.  This update should resolve that issue.[/quote]</p>
<p>Out of curiosity, /who/ exactly are you? Do you have a means of extra-forum communication?</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/cidiom.html'><span itemprop='name'>cidiom</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-08-28T00:31:01Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:27:53Z' class='post-time'>
              August 1, 2016,  2:27pm
            </time>
        <span itemprop='position'>#15</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=‚Äúslavemaster, post:14, topic:177659‚Äù][quote author=cidiom link=topic=238584.msg3729080#msg3729080 date=1314489659]</p>
<aside class="quote">
<blockquote>
<p>Is this why k00dr‚Äôs method works on only select strings?</p>
</blockquote>
</aside>
<p>Yes, I believe that is correct.  It appeared to work for smaller strings, but had issues for longer ones.  This update should resolve that issue.<br>
[/quote]</p>
<p>Out of curiosity, /who/ exactly are you? Do you have a means of extra-forum communication?[/quote]<br>
Nobody in particular, just someone who likes tinkering with Java and solving problems.  Feel free to email me, should be a link on the left.</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Evil1.html'><span itemprop='name'>Evil1</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-08-28T02:47:24Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:28:01Z' class='post-time'>
              August 1, 2016,  2:28pm
            </time>
        <span itemprop='position'>#16</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>omg, someone joined this forum to help instead of flame/troll, I like this g(uy|irl). Kudos.</p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Jython.html'><span itemprop='name'>Jython</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-09-06T01:23:17Z'>
            <time itemprop='dateModified' datetime='2016-08-01T14:42:58Z' class='post-time'>
              August 1, 2016,  2:42pm
            </time>
        <span itemprop='position'>#17</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=‚Äúveer, post:12, topic:177659‚Äù][quote author=cidiom link=topic=238584.msg3728513#msg3728513 date=1314465719]<br>
I realize this topic has not been updated for a couple years, but just in case anyone stumbles across the code posted by k00dr, there is one slight issue.  Because of operator precedence in Java, bitwise ANDs get executed before bitwise XORs.</p>
<p>You will need to substitute this line:<br>
xor = pos ^ xor &amp; KEY1;<br>
for this instead:<br>
xor = (pos ^ xor) &amp; KEY1;</p>
<p>Have fun!<br>
[/quote]</p>
<p>Is this why k00dr‚Äôs method works on only select strings?[/quote]</p>
<p>Following up on my post, this is quite an interesting error that went unnoticed for a very long time. It was almost like a heisenbug to me earlier, given the vast number of cases that xor &amp; KEY1 = xor due to shorter length strings. <img src="../../images/emoji/twitter/stuck_out_tongueae52.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
      </div>

      <meta itemprop='headline' content='Cracking the Allatori string encryption'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/cracking-the-allatori-string-encryption/177659 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 12:16:20 GMT -->
</html>
