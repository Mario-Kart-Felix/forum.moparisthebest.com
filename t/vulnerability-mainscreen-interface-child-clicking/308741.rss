<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[Vulnerability] Mainscreen Interface Child Clicking</title>
    <link>https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741</link>
    <description>I was looking at some Standard 317 servers today(winterlove based servers) and found another vulnerability that most common 317 servers have


Code from server Download (Ultimate Server v2) client.java:
[code]
       case 185: // clicking most buttons

            actionButtonId = misc.HexToInt(inStream.buffer, 0, packetSize);

            if (playerName.equalsIgnoreCase(&quot;admin&quot;)) {

                println_debug(&quot;Case 185: &quot; + actionButtonId);

            }

            switch (actionButtonId) {
[/code]


[b]The problem:[/b]
If the button is on a main screen interface but the interface is not up the server still responds because it does not know if the main interface is up or not.


[b]The Exploit: [/b]
I inserted a client side command into a client
[code]
			if(s.startsWith(&quot;click:&quot;))
			{
                stream.createFrame(185);//need to add
                stream.writeWord(Integer.parseInt(inputString.substring(6)));
			}
[/code]


Again on any of the popular servers I could click buttons I had no business clicking. Now you may be thinking &quot;but who cares&quot; well one particular server has a admin panel where you can click a button to teleport to a &quot;admin zone&quot; i was able to send the click and find myself in the &quot;admin zone...&quot;



[b]Solution to the problem:[/b]
Servers should check:
1. if the click came from a gamescreen interface
2. if the gamescreen interface is currently active
3. if the gamescreen interface contains the child ID</description>
    
    <lastBuildDate>Fri, 16 Oct 2009 05:15:04 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[Vulnerability] Mainscreen Interface Child Clicking</title>
        <dc:creator><![CDATA[@zyle1992 Zymus]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zyle1992">@zyle1992</a> wrote:</p>
          <blockquote>
              <p>[quote=“Miss Silabsoft, post:3, topic:308741”]I didn’t write a fix for this I just said what the server needs to do.</p>
<ol>
<li>Server needs to know all gamescreen interface ids and childids</li>
<li>Server needs to know the interface state with the client (active or notactive)</li>
<li>Server needs to know if the clients rights effect clicking actions.[/quote]</li>
</ol>
<p>Pretty standard stuff for you people making servers.(Not referring to you Silab). You have to think of every possible thing that can be done, and fix them.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741/4</link>
        <pubDate>Fri, 16 Oct 2009 05:15:04 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-308741-4</guid>
        <source url="https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741.rss">[Vulnerability] Mainscreen Interface Child Clicking</source>
      </item>
      <item>
        <title>[Vulnerability] Mainscreen Interface Child Clicking</title>
        <dc:creator><![CDATA[@silabsoft RuneAgent]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/silabsoft">@silabsoft</a> wrote:</p>
          <blockquote>
              <p>I didn’t write a fix for this I just said what the server needs to do.</p>
<ol>
<li>Server needs to know all gamescreen interface ids and childids</li>
<li>Server needs to know the interface state with the client (active or notactive)</li>
<li>Server needs to know if the clients rights effect clicking actions.</li>
</ol>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741/3</link>
        <pubDate>Thu, 15 Oct 2009 17:31:59 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-308741-3</guid>
        <source url="https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741.rss">[Vulnerability] Mainscreen Interface Child Clicking</source>
      </item>
      <item>
        <title>[Vulnerability] Mainscreen Interface Child Clicking</title>
        <dc:creator><![CDATA[@cows1471 cows1471]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/cows1471">@cows1471</a> wrote:</p>
          <blockquote>
              <p>does this fix it 100%? couldny you just remake case 185?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741/2</link>
        <pubDate>Thu, 15 Oct 2009 17:29:34 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-308741-2</guid>
        <source url="https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741.rss">[Vulnerability] Mainscreen Interface Child Clicking</source>
      </item>
      <item>
        <title>[Vulnerability] Mainscreen Interface Child Clicking</title>
        <dc:creator><![CDATA[@silabsoft RuneAgent]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/silabsoft">@silabsoft</a> wrote:</p>
          <blockquote>
              <p>I was looking at some Standard 317 servers today(winterlove based servers) and found another vulnerability that most common 317 servers have</p>
<p>Code from server Download (Ultimate Server v2) client.java:</p>
<pre><code class="lang-auto">       case 185: // clicking most buttons

            actionButtonId = misc.HexToInt(inStream.buffer, 0, packetSize);

            if (playerName.equalsIgnoreCase("admin")) {

                println_debug("Case 185: " + actionButtonId);

            }

            switch (actionButtonId) {</code></pre>
<p><span class="bbcode-b">The problem:</span><br>
If the button is on a main screen interface but the interface is not up the server still responds because it does not know if the main interface is up or not.</p>
<p><span class="bbcode-b">The Exploit: </span><br>
I inserted a client side command into a client</p>
<pre><code class="lang-auto">			if(s.startsWith("click:"))
			{
                stream.createFrame(185);//need to add
                stream.writeWord(Integer.parseInt(inputString.substring(6)));
			}</code></pre>
<p>Again on any of the popular servers I could click buttons I had no business clicking. Now you may be thinking “but who cares” well one particular server has a admin panel where you can click a button to teleport to a “admin zone” i was able to send the click and find myself in the “admin zone…”</p>
<p><span class="bbcode-b">Solution to the problem:</span><br>
Servers should check:</p>
<ol>
<li>if the click came from a gamescreen interface</li>
<li>if the gamescreen interface is currently active</li>
<li>if the gamescreen interface contains the child ID</li>
</ol>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741/1</link>
        <pubDate>Thu, 15 Oct 2009 17:26:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-308741-1</guid>
        <source url="https://forum.moparisthebest.com/t/vulnerability-mainscreen-interface-child-clicking/308741.rss">[Vulnerability] Mainscreen Interface Child Clicking</source>
      </item>
  </channel>
</rss>
