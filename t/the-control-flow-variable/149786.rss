<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>The control flow variable</title>
    <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786</link>
    <description>A really easy way to find it to rip it and all its crap out without ever breaking...

Its always (and always has been) stored in the last position of the LVT, even though its the first saved. The java compiler would assign it to the first available after the arguements.</description>
    
    <lastBuildDate>Mon, 08 Oct 2007 05:57:49 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>The control flow variable</title>
        <dc:creator><![CDATA[@Nerice Nerice]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nerice">@Nerice</a> wrote:</p>
          <blockquote>
              <p>[quote=“pplsuqbawlz, post:7, topic:149786”]That may work. It’s quite a shaky way to find an opaque predicate. The assumption you are making is that they will never apply any other method-level transforms to the bytecode after applying the opaque predicate transforms.</p>
<p>Honestly, I never thought they would implement their own custom virtual machine… shows what assuming gets you…[/quote]</p>
<p>Its not that shaky if it has worked 100% of the time since I have been doing it (back when I messed with the client).</p>
<p>Its things like this that made it so easy to always nail the correct methods/fields etc… when I was writing stuff to locate them. For example, one method I could get into just by one call they made to another, one they couldnt change unless they totally removed something from the client (not actual client maybe now, but from the program), and they wouldnt be removing it… They may place it somewhere else if they knew what it was (but even then, it would cause them more probs to do so, than for me to still use it against them)… Once inside that method I would get loads of variables/methods/classes… 15-20+ if I remember correctly, by getting into one method they couldn’t hide or change the name of what I was looking for to get into it.</p>
<p>I go with the mindeset of looking for stuff that does not change, or cannot be changed, at least easily.</p>
<p>I of course have other ways of finding this as well, that stands out like what I posted does, but not telling all so they can decide to try to circumvent them all.</p>
<p>There is also a very easy way to get rid of all the worthless do loops. Since decompiling/recompiling is not a good option, obv its to make the decompiled code cleaner and easier to read while looking into the client in general for info/learning, not to recompile and use.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786/10</link>
        <pubDate>Mon, 08 Oct 2007 05:57:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-149786-10</guid>
        <source url="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss">The control flow variable</source>
      </item>
      <item>
        <title>The control flow variable</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>nah, this stuff</p>
<pre><code class="lang-auto">int i4 = client.qb;
...
    if(i4 == 0)
        break label1;</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786/9</link>
        <pubDate>Sun, 07 Oct 2007 19:48:18 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-149786-9</guid>
        <source url="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss">The control flow variable</source>
      </item>
      <item>
        <title>The control flow variable</title>
        <dc:creator><![CDATA[@BAsh_CntLgn BAsh(CntLgn)]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/bash_cntlgn">@BAsh_CntLgn</a> wrote:</p>
          <blockquote>
              <p>Dont want to destroy the thread, but are we talking about this crap?</p>
<p><code>if (i != -11)
	    method145(54, (byte) -122);</code></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786/8</link>
        <pubDate>Sun, 07 Oct 2007 19:34:58 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-149786-8</guid>
        <source url="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss">The control flow variable</source>
      </item>
      <item>
        <title>The control flow variable</title>
        <dc:creator><![CDATA[@pplsuqbawlz pplsuqbawlz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pplsuqbawlz">@pplsuqbawlz</a> wrote:</p>
          <blockquote>
              <p>That may work. It’s quite a shaky way to find an opaque predicate. The assumption you are making is that they will never apply any other method-level transforms to the bytecode after applying the opaque predicate transforms.</p>
<p>Honestly, I never thought they would implement their own custom virtual machine… shows what assuming gets you…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786/7</link>
        <pubDate>Sun, 07 Oct 2007 19:06:07 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-149786-7</guid>
        <source url="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss">The control flow variable</source>
      </item>
      <item>
        <title>The control flow variable</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>int firstOpen = numArgs + (isStatic ? 0 : 1);<br>
int range = numLocals - firstOpen;<br>
int newIdx = Math.random() * range + firstOpen;<br>
swapVariables(newIdx, oldIdx);</p>
<p>whats hard? i might be missing the point, but i really dont undertsand what the difficulty would be</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786/6</link>
        <pubDate>Sun, 07 Oct 2007 15:44:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-149786-6</guid>
        <source url="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss">The control flow variable</source>
      </item>
      <item>
        <title>The control flow variable</title>
        <dc:creator><![CDATA[@Nerice Nerice]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nerice">@Nerice</a> wrote:</p>
          <blockquote>
              <p>Technically I have to agree it <em>could</em> be changed. Think you know how likely it is to be is very very very low (and in this case I am 98% sure they have no control over it anyway).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786/5</link>
        <pubDate>Sun, 07 Oct 2007 15:26:10 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-149786-5</guid>
        <source url="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss">The control flow variable</source>
      </item>
      <item>
        <title>The control flow variable</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>no, what i mean is, obfuscator inserts it at the end, another rule swaps variable indices, it wouldnt be that hard to do, so you might want to allow for it not only being the last index.<br>
eg. changing all iload_0’s to iload_1 and all iload_1’s to iload_0</p>
<p>for example, saevion used to find the control field by getting the last entry in the constant pool, that no longer works, the constant pool is even somewhat grouped now</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786/4</link>
        <pubDate>Sun, 07 Oct 2007 14:52:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-149786-4</guid>
        <source url="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss">The control flow variable</source>
      </item>
      <item>
        <title>The control flow variable</title>
        <dc:creator><![CDATA[@Nerice Nerice]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nerice">@Nerice</a> wrote:</p>
          <blockquote>
              <p>[quote=“frank_, post:2, topic:149786”]thanks, i will keep this in mind when i go to write a deobfuscator <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=6" title=":wink:" class="emoji" alt=":wink:"> at the moment i just use saevion’s because it works</p>
<p>though i would never say “without ever breaking”, they might get tricky and shuffle the other variables down in order to insert it[/quote]</p>
<p>The obsfuscator’s would have to start reordering every last one of them, and change every LVI in every method it inserts in into (too risky to do…). Not claiming to know them all, but they all do it the same way that I know of, so changing to a different product, they are still stuck.</p>
<p>Its one of those useless, but done things just like string encryption… Like a lock, keep honest people out, but crooks would just break a window.</p>
<p>Putting something like that in manually and constantly changing the type/name/locations/code etc… all the time is not something any rational company would even consider (not to mention it cant be done code wise, the jumps have to be done at the bytecode level).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786/3</link>
        <pubDate>Sun, 07 Oct 2007 14:36:36 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-149786-3</guid>
        <source url="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss">The control flow variable</source>
      </item>
      <item>
        <title>The control flow variable</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>thanks, i will keep this in mind when i go to write a deobfuscator <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=6" title=":wink:" class="emoji" alt=":wink:"> at the moment i just use saevion’s because it works</p>
<p>though i would never say “without ever breaking”, they might get tricky and shuffle the other variables down in order to insert it</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786/2</link>
        <pubDate>Sun, 07 Oct 2007 14:20:51 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-149786-2</guid>
        <source url="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss">The control flow variable</source>
      </item>
      <item>
        <title>The control flow variable</title>
        <dc:creator><![CDATA[@Nerice Nerice]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nerice">@Nerice</a> wrote:</p>
          <blockquote>
              <p>A really easy way to find it to rip it and all its crap out without ever breaking…</p>
<p>Its always (and always has been) stored in the last position of the LVT, even though its the first saved. The java compiler would assign it to the first available after the arguements.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/the-control-flow-variable/149786/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/the-control-flow-variable/149786/1</link>
        <pubDate>Sun, 07 Oct 2007 13:56:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-149786-1</guid>
        <source url="https://forum.moparisthebest.com/t/the-control-flow-variable/149786.rss">The control flow variable</source>
      </item>
  </channel>
</rss>
