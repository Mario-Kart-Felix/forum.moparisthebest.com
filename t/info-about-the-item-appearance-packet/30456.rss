<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Info about the Item Appearance Packet</title>
    <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456</link>
    <description>Since it has been quiet, I got bored and rummaged through some old notes and found something that is quite harmless to give away, yet has implications beyond what is on the surface.

Not many have descended to packet manipulation, but for those of you that have, I&#39;m speaking about the item appearance branch of the state update packet. I almost gave the name that I use for that packet, but decided that my name is far more cryptic than this one.

Since the game packets are generally dynamic, I&#39;ll give you a basic[sup]1[/sup] rundown of that packet for the most recent version 441.

[ID XX YY SS II II PP PP CC CC OO]

ID = Packet ID - 221 for version 441
XX = Base X location
YY = Base Y location
SS = Sub packet or Branch packet id - for version 441 it is 159 (that is -97 for those of you reading the bytes raw)
II = Item ID
[b]PP = Player ID[/b]
CC = Item Count
OO = Encoded offset from the Base location

The player id is where I was planning on focusing my post. This packet is basically responsible for making a previously invisible item visible to your client. The PP PP value is the id of the player that dropped the item.

This has very little bearing on anyone&#39;s potential &#39;direction&#39; in hacking the game. I just thought I&#39;d try and get some form of intelligent discussion moving as CM was looking quite boring lately.

[sup]1[/sup]= Yes ruler I did say &#39;basic rundown&#39;, which means that it is in no way a full definition of the packet(s) in question... I have no intentions of giving away full definitions and mutations of the game packets.

@EDIT: Verified that I wasn&#39;t completely off on some of the values.</description>
    
    <lastBuildDate>Thu, 07 Dec 2006 05:04:44 +0000</lastBuildDate>
    <category>Community Inside Talk</category>
    <atom:link href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="22" data-topic="30456">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/rln/40/5_6259e4fa9dfe0dec282fb0955bb1974c.png" class="avatar"> RLN:</div>
<blockquote>
<p>b) updates (some people have told me they change their protocol often)</p>
</blockquote>
</aside>
<p>Only every update or so.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/23">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/23</link>
        <pubDate>Thu, 07 Dec 2006 05:04:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-23</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@RLN RLN]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rln">@RLN</a> wrote:</p>
          <blockquote>
              <p>only potential problems i see are a) encryption b) updates (some people have told me they change their protocol often)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/22">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/22</link>
        <pubDate>Thu, 07 Dec 2006 04:23:03 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-22</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <p>[quote=“RLN, post:20, topic:30456”][quote author=moparisthebest link=topic=44576.msg572529#msg572529 date=1165309761]<br>
Well, I reckon if you were a <a href="http://dictionary.reference.com/search?r=2&amp;q=masochist" data-bbcode="true" rel="nofollow noopener">masochist</a> you <span class="bbcode-i">could</span> write and update a bot solely using and editing packets.<br>
[/quote]or if your name is kaitnieks[/quote]</p>
<p>omg AutoRune 2?</p>
<p>In the current system, clientless bots are beyond the range of any person who is not extremely motivated.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/21">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/21</link>
        <pubDate>Thu, 07 Dec 2006 03:51:23 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-21</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@RLN RLN]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rln">@RLN</a> wrote:</p>
          <blockquote>
              <p>[quote=“moparisthebest, post:18, topic:30456”]Well, I reckon if you were a <a href="http://dictionary.reference.com/search?r=2&amp;q=masochist" data-bbcode="true" rel="nofollow noopener">masochist</a> you <span class="bbcode-i">could</span> write and update a bot solely using and editing packets.[/quote]or if your name is kaitnieks</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/20">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/20</link>
        <pubDate>Thu, 07 Dec 2006 03:12:01 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-20</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@pplsuqbawlz pplsuqbawlz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pplsuqbawlz">@pplsuqbawlz</a> wrote:</p>
          <blockquote>
              <p>And if I am?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/19</link>
        <pubDate>Tue, 05 Dec 2006 10:01:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-19</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>Well, I reckon if you were a <a href="http://dictionary.reference.com/search?r=2&amp;q=masochist" data-bbcode="true" rel="nofollow noopener">masochist</a> you <span class="bbcode-i">could</span> write and update a bot solely using and editing packets.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/18</link>
        <pubDate>Tue, 05 Dec 2006 09:09:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-18</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@pplsuqbawlz pplsuqbawlz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pplsuqbawlz">@pplsuqbawlz</a> wrote:</p>
          <blockquote>
              <p>It wouldn’t would it?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/17</link>
        <pubDate>Tue, 05 Dec 2006 08:48:25 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-17</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>I would be interested to know how the whole packet system works, but it really wouldn’t be of much use for writing a bot.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/16</link>
        <pubDate>Tue, 05 Dec 2006 08:45:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-16</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <p>That’s partially what I meant, haha.  But seriously, it seems that we have to figure out most of the stuff that, without much help, isn’t to easy to find out <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=6" title=":confused:" class="emoji" alt=":confused:"></p>
<p>Then we wonder why RS Cheating is dying.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/15</link>
        <pubDate>Mon, 04 Dec 2006 08:40:25 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-15</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <p>[quote=“Pwnd, post:13, topic:30456”][quote author=Krichevskoy link=topic=44576.msg559393#msg559393 date=1165105455]<br>
But you could elaborate on TEA for us and hope to start people talking about the inner workings of RuneScape again <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
[/quote]<br>
No, no.  That’d be far to helpful.[/quote]</p>
<p>It would actually be quite useless. Any practical development isn’t going to worry about how they handle the packet transmission. It would be nice for people who are just curious though. You know, the whole knowledge sharing bit.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/14</link>
        <pubDate>Mon, 04 Dec 2006 08:23:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-14</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="11" data-topic="30456">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/krichevskoy/40/5_6259e4fa9dfe0dec282fb0955bb1974c.png" class="avatar"> Krichevskoy:</div>
<blockquote>
<p>But you could elaborate on TEA for us and hope to start people talking about the inner workings of RuneScape again <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</blockquote>
</aside>
<p>No, no.  That’d be far to helpful.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/13</link>
        <pubDate>Mon, 04 Dec 2006 06:38:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-13</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@pplsuqbawlz pplsuqbawlz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pplsuqbawlz">@pplsuqbawlz</a> wrote:</p>
          <blockquote>
              <p>Who needs other people really?</p>
<p>I imagine i could elaborate, but yeah, they change it every so often.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/12</link>
        <pubDate>Mon, 04 Dec 2006 04:28:03 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-12</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <p>[quote=“pplsuqbawlz, post:10, topic:30456”]OH MY GOODNESS, I SMOKE RICIN…</p>
<p>In other words, bump?[/quote]</p>
<p>I think there are VERY few people who know this much about the client anymore. Packet documentation hasn’t been necessary for bots in a long time, and as far as I know there is no competent server development left. But you could elaborate on TEA for us and hope to start people talking about the inner workings of RuneScape again <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/11</link>
        <pubDate>Sun, 03 Dec 2006 00:24:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-11</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@pplsuqbawlz pplsuqbawlz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pplsuqbawlz">@pplsuqbawlz</a> wrote:</p>
          <blockquote>
              <p>OH MY GOODNESS, I SMOKE RICIN…</p>
<p>In other words, bump?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/10</link>
        <pubDate>Fri, 01 Dec 2006 23:46:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-10</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group quote-modified" data-post="7" data-topic="30456">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/pplsuqbawlz/40/5_6259e4fa9dfe0dec282fb0955bb1974c.png" class="avatar"> pplsuqbawlz:</div>
<blockquote>
<p>Krich, I’ve looked over and over, I’ve not found “ULAW” encryption anywhere; Oh and I assumed by ULAW you meant the “Mu-law” algorithm.</p>
</blockquote>
</aside>
<p>The only algorithm I remember mentioning to you is ISAAC, which seems to be the RNG from which Jagex derived their stream encryption. That doesn’t even make sense…why would there be an audio compensation algorithm involved?</p>
<p>I haven’t seen TEA, but they definitely use ISAAC (if with better formatting than the creator’s <a href="http://www.burtleburtle.net/bob/java/rand/Rand.java" data-bbcode="true" rel="nofollow noopener">Java implementation</a>). It’s much easier to see in an older client, but it explains that hex value you pointed out to me (0x9e3779b9) which seems to be used as an initializer in demo code for both algorithms.</p>
<pre><code class="lang-auto">public class ISAACRNG
{

    public ISAACRNG(int seed[])
    {
        state = new int[256];
        results = new int[256];
        for(int j = 0; j &lt; seed.length; j++)
            results[j] = seed[j];
        init();
    }

    public int next()
    {
        if(count-- == 0)
        {
            generateResults();
            count = 255;
        }
        return results[count];
    }

    public void generateResults()
    {
        lastResult += ++counter;
        for(int i = 0; i &lt; 256; i++)
        {
            int j = state[i];
            if((i &amp; 3) == 0)
                accumulator ^= accumulator &lt;&lt; 13;
            else
            if((i &amp; 3) == 1)
                accumulator ^= accumulator &gt;&gt;&gt; 6;
            else
            if((i &amp; 3) == 2)
                accumulator ^= accumulator &lt;&lt; 2;
            else
            if((i &amp; 3) == 3)
                accumulator ^= accumulator &gt;&gt;&gt; 16;
            accumulator += state[i + 128 &amp; 0xff];
            int k;
            state[i] = k = state[(j &amp; 0x3fc) &gt;&gt; 2] + accumulator + lastResult;
            results[i] = lastResult = state[(k &gt;&gt; 8 &amp; 0x3fc) &gt;&gt; 2] + j;
        }

    }

    public void init()
    {
        int i1;
        int j1;
        int k1;
        int l1;
        int i2;
        int j2;
        int k2;
        int l = i1 = j1 = k1 = l1 = i2 = j2 = k2 = 0x9e3779b9;
        for(int i = 0; i &lt; 4; i++)
        {
            l ^= i1 &lt;&lt; 11;
            k1 += l;
            i1 += j1;
            i1 ^= j1 &gt;&gt;&gt; 2;
            l1 += i1;
            j1 += k1;
            j1 ^= k1 &lt;&lt; 8;
            i2 += j1;
            k1 += l1;
            k1 ^= l1 &gt;&gt;&gt; 16;
            j2 += k1;
            l1 += i2;
            l1 ^= i2 &lt;&lt; 10;
            k2 += l1;
            i2 += j2;
            i2 ^= j2 &gt;&gt;&gt; 4;
            l += i2;
            j2 += k2;
            j2 ^= k2 &lt;&lt; 8;
            i1 += j2;
            k2 += l;
            k2 ^= l &gt;&gt;&gt; 9;
            j1 += k2;
            l += i1;
        }

        for(int j = 0; j &lt; 256; j += 8)
        {
            l += results[j];
            i1 += results[j + 1];
            j1 += results[j + 2];
            k1 += results[j + 3];
            l1 += results[j + 4];
            i2 += results[j + 5];
            j2 += results[j + 6];
            k2 += results[j + 7];
            l ^= i1 &lt;&lt; 11;
            k1 += l;
            i1 += j1;
            i1 ^= j1 &gt;&gt;&gt; 2;
            l1 += i1;
            j1 += k1;
            j1 ^= k1 &lt;&lt; 8;
            i2 += j1;
            k1 += l1;
            k1 ^= l1 &gt;&gt;&gt; 16;
            j2 += k1;
            l1 += i2;
            l1 ^= i2 &lt;&lt; 10;
            k2 += l1;
            i2 += j2;
            i2 ^= j2 &gt;&gt;&gt; 4;
            l += i2;
            j2 += k2;
            j2 ^= k2 &lt;&lt; 8;
            i1 += j2;
            k2 += l;
            k2 ^= l &gt;&gt;&gt; 9;
            j1 += k2;
            l += i1;
            state[j] = l;
            state[j + 1] = i1;
            state[j + 2] = j1;
            state[j + 3] = k1;
            state[j + 4] = l1;
            state[j + 5] = i2;
            state[j + 6] = j2;
            state[j + 7] = k2;
        }

        for(int k = 0; k &lt; 256; k += 8)
        {
            l += state[k];
            i1 += state[k + 1];
            j1 += state[k + 2];
            k1 += state[k + 3];
            l1 += state[k + 4];
            i2 += state[k + 5];
            j2 += state[k + 6];
            k2 += state[k + 7];
            l ^= i1 &lt;&lt; 11;
            k1 += l;
            i1 += j1;
            i1 ^= j1 &gt;&gt;&gt; 2;
            l1 += i1;
            j1 += k1;
            j1 ^= k1 &lt;&lt; 8;
            i2 += j1;
            k1 += l1;
            k1 ^= l1 &gt;&gt;&gt; 16;
            j2 += k1;
            l1 += i2;
            l1 ^= i2 &lt;&lt; 10;
            k2 += l1;
            i2 += j2;
            i2 ^= j2 &gt;&gt;&gt; 4;
            l += i2;
            j2 += k2;
            j2 ^= k2 &lt;&lt; 8;
            i1 += j2;
            k2 += l;
            k2 ^= l &gt;&gt;&gt; 9;
            j1 += k2;
            l += i1;
            state[k] = l;
            state[k + 1] = i1;
            state[k + 2] = j1;
            state[k + 3] = k1;
            state[k + 4] = l1;
            state[k + 5] = i2;
            state[k + 6] = j2;
            state[k + 7] = k2;
        }

        generateResults();
        count = 256;
    }

    public int count;
    public int results[];
    public int state[];
    public int accumulator;
    public int lastResult;
    public int counter;
}</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/9</link>
        <pubDate>Thu, 30 Nov 2006 05:31:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-9</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@GenoDemoN GenoDemoN]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/genodemon">@GenoDemoN</a> wrote:</p>
          <blockquote>
              <p>semaphore –  i was meaning is it visible in a sense that the 3rd aprty character can only se the items or if they can interact with the item while its in the period where you normally cannot see it?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/8</link>
        <pubDate>Thu, 30 Nov 2006 04:30:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-8</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@pplsuqbawlz pplsuqbawlz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pplsuqbawlz">@pplsuqbawlz</a> wrote:</p>
          <blockquote>
              <p>My thoughts on the topic are that they are used to Identify item’s ownership as they are passed along to various accounts. Aiding them as they track which character gets what in order to catch drop trading and various other exploits from a cheating character to that of a clean one.</p>
<p><span class="bbcode-s">Which brings up another thought, pick up an item on a clean character, and pass it to another clean character, would he be banned?</span></p>
<p>Scratch that thought, I assume they don’t need map that extensively; Because it is simply unnecessary! If an item that has been tagged with the character which dropped it originally, transfered it… The account that picked it up would be banned, and thus any transfers from it forwards would also be banned by reference. I should have remembered my lesson from Computer Science - “Structures: Low Resource Mapping”;</p>
<p>Otherwise, I see something questionable in your packet structures sema! The identifier(ID) is not written 16 bit but 8 bit encoded using the TEA Key-Cypher routine. Private server’s call it a ‘frame’ for the nubs, by the way, scrubs, winterlove doesn’t deserve much if any credit for decyphering communication routines… They’re straight forward! RSA for user/password routines, the rest is just TEA [Tiny Encryption Algorithm] implemented in it’s various means. Back on topic: I bet that you already knew ID isn’t</p>
<p>Krich, I’ve looked over and over, I’ve not found “ULAW” encryption anywhere; Oh and I assumed by ULAW you meant the “Mu-law” algorithm.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/7</link>
        <pubDate>Thu, 30 Nov 2006 02:00:50 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-7</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>why would the client need to know who dropped the item? :\</p>
<p>ill try to have a look now, but chances are i wont even find where the packet is parsed</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/6</link>
        <pubDate>Wed, 29 Nov 2006 17:06:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-6</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="1" data-topic="30456">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/semaphore/40/252_2.png" class="avatar"> semaphore:</div>
<blockquote>
<p>Since it has been quiet, I got bored and rummaged through some old notes and found something that is quite harmless to give away, yet has implications beyond what is on the surface.</p>
</blockquote>
</aside>
<p>Events…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/5</link>
        <pubDate>Wed, 29 Nov 2006 07:32:12 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-5</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@semaphore semaphore]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/semaphore">@semaphore</a> wrote:</p>
          <blockquote>
              <p>Not quite the conversation I was planning on starting but… Ok… sure… I’ll bite.</p>
<p>Geno: You may be a great guy, I have no idea. I’ll give you the benefit of the doubt and assume you completely skimmed the post and missed the blatant statement below:</p>
<p>[quote=“semaphore, post:1, topic:30456”]blah blah blah…<br>
<span class="bbcode-b">This packet is basically responsible for making a previously invisible item visible to your client.</span><br>
blah blah blah…[/quote]</p>
<p>This particular packet is the packet that the server sends to the client when an item that has timed out of the ‘local ground item stack’ and has entered the ‘world tile ground item stack’.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/4</link>
        <pubDate>Wed, 29 Nov 2006 07:30:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-4</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="2" data-topic="30456">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/genodemon/40/5_6259e4fa9dfe0dec282fb0955bb1974c.png" class="avatar"> GenoDemoN:</div>
<blockquote>
<p>soo your saing by reading the packets we can know where items are that we cannot see yet that say a player dropped. can we say then force a action on grabbing that item before we can see it?</p>
</blockquote>
</aside>
<p>No, I think this is the packet that coincides with your being able to see an item.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/3</link>
        <pubDate>Wed, 29 Nov 2006 06:08:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-3</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@GenoDemoN GenoDemoN]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/genodemon">@GenoDemoN</a> wrote:</p>
          <blockquote>
              <p>soo your saing by reading the packets we can know where items are that we cannot see yet that say a player dropped. can we say then force a action on grabbing that item before we can see it?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/2</link>
        <pubDate>Wed, 29 Nov 2006 05:25:01 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-2</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
      <item>
        <title>Info about the Item Appearance Packet</title>
        <dc:creator><![CDATA[@semaphore semaphore]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/semaphore">@semaphore</a> wrote:</p>
          <blockquote>
              <p>Since it has been quiet, I got bored and rummaged through some old notes and found something that is quite harmless to give away, yet has implications beyond what is on the surface.</p>
<p>Not many have descended to packet manipulation, but for those of you that have, I’m speaking about the item appearance branch of the state update packet. I almost gave the name that I use for that packet, but decided that my name is far more cryptic than this one.</p>
<p>Since the game packets are generally dynamic, I’ll give you a basic[sup]1[/sup] rundown of that packet for the most recent version 441.</p>
<p>[ID XX YY SS II II PP PP CC CC OO]</p>
<p>ID = Packet ID - 221 for version 441<br>
XX = Base X location<br>
YY = Base Y location<br>
SS = Sub packet or Branch packet id - for version 441 it is 159 (that is -97 for those of you reading the bytes raw)<br>
II = Item ID<br>
<span class="bbcode-b">PP = Player ID</span><br>
CC = Item Count<br>
OO = Encoded offset from the Base location</p>
<p>The player id is where I was planning on focusing my post. This packet is basically responsible for making a previously invisible item visible to your client. The PP PP value is the id of the player that dropped the item.</p>
<p>This has very little bearing on anyone’s potential ‘direction’ in hacking the game. I just thought I’d try and get some form of intelligent discussion moving as CM was looking quite boring lately.</p>
<p>[sup]1[/sup]= Yes ruler I did say ‘basic rundown’, which means that it is in no way a full definition of the packet(s) in question… I have no intentions of giving away full definitions and mutations of the game packets.</p>
<p><a class="mention" href="/u/edit">@EDIT</a>: Verified that I wasn’t completely off on some of the values.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456/1</link>
        <pubDate>Wed, 29 Nov 2006 04:21:35 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-30456-1</guid>
        <source url="https://forum.moparisthebest.com/t/info-about-the-item-appearance-packet/30456.rss">Info about the Item Appearance Packet</source>
      </item>
  </channel>
</rss>
