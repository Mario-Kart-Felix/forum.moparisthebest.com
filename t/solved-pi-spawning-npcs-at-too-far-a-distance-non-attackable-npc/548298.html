<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/solved-pi-spawning-npcs-at-too-far-a-distance-non-attackable-npc/548298 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:07:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[Solved][PI] Spawning NPCs at too far a distance = non-attackable npc? - Runescape - moparisthebest.com</title>
    <meta name="description" content="Solved it guys! Apparently it was something to do with my distance checking (Kinda figured) 

To fix it, if you have this issue.. Find: [code=java] 				if (npcs[i].spawnedBy &amp;gt; 0) { // delete summons npc 					if (PlayerHa&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="548298.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[Solved][PI] Spawning NPCs at too far a distance = non-attackable npc?&#39;" href="548298.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/solved-pi-spawning-npcs-at-too-far-a-distance-non-attackable-npc/548298" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/solved-pi-spawning-npcs-at-too-far-a-distance-non-attackable-npc/548298" />
<meta property="og:title" content="[Solved][PI] Spawning NPCs at too far a distance = non-attackable npc?" />
<meta name="twitter:title" content="[Solved][PI] Spawning NPCs at too far a distance = non-attackable npc?" />
<meta property="og:description" content="Solved it guys! Apparently it was something to do with my distance checking (Kinda figured)  To fix it, if you have this issue… Find:   				if (npcs[i].spawnedBy &gt; 0) { // delete summons npc 					if (PlayerHandler.players[npcs[i].spawnedBy] == null 							|| PlayerHandler.players[npcs[i].spawnedBy].heightLevel != npcs[i].heightLevel 							|| PlayerHandler.players[npcs[i].spawnedBy].respawnTimer &gt; 0 							|| !PlayerHandler.players[npcs[i].spawnedBy] 									.goodDistance( 											npcs[i].ge..." />
<meta name="twitter:description" content="Solved it guys! Apparently it was something to do with my distance checking (Kinda figured)  To fix it, if you have this issue… Find:   				if (npcs[i].spawnedBy &gt; 0) { // delete summons npc 					if (PlayerHandler.players[npcs[i].spawnedBy] == null 							|| PlayerHandler.players[npcs[i].spawnedBy].heightLevel != npcs[i].heightLevel 							|| PlayerHandler.players[npcs[i].spawnedBy].respawnTimer &gt; 0 							|| !PlayerHandler.players[npcs[i].spawnedBy] 									.goodDistance( 											npcs[i].ge..." />
<meta property="article:published_time" content="2014-12-07T02:01:43+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="548298.html">[Solved][PI] Spawning NPCs at too far a distance = non-attackable npc?</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sk8rdude461.html'><span itemprop='name'>sk8rdude461</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-07T02:01:43Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:03:44Z' class='post-time'>
              August 4, 2016,  2:03pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Solved it guys! Apparently it was something to do with my distance checking (Kinda figured)</p>
<p>To fix it, if you have this issue… Find:</p>
<p><code>
				if (npcs[i].spawnedBy &gt; 0) { // delete summons npc
					if (PlayerHandler.players[npcs[i].spawnedBy] == null
							|| PlayerHandler.players[npcs[i].spawnedBy].heightLevel != npcs[i].heightLevel
							|| PlayerHandler.players[npcs[i].spawnedBy].respawnTimer &gt; 0
							|| !PlayerHandler.players[npcs[i].spawnedBy]
									.goodDistance(
											npcs[i].getX(),
											npcs[i].getY(),
											PlayerHandler.players[npcs[i].spawnedBy]
													.getX(),
											PlayerHandler.players[npcs[i].spawnedBy]
													.getY(), 10)) {</code><br>
Replace it with:</p>
<p><code>				if (npcs[i].spawnedBy &gt; 0) { // delete summons npc
					if (PlayerHandler.players[npcs[i].spawnedBy] == null
							|| PlayerHandler.players[npcs[i].spawnedBy].heightLevel != npcs[i].heightLevel
							|| PlayerHandler.players[npcs[i].spawnedBy].respawnTimer &gt; 0
							|| (!PlayerHandler.players[npcs[i].spawnedBy]
									.goodDistance(
											npcs[i].getX(),
											npcs[i].getY(),
											PlayerHandler.players[npcs[i].spawnedBy]
													.getX(),
											PlayerHandler.players[npcs[i].spawnedBy]
													.getY(), 10) &amp;&amp; !PlayerHandler.players[npcs[i].spawnedBy].inFightCaves())) {</code></p>
<p>This is the weirdest thing I’ve ever seen…</p>
<p>I went to work on the Tzhaar fight caves and added the wave data in… But upon the second/third wave I noticed a bug.</p>
<p>If the npc spawns like 10-12 tiles from you, it won’t even acknowledge your existence. If you attempt to attack it, nothing happens.<br>
If it spawns like 14-20 tiles (not 100% sure on this distance), the npc won’t even spawn.</p>
<p>I also had an issue with the npcs where if you ran out of view of them, they’d also disappear. Can’t really be having any of this in the fight caves, so heh…</p>
<p>Here’s the code I use to spawn my waves (It’s not perfect, I just rewrote parts of the existing code)</p>
<p><code>	public void spawnNextWave(Client c) {
		if (c != null) {
			if (c.waveId &gt;= WAVES.length) {
				c.waveId = 0;
				return;
			}
			if (c.waveId &lt; 0) {
				return;
			}
			int npcAmount = WAVES[c.waveId].length;
			for (int j = 0; j &lt; npcAmount; j++) {
				NpcData npc = WAVES[c.waveId][j];
				int X = COORDINATES[j][0];
				int Y = COORDINATES[j][1];
				Server.npcHandler.spawnNpc(c, npc.getNpcId(), X, Y,
						c.getHeight(), 0, npc.getHealth(), npc.getMax(),
						npc.getAttack(), npc.getDefence(), true, false);
			}
			c.tzhaarToKill = npcAmount;
			c.tzhaarKilled = 0;
		} 
	}</code></p>
<p>And then here’s the spawnNpc method. (This code I didn’t even touch)</p>
<p>[code=java]	/**<br>
* Summon npc, barrows, etc<br>
**/<br>
public void spawnNpc(Client c, int npcType, int x, int y, int heightLevel,<br>
int WalkingType, int HP, int maxHit, int attack, int defence,<br>
boolean attackPlayer, boolean headIcon) {<br>
int slot = -1;<br>
for (int i = 1; i &lt; maxNPCs; i++) {<br>
if (npcs[i] == null) {<br>
slot = i;<br>
break;<br>
}<br>
}<br>
if (slot == -1) {<br>
return;<br>
}<br>
NPC newNPC = new NPC(slot, npcType);<br>
newNPC.absX = x;<br>
newNPC.absY = y;<br>
newNPC.makeX = x;<br>
newNPC.makeY = y;<br>
newNPC.heightLevel = heightLevel;<br>
newNPC.walkingType = WalkingType;<br>
newNPC.HP = HP;<br>
newNPC.MaxHP = HP;<br>
newNPC.maxHit = maxHit;<br>
newNPC.attack = attack;<br>
newNPC.defence = defence;<br>
newNPC.spawnedBy = c.getId();<br>
if (headIcon)<br>
c.getPA().drawHeadicon(1, slot, 0, 0);<br>
if (attackPlayer) {<br>
newNPC.underAttack = true;<br>
if (c != null) {<br>
if (Barrows.isBarrowsNpc(newNPC.npcType)) {<br>
for (BarrowsData b : BarrowsData.values()) {<br>
if (c.randomCoffin == b.getId())<br>
newNPC.forceChat(“You dare steal from us!”);<br>
else<br>
newNPC.forceChat(“You dare disturb my rest!”);<br>
}<br>
}<br>
if (newNPC.npcType &gt;= 4278 &amp;&amp; newNPC.npcType &lt;= 4284) {<br>
newNPC.forceAnim(4410);<br>
newNPC.forceChat(“I’M ALIVE!”);<br>
}</p>
<pre><code>			newNPC.killerId = c.playerId;
		}
	}
	npcs[slot] = newNPC;
}[/code]</code></pre>
      </div>

      <meta itemprop='headline' content='[Solved][PI] Spawning NPCs at too far a distance = non-attackable npc?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Hyperon.html'><span itemprop='name'>Hyperon</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-07T02:20:08Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:03:45Z' class='post-time'>
              August 4, 2016,  2:03pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I would suggest ripping those two methods from a different source and seeing if it’s something else. I wouldn’t know what else to suggest. Sounds like the NPCs are nulling. Could it being region loading?</p>
<p>Try spawn a Jad outside of fight caves at a distance of greater than 12 and see if it still occurs. Narrow down the possibilities.</p>
      </div>

      <meta itemprop='headline' content='[Solved][PI] Spawning NPCs at too far a distance = non-attackable npc?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/runescape_sucks.html'><span itemprop='name'>runescape_sucks</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-07T02:31:42Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:03:45Z' class='post-time'>
              August 4, 2016,  2:03pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>You should check the methods that make aggressiveness possible. The same for despawning.</p>
<p>See what the conditions are</p>
      </div>

      <meta itemprop='headline' content='[Solved][PI] Spawning NPCs at too far a distance = non-attackable npc?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sk8rdude461.html'><span itemprop='name'>sk8rdude461</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-07T02:34:33Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:03:45Z' class='post-time'>
              August 4, 2016,  2:03pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“runescape sucks, post:3, topic:548298”]You should check the methods that make aggressiveness possible. The same for despawning.</p>
<p>See what the conditions are[/quote]</p>
<p>I fixed it, hadn’t had time to edit the post. It was distance checking…</p>
<p>[quote=“Hyperon, post:2, topic:548298”]I would suggest ripping those two methods from a different source and seeing if it’s something else. I wouldn’t know what else to suggest. Sounds like the NPCs are nulling. Could it being region loading?</p>
<p>Try spawn a Jad outside of fight caves at a distance of greater than 12 and see if it still occurs. Narrow down the possibilities.[/quote]<br>
It would do that with any player spawned npc. At a certain distance it (Probably either when they’re out of drawing range or in a new region) it removes the player’s spawned npc.</p>
      </div>

      <meta itemprop='headline' content='[Solved][PI] Spawning NPCs at too far a distance = non-attackable npc?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Hyperon.html'><span itemprop='name'>Hyperon</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-12-07T02:37:11Z'>
            <time itemprop='dateModified' datetime='2016-08-04T14:03:45Z' class='post-time'>
              August 4, 2016,  2:03pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Ha. Good job.</p>
<blockquote>
<p>Server Helper needs help<br>
Helps himself <img src="../../images/emoji/twitter/coolae52.png?v=5" title=":cool:" class="emoji" alt=":cool:"></p>
</blockquote>
      </div>

      <meta itemprop='headline' content='[Solved][PI] Spawning NPCs at too far a distance = non-attackable npc?'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/solved-pi-spawning-npcs-at-too-far-a-distance-non-attackable-npc/548298 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:07:32 GMT -->
</html>
