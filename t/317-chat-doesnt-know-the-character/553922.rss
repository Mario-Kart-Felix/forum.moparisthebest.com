<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
    <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922</link>
    <description>Hey,

Whenever i type a &quot; in game it shows this:
http://puu.sh/lvT1j/65b5214876.png
http://puu.sh/lvT2O/12adbecd08.png

So it replaces the &quot; with an E
I&#39;ve looked at this (Misc.java), this is server sided:
[code=java]
public static char xlateTable[] = { &#39; &#39;, &#39;e&#39;, &#39;t&#39;, &#39;a&#39;, &#39;o&#39;, &#39;i&#39;, &#39;h&#39;, &#39;n&#39;,
		&#39;s&#39;, &#39;r&#39;, &#39;d&#39;, &#39;l&#39;, &#39;u&#39;, &#39;m&#39;, &#39;w&#39;, &#39;c&#39;, &#39;y&#39;, &#39;f&#39;, &#39;g&#39;, &#39;p&#39;, &#39;b&#39;,
		&#39;v&#39;, &#39;k&#39;, &#39;x&#39;, &#39;j&#39;, &#39;q&#39;, &#39;z&#39;, &#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;,
		&#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39; &#39;, &#39;!&#39;, &#39;?&#39;, &#39;.&#39;, &#39;,&#39;, &#39;:&#39;, &#39;;&#39;, &#39;(&#39;, &#39;)&#39;, &#39;-&#39;,
		&#39;&amp;&#39;, &#39;*&#39;, &#39;\\&#39;, &#39;\&#39;&#39;, &#39;@&#39;, &#39;#&#39;, &#39;+&#39;, &#39;=&#39;, &#39;\243&#39;, &#39;$&#39;, &#39;%&#39;, &#39;&quot;&#39;,
		&#39;[&#39;, &#39;]&#39; };

[/code]

Entire class:
[code=java]
package com.ruseps.util;

import java.io.ByteArrayInputStream;
import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.URL;
import java.nio.ByteBuffer;
import java.nio.channels.FileChannel;
import java.text.NumberFormat;
import java.time.ZonedDateTime;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Enumeration;
import java.util.LinkedList;
import java.util.List;
import java.util.Random;
import java.util.concurrent.TimeUnit;
import java.util.zip.GZIPInputStream;

import org.jboss.netty.buffer.ChannelBuffer;

import com.ruseps.model.Item;
import com.ruseps.model.Position;
import com.ruseps.world.content.combat.CombatContainer.CombatHit;
import com.ruseps.world.entity.impl.player.Player;

public class Misc {


	/** Random instance, used to generate pseudo-random primitive types. */
	public static final Random RANDOM = new Random(System.currentTimeMillis());

	private static ZonedDateTime zonedDateTime;
	public static final int HALF_A_DAY_IN_MILLIS = 43200000;

	public static CombatHit[] concat(CombatHit[] a, CombatHit[] b) {
		int aLen = a.length;
		int bLen = b.length;
		CombatHit[] c= new CombatHit[aLen+bLen];
		System.arraycopy(a, 0, c, 0, aLen);
		System.arraycopy(b, 0, c, aLen, bLen);
		return c;
	}

	public static List&lt;Player&gt; getCombinedPlayerList(Player p) {
		List&lt;Player&gt; plrs = new LinkedList&lt;Player&gt;();
		for(Player localPlayer : p.getLocalPlayers()) {
			if(localPlayer != null)
				plrs.add(localPlayer);
		}
		plrs.add(p);
		return plrs;
	}

	public static String getCurrentServerTime() {
		zonedDateTime = ZonedDateTime.now();
		int hour = zonedDateTime.getHour();
		String hourPrefix = hour &lt; 10 ? &quot;0&quot;+hour+&quot;&quot; : &quot;&quot;+hour+&quot;&quot;;
		int minute = zonedDateTime.getMinute();
		String minutePrefix = minute &lt; 10 ? &quot;0&quot;+minute+&quot;&quot; : &quot;&quot;+minute+&quot;&quot;;
		return &quot;&quot;+hourPrefix+&quot;:&quot;+minutePrefix+&quot;&quot;;
	}

	public static String getTimePlayed(long totalPlayTime) {
		final int sec = (int) (totalPlayTime / 1000), h = sec / 3600, m = sec / 60 % 60, s = sec % 60;
		return (h &lt; 10 ? &quot;0&quot; + h : h) + &quot;:&quot; + (m &lt; 10 ? &quot;0&quot; + m : m) + &quot;:&quot; + (s &lt; 10 ? &quot;0&quot; + s : s);
	}

	public static int getMinutesPlayed(Player p) {
		long totalPlayTime = p.getTotalPlayTime() + (p.getRecordedLogin().elapsed());
		int sec = (int) (totalPlayTime / 1000), h = sec / 3600, m = sec / 60 % 60;
		for(int i = 0; i &lt; h; i++)
			m+=60;
		return m;
	}

	public static String getHoursPlayed(long totalPlayTime) {
		final int sec = (int) (totalPlayTime / 1000), h = sec / 3600;
		return (h &lt; 10 ? &quot;0&quot; + h : h) + &quot;h&quot;;
	}

	public static int getMinutesPassed(long t) {
		int seconds=(int) ((t/1000)%60);
		int minutes=(int) (((t-seconds)/1000)/60);
		return minutes;
	}

	public static Item[] concat(Item[] a, Item[] b) {
		int aLen = a.length;
		int bLen = b.length;
		Item[] c= new Item[aLen+bLen];
		System.arraycopy(a, 0, c, 0, aLen);
		System.arraycopy(b, 0, c, aLen, bLen);
		return c;
	}

	public static Player getCloseRandomPlayer(List&lt;Player&gt; plrs) {
		int index = Misc.getRandom(plrs.size() - 1);
		if(index &gt; 0) 
			return plrs.get(index);
		return null;
	}

	public static byte directionDeltaX[] = new byte[]{ 0, 1, 1, 1, 0,-1,-1,-1 };
	public static byte directionDeltaY[] = new byte[]{ 1, 1, 0,-1,-1,-1, 0, 1 };	
	public static byte xlateDirectionToClient[] = new byte[]{ 1, 2, 4, 7, 6, 5, 3, 0 };

	public static int getRandom(int range) {
		return (int) (java.lang.Math.random() * (range + 1));
	}

	public static int direction(int srcX, int srcY, int x, int y) {
		double dx = (double) x - srcX, dy = (double) y - srcY;
		double angle = Math.atan(dy / dx);
		angle = Math.toDegrees(angle);
		if (Double.isNaN(angle))
			return -1;
		if (Math.signum(dx) &lt; 0)
			angle += 180.0;
		return (int) ((((90 - angle) / 22.5) + 16) % 16);
		/*int changeX = x - srcX; int changeY = y - srcY;
		for (int j = 0; j &lt; directionDeltaX.length; j++) {
			if (changeX == directionDeltaX[j] &amp;&amp;
				changeY == directionDeltaY[j])
				return j;

		}
		return -1;*/
	}

	public static String ucFirst(String str) {
		str = str.toLowerCase();
		if (str.length() &gt; 1) {
			str = str.substring(0, 1).toUpperCase() + str.substring(1);
		} else {
			return str.toUpperCase();
		}
		return str;
	}

	public static String format(int num) {
		return NumberFormat.getInstance().format(num);
	}

	public static String formatText(String s) {
		for (int i = 0; i &lt; s.length(); i++) {
			if (i == 0) {
				s = String.format(&quot;%s%s&quot;, Character.toUpperCase(s.charAt(0)),
						s.substring(1));
			}
			if (!Character.isLetterOrDigit(s.charAt(i))) {
				if (i + 1 &lt; s.length()) {
					s = String.format(&quot;%s%s%s&quot;, s.subSequence(0, i + 1),
							Character.toUpperCase(s.charAt(i + 1)),
							s.substring(i + 2));
				}
			}
		}
		return s.replace(&quot;_&quot;, &quot; &quot;);
	}

	public static String getTotalAmount(int j) {
		if (j &gt;= 10000 &amp;&amp; j &lt; 10000000) {
			return j / 1000 + &quot;K&quot;;
		} else if (j &gt;= 10000000 &amp;&amp; j &lt;= 2147483647) {
			return j / 1000000 + &quot;M&quot;;
		} else {
			return &quot;&quot; + j + &quot; coins&quot;;
		}
	}

	public static String formatPlayerName(String str) {
		String str1 = Misc.ucFirst(str);
		str1.replace(&quot;_&quot;, &quot; &quot;);
		return str1;
	}

	public static String insertCommasToNumber(String number) {
		return number.length() &lt; 4 ? number : insertCommasToNumber(number
				.substring(0, number.length() - 3))
				+ &quot;,&quot;
				+ number.substring(number.length() - 3, number.length());
	}

	private static char decodeBuf[] = new char[4096];

	public static String textUnpack(byte packedData[], int size) {
		int idx = 0, highNibble = -1;
		for (int i = 0; i &lt; size * 2; i++) {
			int val = packedData[i / 2] &gt;&gt; (4 - 4 * (i % 2)) &amp; 0xf;
		if (highNibble == -1) {
			if (val &lt; 13)
				decodeBuf[idx++] = xlateTable[val];
			else
				highNibble = val;
		} else {
			decodeBuf[idx++] = xlateTable[((highNibble &lt;&lt; 4) + val) - 195];
			highNibble = -1;
		}
		}

		return new String(decodeBuf, 0, idx);
	}

	public static char xlateTable[] = { &#39; &#39;, &#39;e&#39;, &#39;t&#39;, &#39;a&#39;, &#39;o&#39;, &#39;i&#39;, &#39;h&#39;, &#39;n&#39;,
		&#39;s&#39;, &#39;r&#39;, &#39;d&#39;, &#39;l&#39;, &#39;u&#39;, &#39;m&#39;, &#39;w&#39;, &#39;c&#39;, &#39;y&#39;, &#39;f&#39;, &#39;g&#39;, &#39;p&#39;, &#39;b&#39;,
		&#39;v&#39;, &#39;k&#39;, &#39;x&#39;, &#39;j&#39;, &#39;q&#39;, &#39;z&#39;, &#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;,
		&#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39; &#39;, &#39;!&#39;, &#39;?&#39;, &#39;.&#39;, &#39;,&#39;, &#39;:&#39;, &#39;;&#39;, &#39;(&#39;, &#39;)&#39;, &#39;-&#39;,
		&#39;&amp;&#39;, &#39;*&#39;, &#39;\\&#39;, &#39;\&#39;&#39;, &#39;@&#39;, &#39;#&#39;, &#39;+&#39;, &#39;=&#39;, &#39;\243&#39;, &#39;$&#39;, &#39;%&#39;, &#39;&quot;&#39;,
		&#39;[&#39;, &#39;]&#39; };

	public static String anOrA(String s) {
		s = s.toLowerCase();
		if(s.equalsIgnoreCase(&quot;anchovies&quot;) || s.equalsIgnoreCase(&quot;soft clay&quot;) || s.equalsIgnoreCase(&quot;cheese&quot;) || s.equalsIgnoreCase(&quot;ball of wool&quot;) || s.equalsIgnoreCase(&quot;spice&quot;) || s.equalsIgnoreCase(&quot;steel nails&quot;) || s.equalsIgnoreCase(&quot;snape grass&quot;) || s.equalsIgnoreCase(&quot;coal&quot;))
			return &quot;some&quot;;
		if(s.startsWith(&quot;a&quot;) || s.startsWith(&quot;e&quot;) || s.startsWith(&quot;i&quot;) || s.startsWith(&quot;o&quot;) || s.startsWith(&quot;u&quot;)) 
			return &quot;an&quot;;
		return &quot;a&quot;;
	}

	@SuppressWarnings(&quot;rawtypes&quot;)
	public static Class[] getClasses(String packageName) throws ClassNotFoundException, IOException {
		ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
		assert classLoader != null;
		String path = packageName.replace(&#39;.&#39;, &#39;/&#39;);
		Enumeration&lt;URL&gt; resources = classLoader.getResources(path);
		List&lt;File&gt; dirs = new ArrayList&lt;File&gt;();
		while (resources.hasMoreElements()) {
			URL resource = resources.nextElement();
			dirs.add(new File(resource.getFile()));
		}
		ArrayList&lt;Class&gt; classes = new ArrayList&lt;Class&gt;();
		for (File directory : dirs) {
			classes.addAll(findClasses(directory, packageName));
		}
		return classes.toArray(new Class[classes.size()]);
	}

	@SuppressWarnings(&quot;rawtypes&quot;)
	private static List&lt;Class&gt; findClasses(File directory, String packageName) throws ClassNotFoundException {
		List&lt;Class&gt; classes = new ArrayList&lt;Class&gt;();
		if (!directory.exists()) {
			return classes;
		}
		File[] files = directory.listFiles();
		for (File file : files) {
			if (file.isDirectory()) {
				assert !file.getName().contains(&quot;.&quot;);
				classes.addAll(findClasses(file, packageName + &quot;.&quot; + file.getName()));
			} else if (file.getName().endsWith(&quot;.class&quot;)) {
				classes.add(Class.forName(packageName + &#39;.&#39; + file.getName().substring(0, file.getName().length() - 6)));
			}
		}
		return classes;
	}

	public static int randomMinusOne(int length) {
		return getRandom(length - 1);
	}

	public static String removeSpaces(String s) {
		return s.replace(&quot; &quot;, &quot;&quot;);
	}

	public static int getMinutesElapsed(int minute, int hour, int day, int year) {
		Calendar i = Calendar.getInstance();

		if (i.get(1) == year) {
			if (i.get(6) == day) {
				if (hour == i.get(11)) {
					return i.get(12) - minute;
				}
				return (i.get(11) - hour) * 60 + (59 - i.get(12));
			}

			int ela = (i.get(6) - day) * 24 * 60 * 60;
			return ela &gt; 2147483647 ? 2147483647 : ela;
		}

		int ela = getElapsed(day, year) * 24 * 60 * 60;

		return ela &gt; 2147483647 ? 2147483647 : ela;
	}

	public static int getDayOfYear() {
		Calendar c = Calendar.getInstance();
		int year = c.get(Calendar.YEAR);
		int month = c.get(Calendar.MONTH);
		int days = 0;
		int[] daysOfTheMonth = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
		if ((year % 4 == 0) &amp;&amp; (year % 100 != 0) || (year % 400 == 0)) {
			daysOfTheMonth[1] = 29;
		}
		days += c.get(Calendar.DAY_OF_MONTH);
		for (int i = 0; i &lt; daysOfTheMonth.length; i++) {
			if (i &lt; month) {
				days += daysOfTheMonth[i];
			}
		}
		return days;
	}

	public static int getYear() {
		Calendar c = Calendar.getInstance();
		return c.get(Calendar.YEAR);
	}

	public static int getElapsed(int day, int year) {
		if (year &lt; 2013) {
			return 0;
		}

		int elapsed = 0;
		int currentYear = Misc.getYear();
		int currentDay = Misc.getDayOfYear();

		if (currentYear == year) {
			elapsed = currentDay - day;
		} else {
			elapsed = currentDay;

			for (int i = 1; i &lt; 5; i++) {
				if (currentYear - i == year) {
					elapsed += 365 - day;
					break;
				} else {
					elapsed += 365;
				}
			}
		}

		return elapsed;
	}

	public static boolean isWeekend() {
		int day = Calendar.getInstance().get(7);
		return (day == 1) || (day == 6) || (day == 7);
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive
	 * &lt;code&gt;min&lt;/code&gt; and exclusive &lt;code&gt;max&lt;/code&gt;.
	 * 
	 * &lt;br&gt;
	 * &lt;br&gt;
	 * This method is thread-safe. &lt;/br&gt;
	 * 
	 * @param min
	 *            The minimum inclusive number.
	 * @param max
	 *            The maximum exclusive number.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If the specified range is less &lt;tt&gt;0&lt;/tt&gt;
	 */
	public static int exclusiveRandom(int min, int max) {
		if (max &lt;= min) {
			max = min + 1;
		}
		return RANDOM.nextInt((max - min)) + min;
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive &lt;tt&gt;0&lt;/tt&gt;
	 * and exclusive &lt;code&gt;range&lt;/code&gt;.
	 * 
	 * &lt;br&gt;
	 * &lt;br&gt;
	 * This method is thread-safe. &lt;/br&gt;
	 * 
	 * @param range
	 *            The exclusive range.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If the specified range is less &lt;tt&gt;0&lt;/tt&gt;
	 */
	public static int exclusiveRandom(int range) {
		return exclusiveRandom(0, range);
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive
	 * &lt;code&gt;min&lt;/code&gt; and inclusive &lt;code&gt;max&lt;/code&gt;.
	 * 
	 * @param min
	 *            The minimum inclusive number.
	 * @param max
	 *            The maximum inclusive number.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If {@code max - min + 1} is less than &lt;tt&gt;0&lt;/tt&gt;.
	 * @see {@link #exclusiveRandom(int)}.
	 */
	public static int inclusiveRandom(int min, int max) {
		if (max &lt; min) {
			max = min + 1;
		}
		return exclusiveRandom((max - min) + 1) + min;
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive &lt;tt&gt;0&lt;/tt&gt;
	 * and inclusive &lt;code&gt;range&lt;/code&gt;.
	 * 
	 * @param range
	 *            The maximum inclusive number.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If {@code max - min + 1} is less than &lt;tt&gt;0&lt;/tt&gt;.
	 * @see {@link #exclusiveRandom(int)}.
	 */
	public static int inclusiveRandom(int range) {
		return inclusiveRandom(0, range);
	}

	public static byte[] readFile(File s) {
		try {
			FileInputStream fis = new FileInputStream(s);
			FileChannel fc = fis.getChannel();
			ByteBuffer buf = ByteBuffer.allocate((int) fc.size());
			fc.read(buf);
			buf.flip();
			fis.close();
			return buf.array();
		} catch (Exception e) {
			System.out.println(&quot;FILE : &quot; + s.getName() + &quot; missing.&quot;);
			return null;
		}
	}

	public static byte[] getBuffer(File f) throws Exception
	{
		if(!f.exists())
			return null;
		byte[] buffer = new byte[(int) f.length()];
		DataInputStream dis = new DataInputStream(new FileInputStream(f));
		dis.readFully(buffer);
		dis.close();
		byte[] gzipInputBuffer = new byte[999999];
		int bufferlength = 0;
		GZIPInputStream gzip = new GZIPInputStream(new ByteArrayInputStream(buffer));
		do {
			if(bufferlength == gzipInputBuffer.length)
			{
				System.out.println(&quot;Error inflating data.\nGZIP buffer overflow.&quot;);
				break;
			}
			int readByte = gzip.read(gzipInputBuffer, bufferlength, gzipInputBuffer.length - bufferlength);
			if(readByte == -1)
				break;
			bufferlength += readByte;
		} while(true);
		byte[] inflated = new byte[bufferlength];
		System.arraycopy(gzipInputBuffer, 0, inflated, 0, bufferlength);
		buffer = inflated;
		if(buffer.length &lt; 10)
			return null;
		return buffer;
	}

	public static int getTimeLeft(long start, int timeAmount, TimeUnit timeUnit) {
		start -= timeUnit.toMillis(timeAmount);
		long elapsed = System.currentTimeMillis() - start;
		int toReturn = timeUnit == TimeUnit.SECONDS ? (int) ((elapsed / 1000) % 60) - timeAmount : (int) ((elapsed / 1000) / 60) - timeAmount;
		if(toReturn &lt;= 0)
			toReturn = 1;
		return timeAmount - toReturn;
	}

	/**
	 * Converts an array of bytes to an integer.
	 * 
	 * @param data
	 *            the array of bytes.
	 * @return the newly constructed integer.
	 */
	public static int hexToInt(byte[] data) {
		int value = 0;
		int n = 1000;
		for (int i = 0; i &lt; data.length; i++) {
			int num = (data[i] &amp; 0xFF) * n;
			value += num;
			if (n &gt; 1) {
				n = n / 1000;
			}
		}
		return value;
	}

	public static Position delta(Position a, Position b) {
		return new Position(b.getX() - a.getX(), b.getY() - a.getY());
	}

	/**
	 * Picks a random element out of any array type.
	 * 
	 * @param array
	 *            the array to pick the element from.
	 * @return the element chosen.
	 */
	public static &lt;T&gt; T randomElement(T[] array) {
		return array[(int) (RANDOM.nextDouble() * array.length)];
	}

	/**
	 * Picks a random element out of any list type.
	 * 
	 * @param list
	 *            the list to pick the element from.
	 * @return the element chosen.
	 */
	public static &lt;T&gt; T randomElement(List&lt;T&gt; list) {
		return list.get((int) (RANDOM.nextDouble() * list.size()));
	}

	/**
	 * Reads string from a data input stream.
	 * @param inputStream 	The input stream to read string from.
	 * @return 				The String value.
	 */
	public static String readString(ChannelBuffer buffer) {
		StringBuilder builder = null;
		try {
			byte data;
			builder = new StringBuilder();
			while ((data = buffer.readByte()) != 10) {
				builder.append((char) data);
			}
		} catch(IndexOutOfBoundsException e) {

		}
		return builder.toString();
	}

	private static final String[] BLOCKED_WORDS = new String[]{
		&quot;devious&quot;, &quot;firepk&quot;, &quot;ventrilica&quot;, &quot;ventrili&quot;,
		&quot;hade5&quot;, &quot;hades5&quot;, &quot;pvplegacy&quot;, &quot;junglepk&quot;, &quot;runeinsanit&quot;,
		&quot;n3t&quot;, &quot;n e t&quot;, &quot;n et&quot;, &quot;ne t&quot;, &quot;c  0 m&quot;, &quot;c 0 m&quot;, &quot;C 0  m&quot;,
		&quot;c  o  m&quot;, &quot;runeinsanity&quot;, &quot;runeinsanit&quot;, &quot;runeinsan&quot;,
		&quot;rune-insanity&quot;, &quot;rune-insanit&quot;, &quot;.c0&quot;, &quot;.c0m&quot;,
		&quot;legendsdomain&quot;, &quot;createaforum&quot;, &quot;vampirez&quot;, &quot;-scape&quot;,
		&quot;rswebclients&quot;, &quot;pvplegacy&quot;, &quot;junglepk&quot;, &quot;.n3t&quot;, &quot;.c0m&quot;, &quot;c0m&quot;,
		&quot;n3t&quot;, &quot;.tk&quot;, &quot;,net&quot;, &quot;,runescape&quot;, &quot;pvpmaster&quot;, &quot;pvpmasters&quot;,
		&quot;PvPMasters.&quot;, &quot;,org&quot;, &quot;,com&quot;, &quot;,be&quot;, &quot;,nl&quot;, &quot;,info&quot;, &quot;dspk&quot;,
		&quot;.info&quot;, &quot;.org&quot;, &quot;.tk&quot;, &quot;.net&quot;, &quot;.com&quot;, &quot;.co.uk&quot;, &quot;.be&quot;, &quot;.nl&quot;,
		&quot;.dk&quot;, &quot;.co.cz&quot;, &quot;.co&quot;, &quot;.us&quot;, &quot;.biz&quot;, &quot;.eu&quot;, &quot;.de&quot;, &quot;.cc&quot;, &quot;. n e  t&quot;,
		&quot;.i n f o&quot;, &quot;.o r g&quot;, &quot;.t k&quot;, &quot;.n e t&quot;, &quot;.c o m&quot;, &quot;.c o . u k&quot;,
		&quot;.b e&quot;, &quot;.n l&quot;, &quot;.d k&quot;, &quot;.c o . c z&quot;, &quot;.c o&quot;, &quot;.u s&quot;, &quot;.b i z&quot;,
		&quot;.e u&quot;, &quot;.d e&quot;, &quot;.c c&quot;, &quot;.(c)om&quot;, &quot;(.)&quot;, &quot;kandarin&quot;, &quot;o r g&quot;, &quot;www&quot;, 
		&quot;w w w&quot;, &quot;w.w.w&quot;, &quot;voidrsps&quot;, &quot;void-ps&quot;, &quot;desolace&quot;, &quot;ikov&quot;, &quot;soulsplit&quot;, 
		&quot;soulspawn&quot;, &quot;atiloc&quot;, &quot;&lt;img&quot;, &quot;@cr&quot;, &quot;i k o v&quot;, &quot;ik0v&quot;, &quot;&lt;img=&quot;, &quot;@cr&quot;, &quot;:tradereq:&quot;, &quot;:duelreq:&quot;,
		&quot;&lt;col=&quot;, &quot;&lt;shad=&quot;, &quot;hostilityps&quot;, &quot;hostilityp&quot;, &quot;hostility ps&quot;};


	public static boolean blockedWord(String string) {
		for(String s : BLOCKED_WORDS) {
			if(string.contains(s)) {
				return true;
			}
		}
		return false;
	}
}

[/code]

But then i figured, it&#39;s client sided. But i have no idea where i need to look. If it&#39;s of any use this is the ChatPacketListener:
[code=java]
package com.ruseps.net.packet.impl;

import com.ruseps.model.ChatMessage.Message;
import com.ruseps.model.Flag;
import com.ruseps.net.packet.Packet;
import com.ruseps.net.packet.PacketListener;
import com.ruseps.util.Misc;
import com.ruseps.world.content.PlayerPunishment;
import com.ruseps.world.content.dialogue.DialogueManager;
import com.ruseps.world.entity.impl.player.Player;
import com.ruseps.model.PlayerRights;


/**
 * This packet listener manages the spoken text by a player.
 * 
 * @author relex lawl
 */

public class ChatPacketListener implements PacketListener {

	@Override
	public void handleMessage(Player player, Packet packet) {
		int effects = packet.readUnsignedByteS();
		int color = packet.readUnsignedByteS();
		int size = packet.getSize();
		byte[] text = packet.readReversedBytesA(size);
		if(PlayerPunishment.muted(player.getUsername()) || PlayerPunishment.IPMuted(player.getHostAddress())) {
			player.getPacketSender().sendMessage(&quot;You are muted and cannot chat.&quot;);
			return;
		}
		/*
		if(Misc.getMinutesPlayed(player) &lt;= 15) {
			player.getPacketSender().sendMessage(&quot;You have been online for less then 15 minutes and cannot chat yet.&quot;);
			player.getPacketSender().sendMessage(&quot;This is to prevent spam/advertising!&quot;);
			return;
		}
		*/
		String str = Misc.textUnpack(text, size).toLowerCase().replaceAll(&quot;;&quot;, &quot;.&quot;);
		if(Misc.blockedWord(str)) {
			DialogueManager.sendStatement(player, &quot;A word was blocked in your sentence. Please do not repeat it!&quot;);
			return;
		}
		player.getChatMessages().set(new Message(color, effects, text));
		player.getUpdateFlag().flag(Flag.CHAT);
	}

}

[/code]

Also found something else in PacketConstants:
[code=java]
	/**
	 * The size of packets sent from client to the server 
	 * used to decode them.
	 */
	public final static int[] MESSAGE_SIZES = {
		0, 0, 2, 1, -1, -1, 2, 4, 4, 4, //0
		4, -1, -1, -1, 8, 0, 6, 2, 2, 0,  //10
		0, 2, 0, 6, 0, 12, 0, 0, 0, 0, //20
		9, 0, 0, 0, 0, 8, 4, 0, 0, 2,  //30
		2, 6, 0, 6, 0, -1, 0, 0, 0, 1, //40
		0, 0, 0, 12, 0, 0, 0, 8, 8, 0, //50
		-1, 8, 0, 0, 0, 0, 0, 0, 0, 0,  //60
		6, 0, 2, 2, 8, 6, 0, -1, 0, 6, //70
		-1, 0, 0, 0, 0, 1, 4, 6, 0, 0,  //80
		0, 0, 0, 0, 0, 3, 0, 0, -1, 0, //90
		0, 13, 0, -1, 0, 0, 0, 0, 0, 0,//100
		0, 0, 0, 0, 0, 0, 0, 6, 0, 0,  //110
		1, 0, 6, 0, 0, 0, -1, 0, 2, 6, //120
		0, 4, 6, 8, 0, 6, 0, 0, 6, 2,  //130
		0, 0, 0, 0, 0, 6, 0, 0, 0, 0,  //140
		0, 0, 1, 2, 0, 2, 6, 0, 0, 0,  //150
		0, 0, 0, 0, -1, -1, 0, 0, 0, 0,//160
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  //170
		0, 8, 0, 3, 0, 2, 0, 0, 8, 1,  //180
		0, 0, 12, 0, 0, 0, 0, 0, 0, 0, //190
		2, 0, 0, 0, 2, 0, 0, 0, 4, 0,  //200
		4, 0, 0, 0, 7, 8, 0, 0, 10, 0, //210
		0, 0, 3, 2, 0, 0, -1, 0, 6, 1, //220
		1, 0, 0, 0, 6, 0, 6, 8, 1, 0,  //230
		0, 4, 0, 0, 0, 0, -1, 0, -1, 4,//240
		0, 0, 6, 6, 0, 0           //250
	};
[/code]

If i need to post any other file here let me now.
I&#39;m using Ruse as source.

TL;DR: In what file do i need to look to fix the problem (&quot; gets replaced with E). Or how do i search where i need to look?

Thanks</description>
    
    <lastBuildDate>Tue, 09 Feb 2016 19:30:11 +0000</lastBuildDate>
    <category>Game Development</category>
    <atom:link href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="12" data-topic="553922">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/roar337/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> Roar337:</div>
<blockquote>
<p>sk8r are you sure? \ is a switch in java its purpose is to signify when a special character is being used its not read as part of a string. Maybe its a java versions thing but i withdraw my previous answer appears I didn’t read to much into the problem if you do think its the table however try ‘34’ instead</p>
</blockquote>
</aside>
<p>You clearly didn’t read anything I said.<br>
There is a reason I put a double quote, the slash, a double quote, and then another double quote.<br>
In a <span class="bbcode-b">STRING</span>, The start and end of it are signified by a <span class="bbcode-b">double quote</span>. Now, lets say you want to use one in your string.<br>
You would place an <span class="bbcode-u">escape character</span> in front of it. The escape character is .<br>
Therefore, if you wanted a String with <span class="bbcode-u">just a quote</span> you would make it:</p>
<pre><code class="lang-auto"></code></pre>
<p>Don’t believe me? Go try it.</p>
<p>But for characters, it’s a <span class="bbcode-u">single quote</span>. So you don’t need an escape character for the double quote.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/13</link>
        <pubDate>Tue, 09 Feb 2016 19:30:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-13</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@Roar337 Roar337]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/roar337">@Roar337</a> wrote:</p>
          <blockquote>
              <p>sk8r are you sure? \ is a switch in java its purpose is to signify when a special character is being used its not read as part of a string. Maybe its a java versions thing but i withdraw my previous answer appears I didn’t read to much into the problem if you do think its the table however try ‘34’ instead</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/12</link>
        <pubDate>Tue, 09 Feb 2016 17:46:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-12</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@Soulxs Soulxs]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/soulxs">@Soulxs</a> wrote:</p>
          <blockquote>
              <p>Still hasnt been fixed… does anyone know what i am supposed to do?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/11</link>
        <pubDate>Mon, 07 Dec 2015 16:59:56 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-11</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>[quote=“Roar337, post:8, topic:553922”]Hi there your issue seems to be with java itself quote marks are use a lot in the actual java files all you need to do is add the special character ermm character try this</p>
<p>‘"’ should be ‘"’[/quote]<br>
You’re mixing strings and characters.</p>
<p><code>"</code> is a character. “”" would be a string.<br>
Notice how the xlate table is an array of characters.<br>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="https://stackoverflow.com/questions/10430043/difference-between-char-and-string-in-java" target="_blank" rel="nofollow noopener">stackoverflow.com</a>
  </header>
  <article class="onebox-body">
      <a href="https://stackoverflow.com/users/1181992/android-girl" target="_blank" rel="nofollow noopener">
    <img alt="Android Girl" src="https://www.gravatar.com/avatar/b53a5b5e9f3b0710fe3612d11564db25?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="https://stackoverflow.com/questions/10430043/difference-between-char-and-string-in-java" target="_blank" rel="nofollow noopener">Difference between "char" and "String" in Java</a>
</h4>

<div class="tags">
  <strong>java, string, char</strong>
</div>

<div class="date">
  asked by
  
  <a href="https://stackoverflow.com/users/1181992/android-girl" target="_blank" rel="nofollow noopener">
    Android Girl
  </a>
  on <a href="https://stackoverflow.com/questions/10430043/difference-between-char-and-string-in-java" target="_blank" rel="nofollow noopener">11:02AM - 03 May 12</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/10</link>
        <pubDate>Thu, 03 Dec 2015 06:32:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-10</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@Soulxs Soulxs]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/soulxs">@Soulxs</a> wrote:</p>
          <blockquote>
              <p>Add that where exactly? Lol</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/9</link>
        <pubDate>Thu, 03 Dec 2015 06:14:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-9</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@Roar337 Roar337]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/roar337">@Roar337</a> wrote:</p>
          <blockquote>
              <p>Hi there your issue seems to be with java itself quote marks are use a lot in the actual java files all you need to do is add the special character ermm character try this</p>
<p>‘"’ should be ‘"’</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/8</link>
        <pubDate>Tue, 01 Dec 2015 16:56:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-8</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@Soulxs Soulxs]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/soulxs">@Soulxs</a> wrote:</p>
          <blockquote>
              <p>Nope</p>
<p>I did find something else though:<br>
<a href="http://puu.sh/lzrJr/71d51354c1.jpg" class="onebox" target="_blank" rel="nofollow noopener">http://puu.sh/lzrJr/71d51354c1.jpg</a><br>
It works just fine in the clan chat… Do you know any more then skr? (or anyone else)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/7</link>
        <pubDate>Thu, 26 Nov 2015 14:48:25 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-7</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@loliateyourcat loliateyourcat]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/loliateyourcat">@loliateyourcat</a> wrote:</p>
          <blockquote>
              <p>[quote=“Soulxs, post:1, topic:553922”]Hey,</p>
<p>Whenever i type a " in game it shows this:<br>
<a href="http://puu.sh/lvT1j/65b5214876.png" class="onebox" target="_blank" rel="nofollow noopener">http://puu.sh/lvT1j/65b5214876.png</a><br>
<a href="http://puu.sh/lvT2O/12adbecd08.png" class="onebox" target="_blank" rel="nofollow noopener">http://puu.sh/lvT2O/12adbecd08.png</a></p>
<p>So it replaces the " with an E<br>
I’ve looked at this (Misc.java), this is server sided:</p>
<pre><code class="lang-auto">public static char xlateTable[] = { ' ', 'e', 't', 'a', 'o', 'i', 'h', 'n',
		's', 'r', 'd', 'l', 'u', 'm', 'w', 'c', 'y', 'f', 'g', 'p', 'b',
		'v', 'k', 'x', 'j', 'q', 'z', '0', '1', '2', '3', '4', '5', '6',
		'7', '8', '9', ' ', '!', '?', '.', ',', ':', ';', '(', ')', '-',
		'&amp;', '*', '\\', '\'', '@', '#', '+', '=', '\243', '$', '%', '"',
		'[', ']' };
</code></pre>
<p>Entire class:</p>
<pre><code class="lang-auto">package com.ruseps.util;

import java.io.ByteArrayInputStream;
import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.URL;
import java.nio.ByteBuffer;
import java.nio.channels.FileChannel;
import java.text.NumberFormat;
import java.time.ZonedDateTime;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Enumeration;
import java.util.LinkedList;
import java.util.List;
import java.util.Random;
import java.util.concurrent.TimeUnit;
import java.util.zip.GZIPInputStream;

import org.jboss.netty.buffer.ChannelBuffer;

import com.ruseps.model.Item;
import com.ruseps.model.Position;
import com.ruseps.world.content.combat.CombatContainer.CombatHit;
import com.ruseps.world.entity.impl.player.Player;

public class Misc {


	/** Random instance, used to generate pseudo-random primitive types. */
	public static final Random RANDOM = new Random(System.currentTimeMillis());

	private static ZonedDateTime zonedDateTime;
	public static final int HALF_A_DAY_IN_MILLIS = 43200000;

	public static CombatHit[] concat(CombatHit[] a, CombatHit[] b) {
		int aLen = a.length;
		int bLen = b.length;
		CombatHit[] c= new CombatHit[aLen+bLen];
		System.arraycopy(a, 0, c, 0, aLen);
		System.arraycopy(b, 0, c, aLen, bLen);
		return c;
	}

	public static List&lt;Player&gt; getCombinedPlayerList(Player p) {
		List&lt;Player&gt; plrs = new LinkedList&lt;Player&gt;();
		for(Player localPlayer : p.getLocalPlayers()) {
			if(localPlayer != null)
				plrs.add(localPlayer);
		}
		plrs.add(p);
		return plrs;
	}

	public static String getCurrentServerTime() {
		zonedDateTime = ZonedDateTime.now();
		int hour = zonedDateTime.getHour();
		String hourPrefix = hour &lt; 10 ? "0"+hour+"" : ""+hour+"";
		int minute = zonedDateTime.getMinute();
		String minutePrefix = minute &lt; 10 ? "0"+minute+"" : ""+minute+"";
		return ""+hourPrefix+":"+minutePrefix+"";
	}

	public static String getTimePlayed(long totalPlayTime) {
		final int sec = (int) (totalPlayTime / 1000), h = sec / 3600, m = sec / 60 % 60, s = sec % 60;
		return (h &lt; 10 ? "0" + h : h) + ":" + (m &lt; 10 ? "0" + m : m) + ":" + (s &lt; 10 ? "0" + s : s);
	}

	public static int getMinutesPlayed(Player p) {
		long totalPlayTime = p.getTotalPlayTime() + (p.getRecordedLogin().elapsed());
		int sec = (int) (totalPlayTime / 1000), h = sec / 3600, m = sec / 60 % 60;
		for(int i = 0; i &lt; h; i++)
			m+=60;
		return m;
	}

	public static String getHoursPlayed(long totalPlayTime) {
		final int sec = (int) (totalPlayTime / 1000), h = sec / 3600;
		return (h &lt; 10 ? "0" + h : h) + "h";
	}

	public static int getMinutesPassed(long t) {
		int seconds=(int) ((t/1000)%60);
		int minutes=(int) (((t-seconds)/1000)/60);
		return minutes;
	}

	public static Item[] concat(Item[] a, Item[] b) {
		int aLen = a.length;
		int bLen = b.length;
		Item[] c= new Item[aLen+bLen];
		System.arraycopy(a, 0, c, 0, aLen);
		System.arraycopy(b, 0, c, aLen, bLen);
		return c;
	}

	public static Player getCloseRandomPlayer(List&lt;Player&gt; plrs) {
		int index = Misc.getRandom(plrs.size() - 1);
		if(index &gt; 0) 
			return plrs.get(index);
		return null;
	}

	public static byte directionDeltaX[] = new byte[]{ 0, 1, 1, 1, 0,-1,-1,-1 };
	public static byte directionDeltaY[] = new byte[]{ 1, 1, 0,-1,-1,-1, 0, 1 };	
	public static byte xlateDirectionToClient[] = new byte[]{ 1, 2, 4, 7, 6, 5, 3, 0 };

	public static int getRandom(int range) {
		return (int) (java.lang.Math.random() * (range + 1));
	}

	public static int direction(int srcX, int srcY, int x, int y) {
		double dx = (double) x - srcX, dy = (double) y - srcY;
		double angle = Math.atan(dy / dx);
		angle = Math.toDegrees(angle);
		if (Double.isNaN(angle))
			return -1;
		if (Math.signum(dx) &lt; 0)
			angle += 180.0;
		return (int) ((((90 - angle) / 22.5) + 16) % 16);
		/*int changeX = x - srcX; int changeY = y - srcY;
		for (int j = 0; j &lt; directionDeltaX.length; j++) {
			if (changeX == directionDeltaX[j] &amp;&amp;
				changeY == directionDeltaY[j])
				return j;

		}
		return -1;*/
	}

	public static String ucFirst(String str) {
		str = str.toLowerCase();
		if (str.length() &gt; 1) {
			str = str.substring(0, 1).toUpperCase() + str.substring(1);
		} else {
			return str.toUpperCase();
		}
		return str;
	}

	public static String format(int num) {
		return NumberFormat.getInstance().format(num);
	}

	public static String formatText(String s) {
		for (int i = 0; i &lt; s.length(); i++) {
			if (i == 0) {
				s = String.format("%s%s", Character.toUpperCase(s.charAt(0)),
						s.substring(1));
			}
			if (!Character.isLetterOrDigit(s.charAt(i))) {
				if (i + 1 &lt; s.length()) {
					s = String.format("%s%s%s", s.subSequence(0, i + 1),
							Character.toUpperCase(s.charAt(i + 1)),
							s.substring(i + 2));
				}
			}
		}
		return s.replace("_", " ");
	}

	public static String getTotalAmount(int j) {
		if (j &gt;= 10000 &amp;&amp; j &lt; 10000000) {
			return j / 1000 + "K";
		} else if (j &gt;= 10000000 &amp;&amp; j &lt;= 2147483647) {
			return j / 1000000 + "M";
		} else {
			return "" + j + " coins";
		}
	}

	public static String formatPlayerName(String str) {
		String str1 = Misc.ucFirst(str);
		str1.replace("_", " ");
		return str1;
	}

	public static String insertCommasToNumber(String number) {
		return number.length() &lt; 4 ? number : insertCommasToNumber(number
				.substring(0, number.length() - 3))
				+ ","
				+ number.substring(number.length() - 3, number.length());
	}

	private static char decodeBuf[] = new char[4096];

	public static String textUnpack(byte packedData[], int size) {
		int idx = 0, highNibble = -1;
		for (int i = 0; i &lt; size * 2; i++) {
			int val = packedData[i / 2] &gt;&gt; (4 - 4 * (i % 2)) &amp; 0xf;
		if (highNibble == -1) {
			if (val &lt; 13)
				decodeBuf[idx++] = xlateTable[val];
			else
				highNibble = val;
		} else {
			decodeBuf[idx++] = xlateTable[((highNibble &lt;&lt; 4) + val) - 195];
			highNibble = -1;
		}
		}

		return new String(decodeBuf, 0, idx);
	}

	public static char xlateTable[] = { ' ', 'e', 't', 'a', 'o', 'i', 'h', 'n',
		's', 'r', 'd', 'l', 'u', 'm', 'w', 'c', 'y', 'f', 'g', 'p', 'b',
		'v', 'k', 'x', 'j', 'q', 'z', '0', '1', '2', '3', '4', '5', '6',
		'7', '8', '9', ' ', '!', '?', '.', ',', ':', ';', '(', ')', '-',
		'&amp;', '*', '\\', '\'', '@', '#', '+', '=', '\243', '$', '%', '"',
		'[', ']' };

	public static String anOrA(String s) {
		s = s.toLowerCase();
		if(s.equalsIgnoreCase("anchovies") || s.equalsIgnoreCase("soft clay") || s.equalsIgnoreCase("cheese") || s.equalsIgnoreCase("ball of wool") || s.equalsIgnoreCase("spice") || s.equalsIgnoreCase("steel nails") || s.equalsIgnoreCase("snape grass") || s.equalsIgnoreCase("coal"))
			return "some";
		if(s.startsWith("a") || s.startsWith("e") || s.startsWith("i") || s.startsWith("o") || s.startsWith("u")) 
			return "an";
		return "a";
	}

	@SuppressWarnings("rawtypes")
	public static Class[] getClasses(String packageName) throws ClassNotFoundException, IOException {
		ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
		assert classLoader != null;
		String path = packageName.replace('.', '/');
		Enumeration&lt;URL&gt; resources = classLoader.getResources(path);
		List&lt;File&gt; dirs = new ArrayList&lt;File&gt;();
		while (resources.hasMoreElements()) {
			URL resource = resources.nextElement();
			dirs.add(new File(resource.getFile()));
		}
		ArrayList&lt;Class&gt; classes = new ArrayList&lt;Class&gt;();
		for (File directory : dirs) {
			classes.addAll(findClasses(directory, packageName));
		}
		return classes.toArray(new Class[classes.size()]);
	}

	@SuppressWarnings("rawtypes")
	private static List&lt;Class&gt; findClasses(File directory, String packageName) throws ClassNotFoundException {
		List&lt;Class&gt; classes = new ArrayList&lt;Class&gt;();
		if (!directory.exists()) {
			return classes;
		}
		File[] files = directory.listFiles();
		for (File file : files) {
			if (file.isDirectory()) {
				assert !file.getName().contains(".");
				classes.addAll(findClasses(file, packageName + "." + file.getName()));
			} else if (file.getName().endsWith(".class")) {
				classes.add(Class.forName(packageName + '.' + file.getName().substring(0, file.getName().length() - 6)));
			}
		}
		return classes;
	}

	public static int randomMinusOne(int length) {
		return getRandom(length - 1);
	}

	public static String removeSpaces(String s) {
		return s.replace(" ", "");
	}

	public static int getMinutesElapsed(int minute, int hour, int day, int year) {
		Calendar i = Calendar.getInstance();

		if (i.get(1) == year) {
			if (i.get(6) == day) {
				if (hour == i.get(11)) {
					return i.get(12) - minute;
				}
				return (i.get(11) - hour) * 60 + (59 - i.get(12));
			}

			int ela = (i.get(6) - day) * 24 * 60 * 60;
			return ela &gt; 2147483647 ? 2147483647 : ela;
		}

		int ela = getElapsed(day, year) * 24 * 60 * 60;

		return ela &gt; 2147483647 ? 2147483647 : ela;
	}

	public static int getDayOfYear() {
		Calendar c = Calendar.getInstance();
		int year = c.get(Calendar.YEAR);
		int month = c.get(Calendar.MONTH);
		int days = 0;
		int[] daysOfTheMonth = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
		if ((year % 4 == 0) &amp;&amp; (year % 100 != 0) || (year % 400 == 0)) {
			daysOfTheMonth[1] = 29;
		}
		days += c.get(Calendar.DAY_OF_MONTH);
		for (int i = 0; i &lt; daysOfTheMonth.length; i++) {
			if (i &lt; month) {
				days += daysOfTheMonth[i];
			}
		}
		return days;
	}

	public static int getYear() {
		Calendar c = Calendar.getInstance();
		return c.get(Calendar.YEAR);
	}

	public static int getElapsed(int day, int year) {
		if (year &lt; 2013) {
			return 0;
		}

		int elapsed = 0;
		int currentYear = Misc.getYear();
		int currentDay = Misc.getDayOfYear();

		if (currentYear == year) {
			elapsed = currentDay - day;
		} else {
			elapsed = currentDay;

			for (int i = 1; i &lt; 5; i++) {
				if (currentYear - i == year) {
					elapsed += 365 - day;
					break;
				} else {
					elapsed += 365;
				}
			}
		}

		return elapsed;
	}

	public static boolean isWeekend() {
		int day = Calendar.getInstance().get(7);
		return (day == 1) || (day == 6) || (day == 7);
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive
	 * &lt;code&gt;min&lt;/code&gt; and exclusive &lt;code&gt;max&lt;/code&gt;.
	 * 
	 * &lt;br&gt;
	 * &lt;br&gt;
	 * This method is thread-safe. &lt;/br&gt;
	 * 
	 * @param min
	 *            The minimum inclusive number.
	 * @param max
	 *            The maximum exclusive number.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If the specified range is less &lt;tt&gt;0&lt;/tt&gt;
	 */
	public static int exclusiveRandom(int min, int max) {
		if (max &lt;= min) {
			max = min + 1;
		}
		return RANDOM.nextInt((max - min)) + min;
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive &lt;tt&gt;0&lt;/tt&gt;
	 * and exclusive &lt;code&gt;range&lt;/code&gt;.
	 * 
	 * &lt;br&gt;
	 * &lt;br&gt;
	 * This method is thread-safe. &lt;/br&gt;
	 * 
	 * @param range
	 *            The exclusive range.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If the specified range is less &lt;tt&gt;0&lt;/tt&gt;
	 */
	public static int exclusiveRandom(int range) {
		return exclusiveRandom(0, range);
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive
	 * &lt;code&gt;min&lt;/code&gt; and inclusive &lt;code&gt;max&lt;/code&gt;.
	 * 
	 * @param min
	 *            The minimum inclusive number.
	 * @param max
	 *            The maximum inclusive number.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If {@code max - min + 1} is less than &lt;tt&gt;0&lt;/tt&gt;.
	 * @see {@link #exclusiveRandom(int)}.
	 */
	public static int inclusiveRandom(int min, int max) {
		if (max &lt; min) {
			max = min + 1;
		}
		return exclusiveRandom((max - min) + 1) + min;
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive &lt;tt&gt;0&lt;/tt&gt;
	 * and inclusive &lt;code&gt;range&lt;/code&gt;.
	 * 
	 * @param range
	 *            The maximum inclusive number.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If {@code max - min + 1} is less than &lt;tt&gt;0&lt;/tt&gt;.
	 * @see {@link #exclusiveRandom(int)}.
	 */
	public static int inclusiveRandom(int range) {
		return inclusiveRandom(0, range);
	}

	public static byte[] readFile(File s) {
		try {
			FileInputStream fis = new FileInputStream(s);
			FileChannel fc = fis.getChannel();
			ByteBuffer buf = ByteBuffer.allocate((int) fc.size());
			fc.read(buf);
			buf.flip();
			fis.close();
			return buf.array();
		} catch (Exception e) {
			System.out.println("FILE : " + s.getName() + " missing.");
			return null;
		}
	}

	public static byte[] getBuffer(File f) throws Exception
	{
		if(!f.exists())
			return null;
		byte[] buffer = new byte[(int) f.length()];
		DataInputStream dis = new DataInputStream(new FileInputStream(f));
		dis.readFully(buffer);
		dis.close();
		byte[] gzipInputBuffer = new byte[999999];
		int bufferlength = 0;
		GZIPInputStream gzip = new GZIPInputStream(new ByteArrayInputStream(buffer));
		do {
			if(bufferlength == gzipInputBuffer.length)
			{
				System.out.println("Error inflating data.\nGZIP buffer overflow.");
				break;
			}
			int readByte = gzip.read(gzipInputBuffer, bufferlength, gzipInputBuffer.length - bufferlength);
			if(readByte == -1)
				break;
			bufferlength += readByte;
		} while(true);
		byte[] inflated = new byte[bufferlength];
		System.arraycopy(gzipInputBuffer, 0, inflated, 0, bufferlength);
		buffer = inflated;
		if(buffer.length &lt; 10)
			return null;
		return buffer;
	}

	public static int getTimeLeft(long start, int timeAmount, TimeUnit timeUnit) {
		start -= timeUnit.toMillis(timeAmount);
		long elapsed = System.currentTimeMillis() - start;
		int toReturn = timeUnit == TimeUnit.SECONDS ? (int) ((elapsed / 1000) % 60) - timeAmount : (int) ((elapsed / 1000) / 60) - timeAmount;
		if(toReturn &lt;= 0)
			toReturn = 1;
		return timeAmount - toReturn;
	}

	/**
	 * Converts an array of bytes to an integer.
	 * 
	 * @param data
	 *            the array of bytes.
	 * @return the newly constructed integer.
	 */
	public static int hexToInt(byte[] data) {
		int value = 0;
		int n = 1000;
		for (int i = 0; i &lt; data.length; i++) {
			int num = (data[i] &amp; 0xFF) * n;
			value += num;
			if (n &gt; 1) {
				n = n / 1000;
			}
		}
		return value;
	}

	public static Position delta(Position a, Position b) {
		return new Position(b.getX() - a.getX(), b.getY() - a.getY());
	}

	/**
	 * Picks a random element out of any array type.
	 * 
	 * @param array
	 *            the array to pick the element from.
	 * @return the element chosen.
	 */
	public static &lt;T&gt; T randomElement(T[] array) {
		return array[(int) (RANDOM.nextDouble() * array.length)];
	}

	/**
	 * Picks a random element out of any list type.
	 * 
	 * @param list
	 *            the list to pick the element from.
	 * @return the element chosen.
	 */
	public static &lt;T&gt; T randomElement(List&lt;T&gt; list) {
		return list.get((int) (RANDOM.nextDouble() * list.size()));
	}

	/**
	 * Reads string from a data input stream.
	 * @param inputStream 	The input stream to read string from.
	 * @return 				The String value.
	 */
	public static String readString(ChannelBuffer buffer) {
		StringBuilder builder = null;
		try {
			byte data;
			builder = new StringBuilder();
			while ((data = buffer.readByte()) != 10) {
				builder.append((char) data);
			}
		} catch(IndexOutOfBoundsException e) {

		}
		return builder.toString();
	}

	private static final String[] BLOCKED_WORDS = new String[]{
		"devious", "firepk", "ventrilica", "ventrili",
		"hade5", "hades5", "pvplegacy", "junglepk", "runeinsanit",
		"n3t", "n e t", "n et", "ne t", "c  0 m", "c 0 m", "C 0  m",
		"c  o  m", "runeinsanity", "runeinsanit", "runeinsan",
		"rune-insanity", "rune-insanit", ".c0", ".c0m",
		"legendsdomain", "createaforum", "vampirez", "-scape",
		"rswebclients", "pvplegacy", "junglepk", ".n3t", ".c0m", "c0m",
		"n3t", ".tk", ",net", ",runescape", "pvpmaster", "pvpmasters",
		"PvPMasters.", ",org", ",com", ",be", ",nl", ",info", "dspk",
		".info", ".org", ".tk", ".net", ".com", ".co.uk", ".be", ".nl",
		".dk", ".co.cz", ".co", ".us", ".biz", ".eu", ".de", ".cc", ". n e  t",
		".i n f o", ".o r g", ".t k", ".n e t", ".c o m", ".c o . u k",
		".b e", ".n l", ".d k", ".c o . c z", ".c o", ".u s", ".b i z",
		".e u", ".d e", ".c c", ".(c)om", "(.)", "kandarin", "o r g", "www", 
		"w w w", "w.w.w", "voidrsps", "void-ps", "desolace", "ikov", "soulsplit", 
		"soulspawn", "atiloc", "&lt;img", "@cr", "i k o v", "ik0v", "&lt;img=", "@cr", ":tradereq:", ":duelreq:",
		"&lt;col=", "&lt;shad=", "hostilityps", "hostilityp", "hostility ps"};


	public static boolean blockedWord(String string) {
		for(String s : BLOCKED_WORDS) {
			if(string.contains(s)) {
				return true;
			}
		}
		return false;
	}
}
</code></pre>
<p>But then i figured, it’s client sided. But i have no idea where i need to look. If it’s of any use this is the ChatPacketListener:</p>
<pre><code class="lang-auto">package com.ruseps.net.packet.impl;

import com.ruseps.model.ChatMessage.Message;
import com.ruseps.model.Flag;
import com.ruseps.net.packet.Packet;
import com.ruseps.net.packet.PacketListener;
import com.ruseps.util.Misc;
import com.ruseps.world.content.PlayerPunishment;
import com.ruseps.world.content.dialogue.DialogueManager;
import com.ruseps.world.entity.impl.player.Player;
import com.ruseps.model.PlayerRights;


/**
 * This packet listener manages the spoken text by a player.
 * 
 * @author relex lawl
 */

public class ChatPacketListener implements PacketListener {

	@Override
	public void handleMessage(Player player, Packet packet) {
		int effects = packet.readUnsignedByteS();
		int color = packet.readUnsignedByteS();
		int size = packet.getSize();
		byte[] text = packet.readReversedBytesA(size);
		if(PlayerPunishment.muted(player.getUsername()) || PlayerPunishment.IPMuted(player.getHostAddress())) {
			player.getPacketSender().sendMessage("You are muted and cannot chat.");
			return;
		}
		/*
		if(Misc.getMinutesPlayed(player) &lt;= 15) {
			player.getPacketSender().sendMessage("You have been online for less then 15 minutes and cannot chat yet.");
			player.getPacketSender().sendMessage("This is to prevent spam/advertising!");
			return;
		}
		*/
		String str = Misc.textUnpack(text, size).toLowerCase().replaceAll(";", ".");
		if(Misc.blockedWord(str)) {
			DialogueManager.sendStatement(player, "A word was blocked in your sentence. Please do not repeat it!");
			return;
		}
		player.getChatMessages().set(new Message(color, effects, text));
		player.getUpdateFlag().flag(Flag.CHAT);
	}

}
</code></pre>
<p>Also found something else in PacketConstants:</p>
<pre><code class="lang-auto">	/**
	 * The size of packets sent from client to the server 
	 * used to decode them.
	 */
	public final static int[] MESSAGE_SIZES = {
		0, 0, 2, 1, -1, -1, 2, 4, 4, 4, //0
		4, -1, -1, -1, 8, 0, 6, 2, 2, 0,  //10
		0, 2, 0, 6, 0, 12, 0, 0, 0, 0, //20
		9, 0, 0, 0, 0, 8, 4, 0, 0, 2,  //30
		2, 6, 0, 6, 0, -1, 0, 0, 0, 1, //40
		0, 0, 0, 12, 0, 0, 0, 8, 8, 0, //50
		-1, 8, 0, 0, 0, 0, 0, 0, 0, 0,  //60
		6, 0, 2, 2, 8, 6, 0, -1, 0, 6, //70
		-1, 0, 0, 0, 0, 1, 4, 6, 0, 0,  //80
		0, 0, 0, 0, 0, 3, 0, 0, -1, 0, //90
		0, 13, 0, -1, 0, 0, 0, 0, 0, 0,//100
		0, 0, 0, 0, 0, 0, 0, 6, 0, 0,  //110
		1, 0, 6, 0, 0, 0, -1, 0, 2, 6, //120
		0, 4, 6, 8, 0, 6, 0, 0, 6, 2,  //130
		0, 0, 0, 0, 0, 6, 0, 0, 0, 0,  //140
		0, 0, 1, 2, 0, 2, 6, 0, 0, 0,  //150
		0, 0, 0, 0, -1, -1, 0, 0, 0, 0,//160
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  //170
		0, 8, 0, 3, 0, 2, 0, 0, 8, 1,  //180
		0, 0, 12, 0, 0, 0, 0, 0, 0, 0, //190
		2, 0, 0, 0, 2, 0, 0, 0, 4, 0,  //200
		4, 0, 0, 0, 7, 8, 0, 0, 10, 0, //210
		0, 0, 3, 2, 0, 0, -1, 0, 6, 1, //220
		1, 0, 0, 0, 6, 0, 6, 8, 1, 0,  //230
		0, 4, 0, 0, 0, 0, -1, 0, -1, 4,//240
		0, 0, 6, 6, 0, 0           //250
	};</code></pre>
<p>If i need to post any other file here let me now.<br>
I’m using Ruse as source.</p>
<p>TL;DR: In what file do i need to look to fix the problem (" gets replaced with E). Or how do i search where i need to look?</p>
<p>Thanks[/quote]</p>
<p>Figure it out yet?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/6</link>
        <pubDate>Thu, 26 Nov 2015 14:47:36 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-6</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@Soulxs Soulxs]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/soulxs">@Soulxs</a> wrote:</p>
          <blockquote>
              <p>Where would i add this? Also i found PacketEncoder.java (server sided). Do i need to place that somewhere i there?<br>
Sorry for my stupid(?) questions, this is too complicated for me to understand haha.</p>
<p>[code=java]<br>
package com.ruseps.net.packet.codec;<br>
import org.jboss.netty.buffer.ChannelBuffer;<br>
import org.jboss.netty.buffer.ChannelBuffers;<br>
import org.jboss.netty.channel.Channel;<br>
import org.jboss.netty.channel.ChannelHandlerContext;<br>
import org.jboss.netty.handler.codec.oneone.OneToOneEncoder;</p>
<p>import com.ruseps.net.packet.Packet;<br>
import com.ruseps.net.packet.Packet.PacketType;<br>
import com.ruseps.net.security.IsaacRandom;</p>
<p>/**</p>
<ul>
<li>
<p>An implementation of netty’s {<a class="mention" href="/u/link">@link</a> OneToOneEncoder} to</p>
</li>
<li>
<p>encode outgoing packets.</p>
</li>
<li>
</li>
<li>
<p><span class="mention">@author</span> relex lawl<br>
*/<br>
public final class PacketEncoder extends OneToOneEncoder {</p>
<p>/**</p>
<ul>
<li>The GamePacketEncoder constructor.</li>
<li>
<a class="mention" href="/u/param">@param</a> encoder	The encoder used for the packets.<br>
*/<br>
public PacketEncoder(IsaacRandom encoder) {<br>
this.encoder = encoder;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>The encoder used for incoming packets.<br>
*/<br>
private final IsaacRandom encoder;</li>
</ul>
<p><a class="mention" href="/u/override">@Override</a><br>
protected Object encode(ChannelHandlerContext context, Channel channel,<br>
Object message) throws Exception {<br>
Packet packet = (Packet) message;<br>
PacketType packetType = packet.getType();<br>
int headerLength = 1;<br>
int packetLength = packet.getSize();<br>
if (packet.getOpcode() == -1) {<br>
return packet.getBuffer();<br>
}<br>
if (packetType == PacketType.BYTE) {<br>
headerLength += 1;<br>
if (packetLength &gt;= 256) {<br>
throw new Exception(“Packet length is too long for a sized packet.”);<br>
}<br>
} else if (packetType == PacketType.SHORT) {<br>
headerLength += 2;<br>
if (packetLength &gt;= 65536) {<br>
throw new Exception(“Packet length is too long for a short packet.”);<br>
}<br>
}<br>
ChannelBuffer buffer = ChannelBuffers.buffer(headerLength + packetLength);<br>
buffer.writeByte((packet.getOpcode() + encoder.nextInt()) &amp; 0xFF);<br>
if (packetType == PacketType.BYTE) {<br>
buffer.writeByte(packetLength);<br>
} else if (packetType == PacketType.SHORT) {<br>
buffer.writeShort(packetLength);<br>
}<br>
buffer.writeBytes(packet.getBuffer());<br>
return buffer;<br>
}</p>
</li>
</ul>
<p>}</p>
<p><code></code></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/5</link>
        <pubDate>Tue, 24 Nov 2015 17:58:48 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-5</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>I think the packet size may be getting read incorrectly…<br>
But I’m not sure.<br>
In my server the int packet size takes the size of the packet and removes 2:</p>
<pre><code class="lang-auto"></code></pre>
<p>But yours could be too, however I don’t know since I don’t know what packet.getSize() returns.</p>
<p>My server also handles reading the packet differently, but again, this could just be due to having different servers.</p>
<p><code>
		c.inStream.readBytes_reverseA(c.getChatText(), c.getChatTextSize(), 0);
		String message = Misc.textUnpack(c.getChatText(), c.packetSize - 2)
				.toLowerCase();</code></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/4</link>
        <pubDate>Mon, 23 Nov 2015 20:55:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-4</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@Soulxs Soulxs]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/soulxs">@Soulxs</a> wrote:</p>
          <blockquote>
              <p>Put them all in, no errors but it doesn’t work either.<br>
I also noticed that everything was the same, except for xlateTable (the order was different, i don’t know if that matters)</p>
<p>So that leaves option C right? Any idea what else could fix this?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/3</link>
        <pubDate>Mon, 23 Nov 2015 18:49:45 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-3</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>This is a rather common problem on servers.<br>
Reasons this can happen:<br>
A) Using the incorrect xlateTable.<br>
B) Unpacking the text incorrectly (Values get read wrong causing it to show as a different symbol)<br>
C) Packet in data is wrong (The server received one value instead of another)</p>
<p>[code=java]</p>
<pre><code>public static char xlateTable[] = { ' ', 'e', 't', 'a', 'o', 'i', 'h', 'n', 's', 'r', 'd', 'l', 'u', 'm', 'w', 'c',
		'y', 'f', 'g', 'p', 'b', 'v', 'k', 'x', 'j', 'q', 'z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
		' ', '!', '?', '.', ',', ':', ';', '(', ')', '-', '&amp;', '*', '\\', '\'', '@', '#', '+', '=', '\243', '$',
		'%', '"', '[', ']' };

private static char decodeBuf[] = new char[4096];

public static String textUnpack(byte packedData[], int size) {
	int idx = 0, highNibble = -1;
	for (int i = 0; i &lt; size * 2; i++) {
		int val = packedData[i / 2] &gt;&gt; (4 - 4 * (i % 2)) &amp; 0xf;
		if (highNibble == -1) {
			if (val &lt; 13)
				decodeBuf[idx++] = xlateTable[val];
			else
				highNibble = val;
		} else {
			decodeBuf[idx++] = xlateTable[((highNibble &lt;&lt; 4) + val) - 195];
			highNibble = -1;
		}
	}

	return new String(decodeBuf, 0, idx);
}[/code]
</code></pre>
<p>Here’s the textUnpack, xlateTable, and decodeBuf from a server that the quotation mark does work on. I hope they’re of use.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/2</link>
        <pubDate>Mon, 23 Nov 2015 16:52:53 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-2</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
      <item>
        <title>317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</title>
        <dc:creator><![CDATA[@Soulxs Soulxs]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/soulxs">@Soulxs</a> wrote:</p>
          <blockquote>
              <p>Hey,</p>
<p>Whenever i type a " in game it shows this:<br>
<a href="http://puu.sh/lvT1j/65b5214876.png" class="onebox" target="_blank" rel="nofollow noopener">http://puu.sh/lvT1j/65b5214876.png</a><br>
<a href="http://puu.sh/lvT2O/12adbecd08.png" class="onebox" target="_blank" rel="nofollow noopener">http://puu.sh/lvT2O/12adbecd08.png</a></p>
<p>So it replaces the " with an E<br>
I’ve looked at this (Misc.java), this is server sided:</p>
<pre><code class="lang-auto">public static char xlateTable[] = { ' ', 'e', 't', 'a', 'o', 'i', 'h', 'n',
		's', 'r', 'd', 'l', 'u', 'm', 'w', 'c', 'y', 'f', 'g', 'p', 'b',
		'v', 'k', 'x', 'j', 'q', 'z', '0', '1', '2', '3', '4', '5', '6',
		'7', '8', '9', ' ', '!', '?', '.', ',', ':', ';', '(', ')', '-',
		'&amp;', '*', '\\', '\'', '@', '#', '+', '=', '\243', '$', '%', '"',
		'[', ']' };
</code></pre>
<p>Entire class:</p>
<pre><code class="lang-auto">package com.ruseps.util;

import java.io.ByteArrayInputStream;
import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.URL;
import java.nio.ByteBuffer;
import java.nio.channels.FileChannel;
import java.text.NumberFormat;
import java.time.ZonedDateTime;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Enumeration;
import java.util.LinkedList;
import java.util.List;
import java.util.Random;
import java.util.concurrent.TimeUnit;
import java.util.zip.GZIPInputStream;

import org.jboss.netty.buffer.ChannelBuffer;

import com.ruseps.model.Item;
import com.ruseps.model.Position;
import com.ruseps.world.content.combat.CombatContainer.CombatHit;
import com.ruseps.world.entity.impl.player.Player;

public class Misc {


	/** Random instance, used to generate pseudo-random primitive types. */
	public static final Random RANDOM = new Random(System.currentTimeMillis());

	private static ZonedDateTime zonedDateTime;
	public static final int HALF_A_DAY_IN_MILLIS = 43200000;

	public static CombatHit[] concat(CombatHit[] a, CombatHit[] b) {
		int aLen = a.length;
		int bLen = b.length;
		CombatHit[] c= new CombatHit[aLen+bLen];
		System.arraycopy(a, 0, c, 0, aLen);
		System.arraycopy(b, 0, c, aLen, bLen);
		return c;
	}

	public static List&lt;Player&gt; getCombinedPlayerList(Player p) {
		List&lt;Player&gt; plrs = new LinkedList&lt;Player&gt;();
		for(Player localPlayer : p.getLocalPlayers()) {
			if(localPlayer != null)
				plrs.add(localPlayer);
		}
		plrs.add(p);
		return plrs;
	}

	public static String getCurrentServerTime() {
		zonedDateTime = ZonedDateTime.now();
		int hour = zonedDateTime.getHour();
		String hourPrefix = hour &lt; 10 ? "0"+hour+"" : ""+hour+"";
		int minute = zonedDateTime.getMinute();
		String minutePrefix = minute &lt; 10 ? "0"+minute+"" : ""+minute+"";
		return ""+hourPrefix+":"+minutePrefix+"";
	}

	public static String getTimePlayed(long totalPlayTime) {
		final int sec = (int) (totalPlayTime / 1000), h = sec / 3600, m = sec / 60 % 60, s = sec % 60;
		return (h &lt; 10 ? "0" + h : h) + ":" + (m &lt; 10 ? "0" + m : m) + ":" + (s &lt; 10 ? "0" + s : s);
	}

	public static int getMinutesPlayed(Player p) {
		long totalPlayTime = p.getTotalPlayTime() + (p.getRecordedLogin().elapsed());
		int sec = (int) (totalPlayTime / 1000), h = sec / 3600, m = sec / 60 % 60;
		for(int i = 0; i &lt; h; i++)
			m+=60;
		return m;
	}

	public static String getHoursPlayed(long totalPlayTime) {
		final int sec = (int) (totalPlayTime / 1000), h = sec / 3600;
		return (h &lt; 10 ? "0" + h : h) + "h";
	}

	public static int getMinutesPassed(long t) {
		int seconds=(int) ((t/1000)%60);
		int minutes=(int) (((t-seconds)/1000)/60);
		return minutes;
	}

	public static Item[] concat(Item[] a, Item[] b) {
		int aLen = a.length;
		int bLen = b.length;
		Item[] c= new Item[aLen+bLen];
		System.arraycopy(a, 0, c, 0, aLen);
		System.arraycopy(b, 0, c, aLen, bLen);
		return c;
	}

	public static Player getCloseRandomPlayer(List&lt;Player&gt; plrs) {
		int index = Misc.getRandom(plrs.size() - 1);
		if(index &gt; 0) 
			return plrs.get(index);
		return null;
	}

	public static byte directionDeltaX[] = new byte[]{ 0, 1, 1, 1, 0,-1,-1,-1 };
	public static byte directionDeltaY[] = new byte[]{ 1, 1, 0,-1,-1,-1, 0, 1 };	
	public static byte xlateDirectionToClient[] = new byte[]{ 1, 2, 4, 7, 6, 5, 3, 0 };

	public static int getRandom(int range) {
		return (int) (java.lang.Math.random() * (range + 1));
	}

	public static int direction(int srcX, int srcY, int x, int y) {
		double dx = (double) x - srcX, dy = (double) y - srcY;
		double angle = Math.atan(dy / dx);
		angle = Math.toDegrees(angle);
		if (Double.isNaN(angle))
			return -1;
		if (Math.signum(dx) &lt; 0)
			angle += 180.0;
		return (int) ((((90 - angle) / 22.5) + 16) % 16);
		/*int changeX = x - srcX; int changeY = y - srcY;
		for (int j = 0; j &lt; directionDeltaX.length; j++) {
			if (changeX == directionDeltaX[j] &amp;&amp;
				changeY == directionDeltaY[j])
				return j;

		}
		return -1;*/
	}

	public static String ucFirst(String str) {
		str = str.toLowerCase();
		if (str.length() &gt; 1) {
			str = str.substring(0, 1).toUpperCase() + str.substring(1);
		} else {
			return str.toUpperCase();
		}
		return str;
	}

	public static String format(int num) {
		return NumberFormat.getInstance().format(num);
	}

	public static String formatText(String s) {
		for (int i = 0; i &lt; s.length(); i++) {
			if (i == 0) {
				s = String.format("%s%s", Character.toUpperCase(s.charAt(0)),
						s.substring(1));
			}
			if (!Character.isLetterOrDigit(s.charAt(i))) {
				if (i + 1 &lt; s.length()) {
					s = String.format("%s%s%s", s.subSequence(0, i + 1),
							Character.toUpperCase(s.charAt(i + 1)),
							s.substring(i + 2));
				}
			}
		}
		return s.replace("_", " ");
	}

	public static String getTotalAmount(int j) {
		if (j &gt;= 10000 &amp;&amp; j &lt; 10000000) {
			return j / 1000 + "K";
		} else if (j &gt;= 10000000 &amp;&amp; j &lt;= 2147483647) {
			return j / 1000000 + "M";
		} else {
			return "" + j + " coins";
		}
	}

	public static String formatPlayerName(String str) {
		String str1 = Misc.ucFirst(str);
		str1.replace("_", " ");
		return str1;
	}

	public static String insertCommasToNumber(String number) {
		return number.length() &lt; 4 ? number : insertCommasToNumber(number
				.substring(0, number.length() - 3))
				+ ","
				+ number.substring(number.length() - 3, number.length());
	}

	private static char decodeBuf[] = new char[4096];

	public static String textUnpack(byte packedData[], int size) {
		int idx = 0, highNibble = -1;
		for (int i = 0; i &lt; size * 2; i++) {
			int val = packedData[i / 2] &gt;&gt; (4 - 4 * (i % 2)) &amp; 0xf;
		if (highNibble == -1) {
			if (val &lt; 13)
				decodeBuf[idx++] = xlateTable[val];
			else
				highNibble = val;
		} else {
			decodeBuf[idx++] = xlateTable[((highNibble &lt;&lt; 4) + val) - 195];
			highNibble = -1;
		}
		}

		return new String(decodeBuf, 0, idx);
	}

	public static char xlateTable[] = { ' ', 'e', 't', 'a', 'o', 'i', 'h', 'n',
		's', 'r', 'd', 'l', 'u', 'm', 'w', 'c', 'y', 'f', 'g', 'p', 'b',
		'v', 'k', 'x', 'j', 'q', 'z', '0', '1', '2', '3', '4', '5', '6',
		'7', '8', '9', ' ', '!', '?', '.', ',', ':', ';', '(', ')', '-',
		'&amp;', '*', '\\', '\'', '@', '#', '+', '=', '\243', '$', '%', '"',
		'[', ']' };

	public static String anOrA(String s) {
		s = s.toLowerCase();
		if(s.equalsIgnoreCase("anchovies") || s.equalsIgnoreCase("soft clay") || s.equalsIgnoreCase("cheese") || s.equalsIgnoreCase("ball of wool") || s.equalsIgnoreCase("spice") || s.equalsIgnoreCase("steel nails") || s.equalsIgnoreCase("snape grass") || s.equalsIgnoreCase("coal"))
			return "some";
		if(s.startsWith("a") || s.startsWith("e") || s.startsWith("i") || s.startsWith("o") || s.startsWith("u")) 
			return "an";
		return "a";
	}

	@SuppressWarnings("rawtypes")
	public static Class[] getClasses(String packageName) throws ClassNotFoundException, IOException {
		ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
		assert classLoader != null;
		String path = packageName.replace('.', '/');
		Enumeration&lt;URL&gt; resources = classLoader.getResources(path);
		List&lt;File&gt; dirs = new ArrayList&lt;File&gt;();
		while (resources.hasMoreElements()) {
			URL resource = resources.nextElement();
			dirs.add(new File(resource.getFile()));
		}
		ArrayList&lt;Class&gt; classes = new ArrayList&lt;Class&gt;();
		for (File directory : dirs) {
			classes.addAll(findClasses(directory, packageName));
		}
		return classes.toArray(new Class[classes.size()]);
	}

	@SuppressWarnings("rawtypes")
	private static List&lt;Class&gt; findClasses(File directory, String packageName) throws ClassNotFoundException {
		List&lt;Class&gt; classes = new ArrayList&lt;Class&gt;();
		if (!directory.exists()) {
			return classes;
		}
		File[] files = directory.listFiles();
		for (File file : files) {
			if (file.isDirectory()) {
				assert !file.getName().contains(".");
				classes.addAll(findClasses(file, packageName + "." + file.getName()));
			} else if (file.getName().endsWith(".class")) {
				classes.add(Class.forName(packageName + '.' + file.getName().substring(0, file.getName().length() - 6)));
			}
		}
		return classes;
	}

	public static int randomMinusOne(int length) {
		return getRandom(length - 1);
	}

	public static String removeSpaces(String s) {
		return s.replace(" ", "");
	}

	public static int getMinutesElapsed(int minute, int hour, int day, int year) {
		Calendar i = Calendar.getInstance();

		if (i.get(1) == year) {
			if (i.get(6) == day) {
				if (hour == i.get(11)) {
					return i.get(12) - minute;
				}
				return (i.get(11) - hour) * 60 + (59 - i.get(12));
			}

			int ela = (i.get(6) - day) * 24 * 60 * 60;
			return ela &gt; 2147483647 ? 2147483647 : ela;
		}

		int ela = getElapsed(day, year) * 24 * 60 * 60;

		return ela &gt; 2147483647 ? 2147483647 : ela;
	}

	public static int getDayOfYear() {
		Calendar c = Calendar.getInstance();
		int year = c.get(Calendar.YEAR);
		int month = c.get(Calendar.MONTH);
		int days = 0;
		int[] daysOfTheMonth = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
		if ((year % 4 == 0) &amp;&amp; (year % 100 != 0) || (year % 400 == 0)) {
			daysOfTheMonth[1] = 29;
		}
		days += c.get(Calendar.DAY_OF_MONTH);
		for (int i = 0; i &lt; daysOfTheMonth.length; i++) {
			if (i &lt; month) {
				days += daysOfTheMonth[i];
			}
		}
		return days;
	}

	public static int getYear() {
		Calendar c = Calendar.getInstance();
		return c.get(Calendar.YEAR);
	}

	public static int getElapsed(int day, int year) {
		if (year &lt; 2013) {
			return 0;
		}

		int elapsed = 0;
		int currentYear = Misc.getYear();
		int currentDay = Misc.getDayOfYear();

		if (currentYear == year) {
			elapsed = currentDay - day;
		} else {
			elapsed = currentDay;

			for (int i = 1; i &lt; 5; i++) {
				if (currentYear - i == year) {
					elapsed += 365 - day;
					break;
				} else {
					elapsed += 365;
				}
			}
		}

		return elapsed;
	}

	public static boolean isWeekend() {
		int day = Calendar.getInstance().get(7);
		return (day == 1) || (day == 6) || (day == 7);
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive
	 * &lt;code&gt;min&lt;/code&gt; and exclusive &lt;code&gt;max&lt;/code&gt;.
	 * 
	 * &lt;br&gt;
	 * &lt;br&gt;
	 * This method is thread-safe. &lt;/br&gt;
	 * 
	 * @param min
	 *            The minimum inclusive number.
	 * @param max
	 *            The maximum exclusive number.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If the specified range is less &lt;tt&gt;0&lt;/tt&gt;
	 */
	public static int exclusiveRandom(int min, int max) {
		if (max &lt;= min) {
			max = min + 1;
		}
		return RANDOM.nextInt((max - min)) + min;
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive &lt;tt&gt;0&lt;/tt&gt;
	 * and exclusive &lt;code&gt;range&lt;/code&gt;.
	 * 
	 * &lt;br&gt;
	 * &lt;br&gt;
	 * This method is thread-safe. &lt;/br&gt;
	 * 
	 * @param range
	 *            The exclusive range.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If the specified range is less &lt;tt&gt;0&lt;/tt&gt;
	 */
	public static int exclusiveRandom(int range) {
		return exclusiveRandom(0, range);
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive
	 * &lt;code&gt;min&lt;/code&gt; and inclusive &lt;code&gt;max&lt;/code&gt;.
	 * 
	 * @param min
	 *            The minimum inclusive number.
	 * @param max
	 *            The maximum inclusive number.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If {@code max - min + 1} is less than &lt;tt&gt;0&lt;/tt&gt;.
	 * @see {@link #exclusiveRandom(int)}.
	 */
	public static int inclusiveRandom(int min, int max) {
		if (max &lt; min) {
			max = min + 1;
		}
		return exclusiveRandom((max - min) + 1) + min;
	}

	/**
	 * Returns a pseudo-random {@code int} value between inclusive &lt;tt&gt;0&lt;/tt&gt;
	 * and inclusive &lt;code&gt;range&lt;/code&gt;.
	 * 
	 * @param range
	 *            The maximum inclusive number.
	 * @return The pseudo-random {@code int}.
	 * @throws IllegalArgumentException
	 *             If {@code max - min + 1} is less than &lt;tt&gt;0&lt;/tt&gt;.
	 * @see {@link #exclusiveRandom(int)}.
	 */
	public static int inclusiveRandom(int range) {
		return inclusiveRandom(0, range);
	}

	public static byte[] readFile(File s) {
		try {
			FileInputStream fis = new FileInputStream(s);
			FileChannel fc = fis.getChannel();
			ByteBuffer buf = ByteBuffer.allocate((int) fc.size());
			fc.read(buf);
			buf.flip();
			fis.close();
			return buf.array();
		} catch (Exception e) {
			System.out.println("FILE : " + s.getName() + " missing.");
			return null;
		}
	}

	public static byte[] getBuffer(File f) throws Exception
	{
		if(!f.exists())
			return null;
		byte[] buffer = new byte[(int) f.length()];
		DataInputStream dis = new DataInputStream(new FileInputStream(f));
		dis.readFully(buffer);
		dis.close();
		byte[] gzipInputBuffer = new byte[999999];
		int bufferlength = 0;
		GZIPInputStream gzip = new GZIPInputStream(new ByteArrayInputStream(buffer));
		do {
			if(bufferlength == gzipInputBuffer.length)
			{
				System.out.println("Error inflating data.\nGZIP buffer overflow.");
				break;
			}
			int readByte = gzip.read(gzipInputBuffer, bufferlength, gzipInputBuffer.length - bufferlength);
			if(readByte == -1)
				break;
			bufferlength += readByte;
		} while(true);
		byte[] inflated = new byte[bufferlength];
		System.arraycopy(gzipInputBuffer, 0, inflated, 0, bufferlength);
		buffer = inflated;
		if(buffer.length &lt; 10)
			return null;
		return buffer;
	}

	public static int getTimeLeft(long start, int timeAmount, TimeUnit timeUnit) {
		start -= timeUnit.toMillis(timeAmount);
		long elapsed = System.currentTimeMillis() - start;
		int toReturn = timeUnit == TimeUnit.SECONDS ? (int) ((elapsed / 1000) % 60) - timeAmount : (int) ((elapsed / 1000) / 60) - timeAmount;
		if(toReturn &lt;= 0)
			toReturn = 1;
		return timeAmount - toReturn;
	}

	/**
	 * Converts an array of bytes to an integer.
	 * 
	 * @param data
	 *            the array of bytes.
	 * @return the newly constructed integer.
	 */
	public static int hexToInt(byte[] data) {
		int value = 0;
		int n = 1000;
		for (int i = 0; i &lt; data.length; i++) {
			int num = (data[i] &amp; 0xFF) * n;
			value += num;
			if (n &gt; 1) {
				n = n / 1000;
			}
		}
		return value;
	}

	public static Position delta(Position a, Position b) {
		return new Position(b.getX() - a.getX(), b.getY() - a.getY());
	}

	/**
	 * Picks a random element out of any array type.
	 * 
	 * @param array
	 *            the array to pick the element from.
	 * @return the element chosen.
	 */
	public static &lt;T&gt; T randomElement(T[] array) {
		return array[(int) (RANDOM.nextDouble() * array.length)];
	}

	/**
	 * Picks a random element out of any list type.
	 * 
	 * @param list
	 *            the list to pick the element from.
	 * @return the element chosen.
	 */
	public static &lt;T&gt; T randomElement(List&lt;T&gt; list) {
		return list.get((int) (RANDOM.nextDouble() * list.size()));
	}

	/**
	 * Reads string from a data input stream.
	 * @param inputStream 	The input stream to read string from.
	 * @return 				The String value.
	 */
	public static String readString(ChannelBuffer buffer) {
		StringBuilder builder = null;
		try {
			byte data;
			builder = new StringBuilder();
			while ((data = buffer.readByte()) != 10) {
				builder.append((char) data);
			}
		} catch(IndexOutOfBoundsException e) {

		}
		return builder.toString();
	}

	private static final String[] BLOCKED_WORDS = new String[]{
		"devious", "firepk", "ventrilica", "ventrili",
		"hade5", "hades5", "pvplegacy", "junglepk", "runeinsanit",
		"n3t", "n e t", "n et", "ne t", "c  0 m", "c 0 m", "C 0  m",
		"c  o  m", "runeinsanity", "runeinsanit", "runeinsan",
		"rune-insanity", "rune-insanit", ".c0", ".c0m",
		"legendsdomain", "createaforum", "vampirez", "-scape",
		"rswebclients", "pvplegacy", "junglepk", ".n3t", ".c0m", "c0m",
		"n3t", ".tk", ",net", ",runescape", "pvpmaster", "pvpmasters",
		"PvPMasters.", ",org", ",com", ",be", ",nl", ",info", "dspk",
		".info", ".org", ".tk", ".net", ".com", ".co.uk", ".be", ".nl",
		".dk", ".co.cz", ".co", ".us", ".biz", ".eu", ".de", ".cc", ". n e  t",
		".i n f o", ".o r g", ".t k", ".n e t", ".c o m", ".c o . u k",
		".b e", ".n l", ".d k", ".c o . c z", ".c o", ".u s", ".b i z",
		".e u", ".d e", ".c c", ".(c)om", "(.)", "kandarin", "o r g", "www", 
		"w w w", "w.w.w", "voidrsps", "void-ps", "desolace", "ikov", "soulsplit", 
		"soulspawn", "atiloc", "&lt;img", "@cr", "i k o v", "ik0v", "&lt;img=", "@cr", ":tradereq:", ":duelreq:",
		"&lt;col=", "&lt;shad=", "hostilityps", "hostilityp", "hostility ps"};


	public static boolean blockedWord(String string) {
		for(String s : BLOCKED_WORDS) {
			if(string.contains(s)) {
				return true;
			}
		}
		return false;
	}
}
</code></pre>
<p>But then i figured, it’s client sided. But i have no idea where i need to look. If it’s of any use this is the ChatPacketListener:</p>
<pre><code class="lang-auto">package com.ruseps.net.packet.impl;

import com.ruseps.model.ChatMessage.Message;
import com.ruseps.model.Flag;
import com.ruseps.net.packet.Packet;
import com.ruseps.net.packet.PacketListener;
import com.ruseps.util.Misc;
import com.ruseps.world.content.PlayerPunishment;
import com.ruseps.world.content.dialogue.DialogueManager;
import com.ruseps.world.entity.impl.player.Player;
import com.ruseps.model.PlayerRights;


/**
 * This packet listener manages the spoken text by a player.
 * 
 * @author relex lawl
 */

public class ChatPacketListener implements PacketListener {

	@Override
	public void handleMessage(Player player, Packet packet) {
		int effects = packet.readUnsignedByteS();
		int color = packet.readUnsignedByteS();
		int size = packet.getSize();
		byte[] text = packet.readReversedBytesA(size);
		if(PlayerPunishment.muted(player.getUsername()) || PlayerPunishment.IPMuted(player.getHostAddress())) {
			player.getPacketSender().sendMessage("You are muted and cannot chat.");
			return;
		}
		/*
		if(Misc.getMinutesPlayed(player) &lt;= 15) {
			player.getPacketSender().sendMessage("You have been online for less then 15 minutes and cannot chat yet.");
			player.getPacketSender().sendMessage("This is to prevent spam/advertising!");
			return;
		}
		*/
		String str = Misc.textUnpack(text, size).toLowerCase().replaceAll(";", ".");
		if(Misc.blockedWord(str)) {
			DialogueManager.sendStatement(player, "A word was blocked in your sentence. Please do not repeat it!");
			return;
		}
		player.getChatMessages().set(new Message(color, effects, text));
		player.getUpdateFlag().flag(Flag.CHAT);
	}

}
</code></pre>
<p>Also found something else in PacketConstants:</p>
<pre><code class="lang-auto">	/**
	 * The size of packets sent from client to the server 
	 * used to decode them.
	 */
	public final static int[] MESSAGE_SIZES = {
		0, 0, 2, 1, -1, -1, 2, 4, 4, 4, //0
		4, -1, -1, -1, 8, 0, 6, 2, 2, 0,  //10
		0, 2, 0, 6, 0, 12, 0, 0, 0, 0, //20
		9, 0, 0, 0, 0, 8, 4, 0, 0, 2,  //30
		2, 6, 0, 6, 0, -1, 0, 0, 0, 1, //40
		0, 0, 0, 12, 0, 0, 0, 8, 8, 0, //50
		-1, 8, 0, 0, 0, 0, 0, 0, 0, 0,  //60
		6, 0, 2, 2, 8, 6, 0, -1, 0, 6, //70
		-1, 0, 0, 0, 0, 1, 4, 6, 0, 0,  //80
		0, 0, 0, 0, 0, 3, 0, 0, -1, 0, //90
		0, 13, 0, -1, 0, 0, 0, 0, 0, 0,//100
		0, 0, 0, 0, 0, 0, 0, 6, 0, 0,  //110
		1, 0, 6, 0, 0, 0, -1, 0, 2, 6, //120
		0, 4, 6, 8, 0, 6, 0, 0, 6, 2,  //130
		0, 0, 0, 0, 0, 6, 0, 0, 0, 0,  //140
		0, 0, 1, 2, 0, 2, 6, 0, 0, 0,  //150
		0, 0, 0, 0, -1, -1, 0, 0, 0, 0,//160
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  //170
		0, 8, 0, 3, 0, 2, 0, 0, 8, 1,  //180
		0, 0, 12, 0, 0, 0, 0, 0, 0, 0, //190
		2, 0, 0, 0, 2, 0, 0, 0, 4, 0,  //200
		4, 0, 0, 0, 7, 8, 0, 0, 10, 0, //210
		0, 0, 3, 2, 0, 0, -1, 0, 6, 1, //220
		1, 0, 0, 0, 6, 0, 6, 8, 1, 0,  //230
		0, 4, 0, 0, 0, 0, -1, 0, -1, 4,//240
		0, 0, 6, 6, 0, 0           //250
	};</code></pre>
<p>If i need to post any other file here let me now.<br>
I’m using Ruse as source.</p>
<p>TL;DR: In what file do i need to look to fix the problem (" gets replaced with E). Or how do i search where i need to look?</p>
<p>Thanks</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922/1</link>
        <pubDate>Mon, 23 Nov 2015 15:44:29 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-553922-1</guid>
        <source url="https://forum.moparisthebest.com/t/317-chat-doesnt-know-the-character/553922.rss">317 - Chat doesn&#39;t &quot;know&quot; the character: &quot;</source>
      </item>
  </channel>
</rss>
