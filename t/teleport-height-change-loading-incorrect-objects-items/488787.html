<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/teleport-height-change-loading-incorrect-objects-items/488787 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 07:50:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Teleport height change loading incorrect objects/items - Runescape - moparisthebest.com</title>
    <meta name="description" content="Hello, I am currently having trouble with my teleporting method and how it preforms actions. When using ladders/stairs, they all use the same teleport method &amp;quot;teleport(x, y, z)&amp;quot;. This works, and there is also a highchang&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="488787.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Teleport height change loading incorrect objects/items&#39;" href="488787.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/teleport-height-change-loading-incorrect-objects-items/488787" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/teleport-height-change-loading-incorrect-objects-items/488787" />
<meta property="og:title" content="Teleport height change loading incorrect objects/items" />
<meta name="twitter:title" content="Teleport height change loading incorrect objects/items" />
<meta property="og:description" content="Hello, I am currently having trouble with my teleporting method and how it preforms actions. When using ladders/stairs, they all use the same teleport method “teleport(x, y, z)”. This works, and there is also a highchange check, so “if(HightChange)” refresh the objects/items on the floor. This part also works. The part that I am having trouble with is the actual object/item loading. I added the refresh method about 5 times in the height change to see what the problem was and the items refresh 5 ..." />
<meta name="twitter:description" content="Hello, I am currently having trouble with my teleporting method and how it preforms actions. When using ladders/stairs, they all use the same teleport method “teleport(x, y, z)”. This works, and there is also a highchange check, so “if(HightChange)” refresh the objects/items on the floor. This part also works. The part that I am having trouble with is the actual object/item loading. I added the refresh method about 5 times in the height change to see what the problem was and the items refresh 5 ..." />
<meta property="article:published_time" content="2013-02-17T16:32:06+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="488787.html">Teleport height change loading incorrect objects/items</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ProTayToe.html'><span itemprop='name'>ProTayToe</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-02-17T16:32:06Z'>
            <time itemprop='dateModified' datetime='2016-08-04T03:22:43Z' class='post-time'>
              August 4, 2016,  3:22am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hello, I am currently having trouble with my teleporting method and how it preforms actions. When using ladders/stairs, they all use the same teleport method “teleport(x, y, z)”. This works, and there is also a highchange check, so “if(HightChange)” refresh the objects/items on the floor. This part also works. The part that I am having trouble with is the actual object/item loading. I added the refresh method about 5 times in the height change to see what the problem was and the items refresh 5 times (“flash”) then the character gets teleported. So basically whats happening is the items are being loaded from the target floor but on the previous floor. Sorry for the VERY bad wording I just woke up (yeah, 4 o’clock on a Sunday…). Here is the teleport method:</p>
<p>[code]	public void teleport(final Position position) {<br>
final int oldHeight = getPosition().getZ();<br>
final boolean stopPacket = stopPlayerPacket();<br>
if (!stopPacket) {<br>
setStopPacket(true);<br>
}<br>
resetAllActions();<br>
movePlayer(position);<br>
getActionSender().sendMapState(0);<br>
getActionSender().removeInterfaces();<br>
final boolean heightChange = position.getZ() != oldHeight;<br>
final Player player = this;<br>
CycleEventHandler.getInstance().addEvent(this, new CycleEvent() {<br>
<a class="mention" href="../../u/override.html">@Override</a><br>
public void execute(CycleEventContainer container) {<br>
if (heightChange) {<br>
player.reloadRegion();<br>
}<br>
if (!stopPacket) {<br>
setStopPacket(false);<br>
}<br>
getMovementHandler().reset();<br>
container.stop();<br>
}<br>
<a class="mention" href="../../u/override.html">@Override</a><br>
public void stop() {<br>
}<br>
}, 1);<br>
}</p>
<pre><code>public void reloadRegion() {
	WalkInterfaces.addWalkableInterfaces(this);
	WalkInterfaces.checkChickenOption(this);
	ObjectHandler.getInstance().loadObjects(this);
	//GlobalObjectHandler.createGlobalObject();
    GroundItemManager.getManager().refreshLandscapeDisplay(this);
	Npc.reloadTransformedNpcs(this);
}[/code]
</code></pre>
<p>So I basically added “reloadRegion();” about 5-10 times and sendMessage at the end just to see what was going on (my way of debugging this situation. And basically what is happening is the character is being teleported to the target floor but is still seeing the floor it was teleporting from, at the same time, the objects/items for the target floor are being loaded to the floor that is teleporting from then the user is teleported to the target floor.</p>
<p>EDIT: P.S. I am using RuneSource, Also when you change floors a load of times, the items visibly “dupe” but only one can be picked up.</p>
<p>Like I said before, sorry for the bad wording.</p>
      </div>

      <meta itemprop='headline' content='Teleport height change loading incorrect objects/items'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/teleport-height-change-loading-incorrect-objects-items/488787 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 05 Aug 2019 07:50:17 GMT -->
</html>
