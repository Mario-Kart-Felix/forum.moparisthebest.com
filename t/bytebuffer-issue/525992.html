<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/bytebuffer-issue/525992 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:07:11 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>ByteBuffer issue - General Programming - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;ve been working on my RuneScape NIO framework again these last few days and have arrived at the point of login decoding, but i&amp;#39;m having a little trouble performing the decryption with NIO. Everything is fine until afte&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="525992.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;ByteBuffer issue&#39;" href="525992.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/bytebuffer-issue/525992" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/bytebuffer-issue/525992" />
<meta property="og:title" content="ByteBuffer issue" />
<meta name="twitter:title" content="ByteBuffer issue" />
<meta property="og:description" content="I&#39;ve been working on my RuneScape NIO framework again these last few days and have arrived at the point of login decoding, but i&#39;m having a little trouble performing the decryption with NIO. Everything is fine until after I write the keys then I can&#39;t seem to read anymore data after this point. It just returns the value of 14 it initially read. I&#39;ve completed this step many times in the past using IO, Netty, and Apache but I cant seem to crack it using NIO. Any ideas? I&#39;ve been researching this ..." />
<meta name="twitter:description" content="I&#39;ve been working on my RuneScape NIO framework again these last few days and have arrived at the point of login decoding, but i&#39;m having a little trouble performing the decryption with NIO. Everything is fine until after I write the keys then I can&#39;t seem to read anymore data after this point. It just returns the value of 14 it initially read. I&#39;ve completed this step many times in the past using IO, Netty, and Apache but I cant seem to crack it using NIO. Any ideas? I&#39;ve been researching this ..." />
<meta property="article:published_time" content="2013-07-24T17:48:40+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="525992.html">ByteBuffer issue</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/iz3_legend.html'><span itemprop='name'>iz3_legend</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-07-24T17:48:40Z'>
            <time itemprop='dateModified' datetime='2016-08-04T09:52:58Z' class='post-time'>
              August 4, 2016,  9:52am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <pre><code>I've been working on my RuneScape NIO framework again these last few days and have arrived at the point of login decoding, but i'm having a little trouble performing the decryption with NIO. Everything is fine until after I write the keys then I can't seem to read anymore data after this point. It just returns the value of 14 it initially read. I've completed this step many times in the past using IO, Netty, and Apache but I cant seem to crack it using NIO. Any ideas? I've been researching this for a good hour now but none of the recommended solutions have brought about any better results.
</code></pre>
<p>Output For Debugging:</p>
<pre><code class="lang-auto">Styx has bound to the address: [ServerSocket[addr=/0.0.0.0,localport=43594]].
Incoming connection accepted from: [Socket[addr=/127.0.0.1,port=53036,localport=43594]].
[java.nio.channels.SocketChannel[connected local=/127.0.0.1:43594 remote=/127.0.0.1:53036]] The Initial byte was successfully read. [14]
[java.nio.channels.SocketChannel[connected local=/127.0.0.1:43594 remote=/127.0.0.1:53036]] The Name Hash/Login Server was successfully read: [5].
[java.nio.channels.SocketChannel[connected local=/127.0.0.1:43594 remote=/127.0.0.1:53036]] The Login Type wasn't successfully read. [14]</code></pre>
<p>Code:</p>
<pre><code class="lang-auto">@Override
    public void decode(Client client) {
	try {
	    client.setReader(new StreamBuffer(ByteBuffer.allocateDirect(126)));
	    client.getChannel().read(client.getReader().getBuffer());
	    client.getReader().flip();
	    if (client.getReader().getBuffer().hasRemaining()) {
		int initialByte = client.getReader().readSignedByte() &amp; 0xFF;
		if (initialByte != 14) {
			client.getChannel().close();
			System.out.println("[" + client.getChannel() + "] The Initial byte wasn't successfully read. [" + initialByte + "]");
			return;
	    	} else if (initialByte == 14){
			System.out.println("[" + client.getChannel() + "] The Initial byte was successfully read. [" + initialByte + "]");
	    	}
	    }
	    if (client.getReader().getBuffer().hasRemaining()) {
		int nameHash = client.getReader().readSignedByte() &amp; 0xFF;
		System.out.println("[" + client.getChannel() + "] The Name Hash/Login Server was successfully read: [" + nameHash + "].");
	    }
	    ByteBuffer keysExchange = ByteBuffer.allocateDirect(18);
	    keysExchange.putLong(1);
	    keysExchange.put((byte) 0);
	    keysExchange.putLong(new SecureRandom().nextLong());
	    client.flushStream(keysExchange);
	    client.getReader().getBuffer().compact();
	    int loginType = client.getReader().readSignedByte() &amp; 0xFF;
	    if (loginType == 16 || loginType == 18) {
		System.out.println("[" + client.getChannel() + "] The Login Type was successfully read: [" + loginType + "].");
	    } else {
		System.out.println("[" + client.getChannel() + "] The Login Type wasn't successfully read. [" + loginType + "]");
		client.getChannel().close();
		return;
	    }
	} catch (Exception exception) {
	    exception.printStackTrace();
	}
    }</code></pre>
      </div>

      <meta itemprop='headline' content='ByteBuffer issue'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Yesteryear.html'><span itemprop='name'>Yesteryear</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-07-24T17:54:25Z'>
            <time itemprop='dateModified' datetime='2016-08-04T09:52:58Z' class='post-time'>
              August 4, 2016,  9:52am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>You don’t read from the channel after you’ve written the keyExchange buffer.</p>
<p>Also</p>
<pre><code class="lang-auto">client.flushStream(keysExchange);</code></pre>
<p>Bad naming. You’re not using streams.</p>
      </div>

      <meta itemprop='headline' content='ByteBuffer issue'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/iz3_legend.html'><span itemprop='name'>iz3_legend</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-07-24T18:01:35Z'>
            <time itemprop='dateModified' datetime='2016-08-04T09:52:58Z' class='post-time'>
              August 4, 2016,  9:52am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Yesteryear, post:2, topic:525992”]You don’t read from the channel after you’ve written the keyExchange buffer.</p>
<p>Also</p>
<pre><code class="lang-auto">client.flushStream(keysExchange);</code></pre>
<p>Bad naming. You’re not using streams.[/quote]</p>
<p>Addressed the issues, and my bad on the naming. Also now there’s not enough remaining data in the buffer to continue the operation. And sorry for the inconvenience im still a novice with the new input output system.</p>
<p>Modified my code a bit but i’m still having the same issue.</p>
<pre><code class="lang-auto">   @Override
    public void decode(Client client) {
	try {
	    ByteBuffer buffer = ByteBuffer.allocateDirect(126);
	    client.getChannel().read(buffer);
	    buffer.flip();
	    int initialByte = buffer.get() &amp; 0xFF;
	    if (initialByte != 14) {
		client.getChannel().close();
		System.out.println("[" + client.getChannel() + "] The Initial byte wasn't successfully read. [" + initialByte + "]");
		return;
	    } else if (initialByte == 14) {
		System.out.println("[" + client.getChannel() + "] The Initial byte was successfully read. [" + initialByte + "]");
	    }
	    int nameHash = buffer.get() &amp; 0xFF;
	    System.out.println("[" + client.getChannel() + "] The Name Hash/Login Server was successfully read: [" + nameHash + "].");
	    ByteBuffer keyExchange = ByteBuffer.allocate(17);
	    keyExchange.putLong(0);
	    keyExchange.put((byte) 0);
	    keyExchange.putLong(new SecureRandom().nextLong());
	    client.getChannel().write(keyExchange);
	    if (buffer.remaining() &lt; 2) {
		buffer.compact();
		return;
	    }
	    int loginType = buffer.get() &amp; 0xFF;
	    System.out.println("" + loginType);
	} catch (Exception exception) {
	    exception.printStackTrace();
	}
    }</code></pre>
      </div>

      <meta itemprop='headline' content='ByteBuffer issue'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/davidi2.html'><span itemprop='name'>davidi2</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-07-24T19:00:01Z'>
            <time itemprop='dateModified' datetime='2016-08-04T09:52:59Z' class='post-time'>
              August 4, 2016,  9:52am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>remove buffer.compact() and tell me if it still returns the same thing (cba to read the whole thing)</p>
      </div>

      <meta itemprop='headline' content='ByteBuffer issue'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/iz3_legend.html'><span itemprop='name'>iz3_legend</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-07-24T19:08:47Z'>
            <time itemprop='dateModified' datetime='2016-08-04T09:53:00Z' class='post-time'>
              August 4, 2016,  9:53am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote quote-modified" data-post="4" data-topic="525992">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../user_avatar/forum.moparisthebest.com/davidi2/40/2579_1.png" class="avatar"> Davidi2:</div>
<blockquote>
<p>remove buffer.compact() and tell me if it still returns the same thing (cba to read the whole thing)[/quote][quote=“Davidi2, post:4, topic:525992”]remove buffer.compact() and tell me if it still returns the same thing (cba to read the whole thing)</p>
</blockquote>
</aside>
<p>Restored to original version. Removed compaction after writing the keys. Now there’s not enough data to read from this point on.</p>
<p>EDIT: Flipped the buffer after reading but now it simply returns the value of 14 again for the login type which should be 16 or 18. Im connecting off the MoparScape client if that could help in any way too.</p>
<pre><code class="lang-auto">   @Override
    public void decode(Client client) {
        try {
            client.setReader(new ChannelBuffer(ByteBuffer.allocateDirect(126)));
            client.getChannel().read(client.getReader().getBuffer());
            client.getReader().flip();
            if (client.getReader().getBuffer().hasRemaining()) {
                int initialByte = client.getReader().readSignedByte() &amp; 0xFF;
                if (initialByte != 14) {
                        client.getChannel().close();
                        System.out.println("[" + client.getChannel() + "] The Initial byte wasn't successfully read. [" + initialByte + "]");
                        return;
                    } else if (initialByte == 14){
                        System.out.println("[" + client.getChannel() + "] The Initial byte was successfully read. [" + initialByte + "]");
                    }
            }
            if (client.getReader().getBuffer().hasRemaining()) {
                int nameHash = client.getReader().readSignedByte() &amp; 0xFF;
                System.out.println("[" + client.getChannel() + "] The Name Hash/Login Server was successfully read: [" + nameHash + "].");
            }
            ByteBuffer keysExchange = ByteBuffer.allocateDirect(17);
            keysExchange.putLong(0);
            keysExchange.put((byte) 0);
            keysExchange.putLong(new SecureRandom().nextLong());
            client.getChannel().write(keysExchange);
            if (client.getReader().getBuffer().hasRemaining()) {
        	int loginType = client.getReader().readSignedByte() &amp; 0xFF;
        	if (loginType == 16 || loginType == 18) {
        	    System.out.println("[" + client.getChannel() + "] The Login Type was successfully read: [" + loginType + "].");
        	} else {
        	    System.out.println("[" + client.getChannel() + "] The Login Type wasn't successfully read. [" + loginType + "]");
        	    client.getChannel().close();
        	    return;
        	}
            }
        } catch (Exception exception) {
            exception.printStackTrace();
        }
    }</code></pre>
      </div>

      <meta itemprop='headline' content='ByteBuffer issue'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/xxxtilllyxxx.html'><span itemprop='name'>xxxtilllyxxx</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-07-24T20:26:01Z'>
            <time itemprop='dateModified' datetime='2016-08-04T09:53:03Z' class='post-time'>
              August 4, 2016,  9:53am
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>You’re supposed to flip the buffer everytime you change from reading to writing.</p>
      </div>

      <meta itemprop='headline' content='ByteBuffer issue'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mod_taharok.html'><span itemprop='name'>mod_taharok</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-07-24T20:34:18Z'>
            <time itemprop='dateModified' datetime='2016-08-04T09:53:03Z' class='post-time'>
              August 4, 2016,  9:53am
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’ll see if I can look over your code more closely later, but one thing I’m noticing is your usage of NIO. NIO wraps around the concept of non-blocking IO, which runs best in an asynchronous situation. I challenge you to question how you understand networking because your current usage of NIO is very similar to the standard, blocking Java IO library. In blocking IO, you need to perform everything synchronously (one after the other), since you have to wait for one thing to happen before you can move on. Despite that, asynchronous programming involves splitting procedures into a series of separate tasks, then executing them based on states changing.</p>
<p>For example, rather than having code that receives data, sends data, and reads data again, you should split that into two separate tasks. The first is the initial state, so you read in the data sent by the client and send a response. The second is based on the first task succeeding, which then reads in the response from the client and handles that appropriately. This is much better design and can lead to better thread time management.</p>
<p>In fact, this might actually be your problem as well. I noticed you are expecting to read data from the client as a response. Unless my memory is seriously mistaken, isn’t the login type sent after the server initializes the client’s ISAAC keys? You can’t just read data from the client after sending something to it. This is <span class="bbcode-b">not</span> blocking IO and it does not work like it.</p>
<p>Hope this helps.</p>
      </div>

      <meta itemprop='headline' content='ByteBuffer issue'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/iz3_legend.html'><span itemprop='name'>iz3_legend</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-07-24T20:41:22Z'>
            <time itemprop='dateModified' datetime='2016-08-04T09:53:03Z' class='post-time'>
              August 4, 2016,  9:53am
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Taharok, post:7, topic:525992”]I’ll see if I can look over your code more closely later, but one thing I’m noticing is your usage of NIO. NIO wraps around the concept of non-blocking IO, which runs best in an asynchronous situation. I challenge you to question how you understand networking because your current usage of NIO is very similar to the standard, blocking Java IO library. In blocking IO, you need to perform everything synchronously (one after the other), since you have to wait for one thing to happen before you can move on. Despite that, asynchronous programming involves splitting procedures into a series of separate tasks, then executing them based on states changing.</p>
<p>For example, rather than having code that receives data, sends data, and reads data again, you should split that into two separate tasks. The first is the initial state, so you read in the data sent by the client and send a response. The second is based on the first task succeeding, which then reads in the response from the client and handles that appropriately. This is much better design and can lead to better thread time management.</p>
<p>In fact, this might actually be your problem as well. I noticed you are expecting to read data from the client as a response. Unless my memory is seriously mistaken, isn’t the login type sent after the server initializes the client’s ISAAC keys? You can’t just read data from the client after sending something to it. This is <span class="bbcode-b">not</span> blocking IO and it does not work like it.</p>
<p>Hope this helps.[/quote]</p>
<p>Thanks for the help, and this is my first time attempting to implement NIO into a RuneScape framework. I’m going to go back through the RuneScape Protocol and look into asynchronous programming. And by state changes do you mean breaking my login procedure down into multiple stages through an enumeration or switch case?</p>
      </div>

      <meta itemprop='headline' content='ByteBuffer issue'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mod_taharok.html'><span itemprop='name'>mod_taharok</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-07-24T20:50:29Z'>
            <time itemprop='dateModified' datetime='2016-08-04T09:53:04Z' class='post-time'>
              August 4, 2016,  9:53am
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“iz3 legend, post:8, topic:525992”][quote author=Taharok link=topic=644736.msg4338050#msg4338050 date=1374698058]<br>
I’ll see if I can look over your code more closely later, but one thing I’m noticing is your usage of NIO. NIO wraps around the concept of non-blocking IO, which runs best in an asynchronous situation. I challenge you to question how you understand networking because your current usage of NIO is very similar to the standard, blocking Java IO library. In blocking IO, you need to perform everything synchronously (one after the other), since you have to wait for one thing to happen before you can move on. Despite that, asynchronous programming involves splitting procedures into a series of separate tasks, then executing them based on states changing.</p>
<p>For example, rather than having code that receives data, sends data, and reads data again, you should split that into two separate tasks. The first is the initial state, so you read in the data sent by the client and send a response. The second is based on the first task succeeding, which then reads in the response from the client and handles that appropriately. This is much better design and can lead to better thread time management.</p>
<p>In fact, this might actually be your problem as well. I noticed you are expecting to read data from the client as a response. Unless my memory is seriously mistaken, isn’t the login type sent after the server initializes the client’s ISAAC keys? You can’t just read data from the client after sending something to it. This is <span class="bbcode-b">not</span> blocking IO and it does not work like it.</p>
<p>Hope this helps.<br>
[/quote]</p>
<p>Thanks for the help, and this is my first time attempting to implement NIO into a RuneScape framework. I’m going to go back through the RuneScape Protocol and look into asynchronous programming. And by state changes do you mean breaking my login procedure down into multiple stages through an enumeration or switch case?[/quote]</p>
<p>You could do it that way, sure. There are many ways to implement a state machine, whichever you prefer is fine, as long as you understand what’s going on and the effectiveness of splitting it up.</p>
      </div>

      <meta itemprop='headline' content='ByteBuffer issue'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/bytebuffer-issue/525992 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:07:11 GMT -->
</html>
