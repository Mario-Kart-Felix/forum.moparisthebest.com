<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/nashorn/554419 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Nashorn - General Programming - moparisthebest.com</title>
    <meta name="description" content="Have been messing around with Nashorn. Is there a more effective way of loading scripts and their contents into some form of memory and then calling specific functions from those scripts? This code works, but it feels li&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="554419.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Nashorn&#39;" href="554419.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/nashorn/554419" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/nashorn/554419" />
<meta property="og:title" content="Nashorn" />
<meta name="twitter:title" content="Nashorn" />
<meta property="og:description" content="Have been messing around with Nashorn. Is there a more effective way of loading scripts and their contents into some form of memory and then calling specific functions from those scripts? This code works, but it feels like a work around.          private final ScriptEngineManager manager = new ScriptEngineManager(); 	 private final ScriptEngine engine = manager.getEngineByName(&quot;nashorn&quot;); private final ConcurrentHashMap&lt;String, String&gt; scripts = new ConcurrentHashMap&lt;String, String&gt;(); 	  The ke..." />
<meta name="twitter:description" content="Have been messing around with Nashorn. Is there a more effective way of loading scripts and their contents into some form of memory and then calling specific functions from those scripts? This code works, but it feels like a work around.          private final ScriptEngineManager manager = new ScriptEngineManager(); 	 private final ScriptEngine engine = manager.getEngineByName(&quot;nashorn&quot;); private final ConcurrentHashMap&lt;String, String&gt; scripts = new ConcurrentHashMap&lt;String, String&gt;(); 	  The ke..." />
<meta property="article:published_time" content="2016-01-16T06:23:57+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="554419.html">Nashorn</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Vix.html'><span itemprop='name'>Vix</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2016-01-16T06:23:57Z'>
            <time itemprop='dateModified' datetime='2016-08-04T17:14:16Z' class='post-time'>
              August 4, 2016,  5:14pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Have been messing around with Nashorn. Is there a more effective way of loading scripts and their contents into some form of memory and then calling specific functions from those scripts? This code works, but it feels like a work around.</p>
<pre><code class="lang-auto">       
private final ScriptEngineManager manager = new ScriptEngineManager();
	
private final ScriptEngine engine = manager.getEngineByName("nashorn");</code></pre>
<p><code>private final ConcurrentHashMap&lt;String, String&gt; scripts = new ConcurrentHashMap&lt;String, String&gt;();
	</code></p>
<p>The key in this map is the name of the script and the value is the contents of the file. Did it this way so when the script is evaluated in the call method<br>
the contents would already be in memory so a stream isn’t opened every time a script’s function is called, figured this might be efficient?</p>
<p><code>public void loadDirectory(String directory) {
		try {
			final File[] files = new File(directory).listFiles();
			for (File file : files) {
				if (file == null) {
					continue;
				}
				scripts.put(file.getName(), new Scanner(file).useDelimiter("\\Z").next());
				logger.info("Loaded script " + file.getPath() + ".");
			}
		} catch (FileNotFoundException exception) {
			exception.printStackTrace();
		}
	}</code></p>
<p><code>public void call(String script, String function, Object... arguments) {
		try {
			engine.eval(scripts.get(script));
			Invocable invocable = (Invocable) engine;
			invocable.invokeFunction(function, arguments);
		} catch (ScriptException | NoSuchMethodException exception) {
			exception.printStackTrace();
		}
	}</code></p>
      </div>

      <meta itemprop='headline' content='Nashorn'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sinisoul.html'><span itemprop='name'>sinisoul</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2016-01-16T23:43:33Z'>
            <time itemprop='dateModified' datetime='2016-08-04T17:14:18Z' class='post-time'>
              August 4, 2016,  5:14pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><a href="https://docs.oracle.com/javase/7/docs/api/javax/script/Compilable.html" class="onebox" target="_blank" rel="nofollow noopener">https://docs.oracle.com/javase/7/docs/api/javax/script/Compilable.html</a><br>
<a href="https://docs.oracle.com/javase/7/docs/api/javax/script/CompiledScript.html" class="onebox" target="_blank" rel="nofollow noopener">https://docs.oracle.com/javase/7/docs/api/javax/script/CompiledScript.html</a></p>
      </div>

      <meta itemprop='headline' content='Nashorn'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Vix.html'><span itemprop='name'>Vix</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2016-01-17T00:17:22Z'>
            <time itemprop='dateModified' datetime='2016-08-04T17:14:19Z' class='post-time'>
              August 4, 2016,  5:14pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“sini, post:2, topic:554419”]<a href="https://docs.oracle.com/javase/7/docs/api/javax/script/Compilable.html" rel="nofollow noopener">https://docs.oracle.com/javase/7/docs/api/javax/script/Compilable.html</a><br>
<a href="https://docs.oracle.com/javase/7/docs/api/javax/script/CompiledScript.html%5B/quote%5D" rel="nofollow noopener">https://docs.oracle.com/javase/7/docs/api/javax/script/CompiledScript.html[/quote]</a></p>
<p>Thanks, don’t know how i missed that :palm:</p>
<p>Edit : Implementation</p>
<p>[code=java5]	/**<br>
* Evaluates a compiled script and then calls a specific function from that script file.<br>
* <a class="mention" href="../../u/param.html">@param</a> script The name of the script.<br>
* <a class="mention" href="../../u/param.html">@param</a> function The name of the function.<br>
* <a class="mention" href="../../u/param.html">@param</a> arguments The potential arguments the function may take.<br>
*/<br>
public void call(String script, String function, Object… arguments) {<br>
try {<br>
final CompiledScript compiledScript = (CompiledScript) engine.get(script);<br>
compiledScript.eval();<br>
final Invocable invocable = (Invocable) compiledScript.getEngine();<br>
invocable.invokeFunction(function, arguments);<br>
} catch (ScriptException | NoSuchMethodException exception) {<br>
exception.printStackTrace();<br>
}<br>
}</p>
<pre><code>/**
 * Loads all of the java-script files within a given directory.
 * @param directory The path to the directory containing the scripts.
 */
public void loadDirectory(String directory) {
	try {
		final File[] files = new File(directory).listFiles();
		for (File file : files) {
			if (file == null) {
				continue;
			}
			final CompiledScript compiledScript = compilable.compile(new FileReader(file.getPath()));
			engine.put(file.getName(), compiledScript);
			logger.info("Compiled script " + file + ".");
		}
		logger.info("Loaded " + files.length + " java-script files.");
	} catch (FileNotFoundException | ScriptException exception) {
		exception.printStackTrace();
	}
}[/code]</code></pre>
      </div>

      <meta itemprop='headline' content='Nashorn'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sinisoul.html'><span itemprop='name'>sinisoul</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2016-01-17T05:48:59Z'>
            <time itemprop='dateModified' datetime='2016-08-04T17:14:19Z' class='post-time'>
              August 4, 2016,  5:14pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>nice</p>
      </div>

      <meta itemprop='headline' content='Nashorn'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/nashorn/554419 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:05:10 GMT -->
</html>
