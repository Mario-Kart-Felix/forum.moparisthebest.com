<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Getting a BufferedImage of the Client</title>
    <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703</link>
    <description>I&#39;ve worn myself out trying to figure this one out. It may be that I&#39;m looking for something that dosen&#39;t exist in java, I don&#39;t know. But I&#39;ed like some more experianced input on this. Basicly what I want is a BufferedImage of the client, regardless of the client being visible, minimized, on another tab, etc. I assumed, at first, that this would require a simple call to the client&#39;s paint method. But, uppon further investigation, I found that all drawing in the client was done through a call to the canvas&#39; getGraphics() method. So, the only way to get the image would be to find where the canvas&#39; graphics drew it to. After searching through various sun.awt and sun.java2d packages and subpackages I came up with this code snippet.
[code]Canvas canvas = (Canvas)thisClient.getComponentAt(1,1);
SurfaceData source = ((SunGraphics2D)canvas.getGraphics()).surfaceData;
BufferedImage image = new BufferedImage(765,503,BufferedImage.TYPE_INT_ARGB);
SurfaceData dest = SurfaceData.getDestSurfaceData(image);
SunGraphics2D sunG = (SunGraphics2D)image.getGraphics();
Blit blit = Blit.getFromCache(source.getSurfaceType(), sunG.imageComp, dest.getSurfaceType());
blit.Blit(source,dest,sunG.composite,sunG.getCompClip(),0,0,0,0,765,503);
return image;[/code]
After that I had a few moments to savor my apparent victory, until I compiled it and realised I had made a very complex screenshot method... However, I was amazed still that I had figured out how to copy the destination of a graphics to an image. This might still work, but it seems it will copy whatever is on top of the client instead of the client itself. Possible somthing with java, as I was under the assumption that a canvas would have a unique graphics.

So, I&#39;m left at the point where I have to ask for help to figure this one out. And i&#39;m thinking of two options. One would be if anyone knows how to get an image of the client as if it was visible, even if its not. The other would be if someone could teach me enough bcel to stuff (and meld) these methods (and field) into the class that extends Canvas in the client. Let me tell you what I know so I don&#39;t make anyone type more then they need to. I can find the class that extends Canvas and get its JavaClass, ClassGen, Methods, Fields, etc. all I need to know is how to put the following methods/field into that class.
[code]public static final java.awt.image.BufferedImage buffer = new BufferedImage(765, 503, 2);

public Graphics getGraphics() {
    return buffer.getGraphics();
}
    
public Graphics oldGraphics() {
    return super.getGraphics();
}

public void paint(Graphics g) {
    g.drawImage(buffer, 0, 0, null);
    //the rest of that classes paint method
}[/code]
Now, I know that after injecting(?) those methods into that class all of the client will be rendered into that BufferedImage, and not onto the canvas. But I think I can do some fancy graphics coupling to render from the buffer to the canvas. Or, at least make a thread that renders to the canvas at some frame rate.

P.S. In the Blit class, in the Blit method, the last 6 ints are basicly sourceX, sourceY, destX, destY, Width, Height as far as I can tell. They should document those classes.</description>
    
    <lastBuildDate>Wed, 06 Dec 2006 08:10:36 +0000</lastBuildDate>
    <category>Community Inside Talk</category>
    <atom:link href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@benland100 benland100]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/benland100">@benland100</a> wrote:</p>
          <blockquote>
              <p>Leave it to me to ask the questions <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=6" title=":wink:" class="emoji" alt=":wink:"><br>
P.S. Overriding the superclass of the class that extends Canvas to your own class is much easier.<br>
Used to be:<br>
ClientCanvas —&gt; java.awt.Canvas<br>
Now:<br>
ClientCanvas —&gt; BufferedCanvas —&gt; java.awt.Canvas<br>
So, in the BufferedCanvas class I just override the getGraphics() method and i’m set.<br>
Thanks pplsuqbawlz <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/20">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/20</link>
        <pubDate>Wed, 06 Dec 2006 08:10:36 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-20</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Taios Taios]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/taios">@Taios</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group quote-modified" data-post="18" data-topic="31703">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/pwnd/40/5_6259e4fa9dfe0dec282fb0955bb1974c.png" class="avatar"> Pwnd:</div>
<blockquote>
<p>Wow, why the hell didn’t anyone suggest that before?</p>
</blockquote>
</aside>
<p>No one ever asked before ;).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/19</link>
        <pubDate>Wed, 06 Dec 2006 01:26:45 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-19</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <p>Wow, why the hell didn’t anyone suggest that before?  It basically creates examples for you, which is exactly what I needed!  D;</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/18</link>
        <pubDate>Wed, 06 Dec 2006 01:05:03 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-18</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Taios Taios]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/taios">@Taios</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="16" data-topic="31703">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/pwnd/40/5_6259e4fa9dfe0dec282fb0955bb1974c.png" class="avatar"> Pwnd:</div>
<blockquote>
<p>Thanks very much, Taios <img src="https://forum.moparisthebest.com/images/emoji/twitter/smiley.png?v=6" title=":smiley:" class="emoji" alt=":smiley:"></p>
</blockquote>
</aside>
<p>np.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/17</link>
        <pubDate>Wed, 06 Dec 2006 00:05:05 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-17</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <p>Thanks very much, Taios <img src="https://forum.moparisthebest.com/images/emoji/twitter/smiley.png?v=6" title=":smiley:" class="emoji" alt=":smiley:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/16</link>
        <pubDate>Tue, 05 Dec 2006 08:00:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-16</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Taios Taios]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/taios">@Taios</a> wrote:</p>
          <blockquote>
              <p>Sure.</p>
<p>A generation of the following HelloWorld class :</p>
<pre><code class="lang-auto">public class HelloWorld {
	public static void main(String[] args) {
		System.out.println("hai dere");
	}
}</code></pre>
<p>This with a BCELifier would generate the following :</p>
<pre><code class="lang-auto">import org.apache.bcel.generic.*;
import org.apache.bcel.classfile.*;
import org.apache.bcel.*;
import java.io.*;

public class HelloWorldCreator implements Constants {
  private InstructionFactory _factory;
  private ConstantPoolGen    _cp;
  private ClassGen           _cg;

  public HelloWorldCreator() {
    _cg = new ClassGen("HelloWorld", "java.lang.Object", "HelloWorld.java", ACC_PUBLIC | ACC_SUPER, new String[] {  });

    _cp = _cg.getConstantPool();
    _factory = new InstructionFactory(_cg, _cp);
  }

  public void create(OutputStream out) throws IOException {
    createMethod_0();
    createMethod_1();
    _cg.getJavaClass().dump(out);
  }

  private void createMethod_0() {
    InstructionList il = new InstructionList();
    MethodGen method = new MethodGen(ACC_PUBLIC, Type.VOID, Type.NO_ARGS, new String[] {  }, "&lt;init&gt;", "HelloWorld", il, _cp);

    InstructionHandle ih_0 = il.append(_factory.createLoad(Type.OBJECT, 0));
    il.append(_factory.createInvoke("java.lang.Object", "&lt;init&gt;", Type.VOID, Type.NO_ARGS, Constants.INVOKESPECIAL));
    InstructionHandle ih_4 = il.append(_factory.createReturn(Type.VOID));
    method.setMaxStack();
    method.setMaxLocals();
    _cg.addMethod(method.getMethod());
    il.dispose();
  }

  private void createMethod_1() {
    InstructionList il = new InstructionList();
    MethodGen method = new MethodGen(ACC_PUBLIC | ACC_STATIC, Type.VOID, new Type[] { new ArrayType(Type.STRING, 1) }, new String[] { "arg0" }, "main", "HelloWorld", il, _cp);

    InstructionHandle ih_0 = il.append(_factory.createFieldAccess("java.lang.System", "out", new ObjectType("java.io.PrintStream"), Constants.GETSTATIC));
    il.append(new PUSH(_cp, "hai dere"));
    il.append(_factory.createInvoke("java.io.PrintStream", "println", Type.VOID, new Type[] { Type.STRING }, Constants.INVOKEVIRTUAL));
    InstructionHandle ih_8 = il.append(_factory.createReturn(Type.VOID));
    method.setMaxStack();
    method.setMaxLocals();
    _cg.addMethod(method.getMethod());
    il.dispose();
  }

  public static void main(String[] args) throws Exception {
    HelloWorldCreator creator = new HelloWorldCreator();
    creator.create(new FileOutputStream("HelloWorld.class"));
  }
}
</code></pre>
<p>You can use the above to quickly create injection methods.</p>
<p>The simple BCELifier that generated this would be :</p>
<pre><code class="lang-auto">import org.apache.bcel.classfile.*;
import org.apache.bcel.util.*;
import java.io.*;
 public class Bcelify {

 	public static void main(String[] args) {

 		try {
 			JavaClass jclass = new ClassParser("HelloWorld.class").parse();
 			BCELifier b = new BCELifier(jclass, new FileOutputStream("HelloWorldCreator.java"));
 			b.start();
 		}
 		catch(Exception e) {
 			System.out.println(e.getMessage());
 		}
 	}
 }</code></pre>
<p>Have a play around with it. :).</p>
<p>Ive uploaded it also quickly with a batch that will, compile all classes, run bcelify, compile the generated bcelify class, delete the original HelloWorld class, run your HelloWorldCreator which generates HelloWorld.class, it will then run that.</p>
<p>Just for the ease : <a href="http://www.rs-resources.com/BCELify.rar" rel="nofollow noopener">http://www.rs-resources.com/BCELify.rar</a></p>
<p>If you need any further help. Please feel free to reply or pm me.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/15</link>
        <pubDate>Mon, 04 Dec 2006 17:30:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-15</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <p>Can you give us an example of this BCELifier? x]</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/14</link>
        <pubDate>Mon, 04 Dec 2006 06:40:05 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-14</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Taios Taios]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/taios">@Taios</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="3" data-topic="31703">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/benland100/40/110_2.png" class="avatar"> benland100:</div>
<blockquote>
<p>EDIT: Do you know of any good examples of bcel in action? I tend to learn better from experiance then working with a tutorial.</p>
</blockquote>
</aside>
<p>I am very much the same. :).</p>
<p>I recommend Bcelifying some things. I dont know if you know what it is, so i apologise for this reply if you do. Bcelifying basically takes a class and converts it to BCEL, which when ran would recreate that class.</p>
<p>Its good to bcelify somethings and take a look at how it is made <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"> using bcel. It would help with injection also.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/13</link>
        <pubDate>Mon, 04 Dec 2006 06:02:05 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-13</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@pplsuqbawlz pplsuqbawlz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pplsuqbawlz">@pplsuqbawlz</a> wrote:</p>
          <blockquote>
              <p>And you might not. Lol Ambiguity! YAY!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/12</link>
        <pubDate>Mon, 04 Dec 2006 04:24:50 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-12</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="8" data-topic="31703">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/benland100/40/110_2.png" class="avatar"> benland100:</div>
<blockquote>
<p>Why does bcel have to be in bytecode? (lol)</p>
</blockquote>
</aside>
<p>You might enjoy <a href="http://www.csg.is.titech.ac.jp/~chiba/javassist/" data-bbcode="true" rel="nofollow noopener">javassist</a> if that bothers you. It’s the backend for some AOP tool, but in the process it’s become the most usable bytecode library I know of. It lacks some of BCEL’s power but if you don’t need all of that it makes up for it by not making you learn bytecode.</p>
<p><code>
public class Test {
    public static void main(String[] args) throws Exception {
        ClassPool cp = ClassPool.getDefault();
        CtClass cc = cp.get("Hello");
        CtMethod m = cc.getDeclaredMethod("say");
        m.insertBefore("{ System.out.println(\"Hello.say():\"); }");
        Class c = cc.toClass();
        Hello h = (Hello)c.newInstance();
        h.say();
    }
}</code></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/11</link>
        <pubDate>Sun, 03 Dec 2006 22:24:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-11</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@semaphore semaphore]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/semaphore">@semaphore</a> wrote:</p>
          <blockquote>
              <p>[quote=“benland100, post:8, topic:31703”]Ok, I think i’m catching on. A few questions:<br>
What is the “method” ?[/quote]</p>
<p> is the static initializer (as psb said). It a java source file it is simply this:</p>
<pre><code class="lang-auto">static {
...
}</code></pre>
<aside class="quote no-group quote-modified" data-post="8" data-topic="31703">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/benland100/40/110_2.png" class="avatar"> benland100:</div>
<blockquote>
<p>How does one set a static variable (a BufferedImage ;)) to an initial value (is that )?</p>
</blockquote>
</aside>
<p>Using BCEL, for a something like what you wanted below… setting a BufferedImage inside that ClassDef class:</p>
<pre><code class="lang-auto">        try {
            ClassParser cp = new ClassParser("ajcc.loader.ClassDef.class");
            JavaClass jc = cp.parse();
            ClassGen cg = new ClassGen(jc);
            Method mth = cg.containsMethod("&lt;clinit&gt;", "()V");
            MethodGen mg = new MethodGen(mth, cg.getClassName(), cg.getConstantPool());
            InstructionList il = mg.getInstructionList();
            InstructionFactory ifactory = new InstructionFactory(cg);
            InstructionList injection = new InstructionList();
            injection.append(ifactory.createNew((ObjectType)Type.getType(BufferedImage.class)));
            injection.append(new DUP());
            injection.append(new PUSH(cg.getConstantPool(), 503));
            injection.append(new PUSH(cg.getConstantPool(), 765));
            injection.append(new ICONST(2));
            injection.append(ifactory.createInvoke("java/awt/image/BufferedImage", "&lt;init&gt;", Type.VOID, new Type[] {Type.INT, Type.INT, Type.INT}, Constants.INVOKESPECIAL));
            injection.append(ifactory.createPutStatic("ajcc/loader/ClassDef", "image", Type.getType(BufferedImage.class)));
            il.insert(il.getStart(), injection); 
            mg.setMaxLocals();
            mg.setMaxStack();
            cg.replaceMethod(mth, mg.getMethod());
            jc = cg.getJavaClass();
        } catch(Exception e) {}</code></pre>
<p>That should get you started. I could go line by line but honestly I cba to do it this morning. Replace the dummy values with real values. The putstatic in particular, along with the classname in classparser.</p>
<aside class="quote no-group quote-modified" data-post="8" data-topic="31703">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/benland100/40/110_2.png" class="avatar"> benland100:</div>
<blockquote>
<p>If i’m going to add code to an existing method (paint(Graphics g) ;)) do I: get the instructionList, remove that method, make a new method, add the new code, add the old code (from the instruction list), add the new method to the classgen?</p>
</blockquote>
</aside>
<p>No. See the example above. Essentially replaceMethod is sufficient if you are injecting code. You <em>CAN</em> remove and then add but… isn’t that effectively the same thing as a replace? <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<aside class="quote no-group" data-post="8" data-topic="31703">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/benland100/40/110_2.png" class="avatar"> benland100:</div>
<blockquote>
<p>Why does bcel have to be in bytecode? (lol)</p>
</blockquote>
</aside>
<p>What? Do you mean why do you have to think in terms of bytecode when using the bytecode objects of BCEL? Um… I have no idea how to answer that. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>[quote=“benland100, post:8, topic:31703”]As I Answer my own questions:<br>
, i believe is the method that sets up the class (staticly?)[/quote]<br>
Yes. It is the static initializer. One per class, and they always have the signature “()V”.</p>
<aside class="quote no-group" data-post="8" data-topic="31703">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/benland100/40/110_2.png" class="avatar"> benland100:</div>
<blockquote>
<p>so, to set a static BufferedImage buffer to new BufferedImage(765,503,BufferedImage.TYPE_INT_ARGB) in the class ajcc.loader.ClassDef I would add some bytecode to the  method. now, how exactly would one represent that in bytecode?</p>
</blockquote>
</aside>
<p>See Above. Keep in mind, it is assuming that there is already a Field created in that ClassDef class.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/10</link>
        <pubDate>Sun, 03 Dec 2006 20:02:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-10</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@pplsuqbawlz pplsuqbawlz]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pplsuqbawlz">@pplsuqbawlz</a> wrote:</p>
          <blockquote>
              <p>This problem is a simple one, I tackled it MONTHS ago. I mean, is it ever so simple. A bytecode editor is a bit drastic for all this requires ;D. Also, you’re still missing some very <span class="bbcode-b">key</span> detection routines for your, uh, plan?</p>
<p>Uh, you should read up on how the JVM draws to the screen, then you should read up on how the client draws to the JVM. It’s tricky, but foolishly simple to the curious eye.<br>
[hr]</p>
<p> is the static initializer method. (im under the impression that there can only be one of these)<br>
 is the initializer for non static class instances. (yes there can be many of these [for sure])</p>
<p>Anyways, if you read your private messages, you should do as they say.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/9</link>
        <pubDate>Sun, 03 Dec 2006 13:39:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-9</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@benland100 benland100]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/benland100">@benland100</a> wrote:</p>
          <blockquote>
              <p>Ok, I think i’m catching on. A few questions:<br>
What is the “method” ?<br>
How does one set a static variable (a BufferedImage ;)) to an initial value (is that )?<br>
If i’m going to add code to an existing method (paint(Graphics g) ;)) do I: get the instructionList, remove that method, make a new method, add the new code, add the old code (from the instruction list), add the new method to the classgen?<br>
Why does bcel have to be in bytecode? (lol)</p>
<p>As I Answer my own questions:<br>
, i believe is the method that sets up the class (staticly?)<br>
so, to set a static BufferedImage buffer to new BufferedImage(765,503,BufferedImage.TYPE_INT_ARGB) in the class ajcc.loader.ClassDef I would add some bytecode to the  method. now, how exactly would one represent that in bytecode?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/8</link>
        <pubDate>Sun, 03 Dec 2006 13:33:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-8</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group quote-modified" data-post="5" data-topic="31703">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/benland100/40/110_2.png" class="avatar"> benland100:</div>
<blockquote>
<p>No offence, but I’m not too keen to register somewhere else <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</blockquote>
</aside>
<p>I’m going to take a second look at that now, Krich.  I remember you posting that a while ago.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/7</link>
        <pubDate>Sun, 03 Dec 2006 12:53:54 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-7</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <p><aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://forum.moparisthebest.com/uploads/default/original/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a.png" class="site-icon" width="32" height="32">
      <a href="https://forum.moparisthebest.com/" target="_blank">moparisthebest.com</a>
  </header>
  <article class="onebox-body">
    <img src="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" class="thumbnail onebox-avatar" width="500" height="500">

<h3><a href="https://forum.moparisthebest.com/" target="_blank">moparisthebest.com</a></h3>

<p>programming, irc, cars</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<br>
using data read from a class to decrypt constants within it and injecting new references while deleting unnecessary content</p>
<p>No use of InstructionFactory though, I’ll see if I can find an example of that.</p>
<p>edit: That thing sounds so much cooler when I describe it in general terms. Pretty hackish actually, don’t take any design tips from it <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/6</link>
        <pubDate>Sun, 03 Dec 2006 12:46:26 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-6</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@benland100 benland100]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/benland100">@benland100</a> wrote:</p>
          <blockquote>
              <p>No offence, but I’m not too keen to register somewhere else <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
EDIT: Well I decided to register and found out that I knew that stuff.<br>
BTW: Your site looks like a “Teach Pwnd Foundation” lolz <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/5</link>
        <pubDate>Sun, 03 Dec 2006 12:37:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-5</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Pwnd Pwnd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pwnd">@Pwnd</a> wrote:</p>
          <blockquote>
              <p><a href="http://pwnds.info/smf/index.php?board=7.0" class="onebox" target="_blank" rel="nofollow noopener">http://pwnds.info/smf/index.php?board=7.0</a></p>
<p>This is all we have on BCEL at the moment <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=6" title=":confused:" class="emoji" alt=":confused:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/4</link>
        <pubDate>Sun, 03 Dec 2006 12:02:47 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-4</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@benland100 benland100]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/benland100">@benland100</a> wrote:</p>
          <blockquote>
              <p>Really what I need is to know how to inject that code into the ClassGen that I have already. The biggest problem is I have no grasp on bytecode at all ;). I have a vague idea about how to preserve the origional paint method and add that code into the old method, but not sure on that. Also not sure on how to initilze that static variable… So I guess I’m leaving you some pretty big blanks :). I guess it would be a good idea to go ahead and try to learn bcel.</p>
<p>And, if you were to ask anyone from sun, the Blit class dosen’t exist, like everthing else that is in the runtime jar that is not documented…</p>
<p>EDIT: Do you know of any good examples of bcel in action? I tend to learn better from experiance then working with a tutorial.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/3</link>
        <pubDate>Sun, 03 Dec 2006 11:04:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-3</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@Krichevskoy Krichevskoy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/krichevskoy">@Krichevskoy</a> wrote:</p>
          <blockquote>
              <p>Shouldn’t be too hard if I understood your BCEL request. Do you want an example or a sort of “I’ll write the code to find the class and you fill in the blanks” kind of deal?</p>
<p>I didn’t even know that the Blit class exists.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/2</link>
        <pubDate>Sun, 03 Dec 2006 10:53:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-2</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
      <item>
        <title>Getting a BufferedImage of the Client</title>
        <dc:creator><![CDATA[@benland100 benland100]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/benland100">@benland100</a> wrote:</p>
          <blockquote>
              <p>I’ve worn myself out trying to figure this one out. It may be that I’m looking for something that dosen’t exist in java, I don’t know. But I’ed like some more experianced input on this. Basicly what I want is a BufferedImage of the client, regardless of the client being visible, minimized, on another tab, etc. I assumed, at first, that this would require a simple call to the client’s paint method. But, uppon further investigation, I found that all drawing in the client was done through a call to the canvas’ getGraphics() method. So, the only way to get the image would be to find where the canvas’ graphics drew it to. After searching through various sun.awt and sun.java2d packages and subpackages I came up with this code snippet.</p>
<p><code>Canvas canvas = (Canvas)thisClient.getComponentAt(1,1);
SurfaceData source = ((SunGraphics2D)canvas.getGraphics()).surfaceData;
BufferedImage image = new BufferedImage(765,503,BufferedImage.TYPE_INT_ARGB);
SurfaceData dest = SurfaceData.getDestSurfaceData(image);
SunGraphics2D sunG = (SunGraphics2D)image.getGraphics();
Blit blit = Blit.getFromCache(source.getSurfaceType(), sunG.imageComp, dest.getSurfaceType());
blit.Blit(source,dest,sunG.composite,sunG.getCompClip(),0,0,0,0,765,503);
return image;</code><br>
After that I had a few moments to savor my apparent victory, until I compiled it and realised I had made a very complex screenshot method… However, I was amazed still that I had figured out how to copy the destination of a graphics to an image. This might still work, but it seems it will copy whatever is on top of the client instead of the client itself. Possible somthing with java, as I was under the assumption that a canvas would have a unique graphics.</p>
<p>So, I’m left at the point where I have to ask for help to figure this one out. And i’m thinking of two options. One would be if anyone knows how to get an image of the client as if it was visible, even if its not. The other would be if someone could teach me enough bcel to stuff (and meld) these methods (and field) into the class that extends Canvas in the client. Let me tell you what I know so I don’t make anyone type more then they need to. I can find the class that extends Canvas and get its JavaClass, ClassGen, Methods, Fields, etc. all I need to know is how to put the following methods/field into that class.</p>
<p>[code]public static final java.awt.image.BufferedImage buffer = new BufferedImage(765, 503, 2);</p>
<p>public Graphics getGraphics() {<br>
return buffer.getGraphics();<br>
}</p>
<p>public Graphics oldGraphics() {<br>
return super.getGraphics();<br>
}</p>
<p>public void paint(Graphics g) {<br>
g.drawImage(buffer, 0, 0, null);<br>
//the rest of that classes paint method<br>
}[/code]<br>
Now, I know that after injecting(?) those methods into that class all of the client will be rendered into that BufferedImage, and not onto the canvas. But I think I can do some fancy graphics coupling to render from the buffer to the canvas. Or, at least make a thread that renders to the canvas at some frame rate.</p>
<p>P.S. In the Blit class, in the Blit method, the last 6 ints are basicly sourceX, sourceY, destX, destY, Width, Height as far as I can tell. They should document those classes.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703/1</link>
        <pubDate>Sun, 03 Dec 2006 10:13:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-31703-1</guid>
        <source url="https://forum.moparisthebest.com/t/getting-a-bufferedimage-of-the-client/31703.rss">Getting a BufferedImage of the Client</source>
      </item>
  </channel>
</rss>
