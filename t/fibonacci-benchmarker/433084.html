<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/fibonacci-benchmarker/433084 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 06:29:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Fibonacci Benchmarker - General Programming - moparisthebest.com</title>
    <meta name="description" content="What: The benchmarks the time needed to evaluate the Fibonacci sequence over a series of implementations.  

Source: [code=java] import java.lang.reflect.InvocationTargetException; import java.lang.reflect.Method; import&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="433084.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Fibonacci Benchmarker&#39;" href="433084.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/fibonacci-benchmarker/433084" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/fibonacci-benchmarker/433084" />
<meta property="og:title" content="Fibonacci Benchmarker" />
<meta name="twitter:title" content="Fibonacci Benchmarker" />
<meta property="og:description" content="What:  The benchmarks the time needed to evaluate the Fibonacci sequence over a series of implementations.  Source:  import java.lang.reflect.InvocationTargetException; import java.lang.reflect.Method; import java.math.BigDecimal; import java.math.BigInteger;  /**  * Fibonacci Benchmarker  * @author t4  */ public class Fib { 	 	/** The positive golden ratio constant */ 	static final BigDecimal postive_golden_ratio = new BigDecimal(1.61803399F);  	/** The negative golden ratio constant */ 	static..." />
<meta name="twitter:description" content="What:  The benchmarks the time needed to evaluate the Fibonacci sequence over a series of implementations.  Source:  import java.lang.reflect.InvocationTargetException; import java.lang.reflect.Method; import java.math.BigDecimal; import java.math.BigInteger;  /**  * Fibonacci Benchmarker  * @author t4  */ public class Fib { 	 	/** The positive golden ratio constant */ 	static final BigDecimal postive_golden_ratio = new BigDecimal(1.61803399F);  	/** The negative golden ratio constant */ 	static..." />
<meta property="article:published_time" content="2012-02-15T22:17:10+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="433084.html">Fibonacci Benchmarker</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-15T22:17:10Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:58:18Z' class='post-time'>
              August 2, 2016,  3:58pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><span class="bbcode-b">What:</span><br>
The benchmarks the time needed to evaluate the Fibonacci sequence over a series of implementations.</p>
<p><span class="bbcode-b">Source:</span></p>
<pre><code class="lang-auto">import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.math.BigDecimal;
import java.math.BigInteger;

/**
 * Fibonacci Benchmarker
 * @author t4
 */
public class Fib {
	
	/** The positive golden ratio constant */
	static final BigDecimal postive_golden_ratio = new BigDecimal(1.61803399F);

	/** The negative golden ratio constant */
	static final BigDecimal negative_golden_ratio = new BigDecimal(0.618033989F);

	/** The constant of 1/sqrt(5) */
	static final BigDecimal one_sqrt_fifth = new BigDecimal(0.447213595F);
	
	/** The constant 1/2 */
	static final BigDecimal one_half = new BigDecimal(0.5F);
	
	/** Constants */
	static final BigInteger ZERO = new BigInteger("0"), 
							ONE = new BigInteger("1");
	
	/**
	 * Standard recursive implementation of fibonacci sequence
	 * @param n
	 * @return
	 */
	private static BigInteger fib_recursive(int n) {
		if(n == 0)
			return ZERO;
		if(n == 1)
			return ONE;
		return fib_recursive(n - 1).add(fib_recursive(n - 2));		
	}
	
	/**
	 * Recursive implementation of fibonacci sequence w/ memoization
	 * @param n
	 * @param table
	 * @return
	 */
	private static BigInteger fib_recursive_memo(int n, BigInteger[] table) {
		if(table == null) {
			table = new BigInteger[n + 1];
			table[0] = ZERO;
			table[1] = ONE;
		}
		if(table[n] != null)
			return table[n];		
		return fib_recursive_memo(n - 1, table).add(fib_recursive_memo(n - 2, table));	
	}
	
	/**
	 * Standard closed-form implementation of fibonacci sequence
	 * @param n
	 * @return
	 */
	private static BigInteger fib_closed_form(int n) {
       		return one_sqrt_fifth.multiply(postive_golden_ratio.pow(n).subtract(negative_golden_ratio.pow(n))).toBigInteger();
	}
	
	/**
	 * Closed-form implementation of fibonacci sequence w/ rounding
	 * @param n
	 * @return
	 */
	private static BigInteger fib_closed_form_est(int n) {
		return (one_sqrt_fifth.multiply(postive_golden_ratio.pow(n)).add(one_half)).toBigInteger();
	}

	/**
	 * Entry point
	 * @param args
	 * @throws InvocationTargetException 
	 * @throws IllegalAccessException 
	 * @throws IllegalArgumentException 
	 */
	public static void main(String[] args) throws IllegalArgumentException, IllegalAccessException, InvocationTargetException {
		final int n = 32;
        Method[] methods = Fib.class.getDeclaredMethods();
    	System.out.println("Method Name\t\t\tResult\t\tTime Taken");
    	for(int i = 0; i &lt; methods.length; ++i) {
        	if(methods[i].getName().equals("main"))
        		continue;        	
        	long start = 0L, end = 0L;
        	
        	Object[] margs;
        	if(methods[i].getName().equals("fib_recursive_memo"))
            	margs = new Object[]{ n, null };
        	else
        		margs = new Object[]{ n };
        	
        	start = System.nanoTime();
        	BigInteger answer = (BigInteger) methods[i].invoke(methods[i], margs);
        	end = System.nanoTime();
        	
        	System.out.println(methods[i].getName() + "(" + n + ")\t\t" + answer + "\t\t" + (end - start) + "ns");
        }
	}

}</code></pre>
<p>No idea why the formatting got mucked up on these forums.</p>
<p><span class="bbcode-b">Results:</span><br>
[tt]<br>
Method Name					Result		Time Taken<br>
fib_recursive(32)		   2178309		196957890ns<br>
fib_recursive_memo(32)	 2178309		121258715ns<br>
fib_closed_form(32)		 2178309		1078813ns<br>
fib_closed_form_est(32)	2178310		1853781ns<br>
[/tt]</p>
      </div>

      <meta itemprop='headline' content='Fibonacci Benchmarker'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/slavemaster.html'><span itemprop='name'>slavemaster</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-16T04:27:14Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:58:40Z' class='post-time'>
              August 2, 2016,  3:58pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Using reflection to invoke the methods will make things unnecessarily slow by adding a level of indirection. I get that you were trying to make the code generic, however when you have things where your code is suddenly more-so coupled with the methods themselves like so:</p>
<p><code>                if(methods[i].getName().equals("fib_recursive_memo"))
                margs = new Object[]{ n, null };
                else
                        margs = new Object[]{ n };</code><br>
… then it becomes rather pointless. On a tangential point, why are you needing to pass the table? Usually whether or not an implementation of an algorithm uses memoization is a hidden detail… the table would be hidden from sight.</p>
      </div>

      <meta itemprop='headline' content='Fibonacci Benchmarker'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-16T04:57:57Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:58:41Z' class='post-time'>
              August 2, 2016,  3:58pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“veer, post:2, topic:433084”]Using reflection to invoke the methods will make things unnecessarily slow by adding a level of indirection. I get that you were trying to make the code generic, however when you have things where your code is suddenly more-so coupled with the methods themselves like so:</p>
<p><code>                if(methods[i].getName().equals("fib_recursive_memo"))
                margs = new Object[]{ n, null };
                else
                        margs = new Object[]{ n };</code><br>
… then it becomes rather pointless. On a tangential point, why are you needing to pass the table? Usually whether or not an implementation of an algorithm uses memoization is a hidden detail… the table would be hidden from sight.[/quote]<br>
I figured as much as per the time added to the operations by using reflection, but the benchmarks still prove their relativity towards one another.</p>
<p>I am passing the table because I wasn’t thinking/wanting to make a field for it - no real reason.</p>
      </div>

      <meta itemprop='headline' content='Fibonacci Benchmarker'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mod_taharok.html'><span itemprop='name'>mod_taharok</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-16T14:15:01Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:58:49Z' class='post-time'>
              August 2, 2016,  3:58pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>You have some logic flaws in your “benchmark.” First of all (I hope I don’t get bashed for this), Java is not a great language to benchmark in. It’s fine to benchmark applications over different languages against one written in Java, but a benchmark purely in Java is not nearly as reliable as one in a lower-level language. Why? There are always Java services running in the background of the VM, such as the garbage collector, that are actually doing things even in a simple application like this. Although that’s not nearly as important, you never seemed to consider the hotspot compiler.</p>
<p>So basically, the hotspot compiler’s most basic condition is to compile a Java method to native code if it’s executed n number of times (I think the default value is around 1000). It will also compile a method if it is taking a long time to execute (which is several milliseconds, surely). As far as more complex behavior goes (such as nested calling like in a recursive situation), I’m not sure. Unless you are, I would consider an approach that ensures all the methods are compiled to native code before testing them against each other. Why would you want to benchmark in interpreted mode, anyway?</p>
<p>veer brings up an excellent point regarding reflection. A significant portion your benchmark time could be wasted from generically invoking the methods. There’s really no reason not to spend an extra 5 minutes writing out the specific code for each method.</p>
<p>And finally, you should consider adding this as a fifth method:</p>
<pre><code class="lang-auto">	private static BigInteger fibonacci(int n) {
		BigInteger nm1 = BigInteger.ONE;
		BigInteger nm2 = BigInteger.ZERO;
		if (n == 0)
			return nm2;
		BigInteger fib = nm1.add(nm2);
		for (int i = 2; i &lt; n; i++) {
			nm2 = nm1;
			nm1 = fib;
			fib = nm1.add(nm2);
		}
		return fib;
	}</code></pre>
<p>It’s simpler than using a table or recursion, and is much faster. Also, it’s worth noting that it’s much slower to load a field (static or dynamic) versus loading a local variable. I’d consider a more local approach to your algorithms, which should shave off a few nanoseconds. The only reason I consider that worth mentioning is because a benchmark should not be slowed down due to the nature of the language. Benchmarks should be consistent across multiple domains, when you aren’t specifically trying to benchmark the processing and management of the language itself.</p>
<p>Just some food for thought.</p>
      </div>

      <meta itemprop='headline' content='Fibonacci Benchmarker'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/T41.html'><span itemprop='name'>T41</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-16T14:54:41Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:58:50Z' class='post-time'>
              August 2, 2016,  3:58pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote quote-modified" data-post="4" data-topic="433084">
<div class="title">
<div class="quote-controls"></div>
 Taharok:</div>
<blockquote>
<p>You have some logic flaws in your “benchmark.” First of all (I hope I don’t get bashed for this), Java is not a great language to benchmark in. It’s fine to benchmark applications over different languages against one written in Java, but a benchmark purely in Java is not nearly as reliable as one in a lower-level language. Why? There are always Java services running in the background of the VM, such as the garbage collector, that are actually doing things even in a simple application like this. Although that’s not nearly as important, you never seemed to consider the hotspot compiler.</p>
</blockquote>
</aside>
<p>I originally wrote this in C++.</p>
<aside class="quote quote-modified" data-post="4" data-topic="433084">
<div class="title">
<div class="quote-controls"></div>
 Taharok:</div>
<blockquote>
<p>veer brings up an excellent point regarding reflection. A significant portion your benchmark time could be wasted from generically invoking the methods. There’s really no reason not to spend an extra 5 minutes writing out the specific code for each method.</p>
</blockquote>
</aside>
<p>Valid point, i wanted more of a comparison (i’d imagine the added time complexity to be about the same across each method). I was lazy.</p>
<p>[quote=“Taharok, post:4, topic:433084”]And finally, you should consider adding this as a fifth method:</p>
<pre><code class="lang-auto">	private static BigInteger fibonacci(int n) {
		BigInteger nm1 = BigInteger.ONE;
		BigInteger nm2 = BigInteger.ZERO;
		if (n == 0)
			return nm2;
		BigInteger fib = nm1.add(nm2);
		for (int i = 2; i &lt; n; i++) {
			nm2 = nm1;
			nm1 = fib;
			fib = nm1.add(nm2);
		}
		return fib;
	}</code></pre>
<p>It’s simpler than using a table or recursion, and is much faster. Also, it’s worth noting that it’s much slower to load a field (static or dynamic) versus loading a local variable. I’d consider a more local approach to your algorithms, which should shave off a few nanoseconds. The only reason I consider that worth mentioning is because a benchmark should not be slowed down due to the nature of the language. Benchmarks should be consistent across multiple domains, when you aren’t specifically trying to benchmark the processing and management of the language itself.</p>
<p>Just some food for thought.[/quote]<br>
Didn’t think of that implementation.</p>
      </div>

      <meta itemprop='headline' content='Fibonacci Benchmarker'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/mod_taharok.html'><span itemprop='name'>mod_taharok</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-02-16T16:56:13Z'>
            <time itemprop='dateModified' datetime='2016-08-02T15:58:54Z' class='post-time'>
              August 2, 2016,  3:58pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>It may be more own inadequacy, but I have noticed that the time complexity when benchmarking different algorithms in Java is not predictable. I’ve benchmarked miniature methods before, and they were about the same speed. However, one was marked faster than the other based on which order they were invoked. Your best bet for a somewhat believable benchmark is to ensure all methods invoked in that class and in subsequent classes are natively compiled before actually benchmarking.</p>
      </div>

      <meta itemprop='headline' content='Fibonacci Benchmarker'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/fibonacci-benchmarker/433084 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 06:29:03 GMT -->
</html>
