<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
    <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886</link>
    <description>[b]There is a compile error for RSCD_v25. This was designed to work on Lefty&#39;s RSCD No Forums source. (Which is superior to RSCD_v25 imho) This can be made to work with RSCD_v25 and Demonik, however, I don&#39;t have the time, nor knowledge to do this for you. Those who can use this, go right ahead. Could also solve by commenting out the logging function.

&lt;blockquote&gt;compile:
    [javac] Compiling 124 source files to Rscd v2
5\build
    [javac] Rscd v25\src\org\rscdaemon\server\net
\ConnectionThrottleFilter.java:76: cannot find symbol
    [javac] symbol  : method log(java.lang.String,java.lang.String)
    [javac] location: class org.rscdaemon.server.util.Logger
    [javac]                                     Logger.log(&quot;DoS.log&quot;, c+&quot; concur
rent failures: `&quot;+addr.getHostAddress()+&quot;`&quot;);
    [javac]                                           ^
    [javac] Note: Some input files use unchecked or unsafe operations.
    [javac] Note: Recompile with -Xlint:unchecked for details.
    [javac] 1 error

BUILD FAILED&lt;/blockquote&gt;

[b]I did not write this. It was originally written by Stork, as Aeros has told me. &quot;Yes, I don&#39;t want that dyslexic skiddy (TX) getting credit for Stork&#39;s work&quot; &quot; Stork wrote it, implemented it to Varekd, I got varekd, gave the script to T_x&quot; Aeros further says that this script &quot;all it does is print the IPs to a log
 no blocking involved&quot;[/b]

What this does is detect IP addresses that connect so quickly and so often to your server in order to crash it and prevent legit players from connecting. This was a huge problem for months. This was previously made for Project-P2P also. This does not block them, it logs them, which is very useful for manual blocking purposes.

Name it ConnectionThrottleFilter.java and save to \src\org\rscdaemon\server\net
[code]package org.rscdaemon.server.net;

import java.net.*;
import java.util.*;
import java.io.*;
import java.util.zip.GZIPOutputStream;

import org.apache.mina.common.*;
import org.rscdaemon.server.util.Logger;

public class ConnectionThrottleFilter extends IoFilterAdapter {
	private long allowedInterval;
	private Map&lt;InetAddress, Long&gt; clients;
	private Map&lt;InetAddress, Integer&gt; counts;
	private Set&lt;InetAddress&gt; connectedAddresses;
	
	/**
	* Constructor that takes in a specified wait time.
	*
	* @param allowedInterval
	* 	The number of milliseconds a client is allowed to wait
	* 	before making another successful connection
	*
	*/
	public ConnectionThrottleFilter(long allowedInterval) {
		this.allowedInterval = allowedInterval;
		clients = Collections.synchronizedMap(new HashMap&lt;InetAddress, Long&gt;());
		counts = Collections.synchronizedMap(new HashMap&lt;InetAddress, Integer&gt;());
		connectedAddresses = new HashSet&lt;InetAddress&gt;();
	}
	
	/**
	* Sets the interval between connections from a client.
	* This value is measured in milliseconds.
	*
	* @param allowedInterval
	* 	The number of milliseconds a client is allowed to wait
	* 	before making another successful connection
	*/
	public void setAllowedInterval(long allowedInterval) {
		this.allowedInterval = allowedInterval;
	}
	
	public void delayClient(IoSession session, int delay) {
		long d = System.currentTimeMillis() - delay;
		clients.put(getAddress(session), d);
	}
	
	private InetAddress getAddress(IoSession io) {
		return ((InetSocketAddress)io.getRemoteAddress()).getAddress();
	}
	
	/**
	* Method responsible for deciding if a connection is OK
	* to continue
	*
	* @param session
	* 	The new session that will be verified
	* @return
	* 	True if the session meets the criteria, otherwise false
	*/
	public boolean isConnectionOk(IoSession session) {
		InetAddress addr = getAddress(session);
		long now = System.currentTimeMillis();
		if (clients.containsKey(addr)) {
			long lastConnTime = clients.get(addr);
			
			if (now - lastConnTime &lt; allowedInterval) {
				int c = 0;
				if(!counts.containsKey(addr))
					counts.put(addr, 0);
				else c = counts.get(addr) + 1;
				System.out.println(counts.get(addr) + 1);
				if(c &gt;= 2) {
					// Write to a file called DoS.log saying we&#39;ve been spammed with failed login attempts
					Logger.log(&quot;DoS.log&quot;, c+&quot; concurrent failures: `&quot;+addr.getHostAddress()+&quot;`&quot;);
					c = 0;
				}
				counts.put(addr, c);
				Logger.error(&quot;[&quot;+addr.getHostAddress()+&quot;] Session dropped (delay=&quot;+(now-lastConnTime)+&quot;ms)&quot;);
				return false;
			} else {
				clients.put(addr, now);
				return true;
			}
		} else {
			clients.put(addr, now);
			return true;
		}
	}
	
	public void closedSession(IoSession io) {
		connectedAddresses.remove(getAddress(io));
	}
	
	public void Banned(IoSession io) {
		connectedAddresses.remove(getAddress(io));
	}
	
	public void acceptedLogin(IoSession io) {
		connectedAddresses.add(getAddress(io));
	}
	
	public boolean isConnected(IoSession io) {
		return connectedAddresses.contains(getAddress(io));
	}
	
	public int[] getSizes() { 
		return new int[] { clients.size(), counts.size(), connectedAddresses.size() }; 
	}
	
	public void connectionOk(IoSession io) {
		counts.remove(getAddress(io));
	}
	
	@Override
	public void sessionCreated(NextFilter nextFilter, IoSession session) throws Exception {
		if (!isConnectionOk(session)) {
			session.close();
			return;
		}
		nextFilter.sessionCreated(session);
	}
}[/code]


Then go to \src\org\rscdaemon\server\packethandler and open PlayerLogin.java

Look at the top for:
[code]import org.rscdaemon.server.model.*;[/code]

Then right below that, insert this:
[code]import org.rscdaemon.server.net.ConnectionThrottleFilter;[/code]


Look for:
[code]private static final World world = World.getWorld();[/code]
(This is right at the top pretty much)

Then, right below that line, declare this:

[code]private static ConnectionThrottleFilter throttleFilter;[/code]


Not too far past that is this:
[code]public void handlePacket(Packet p, IoSession session) throws Exception {[/code]
Right below, yet above where it has &quot;byte loginCode = p.readByte();&quot; insert this:

[code]throttleFilter = new ConnectionThrottleFilter(1);[/code]</description>
    
    <lastBuildDate>Sun, 21 Jun 2009 10:40:06 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@KO9 KO9]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ko9">@KO9</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="7" data-topic="283886">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/xent/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> xEnt:</div>
<blockquote>
<p>I know this because RSCA has that same approach (just not that class), it helped a bit but never stopped it.</p>
</blockquote>
</aside>
<p>We’re actually using a highly modified one that Stork wrote for RSCDv25… Heh. It’s really not that great at blocking attacks and can have a large number of false positives if you set the filter too high</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/20">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/20</link>
        <pubDate>Sun, 21 Jun 2009 10:40:06 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-20</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@darscape darscape]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/darscape">@darscape</a> wrote:</p>
          <blockquote>
              <p>I’m so goth i’m cryin goffic tears of blood n eetin Count Chocula cereal with blood instead of milk! &gt;?3</p>
<p>So, what does Apache have to do with this exactly?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/19</link>
        <pubDate>Fri, 19 Jun 2009 14:01:25 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-19</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@PKERZ PKERZ]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pkerz">@PKERZ</a> wrote:</p>
          <blockquote>
              <p>Kozy, not to be an ass but, you’re contradicting yourself now.</p>
<p>This is the part I am judging:</p>
<blockquote>And Lol at the more knowledge in coding than myself. I have never ONCE stated that I can code, yet multiple ppl try to use that as an insult that I cannot code. Atleast, unlike the other's in here, I attempt to learn, and am doing quite well IMO.</blockquote>
<ol>
<li>Your statement “I have never ONCE stated that I can code” is okay, and that might be true.</li>
<li>However, the continued part of the same sentence containing this part “yet multiple ppl try to use that as an insult that I cannot code.”, is an invalid insult if, and only if you really cannot code.</li>
<li>Now the last and most contradicting part is “Atleast, unlike the other’s in here, I attempt to learn, and am doing quite well IMO.”, where you state that you are learning to code. If you are learning, you can code - even if only just a little (if you do not agree on that, then where does the transition between “knowing little and cannot code” and “knowing much and can code” occur?). So, then, if you can code, then you are opposing your own statement on <span class="hashtag">#2</span>.</li>
</ol>
<p>Don’t take the above too seriously though. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Also, it is very often so, that if someone tries to convince you they are better at something, they lack the ability to show you that they really are. Perhaps they are better at it than the individual they are comparing themselves to, but then I can almost convincingly state that they are not <em>that</em> great. People with great knowledge does not have to prove their knowledge infront of others to be verified. They get it anyway…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/18</link>
        <pubDate>Thu, 18 Jun 2009 07:55:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-18</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@Kozy Kozy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/kozy">@Kozy</a> wrote:</p>
          <blockquote>
              <p>[quote=“pesterd, post:11, topic:283886”]Lol I like it how Kozy ALWAYS has something to say about RS2 people posting in the RSC Section…</p>
<p>Apache Ant is used for Both RSC and RS2 and plus hes aloud to post wherever the hell he wants…<br>
If he claims hes seen it before then so be it. You cant be against the fact that hes from RS2…</p>
<p>Please… Hes most probably more knowledgeable than you are with coding…[/quote]</p>
<p>Lol. I like how you act like a mod. Also, I have a friend who hosts a RS2 server, and there is no Ant involved, so no… you fail mate, don’t even try that. Hm… yes, everyone can post wherever, as long as it’s the correct topic, which he was giving help on. I like how you ALWAYS have to flame my posts. Get a life mate, I mean seriously, between you and pork saying something about every single post of mine, you guys could actually attempt social interaction with a person of the opposite sex.</p>
<p>And Lol at the more knowledge in coding than myself. I have never ONCE stated that I can code, yet multiple ppl try to use that as an insult that I cannot code. Atleast, unlike the other’s in here, I attempt to learn, and am doing quite well IMO.</p>
<p>-Kozy</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/17</link>
        <pubDate>Thu, 18 Jun 2009 04:34:35 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-17</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@froggie froggie]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/froggie">@froggie</a> wrote:</p>
          <blockquote>
              <p>pretty cool <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/16</link>
        <pubDate>Thu, 18 Jun 2009 04:15:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-16</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@pesterd pesterd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pesterd">@pesterd</a> wrote:</p>
          <blockquote>
              <p>hehe <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Ownt ftw <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/15</link>
        <pubDate>Thu, 18 Jun 2009 01:50:23 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-15</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@Owner_Spyder Owner Spyder]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/owner_spyder">@Owner_Spyder</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group quote-modified" data-post="9" data-topic="283886">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/darscape/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> darscape:</div>
<blockquote>
<p>Apache huh. I don’t think I agree with that but if that is what you believe, okay.</p>
</blockquote>
</aside>
<p><a href="http://svn.apache.org/repos/asf/mina/branches/buffer/core/src/main/java/org/apache/mina/filter/firewall/ConnectionThrottleFilter.java" class="onebox" target="_blank" rel="nofollow noopener">http://svn.apache.org/repos/asf/mina/branches/buffer/core/src/main/java/org/apache/mina/filter/firewall/ConnectionThrottleFilter.java</a><br>
Okay pwnt</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/14</link>
        <pubDate>Wed, 17 Jun 2009 21:06:12 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-14</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@pesterd pesterd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pesterd">@pesterd</a> wrote:</p>
          <blockquote>
              <p>Bloke=???</p>
<p>And Im definately more knowledgeable than Kozy</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/13</link>
        <pubDate>Wed, 17 Jun 2009 21:00:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-13</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@rustyx rustyx]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rustyx">@rustyx</a> wrote:</p>
          <blockquote>
              <p>[quote=“pesterd, post:11, topic:283886”]Lol I like it how Kozy ALWAYS has something to say about RS2 people posting in the RSC Section…</p>
<p>Apache Ant is used for Both RSC and RS2 and plus hes aloud to post wherever the hell he wants…<br>
If he claims hes seen it before then so be it. You cant be against the fact that hes from RS2…</p>
<p>Please… Hes most probably more knowledgeable than you are with coding…[/quote]</p>
<p>i love how u think ur a good bloke</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/12</link>
        <pubDate>Wed, 17 Jun 2009 06:00:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-12</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@pesterd pesterd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pesterd">@pesterd</a> wrote:</p>
          <blockquote>
              <p>Lol I like it how Kozy ALWAYS has something to say about RS2 people posting in the RSC Section…</p>
<p>Apache Ant is used for Both RSC and RS2 and plus hes aloud to post wherever the hell he wants…<br>
If he claims hes seen it before then so be it. You cant be against the fact that hes from RS2…</p>
<p>Please… Hes most probably more knowledgeable than you are with coding…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/11</link>
        <pubDate>Wed, 17 Jun 2009 04:43:24 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-11</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@Kozy Kozy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/kozy">@Kozy</a> wrote:</p>
          <blockquote>
              <p>[quote=“Owner Spyder, post:8, topic:283886”][quote author=xEnt link=topic=375185.msg2828232#msg2828232 date=1245194273]</p>
<ol>
<li>
<p>almost everyone here won’t know how to add it, as you need to use these methods from other classes as well.</p>
</li>
<li>
<p>it won’t stop proper ddos attacks, at best it would stop lite gameserver port attacks.</p>
</li>
</ol>
<p>I know this because RSCA has that same approach (just not that class), it helped a bit but never stopped it.<br>
[/quote]Aye but it will help to other ddos attacks what comes of small amount of bots</p>
<p>And marwolf that was not programmed by stork or varaked it is from apache its self… please research[/quote]</p>
<p>“Research” coming from a guy with only 1 post in the RSC Section, all the others in RS2?</p>
<p>-Kozy</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/10</link>
        <pubDate>Wed, 17 Jun 2009 01:49:51 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-10</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@darscape darscape]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/darscape">@darscape</a> wrote:</p>
          <blockquote>
              <p>Apache huh. I don’t think I agree with that but if that is what you believe, okay.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/9</link>
        <pubDate>Wed, 17 Jun 2009 00:28:14 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-9</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@Owner_Spyder Owner Spyder]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/owner_spyder">@Owner_Spyder</a> wrote:</p>
          <blockquote>
              <p>[quote=“xEnt, post:7, topic:283886”]1. almost everyone here won’t know how to add it, as you need to use these methods from other classes as well.</p>
<ol start="2">
<li>it won’t stop proper ddos attacks, at best it would stop lite gameserver port attacks.</li>
</ol>
<p>I know this because RSCA has that same approach (just not that class), it helped a bit but never stopped it.[/quote]Aye but it will help to other ddos attacks what comes of small amount of bots</p>
<p>And marwolf that was not programmed by stork or varaked it is from apache its self… please research</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/8</link>
        <pubDate>Wed, 17 Jun 2009 00:11:57 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-8</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@xEnt xEnt]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/xent">@xEnt</a> wrote:</p>
          <blockquote>
              <ol>
<li>
<p>almost everyone here won’t know how to add it, as you need to use these methods from other classes as well.</p>
</li>
<li>
<p>it won’t stop proper ddos attacks, at best it would stop lite gameserver port attacks.</p>
</li>
</ol>
<p>I know this because RSCA has that same approach (just not that class), it helped a bit but never stopped it.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/7</link>
        <pubDate>Tue, 16 Jun 2009 23:17:53 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-7</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@pesterd pesterd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pesterd">@pesterd</a> wrote:</p>
          <blockquote>
              <p>I thought it said “ConnectionThrottleFilter (Stops many ints against your booleans)”</p>
<p>Ya my bad <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"> Should have had my glasses on <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/6</link>
        <pubDate>Tue, 16 Jun 2009 21:52:54 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-6</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@dear_god1 dear god]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/dear_god1">@dear_god1</a> wrote:</p>
          <blockquote>
              <p>You don’t need to read the code to read the title scrub.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/5</link>
        <pubDate>Tue, 16 Jun 2009 21:49:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-5</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@pesterd pesterd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pesterd">@pesterd</a> wrote:</p>
          <blockquote>
              <p>Haha My bad</p>
<p>Chase… You dont understand… After reading thousands and thousands of lines of code my vision starts getting to me <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>I see Ints and Booleans everywhere I look <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/4</link>
        <pubDate>Tue, 16 Jun 2009 21:45:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-4</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@dear_god1 dear god]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/dear_god1">@dear_god1</a> wrote:</p>
          <blockquote>
              <aside class="quote no-group" data-post="2" data-topic="283886">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/pesterd/40/5_513041d5f7104045db30895d3b90af16.png" class="avatar"> pesterd:</div>
<blockquote>
<p>Wait so this Stops or Doesnt stop the Attacks?</p>
</blockquote>
</aside>
<p>Eli, read the topic name you tard.</p>
<p>Thanks btw</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/3</link>
        <pubDate>Tue, 16 Jun 2009 17:48:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-3</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@pesterd pesterd]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pesterd">@pesterd</a> wrote:</p>
          <blockquote>
              <p>Wait so this Stops or Doesnt stop the Attacks?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/2</link>
        <pubDate>Tue, 16 Jun 2009 17:18:56 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-2</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
      <item>
        <title>ConnectionThrottleFilter (stops many ddos attacks against your servers)</title>
        <dc:creator><![CDATA[@darscape darscape]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/darscape">@darscape</a> wrote:</p>
          <blockquote>
              <p>[b]There is a compile error for RSCD_v25. This was designed to work on Lefty’s RSCD No Forums source. (Which is superior to RSCD_v25 imho) This can be made to work with RSCD_v25 and Demonik, however, I don’t have the time, nor knowledge to do this for you. Those who can use this, go right ahead. Could also solve by commenting out the logging function.</p>
<blockquote>compile:
    [javac] Compiling 124 source files to Rscd v2
5\build
    [javac] Rscd v25\src\org\rscdaemon\server\net
\ConnectionThrottleFilter.java:76: cannot find symbol
    [javac] symbol  : method log(java.lang.String,java.lang.String)
    [javac] location: class org.rscdaemon.server.util.Logger
    [javac]                                     Logger.log("DoS.log", c+" concur
rent failures: `"+addr.getHostAddress()+"`");
    [javac]                                           ^
    [javac] Note: Some input files use unchecked or unsafe operations.
    [javac] Note: Recompile with -Xlint:unchecked for details.
    [javac] 1 error
<p>BUILD FAILED</p>
</blockquote>
<p><span class="bbcode-b">I did not write this. It was originally written by Stork, as Aeros has told me. “Yes, I don’t want that dyslexic skiddy (TX) getting credit for Stork’s work” " Stork wrote it, implemented it to Varekd, I got varekd, gave the script to T_x" Aeros further says that this script “all it does is print the IPs to a log<br>
no blocking involved”</span></p>
<p>What this does is detect IP addresses that connect so quickly and so often to your server in order to crash it and prevent legit players from connecting. This was a huge problem for months. This was previously made for Project-P2P also. This does not block them, it logs them, which is very useful for manual blocking purposes.</p>
<p>Name it ConnectionThrottleFilter.java and save to \src\org\rscdaemon\server\net</p>
<p>[code]package <a href="http://org.rscdaemon.server.net" rel="nofollow noopener">org.rscdaemon.server.net</a>;</p>
<p>import <a href="http://java.net" rel="nofollow noopener">java.net</a>.<em>;<br>
import java.util.</em>;<br>
import <a href="http://java.io" rel="nofollow noopener">java.io</a>.*;<br>
import java.util.zip.GZIPOutputStream;</p>
<p>import org.apache.mina.common.*;<br>
import org.rscdaemon.server.util.Logger;</p>
<p>public class ConnectionThrottleFilter extends IoFilterAdapter {<br>
private long allowedInterval;<br>
private Map&lt;InetAddress, Long&gt; clients;<br>
private Map&lt;InetAddress, Integer&gt; counts;<br>
private Set connectedAddresses;</p>
<pre><code>/**
* Constructor that takes in a specified wait time.
*
* @param allowedInterval
* 	The number of milliseconds a client is allowed to wait
* 	before making another successful connection
*
*/
public ConnectionThrottleFilter(long allowedInterval) {
	this.allowedInterval = allowedInterval;
	clients = Collections.synchronizedMap(new HashMap&lt;InetAddress, Long&gt;());
	counts = Collections.synchronizedMap(new HashMap&lt;InetAddress, Integer&gt;());
	connectedAddresses = new HashSet&lt;InetAddress&gt;();
}

/**
* Sets the interval between connections from a client.
* This value is measured in milliseconds.
*
* @param allowedInterval
* 	The number of milliseconds a client is allowed to wait
* 	before making another successful connection
*/
public void setAllowedInterval(long allowedInterval) {
	this.allowedInterval = allowedInterval;
}

public void delayClient(IoSession session, int delay) {
	long d = System.currentTimeMillis() - delay;
	clients.put(getAddress(session), d);
}

private InetAddress getAddress(IoSession io) {
	return ((InetSocketAddress)io.getRemoteAddress()).getAddress();
}

/**
* Method responsible for deciding if a connection is OK
* to continue
*
* @param session
* 	The new session that will be verified
* @return
* 	True if the session meets the criteria, otherwise false
*/
public boolean isConnectionOk(IoSession session) {
	InetAddress addr = getAddress(session);
	long now = System.currentTimeMillis();
	if (clients.containsKey(addr)) {
		long lastConnTime = clients.get(addr);
		
		if (now - lastConnTime &lt; allowedInterval) {
			int c = 0;
			if(!counts.containsKey(addr))
				counts.put(addr, 0);
			else c = counts.get(addr) + 1;
			System.out.println(counts.get(addr) + 1);
			if(c &gt;= 2) {
				// Write to a file called DoS.log saying we've been spammed with failed login attempts
				Logger.log("DoS.log", c+" concurrent failures: `"+addr.getHostAddress()+"`");
				c = 0;
			}
			counts.put(addr, c);
			Logger.error("["+addr.getHostAddress()+"] Session dropped (delay="+(now-lastConnTime)+"ms)");
			return false;
		} else {
			clients.put(addr, now);
			return true;
		}
	} else {
		clients.put(addr, now);
		return true;
	}
}

public void closedSession(IoSession io) {
	connectedAddresses.remove(getAddress(io));
}

public void Banned(IoSession io) {
	connectedAddresses.remove(getAddress(io));
}

public void acceptedLogin(IoSession io) {
	connectedAddresses.add(getAddress(io));
}

public boolean isConnected(IoSession io) {
	return connectedAddresses.contains(getAddress(io));
}

public int[] getSizes() { 
	return new int[] { clients.size(), counts.size(), connectedAddresses.size() }; 
}

public void connectionOk(IoSession io) {
	counts.remove(getAddress(io));
}

@Override
public void sessionCreated(NextFilter nextFilter, IoSession session) throws Exception {
	if (!isConnectionOk(session)) {
		session.close();
		return;
	}
	nextFilter.sessionCreated(session);
}
</code></pre>
<p>}[/code]</p>
<p>Then go to \src\org\rscdaemon\server\packethandler and open PlayerLogin.java</p>
<p>Look at the top for:</p>
<pre><code class="lang-auto">import org.rscdaemon.server.model.*;</code></pre>
<p>Then right below that, insert this:</p>
<pre><code class="lang-auto">import org.rscdaemon.server.net.ConnectionThrottleFilter;</code></pre>
<p>Look for:</p>
<pre><code class="lang-auto">private static final World world = World.getWorld();</code></pre>
<p>(This is right at the top pretty much)</p>
<p>Then, right below that line, declare this:</p>
<pre><code class="lang-auto">private static ConnectionThrottleFilter throttleFilter;</code></pre>
<p>Not too far past that is this:</p>
<pre><code class="lang-auto">public void handlePacket(Packet p, IoSession session) throws Exception {</code></pre>
<p>Right below, yet above where it has “byte loginCode = p.readByte();” insert this:</p>
<pre><code class="lang-auto">throttleFilter = new ConnectionThrottleFilter(1);</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886/1</link>
        <pubDate>Tue, 16 Jun 2009 15:04:22 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-283886-1</guid>
        <source url="https://forum.moparisthebest.com/t/connectionthrottlefilter-stops-many-ddos-attacks-against-your-servers/283886.rss">ConnectionThrottleFilter (stops many ddos attacks against your servers)</source>
      </item>
  </channel>
</rss>
