<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/718-fairy-ring-base-better-than-the-last/540682 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 05:39:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[718] Fairy Ring Base - Better than the last - Runescape - moparisthebest.com</title>
    <meta name="description" content="[image] 

I wanted a fairy ring system with my own custom locations. You know, so people can get to training areas and stuff. Here&amp;#39;s the base of my Fairy Ring system. This code is mine, besides the buttons. 



Make a ne&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="540682.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[718] Fairy Ring Base - Better than the last&#39;" href="540682.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://puu.sh/5Q2CN.png" />
<meta property="og:image" content="http://puu.sh/5Q2CN.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/718-fairy-ring-base-better-than-the-last/540682" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/718-fairy-ring-base-better-than-the-last/540682" />
<meta property="og:title" content="[718] Fairy Ring Base - Better than the last" />
<meta name="twitter:title" content="[718] Fairy Ring Base - Better than the last" />
<meta property="og:description" content="I wanted a fairy ring system with my own custom locations. You know, so people can get to training areas and stuff. Here’s the base of my Fairy Ring system. This code is mine, besides the buttons.   Make a new file called FairyRing in the package com.rs.game.player.content. In it, add this:  package com.rs.game.player.content;  import com.rs.game.Animation; import com.rs.game.Graphics; import com.rs.game.WorldObject; import com.rs.game.WorldTile; import com.rs.game.player.Equipment; import com..." />
<meta name="twitter:description" content="I wanted a fairy ring system with my own custom locations. You know, so people can get to training areas and stuff. Here’s the base of my Fairy Ring system. This code is mine, besides the buttons.   Make a new file called FairyRing in the package com.rs.game.player.content. In it, add this:  package com.rs.game.player.content;  import com.rs.game.Animation; import com.rs.game.Graphics; import com.rs.game.WorldObject; import com.rs.game.WorldTile; import com.rs.game.player.Equipment; import com..." />
<meta property="article:published_time" content="2014-02-27T00:14:01+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="540682.html">[718] Fairy Ring Base - Better than the last</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/arham_4.html'><span itemprop='name'>arham_4</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-02-27T00:14:01Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:49:49Z' class='post-time'>
              August 4, 2016, 11:49am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><img src="http://puu.sh/5Q2CN.png" alt width="" height=""></p>
<p>I wanted a fairy ring system with my own custom locations. You know, so people can get to training areas and stuff. Here’s the base of my Fairy Ring system. This code is mine, besides the buttons.</p>
<hr>
<p>Make a new file called FairyRing in the package com.rs.game.player.content. In it, add this:</p>
<pre><code class="lang-auto">package com.rs.game.player.content;

import com.rs.game.Animation;
import com.rs.game.Graphics;
import com.rs.game.WorldObject;
import com.rs.game.WorldTile;
import com.rs.game.player.Equipment;
import com.rs.game.player.Player;
import com.rs.game.tasks.WorldTask;
import com.rs.game.tasks.WorldTasksManager;

/**
 * @author Arham Siddiqui
 * @author InflictionRB
 *         The Fairy Ring transportation system.
 */
public class FairyRing {

    /**
     * Handles the single button of the main Fairy Ring interface.
     *
     * @param player      The Player.
     * @param componentId The button (component in 508+ revisions)'s ID.
     */
    public static void handleButton(Player player, int componentId) {
        if (componentId == 23) { //1st Plus
            if (player.getFirstColumn() == 2) {
                player.setFirstColumn(4);
            } else if (player.getFirstColumn() == 3) {
                player.setFirstColumn(3);
            } else if (player.getFirstColumn() &gt;= 4) {
                player.setFirstColumn(1);
            } else {
                player.incrementFirstColumn();
            }
        } else if (componentId == 24) { //1st Subtract
            if (player.getFirstColumn() &lt;= 1) {
                player.setFirstColumn(4);
            } else {
                player.decrementFirstColumn();
            }
        } else if (componentId == 25) { //2nd Plus
            if (player.getSecondColumn() == 2) {
                player.setSecondColumn(4);
            } else if (player.getSecondColumn() == 3) {
                player.setSecondColumn(3);
            } else if (player.getSecondColumn() &gt;= 4) {
                player.setSecondColumn(1);
            } else {
                player.incrementSecondColumn();
            }
        } else if (componentId == 26) { //2nd Subtract
            if (player.getSecondColumn() &lt;= 1) {
                player.setSecondColumn(4);
            } else {
                player.decrementSecondColumn();
            }
        } else if (componentId == 27) { //3rd Plus
            if (player.getThirdColumn() == 2) {
                player.setThirdColumn(4);
            } else if (player.getThirdColumn() == 3) {
                player.setThirdColumn(3);
            } else if (player.getThirdColumn() &gt;= 4) {
                player.setThirdColumn(1);
            } else {
                player.incrementThirdColumn();
            }
        } else if (componentId == 28) { //3rd Subtract
            if (player.getThirdColumn() &lt;= 1) {
                player.setThirdColumn(4);
            } else {
                player.decrementThirdColumn();
            }
        } else if (componentId == 21) { //Confirm
            System.out.println(1);
            teleport(player, false);
        }
    }

    /**
     * Teleports the player to the desired Fairy Ring code's location.
     *
     * @param player The Player teleporting to the entered code.
     * @param main   If the Player is teleporting to the main Fairy Ring.
     */
    private static void teleport(final Player player, boolean main) {
        System.out.println(2);
        if (player.getTemporaryAttributtes().get("TeleBlocked") != null) {
            player.getPackets().sendGameMessage("You cannot use the Fairy ring when teleblocked!");
            return;
        }
        if (main) {
            teleport(player, Combination.MAIN_LOCATION);
            return;
        }
        boolean success = false;
        for (final Combination combination : Combination.values()) {
            if (player.getFirstColumn() == combination.getFirstColumn() &amp;&amp; player.getSecondColumn() == combination.getSecondColumn() &amp;&amp; player.getThirdColumn() == combination.getThirdColumn() &amp;&amp; combination != Combination.MAIN_LOCATION) {
                System.out.println(3);
                success = true;
                teleport(player, combination);
            }
        }
        System.out.println(success ? "true" : "false");
        if (!success) {
            invalidCode(player);
        }
    }

    /**
     * Handles if the code was invalid.
     *
     * @param player The Player entering the invalid code.
     */
    private static void invalidCode(Player player) {
        player.closeInterfaces();
        player.getPackets().sendGameMessage("You've entered an invalid code!");
    }

    /**
     * The teleporting itself.
     *
     * @param player      The Player teleporting.
     * @param combination The combination the Player entered (to get the destination).
     */
    private static void teleport(final Player player, final Combination combination) {
        preTeleportSetup(player);
        player.setNextAnimation(new Animation(3254));
        player.setNextGraphics(new Graphics(2670));
        WorldTasksManager.schedule(new WorldTask() {
            @Override
            public void run() {
                player.setNextWorldTile(combination.getDestination());
            }
        }, 1);
        WorldTasksManager.schedule(new WorldTask() {
            @Override
            public void run() {
                player.setNextGraphics(new Graphics(2671));
                player.setNextAnimation(new Animation(3255));
                postTeleportSetup(player);
            }
        }, 3);
    }

    /**
     * What to do before initializing the teleport itself.
     *
     * @param player The Player initializing the teleport.
     */
    private static void preTeleportSetup(Player player) {
        player.stopAll();
        player.lock(3);
    }

    /**
     * What to do after the teleport has been done.
     *
     * @param player The Player to handle after the teleport has been done.
     */
    private static void postTeleportSetup(Player player) {
        player.lock(3);
        refreshConfigurations(player);
        player.closeInterfaces();
        player.stopAll();
    }

    /**
     * Refreshes the numbers representing the sections of the Fairy Ring code.
     *
     * @param player The Player to refresh the numbers of.
     */
    private static void refreshConfigurations(Player player) {
        player.setFirstColumn(1);
        player.setSecondColumn(1);
        player.setThirdColumn(1);
    }

    /**
     * Handles the Fairy Ring object.
     *
     * @param object The Fairy Ring object.
     * @param player The Player clicking the Fairy Ring object.
     */
    public static void handleObject(WorldObject object, Player player) {
        if (object.getX() == 2412 &amp;&amp; object.getY() == 4434 &amp;&amp; object.getPlane() == 0) {
            if (canOpenInterfaces(player))
                openInterfaces(player);
            return;
        }
        teleport(player, true);
    }

    /**
     * Can the player open the interface (if they don't have a weapon or if they do and its not a dramen or a lunar staff)?
     *
     * @param player The Player to check if they can open the interface for them.
     * @return If the player can open the interface.
     */
    private static boolean canOpenInterfaces(Player player) {
        if (player.getEquipment().getItem(Equipment.SLOT_WEAPON) == null || player.getEquipment().getItem(Equipment.SLOT_WEAPON) != null &amp;&amp; player.getEquipment().getItem(Equipment.SLOT_WEAPON).getId() == 772 || player.getEquipment().getItem(Equipment.SLOT_WEAPON) != null &amp;&amp; player.getEquipment().getItem(Equipment.SLOT_WEAPON).getId() == 9084) {
            player.getPackets().sendGameMessage("You need a dramen or lunar staff to use the Fairy Ring!");
            return false;
        }
        return true;
    }

    /**
     * Opens the interfaces of the main Fairy Ring. Also assigns text to the interface.
     *
     * @param player The Player to open the interfaces for.
     */
    private static void openInterfaces(Player player) {
        player.getInterfaceManager().sendInterface(734);
        player.getInterfaceManager().sendInventoryInterface(735);
        // setTitle(player, ""); // If you'd like to set a custom title for your Fairy Ring transportation system, uncomment this code and put the new name in-between the "".
        setLocations(player, "Test1", "Test2", "Test3", "Test4", "Test5", "Test6", "Test7", "Test8", "Test9", "Test10", "Test11", "Test12", "Test13", "Test14", "Test15", "Test16", "Test17");
    }

    /**
     * Sets the title of the inventory interface. This is optional.
     *
     * @param player The Player to set the title of their inventory interface.
     * @param title  The title of the inventory interface.
     */
    private static void setTitle(Player player, String title) {
        player.getPackets().sendIComponentText(735, 11, title);
    }

    /**
     * Sets the list of codes and locations.
     *
     * @param player    The Player to list the locations to.
     * @param locations The locations to set.
     */
    private static void setLocations(Player player, String... locations) {
        int line = 14;
        int stringIndex = 0;
        while (line != 31) {
            player.getPackets().sendIComponentText(735, line, "                                                   " + locations[stringIndex]);
            stringIndex++;
            line++;
        }
    }

    /**
     * The enumeration of the possible Combinations for the Fairy Ring.
     */
    private enum Combination {
        MAIN_LOCATION(-1, -1, -1, new WorldTile(2412, 4434, 0));
        private int firstColumn;
        private int secondColumn;
        private int thirdColumn;
        private WorldTile destination;

        Combination(int firstColumn, int secondColumn, int thirdColumn, WorldTile destination) {
            this.firstColumn = firstColumn;
            this.secondColumn = secondColumn;
            this.thirdColumn = thirdColumn;
            this.destination = destination;
        }

        public int getFirstColumn() {
            return firstColumn;
        }

        public int getSecondColumn() {
            return secondColumn;
        }

        public int getThirdColumn() {
            return thirdColumn;
        }

        public WorldTile getDestination() {
            return destination;
        }
    }
}</code></pre>
<p>Next, in Player.java, add:</p>
<pre><code class="lang-auto">    private transient int firstColumn = 1, secondColumn = 1, thirdColumn = 1;

    public int getFirstColumn() {
        return this.firstColumn;
    }

    public int getSecondColumn() {
        return this.secondColumn;
    }

    public int getThirdColumn() {
        return this.thirdColumn;
    }

    public void setFirstColumn(int i) {
        this.firstColumn = i;
    }

    public void setSecondColumn(int i) {
        this.secondColumn = i;
    }

    public void setThirdColumn(int i) {
        this.thirdColumn = i;
    }

    public void decrementFirstColumn() { this.firstColumn--; }

    public void decrementSecondColumn() { this.secondColumn--; }

    public void decrementThirdColumn() { this.thirdColumn--; }

    public void incrementFirstColumn() { this.firstColumn++; }

    public void incrementSecondColumn() { this.secondColumn++; }

    public void incrementThirdColumn() { this.thirdColumn++; }
</code></pre>
<p>Now, open ButtonHandler and find:</p>
<pre><code class="lang-auto">		} else if (interfaceId == 34) {// notes interface</code></pre>
<p>Above that, add:</p>
<pre><code class="lang-auto">        } else if (interfaceId == 734) { //Fairy rings
            FairyRing.handleButton(player, componentId);</code></pre>
<p>Lastly, open ObjectHandler and below:</p>
<pre><code class="lang-auto">                        case "ladder":
                            handleLadder(player, object, 1);
                            break;</code></pre>
<p>Add:</p>
<pre><code class="lang-auto">                        case "fairy ring":
                            FairyRing.handleObject(object, player);
                            break;</code></pre>
<p>Finished. :^^<br>
<img src="http://puu.sh/5Q37m.png" alt width="" height=""><br>
[I]Here we go…[/I]</p>
<p>EDIT: Here’s some little things for adding onto this base:</p>
<p>[B]Adding a new code combination[/B]<br>
Heh, funny thing is, I left something out. If you are still reading this far, lucky you.</p>
<p>Go just below the class declaration and add the following:</p>
<pre><code class="lang-auto">    /**
     * The integers representing the letters on the Fairy Ring.
     */
    private static final int A = 1;
    private static final int I = 1;
    private static final int P = 1;
    private static final int D = 2;
    private static final int L = 2;
    private static final int S = 2;
    private static final int C = 3;
    private static final int K = 3;
    private static final int R = 3;
    private static final int B = 4;
    private static final int J = 4;
    private static final int Q = 4;</code></pre>
<p>This will make you making a new code SO much more easier!</p>
<p>So, adding the new combination code. To do so, go into the Combination enum and remove the [I];[/I] in the [I]MAIN_LOCATION[/I] and make it a [I],[/I], then below that, with a enter from the [I]MAIN_LOCATION[/I], make a new entry. You must put 3 integers. The things we declared below the class declaration are what we are going to use. Let’s say, we want a player to go to Lumbridge with AIP, so then I’d put [I]A, I, P[/I], then we’d make one for the location, so we’d do, [I]A, I, P, new WorldTile(3200, 3200, 0)[/I]. Our end result?</p>
<pre><code class="lang-auto">    /**
     * The enumeration of the possible Combinations for the Fairy Ring.
     */
    private enum Combination {
        MAIN_LOCATION(-1, -1, -1, new WorldTile(2412, 4434, 0)),
        LUMBRIDGE(A, I, P, new WorldTile(3200, 3200, 0));</code></pre>
<p>We have just added a new code combination!</p>
<p>[B]Changing the text so it prints out your location.[/B]<br>
Did you notice the dummy text?<br>
<img src="http://puu.sh/5Q45g.png" alt width="" height=""><br>
Yeah… they don’t look pretty.</p>
<p>Scroll down to see the following:</p>
<pre><code class="lang-auto">        setLocations(player, "Test1", "Test2", "Test3", "Test4", "Test5", "Test6", "Test7", "Test8", "Test9", "Test10", "Test11", "Test12", "Test13", "Test14", "Test15", "Test16", "Test17");</code></pre>
<p>Currently, a bug I am trying to fix is that the tests are not really organized in the travel log. For now, you’ll need to actually use your head for making it visible. Good luck with that!</p>
<p>Anywho, all you need to do is replace the Test# with your text.</p>
<p>For example, I made lumbridge AIP, so now I want to make it say that in the description. All I need to do is replace Test1 with my text. I’m going to say, [I]Misthalin: Lumbridge[/I]. So now, it looks like this:</p>
<pre><code class="lang-auto">        setLocations(player, "Misthalin: Lumbridge", "Test2", "Test3", "Test4", "Test5", "Test6", "Test7", "Test8", "Test9", "Test10", "Test11", "Test12", "Test13", "Test14", "Test15", "Test16", "Test17");</code></pre>
<p><img src="http://puu.sh/5Q4om.png" alt width="" height=""></p>
<p>[B]Setting a custom title[/B]<br>
For setting a custom title, I commented some code in the openInterfaces method.</p>
<pre><code class="lang-auto">// setTitle(player, ""); // If you'd like to set a custom title for your Fairy Ring transportation system, uncomment this code and put the new name in-between the "".</code></pre>
<p>The instructions are there for you. <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
<p>For example, I want to make the title now, “Ham’s Transportation”. All I’d do is replace whats inside, so the ending is this:</p>
<pre><code class="lang-auto">setTitle(player, "Ham's Transportation");</code></pre>
<p><img src="http://puu.sh/5Q4Cv.png" alt width="" height=""></p>
<p>[COLOR=RED][B]Bug fix <span class="hashtag">#1</span>[/B][/COLOR]</p>
<p>The system was reading the integers as 0, where they should be read as 1 at start. Simple fix. All you need to do is add this to [I]openInterfaces[/I]:</p>
<pre><code class="lang-auto">        refreshConfigurations(player);</code></pre>
      </div>

      <meta itemprop='headline' content='[718] Fairy Ring Base - Better than the last'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/718-fairy-ring-base-better-than-the-last/540682 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 05:39:54 GMT -->
</html>
