<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[bytecode] Control or Redirect ALL File and Network Access</title>
    <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379</link>
    <description>I am trying to brainstorm a good way to do this.  The goal is to have an application that forces another application to run in a sandbox or chroot of sorts without the other application knowing about it.  Giving me the opportunity to accept, deny, or change all requests to access the network or filesystem on the computer the program is running on.  I think what I am going to do is something like this:

Load the jar with a bytecode library, like BCEL or ASM (suggestions/examples welcome), replace all instances of &quot;new File(...)&quot; with &quot;new org.mypackage.MyFile(...)&quot; which is a custom class I would write which would extend Java&#39;s File, therefore providing the same API, but would let me redirect a request for the file &#39;C:/Users/firefoxs_password_database&#39;  to perhaps something like &#39;C:/mychrootdirectory/Users/firefoxs_password_database&#39;.  I could also fix-up windows-specific paths (like C:\ or anything using \) to work on non-windows systems.

The issue is I would need to do this for every single class in the Java Standard Library that can access a file, as well as those that can access the network.  The ones that I know of are:

File
RandomAccessFile
FileInputStream

URL
URLConnection
Socket
ServerSocket
DatagramPacket
DatagramSocket
MulticastSocket

Do you know of any others?  Or do you have another solution all together?  Another option I&#39;m sure some of you will mention is using -Xbootclasspath to over-ride default classes, and that might be nicer, but it can&#39;t be done with an applet can it (without modifying the user&#39;s system beforehand)?</description>
    
    <lastBuildDate>Mon, 09 Apr 2012 23:03:15 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@SpeedIsMeh SpeedIsMeh]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/speedismeh">@SpeedIsMeh</a> wrote:</p>
          <blockquote>
              <p>Use bcel and you can just change the classrefs in the constant pool to your own classes, maybe you might need to change the methodrefs too although I’m not too sure about that part</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/49">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/49</link>
        <pubDate>Mon, 09 Apr 2012 23:03:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-49</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>[quote=“Nueb35, post:47, topic:413379”][quote author=Moparisthebest link=topic=514882.msg3957574#msg3957574 date=1332908291]</p>
<aside class="quote">
<blockquote>
<p>then you probably shouldnt be changing the signature of method calls to those classes</p>
</blockquote>
</aside>
<p>I’m only renaming classes, not changing anything else.</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>Ok, unfortunately a new class with the same signature as java.net.URL does not work with methods expecting java.net.URL:</p>
</blockquote>
</aside>
<p>Can you XBoot instead?</p>
</blockquote>
</aside>
<p>Not with an applet, no.<br>
[/quote]</p>
<p>Since you are changing the types within the classes you load, can you not also change the method calls? for example</p>
<pre><code class="lang-auto">...
        java.net.URL url = new java.net.URL("http://www.moparisthebest.com/ip.php");
        Test.dourl(url);
...</code></pre>
<p>Would be changed to</p>
<p><code>
...
        org.moparscape.sandbox.java.net.URL url = new org.moparscape.sandbox.java.net.URL("http://www.moparisthebest.com/ip.php");
        Test.dourl(url.toURL()); //returns the correct sandboxed URL object
...
</code>[/quote]</p>
<p>Not a bad idea, certainly more complicated, but it should work.  Thanks.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/48">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/48</link>
        <pubDate>Wed, 28 Mar 2012 14:38:26 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-48</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@nueb35 Nueb35]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nueb35">@nueb35</a> wrote:</p>
          <blockquote>
              <p>[quote=“Moparisthebest, post:46, topic:413379”][quote author=frank_ link=topic=514882.msg3956740#msg3956740 date=1332819519]<br>
then you probably shouldnt be changing the signature of method calls to those classes<br>
[/quote]</p>
<p>I’m only renaming classes, not changing anything else.</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>Ok, unfortunately a new class with the same signature as java.net.URL does not work with methods expecting java.net.URL:</p>
</blockquote>
</aside>
<p>Can you XBoot instead?</p>
</blockquote>
</aside>
<p>Not with an applet, no.[/quote]</p>
<p>Since you are changing the types within the classes you load, can you not also change the method calls? for example</p>
<pre><code class="lang-auto">...
        java.net.URL url = new java.net.URL("http://www.moparisthebest.com/ip.php");
        Test.dourl(url);
...</code></pre>
<p>Would be changed to</p>
<pre><code class="lang-auto">...
        org.moparscape.sandbox.java.net.URL url = new org.moparscape.sandbox.java.net.URL("http://www.moparisthebest.com/ip.php");
        Test.dourl(url.toURL()); //returns the correct sandboxed URL object
...</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/47">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/47</link>
        <pubDate>Wed, 28 Mar 2012 04:55:48 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-47</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="44" data-topic="413379">
<div class="title">
<div class="quote-controls"></div>
 frank_:</div>
<blockquote>
<p>then you probably shouldnt be changing the signature of method calls to those classes</p>
</blockquote>
</aside>
<p>I’m only renaming classes, not changing anything else.</p>
<p>[quote=“Fsig, post:45, topic:413379”][quote author=Moparisthebest link=topic=514882.msg3955686#msg3955686 date=1332723933]<br>
Ok, unfortunately a new class with the same signature as java.net.URL does not work with methods expecting java.net.URL:<br>
[/quote]</p>
<p>Can you XBoot instead?[/quote]</p>
<p>Not with an applet, no.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/46">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/46</link>
        <pubDate>Wed, 28 Mar 2012 04:18:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-46</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@Fsig Fsig]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/fsig">@Fsig</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="41" data-topic="413379">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/moparisthebest/40/30_1.png" class="avatar"> Moparisthebest:</div>
<blockquote>
<p>Ok, unfortunately a new class with the same signature as java.net.URL does not work with methods expecting java.net.URL:</p>
</blockquote>
</aside>
<p>Can you XBoot instead?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/45">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/45</link>
        <pubDate>Tue, 27 Mar 2012 06:57:36 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-45</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>then you probably shouldnt be changing the signature of method calls to those classes</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/44">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/44</link>
        <pubDate>Tue, 27 Mar 2012 03:38:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-44</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="42" data-topic="413379">
<div class="title">
<div class="quote-controls"></div>
 frank_:</div>
<blockquote>
<p>you arent transforming your Test class? dourl signature remains as <a>tt</a>V[/tt]</p>
</blockquote>
</aside>
<p>Yes, it represents the classes I can’t transform, like other classes in the JVM for example.  Unless I just re-implemented them all, yuck.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/43">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/43</link>
        <pubDate>Tue, 27 Mar 2012 02:54:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-43</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@frank frank_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frank">@frank</a> wrote:</p>
          <blockquote>
              <p>you arent transforming your Test class? dourl signature remains as <a>tt</a>V[/tt]</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/42">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/42</link>
        <pubDate>Tue, 27 Mar 2012 00:56:46 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-42</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>Ok, unfortunately a new class with the same signature as java.net.URL does not work with methods expecting java.net.URL:</p>
<p>Code to change:</p>
<pre><code class="lang-auto">package org.moparscape;
public class ChangeMe {
    public static void main(String[] args) throws Exception{
        System.out.println("normal  file (java.io.File):                        "+new java.io.File("/home/mopar"));
        System.out.println("sandbox file (org.moparscape.sandbox.java.io.File): "+new org.moparscape.sandbox.java.io.File("/home/mopar"));
        java.net.URL url = new java.net.URL("http://www.moparisthebest.com/ip.php");
        Test.dourl(url);
    }
}</code></pre>
<p>code that changes the bytecode:</p>
<pre><code class="lang-auto">package org.moparscape;

import com.tonicsystems.jarjar.MainProcessor;
import com.tonicsystems.jarjar.PatternElement;
import com.tonicsystems.jarjar.Rule;
import com.tonicsystems.jarjar.util.EntryStruct;

import java.io.*;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

public class Test {

    public static void main(String[] args) throws Exception {
        String[] renames = new String[]{"java.io.File", "java.lang.System", "java.net.URL"};
        List&lt;PatternElement&gt; patterns = new ArrayList&lt;PatternElement&gt;(renames.length);
        for (String rename : renames) {
            Rule rule = new Rule();
            rule.setPattern(rename);
            rule.setResult("org.moparscape.sandbox." + rename);
            patterns.add(rule);
        }
        boolean verbose = true;
        boolean skipManifest = true;
        MainProcessor proc = new MainProcessor(patterns, verbose, skipManifest);
        EntryStruct struct = new EntryStruct();

        ByteArrayOutputStream out = new ByteArrayOutputStream();
        File inFile = new File("./out/production/Jarjar/org/moparscape/ChangeMe.class");
        writeStream(new FileInputStream(inFile), out);
        inFile.delete();
        struct.name = "org/moparscape/ChangeMe.class";
        struct.data = out.toByteArray();
        if (proc.process(struct)) {
            writeStream(new ByteArrayInputStream(struct.data), new FileOutputStream(inFile));
            System.out.println("success!");
        } else {
            System.out.println("failure...");
        }
    }

    public static void writeStream(InputStream in, OutputStream out) throws IOException {
        byte[] buffer = new byte[512];
        int len;
        while ((len = in.read(buffer)) &gt;= 0) {
            out.write(buffer, 0, len);
        }
        in.close();
        out.close();
    }
    
    public static void dourl(URL url){
        try{
        System.out.println("url: "+url.openConnection());
        }catch(Exception e){
            e.printStackTrace();
        }
    }

}</code></pre>
<p>Run before change:</p>
<pre><code class="lang-auto">normal  file (java.io.File):                        /home/mopar
sandbox file (org.moparscape.sandbox.java.io.File): /home/mopar/.moparscape/home/mopar
url: sun.net.www.protocol.http.HttpURLConnection:http://www.moparisthebest.com/ip.php</code></pre>
<p>Run after change:</p>
<pre><code class="lang-auto">normal  file (java.io.File):                        /home/mopar/.moparscape/home/mopar
sandbox file (org.moparscape.sandbox.java.io.File): /home/mopar/.moparscape/home/mopar
Exception in thread "main" java.lang.NoSuchMethodError: org.moparscape.Test.dourl(Lorg/moparscape/sandbox/java/net/URL;)V
	at org.moparscape.ChangeMe.main(ChangeMe.java:7)</code></pre>
<p>So, any ideas?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/41">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/41</link>
        <pubDate>Mon, 26 Mar 2012 01:05:33 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-41</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="39" data-topic="413379">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/mopman/40/33_1.png" class="avatar"> Mopman:</div>
<blockquote>
<p>as long as the applet is signed and accepted, its pretty easy to attach an agent without making any permanent changes, though its hacky-ish &amp; os specific and you only get to attach after the vm has initialized, all of which might be things you dont like <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
</blockquote>
</aside>
<p>But it doesn’t do anything for loading untrusted code inside my trusted applet.</p>
<p>Ok, here is another question for you guys.  I’m running into a slight problem with some classes I want to over-ride, I’ll explain what I’ve done so far:</p>
<p>org.moparscape.sandbox.java.io.File extends java.io.File -&gt; works great, I over-ride what I like and it will work anywhere a java.io.File is expected</p>
<p>org.moparscape.sandbox.java.lang.System -&gt; java.lang.System is final, but all the methods are static, so I just re-implement them with identical signatures and everything works as expected</p>
<p>org.moparscape.sandbox.java.net.URL -&gt; java.net.URL is final, so I can’t over-ride it, if I create a new stand-alone URL class that behaves exactly like the java URL class, it won’t work, because when you try to pass it to something that expects java.net.URL, it will fail, right?  Or is the compiler the only thing that cares about that and if edited in the bytecode it only cares about the correct method signatures and such?</p>
<p>Can anyone shed some light or point me in the right direction on these things?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/40">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/40</link>
        <pubDate>Sun, 25 Mar 2012 20:04:59 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-40</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@Mopman Mopman]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mopman">@Mopman</a> wrote:</p>
          <blockquote>
              <p>as long as the applet is signed and accepted, its pretty easy to attach an agent without making any permanent changes, though its hacky-ish &amp; os specific and you only get to attach after the vm has initialized, all of which might be things you dont like <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/39">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/39</link>
        <pubDate>Sat, 24 Mar 2012 12:26:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-39</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>While googling about an entirely different project, I stumbled across this handy little app called ‘jarjar’, which just so happens to have the exact functionality that I need, using ASM:</p>
<p><a href="http://code.google.com/p/jarjar/source/browse/trunk/jarjar/src/main/com/tonicsystems/jarjar/MainProcessor.java" class="onebox" target="_blank">http://code.google.com/p/jarjar/source/browse/trunk/jarjar/src/main/com/tonicsystems/jarjar/MainProcessor.java</a></p>
<p>Woohoo! <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:">  That’s never happened to me before.</p>
<p>I’ll be writing a sandbox classloader shortly.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/38">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/38</link>
        <pubDate>Sat, 24 Mar 2012 05:33:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-38</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="35" data-topic="413379">
<div class="title">
<div class="quote-controls"></div>
 The Enforcer:</div>
<blockquote>
<p>The bytecode editing idea presented in the first post seems like a very bad solution. Use JVMTI, you can hook class load and method call events. In fact, you can hook all kinds of events.</p>
</blockquote>
</aside>
<p>Again, this is going to run as an applet, so that isn’t an option either.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/37">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/37</link>
        <pubDate>Fri, 02 Mar 2012 20:39:06 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-37</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@silic silic]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/silic">@silic</a> wrote:</p>
          <blockquote>
              <p>[quote=“The Enforcer, post:35, topic:413379”][/quote]</p>
<p>The only problem is that, when you set the JVM to send all those method enter events, it slows execution down considerably and IDK if you can disengage the event dispatch while the VM is running.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/36">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/36</link>
        <pubDate>Fri, 02 Mar 2012 19:40:59 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-36</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@The_Enforcer The Enforcer]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/the_enforcer">@The_Enforcer</a> wrote:</p>
          <blockquote>
              <p>The bytecode editing idea presented in the first post seems like a very bad solution. Use JVMTI, you can hook class load and method call events. In fact, you can hook all kinds of events.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/35">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/35</link>
        <pubDate>Fri, 02 Mar 2012 13:14:59 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-35</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>I’ll have a list of ‘safe’ hashes, and if the binary they want to load matches one of those, I’ll allow it.  Otherwise I’ll have to decide whether or not to let the user decide to over-ride, probably not though.</p>
<aside class="quote quote-modified" data-post="30" data-topic="413379">
<div class="title">
<div class="quote-controls"></div>
 Miss Silabsoft:</div>
<blockquote>
<p>“cold hard cash” you can keep your pennies nickles and dimes hand out some Benjamin’s (soft and sexy).</p>
</blockquote>
</aside>
<p>More likely, unless you live in the USA and want me to mail you a check, it would be “digital electronic cash”.  Anyone want some? <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/34">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/34</link>
        <pubDate>Thu, 01 Mar 2012 19:14:18 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-34</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@T41 t4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/t41">@T41</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="32" data-topic="413379">
<div class="title">
<div class="quote-controls"></div>
 Taharok:</div>
<blockquote>
<p>So the libraries would have to be managed by mopar himself then, instead of being part of the regular client distribution. Otherwise he’d need some sort of way of detecting what each library is. Probably easily done with a simple name comparison (which also needs to be done for handling the load library permission).</p>
</blockquote>
</aside>
<p>maybe i’m not understanding your post, but as i said the most common native libraries will always be the same (the rs2 libraries for rt5+) - a simple hash check on them will ensure they weren’t tampered with. as far as other native libraries go, there’s nothing much moparisthebest can really do other than warning the user of the client that native libraries were loaded (ex: continue: y/n).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/33">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/33</link>
        <pubDate>Thu, 01 Mar 2012 18:25:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-33</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@mod_taharok Taharok]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mod_taharok">@mod_taharok</a> wrote:</p>
          <blockquote>
              <p>So the libraries would have to be managed by mopar himself then, instead of being part of the regular client distribution. Otherwise he’d need some sort of way of detecting what each library is. Probably easily done with a simple name comparison (which also needs to be done for handling the load library permission).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/32">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/32</link>
        <pubDate>Thu, 01 Mar 2012 17:25:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-32</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@T41 t4]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/t41">@T41</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="29" data-topic="413379">
<div class="title">
<div class="quote-controls"></div>
 c|p:</div>
<blockquote>
<p>There is really no reliable or secure way to prevent/check anything once you let a native library load.  You can try, but it’s a battle that can’t be won (think anti-cheat and anti-virus).</p>
</blockquote>
</aside>
<p>chances are moparscapians won’t be writing native libraries. i know rt5 has native libraries with it, but like mitb said a simple CRC comparison would remedy that. in the off event that the distributor does have native libraries, the client could warn the user.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/31">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/31</link>
        <pubDate>Thu, 01 Mar 2012 16:44:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-31</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@silabsoft RuneAgent]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/silabsoft">@silabsoft</a> wrote:</p>
          <blockquote>
              <p>“cold hard cash” you can keep your pennies nickles and dimes hand out some Benjamin’s (soft and sexy).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/30">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/30</link>
        <pubDate>Thu, 01 Mar 2012 11:31:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-30</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@Cheese_Police c|p]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/cheese_police">@Cheese_Police</a> wrote:</p>
          <blockquote>
              <p>There is really no reliable or secure way to prevent/check anything once you let a native library load.  You can try, but it’s a battle that can’t be won (think anti-cheat and anti-virus).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/29">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/29</link>
        <pubDate>Thu, 01 Mar 2012 05:25:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-29</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="27" data-topic="413379">
<div class="title">
<div class="quote-controls"></div>
 Taharok:</div>
<blockquote>
<p>What about native access? Some of the clients may require the loading of a native library, such as for high detail of the 5xx clients. Is this allowed in moparscape 4? If so, you’d have to police all the attempted file and network access in those, too.</p>
</blockquote>
</aside>
<p>I don’t know about that.  For now, I don’t allow it.  I planned on allowing it on a whitelist basis of binaries I knew were clean (take the md5sum of them or something).  I’m open to ideas on that of course, but the above needs implemented either way.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/28">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/28</link>
        <pubDate>Thu, 01 Mar 2012 04:13:37 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-28</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@mod_taharok Taharok]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mod_taharok">@mod_taharok</a> wrote:</p>
          <blockquote>
              <p>What about native access? Some of the clients may require the loading of a native library, such as for high detail of the 5xx clients. Is this allowed in moparscape 4? If so, you’d have to police all the attempted file and network access in those, too.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/27">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/27</link>
        <pubDate>Thu, 01 Mar 2012 03:10:53 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-27</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>So, in relation to this thread, I’d like to get this done ASAP but don’t have a lot of free time lately.  So I’m looking for someone who knows what they are doing that can write this code for me in exchange for some cold hard cash.  The code will be released to the community under a license like the GNU/GPL.  Anyone interested?</p>
<p>tl;dr, I’ll pay someone to implement code to change various constructors and/or method calls in bytecode.</p>
<p>Either post in this thread or shoot me a PM for more details and maybe we can discuss it over IRC or something.  I’d like to get it done quickly.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/26">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/26</link>
        <pubDate>Wed, 29 Feb 2012 23:54:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-26</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
      <item>
        <title>[bytecode] Control or Redirect ALL File and Network Access</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>[quote=“Speljohan, post:23, topic:413379”][quote author=Moparisthebest link=topic=514882.msg3742336#msg3742336 date=1315454648]<br>
But in order to run a java-agent like that, I’d have to make permanent changes to the user’s system before running the applet (to the deployment properties), so it’s not a system I want to use.  I don’t think it’s appropriate for this particular problem.<br>
[/quote]User-level deployment configuration is your friend.[/quote]<br>
And it should be fun to try to get to work across all Operating Systems, all Sun Java versions from 5-7, and OpenJDK and IcedTea too right?  No thanks. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>edit:<br>
Actually it’s not even an option with Java 5 I don’t think.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/25">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379/25</link>
        <pubDate>Thu, 08 Sep 2011 04:49:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-413379-25</guid>
        <source url="https://forum.moparisthebest.com/t/bytecode-control-or-redirect-all-file-and-network-access/413379.rss">[bytecode] Control or Redirect ALL File and Network Access</source>
      </item>
  </channel>
</rss>
