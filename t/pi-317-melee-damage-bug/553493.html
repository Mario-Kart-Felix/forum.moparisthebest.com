<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/pi-317-melee-damage-bug/553493 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>PI 317 - Melee damage bug - Runescape - moparisthebest.com</title>
    <meta name="description" content="THIS IS FOR A 317 PI 

The bug For occasional hits, the damage ratings of each player will invisibly &amp;#39;swap&amp;#39; causing the hits below, ignore the fact the maximum hp is 7500 and the hits, this is wierd. Screenshot by Lights&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="553493.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;PI 317 - Melee damage bug&#39;" href="553493.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/pi-317-melee-damage-bug/553493" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/pi-317-melee-damage-bug/553493" />
<meta property="og:title" content="PI 317 - Melee damage bug" />
<meta name="twitter:title" content="PI 317 - Melee damage bug" />
<meta property="og:description" content="THIS IS FOR A 317 PI  The bug  For occasional hits, the damage ratings of each player will invisibly ‘swap’ causing the hits below, ignore the fact the maximum hp is 7500 and the hits, this is wierd.  Screenshot by Lightshot Damage rating of primal rapier with elite void (this is bugged in itself but its a different issue)  Screenshot by Lightshot Damage rating of unarmed combat  Screenshot by Lightshot  Screenshot by Lightshot  Screenshot by Lightshot  http://prntscr.com/8n9ajv  http://prntscr...." />
<meta name="twitter:description" content="THIS IS FOR A 317 PI  The bug  For occasional hits, the damage ratings of each player will invisibly ‘swap’ causing the hits below, ignore the fact the maximum hp is 7500 and the hits, this is wierd.  Screenshot by Lightshot Damage rating of primal rapier with elite void (this is bugged in itself but its a different issue)  Screenshot by Lightshot Damage rating of unarmed combat  Screenshot by Lightshot  Screenshot by Lightshot  Screenshot by Lightshot  http://prntscr.com/8n9ajv  http://prntscr...." />
<meta property="article:published_time" content="2015-10-03T17:18:00+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="553493.html">PI 317 - Melee damage bug</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Pker_DX.html'><span itemprop='name'>Pker_DX</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-10-03T17:18:00Z'>
            <time itemprop='dateModified' datetime='2016-08-04T16:32:27Z' class='post-time'>
              August 4, 2016,  4:32pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>THIS IS FOR A 317 PI</p>
<p>The bug<br>
For occasional hits, the damage ratings of each player will invisibly ‘swap’ causing the hits below, ignore the fact the maximum hp is 7500 and the hits, this is wierd.<br>
<a href="http://prntscr.com/8n99db" data-bbcode="true" rel="nofollow noopener">Screenshot by Lightshot</a> Damage rating of primal rapier with elite void (this is bugged in itself but its a different issue)<br>
<a href="http://prntscr.com/8n99jz" data-bbcode="true" rel="nofollow noopener">Screenshot by Lightshot</a> Damage rating of unarmed combat</p>
<p><a href="http://prntscr.com/8n972c" data-bbcode="true" rel="nofollow noopener">Screenshot by Lightshot</a><br>
<a href="http://prntscr.com/8n98q3" data-bbcode="true" rel="nofollow noopener">Screenshot by Lightshot</a><br>
<a href="http://prntscr.com/8n990d" data-bbcode="true" rel="nofollow noopener">Screenshot by Lightshot</a><br>
<a href="http://prntscr.com/8n9ajv" data-bbcode="true" rel="nofollow noopener">http://prntscr.com/8n9ajv</a><br>
<a href="http://prntscr.com/8n9b3o" data-bbcode="true" rel="nofollow noopener">http://prntscr.com/8n9b3o</a></p>
<p>Sometimes it doesn’t swap and both players recieve the higher damage</p>
<p>[CODE]	public void applyPlayerMeleeDamage(int i, int damageMask){<br>
Client o = (Client) Server.playerHandler.players[i];<br>
if(o == null) {<br>
return;<br>
}<br>
if(ABS())<br>
{<br>
c.korasiSpec = true;<br>
}<br>
int damage = calculateMeleeMaxHit() + (int) (Misc.random(calculateMeleeMaxHit()) * 3);<br>
double damage4 = calculateMeleeMaxHit() + (int) (Misc.random(calculateMeleeMaxHit()) * 3);<br>
int damage2 = damage;<br>
int damage3 = calculateMeleeMaxHit() + Misc.random(calculateMeleeMaxHit());<br>
if (c.playerEquipment[c.playerWeapon] == 5698 &amp;&amp; o.poisonDamage &lt;= 0 &amp;&amp; Misc.random(3) == 1)<br>
o.getPA().appendPoison(i);<br>
boolean veracsEffect = false;<br>
boolean guthansEffect = false;<br>
boolean toragsEffect = false;<br>
if (c.getPA().fullVeracs()) {<br>
if (Misc.random(5) == 1) {<br>
veracsEffect = true;				<br>
}		<br>
}<br>
if (c.getPA().fullGuthans()) {<br>
if (Misc.random(5) == 1) {<br>
guthansEffect = true;<br>
}		<br>
}<br>
if (c.getPA().fullTorags()) {<br>
if (Misc.random(5) == 1) {<br>
toragsEffect = true;				<br>
}		<br>
}<br>
if (damageMask == 1) {<br>
damage = c.delayedDamage;<br>
c.delayedDamage = 0;<br>
} else {<br>
damage = c.delayedDamage2;<br>
c.delayedDamage2 = 0;<br>
}<br>
if(Misc.random(o.getCombat().calculateMeleeDefence()) &gt; Misc.random(calculateMeleeAttack()) &amp;&amp; !veracsEffect) {<br>
damage = 0;<br>
c.bonusAttack = 0;<br>
damage3 = 0;<br>
damage4 = 0;<br>
}<br>
if(c.playerEquipment[c.playerHands] == 20336 &amp;&amp; c.playerEquipment[c.playerWeapon] == -1) {	<br>
damage4 = (int) damage * 1.6;<br>
if(Misc.random(68) == 49)<br>
{<br>
damage4 = (int) damage3 * 1.6;<br>
o.gfx0(1738);<br>
}<br>
}<br>
if (toragsEffect) {<br>
if(damage &gt; 0 &amp;&amp; Server.playerHandler.players[i].constitution &gt;= 1000)<br>
{<br>
if(!o.curseActive[o.curses().DEFLECT_MELEE] &amp;&amp; !o.prayerActive[18])<br>
{<br>
damage = Server.playerHandler.players[i].constitution/3;<br>
}<br>
if(o.curseActive[o.curses().DEFLECT_MELEE] &amp;&amp; o.prayerActive[18])<br>
{<br>
damage = Server.playerHandler.players[i].constitution/6;<br>
}<br>
}</p>
<pre><code>		if(damage &gt; 0 &amp;&amp; Server.playerHandler.players[i].constitution &lt; 1000)
		{
		if(!o.curseActive[o.curses().DEFLECT_MELEE] &amp;&amp; !o.prayerActive[18])
		{
		damage = Server.playerHandler.players[i].constitution;
		}
		if(o.curseActive[o.curses().DEFLECT_MELEE] &amp;&amp; o.prayerActive[18])
		{
		damage = (int)(Server.playerHandler.players[i].constitution/1.4);
		}
	}}
	if(damage4 &gt; 0)
	{
		damage = (int)damage4;
	}
	if (o.curseActive[c.curses().DEFLECT_MELEE] &amp;&amp; !veracsEffect) {
		damage = (int)damage * 50 / 100;
		o.curses().deflect(c, damage, 0);
	}
	if(o.prayerActive[18] &amp;&amp; !veracsEffect) { // if prayer active reduce damage by 40%
		damage = (int)damage * 50 / 100;
	}
	if (damage &gt; 0 &amp;&amp; guthansEffect) {
		c.constitution += damage;
		if (c.constitution &gt; c.maxConstitution)
			c.constitution = c.maxConstitution;
		o.gfx0(398);		
	}
	if (c.ssSpec &amp;&amp; damageMask == 2) {
		damage = 500 + Misc.random(1750);
		c.ssSpec = false;
	}
	if (o.vengOn &amp;&amp; damage &gt; 0)
		appendVengeance(i, damage);
	if (damage &gt; 0)
		applyRecoil(damage, i);
	switch (c.specEffect) {
		case 1: // dragon scimmy special
		if(damage &gt; 0) {
			if(o.prayerActive[16] || o.prayerActive[17] || o.prayerActive[18]) {
				o.headIcon = -1;
				o.getPA().sendFrame36(c.PRAYER_GLOW[16], 0);
				o.getPA().sendFrame36(c.PRAYER_GLOW[17], 0);
				o.getPA().sendFrame36(c.PRAYER_GLOW[18], 0);					
			}
			if(o.curseActive[o.curses().DEFLECT_MELEE] || o.curseActive[o.curses().DEFLECT_MAGIC] || o.curseActive[o.curses().DEFLECT_MISSILES]) {
				o.headIcon = -1;
				o.curses().deactivate(o.curses().DEFLECT_MAGIC);	
				o.curses().deactivate(o.curses().DEFLECT_MISSILES);	
				o.curses().deactivate(o.curses().DEFLECT_MELEE);			
			}
			o.sendMessage("You have been injured!");
			o.stopPrayerDelay = System.currentTimeMillis();
			o.prayerActive[16] = false;
			o.prayerActive[17] = false;
			o.prayerActive[18] = false;
			o.getPA().requestUpdates();		
		}
		break;
		case 2:
			if (damage &gt; 0) {
				if (o.freezeTimer &lt;= 0)
					o.freezeTimer = 20;
				o.gfx0(369);
				o.sendMessage("You have been frozen.");
				o.frozenBy = c.playerId;
				o.stopMovement();
				c.sendMessage("You freeze your enemy.");
			}		
		break;
		case 3:
			if (damage &gt; 0) {
				o.playerLevel[1] -= damage/10;
				o.sendMessage("You feel weak.");
				if (o.playerLevel[1] &lt; 1)
					o.playerLevel[1] = 1;
				o.getPA().refreshSkill(1);
			}
		break;
		case 4:
			if (damage &gt; 0) {
				if (c.constitution + damage &gt; c.maxConstitution)
					if (c.constitution &gt; c.maxConstitution);
					else 
					c.constitution = c.maxConstitution;
				else 
					c.constitution += damage;
				c.getPA().refreshSkill(3);
			}
		break;
		case 5:
			if (damage &gt; 0) {
				o.playerLevel[6] -= damage/2;
				o.sendMessage("Your magic skill is shredded by the spirit of Aiyana!");
				if (o.playerLevel[6] &lt; 1)
				o.playerLevel[6] = 1;
				o.getPA().refreshSkill(6);
				o.gfx0(1849);
			}
		break;
		case 6:
			if (damage &lt; 0) {
				damage = 1;
				}
			
		break;
		case 7:
			if (damage &gt; 0) {
				o.playerLevel[5] -= damage/10;
				o.sendMessage("Your prayer is sapped by the wrath of Zaros!");
				if (o.playerLevel[5] &lt; 1)
				o.playerLevel[5] = 1;
				o.getPA().refreshSkill(5);
			}
		break;
		case 8:
			if (damage &gt; 0) {
				o.playerLevel[4] -= damage/5;
				o.sendMessage("You feel drained of ranged capability.");
				if (o.playerLevel[4] &lt; 1)
					o.playerLevel[4] = 1;
				o.getPA().refreshSkill(4);
			}
		break;
		case 9:
			damage = korasiDamage(o);
			o.gfx0(1248);
		break;
		case 10:
			c.hit1 = damage;
           			if(o.vengOn &amp;&amp; damage &gt; 0)
            		appendVengeance(1, damage);
			if (c.hit1 &gt; 0)
				c.hit2 = c.hit1/2;
			else
				c.hit2 = meleeHitSuccess(calculateMeleeAttack(), o.getCombat().calculateMeleeDefence()) ? Misc.random(calculateMeleeMaxHit()) : 0;
           				if (o.vengOn &amp;&amp; c.hit2 &gt; 0)
            			appendVengeance(1, c.hit2);

           				if (o.vengOn &amp;&amp; damage &gt; 0)
			if (c.hit2 &gt; 0)
				c.hit3 = c.hit2/2;
			else
				c.hit3 = meleeHitSuccess(calculateMeleeAttack(), o.getCombat().calculateMeleeDefence()) ? Misc.random(calculateMeleeMaxHit()) : 0;
			
           				if (o.vengOn &amp;&amp; c.hit3 &gt; 0)
            			appendVengeance(1, c.hit3);
			if (c.hit3 &gt; 0)
				c.hit4 = c.hit3 + 10;
			else
				c.hit4 = meleeHitSuccess(calculateMeleeAttack(), o.getCombat().calculateMeleeDefence()) ? Misc.random2(calculateMeleeMaxHit() / 0.5) : 1;
           				if (o.vengOn &amp;&amp; c.hit4 &gt; 0)
            			appendVengeance(1, c.hit4);
			appendHit(o, c.hit2, 0, 0, true);
			c.clawDelay = 1;
			c.clawTarg = i;
			c.clawTargNPC = 0;
		break;
		case 11: // dragon scimmy special
		if(damage &gt; 0) {
			if(o.prayerActive[16] || o.prayerActive[17] || o.prayerActive[18]) {
				o.headIcon = -1;
				o.getPA().sendFrame36(c.PRAYER_GLOW[16], 0);
				o.getPA().sendFrame36(c.PRAYER_GLOW[17], 0);
				o.getPA().sendFrame36(c.PRAYER_GLOW[18], 0);					
			}
			if(o.curseActive[o.curses().DEFLECT_MELEE] || o.curseActive[o.curses().DEFLECT_MAGIC] || o.curseActive[o.curses().DEFLECT_MISSILES]) {
				o.headIcon = -1;
				o.curses().deactivate(o.curses().DEFLECT_MAGIC);	
				o.curses().deactivate(o.curses().DEFLECT_MISSILES);	
				o.curses().deactivate(o.curses().DEFLECT_MELEE);			
			}
			o.sendMessage("You have been injured!");
			o.stopPrayerDelay2 = System.currentTimeMillis();
			o.prayerActive[16] = false;
			o.prayerActive[17] = false;
			o.prayerActive[18] = false;
			o.getPA().requestUpdates();		
		}
		case 12:
			damage = absDamage(o);
			o.gfx0(2189);
		break;
		case 13:
			if (damage &gt; 0) {
				o.playerLevel[5] -= damage;
				o.sendMessage("@red@Your prayer is destroyed by the power of the war god!");
				if (o.playerLevel[5] &lt; 0)
				o.playerLevel[5] = 0;
				o.getPA().refreshSkill(5);
			}
		break;
	}
	c.specEffect = 0;
	Server.playerHandler.players[i].logoutDelay = System.currentTimeMillis();
	Server.playerHandler.players[i].underAttackBy = c.playerId;
	Server.playerHandler.players[i].killerId = c.playerId;	
	Server.playerHandler.players[i].singleCombatDelay = System.currentTimeMillis();
	if (c.killedBy != Server.playerHandler.players[i].playerId)
		c.totalPlayerDamageDealt = 0;
	c.killedBy = Server.playerHandler.players[i].playerId;
	applySmite(i, damage);
	c.curses().soulSplit(i, damage);
	if(Misc.random(mageAtk()) &lt; Misc.random(mageDef()) &amp;&amp; ABS()) {
	damage = 0;
	}
	if(Misc.random(mageAtk()) &gt; Misc.random(mageDef()) &amp;&amp; ABS()) {
	damage = (int) finalMagicDamage(c) + (Misc.random(finalMagicDamage(c)*3));
	if(o.curseActive[o.curses().DEFLECT_MAGIC] || o.prayerActive[16])
	{
	damage = damage * 50 / 100;
	}
	}
	if(c.korasiSpec)
	{
	appendHit(o, damage, 0, 2, true);
	}
	if(!c.korasiSpec)
	{
	appendHit(o, damage, 0, 0, true);
	}
	addCombatXP(1, damage);
	addCombatXP(0, damage);
	switch(damageMask) {
		case 1:
		Server.playerHandler.players[i].damageTaken[c.playerId] += damage;
		c.totalPlayerDamageDealt += damage;
		break;
	
		case 2:
		Server.playerHandler.players[i].damageTaken[c.playerId] += damage;
		c.totalPlayerDamageDealt += damage;
		c.doubleHit = false;
		break;			
	}
	c.korasiSpec = false;
}[/CODE]</code></pre>
      </div>

      <meta itemprop='headline' content='PI 317 - Melee damage bug'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/pi-317-melee-damage-bug/553493 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:16 GMT -->
</html>
