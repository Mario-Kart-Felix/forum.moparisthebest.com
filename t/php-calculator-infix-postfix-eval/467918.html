<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/php-calculator-infix-postfix-eval/467918 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 21:43:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[PHP] Calculator (infix-&gt;postfix-&gt;eval) - General Programming - moparisthebest.com</title>
    <meta name="description" content="i was kind of following off of a few different sources trying to solve a bunch of different problems. i didn&amp;#39;t really come across a php implementation so i just wrote one. 

thankfully due to the way php works negative n&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="467918.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[PHP] Calculator (infix-&gt;postfix-&gt;eval)&#39;" href="467918.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/php-calculator-infix-postfix-eval/467918" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/php-calculator-infix-postfix-eval/467918" />
<meta property="og:title" content="[PHP] Calculator (infix-&gt;postfix-&gt;eval)" />
<meta name="twitter:title" content="[PHP] Calculator (infix-&gt;postfix-&gt;eval)" />
<meta property="og:description" content="i was kind of following off of a few different sources trying to solve a bunch of different problems. i didn’t really come across a php implementation so i just wrote one.  thankfully due to the way php works negative numbers work properly without any extra hassle. no support for functions or variables though. variables would be easy. functions would be a bit harder but definitely doable.  i needed to understand how math calculation works for something i’m writing in java and php is easy for tes..." />
<meta name="twitter:description" content="i was kind of following off of a few different sources trying to solve a bunch of different problems. i didn’t really come across a php implementation so i just wrote one.  thankfully due to the way php works negative numbers work properly without any extra hassle. no support for functions or variables though. variables would be easy. functions would be a bit harder but definitely doable.  i needed to understand how math calculation works for something i’m writing in java and php is easy for tes..." />
<meta property="article:published_time" content="2012-11-13T12:53:39+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="467918.html">[PHP] Calculator (infix-&gt;postfix-&gt;eval)</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Supah_Flyizzle.html'><span itemprop='name'>Supah_Flyizzle</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-11-13T12:53:39Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:08:45Z' class='post-time'>
              August 4, 2016,  1:08am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>i was kind of following off of a few different sources trying to solve a bunch of different problems. i didn’t really come across a php implementation so i just wrote one.</p>
<p>thankfully due to the way php works negative numbers work properly without any extra hassle. no support for functions or variables though. variables would be easy. functions would be a bit harder but definitely doable.</p>
<p>i needed to understand how math calculation works for something i’m writing in java and <span class="bbcode-b">php is easy for testing</span>. of course if you didn’t really care about parsing then evaluating (eval is just a cheap way of evaluating because i got lazy and didn’t need to elaborate on that) then you could pretty much use eval for any expression. the point is to actually have something that parses the math rather than something that evaluates.</p>
<p>index.php?expr=(32*3)%2B(4/5-(6^9/(4%8)))<br>
[SIZE=1]%2B = plus sign (+)[/SIZE]</p>
<p><code>Expression: (32*3)+(4/5-(6^9/(4%8)))
Postfix: 32 3 * 4 5 / 6 9 ^ 4 8 % / - +
Evaluation: -2519327.2</code></p>
<p>improved version:</p>
<p>[CODE]&lt;?php<br>
define(‘ASSOC_NONE’, 0);<br>
define(‘ASSOC_LEFT’, 1);<br>
define(‘ASSOC_RIGHT’, 2);</p>
<p>// array(10, ASSOC_RIGHT, true), // originally needed in c code for unary -<br>
// operator =&gt; array(precedence, associativity, unary)<br>
$operators = array(’^’ =&gt; array(9, ASSOC_RIGHT, false),<br>
‘*’ =&gt; array(8, ASSOC_LEFT, false),<br>
‘/’ =&gt; array(8, ASSOC_LEFT, false),<br>
‘%’ =&gt; array(8, ASSOC_LEFT, false),<br>
‘+’ =&gt; array(5, ASSOC_LEFT, false),<br>
‘-’ =&gt; array(5, ASSOC_LEFT, false),<br>
‘(’ =&gt; array(0, ASSOC_NONE, false),<br>
‘)’ =&gt; array(0, ASSOC_NONE, false));</p>
<p>function precedence($opchar)<br>
{<br>
global $operators;<br>
return $operators[$opchar][0];<br>
}</p>
<p>function associativity($opchar)<br>
{<br>
global $operators;<br>
return $operators[$opchar][1];<br>
}</p>
<p>function unary($opchar)<br>
{<br>
global $operators;<br>
return $operators[$opchar][2];<br>
}</p>
<p>function is_operator($char)<br>
{<br>
global $operators;<br>
return array_key_exists($char, $operators);<br>
}</p>
<p>function starts_with($haystack, $needle)<br>
{<br>
return !strncmp($haystack, $needle, strlen($needle));<br>
}</p>
<p>function ends_with($haystack, $needle)<br>
{<br>
return substr($haystack, -strlen($needle)) === $needle;<br>
}</p>
<p>function array_peek($stack)<br>
{<br>
return $stack[count($stack) - 1];<br>
}</p>
<p>function postfix($expression)<br>
{<br>
$expression = preg_replace(’/\s+/’, ‘’, $expression);</p>
<pre><code>if (!starts_with($expression, '('))
{
	$expression = '('.$expression;
}

if (!ends_with($expression, ')'))
{
	$expression .= ')';
}

$stack = array();
$output = array();
$numtoken = '';

for ($i = 0; $i &lt; strlen($expression); $i++)
{
	$char = $expression[$i];
	
	if (is_operator($char))
	{
		if ($numtoken != '')
		{
			$output[] = $numtoken;
			$numtoken = '';
		}
		
		if ($char == '(')
		{
			array_push($stack, $char);
		}
		else if ($char == ')')
		{
			while (count($stack) &gt; 0 &amp;&amp; ($top = array_peek($stack)) != '(')
			{
				$output[] = array_pop($stack);
			}
			
			array_pop($stack);
		}
		else
		{
			while (count($stack) &gt; 0)
			{
				$peek = array_peek($stack);
				
				if (associativity($char) == ASSOC_LEFT &amp;&amp; precedence($char) &lt;= precedence($peek)
					|| associativity($char) == ASSOC_RIGHT &amp;&amp; precedence($char) &lt; precedence($peek))
				{
					$output[] = array_pop($stack);
				}
				else
				{
					break;
				}
			}
			
			array_push($stack, $char);
		}
	}
	else
	{
		$numtoken .= $char;
	}
}

while (count($stack) &gt; 0)
{
	if (array_peek($stack) == '(')
	{
		array_pop($stack);
	}
	else
	{
		$output[] = array_pop($stack);
	}
}

return $output;
</code></pre>
<p>}</p>
<p>function postfix_eval($postfix, $variables = array())<br>
{<br>
$stack = array();</p>
<pre><code>foreach ($postfix as $token)
{
	if (is_operator($token))
	{
		$second = array_pop($stack);
		$first = array_pop($stack);
		
		if ($second == null || $first == null)
		{
			continue; // we need two operands on the stack first
		}
		
		if (!is_numeric($first) &amp;&amp; array_key_exists($first, $variables))
		{
			$first = $variables[$first];
		}
		
		if (!is_numeric($second) &amp;&amp; array_key_exists($second, $variables))
		{
			$second = $variables[$second];
		}
		
		$result = 0;
		
		if ($token == '^')
		{
			$result = pow($first, $second);
		}
		else
		{
			$result = eval("return $first $token $second;");
		}
		
		array_push($stack, $result);
	}
	else
	{
		if (strlen($token) &gt; 0)
		{
			array_push($stack, $token);
		}
	}
}

return array_pop($stack);
</code></pre>
<p>}</p>
<p>if (isset($_GET[‘expr’]))<br>
{<br>
$expression = $_GET[‘expr’];<br>
echo(‘Expression: ‘.$expression.’<br>’);<br>
$postfix = postfix($expression);<br>
echo(‘Postfix: ‘.implode(’ ‘, $postfix).’<br>’);<br>
echo(‘Evaluation: ‘.postfix_eval($postfix, array(‘size’ =&gt; 121)));<br>
}<br>
else<br>
{<br>
echo(’<img src="../../images/emoji/twitter/frowningae52.png?v=5" title=":frowning:" class="emoji" alt=":frowning:"> no expression? fux u’);<br>
}<br>
?&gt;[/CODE]</p>
      </div>

      <meta itemprop='headline' content='[PHP] Calculator (infix-&gt;postfix-&gt;eval)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/RSPS_Mirrors.html'><span itemprop='name'>RSPS_Mirrors</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-11-13T12:56:18Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:08:45Z' class='post-time'>
              August 4, 2016,  1:08am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Heh, and there’s me thinking a page view counter in php is boss… good stuff, can’t really criticise as I’m new to php myself.</p>
      </div>

      <meta itemprop='headline' content='[PHP] Calculator (infix-&gt;postfix-&gt;eval)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/php-calculator-infix-postfix-eval/467918 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 21:43:46 GMT -->
</html>
