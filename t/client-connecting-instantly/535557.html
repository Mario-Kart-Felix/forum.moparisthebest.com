<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/client-connecting-instantly/535557 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Client connecting instantly - Game Development - moparisthebest.com</title>
    <meta name="description" content="What causes the client&amp;#39;s connection to delay when logging in? I&amp;#39;m just looking to remove the delay/error messages if you&amp;#39;re logging in multiple times. 

Sometimes it will display the message &amp;quot;No reponse from server&amp;quot;, and&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="535557.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Client connecting instantly&#39;" href="535557.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/client-connecting-instantly/535557" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/client-connecting-instantly/535557" />
<meta property="og:title" content="Client connecting instantly" />
<meta name="twitter:title" content="Client connecting instantly" />
<meta property="og:description" content="What causes the client’s connection to delay when logging in? I’m just looking to remove the delay/error messages if you’re logging in multiple times.  Sometimes it will display the message “No reponse from server”, and when I tried to get around this, it will keep saying “Connecting to server…” for like 40 seconds and then finally give me a response?  		if (k == -1) { 				i1 = k; 				if (i1 == 0 || i1 != 0) { 					if (loginFailures &lt; 5) { 						try { 							Thread.sleep(1000L); 						} catch (E..." />
<meta name="twitter:description" content="What causes the client’s connection to delay when logging in? I’m just looking to remove the delay/error messages if you’re logging in multiple times.  Sometimes it will display the message “No reponse from server”, and when I tried to get around this, it will keep saying “Connecting to server…” for like 40 seconds and then finally give me a response?  		if (k == -1) { 				i1 = k; 				if (i1 == 0 || i1 != 0) { 					if (loginFailures &lt; 5) { 						try { 							Thread.sleep(1000L); 						} catch (E..." />
<meta property="article:published_time" content="2013-11-13T00:52:59+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="535557.html">Client connecting instantly</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming/game-development.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Game Development</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ohokay.html'><span itemprop='name'>ohokay</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-11-13T00:52:59Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:02:08Z' class='post-time'>
              August 4, 2016, 11:02am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>What causes the client’s connection to delay when logging in? I’m just looking to remove the delay/error messages if you’re logging in multiple times.</p>
<p>Sometimes it will display the message “No reponse from server”, and when I tried to get around this, it will keep saying “Connecting to server…” for like 40 seconds and then finally give me a response?</p>
<pre><code class="lang-auto">		if (k == -1) {
				i1 = k;
				if (i1 == 0 || i1 != 0) {
					if (loginFailures &lt; 5) {
						try {
							Thread.sleep(1000L);
						} catch (Exception _ex) {
						}
						//loginFailures++;
						loginFailures = 0;
						login(s, s1, flag);
						//Thread.sleep(1000L);
						return;
					} else {
						loginMessage1 = "No response from loginserver";
						loginMessage2 = "Please wait 1 minute and try again.";
						return;
					}
				} else {
					loginMessage1 = "No response from server";
					loginMessage2 = "Please wait 1 minute and try again.";
					return;
				}
			} else {
				System.out.println("response:" + k);
				loginMessage1 = "Unexpected server response";
				loginMessage2 = "Please try using a different world.";
				return;
			}
		} catch (IOException _ex) {
			loginMessage1 = "";
		}
		loginMessage2 = "Error connecting to server.";
	}</code></pre>
<p>I’ve removed the loginFailures.</p>
<p>With this line</p>
<pre><code class="lang-auto">if (i1 == 0) {</code></pre>
<p>I get “No response from server” after multiple login attempts, and when it’s changed to</p>
<pre><code class="lang-auto">if (i1 == 0 || i1 != 0) {</code></pre>
<p>It stays on “Connecting to server” for about 30-40 seconds, then finally I get my response. What should I be looking at to sort this?</p>
      </div>

      <meta itemprop='headline' content='Client connecting instantly'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ExtremeX-Scape.html'><span itemprop='name'>ExtremeX-Scape</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-11-13T02:19:43Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:02:10Z' class='post-time'>
              August 4, 2016, 11:02am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The client specifies a 30,000 millisecond timeout in its socket class (commonly named RSSocket)</p>
<pre><code class="lang-auto">package org.astrect.net;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

import org.astrect.awt.GameStub;

public final class BufferedConnection implements Runnable {

    private byte[] buffer;
    private int buffIndex;
    private boolean closed;
    private boolean hasIOError;
    private final InputStream inputStream;
    private boolean isWriter;
    private final OutputStream outputStream;
    private final GameStub rsApplet;
    private final Socket socket;
    private int writeIndex;

    public BufferedConnection(GameStub RSApplet_, Socket socket1) throws IOException {
        closed = false;
        isWriter = false;
        hasIOError = false;
        rsApplet = RSApplet_;
        socket = socket1;
        socket.setSoTimeout(30000);
        socket.setTcpNoDelay(true);
        inputStream = socket.getInputStream();
        outputStream = socket.getOutputStream();
    }

    public int available() throws IOException {
        if (closed) {
            return 0;
        } else {
            return inputStream.available();
        }
    }

    public void close() {
        closed = true;
        try {
            if (inputStream != null) {
                inputStream.close();
            }
            if (outputStream != null) {
                outputStream.close();
            }
            if (socket != null) {
                socket.close();
            }
        } catch (IOException _ex) {
            System.out.println("Error closing stream");
        }
        isWriter = false;
        synchronized (this) {
            notify();
        }
        buffer = null;
    }

    public void flushInputStream(byte abyte0[], int j) throws IOException {
        int i = 0;
        if (closed) {
            return;
        }
        int k;
        for (; j &gt; 0; j -= k) {
            k = inputStream.read(abyte0, i, j);
            if (k &lt;= 0) {
                throw new IOException("EOF");
            }
            i += k;
        }

    }

    public void printDebug() {
        System.out.println("dummy:" + closed);
        System.out.println("tcycl:" + writeIndex);
        System.out.println("tnum:" + buffIndex);
        System.out.println("writer:" + isWriter);
        System.out.println("ioerror:" + hasIOError);
        try {
            System.out.println("available:" + available());
        } catch (IOException _ex) {
        }
    }

    public void queueBytes(int i, byte abyte0[]) throws IOException {
        if (closed) {
            return;
        }
        if (hasIOError) {
            hasIOError = false;
            throw new IOException("Error in writer thread");
        }
        if (buffer == null) {
            buffer = new byte[5000];
        }
        synchronized (this) {
            for (int l = 0; l &lt; i; l++) {
                buffer[buffIndex] = abyte0[l];
                buffIndex = (buffIndex + 1) % 5000;
                if (buffIndex == ((writeIndex + 4900) % 5000)) {
                    throw new IOException("buffer overflow");
                }
            }

            if (!isWriter) {
                isWriter = true;
                rsApplet.startRunnable(this, 3);
            }
            notify();
        }
    }

    public int read() throws IOException {
        if (closed) {
            return 0;
        } else {
            return inputStream.read();
        }
    }

    @Override
    public void run() {
        while (isWriter) {
            int i;
            int j;
            synchronized (this) {
                if (buffIndex == writeIndex) {
                    try {
                        wait();
                    } catch (InterruptedException _ex) {
                    }
                }
                if (!isWriter) {
                    return;
                }
                j = writeIndex;
                if (buffIndex &gt;= writeIndex) {
                    i = buffIndex - writeIndex;
                } else {
                    i = 5000 - writeIndex;
                }
            }
            if (i &gt; 0) {
                try {
                    outputStream.write(buffer, j, i);
                } catch (IOException _ex) {
                    hasIOError = true;
                }
                writeIndex = (writeIndex + i) % 5000;
                try {
                    if (buffIndex == writeIndex) {
                        outputStream.flush();
                    }
                } catch (IOException _ex) {
                    hasIOError = true;
                }
            }
        }
    }
}</code></pre>
<p>specifically:</p>
<p><code>
    public BufferedConnection(GameStub RSApplet_, Socket socket1) throws IOException {
        ....
        socket.setSoTimeout(30000);
        ....
    }</code></p>
<p>These classes are from my client which is based off of MITB’s client.</p>
      </div>

      <meta itemprop='headline' content='Client connecting instantly'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ohokay.html'><span itemprop='name'>ohokay</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-11-13T13:58:58Z'>
            <time itemprop='dateModified' datetime='2016-08-04T11:02:17Z' class='post-time'>
              August 4, 2016, 11:02am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“AtomicInt_, post:2, topic:535557”]The client specifies a 30,000 millisecond timeout in its socket class (commonly named RSSocket)</p>
<pre><code class="lang-auto">package org.astrect.net;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

import org.astrect.awt.GameStub;

public final class BufferedConnection implements Runnable {

    private byte[] buffer;
    private int buffIndex;
    private boolean closed;
    private boolean hasIOError;
    private final InputStream inputStream;
    private boolean isWriter;
    private final OutputStream outputStream;
    private final GameStub rsApplet;
    private final Socket socket;
    private int writeIndex;

    public BufferedConnection(GameStub RSApplet_, Socket socket1) throws IOException {
        closed = false;
        isWriter = false;
        hasIOError = false;
        rsApplet = RSApplet_;
        socket = socket1;
        socket.setSoTimeout(30000);
        socket.setTcpNoDelay(true);
        inputStream = socket.getInputStream();
        outputStream = socket.getOutputStream();
    }

    public int available() throws IOException {
        if (closed) {
            return 0;
        } else {
            return inputStream.available();
        }
    }

    public void close() {
        closed = true;
        try {
            if (inputStream != null) {
                inputStream.close();
            }
            if (outputStream != null) {
                outputStream.close();
            }
            if (socket != null) {
                socket.close();
            }
        } catch (IOException _ex) {
            System.out.println("Error closing stream");
        }
        isWriter = false;
        synchronized (this) {
            notify();
        }
        buffer = null;
    }

    public void flushInputStream(byte abyte0[], int j) throws IOException {
        int i = 0;
        if (closed) {
            return;
        }
        int k;
        for (; j &gt; 0; j -= k) {
            k = inputStream.read(abyte0, i, j);
            if (k &lt;= 0) {
                throw new IOException("EOF");
            }
            i += k;
        }

    }

    public void printDebug() {
        System.out.println("dummy:" + closed);
        System.out.println("tcycl:" + writeIndex);
        System.out.println("tnum:" + buffIndex);
        System.out.println("writer:" + isWriter);
        System.out.println("ioerror:" + hasIOError);
        try {
            System.out.println("available:" + available());
        } catch (IOException _ex) {
        }
    }

    public void queueBytes(int i, byte abyte0[]) throws IOException {
        if (closed) {
            return;
        }
        if (hasIOError) {
            hasIOError = false;
            throw new IOException("Error in writer thread");
        }
        if (buffer == null) {
            buffer = new byte[5000];
        }
        synchronized (this) {
            for (int l = 0; l &lt; i; l++) {
                buffer[buffIndex] = abyte0[l];
                buffIndex = (buffIndex + 1) % 5000;
                if (buffIndex == ((writeIndex + 4900) % 5000)) {
                    throw new IOException("buffer overflow");
                }
            }

            if (!isWriter) {
                isWriter = true;
                rsApplet.startRunnable(this, 3);
            }
            notify();
        }
    }

    public int read() throws IOException {
        if (closed) {
            return 0;
        } else {
            return inputStream.read();
        }
    }

    @Override
    public void run() {
        while (isWriter) {
            int i;
            int j;
            synchronized (this) {
                if (buffIndex == writeIndex) {
                    try {
                        wait();
                    } catch (InterruptedException _ex) {
                    }
                }
                if (!isWriter) {
                    return;
                }
                j = writeIndex;
                if (buffIndex &gt;= writeIndex) {
                    i = buffIndex - writeIndex;
                } else {
                    i = 5000 - writeIndex;
                }
            }
            if (i &gt; 0) {
                try {
                    outputStream.write(buffer, j, i);
                } catch (IOException _ex) {
                    hasIOError = true;
                }
                writeIndex = (writeIndex + i) % 5000;
                try {
                    if (buffIndex == writeIndex) {
                        outputStream.flush();
                    }
                } catch (IOException _ex) {
                    hasIOError = true;
                }
            }
        }
    }
}</code></pre>
<p>specifically:</p>
<p><code>
    public BufferedConnection(GameStub RSApplet_, Socket socket1) throws IOException {
        ....
        socket.setSoTimeout(30000);
        ....
    }</code></p>
<p>These classes are from my client which is based off of MITB’s client.[/quote]</p>
<p>I had a thought it was to do with this. Even after changing the timeout, the duration is still the same and I’m still not able to log in after 2 attempts, for about 40 seconds.</p>
      </div>

      <meta itemprop='headline' content='Client connecting instantly'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/client-connecting-instantly/535557 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:32 GMT -->
</html>
