<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/improving-the-performance-of-hyperion/378459?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 12:37:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Improving the Performance of Hyperion - Runescape - moparisthebest.com</title>
    <meta name="description" content="[size=14pt][b]Introduction[/b][/size] Although Hyperion is already a relatively high-performance server, there are some things that could still be improved. This tutorial will focus on entity updating, which is probably &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="3784594658.html?page=2" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Improving the Performance of Hyperion&#39;" href="378459.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/improving-the-performance-of-hyperion/378459?page=2" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/improving-the-performance-of-hyperion/378459?page=2" />
<meta property="og:title" content="Improving the Performance of Hyperion" />
<meta name="twitter:title" content="Improving the Performance of Hyperion" />
<meta property="og:description" content="[quote=“filthjr, post:20, topic:378459”][quote author=headlights link=topic=474324.msg3517281#msg3517281 date=1299104859]   and how does that getIndex method work? would it return -1 if it doesn’t have an index? or an invalid index (i.e. 0 when there is a different object at 0), wouldn’t it make more sense to check if the object at that index equals the object you’re comparing it to?    When you say “order”, are you talking about updating the closest players/NPCs first an so on? That’s beyond th..." />
<meta name="twitter:description" content="[quote=“filthjr, post:20, topic:378459”][quote author=headlights link=topic=474324.msg3517281#msg3517281 date=1299104859]   and how does that getIndex method work? would it return -1 if it doesn’t have an index? or an invalid index (i.e. 0 when there is a different object at 0), wouldn’t it make more sense to check if the object at that index equals the object you’re comparing it to?    When you say “order”, are you talking about updating the closest players/NPCs first an so on? That’s beyond th..." />
<meta property="article:published_time" content="2011-03-03T16:20:55+00:00" />
<meta property="og:ignore_canonical" content="true" />

      <link rel="prev" href="378459.html">


    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="378459.html">Improving the Performance of Hyperion</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/headlights.html'><span itemprop='name'>headlights</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2011-03-03T16:20:55Z'>
            <time itemprop='dateModified' datetime='2016-08-01T07:55:05Z' class='post-time'>
              August 1, 2016,  7:55am
            </time>
        <span itemprop='position'>#21</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“filthjr, post:20, topic:378459”][quote author=headlights link=topic=474324.msg3517281#msg3517281 date=1299104859]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="../../letter_avatar/filth/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> filth:</div>
<blockquote>
<p>player/npc updating requires order</p>
</blockquote>
</aside>
<p>and how does that getIndex method work? would it return -1 if it doesn’t have an index? or an invalid index (i.e. 0 when there is a different object at 0), wouldn’t it make more sense to check if the object at that index equals the object you’re comparing it to?</p>
</blockquote>
</aside>
<p>When you say “order”, are you talking about updating the closest players/NPCs first an so on? That’s beyond the scope of this tutorial. I wouldn’t say it’s “required”, although I suppose it can turn into an issue if the amount of players in a given region is too high.</p>
<p>An entity’s index is only ever set by the EntityList implementation, so what you’re saying is not necessary. Unless someone sets the entity’s index from the “outside” (encapsulation issue), it will always be equal to its index in the EntityList array.<br>
[/quote]</p>
<p>no, the way the client identifies which entity is being updated is by retaining the same order each time you are doing entity updating, so if you have an unordered set, it will frequently update the wrong entities.</p>
<p>and the problem for your first improvement is that indexes are reused so while the player with index 1 might no longer be logged in, the index 1 could have been reused meaning that it is no longer null (which is what you check for).</p>
<p>just compare objects instead of comparing that object in the specified index to null[/quote]<br>
Oh, I see what you’re saying now. I’ll update my original post. Those who applied the improvements before should update as well.</p>
<p>To summarize, this is the new contains() implementation:</p>
<pre><code class="lang-auto">@Override
public boolean contains(Object arg0) {
        Entity entity = (Entity) arg0;
        return entities[entity.getIndex()] == entity;
}</code></pre>
<p>Also, instead of using a HashSet, I advise you guys to use a LinkedHashSet.</p>
      </div>

      <meta itemprop='headline' content='Improving the Performance of Hyperion'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sspoke.html'><span itemprop='name'>sspoke</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-11T01:42:45Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:47:28Z' class='post-time'>
              August 4, 2016, 10:47am
            </time>
        <span itemprop='position'>#22</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Wouldn’t</p>
<pre><code class="lang-auto"> return entities[entity.getIndex()] == entity;</code></pre>
<p>Crash if entity.getIndex() returns a number bigger then entities array or -1 number</p>
<pre><code class="lang-auto">return entities[-1] == entity </code></pre>
<p>will crash <img src="../../images/emoji/twitter/stuck_out_tongueae52.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
      </div>

      <meta itemprop='headline' content='Improving the Performance of Hyperion'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/ExtremeX-Scape.html'><span itemprop='name'>ExtremeX-Scape</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-10-11T02:01:39Z'>
            <time itemprop='dateModified' datetime='2016-08-04T10:47:28Z' class='post-time'>
              August 4, 2016, 10:47am
            </time>
        <span itemprop='position'>#23</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“sspoke, post:22, topic:378459”]Wouldn’t</p>
<pre><code class="lang-auto"> return entities[entity.getIndex()] == entity;</code></pre>
<p>Crash if entity.getIndex() returns a number bigger then entities array or -1 number</p>
<pre><code class="lang-auto">return entities[-1] == entity </code></pre>
<p>will crash :P[/quote]</p>
<p>Will not happen, take a look at the EnityList implementation;</p>
<p><code>
		if (index == -1) {
			return false;
		}
		entities[index] = entity;
		entity.setIndex(index + 1);</code></p>
<p>and</p>
<p><code>
	/**
	 * Creates a new entity list with the specified capacity.
	 * 
	 * @param capacity
	 *            The maximum number of entities that can be present in the
	 *            repository.
	 */
	public EntityList(int capacity) {
		this.entities = new Entity[capacity];
	}</code></p>
<p>There is no default capacity, the capacity must be set upon construction, unless modified by someone stupid, you will not get a IOOBE.</p>
      </div>

      <meta itemprop='headline' content='Improving the Performance of Hyperion'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>

  <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
      <span itemprop='name'><a rel="prev" itemprop="url" href="378459.html">← previous page</a></span>
  </div>





    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/improving-the-performance-of-hyperion/378459?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Aug 2019 12:37:10 GMT -->
</html>
