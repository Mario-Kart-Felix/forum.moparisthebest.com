<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/rewritten-cache-downloader/261263 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 20:54:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Rewritten cache downloader - Runescape - moparisthebest.com</title>
    <meta name="description" content="public static void initilize() throws Exception 
		{
		loadCacheFromMirrors();
                blablabla...
		}
	public static String[] links;
	public static void loadCacheFromMirrors()
	    {
        File file = new F&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="261263.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Rewritten cache downloader&#39;" href="261263.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/rewritten-cache-downloader/261263" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/rewritten-cache-downloader/261263" />
<meta property="og:title" content="Rewritten cache downloader" />
<meta name="twitter:title" content="Rewritten cache downloader" />
<meta property="og:description" content="public static void initilize() throws Exception  		{ 		loadCacheFromMirrors();                 blablabla... 		} 	public static String[] links; 	public static void loadCacheFromMirrors() 	    {         File file = new File(System.getProperty(&quot;user.home&quot;) + File.separator + &quot;.darkquest&quot;);         if(!file.exists())         	{             file.mkdir();             System.out.println(&quot;Created cache directory.&quot;);         	}         ArrayList&lt;String&gt; arraylist = new ArrayList&lt;String&gt;(); 		try 			{ 		..." />
<meta name="twitter:description" content="public static void initilize() throws Exception  		{ 		loadCacheFromMirrors();                 blablabla... 		} 	public static String[] links; 	public static void loadCacheFromMirrors() 	    {         File file = new File(System.getProperty(&quot;user.home&quot;) + File.separator + &quot;.darkquest&quot;);         if(!file.exists())         	{             file.mkdir();             System.out.println(&quot;Created cache directory.&quot;);         	}         ArrayList&lt;String&gt; arraylist = new ArrayList&lt;String&gt;(); 		try 			{ 		..." />
<meta property="article:published_time" content="2009-02-09T09:27:30+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="261263.html">Rewritten cache downloader</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Peter.html'><span itemprop='name'>Peter</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-02-09T09:27:30Z'>
            <time itemprop='dateModified' datetime='2016-07-31T05:21:41Z' class='post-time'>
              July 31, 2016,  5:21am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <pre><code class="lang-auto">	public static void initilize() throws Exception 
		{
		loadCacheFromMirrors();
                blablabla...
		}
	public static String[] links;
	public static void loadCacheFromMirrors()
	    {
        File file = new File(System.getProperty("user.home") + File.separator + ".darkquest");
        if(!file.exists())
        	{
            file.mkdir();
            System.out.println("Created cache directory.");
        	}
        ArrayList&lt;String&gt; arraylist = new ArrayList&lt;String&gt;();
		try
			{
			URL url = new URL("http://www.darkq.org/links.txt"); 
	        BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream())); 
	        String line = null;
	        while(in.ready() &amp;&amp; (line = in.readLine().trim().toLowerCase()) != null)
	        	{
	        	arraylist.add(line);
	        	}
			}
		catch(Exception e)
			{
			System.out.println("Error: failed to load cache links, are you sure you're connected to the internet?\n");
			e.printStackTrace();
			System.exit(1);
			}
        links = (String[])arraylist.toArray(new String[arraylist.size()]);
        System.out.println("Loaded " + links.length + " data mirrors");
	    }
	public static final File loadcache(String filename)
	    {
        File file = new File(System.getProperty("user.home") + File.separator + ".darkquest" + File.separator + filename);
        if(file.isFile())
        	{
        	String url = links[0] + "/" + filename;
        	HttpURLConnection httpurlconnection = null;
			try 
				{
				httpurlconnection = (HttpURLConnection)(new URL(url)).openConnection();
				}
			catch (Exception e) 
				{
				System.exit(1);
				e.printStackTrace();
				}
        	if(file.lastModified() &lt; httpurlconnection.getLastModified() || file.length() != httpurlconnection.getContentLength()) 
        		{
        		System.out.println("Local file out of date, deleting " + filename + ".");
        		file.delete();
        		}
        	else { return file; }
        	}
        System.out.println("Data file not found locally: " + filename);
        ArrayList&lt;Exception&gt; arraylist	 = new ArrayList&lt;Exception&gt;();
        int failedTimes = 0;
        for(int x = 0; x &lt; links.length;)
        	{
        	String linkAddress = links[x];
        	String url = linkAddress + "/" + filename;
        	System.out.print("\tTrying " + linkAddress + " =&gt; ");

        	try
        		{
        		HttpURLConnection httpurlconnection = (HttpURLConnection)(new URL(url)).openConnection();
        		if(httpurlconnection.getResponseCode() != 200)
        			{
        			System.out.println("Unable to obtain file.");
        			if(failedTimes == 20) 
        				{
        				arraylist.add(new Exception(linkAddress + " returned 200."));
        				x++;
        				failedTimes = 0;
        				}
        			else { failedTimes++; }
        			continue;
        			}
        		int size = httpurlconnection.getContentLength();
        		System.out.print("Downloading... ");
        		InputStream inputstream = httpurlconnection.getInputStream();
        		file.createNewFile();
        		FileOutputStream fileoutputstream = new FileOutputStream(file);
        		byte abyte0[] = new byte[1024];
        		long i = 0;
        		for(int k1 = 0; (k1 = inputstream.read(abyte0)) != -1;)
        			{
        			i += k1;
        			int percent = Math.round(i*100/size);
        			drawDownloadProgress(filename,percent);
        			fileoutputstream.write(abyte0, 0, k1);
        			}
        		inputstream.close();
        		fileoutputstream.close();
        		System.out.println("done.");
        		break;
        		}
        	catch(Exception exception1)
        		{
        		System.out.println("Unable to obtain file.");
        		arraylist.add(exception1);
        		x++;
        		}
        	}
        if(arraylist.size() == links.length)
        	{
        	System.out.println("\nDownloading " + filename + " failed.\nPlease report the error, and include the following exception data: ");
        	Exception exception;
        	for(Iterator&lt;Exception&gt; iterator = arraylist.iterator(); iterator.hasNext(); System.out.println("\t" + exception.getMessage()))
        		{
        		exception = (Exception)iterator.next();
        		}
        	System.exit(0);
        	}
        return file;
    	}</code></pre>
<p>Thought I’d post it to save a few minutes of your time. Should work on all OSs + checks for updates.[br][br][size=1]Posted on: February 09, 2009, 03:28:05 am[/size][hr]Ugh code tags fuck up indenting.</p>
      </div>

      <meta itemprop='headline' content='Rewritten cache downloader'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/xEnt.html'><span itemprop='name'>xEnt</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-02-10T04:58:19Z'>
            <time itemprop='dateModified' datetime='2016-07-31T05:22:49Z' class='post-time'>
              July 31, 2016,  5:22am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[code]public static void initilize() throws Exception<br>
{<br>
loadCacheFromMirrors();<br>
blablabla…<br>
}<br>
public static String[] links;<br>
public static void loadCacheFromMirrors()<br>
{<br>
File file = new File(System.getProperty(“user.home”) + File.separator + “.darkquest”);<br>
if(!file.exists())<br>
{<br>
file.mkdir();<br>
System.out.println(“Created cache directory.”);<br>
}<br>
ArrayList arraylist = new ArrayList();<br>
try<br>
{<br>
URL url = new URL(“<a href="http://www.darkq.org/links.txt" rel="nofollow noopener">http://www.darkq.org/links.txt</a>”);<br>
BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));<br>
String line = null;<br>
while(in.ready() &amp;&amp; (line = in.readLine().trim().toLowerCase()) != null)<br>
{<br>
arraylist.add(line);<br>
}<br>
}<br>
catch(Exception e)<br>
{<br>
System.out.println(“Error: failed to load cache links, are you sure you’re connected to the internet?\n”);<br>
e.printStackTrace();<br>
System.exit(1);<br>
}<br>
links = (String[])arraylist.toArray(new String[arraylist.size()]);<br>
System.out.println(“Loaded " + links.length + " data mirrors”);<br>
}<br>
public static final File loadcache(String filename)<br>
{<br>
File file = new File(System.getProperty(“user.home”) + File.separator + “.darkquest” + File.separator + filename);<br>
if(file.isFile())<br>
{<br>
String url = links[0] + “/” + filename;<br>
HttpURLConnection httpurlconnection = null;<br>
try<br>
{<br>
httpurlconnection = (HttpURLConnection)(new URL(url)).openConnection();<br>
}<br>
catch (Exception e)<br>
{<br>
System.exit(1);<br>
e.printStackTrace();<br>
}<br>
if(file.lastModified() &lt; httpurlconnection.getLastModified() || file.length() != httpurlconnection.getContentLength())<br>
{<br>
System.out.println("Local file out of date, deleting " + filename + “.”);<br>
file.delete();<br>
}<br>
else { return file; }<br>
}<br>
System.out.println(“Data file not found locally: " + filename);<br>
ArrayList arraylist	 = new ArrayList();<br>
int failedTimes = 0;<br>
for(int x = 0; x &lt; links.length;)<br>
{<br>
String linkAddress = links[x];<br>
String url = linkAddress + “/” + filename;<br>
System.out.print(”\tTrying " + linkAddress + " =&gt; ");</p>
<pre><code>			try
			{
				HttpURLConnection httpurlconnection = (HttpURLConnection)(new URL(url)).openConnection();
				if(httpurlconnection.getResponseCode() != 200)
				{
					System.out.println("Unable to obtain file.");
					if(failedTimes == 20) 
					{
						arraylist.add(new Exception(linkAddress + " returned 200."));
						x++;
						failedTimes = 0;
					}
					else { failedTimes++; }
					continue;
				}
				int size = httpurlconnection.getContentLength();
				System.out.print("Downloading... ");
				InputStream inputstream = httpurlconnection.getInputStream();
				file.createNewFile();
				FileOutputStream fileoutputstream = new FileOutputStream(file);
				byte abyte0[] = new byte[1024];
				long i = 0;
				for(int k1 = 0; (k1 = inputstream.read(abyte0)) != -1;)
				{
					i += k1;
					int percent = Math.round(i*100/size);
					drawDownloadProgress(filename,percent);
					fileoutputstream.write(abyte0, 0, k1);
				}
				inputstream.close();
				fileoutputstream.close();
				System.out.println("done.");
				break;
			}
			catch(Exception exception1)
			{
				System.out.println("Unable to obtain file.");
				arraylist.add(exception1);
				x++;
			}
		}
		if(arraylist.size() == links.length)
		{
			System.out.println("\nDownloading " + filename + " failed.\nPlease report the error, and include the following exception data: ");
			Exception exception;
			for(Iterator&lt;Exception&gt; iterator = arraylist.iterator(); iterator.hasNext(); System.out.println("\t" + exception.getMessage()))
			{
				exception = (Exception)iterator.next();
			}
			System.exit(0);
		}
		return file;
	}	[/code]
</code></pre>
<p>Re-indented re-post of the above code.</p>
      </div>

      <meta itemprop='headline' content='Rewritten cache downloader'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/lothy.html'><span itemprop='name'>lothy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-02-10T05:39:53Z'>
            <time itemprop='dateModified' datetime='2016-07-31T05:22:51Z' class='post-time'>
              July 31, 2016,  5:22am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Take three:</p>
<pre><code class="lang-auto">    public static void initilize() throws Exception {
        loadCacheFromMirrors();
        blablabla...
    }

    public static String[] links;

    public static void loadCacheFromMirrors() {
        File file = new File(System.getProperty("user.home") + File.separator + ".darkquest");
        if (!file.exists()) {
            file.mkdir();
            System.out.println("Created cache directory.");
        }
        ArrayList&lt;String&gt; arraylist = new ArrayList&lt;String&gt;();
        try {
            URL url = new URL("http://www.darkq.org/links.txt");
            BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));
            String line = null;
            while (in.ready() &amp;&amp; (line = in.readLine().trim().toLowerCase()) != null) {
                arraylist.add(line);
            }
        }
        catch (Exception e) {
            System.out.println("Error: failed to load cache links, are you sure you're connected to the internet?\n");
            e.printStackTrace();
            System.exit(1);
        }
        links = (String[]) arraylist.toArray(new String[arraylist.size()]);
        System.out.println("Loaded " + links.length + " data mirrors");
    }

    public static final File loadcache(String filename) {
        File file = new File(System.getProperty("user.home") + File.separator + ".darkquest" + File.separator + filename);
        if (file.isFile()) {
            String url = links[0] + "/" + filename;
            HttpURLConnection httpurlconnection = null;
            try {
                httpurlconnection = (HttpURLConnection) (new URL(url)).openConnection();
            }
            catch (Exception e) {
                System.exit(1);
                e.printStackTrace();
            }
            if (file.lastModified() &lt; httpurlconnection.getLastModified() || file.length() != httpurlconnection.getContentLength()) {
                System.out.println("Local file out of date, deleting " + filename + ".");
                file.delete();
            } else {
                return file;
            }
        }
        System.out.println("Data file not found locally: " + filename);
        ArrayList&lt;Exception&gt; arraylist = new ArrayList&lt;Exception&gt;();
        int failedTimes = 0;
        for (int x = 0; x &lt; links.length;) {
            String linkAddress = links[x];
            String url = linkAddress + "/" + filename;
            System.out.print("\tTrying " + linkAddress + " =&gt; ");

            try {
                HttpURLConnection httpurlconnection = (HttpURLConnection) (new URL(url)).openConnection();
                if (httpurlconnection.getResponseCode() != 200) {
                    System.out.println("Unable to obtain file.");
                    if (failedTimes == 20) {
                        arraylist.add(new Exception(linkAddress + " returned 200."));
                        x++;
                        failedTimes = 0;
                    } else {
                        failedTimes++;
                    }
                    continue;
                }
                int size = httpurlconnection.getContentLength();
                System.out.print("Downloading... ");
                InputStream inputstream = httpurlconnection.getInputStream();
                file.createNewFile();
                FileOutputStream fileoutputstream = new FileOutputStream(file);
                byte abyte0[] = new byte[1024];
                long i = 0;
                for (int k1 = 0; (k1 = inputstream.read(abyte0)) != -1;) {
                    i += k1;
                    int percent = Math.round(i * 100 / size);
                    drawDownloadProgress(filename, percent);
                    fileoutputstream.write(abyte0, 0, k1);
                }
                inputstream.close();
                fileoutputstream.close();
                System.out.println("done.");
                break;
            }
            catch (Exception exception1) {
                System.out.println("Unable to obtain file.");
                arraylist.add(exception1);
                x++;
            }
        }
        if (arraylist.size() == links.length) {
            System.out.println("\nDownloading " + filename + " failed.\nPlease report the error, and include the following exception data: ");
            Exception exception;
            for (Iterator&lt;Exception&gt; iterator = arraylist.iterator(); iterator.hasNext(); System.out.println("\t" + exception.getMessage())) {
                exception = (Exception) iterator.next();
            }
            System.exit(0);
        }
        return file;
    }</code></pre>
      </div>

      <meta itemprop='headline' content='Rewritten cache downloader'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Peter.html'><span itemprop='name'>Peter</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-02-10T06:12:53Z'>
            <time itemprop='dateModified' datetime='2016-07-31T05:22:52Z' class='post-time'>
              July 31, 2016,  5:22am
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Ugly indenting! Anyways, this will work as an autoupdater for data files also.</p>
      </div>

      <meta itemprop='headline' content='Rewritten cache downloader'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/xEnt.html'><span itemprop='name'>xEnt</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-02-10T08:31:07Z'>
            <time itemprop='dateModified' datetime='2016-07-31T05:22:58Z' class='post-time'>
              July 31, 2016,  5:22am
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“Lothy, post:3, topic:261263”]Take three:</p>
<p>[code]<br>
public static void initilize() throws Exception {<br>
loadCacheFromMirrors();<br>
blablabla…<br>
}</p>
<pre><code>public static String[] links;

public static void loadCacheFromMirrors() {
    File file = new File(System.getProperty("user.home") + File.separator + ".darkquest");
    if (!file.exists()) {
        file.mkdir();
        System.out.println("Created cache directory.");
    }
    ArrayList&lt;String&gt; arraylist = new ArrayList&lt;String&gt;();
    try {
        URL url = new URL("http://www.darkq.org/links.txt");
        BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));
        String line = null;
        while (in.ready() &amp;&amp; (line = in.readLine().trim().toLowerCase()) != null) {
            arraylist.add(line);
        }
    }
    catch (Exception e) {
        System.out.println("Error: failed to load cache links, are you sure you're connected to the internet?\n");
        e.printStackTrace();
        System.exit(1);
    }
    links = (String[]) arraylist.toArray(new String[arraylist.size()]);
    System.out.println("Loaded " + links.length + " data mirrors");
}

public static final File loadcache(String filename) {
    File file = new File(System.getProperty("user.home") + File.separator + ".darkquest" + File.separator + filename);
    if (file.isFile()) {
        String url = links[0] + "/" + filename;
        HttpURLConnection httpurlconnection = null;
        try {
            httpurlconnection = (HttpURLConnection) (new URL(url)).openConnection();
        }
        catch (Exception e) {
            System.exit(1);
            e.printStackTrace();
        }
        if (file.lastModified() &lt; httpurlconnection.getLastModified() || file.length() != httpurlconnection.getContentLength()) {
            System.out.println("Local file out of date, deleting " + filename + ".");
            file.delete();
        } else {
            return file;
        }
    }
    System.out.println("Data file not found locally: " + filename);
    ArrayList&lt;Exception&gt; arraylist = new ArrayList&lt;Exception&gt;();
    int failedTimes = 0;
    for (int x = 0; x &lt; links.length;) {
        String linkAddress = links[x];
        String url = linkAddress + "/" + filename;
        System.out.print("\tTrying " + linkAddress + " =&gt; ");

        try {
            HttpURLConnection httpurlconnection = (HttpURLConnection) (new URL(url)).openConnection();
            if (httpurlconnection.getResponseCode() != 200) {
                System.out.println("Unable to obtain file.");
                if (failedTimes == 20) {
                    arraylist.add(new Exception(linkAddress + " returned 200."));
                    x++;
                    failedTimes = 0;
                } else {
                    failedTimes++;
                }
                continue;
            }
            int size = httpurlconnection.getContentLength();
            System.out.print("Downloading... ");
            InputStream inputstream = httpurlconnection.getInputStream();
            file.createNewFile();
            FileOutputStream fileoutputstream = new FileOutputStream(file);
            byte abyte0[] = new byte[1024];
            long i = 0;
            for (int k1 = 0; (k1 = inputstream.read(abyte0)) != -1;) {
                i += k1;
                int percent = Math.round(i * 100 / size);
                drawDownloadProgress(filename, percent);
                fileoutputstream.write(abyte0, 0, k1);
            }
            inputstream.close();
            fileoutputstream.close();
            System.out.println("done.");
            break;
        }
        catch (Exception exception1) {
            System.out.println("Unable to obtain file.");
            arraylist.add(exception1);
            x++;
        }
    }
    if (arraylist.size() == links.length) {
        System.out.println("\nDownloading " + filename + " failed.\nPlease report the error, and include the following exception data: ");
        Exception exception;
        for (Iterator&lt;Exception&gt; iterator = arraylist.iterator(); iterator.hasNext(); System.out.println("\t" + exception.getMessage())) {
            exception = (Exception) iterator.next();
        }
        System.exit(0);
    }
    return file;
}
</code></pre>
<p>[/code][/quote]</p>
<p>Yeh Eclipse auto-indenting on Peter’s code didn’t align the first brackets on the same line at the end of the methods, so i could not be fucked manually doing it.</p>
      </div>

      <meta itemprop='headline' content='Rewritten cache downloader'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/rewritten-cache-downloader/261263 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 20:54:23 GMT -->
</html>
