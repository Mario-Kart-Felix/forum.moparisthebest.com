<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/pi-player-saving-loop/552100 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>PI Player Saving Loop - Runescape - moparisthebest.com</title>
    <meta name="description" content="So I&amp;#39;ve been looking around and I&amp;#39;ve been experiencing some rollback problems on a PI source I&amp;#39;ve been messing around with. Players will randomly disconnect (which I believe is due to their connection, not the server) an&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="552100.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;PI Player Saving Loop&#39;" href="552100.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/pi-player-saving-loop/552100" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/pi-player-saving-loop/552100" />
<meta property="og:title" content="PI Player Saving Loop" />
<meta name="twitter:title" content="PI Player Saving Loop" />
<meta property="og:description" content="So I’ve been looking around and I’ve been experiencing some rollback problems on a PI source I’ve been messing around with. Players will randomly disconnect (which I believe is due to their connection, not the server) and lose all of their progress they made since the last login (the last time their player file was saved). I need some help in creating something that automatically saves player’s progress so that when they disconnect randomly, no progress is lost. I’ve hesitated to make a loop tha..." />
<meta name="twitter:description" content="So I’ve been looking around and I’ve been experiencing some rollback problems on a PI source I’ve been messing around with. Players will randomly disconnect (which I believe is due to their connection, not the server) and lose all of their progress they made since the last login (the last time their player file was saved). I need some help in creating something that automatically saves player’s progress so that when they disconnect randomly, no progress is lost. I’ve hesitated to make a loop tha..." />
<meta property="article:published_time" content="2015-06-21T17:18:38+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="552100.html">PI Player Saving Loop</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/HairyNips.html'><span itemprop='name'>HairyNips</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-21T17:18:38Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:44Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>So I’ve been looking around and I’ve been experiencing some rollback problems on a PI source I’ve been messing around with. Players will randomly disconnect (which I believe is due to their connection, not the server) and lose all of their progress they made since the last login (the last time their player file was saved). I need some help in creating something that automatically saves player’s progress so that when they disconnect randomly, no progress is lost. I’ve hesitated to make a loop that saves every so often, because I’ve read that it is extremely laggy.</p>
      </div>

      <meta itemprop='headline' content='PI Player Saving Loop'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sk8rdude461.html'><span itemprop='name'>sk8rdude461</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-21T18:40:51Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:45Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Save the player when they disconnect.</p>
<p>In your ConnectionHandler.java you should have a method called sessionClosed.<br>
You want to save the player there. Because no matter what happens, that method is called.</p>
<p>Player hits the X on their client, forcing the client closed &gt; The session is closed and the player saves.<br>
Player hits the logout button &gt; The logout method is called, the player is saved, then the session is closed.<br>
Player’s internet connection drops &gt; The session closes and the player is saved.<br>
The VPS somehow loses internet &gt; All sessions are closed, all accounts save.</p>
      </div>

      <meta itemprop='headline' content='PI Player Saving Loop'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/bowserjr2.html'><span itemprop='name'>bowserjr2</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-21T18:49:27Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:45Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>And of course full saves of all the players once in a while in case of crashes.</p>
      </div>

      <meta itemprop='headline' content='PI Player Saving Loop'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/HairyNips.html'><span itemprop='name'>HairyNips</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-21T19:26:11Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:45Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p><code>public void sessionClosed(IoSession arg0) throws Exception {
		if(arg0.getAttachment() != null) {
			Player plr = (Player) arg0.getAttachment();
			plr.disconnected = true;
			PlayerSave.saveGame(c);
		}
		HostList.getHostList().remove(arg0);
	}</code></p>
<p>So I added that to my sessionclosed method but I’m getting this error.</p>
<p><code>src\com\exile\net\ConnectionHandler.java:38: error: cannot find symbol
                        PlayerSave.saveGame(c);
                                            ^
  symbol:   variable c
  location: class ConnectionHandler
Note: src\com\exile\EconomyReset.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
Note: src\com\exile\mananger\Manager.java uses unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
1 error
Press any key to continue . . .</code></p>
<p>Can you help me fix this, I’ve tried several different ways of implementing it and each throws an error.</p>
<p>This is the savegame method</p>
<p>[code]public static boolean saveGame(Player p) {<br>
if (PlayerHandler.players[p.playerId] == null || p.playerName == null ) {<br>
System.out.println(PlayerHandler.players[p.playerId]+" "+p.playerName);<br>
return false;<br>
}<br>
if (!p.getVariables().saveFile || p.getVariables().newPlayer || !p.getVariables().saveCharacter) {<br>
System.out.println(“ugh… 2”);<br>
return false;<br>
}<br>
p.playerName = p.playerName2;<br>
int tbTime = (int) (p.getVariables().teleBlockDelay - System.currentTimeMillis() + p.getVariables().teleBlockLength);<br>
if (tbTime &gt; 300000 || tbTime &lt; 0) {<br>
tbTime = 0;<br>
}</p>
<pre><code>	BufferedWriter characterfile = null;
	try {
		characterfile = new BufferedWriter(new FileWriter(
				(GameEngine.isVps() ? "C:/Users/Administrator/Desktop/characters/" : "./Data/characters/") + p.playerName + ".txt"));

		/* ACCOUNT */
		characterfile.write("[ACCOUNT]", 0, 9);
		characterfile.newLine();
		characterfile.write("character-username = ", 0, 21);
		characterfile.write(p.playerName, 0, p.playerName.length());
		characterfile.newLine();
		characterfile.write("character-password = ", 0, 21);
		characterfile.write(Misc.md5Hash(p.playerPass+p.playerName+(p.playerName.length()*p.playerPass.length()))
				, 0, Misc.md5Hash(p.playerPass+p.playerName+(p.playerName.length()*p.playerPass.length())).length());
		characterfile.newLine();
		characterfile.newLine();

		/* CHARACTER */
		characterfile.write("[CHARACTER]", 0, 11);
		characterfile.newLine();
		characterfile.write("character-height = ", 0, 19);
		characterfile.write(Integer.toString(p.heightLevel), 0, Integer
				.toString(p.heightLevel).length());
		characterfile.newLine();
		characterfile.write("character-posx = ", 0, 17);
		characterfile.write(Integer.toString(p.absX), 0,
				Integer.toString(p.absX).length());
		characterfile.newLine();
		characterfile.write("character-posy = ", 0, 17);
		characterfile.write(Integer.toString(p.absY), 0,
				Integer.toString(p.absY).length());
		characterfile.newLine();
		characterfile.write("character-rights = ", 0, 19);
		characterfile.write(Integer.toString(p.getVariables().playerRights), 0, Integer
				.toString(p.getVariables().playerRights).length());
		characterfile.newLine();
		characterfile.write("Donator = ", 0, 10);
		characterfile.write(Integer.toString(p.getVariables().isDonator), 0, Integer
				.toString(p.getVariables().isDonator).length());
		characterfile.newLine();
		characterfile.write("character-title = ", 0, 18);
		characterfile.write(Integer.toString(p.getVariables().playerTitle), 0, Integer
				.toString(p.getVariables().playerTitle).length());
		characterfile.newLine();
		characterfile.write("expLock = ", 0, 10);
		characterfile.write(Boolean.toString(p.getVariables().expLock), 0, Boolean
				.toString(p.getVariables().expLock).length());
		characterfile.newLine();
		characterfile.write("totalxp = ", 0, 9);
		characterfile.write(Integer.toString(p.getVariables().totalxp), 0 , Integer
				.toString(p.getVariables().totalxp).length());
		characterfile.newLine();
		characterfile.write("crystal-bow-shots = ", 0, 20);
		characterfile.write(Integer.toString(p.getVariables().crystalBowArrowCount), 0,
				Integer.toString(p.getVariables().crystalBowArrowCount).length());
		characterfile.newLine();
		characterfile.write("skull-timer = ", 0, 14);
		characterfile.write(Integer.toString(p.getVariables().skullTimer), 0, Integer
				.toString(p.getVariables().skullTimer).length());
		characterfile.newLine();
		characterfile.write("magic-book = ", 0, 13);
		characterfile.write(Integer.toString(p.getVariables().playerMagicBook), 0, Integer
				.toString(p.getVariables().playerMagicBook).length());
		characterfile.newLine();
		characterfile.write("prayer-book = ", 0, 14);
		characterfile.write(Boolean.toString(p.getVariables().playerPrayerBook), 0,
				Boolean.toString(p.getVariables().playerPrayerBook).length());
		characterfile.newLine();
		characterfile.write("isDonePicking = ", 0, 16);
		characterfile.write(Boolean.toString(p.getVariables().isDonePicking), 0, Boolean
				.toString(p.getVariables().isDonePicking).length());
		characterfile.newLine();
		characterfile.write("Picked = ", 0, 9);
		characterfile.write(Integer.toString(p.getVariables().Picked), 0, Integer
				.toString(p.getVariables().Picked).length());
		characterfile.newLine();
		characterfile.write("KC = ", 0, 5);
		characterfile.write(Integer.toString(p.getVariables().KC), 0,
				Integer.toString(p.getVariables().KC).length());
		characterfile.newLine();
		characterfile.write("DC = ", 0, 5);
		characterfile.write(Integer.toString(p.getVariables().DC), 0,
				Integer.toString(p.getVariables().DC).length());
		characterfile.newLine();
		characterfile.write("special-amount = ", 0, 17);
		characterfile.write(Double.toString(p.getVariables().specAmount), 0, Double
				.toString(p.getVariables().specAmount).length());
		characterfile.newLine();
		characterfile.write("selected-coffin = ", 0, 18);
		characterfile.write(Integer.toString(p.getVariables().randomCoffin), 0, Integer
				.toString(p.getVariables().randomCoffin).length());
		characterfile.newLine();
		characterfile.write("lastBrother = ", 0, 14);
		characterfile.write(Integer.toString(p.getVariables().lastBrother), 0, Integer
				.toString(p.getVariables().lastBrother).length());
		characterfile.newLine();
		characterfile.write("barrows-npc-dead = ", 0, 19);
		characterfile.write(p.getVariables().brotherKilled[0] + "\t"
				+ p.getVariables().brotherKilled[1] + "\t" + p.getVariables().brotherKilled[2] + "\t"
				+ p.getVariables().brotherKilled[3] + "\t" + p.getVariables().brotherKilled[4] + "\t"
				+ p.getVariables().brotherKilled[5]);
		characterfile.newLine();
		characterfile.write("teleblock-length = ", 0, 19);
		characterfile.write(Integer.toString(tbTime), 0,
				Integer.toString(tbTime).length());
		characterfile.newLine();
		characterfile.write("votingPoints = ", 0, 15);
		characterfile.write(Integer.toString(p.getVariables().votingPoints), 0, Integer
				.toString(p.getVariables().votingPoints).length());
		characterfile.newLine();
		characterfile.write("timesVoted = ", 0, 13);
		characterfile.write(Integer.toString(p.getVariables().timesVoted), 0, Integer
				.toString(p.getVariables().timesVoted).length());
		characterfile.newLine();
		characterfile.write("Amount-Donated = ", 0, 17);
		characterfile.write(Integer.toString(p.getVariables().amountDonated), 0, Integer
				.toString(p.getVariables().amountDonated).length());
		characterfile.newLine();
		characterfile.write("pc-points = ", 0, 12);
		characterfile.write(Integer.toString(p.getVariables().pcPoints), 0, Integer
				.toString(p.getVariables().pcPoints).length());
		characterfile.newLine();
		characterfile.write("SlayerPoints = ", 0, 15);
		characterfile.write(Integer.toString(p.getVariables().SlayerPoints), 0, Integer
				.toString(p.getVariables().SlayerPoints).length());
		characterfile.newLine();
		characterfile.write("DonatorPoints = ", 0, 16);
		characterfile.write(Integer.toString(p.getVariables().DonatorPoints), 0, Integer
				.toString(p.getVariables().DonatorPoints).length());
		characterfile.newLine();
		characterfile.write("splitChat = ", 0, 12);
		characterfile.write(Boolean.toString(p.splitChat), 0, Boolean
				.toString(p.splitChat).length());
		characterfile.newLine();
		if(p.getSlayer().getTask() != null) {
            characterfile.write("SLAY-TASK = ", 0, 12);
            characterfile.write(p.getSlayer().getTask().toString(), 0, p.getSlayer().getTask().toString().length());
            characterfile.write("\t", 0, 1);
            characterfile.write(Integer.toString(p.getSlayer().getTask().leftToKill()), 0, Integer.toString(p.getSlayer().getTask().leftToKill()).length());
        } else {
            characterfile.write("SLAY-TASK = ", 0, 12);
            characterfile.write("null", 0, 4);
            characterfile.write("\t", 0, 1);
            characterfile.write("0", 0, 1);
        }
		characterfile.newLine();
		characterfile.write("totalTasks = ", 0, 13);
		characterfile.write(Integer.toString(p.getVariables().totalTasks), 0, Integer
				.toString(p.getVariables().totalTasks).length());
		characterfile.newLine();
		characterfile.write("taskDifficulty = ", 0, 17);
		characterfile.write(Integer.toString(p.getVariables().taskDifficulty), 0, Integer
				.toString(p.getVariables().taskDifficulty).length());
		characterfile.newLine();
		characterfile.write("magePoints = ", 0, 13);
		characterfile.write(Integer.toString(p.getVariables().magePoints), 0, Integer
				.toString(p.getVariables().magePoints).length());
		characterfile.newLine();
		characterfile.write("autoRet = ", 0, 10);
		characterfile.write(Integer.toString(p.getVariables().autoRet), 0, Integer
				.toString(p.getVariables().autoRet).length());
		characterfile.newLine();
		characterfile.write("flagged = ", 0, 10);
		characterfile.write(Boolean.toString(p.getVariables().accountFlagged), 0, Boolean
				.toString(p.getVariables().accountFlagged).length());
		characterfile.newLine();
		characterfile.write("hasOverloadBoost = ", 0, 10);
		characterfile.write(Boolean.toString(p.getVariables().hasOverloadBoost), 0, Boolean
				.toString(p.getVariables().hasOverloadBoost).length());
		characterfile.newLine();
		characterfile.write("wave = ", 0, 7);
		characterfile.write(Integer.toString(p.getVariables().waveId), 0, Integer
				.toString(p.getVariables().waveId).length());
		characterfile.newLine();
		characterfile.write("gwkc = ", 0, 7);
		characterfile.write(Integer.toString(p.getVariables().killCount), 0, Integer
				.toString(p.getVariables().killCount).length());
		characterfile.newLine();
		characterfile.write("fightMode = ", 0, 12);
		characterfile.write(Integer.toString(p.getVariables().fightMode), 0, Integer
				.toString(p.getVariables().fightMode).length());
		characterfile.newLine();
		characterfile.write("PKP = ", 0, 6);
		characterfile.write(Integer.toString(p.getVariables().pkp), 0,
				Integer.toString(p.getVariables().pkp).length());
		characterfile.newLine();
		characterfile.write("yellTag = ", 0, 10);
		characterfile.write(p.getVariables().donorTag, 0, p.getVariables().donorTag.length());
		characterfile.newLine();
		characterfile.write("constitution = ", 0, 15);
		characterfile.write(Integer.toString(p.getVariables().constitution), 0, Integer
				.toString(p.getVariables().constitution).length());
		characterfile.newLine();
		characterfile.write("void = ", 0, 7);
		String toWrite = p.getVariables().voidStatus[0] + "\t" + p.getVariables().voidStatus[1] + "\t"
				+ p.getVariables().voidStatus[2] + "\t" + p.getVariables().voidStatus[3] + "\t"
				+ p.getVariables().voidStatus[4];
		characterfile.write(toWrite);
		characterfile.newLine();
		characterfile.write("savedClan = ", 0, 12);
		characterfile.write(p.getVariables().savedClan == null ? "null" : p.getVariables().savedClan, 0, p.getVariables().savedClan == null ? 4 : p.getVariables().savedClan.length());
		characterfile.newLine();
		characterfile.write("hasSavedClan = ", 0, 15);
		characterfile.write(Boolean.toString(p.getVariables().hasSavedClan), 0, Boolean
				.toString(p.getVariables().hasSavedClan).length());
		characterfile.newLine();
		characterfile.write("lootSharePotential = ", 0, 21);
		characterfile.write(Long.toString(p.getVariables().lootSharePotential), 0, Long
				.toString(p.getVariables().lootSharePotential).length());
		characterfile.newLine();
		characterfile.write("lastLootDate = ", 0, 15);
		characterfile.write(Long.toString(p.getVariables().lastLootDate), 0, Long
				.toString(p.getVariables().lastLootDate).length());
		characterfile.newLine();
		characterfile.write("vengeanceCasted = ", 0, 18);
		characterfile.write(Integer.toString(p.getVariables().castVengeance), 0, Integer
				.toString(p.getVariables().castVengeance).length());
		characterfile.newLine();
		characterfile.write("familiarSpecialEnergy = ", 0, 24);
		characterfile.write(
				Integer.toString(p.getSummoning().familiarSpecialEnergy),
				0, Integer.toString(p.getSummoning().familiarSpecialEnergy)
						.length());
		characterfile.newLine();
		characterfile.write("familiar = ", 0, 11);
		characterfile
				.write(Integer
						.toString(p.getSummoning().summonedFamiliar == null ? -1
								: p.getSummoning().summonedFamiliar.pouchId),
						0,
						Integer.toString(
								p.getSummoning().summonedFamiliar == null ? -1
										: p.getSummoning().summonedFamiliar.pouchId)
								.length());
		characterfile.newLine();
		characterfile.write("RockCrabKills = ", 0, 16);
		characterfile.write(Integer.toString(p.getVariables().rockCrabKills), 0, Integer
				.toString(p.getVariables().rockCrabKills).length());
		characterfile.newLine();
		characterfile.write("run-energy = ", 0, 13);
		characterfile.write(Integer.toString(p.getVariables().runEnergy), 0, Integer.toString(p.getVariables().runEnergy).length());
		characterfile.newLine();
		characterfile.newLine();
		
		characterfile.write("[GODWARS]");
		characterfile.newLine();
		for (int i = 0; i &lt; p.getVariables().gwKills.length; i++) {
			characterfile.write("godwars = ", 0, 10);
			characterfile.write(Integer.toString(i), 0, Integer.toString(i).length());
			characterfile.write("	", 0, 1);
			characterfile.write(Integer.toString(p.getVariables().gwKills[i]), 0, Integer.toString(p.getVariables().gwKills[i]).length());
			characterfile.newLine();
		}
		characterfile.newLine();

		/*QUICK-PRAYERS*/
		characterfile.write("[QUICKS]", 0, 8);
		characterfile.newLine();
		characterfile.write("quickCurses = ", 0, 14);
		String toWrite1 = "";
		for(int i1 = 0; i1 &lt; p.getVariables().quickCurses.length; i1++) {
			toWrite1 += p.getVariables().quickCurses[i1] +"\t";
		}
		characterfile.write(toWrite1);
		characterfile.newLine();
		characterfile.write("quickPrayers = ", 0, 15);
		String toWrite2 = "";
		for(int i1 = 0; i1 &lt; p.getVariables().quickPrayers.length; i1++) {
			toWrite2 += p.getVariables().quickPrayers[i1] +"\t";
		}
		characterfile.write(toWrite2);
		characterfile.newLine();
		characterfile.newLine();
		
		/* EQUIPMENT */
		characterfile.write("[EQUIPMENT]", 0, 11);
		characterfile.newLine();
		for (int i = 0; i &lt; p.getVariables().playerEquipment.length; i++) {
			characterfile.write("character-equip = ", 0, 18);
			characterfile.write(Integer.toString(i), 0, Integer.toString(i)
					.length());
			characterfile.write("	", 0, 1);
			characterfile.write(Integer.toString(p.getVariables().playerEquipment[i]), 0,
					Integer.toString(p.getVariables().playerEquipment[i]).length());
			characterfile.write("	", 0, 1);
			characterfile.write(Integer.toString(p.getVariables().playerEquipmentN[i]), 0,
					Integer.toString(p.getVariables().playerEquipmentN[i]).length());
			characterfile.write("	", 0, 1);
			characterfile.newLine();
		}
		characterfile.newLine();
		[/code]
</code></pre>
<p>Had to cut the last part of the code for limitations on amount of words.</p>
      </div>

      <meta itemprop='headline' content='PI Player Saving Loop'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sk8rdude461.html'><span itemprop='name'>sk8rdude461</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-21T19:36:31Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:46Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#5</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>The variable “c” does not exist in your ConnectionHandler class.</p>
<p>You cannot just add whatever random variable and assume it works… The variable needs to exist first.</p>
<p>Create a client object from the existing player object (Since client extends player)…</p>
<pre><code class="lang-auto"></code></pre>
      </div>

      <meta itemprop='headline' content='PI Player Saving Loop'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/HairyNips.html'><span itemprop='name'>HairyNips</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-21T19:54:54Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:46Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#6</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“sk8rdude461, post:5, topic:552100”]The variable “c” does not exist in your ConnectionHandler class.</p>
<p>You cannot just add whatever random variable and assume it works… The variable needs to exist first.</p>
<p>Create a client object from the existing player object (Since client extends player)…</p>
<pre><code class="lang-auto"></code></pre>
<p>So it would be this, sorry for not noticing that btw, lel.</p>
<p><code>public void sessionClosed(IoSession arg0) throws Exception {
		if(arg0.getAttachment() != null) {
			Player plr = (Player) arg0.getAttachment();
			plr.disconnected = true;
			PlayerSave.saveGame(plr);
		}</code></p>
      </div>

      <meta itemprop='headline' content='PI Player Saving Loop'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/sk8rdude461.html'><span itemprop='name'>sk8rdude461</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-21T20:10:54Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:47Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#7</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Yes that should work fine.</p>
      </div>

      <meta itemprop='headline' content='PI Player Saving Loop'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/HairyNips.html'><span itemprop='name'>HairyNips</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-21T20:20:03Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:13:47Z' class='post-time'>
              August 4, 2016,  3:13pm
            </time>
        <span itemprop='position'>#8</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Thanks for the help mate.</p>
      </div>

      <meta itemprop='headline' content='PI Player Saving Loop'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/matzie.html'><span itemprop='name'>matzie</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-25T22:49:28Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:14:20Z' class='post-time'>
              August 4, 2016,  3:14pm
            </time>
        <span itemprop='position'>#9</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>[quote=“HairyNips, post:6, topic:552100”][quote author=sk8rdude461 link=topic=671018.msg4487216#msg4487216 date=1434915391]<br>
The variable “c” does not exist in your ConnectionHandler class.</p>
<p>You cannot just add whatever random variable and assume it works… The variable needs to exist first.</p>
<p>Create a client object from the existing player object (Since client extends player)…</p>
<pre><code class="lang-auto"></code></pre>
<p>[/quote]</p>
<p>So it would be this, sorry for not noticing that btw, lel.</p>
<p><code>public void sessionClosed(IoSession arg0) throws Exception {
		if(arg0.getAttachment() != null) {
			Player plr = (Player) arg0.getAttachment();
			plr.disconnected = true;
			PlayerSave.saveGame(plr);
		}</code>[/quote]<br>
I do not know how a null player can disconnect from your server. This <span class="bbcode-i">should</span> not be needed if it was done correctly…</p>
<p>The most efficient way of doing this is make all of your player saves binary. Make everything have a set size. So when saving a file, you only have to update 4 bytes(typically). Not an entire file of plain-text. With this method you can save progress after every action with minimal drawbacks, handle the disk access in a background thread so that it does not hamper front end server performance.  Create a HashMap for constant lookup time of where to go in your save file to save/store information (and how many bytes it should write). This is the best way to prevent rollbacks. Careful if you modify your save order in the future, your hashmap with locations will need to be updated as well. (Also you will have to create a SavePorter, to convert it to the new format)</p>
<p>If you find your disk drive is unable to support this kind of procedure, consider using a database to store your information. They are good at efficient consecutive read/writes to disk.</p>
<p>Good luck <img src="../../images/emoji/twitter/winkae52.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
      </div>

      <meta itemprop='headline' content='PI Player Saving Loop'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Clawz_fury.html'><span itemprop='name'>Clawz_fury</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2015-06-26T01:15:16Z'>
            <time itemprop='dateModified' datetime='2016-08-04T15:14:22Z' class='post-time'>
              August 4, 2016,  3:14pm
            </time>
        <span itemprop='position'>#10</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>saving should be done asynchronously on a “utility” thread</p>
      </div>

      <meta itemprop='headline' content='PI Player Saving Loop'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/pi-player-saving-loop/552100 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:42 GMT -->
</html>
