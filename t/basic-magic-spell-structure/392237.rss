<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Basic Magic spell structure</title>
    <link>https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237</link>
    <description>This tutorial will teach you how to set up a basic magic spell structure - no content, but a structure to hold data and use it. This tutorial is more of a teaching tutorial, than &#39;adding a feature to your server&#39; tutorial.

[b]NOTE: In all classes that I provide in this tutorial, there will be imports and packages that won&#39;t be valid with your server (They are the imports and packages for my server), therefore you will have to either edit them yourself, or remove them. I&#39;ve left them in to show the package structure that I have for the magic skill structure.[/b]

The main feature of this structure is [b]Inheritance[/b]. This is when a class, or multiple classes, are derivatives of a single abstract class, and therefore they inherit the abstract class&#39;s methods and fields. This can prove [b]very[/b] useful when creating a big structure like the Magic skill, because there are many methods and fields that can be used by several different things.

Before I start, here&#39;s a diagram I created to show what is going on whilst you&#39;re using this structure:
[img]http://dl.dropbox.com/u/2505112/magic-structure.jpg[/img]

All the fields inherited in the image also have &#39;get()&#39; methods that are also inherited by the child classes.

[size=12pt][u][b]The parent spell[/b][/u][/size]

In Magic, we have our basic spell - every single spell share these pieces of data: Button id, required level, base experience, runes required.
The only exceptions to the above are the home teleport spells (They require no runes or level, and no experience is given), though I will exclude those in this tutorial due to the fact that they didn&#39;t exist in the 317 revision.

Here is our abstract class that we will use for the base spell:
[code=java]package org.iClarity.content.skills.magic.spells;

import org.iClarity.util.items.Item;

/**
 * Represents a spell.
 * @author PrimaDude.
 */
public abstract class Spell {
	
	private int id;
	private int levelRequired;
	private double baseExperience;
	private Item[] runesRequired;
	
	public int getId() {
		return id;
	}
	
	public int getLevelRequired() {
		return levelRequired;
	}
	
	public double getBaseExperience() {
		return baseExperience;
	}
	
	public Item[] getRunesRequired() {
		return runesRequired;
	}
	
	public Spell(int id, int levelRequired, int baseExperience, Item[] runesRequired) {
		this.id = id;
		this.levelRequired = levelRequired;
		this.baseExperience = baseExperience;
		this.runesRequired = runesRequired;
	}

}[/code]

All classes that extend this abstract class will inherit all it&#39;s public and protected fields/methods (In this case, the get() methods, since that&#39;s all we need to get the data).

Of course, we&#39;ll also need the [b]Item[/b] class, because we have an Item class array (Used to hold the rune requirements) in the Spell class:
[code=java]package org.iClarity.util.items;

/**
 * Represents an item.
 * @author PrimaDude.
 */
public class Item {
        
        private int id;
        private int amount;
        
        /**
         * Gets the id of the item.
         * @return The id variable.
         */
        public int getId() {
                return id;
        }
        
        /**
         * Gets the amount of the item.
         * @return The amount variable.
         */
        public int getAmount() {
                return amount;
        }
                
        /**
         * Constructs a new item.
         * @param id The id of the item.
         */
        public Item(int id) {
                this(id, 1);
        }
        
        /**
         * Constructs a new item.
         * @param id The id of the item.
         * @param amount The amount of the item.
         */
        public Item(int id, int amount) {
                if (amount &lt; 0) {
                        return;
                }
                this.id = id;
                this.amount = amount;
        }

        /**
         * Sets the id.
         * @param id The id.
         */
	public void setId(int id) {
		this.id = id;
	}

	/**
	 * Sets the amount.
	 * @param amount The amount.
	 */
	public void setAmount(int amount) {
		this.amount = amount;
	}

}[/code]

This class proves very useful when compared to your average Winterlove server. This class treats [b]every[/b] item as an Object (The object being an instance of this class for each item), rather than storing item Id&#39;s in one integer array and the item amounts in another integer array like most servers do.

[size=12pt][u][b]The child spells[/b][/u][/size]

Next we need to create the classes that will be extending the Spell class.

[size=10pt][u][b]Teleportation spells
[/b][/u][/size]
Firstly, we&#39;ll take a look at a class for Teleportation; the [b]TeleportationSpell[/b] class.
[code=java]package org.iClarity.content.skills.magic.spells.impl;

import org.iClarity.content.Teleport.TeleportType;
import org.iClarity.content.skills.magic.spells.Spell;
import org.iClarity.util.Position;
import org.iClarity.util.items.Item;

/**
 * Represents a teleportation spell.
 * @author PrimaDude.
 */
public class TeleportationSpell extends Spell {
	
	private Position position;
	private TeleportType teleportType;
	
	/**
	 * Gets the position.
	 * @return The position.
	 */
	public Position getPosition() {
		return position;
	}
	
	/**
	 * Gets the teleport type.
	 * @return The teleport type.
	 */
	public TeleportType getTeleportType() {
		return teleportType;
	}
	
	public TeleportationSpell(int id, int levelRequired, int baseExperience, Item[] runesRequired,
			Position position, TeleportType teleportType) {
		super(id, levelRequired, baseExperience, runesRequired);
		this.position = position;
		this.teleportType = teleportType;
	}

}[/code]

The graphic and animation fields are not included in this class because there are only two sets for all the teleports (The set for Modern magicks and the set for Ancient magicks).

This class contains two fields
1) The &#39;position&#39; field, which is an instance of the [b]Position[/b] class (which will follow below). The position instance contains the values for the x, y and height of the position that the teleport will move the player to.
2) The &#39;teleportType&#39; field. The &#39;[b]TeleportType[/b]&#39; type is an enum:
[code=java]	public enum TeleportType {
		MODERN_MAGICKS,
		ANCIENT_MAGICKS
	}[/code]
This field will determine what type of teleport the spell is. The type of teleport should change the graphic and animation displayed for the teleport (As the ancient magicks graphics and animation are different to the modern magicks ones).

The constructor of this class invokes the &#39;super&#39; constructor (The constructor of it&#39;s parent class, the Spell class), with the parameters that is within it&#39;s own constructor.

Here is the [b]Position[/b] class that is used in the [b]TeleportSpell[/b] class:
[code=java]package org.iClarity.util;

/**
 * Represents a position.
 * @author PrimaDude.
 */
public class Position {

	private int x;
	private int y;
	private int height;

	/**
	 * Creates a new Position with the specified coordinates. The height coordinate
	 * is set to 0.
	 * @param x The X coordinate.
	 * @param y The Y coordinate.
	 */
	public Position(int x, int y) {
		this(x, y, 0);
	}

	/**
	 * Creates a new Position with the specified coordinates.
	 * @param x The X coordinate.
	 * @param y The Y coordinate.
	 * @param height The height.
	 */
	public Position(int x, int y, int height) {
		this.setX(x);
		this.setY(y);
		this.setHeight(height);
	}

	/**
	 * Sets this position as the other position.
	 * @param other The other position.
	 */
	public void setAs(Position other) {
		this.x = other.x;
		this.y = other.y;
		this.height = other.height;
	}

	/**
	 * Sets the X coordinate.
	 * @param x The X coordinate.
	 */
	public void setX(int x) {
		this.x = x;
	}

	/**
	 * Gets the X coordinate.
	 * @return The X coordinate.
	 */
	public int getX() {
		return x;
	}

	/**
	 * Sets the Y coordinate.
	 * @param y The Y coordinate.
	 */
	public void setY(int y) {
		this.y = y;
	}

	/**
	 * Gets the Y coordinate.
	 * @return The Y coordinate.
	 */
	public int getY() {
		return y;
	}

	/**
	 * Sets the height coordinate.
	 * @param height The height coordinate.
	 */
	public void setHeight(int height) {
		this.height = height;
	}

	/**
	 * Gets the height coordinate.
	 * @return The height coordinate.
	 */
	public int getHeight() {
		return height;
	}

}[/code]

This is a basic class to store the values of a specified position, to save creating several more variables in multiple places (Which is inefficient when compared to using this class).

[size=10pt][u][b]Combat spells[/b][/u][/size]

Next, we have our [b]CombatSpell[/b] class:
[code=java]package org.iClarity.content.skills.magic.spells.impl;

import org.iClarity.content.skills.magic.spells.Spell;
import org.iClarity.content.skills.magic.spells.SpellProjectile;
import org.iClarity.util.items.Item;

/**
 * Represents a combat spell.
 * @author PrimaDude.
 */
public class CombatSpell extends Spell {
	
	private int animation;
	private int maximumDamage;
	private boolean freezingSpell;
	private SpellProjectile spellProjectile;
	
	/**
	 * Gets the animation.
	 * @return The animation.
	 */
	public int getAnimation() {
		return animation;
	}
	
	/**
	 * Gets the maximum damage.
	 * @return The maximum damage.
	 */
	public int getMaximumDamage() {
		return maximumDamage;
	}
	
	/**
	 * If the spell freezes the enemy.
	 * @return True or false.
	 */
	public boolean isFreezingSpell() {
		return freezingSpell;
	}
	
	/**
	 * Gets the spell projectile.
	 * @return The spell projectile.
	 */
	public SpellProjectile getSpellProjectile() {
		return spellProjectile;
	}

	/**
	 * Constructs a new CombatSpell.
	 * @param id The id of the spell.
	 * @param levelRequired The level required.
	 * @param baseExperience The base experience.
	 * @param runesRequired The runes required.
	 * @param animation The spell animation.
	 * @param maximumDamage The maximum damage.
	 * @param freezingSpell If the spell freezes the enemy.
	 * @param spellProjectile The spell projectile.
	 */
	public CombatSpell(int id, int levelRequired, int baseExperience, Item[] runesRequired,
			int animation, int maximumDamage, boolean freezingSpell, SpellProjectile spellProjectile) {
		super(id, levelRequired, baseExperience, runesRequired);
		this.animation = animation;
		this.maximumDamage = maximumDamage;
		this.freezingSpell = freezingSpell;
		this.spellProjectile = spellProjectile;
	}

}[/code]

Once again, the constructor of this class invokes the &#39;super&#39; constructor (The constructor of it&#39;s parent class, the Spell class), with the parameters that is within it&#39;s own constructor.

The fields within this class are simple to understand. I will however explain the &#39;spellProjectile&#39; field because it&#39;s an object of another class, the [b]SpellProjectile[/b] class:
[code=java]package org.iClarity.content.skills.magic.spells;

/**
 * Represents a spell projectile.
 * @author PrimaDude.
 */
public class SpellProjectile {
	
	private int castGraphic;
	private int projectileGraphic;
	private int collideGraphic;
	
	/**
	 * Gets the casting graphic.
	 * @return The cast graphic.
	 */
	public int getCastGraphic() {
		return castGraphic;
	}
	
	/**
	 * Gets the projectile graphic.
	 * @return The projectile graphic.
	 */
	public int getProjectileGraphic() {
		return projectileGraphic;
	}
	
	/**
	 * Gets the colliding graphic.
	 * @return The collide graphic.
	 */
	public int getCollideGraphic() {
		return collideGraphic;
	}

	/**
	 * Constructs a new SpellProjectile.
	 * @param castGraphic The casting graphic id.
	 * @param projectileGraphic The projectile graphic id.
	 * @param collideGraphic The colliding graphic id.
	 */
	public SpellProjectile(int castGraphic, int projectileGraphic, int collideGraphic) {
		this.castGraphic = castGraphic;
		this.projectileGraphic = projectileGraphic;
		this.collideGraphic = collideGraphic;
	}	

}[/code]

This class will hold the data for the casting, projectile and colliding graphics of a combat spell (Hence why there&#39;s an object of it in the [b]CombatSpell[/b] class).

[size=12pt][u][b]Storing the data in instances[/b][/u][/size]

There are several ways in which you can do this. You could either load it from a file or store it directly within a class in an array/list/enum etc.

Loading it from a file; there are hundreds of different methods of doing this. I, personally, store the data that I store in files in XML format, then load it via the server using XStream. For information about XStream, you could either visit their [url=http://xstream.codehaus.org/]website[/url], or look at some of my previous tutorials that use XStream, for example:
http://www.moparisthebest.com/smf/index.php/topic,446245.msg3274984.html#msg3274984
or
http://www.moparisthebest.com/smf/index.php/topic,470029.msg3436652.html#msg3436652

Here is an xml file storing my teleportation data, as an example: http://dl.dropbox.com/u/2505112/teleports.xml

Storing the data directly in a class is simple. If you were to use an enum, you would use something like this (This would be stored within a class):
[code=java]public static enum Teleports {
	
	VARROCK_TELEPORT(1164, new TeleportationSpell(1164, 25, 35,
		new Item[] {
			new Item(563, 1), new Item(556, 3), new Item(554, 1)
		}, new Position(3212, 3423), MODERN_MAGICKS); 

	private int buttonId;
	private TeleportSpell teleportSpell;

	Teleports(int buttonId, TeleportSpell teleportSpell) {
		this.buttonId = buttonId;
		this.teleportSpell = teleportSpell;
	}

}[/code]

That just has one teleport within it, just to show as an example.

[size=12pt][u][b]Using the data[/b][/u][/size]

Using the data is simple if you&#39;ve got it stored in a nice, tidy and efficient way. Let&#39;s look a the data stored in a Map, for example:
[code=java]public static Map&lt;Integer, TeleportationSpell&gt; teleportationSpells = new HashMap&lt;Integer, TeleportationSpell&gt;();[/code]

The integer in the map is the button id of the teleportation spell. This is used to get the &#39;TeleportationSpell&#39; instance from the map:
[code=java]TeleportationSpell teleportationSpell = teleportationSpells.get(buttonId);[/code]

From that instance, you can get all the data you need to perform a teleportation spell:
[code=java]int levelRequired = teleportationSpell.getLevelRequired();
int experience = teleportationSpell.getBaseExperience();
Item[] runeRequirements = teleportationSpell.getRunesRequired();
Position teleportPosition = teleportationSpell.getPosition();
TeleportType teleportType = teleportationSpell.getTeleportType();[/code]

______________________________________________________

To conclude the tutorial, I&#39;ll show you how I get the data and perform a teleportation spell. My MagicTeleport class:
[code=java]package org.iClarity.content.skills.magic;

import java.util.ArrayList;
import java.util.List;

import org.iClarity.Constants;
import org.iClarity.content.Teleport;
import org.iClarity.content.skills.magic.spells.Spells;
import org.iClarity.content.skills.magic.spells.impl.TeleportationSpell;
import org.iClarity.model.player.Player;
import org.iClarity.util.items.Item;

/**
 * Magic teleportation.
 * @author PrimaDude.
 */
public class MagicTeleport {
	
	/**
	 * Gets a RuneRequirement instance for the teleport.
	 * @param runes An array of the runes required.
	 * @return The RuneRequirement instance.
	 */
	private static RuneRequirement getRuneRequirements(Item[] runes) {
		List&lt;Item&gt; requirements = new ArrayList&lt;Item&gt;();
		for (Item rune : runes) {
			requirements.add(rune);			
		}
		return new RuneRequirement(requirements);
	}

	/**
	 * Initiates a teleportation spell.
	 * @param player The player.
	 * @param buttonId The button id.
	 */
	public static void teleport(Player player, int buttonId) {
		TeleportationSpell teleport = Spells.TELEPORTATION_SPELLS.get(buttonId);
		if (teleport == null) {
			return;
		}
		int level = teleport.getLevelRequired();
		RuneRequirement runeRequirement = getRuneRequirements(teleport.getRunesRequired());
		if (player.getSkills().get()[Constants.MAGIC].getLevel() &lt; level) {
			player.getActionSender().sendMessage(&quot;You need a magic level of &quot;+ level +&quot; to cast this spell.&quot;);
			return;
		} else if (!runeRequirement.hasRequirement(player)) {
			player.getActionSender().sendMessage(runeRequirement.getMessage());
			return;
		}
		player.getSkills().addSkillXP(player, Constants.MAGIC, teleport.getBaseExperience());
		for (Item item : runeRequirement.getRequirements()) {
			player.getInventory().get().remove(item.getId(), item.getAmount());
		}
		new Teleport(teleport.getPosition(), teleport.getTeleportType()).initiateTeleport(player);
	}
}[/code]

All I need to do with that, is wherever my buttons are managed, is invoke:
[code=java]MagicTeleport.teleport(player, buttonId);[/code]

And my RuneRequirement class that I use to manage rune requirements:
[code=java]package org.iClarity.content.skills.magic;

import java.util.List;

import org.iClarity.model.player.Player;
import org.iClarity.util.items.Item;
import org.iClarity.util.items.ItemDefinitions;

/**
 * Represents the rune requirements for a spell.
 * @author PrimaDude.
 */
public class RuneRequirement {
	
	private List&lt;Item&gt; requirements;
	
	/**
	 * Gets the requirements.
	 * @return The requirements.
	 */
	public List&lt;Item&gt; getRequirements() {
		return requirements;
	}
	
	/**
	 * Constructs a new set of rune requirements.
	 * @param requirements The rune requirements.
	 */
	public RuneRequirement(List&lt;Item&gt; requirements) {
		this.requirements = requirements;
	}
	
	/**
	 * Checks if the player has the rune requirements.
	 * @param player The player.
	 * @return True or false.
	 */
	public boolean hasRequirement(Player player) {
		for (Item rune : requirements) {
			if (!player.getInventory().get().hasItemAmount(rune.getId(), rune.getAmount())) {
				return false;
			}
		}
		return true;
	}
	
	/**
	 * Gets the message for when the player 
	 * doesn&#39;t have the rune requirements.
	 * @return The message.
	 */
	public String getMessage() {
		String message = &quot;You need &quot;;
		int runeAmount = 0;
		String runeName = null;
		for (int slot = 0; slot &lt; requirements.size(); slot++) {
			runeAmount = requirements.get(slot).getAmount();
			runeName = (ItemDefinitions.get(requirements.get(slot).getId()).getName() + ((runeAmount &gt; 1) ? &quot;s&quot; : &quot;&quot;)).toLowerCase();
			if (slot == 0) {
				message += runeAmount +&quot; &quot;+ runeName;
			} else {
				message += ((slot == (requirements.size() - 1)) ? &quot;, and &quot; : &quot;, &quot;) + runeAmount +&quot; &quot;+ runeName;
			}
		}
		message += &quot; to cast this spell.&quot;;
		return message;
	}

}[/code]


If you have any questions or problems, either PM me or post them here ;).</description>
    
    <lastBuildDate>Sat, 23 Apr 2011 23:08:27 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Basic Magic spell structure</title>
        <dc:creator><![CDATA[@primadude Primadude]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/primadude">@primadude</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="8" data-topic="392237">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/user_avatar/forum.moparisthebest.com/davidi2/40/2579_1.png" class="avatar"> Davidi2:</div>
<blockquote>
<p>What about bones to peaches, and telegrab?</p>
</blockquote>
</aside>
<p>Those still have an output item. The same class can be used as an instance for the spell, just excluding the use of the input item object.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/9</link>
        <pubDate>Sat, 23 Apr 2011 23:08:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-392237-9</guid>
        <source url="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237.rss">Basic Magic spell structure</source>
      </item>
      <item>
        <title>Basic Magic spell structure</title>
        <dc:creator><![CDATA[@davidi2 Davidi2]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/davidi2">@davidi2</a> wrote:</p>
          <blockquote>
              <p>What about bones to peaches, and telegrab?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/8</link>
        <pubDate>Sat, 23 Apr 2011 23:06:56 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-392237-8</guid>
        <source url="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237.rss">Basic Magic spell structure</source>
      </item>
      <item>
        <title>Basic Magic spell structure</title>
        <dc:creator><![CDATA[@primadude Primadude]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/primadude">@primadude</a> wrote:</p>
          <blockquote>
              <p>[quote=“Davidi2, post:4, topic:392237”]Even though it seems like it wouldn’t fit, non-combat and non-teleportation spells should be included, such as alchemy, superheat etc. Perhaps a MiscSpell class? Also, what did you use to make that graph?<br>
Nice tutorial.[/quote]</p>
<p>I was going to include non-combat spells, however I made the wrong move and made that diagram half-way through myself writing the tutorial, so I forgot to include non-combat spells within it :P.</p>
<p>Here’s my NonCombatSpell class:</p>
<p>[code=java]package org.iClarity.content.skills.magic.spells.impl;</p>
<p>import org.iClarity.content.skills.magic.spells.Spell;<br>
import org.iClarity.util.items.Item;</p>
<p>/**</p>
<ul>
<li>
<p>Represents a non-combat spell.</p>
</li>
<li>
<p><span class="mention">@author</span> PrimaDude.<br>
*/<br>
public class NonCombatSpell extends Spell {</p>
<p>private int animation;<br>
private int graphic;<br>
private Item inputItem;<br>
private Item outputItem;</p>
<p>/**</p>
<ul>
<li>Gets the animation.</li>
<li>
<a class="mention" href="/u/return">@return</a> The animation.<br>
*/<br>
public int getAnimation() {<br>
return animation;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the graphic.</li>
<li>
<a class="mention" href="/u/return">@return</a> The graphic.<br>
*/<br>
public int getGraphic() {<br>
return graphic;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the input item.</li>
<li>
<a class="mention" href="/u/return">@return</a> The input item.<br>
*/<br>
public Item getInputItem() {<br>
return inputItem;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the output item.</li>
<li>
<a class="mention" href="/u/return">@return</a> The output item.<br>
*/<br>
public Item getOutputItem() {<br>
return outputItem;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Constructs a new NonCombatSpell.</li>
<li>
<a class="mention" href="/u/param">@param</a> id The button id of the spell.</li>
<li>
<a class="mention" href="/u/param">@param</a> levelRequired The level required.</li>
<li>
<a class="mention" href="/u/param">@param</a> baseExperience The base experience.</li>
<li>
<a class="mention" href="/u/param">@param</a> runesRequired The runes required.</li>
<li>
<a class="mention" href="/u/param">@param</a> animation The animation displayed.</li>
<li>
<a class="mention" href="/u/param">@param</a> graphic The graphic displayed.</li>
<li>
<a class="mention" href="/u/param">@param</a> inputItem The input item.</li>
<li>
<a class="mention" href="/u/param">@param</a> outputItem The output item.<br>
*/<br>
public NonCombatSpell(int id, int levelRequired, int baseExperience, Item[] runesRequired,<br>
int animation, int graphic, Item inputItem, Item outputItem) {<br>
super(id, levelRequired, baseExperience, runesRequired);<br>
this.animation = animation;<br>
this.graphic = graphic;<br>
this.inputItem = inputItem;<br>
this.outputItem = outputItem;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Sets the input item.</li>
<li>Used for setting the input item for the alchemy spells.</li>
<li>
<a class="mention" href="/u/param">@param</a> inputItem The input item.<br>
*/<br>
public void setInputItem(Item inputItem) {<br>
this.inputItem = inputItem;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Sets the output item.</li>
<li>Used for setting the output item for the alchemy spells.</li>
<li>
<a class="mention" href="/u/param">@param</a> inputItem The output item.<br>
*/<br>
public void setOutputItem(Item outputItem) {<br>
this.outputItem = outputItem;<br>
}</li>
</ul>
</li>
</ul>
<p>}[/code]</p>
<p><span class="bbcode-b">All</span> non-combat spells (found <a href="http://www.runescape.com/kbase/guid/magic_non_combat_magic" data-bbcode="true" rel="nofollow noopener">here</a>) have an input item (The item that the spell is used on) and an output item (The item that the spell gives once cast).</p>
<p>Edit: I made that diagram in Microsoft word, then exported it as a PDF, then opened it in Photoshop to added the outline and the shadow, and exported it as a jpg image to upload and use.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/7</link>
        <pubDate>Sat, 23 Apr 2011 23:05:41 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-392237-7</guid>
        <source url="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237.rss">Basic Magic spell structure</source>
      </item>
      <item>
        <title>Basic Magic spell structure</title>
        <dc:creator><![CDATA[@davidi2 Davidi2]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/davidi2">@davidi2</a> wrote:</p>
          <blockquote>
              <p>[quote=“Clawz fury, post:5, topic:392237”]Fucking amazing, I hate how shit like ‘THE SHAME ROOM!’ has 100 replies but efficient stuff like this barely has any views.[/quote]Because hardly anybody that uses/needs tutorials cares about this or will use it</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/6</link>
        <pubDate>Sat, 23 Apr 2011 22:44:02 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-392237-6</guid>
        <source url="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237.rss">Basic Magic spell structure</source>
      </item>
      <item>
        <title>Basic Magic spell structure</title>
        <dc:creator><![CDATA[@Clawz_fury lare69]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/clawz_fury">@Clawz_fury</a> wrote:</p>
          <blockquote>
              <p>Fucking amazing, I hate how shit like ‘THE SHAME ROOM!’ has 100 replies but efficient stuff like this barely has any views.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/5</link>
        <pubDate>Sat, 23 Apr 2011 22:42:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-392237-5</guid>
        <source url="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237.rss">Basic Magic spell structure</source>
      </item>
      <item>
        <title>Basic Magic spell structure</title>
        <dc:creator><![CDATA[@davidi2 Davidi2]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/davidi2">@davidi2</a> wrote:</p>
          <blockquote>
              <p>Even though it seems like it wouldn’t fit, non-combat and non-teleportation spells should be included, such as alchemy, superheat etc. Perhaps a MiscSpell class? Also, what did you use to make that graph?<br>
Nice tutorial.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/4</link>
        <pubDate>Sat, 23 Apr 2011 22:29:47 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-392237-4</guid>
        <source url="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237.rss">Basic Magic spell structure</source>
      </item>
      <item>
        <title>Basic Magic spell structure</title>
        <dc:creator><![CDATA[@Ddragonimp Ddragonimp]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ddragonimp">@Ddragonimp</a> wrote:</p>
          <blockquote>
              <p>100% Pro</p>
<p>Good Job probaly would have taken you about the same time to write the actual guide that it took you to write this</p>
<p>But still good job.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/3</link>
        <pubDate>Sat, 23 Apr 2011 22:26:19 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-392237-3</guid>
        <source url="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237.rss">Basic Magic spell structure</source>
      </item>
      <item>
        <title>Basic Magic spell structure</title>
        <dc:creator><![CDATA[@TheHolyGrail TheHolyGrail]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/theholygrail">@TheHolyGrail</a> wrote:</p>
          <blockquote>
              <p>Nice, this will help a lot of people. It’s good that you just gave the outline of it so people can actually learn something instead of just spoonfeading like everyone else.</p>
<p>Goodjob Primadude  ;D</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/2</link>
        <pubDate>Sat, 23 Apr 2011 19:11:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-392237-2</guid>
        <source url="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237.rss">Basic Magic spell structure</source>
      </item>
      <item>
        <title>Basic Magic spell structure</title>
        <dc:creator><![CDATA[@primadude Primadude]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/primadude">@primadude</a> wrote:</p>
          <blockquote>
              <p>This tutorial will teach you how to set up a basic magic spell structure - no content, but a structure to hold data and use it. This tutorial is more of a teaching tutorial, than ‘adding a feature to your server’ tutorial.</p>
<p><span class="bbcode-b">NOTE: In all classes that I provide in this tutorial, there will be imports and packages that won’t be valid with your server (They are the imports and packages for my server), therefore you will have to either edit them yourself, or remove them. I’ve left them in to show the package structure that I have for the magic skill structure.</span></p>
<p>The main feature of this structure is <span class="bbcode-b">Inheritance</span>. This is when a class, or multiple classes, are derivatives of a single abstract class, and therefore they inherit the abstract class’s methods and fields. This can prove <span class="bbcode-b">very</span> useful when creating a big structure like the Magic skill, because there are many methods and fields that can be used by several different things.</p>
<p>Before I start, here’s a diagram I created to show what is going on whilst you’re using this structure:<br>
<img src="http://dl.dropbox.com/u/2505112/magic-structure.jpg" alt width="" height=""></p>
<p>All the fields inherited in the image also have ‘get()’ methods that are also inherited by the child classes.</p>
<p>[size=12pt]<span class="bbcode-u"><span class="bbcode-b">The parent spell</span></span>[/size]</p>
<p>In Magic, we have our basic spell - every single spell share these pieces of data: Button id, required level, base experience, runes required.<br>
The only exceptions to the above are the home teleport spells (They require no runes or level, and no experience is given), though I will exclude those in this tutorial due to the fact that they didn’t exist in the 317 revision.</p>
<p>Here is our abstract class that we will use for the base spell:</p>
<p>[code=java]package org.iClarity.content.skills.magic.spells;</p>
<p>import org.iClarity.util.items.Item;</p>
<p>/**</p>
<ul>
<li>
<p>Represents a spell.</p>
</li>
<li>
<p><span class="mention">@author</span> PrimaDude.<br>
*/<br>
public abstract class Spell {</p>
<p>private int id;<br>
private int levelRequired;<br>
private double baseExperience;<br>
private Item[] runesRequired;</p>
<p>public int getId() {<br>
return id;<br>
}</p>
<p>public int getLevelRequired() {<br>
return levelRequired;<br>
}</p>
<p>public double getBaseExperience() {<br>
return baseExperience;<br>
}</p>
<p>public Item[] getRunesRequired() {<br>
return runesRequired;<br>
}</p>
<p>public Spell(int id, int levelRequired, int baseExperience, Item[] runesRequired) {<br>
this.id = id;<br>
this.levelRequired = levelRequired;<br>
this.baseExperience = baseExperience;<br>
this.runesRequired = runesRequired;<br>
}</p>
</li>
</ul>
<p>}[/code]</p>
<p>All classes that extend this abstract class will inherit all it’s public and protected fields/methods (In this case, the get() methods, since that’s all we need to get the data).</p>
<p>Of course, we’ll also need the <span class="bbcode-b">Item</span> class, because we have an Item class array (Used to hold the rune requirements) in the Spell class:</p>
<p>[code=java]package org.iClarity.util.items;</p>
<p>/**</p>
<ul>
<li>
<p>Represents an item.</p>
</li>
<li>
<p><span class="mention">@author</span> PrimaDude.<br>
*/<br>
public class Item {</p>
<pre><code> private int id;
 private int amount;
 
 /**
  * Gets the id of the item.
  * @return The id variable.
  */
 public int getId() {
         return id;
 }
 
 /**
  * Gets the amount of the item.
  * @return The amount variable.
  */
 public int getAmount() {
         return amount;
 }
         
 /**
  * Constructs a new item.
  * @param id The id of the item.
  */
 public Item(int id) {
         this(id, 1);
 }
 
 /**
  * Constructs a new item.
  * @param id The id of the item.
  * @param amount The amount of the item.
  */
 public Item(int id, int amount) {
         if (amount &lt; 0) {
                 return;
         }
         this.id = id;
         this.amount = amount;
 }

 /**
  * Sets the id.
  * @param id The id.
  */
</code></pre>
<p>public void setId(int id) {<br>
this.id = id;<br>
}</p>
<p>/**</p>
<ul>
<li>Sets the amount.</li>
<li>
<a class="mention" href="/u/param">@param</a> amount The amount.<br>
*/<br>
public void setAmount(int amount) {<br>
this.amount = amount;<br>
}</li>
</ul>
</li>
</ul>
<p>}[/code]</p>
<p>This class proves very useful when compared to your average Winterlove server. This class treats <span class="bbcode-b">every</span> item as an Object (The object being an instance of this class for each item), rather than storing item Id’s in one integer array and the item amounts in another integer array like most servers do.</p>
<p>[size=12pt]<span class="bbcode-u"><span class="bbcode-b">The child spells</span></span>[/size]</p>
<p>Next we need to create the classes that will be extending the Spell class.</p>
<p>[size=10pt]<span class="bbcode-u"><span class="bbcode-b">Teleportation spells<br>
</span></span>[/size]<br>
Firstly, we’ll take a look at a class for Teleportation; the <span class="bbcode-b">TeleportationSpell</span> class.</p>
<p>[code=java]package org.iClarity.content.skills.magic.spells.impl;</p>
<p>import org.iClarity.content.Teleport.TeleportType;<br>
import org.iClarity.content.skills.magic.spells.Spell;<br>
import org.iClarity.util.Position;<br>
import org.iClarity.util.items.Item;</p>
<p>/**</p>
<ul>
<li>
<p>Represents a teleportation spell.</p>
</li>
<li>
<p><span class="mention">@author</span> PrimaDude.<br>
*/<br>
public class TeleportationSpell extends Spell {</p>
<p>private Position position;<br>
private TeleportType teleportType;</p>
<p>/**</p>
<ul>
<li>Gets the position.</li>
<li>
<a class="mention" href="/u/return">@return</a> The position.<br>
*/<br>
public Position getPosition() {<br>
return position;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the teleport type.</li>
<li>
<a class="mention" href="/u/return">@return</a> The teleport type.<br>
*/<br>
public TeleportType getTeleportType() {<br>
return teleportType;<br>
}</li>
</ul>
<p>public TeleportationSpell(int id, int levelRequired, int baseExperience, Item[] runesRequired,<br>
Position position, TeleportType teleportType) {<br>
super(id, levelRequired, baseExperience, runesRequired);<br>
this.position = position;<br>
this.teleportType = teleportType;<br>
}</p>
</li>
</ul>
<p>}[/code]</p>
<p>The graphic and animation fields are not included in this class because there are only two sets for all the teleports (The set for Modern magicks and the set for Ancient magicks).</p>
<p>This class contains two fields</p>
<ol>
<li>The ‘position’ field, which is an instance of the <span class="bbcode-b">Position</span> class (which will follow below). The position instance contains the values for the x, y and height of the position that the teleport will move the player to.</li>
<li>The ‘teleportType’ field. The ‘<span class="bbcode-b">TeleportType</span>’ type is an enum:</li>
</ol>
<p><code>	public enum TeleportType {
		MODERN_MAGICKS,
		ANCIENT_MAGICKS
	}</code><br>
This field will determine what type of teleport the spell is. The type of teleport should change the graphic and animation displayed for the teleport (As the ancient magicks graphics and animation are different to the modern magicks ones).</p>
<p>The constructor of this class invokes the ‘super’ constructor (The constructor of it’s parent class, the Spell class), with the parameters that is within it’s own constructor.</p>
<p>Here is the <span class="bbcode-b">Position</span> class that is used in the <span class="bbcode-b">TeleportSpell</span> class:</p>
<p>[code=java]package org.iClarity.util;</p>
<p>/**</p>
<ul>
<li>
<p>Represents a position.</p>
</li>
<li>
<p><span class="mention">@author</span> PrimaDude.<br>
*/<br>
public class Position {</p>
<p>private int x;<br>
private int y;<br>
private int height;</p>
<p>/**</p>
<ul>
<li>Creates a new Position with the specified coordinates. The height coordinate</li>
<li>is set to 0.</li>
<li>
<a class="mention" href="/u/param">@param</a> x The X coordinate.</li>
<li>
<a class="mention" href="/u/param">@param</a> y The Y coordinate.<br>
*/<br>
public Position(int x, int y) {<br>
this(x, y, 0);<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Creates a new Position with the specified coordinates.</li>
<li>
<a class="mention" href="/u/param">@param</a> x The X coordinate.</li>
<li>
<a class="mention" href="/u/param">@param</a> y The Y coordinate.</li>
<li>
<a class="mention" href="/u/param">@param</a> height The height.<br>
*/<br>
public Position(int x, int y, int height) {<br>
this.setX(x);<br>
this.setY(y);<br>
this.setHeight(height);<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Sets this position as the other position.</li>
<li>
<a class="mention" href="/u/param">@param</a> other The other position.<br>
*/<br>
public void setAs(Position other) {<br>
this.x = other.x;<br>
this.y = other.y;<br>
this.height = other.height;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Sets the X coordinate.</li>
<li>
<a class="mention" href="/u/param">@param</a> x The X coordinate.<br>
*/<br>
public void setX(int x) {<br>
this.x = x;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the X coordinate.</li>
<li>
<a class="mention" href="/u/return">@return</a> The X coordinate.<br>
*/<br>
public int getX() {<br>
return x;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Sets the Y coordinate.</li>
<li>
<a class="mention" href="/u/param">@param</a> y The Y coordinate.<br>
*/<br>
public void setY(int y) {<br>
this.y = y;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the Y coordinate.</li>
<li>
<a class="mention" href="/u/return">@return</a> The Y coordinate.<br>
*/<br>
public int getY() {<br>
return y;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Sets the height coordinate.</li>
<li>
<a class="mention" href="/u/param">@param</a> height The height coordinate.<br>
*/<br>
public void setHeight(int height) {<br>
this.height = height;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the height coordinate.</li>
<li>
<a class="mention" href="/u/return">@return</a> The height coordinate.<br>
*/<br>
public int getHeight() {<br>
return height;<br>
}</li>
</ul>
</li>
</ul>
<p>}[/code]</p>
<p>This is a basic class to store the values of a specified position, to save creating several more variables in multiple places (Which is inefficient when compared to using this class).</p>
<p>[size=10pt]<span class="bbcode-u"><span class="bbcode-b">Combat spells</span></span>[/size]</p>
<p>Next, we have our <span class="bbcode-b">CombatSpell</span> class:</p>
<p>[code=java]package org.iClarity.content.skills.magic.spells.impl;</p>
<p>import org.iClarity.content.skills.magic.spells.Spell;<br>
import org.iClarity.content.skills.magic.spells.SpellProjectile;<br>
import org.iClarity.util.items.Item;</p>
<p>/**</p>
<ul>
<li>
<p>Represents a combat spell.</p>
</li>
<li>
<p><span class="mention">@author</span> PrimaDude.<br>
*/<br>
public class CombatSpell extends Spell {</p>
<p>private int animation;<br>
private int maximumDamage;<br>
private boolean freezingSpell;<br>
private SpellProjectile spellProjectile;</p>
<p>/**</p>
<ul>
<li>Gets the animation.</li>
<li>
<a class="mention" href="/u/return">@return</a> The animation.<br>
*/<br>
public int getAnimation() {<br>
return animation;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the maximum damage.</li>
<li>
<a class="mention" href="/u/return">@return</a> The maximum damage.<br>
*/<br>
public int getMaximumDamage() {<br>
return maximumDamage;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>If the spell freezes the enemy.</li>
<li>
<a class="mention" href="/u/return">@return</a> True or false.<br>
*/<br>
public boolean isFreezingSpell() {<br>
return freezingSpell;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the spell projectile.</li>
<li>
<a class="mention" href="/u/return">@return</a> The spell projectile.<br>
*/<br>
public SpellProjectile getSpellProjectile() {<br>
return spellProjectile;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Constructs a new CombatSpell.</li>
<li>
<a class="mention" href="/u/param">@param</a> id The id of the spell.</li>
<li>
<a class="mention" href="/u/param">@param</a> levelRequired The level required.</li>
<li>
<a class="mention" href="/u/param">@param</a> baseExperience The base experience.</li>
<li>
<a class="mention" href="/u/param">@param</a> runesRequired The runes required.</li>
<li>
<a class="mention" href="/u/param">@param</a> animation The spell animation.</li>
<li>
<a class="mention" href="/u/param">@param</a> maximumDamage The maximum damage.</li>
<li>
<a class="mention" href="/u/param">@param</a> freezingSpell If the spell freezes the enemy.</li>
<li>
<a class="mention" href="/u/param">@param</a> spellProjectile The spell projectile.<br>
*/<br>
public CombatSpell(int id, int levelRequired, int baseExperience, Item[] runesRequired,<br>
int animation, int maximumDamage, boolean freezingSpell, SpellProjectile spellProjectile) {<br>
super(id, levelRequired, baseExperience, runesRequired);<br>
this.animation = animation;<br>
this.maximumDamage = maximumDamage;<br>
this.freezingSpell = freezingSpell;<br>
this.spellProjectile = spellProjectile;<br>
}</li>
</ul>
</li>
</ul>
<p>}[/code]</p>
<p>Once again, the constructor of this class invokes the ‘super’ constructor (The constructor of it’s parent class, the Spell class), with the parameters that is within it’s own constructor.</p>
<p>The fields within this class are simple to understand. I will however explain the ‘spellProjectile’ field because it’s an object of another class, the <span class="bbcode-b">SpellProjectile</span> class:</p>
<p>[code=java]package org.iClarity.content.skills.magic.spells;</p>
<p>/**</p>
<ul>
<li>
<p>Represents a spell projectile.</p>
</li>
<li>
<p><span class="mention">@author</span> PrimaDude.<br>
*/<br>
public class SpellProjectile {</p>
<p>private int castGraphic;<br>
private int projectileGraphic;<br>
private int collideGraphic;</p>
<p>/**</p>
<ul>
<li>Gets the casting graphic.</li>
<li>
<a class="mention" href="/u/return">@return</a> The cast graphic.<br>
*/<br>
public int getCastGraphic() {<br>
return castGraphic;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the projectile graphic.</li>
<li>
<a class="mention" href="/u/return">@return</a> The projectile graphic.<br>
*/<br>
public int getProjectileGraphic() {<br>
return projectileGraphic;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the colliding graphic.</li>
<li>
<a class="mention" href="/u/return">@return</a> The collide graphic.<br>
*/<br>
public int getCollideGraphic() {<br>
return collideGraphic;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Constructs a new SpellProjectile.</li>
<li>
<a class="mention" href="/u/param">@param</a> castGraphic The casting graphic id.</li>
<li>
<a class="mention" href="/u/param">@param</a> projectileGraphic The projectile graphic id.</li>
<li>
<a class="mention" href="/u/param">@param</a> collideGraphic The colliding graphic id.<br>
*/<br>
public SpellProjectile(int castGraphic, int projectileGraphic, int collideGraphic) {<br>
this.castGraphic = castGraphic;<br>
this.projectileGraphic = projectileGraphic;<br>
this.collideGraphic = collideGraphic;<br>
}</li>
</ul>
</li>
</ul>
<p>}[/code]</p>
<p>This class will hold the data for the casting, projectile and colliding graphics of a combat spell (Hence why there’s an object of it in the <span class="bbcode-b">CombatSpell</span> class).</p>
<p>[size=12pt]<span class="bbcode-u"><span class="bbcode-b">Storing the data in instances</span></span>[/size]</p>
<p>There are several ways in which you can do this. You could either load it from a file or store it directly within a class in an array/list/enum etc.</p>
<p>Loading it from a file; there are hundreds of different methods of doing this. I, personally, store the data that I store in files in XML format, then load it via the server using XStream. For information about XStream, you could either visit their <a href="http://xstream.codehaus.org/" data-bbcode="true" rel="nofollow noopener">website</a>, or look at some of my previous tutorials that use XStream, for example:<br>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://forum.moparisthebest.com/uploads/default/original/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a.png" class="site-icon" width="32" height="32">
      <a href="https://forum.moparisthebest.com/" target="_blank">moparisthebest.com</a>
  </header>
  <article class="onebox-body">
    <img src="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" class="thumbnail onebox-avatar" width="500" height="500">

<h3><a href="https://forum.moparisthebest.com/" target="_blank">moparisthebest.com</a></h3>

<p>programming, irc, cars</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<br>
or<br>
<aside class="onebox whitelistedgeneric">
  <header class="source">
      <img src="https://forum.moparisthebest.com/uploads/default/original/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a.png" class="site-icon" width="32" height="32">
      <a href="https://forum.moparisthebest.com/" target="_blank">moparisthebest.com</a>
  </header>
  <article class="onebox-body">
    <img src="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" class="thumbnail onebox-avatar" width="500" height="500">

<h3><a href="https://forum.moparisthebest.com/" target="_blank">moparisthebest.com</a></h3>

<p>programming, irc, cars</p>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
</p>
<p>Here is an xml file storing my teleportation data, as an example: <a href="http://dl.dropbox.com/u/2505112/teleports.xml" rel="nofollow noopener">http://dl.dropbox.com/u/2505112/teleports.xml</a></p>
<p>Storing the data directly in a class is simple. If you were to use an enum, you would use something like this (This would be stored within a class):</p>
<p>[code=java]public static enum Teleports {</p>
<pre><code>VARROCK_TELEPORT(1164, new TeleportationSpell(1164, 25, 35,
	new Item[] {
		new Item(563, 1), new Item(556, 3), new Item(554, 1)
	}, new Position(3212, 3423), MODERN_MAGICKS); 

private int buttonId;
private TeleportSpell teleportSpell;

Teleports(int buttonId, TeleportSpell teleportSpell) {
	this.buttonId = buttonId;
	this.teleportSpell = teleportSpell;
}
</code></pre>
<p>}[/code]</p>
<p>That just has one teleport within it, just to show as an example.</p>
<p>[size=12pt]<span class="bbcode-u"><span class="bbcode-b">Using the data</span></span>[/size]</p>
<p>Using the data is simple if you’ve got it stored in a nice, tidy and efficient way. Let’s look a the data stored in a Map, for example:</p>
<pre><code class="lang-auto">public static Map&lt;Integer, TeleportationSpell&gt; teleportationSpells = new HashMap&lt;Integer, TeleportationSpell&gt;();</code></pre>
<p>The integer in the map is the button id of the teleportation spell. This is used to get the ‘TeleportationSpell’ instance from the map:</p>
<pre><code class="lang-auto">TeleportationSpell teleportationSpell = teleportationSpells.get(buttonId);</code></pre>
<p>From that instance, you can get all the data you need to perform a teleportation spell:</p>
<p><code>int levelRequired = teleportationSpell.getLevelRequired();
int experience = teleportationSpell.getBaseExperience();
Item[] runeRequirements = teleportationSpell.getRunesRequired();
Position teleportPosition = teleportationSpell.getPosition();
TeleportType teleportType = teleportationSpell.getTeleportType();</code></p>
<hr>
<p>To conclude the tutorial, I’ll show you how I get the data and perform a teleportation spell. My MagicTeleport class:</p>
<p>[code=java]package org.iClarity.content.skills.magic;</p>
<p>import java.util.ArrayList;<br>
import java.util.List;</p>
<p>import org.iClarity.Constants;<br>
import org.iClarity.content.Teleport;<br>
import org.iClarity.content.skills.magic.spells.Spells;<br>
import org.iClarity.content.skills.magic.spells.impl.TeleportationSpell;<br>
import org.iClarity.model.player.Player;<br>
import org.iClarity.util.items.Item;</p>
<p>/**</p>
<ul>
<li>
<p>Magic teleportation.</p>
</li>
<li>
<p><span class="mention">@author</span> PrimaDude.<br>
*/<br>
public class MagicTeleport {</p>
<p>/**</p>
<ul>
<li>Gets a RuneRequirement instance for the teleport.</li>
<li>
<a class="mention" href="/u/param">@param</a> runes An array of the runes required.</li>
<li>
<a class="mention" href="/u/return">@return</a> The RuneRequirement instance.<br>
*/<br>
private static RuneRequirement getRuneRequirements(Item[] runes) {<br>
List requirements = new ArrayList();<br>
for (Item rune : runes) {<br>
requirements.add(rune);			<br>
}<br>
return new RuneRequirement(requirements);<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Initiates a teleportation spell.</li>
<li>
<a class="mention" href="/u/param">@param</a> player The player.</li>
<li>
<a class="mention" href="/u/param">@param</a> buttonId The button id.<br>
*/<br>
public static void teleport(Player player, int buttonId) {<br>
TeleportationSpell teleport = Spells.TELEPORTATION_SPELLS.get(buttonId);<br>
if (teleport == null) {<br>
return;<br>
}<br>
int level = teleport.getLevelRequired();<br>
RuneRequirement runeRequirement = getRuneRequirements(teleport.getRunesRequired());<br>
if (player.getSkills().get()[Constants.MAGIC].getLevel() &lt; level) {<br>
player.getActionSender().sendMessage(“You need a magic level of “+ level +” to cast this spell.”);<br>
return;<br>
} else if (!runeRequirement.hasRequirement(player)) {<br>
player.getActionSender().sendMessage(runeRequirement.getMessage());<br>
return;<br>
}<br>
player.getSkills().addSkillXP(player, Constants.MAGIC, teleport.getBaseExperience());<br>
for (Item item : runeRequirement.getRequirements()) {<br>
player.getInventory().get().remove(item.getId(), item.getAmount());<br>
}<br>
new Teleport(teleport.getPosition(), teleport.getTeleportType()).initiateTeleport(player);<br>
}<br>
}[/code]</li>
</ul>
</li>
</ul>
<p>All I need to do with that, is wherever my buttons are managed, is invoke:</p>
<pre><code class="lang-auto">MagicTeleport.teleport(player, buttonId);</code></pre>
<p>And my RuneRequirement class that I use to manage rune requirements:</p>
<p>[code=java]package org.iClarity.content.skills.magic;</p>
<p>import java.util.List;</p>
<p>import org.iClarity.model.player.Player;<br>
import org.iClarity.util.items.Item;<br>
import org.iClarity.util.items.ItemDefinitions;</p>
<p>/**</p>
<ul>
<li>
<p>Represents the rune requirements for a spell.</p>
</li>
<li>
<p><span class="mention">@author</span> PrimaDude.<br>
*/<br>
public class RuneRequirement {</p>
<p>private List requirements;</p>
<p>/**</p>
<ul>
<li>Gets the requirements.</li>
<li>
<a class="mention" href="/u/return">@return</a> The requirements.<br>
*/<br>
public List getRequirements() {<br>
return requirements;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Constructs a new set of rune requirements.</li>
<li>
<a class="mention" href="/u/param">@param</a> requirements The rune requirements.<br>
*/<br>
public RuneRequirement(List requirements) {<br>
this.requirements = requirements;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Checks if the player has the rune requirements.</li>
<li>
<a class="mention" href="/u/param">@param</a> player The player.</li>
<li>
<a class="mention" href="/u/return">@return</a> True or false.<br>
*/<br>
public boolean hasRequirement(Player player) {<br>
for (Item rune : requirements) {<br>
if (!player.getInventory().get().hasItemAmount(rune.getId(), rune.getAmount())) {<br>
return false;<br>
}<br>
}<br>
return true;<br>
}</li>
</ul>
<p>/**</p>
<ul>
<li>Gets the message for when the player</li>
<li>doesn’t have the rune requirements.</li>
<li>
<a class="mention" href="/u/return">@return</a> The message.<br>
*/<br>
public String getMessage() {<br>
String message = "You need “;<br>
int runeAmount = 0;<br>
String runeName = null;<br>
for (int slot = 0; slot &lt; requirements.size(); slot++) {<br>
runeAmount = requirements.get(slot).getAmount();<br>
runeName = (ItemDefinitions.get(requirements.get(slot).getId()).getName() + ((runeAmount &gt; 1) ? “s” : “”)).toLowerCase();<br>
if (slot == 0) {<br>
message += runeAmount +” "+ runeName;<br>
} else {<br>
message += ((slot == (requirements.size() - 1)) ? ", and " : ", “) + runeAmount +” “+ runeName;<br>
}<br>
}<br>
message += " to cast this spell.”;<br>
return message;<br>
}</li>
</ul>
</li>
</ul>
<p>}[/code]</p>
<p>If you have any questions or problems, either PM me or post them here ;).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237/1</link>
        <pubDate>Sat, 23 Apr 2011 18:47:19 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-392237-1</guid>
        <source url="https://forum.moparisthebest.com/t/basic-magic-spell-structure/392237.rss">Basic Magic spell structure</source>
      </item>
  </channel>
</rss>
