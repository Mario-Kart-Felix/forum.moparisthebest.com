<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>[Delta] Command panel for your server + Automated shop maker</title>
    <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664</link>
    <description>[size=16pt][b]Introduction:[/b][/size]
Hello Moparscape.
I felt like programming something different than rsps&#39;s for once and decided to throw an attempt
on making a little program in which I succeeded.
I decided to convert it to a command input panel for my server.
Nothing special or big.
Nessie suggested me on making a command to add shops automatically, which I did.


[size=16pt][b]What is in this tutorial?[/b][/size]
- Adding a command panel for your server. The panel opens at server startup and allows you to input commands without being logged in.
- Some tweaks on easier shops (opening a shop via an npc)
- Adding complete shops via a command via the command pannel.
  -&gt; This is not like the programs you are used to see that generate the code for you to paste
      but actually automatically creating a file with the shopdata.
Let me show you with some pictures:

[img]http://i.imgur.com/lI8O1V9.png[/img]

[img]http://i.imgur.com/EXeTyh9.png[/img]

[img]http://i.imgur.com/uJw9Wqh.png[/img]



[size=16pt][b]Let&#39;s get started[/b][/size]
[size=14pt]Step 1: Making shops easier[/size]

[ul][li]Create a new java file called Shops.java[/li][/ul]

[img]http://i.imgur.com/bqL2sl3.png[/img]


[ul][li]Paste this code into it:[/li][/ul]
[code=java]
public class Shops {
	
	/**
	 * @Author: RandQm
	 * @Date: 12 March 2012
	 * @Info: Handling the world shops.
	 */
	
	private client c;
	
	public Shops(final client c) {
		this.c = c;
	}
 
	//This opens the shopping interface for a defined shopID
	public void openShop (int shopId) {
		c.sendFrame(ShopHandler.ShopName[shopId], 3901);
		c.sendFrame248(3824, 3822);
		c.resetItems(3823);
		c.resetShop(shopId);
		c.IsShopping = true;
		c.MyShopID = shopId;
	}
	
    //This requests to open a shop for an npc
	public void handleShops (int npc) {
		switch(npc) {
		
		//Example
		case 520: // The NPCIDs 520 and 521 are General Store owner and assistent
		case 521:
			openShop(10); //Shopid 10 gets opened
			break;
		}
	}
}[/code]


[ul][li]Open your client.java and search (ctrl+f) for case 155:[/li]
[li]you should see something like this:[/li][/ul]

[code=java]case 17:
			// second Click npc
			NPCSlot = inStream.readUnsignedWordBigEndianA();[/code]

[ul][li]If you scroll down a bit and there are shops added in your server, you&#39;ll see some of these:[/li][/ul]

[code=java]if(NPCID == 534){
				PutNPCCoords = true;
				WanneShop = 42;
}
if(NPCID == 594){
				PutNPCCoords = true;
				WanneShop = 17; 
}[/code]

[ul][li]Remove all these, if you have 100+ errors upon compiling you will have accidentally remove a bracket that you shouldn&#39;t have.[/li]
[li]Where you removed all those things, add these lines instead:[/li][/ul]

[code=java]PutNPCCoords = false;
			faceNPC(NPCSlot);
			getShops().handleShops(NPCID);[/code]


[ul][li]Now search for case 17 and do the same. Don&#39;t forget also adding the new code pasted above ^.[/li]
[li]Now at the top of your client class under something similar to this:[/li][/ul]

[code=java]public class Client extends Player[/code]

[ul][li]Add these lines:[/li][/ul]

[code=java]private Shops shops = new Shops(this);
public Shops getShops() {
   return shops;
}[/code]
[ul][/ul]




[size=14pt]Step 2: Adding the command panel and command system[/size]

[ul][li]Add a new java file again, called Panel.java this time[/li]
[li]Add this bunch of code to it:[/li][/ul]

[code=java]
import java.awt.EventQueue;

import javax.swing.JFrame;
import javax.swing.JPanel;
import java.awt.BorderLayout;

import javax.swing.JTextField;
import javax.swing.JLabel;
import javax.swing.JButton;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

/**
 * @Author: RandQm
 * @Date: 19th of May 2013
 */

public class Panel {

	private JFrame frame;
	private JTextField commandField;
	private JPanel panel;
	private JButton sendCommand;
	
	private String version = &quot;version 1&quot;;

	
	public Panel() {
		initialize();
	}
	
	/*
	 * Launching the program.
	 */
	public void launch() {
		EventQueue.invokeLater(new Runnable() {
			public void run() {
				try {
					Panel window = new Panel();
					window.frame.setVisible(true);
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		});
	}

	/*
	 * Controlling the command panel.
	 */
	private void initialize() {
		try {
			UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
		} catch (UnsupportedLookAndFeelException | ClassNotFoundException | InstantiationException | IllegalAccessException e) {
			System.out.println(&quot;Initialization error ocurred.&quot;);
			e.printStackTrace();
		}
		frame = new JFrame();
		frame.setResizable(false);
		frame.setTitle(&quot;Admin Panel &quot; + version);
		frame.setBounds(100, 100, 577, 400);
		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		panel = new JPanel();
		frame.getContentPane().add(panel, BorderLayout.CENTER);
		panel.setLayout(null);
		
		commandField = new JTextField();
		commandField.setBounds(75, 8, 350, 20);
		panel.add(commandField);
		commandField.setColumns(10);

		sendCommand = new JButton(&quot;Send Command&quot;);
		sendCommand.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent arg0) {
				CommandManager.sendCommand(commandField.getText());
			}
		});
		sendCommand.setBounds(435, 7, 125, 23);
		panel.add(sendCommand);
		
		JLabel lblThreadLink = new JLabel(&quot;Command&quot;);
		lblThreadLink.setBounds(10, 11, 102, 14);
		panel.add(lblThreadLink);
	}

}
[/code]


[ul][li]Now open your Server.java and add this line with the similar other lines:[/li][/ul]

[code=java]public static Panel panel = new Panel();[/code]

[ul][li]Now search for this:[/li][/ul]

[code=java]public static void main[/code]

[ul][li]If you scroll down a bit, you&#39;ll see lines like these in this method:[/li][/ul]

[code=java]npcHandler = new NPCHandler();
		itemHandler = new ItemHandler();[/code]

[ul][li]Add this line with them:[/li][/ul]

[code=java]panel.launch();[/code]


[ul][li]Now we have added the panel we have to add the command system, therefore make again a new java file.
This time we&#39;ll call it CommandManager.java[/li]
[li]Add this code into CommandManager.java[/li][/ul]

[code=java]public class CommandManager {
	
	public static void sendCommand(String command) {
		String[] args = command.split(&quot; &quot;);
		if (args.length &lt; 1)
			return;
		
		if (command.equalsIgnoreCase(&quot;test&quot;)) {
			System.out.println(&quot;RandQm Rocks&quot;);
		}
		
		if (command.startsWith(&quot;shop&quot;)) {
			Server.shopHandler.createShop(args);
		}
		
	}

}[/code]
[ul][/ul]


[size=14pt]Step 3: Adding the shopmaking command[/size]

[ul][li]Open your Shophandler.java and search for &quot;boolean loadshops&quot; and remove that whole method.[/li]
[li]Add these 2 methods instead:[/li][/ul]

[code=java]public void createShop(String[] args) {
		if (Integer.parseInt(args[1]) &lt;= 0) {
			System.out.println(&quot;You must use a positive number as shop ID.&quot;);
			return;
		}
		if (Integer.parseInt(args[1]) &gt; 500) {
			System.out.println(&quot;You can&#39;t have more than 500 shops.&quot;);
			return;
		}
		File file = new File(&quot;Content\\Shops\\&quot;+ args[1]);
		if (file.exists()) {
			System.out.println(&quot;This shop ID already exists!&quot;);
			return;
		} else {
			BufferedWriter bw = null;
			try {
				bw = new BufferedWriter(new FileWriter(&quot;Content//Shops//&quot; + args[1] + &quot;.txt&quot;, true));
				bw.write(args[2]);
				bw.newLine();
				for (int i = 3; i &lt; args.length; i++) {
					bw.write(args[i]);
					bw.newLine();
				}
				bw.flush();
			} catch (IOException ioe) {
				ioe.printStackTrace();
			} finally {
				if (bw != null)
					try {
						bw.close();
					} catch (IOException ioe2) {
						System.out.println(&quot;Error writing log.&quot;);
						ioe2.printStackTrace();
					}
			}
		}
	}
	
	public void loadShops() {
		for (int i = 1; i &lt; 500; i ++) {
			File file = new File(&quot;Content//Shops//&quot; + i + &quot;.txt&quot;);
			if (file.exists()) {
				try {
					Scanner s = new Scanner(new File(&quot;Content//Shops//&quot; + i + &quot;.txt&quot;));
					ShopName[i] = s.nextLine();
					int j = 0;
					while (s.hasNextLine()) {
						int item = Integer.parseInt(s.nextLine()) + 1;
						int amount = Integer.parseInt(s.nextLine());
						ShopSModifier[i] = 2;
						ShopBModifier[i] = 2;
						ShopItems[i][j] = item;
						ShopItemsN[i][j] = amount;
						ShopItemsSN[i][j] = amount;
						ShopItemsStandard[i] ++;
						TotalShops++;
						j++;	
					}
				} catch (FileNotFoundException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}
		}
	}[/code]

[ul][li]Now search for &quot;public ShopHandler()&quot;, you&#39;ll see this line: loadShops(&quot;shops.cfg&quot;);[/li]
[li]Remove the &quot;shops.cfg&quot; so it looks like this:[/li][/ul]
[code=java]loadShops();[/code]
[ul][list][li]Now in the main folder of your server, add a folder called &#39;Content&#39; and in that folder add one called &#39;Shops&#39;[/li]
[li]If you get errors saying it couldn&#39;t find files or folders you&#39;ll have created the folders in a wrong directions[/li][/list]
[img]http://i.imgur.com/VBXIfzj.png[/img][/ul]



[size=16pt][b]How exactly to add shops the right way?[/b][/size]

[ul][li]In your Content/Shops folder check what ID&#39;s are in use if you already added shops.[/li]
[li]Go into your shops.java and go the the &#39;public void handleShops&#39; method.[/li]
[li]Add the id of shop you want to open when clicking a specified npc.[/li][/ul]

[code=java]		case 546: //The npc
			openShop(25); //The ID of shop you want to open when clicking npc 546
			break; [/code]

[ul][li]Now just run your server so the command pannel pops up and add a command in the following format:[/li][/ul]

[code]shop shopID shopName item itemamount item itemamount[/code]
[ul]//You can ofc add more items.[/ul]




[size=16pt][b]This was it[/b][/size]
- If you have any questions, suggestions or errors let me know.
- Feel free to add new commands to the command system obviously.
- It&#39;s more than likely possible that I par accident skipped something so don&#39;t hesitate to post errors. 
  (If you&#39;re 100% sure that you correctly followed the tutorial and not just rushed thinking you know what you were doing)

Credits:
- stackoverflow for learning Jframe and some help on fixing bugs on reading and writing files.
- Delta, the used base
- Me, RandQm, writing all the code</description>
    
    <lastBuildDate>Wed, 29 May 2013 19:17:18 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>[Delta] Command panel for your server + Automated shop maker</title>
        <dc:creator><![CDATA[@mrnessie mrnessie]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mrnessie">@mrnessie</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="9" data-topic="519664">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/strucker/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> Strucker:</div>
<blockquote>
<p>baby i like it</p>
</blockquote>
</aside>
<p><img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"> Who doesn’t, like seriously, RandQm and Arham_4 are like gods to me <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/10</link>
        <pubDate>Wed, 29 May 2013 19:17:18 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-519664-10</guid>
        <source url="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss">[Delta] Command panel for your server + Automated shop maker</source>
      </item>
      <item>
        <title>[Delta] Command panel for your server + Automated shop maker</title>
        <dc:creator><![CDATA[@strucker Strucker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/strucker">@strucker</a> wrote:</p>
          <blockquote>
              <p>baby i like it</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/9</link>
        <pubDate>Sat, 25 May 2013 23:30:54 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-519664-9</guid>
        <source url="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss">[Delta] Command panel for your server + Automated shop maker</source>
      </item>
      <item>
        <title>[Delta] Command panel for your server + Automated shop maker</title>
        <dc:creator><![CDATA[@mrnessie mrnessie]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mrnessie">@mrnessie</a> wrote:</p>
          <blockquote>
              <p>ima code onto to get used to the idea of it k? I got arham to help me think of concept for our game btw <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/8</link>
        <pubDate>Tue, 21 May 2013 19:27:04 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-519664-8</guid>
        <source url="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss">[Delta] Command panel for your server + Automated shop maker</source>
      </item>
      <item>
        <title>[Delta] Command panel for your server + Automated shop maker</title>
        <dc:creator><![CDATA[@RandQm RandQm]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/randqm">@RandQm</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="6" data-topic="519664">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/mrnessie/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> mrnessie:</div>
<blockquote>
<p>lol, this isnt a panel, this is a command prompt kinda thing, like a mod could send u a message thru skype to unban someone or ban someone without logging in, And he didnt want it to be like trisidia’s where the was buttons, u literally have to type commands not hit a button.</p>
</blockquote>
</aside>
<p>exactly,<br>
I might expand it to more of a panel though once I find the time, but definitely different from all those panels currently around that all look the same.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/7</link>
        <pubDate>Tue, 21 May 2013 15:49:54 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-519664-7</guid>
        <source url="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss">[Delta] Command panel for your server + Automated shop maker</source>
      </item>
      <item>
        <title>[Delta] Command panel for your server + Automated shop maker</title>
        <dc:creator><![CDATA[@mrnessie mrnessie]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mrnessie">@mrnessie</a> wrote:</p>
          <blockquote>
              <p>lol, this isnt a panel, this is a command prompt kinda thing, like a mod could send u a message thru skype to unban someone or ban someone without logging in, And he didnt want it to be like trisidia’s where the was buttons, u literally have to type commands not hit a button.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/6</link>
        <pubDate>Tue, 21 May 2013 10:09:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-519664-6</guid>
        <source url="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss">[Delta] Command panel for your server + Automated shop maker</source>
      </item>
      <item>
        <title>[Delta] Command panel for your server + Automated shop maker</title>
        <dc:creator><![CDATA[@Vain1 Vain_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/vain1">@Vain1</a> wrote:</p>
          <blockquote>
              <p>if you’re going to make a panel, add support for everything the other panels work (plus more)</p>
<p>i suggest jtabbedpanes for organization.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/5</link>
        <pubDate>Mon, 20 May 2013 03:22:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-519664-5</guid>
        <source url="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss">[Delta] Command panel for your server + Automated shop maker</source>
      </item>
      <item>
        <title>[Delta] Command panel for your server + Automated shop maker</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>Just sayin’. Some noob would use it, type something wrong, blame you.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/4</link>
        <pubDate>Mon, 20 May 2013 03:20:33 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-519664-4</guid>
        <source url="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss">[Delta] Command panel for your server + Automated shop maker</source>
      </item>
      <item>
        <title>[Delta] Command panel for your server + Automated shop maker</title>
        <dc:creator><![CDATA[@RandQm RandQm]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/randqm">@RandQm</a> wrote:</p>
          <blockquote>
              <p>[quote=“sk8rdude461, post:2, topic:519664”]I don’t like that shop thing in the first image…<br>
You should structure it better (imo).<br>
Have it look like this (Obvious mock up made in paint):<br>
<img src="http://i.imgur.com/V72CDS0.png" alt width="161" height="81"><br>
Ehh guess I forgot shop ID. but oops.[/quote]<br>
The thing is the purpose isn’t really for a shopmaker but as command input.<br>
The shopmaker is just a command from a suggestion I worked out.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/3</link>
        <pubDate>Mon, 20 May 2013 01:46:09 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-519664-3</guid>
        <source url="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss">[Delta] Command panel for your server + Automated shop maker</source>
      </item>
      <item>
        <title>[Delta] Command panel for your server + Automated shop maker</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>I don’t like that shop thing in the first image…<br>
You should structure it better (imo).<br>
Have it look like this (Obvious mock up made in paint):<br>
<img src="http://i.imgur.com/V72CDS0.png" alt width="161" height="81"><br>
Ehh guess I forgot shop ID. but oops.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/2</link>
        <pubDate>Mon, 20 May 2013 01:43:18 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-519664-2</guid>
        <source url="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss">[Delta] Command panel for your server + Automated shop maker</source>
      </item>
      <item>
        <title>[Delta] Command panel for your server + Automated shop maker</title>
        <dc:creator><![CDATA[@RandQm RandQm]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/randqm">@RandQm</a> wrote:</p>
          <blockquote>
              <p>[size=16pt]<span class="bbcode-b">Introduction:</span>[/size]<br>
Hello Moparscape.<br>
I felt like programming something different than rsps’s for once and decided to throw an attempt<br>
on making a little program in which I succeeded.<br>
I decided to convert it to a command input panel for my server.<br>
Nothing special or big.<br>
Nessie suggested me on making a command to add shops automatically, which I did.</p>
<p>[size=16pt]<span class="bbcode-b">What is in this tutorial?</span>[/size]</p>
<ul>
<li>Adding a command panel for your server. The panel opens at server startup and allows you to input commands without being logged in.</li>
<li>Some tweaks on easier shops (opening a shop via an npc)</li>
<li>Adding complete shops via a command via the command pannel.<br>
-&gt; This is not like the programs you are used to see that generate the code for you to paste<br>
but actually automatically creating a file with the shopdata.<br>
Let me show you with some pictures:</li>
</ul>
<p><img src="http://i.imgur.com/lI8O1V9.png" alt width="161" height="81"></p>
<p><img src="http://i.imgur.com/EXeTyh9.png" alt width="161" height="81"></p>
<p><img src="http://i.imgur.com/uJw9Wqh.png" alt width="161" height="81"></p>
<p>[size=16pt]<span class="bbcode-b">Let’s get started</span>[/size]<br>
[size=14pt]Step 1: Making shops easier[/size]</p>
<p>[ul][li]Create a new java file called Shops.java[/li][/ul]</p>
<p><img src="http://i.imgur.com/bqL2sl3.png" alt width="161" height="81"></p>
<p>[ul][li]Paste this code into it:[/li][/ul]</p>
<p>[code=java]<br>
public class Shops {</p>
<pre><code>/**
 * @Author: RandQm
 * @Date: 12 March 2012
 * @Info: Handling the world shops.
 */

private client c;

public Shops(final client c) {
	this.c = c;
}

//This opens the shopping interface for a defined shopID
public void openShop (int shopId) {
	c.sendFrame(ShopHandler.ShopName[shopId], 3901);
	c.sendFrame248(3824, 3822);
	c.resetItems(3823);
	c.resetShop(shopId);
	c.IsShopping = true;
	c.MyShopID = shopId;
}

//This requests to open a shop for an npc
public void handleShops (int npc) {
	switch(npc) {
	
	//Example
	case 520: // The NPCIDs 520 and 521 are General Store owner and assistent
	case 521:
		openShop(10); //Shopid 10 gets opened
		break;
	}
}
</code></pre>
<p>}[/code]</p>
<p>[ul][li]Open your client.java and search (ctrl+f) for case 155:[/li]<br>
[li]you should see something like this:[/li][/ul]</p>
<p><code>case 17:
			// second Click npc
			NPCSlot = inStream.readUnsignedWordBigEndianA();</code></p>
<p>[ul][li]If you scroll down a bit and there are shops added in your server, you’ll see some of these:[/li][/ul]</p>
<p><code>if(NPCID == 534){
				PutNPCCoords = true;
				WanneShop = 42;
}
if(NPCID == 594){
				PutNPCCoords = true;
				WanneShop = 17; 
}</code></p>
<p>[ul][li]Remove all these, if you have 100+ errors upon compiling you will have accidentally remove a bracket that you shouldn’t have.[/li]<br>
[li]Where you removed all those things, add these lines instead:[/li][/ul]</p>
<p><code>PutNPCCoords = false;
			faceNPC(NPCSlot);
			getShops().handleShops(NPCID);</code></p>
<p>[ul][li]Now search for case 17 and do the same. Don’t forget also adding the new code pasted above ^.[/li]<br>
[li]Now at the top of your client class under something similar to this:[/li][/ul]</p>
<pre><code class="lang-auto">public class Client extends Player</code></pre>
<p>[ul][li]Add these lines:[/li][/ul]</p>
<p><code>private Shops shops = new Shops(this);
public Shops getShops() {
   return shops;
}</code><br>
[ul][/ul]</p>
<p>[size=14pt]Step 2: Adding the command panel and command system[/size]</p>
<p>[ul][li]Add a new java file again, called Panel.java this time[/li]<br>
[li]Add this bunch of code to it:[/li][/ul]</p>
<pre><code class="lang-auto">import java.awt.EventQueue;

import javax.swing.JFrame;
import javax.swing.JPanel;
import java.awt.BorderLayout;

import javax.swing.JTextField;
import javax.swing.JLabel;
import javax.swing.JButton;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

/**
 * @Author: RandQm
 * @Date: 19th of May 2013
 */

public class Panel {

	private JFrame frame;
	private JTextField commandField;
	private JPanel panel;
	private JButton sendCommand;
	
	private String version = "version 1";

	
	public Panel() {
		initialize();
	}
	
	/*
	 * Launching the program.
	 */
	public void launch() {
		EventQueue.invokeLater(new Runnable() {
			public void run() {
				try {
					Panel window = new Panel();
					window.frame.setVisible(true);
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		});
	}

	/*
	 * Controlling the command panel.
	 */
	private void initialize() {
		try {
			UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
		} catch (UnsupportedLookAndFeelException | ClassNotFoundException | InstantiationException | IllegalAccessException e) {
			System.out.println("Initialization error ocurred.");
			e.printStackTrace();
		}
		frame = new JFrame();
		frame.setResizable(false);
		frame.setTitle("Admin Panel " + version);
		frame.setBounds(100, 100, 577, 400);
		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		panel = new JPanel();
		frame.getContentPane().add(panel, BorderLayout.CENTER);
		panel.setLayout(null);
		
		commandField = new JTextField();
		commandField.setBounds(75, 8, 350, 20);
		panel.add(commandField);
		commandField.setColumns(10);

		sendCommand = new JButton("Send Command");
		sendCommand.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent arg0) {
				CommandManager.sendCommand(commandField.getText());
			}
		});
		sendCommand.setBounds(435, 7, 125, 23);
		panel.add(sendCommand);
		
		JLabel lblThreadLink = new JLabel("Command");
		lblThreadLink.setBounds(10, 11, 102, 14);
		panel.add(lblThreadLink);
	}

}</code></pre>
<p>[ul][li]Now open your Server.java and add this line with the similar other lines:[/li][/ul]</p>
<pre><code class="lang-auto">public static Panel panel = new Panel();</code></pre>
<p>[ul][li]Now search for this:[/li][/ul]</p>
<pre><code class="lang-auto">public static void main</code></pre>
<p>[ul][li]If you scroll down a bit, you’ll see lines like these in this method:[/li][/ul]</p>
<p><code>npcHandler = new NPCHandler();
		itemHandler = new ItemHandler();</code></p>
<p>[ul][li]Add this line with them:[/li][/ul]</p>
<pre><code class="lang-auto">panel.launch();</code></pre>
<p>[ul][li]Now we have added the panel we have to add the command system, therefore make again a new java file.<br>
This time we’ll call it CommandManager.java[/li]<br>
[li]Add this code into CommandManager.java[/li][/ul]</p>
<p>[code=java]public class CommandManager {</p>
<pre><code>public static void sendCommand(String command) {
	String[] args = command.split(" ");
	if (args.length &lt; 1)
		return;
	
	if (command.equalsIgnoreCase("test")) {
		System.out.println("RandQm Rocks");
	}
	
	if (command.startsWith("shop")) {
		Server.shopHandler.createShop(args);
	}
	
}
</code></pre>
<p>}[/code]<br>
[ul][/ul]</p>
<p>[size=14pt]Step 3: Adding the shopmaking command[/size]</p>
<p>[ul][li]Open your Shophandler.java and search for “boolean loadshops” and remove that whole method.[/li]<br>
[li]Add these 2 methods instead:[/li][/ul]</p>
<p>[code=java]public void createShop(String[] args) {<br>
if (Integer.parseInt(args[1]) &lt;= 0) {<br>
System.out.println(“You must use a positive number as shop ID.”);<br>
return;<br>
}<br>
if (Integer.parseInt(args[1]) &gt; 500) {<br>
System.out.println(“You can’t have more than 500 shops.”);<br>
return;<br>
}<br>
File file = new File(“Content\Shops\”+ args[1]);<br>
if (file.exists()) {<br>
System.out.println(“This shop ID already exists!”);<br>
return;<br>
} else {<br>
BufferedWriter bw = null;<br>
try {<br>
bw = new BufferedWriter(new FileWriter(“Content//Shops//” + args[1] + “.txt”, true));<br>
bw.write(args[2]);<br>
bw.newLine();<br>
for (int i = 3; i &lt; args.length; i++) {<br>
bw.write(args[i]);<br>
bw.newLine();<br>
}<br>
bw.flush();<br>
} catch (IOException ioe) {<br>
ioe.printStackTrace();<br>
} finally {<br>
if (bw != null)<br>
try {<br>
bw.close();<br>
} catch (IOException ioe2) {<br>
System.out.println(“Error writing log.”);<br>
ioe2.printStackTrace();<br>
}<br>
}<br>
}<br>
}</p>
<pre><code>public void loadShops() {
	for (int i = 1; i &lt; 500; i ++) {
		File file = new File("Content//Shops//" + i + ".txt");
		if (file.exists()) {
			try {
				Scanner s = new Scanner(new File("Content//Shops//" + i + ".txt"));
				ShopName[i] = s.nextLine();
				int j = 0;
				while (s.hasNextLine()) {
					int item = Integer.parseInt(s.nextLine()) + 1;
					int amount = Integer.parseInt(s.nextLine());
					ShopSModifier[i] = 2;
					ShopBModifier[i] = 2;
					ShopItems[i][j] = item;
					ShopItemsN[i][j] = amount;
					ShopItemsSN[i][j] = amount;
					ShopItemsStandard[i] ++;
					TotalShops++;
					j++;	
				}
			} catch (FileNotFoundException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
	}
}[/code]
</code></pre>
<p>[ul][li]Now search for “public ShopHandler()”, you’ll see this line: loadShops(“shops.cfg”);[/li]<br>
[li]Remove the “shops.cfg” so it looks like this:[/li][/ul]</p>
<pre><code class="lang-auto">loadShops();</code></pre>
<p>[ul][list][li]Now in the main folder of your server, add a folder called ‘Content’ and in that folder add one called ‘Shops’[/li]<br>
[li]If you get errors saying it couldn’t find files or folders you’ll have created the folders in a wrong directions[/li][/list]<br>
<img src="http://i.imgur.com/VBXIfzj.png" alt width="161" height="81">[/ul]</p>
<p>[size=16pt]<span class="bbcode-b">How exactly to add shops the right way?</span>[/size]</p>
<p>[ul][li]In your Content/Shops folder check what ID’s are in use if you already added shops.[/li]<br>
[li]Go into your shops.java and go the the ‘public void handleShops’ method.[/li]<br>
[li]Add the id of shop you want to open when clicking a specified npc.[/li][/ul]</p>
<p><code>		case 546: //The npc
			openShop(25); //The ID of shop you want to open when clicking npc 546
			break; </code></p>
<p>[ul][li]Now just run your server so the command pannel pops up and add a command in the following format:[/li][/ul]</p>
<pre><code class="lang-auto">shop shopID shopName item itemamount item itemamount</code></pre>
<p>[ul]//You can ofc add more items.[/ul]</p>
<p>[size=16pt]<span class="bbcode-b">This was it</span>[/size]</p>
<ul>
<li>If you have any questions, suggestions or errors let me know.</li>
<li>Feel free to add new commands to the command system obviously.</li>
<li>It’s more than likely possible that I par accident skipped something so don’t hesitate to post errors.<br>
(If you’re 100% sure that you correctly followed the tutorial and not just rushed thinking you know what you were doing)</li>
</ul>
<p>Credits:</p>
<ul>
<li>stackoverflow for learning Jframe and some help on fixing bugs on reading and writing files.</li>
<li>Delta, the used base</li>
<li>Me, RandQm, writing all the code</li>
</ul>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664/1</link>
        <pubDate>Mon, 20 May 2013 00:03:54 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-519664-1</guid>
        <source url="https://forum.moparisthebest.com/t/delta-command-panel-for-your-server-automated-shop-maker/519664.rss">[Delta] Command panel for your server + Automated shop maker</source>
      </item>
  </channel>
</rss>
