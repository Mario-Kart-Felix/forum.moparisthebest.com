<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/c-hashmap-free-memory/542915 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>C HashMap free memory - General Programming - moparisthebest.com</title>
    <meta name="description" content="Hi everyone! 

For school I had to write a hashmap in C. I&amp;#39;m not sure about the freeMemory function though, if anybody could check it I would really appreciate it! 

 #include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;stri&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="542915.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;C HashMap free memory&#39;" href="542915.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/c-hashmap-free-memory/542915" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/c-hashmap-free-memory/542915" />
<meta property="og:title" content="C HashMap free memory" />
<meta name="twitter:title" content="C HashMap free memory" />
<meta property="og:description" content="Hi everyone!  For school I had to write a hashmap in C.  I’m not sure about the freeMemory function though, if anybody could check it I would really appreciate it!  #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;strings.h&gt;  #define BUCKETS_SIZE 100  typedef char* ELEMENT;  typedef struct { 	ELEMENT key; 	ELEMENT value; } PAIR;  typedef struct node_structure { 	PAIR pair; 	struct node_structure* next; } NODE;  typedef struct { 	NODE* startNode; 	int size; } LINKEDLIST;  typedef struct { 	LINKED..." />
<meta name="twitter:description" content="Hi everyone!  For school I had to write a hashmap in C.  I’m not sure about the freeMemory function though, if anybody could check it I would really appreciate it!  #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;strings.h&gt;  #define BUCKETS_SIZE 100  typedef char* ELEMENT;  typedef struct { 	ELEMENT key; 	ELEMENT value; } PAIR;  typedef struct node_structure { 	PAIR pair; 	struct node_structure* next; } NODE;  typedef struct { 	NODE* startNode; 	int size; } LINKEDLIST;  typedef struct { 	LINKED..." />
<meta property="article:published_time" content="2014-05-08T13:44:26+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="542915.html">C HashMap free memory</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Kattoor.html'><span itemprop='name'>Kattoor</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-05-08T13:44:26Z'>
            <time itemprop='dateModified' datetime='2016-08-04T13:07:05Z' class='post-time'>
              August 4, 2016,  1:07pm
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Hi everyone!</p>
<p>For school I had to write a hashmap in C.<br>
I’m not sure about the freeMemory function though, if anybody could check it I would really appreciate it!</p>
<pre><code class="lang-auto">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;strings.h&gt;

#define BUCKETS_SIZE 100

typedef char* ELEMENT;

typedef struct {
	ELEMENT key;
	ELEMENT value;
} PAIR;

typedef struct node_structure {
	PAIR pair;
	struct node_structure* next;
} NODE;

typedef struct {
	NODE* startNode;
	int size;
} LINKEDLIST;

typedef struct {
	LINKEDLIST** buckets;
	int size;
} HASHMAP;

NODE* newNode(ELEMENT key, ELEMENT value) {
	NODE* node = malloc(sizeof(NODE));
	node-&gt;pair.key = key;
	node-&gt;pair.value = value;
	node-&gt;next = NULL;
	return node;
}

LINKEDLIST *newLinkedList() {
	LINKEDLIST *pLinkedList = malloc(sizeof(LINKEDLIST));
	pLinkedList-&gt;size = 0;
	pLinkedList-&gt;startNode = NULL;
	return pLinkedList;
}

HASHMAP* newMap() {
	HASHMAP* map = malloc(sizeof(HASHMAP));
	map-&gt;buckets = calloc(BUCKETS_SIZE, sizeof(LINKEDLIST*));
	map-&gt;size = 0;
	return map;
}

int hash(char* string) {
	int i, som = 0;
	for (i = 0; string[i] != '\0'; i++)
		som += string[i];
	return som % BUCKETS_SIZE;	
}

void put(HASHMAP* map,ELEMENT key, ELEMENT value) {
	NODE* node = newNode(key, value);	
	int h = hash(key);
	if (map-&gt;buckets[h] != NULL) {		
		LINKEDLIST* list = map-&gt;buckets[h];
		node-&gt;next = list-&gt;startNode;
		list-&gt;startNode = node;
		list-&gt;size++;
	} else {
		LINKEDLIST* list = newLinkedList();
		map-&gt;buckets[h] = list;
		list-&gt;startNode = node;
		list-&gt;size++;				
	}
}

ELEMENT get(HASHMAP* map,ELEMENT key) {
	int h = hash(key);
	if (map-&gt;buckets[h] == NULL) {
		return NULL; //key bestaat niet
	} else {
		LINKEDLIST* list = map-&gt;buckets[h];
		int i;
		NODE* temp = list-&gt;startNode;
		for (i = 0; i &lt; list-&gt;size; i++) {
			if (!strcmp(temp-&gt;pair.key, key))
				return temp-&gt;pair.value;
			else
				temp = temp-&gt;next;						
		}
	}
	return NULL;
}

void removePair(HASHMAP* map, ELEMENT key) {
	int index = hash(key);
	LINKEDLIST *deList = map-&gt;buckets[index];
	NODE* nodePrev = deList-&gt;startNode;
	NODE* node = deList-&gt;startNode;
	if (node-&gt;next == NULL) { // bucket wordt leeg!
		map-&gt;buckets[index] = NULL;
		map-&gt;size--;
		free(node);
	} else {
		while (node-&gt;pair.key != key) {
			nodePrev = node;
			node = node-&gt;next;
		}
		NODE* temp = node;
		if (node == deList-&gt;startNode) {
			deList-&gt;startNode = node-&gt;next;
		} else {
			nodePrev-&gt;next = node-&gt;next;
		}
		free(temp);
		deList-&gt;size--;
		map-&gt;size--;
	}
}

void printMap(HASHMAP* map) {
	int i;	
	for (i = 0; i &lt; BUCKETS_SIZE; i++) {
		if (map-&gt;buckets[i] != NULL) {
			LINKEDLIST* theList = map-&gt;buckets[i];
			NODE *indexNode = theList-&gt;startNode;
			int j;
			for (j = 0; j &lt; theList-&gt;size; j++) {
				printf("%s: %s\t",indexNode-&gt;pair.key,indexNode-&gt;pair.value);
				indexNode = indexNode-&gt;next;
			}
			printf("\n");
		}
	}
}

void freeMemory(HASHMAP* map) {
	int i, j;
	for (i = 0; i &lt; BUCKETS_SIZE; i++) {		
		if (map-&gt;buckets[i] != NULL) {						
			NODE* temp = map-&gt;buckets[i]-&gt;startNode;
			for (j = 0; j &lt; map-&gt;buckets[i]-&gt;size; j++) {
				NODE* next = temp-&gt;next;
				free(temp);
				temp = next;
			}
		}
		free(map-&gt;buckets[i]);
	}
	free(map-&gt;buckets);
	free(map);
}

int main() {
	printf("----HashMap test----\n\n");
	
	printf("--Hash test--\n");
	char *str1 = "Test 1";
	char *str2 = "Test 2";
	char *str3 = "Test 3";
	printf("hash (%s) = %d\n", str1, hash(str1));
	printf("hash (%s) = %d\n", str2, hash(str2));
	printf("hash (%s) = %d\n", str3, hash(str3));
	
	printf("\n--Map test--\n");
	HASHMAP* map = newMap();
	put(map, str1, "0486/11.33.23");
	put(map, str2, "0486/10.20.30");
	put(map, str3, "0475/11.39.12");
	printMap(map);

	
	printf("\nFirst: %s: %s\n", str1, get(map, str1));
	printf("Second %s: %s\n", str2, get(map, str2));
	
	freeMemory(map);
	return 0;
}</code></pre>
      </div>

      <meta itemprop='headline' content='C HashMap free memory'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/_s11.html'><span itemprop='name'>_s11</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-05-13T18:37:22Z'>
            <time itemprop='dateModified' datetime='2016-08-04T13:07:57Z' class='post-time'>
              August 4, 2016,  1:07pm
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>valgrind?</p>
      </div>

      <meta itemprop='headline' content='C HashMap free memory'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Slave_Scyth.html'><span itemprop='name'>Slave_Scyth</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-05-13T19:38:49Z'>
            <time itemprop='dateModified' datetime='2016-08-04T13:07:58Z' class='post-time'>
              August 4, 2016,  1:07pm
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’m not sure what you think’s wrong with the freeMemory function. Looks good to me.</p>
<p>That was pretty fun to read through for some reason. Good job.</p>
<p>German?</p>
      </div>

      <meta itemprop='headline' content='C HashMap free memory'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="1" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Kattoor.html'><span itemprop='name'>Kattoor</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2014-05-15T07:43:17Z'>
            <time itemprop='dateModified' datetime='2016-08-04T13:08:20Z' class='post-time'>
              August 4, 2016,  1:08pm
            </time>
        <span itemprop='position'>#4</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <aside class="quote" data-post="2" data-topic="542915">
<div class="title">
<div class="quote-controls"></div>
 s1gma:</div>
<blockquote>
<p>valgrind?</p>
</blockquote>
</aside>
<p>Thanks, didn’t know about that!</p>
<p>[quote=“Slave Scyth, post:3, topic:542915”]I’m not sure what you think’s wrong with the freeMemory function. Looks good to me.</p>
<p>That was pretty fun to read through for some reason. Good job.</p>
<p>German?[/quote]<br>
I wasn’t sure how to check if it worked and since I just took a couple of classes I wasn’t completely sure<br>
Thanks (:<br>
And Dutch actually <img src="../../images/emoji/twitter/stuck_out_tongueae52.png?v=5" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
      </div>

      <meta itemprop='headline' content='C HashMap free memory'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/c-hashmap-free-memory/542915 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:06:23 GMT -->
</html>
