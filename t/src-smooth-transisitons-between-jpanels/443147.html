<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/src-smooth-transisitons-between-jpanels/443147 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:11:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[SRC] Smooth transisitons between JPanels - General Programming - moparisthebest.com</title>
    <meta name="description" content="I&amp;#39;m working on a project atm, and I wanted a nice way to be able to switch the content currently being shown (it&amp;#39;s paginated content).  Initially I tried adding and removing the components and altering the values directl&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="443147.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[SRC] Smooth transisitons between JPanels&#39;" href="443147.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/src-smooth-transisitons-between-jpanels/443147" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/src-smooth-transisitons-between-jpanels/443147" />
<meta property="og:title" content="[SRC] Smooth transisitons between JPanels" />
<meta name="twitter:title" content="[SRC] Smooth transisitons between JPanels" />
<meta property="og:description" content="I’m working on a project atm, and I wanted a nice way to be able to switch the content currently being shown (it’s paginated content).  Initially I tried adding and removing the components and altering the values directly - needless to say this did not work.  When I finally did come up with a solution that did work I had all sorts of problems due to swing being an asshole.  The solution I eventually came up with was to use a JLayeredPane as the content area so that the transition could be shown ..." />
<meta name="twitter:description" content="I’m working on a project atm, and I wanted a nice way to be able to switch the content currently being shown (it’s paginated content).  Initially I tried adding and removing the components and altering the values directly - needless to say this did not work.  When I finally did come up with a solution that did work I had all sorts of problems due to swing being an asshole.  The solution I eventually came up with was to use a JLayeredPane as the content area so that the transition could be shown ..." />
<meta property="article:published_time" content="2012-05-26T09:40:04+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="443147.html">[SRC] Smooth transisitons between JPanels</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/newbiehacker.html'><span itemprop='name'>newbiehacker</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-05-26T09:40:04Z'>
            <time itemprop='dateModified' datetime='2016-08-03T02:51:09Z' class='post-time'>
              August 3, 2016,  2:51am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>I’m working on a project atm, and I wanted a nice way to be able to switch the content currently being shown (it’s paginated content).  Initially I tried adding and removing the components and altering the values directly - needless to say this did not work.  When I finally did come up with a solution that did work I had all sorts of problems due to swing being an asshole.</p>
<p>The solution I eventually came up with was to use a JLayeredPane as the content area so that the transition could be shown ABOVE the component, this removes flicker when adding/removing components and it also means we can have the new component in place while the transition is showing… cool, huh?<br>
To do the transisitons I simply paint the components to a BufferedImage, then use a Transition (a class defined near the bottom of the source) to tween between them.</p>
<p>Without further ado:</p>
<p>[code=java5]import javax.swing.<em>;<br>
import java.awt.</em>;<br>
import java.awt.image.BufferedImage;</p>
<p>public class SmoothPageTransitioner extends JPanel implements Runnable {<br>
private JLayeredPane target;<br>
private JComponent old;<br>
private JComponent newP;<br>
private Thread thread;<br>
private boolean run = true;<br>
private long time;<br>
private int type;<br>
private BufferedImage back;</p>
<pre><code>private SmoothPageTransitioner(JLayeredPane target, JComponent old, JComponent newP, long time, int type) {
    setOpaque(false);
    int width = old == null ? target.getWidth() : old.getWidth();
    int height = old == null ? target.getHeight() : old.getHeight();
    setPreferredSize(new Dimension(width, height));
    setSize(width, height);
    this.target = target;
    this.old = old;
    this.newP = newP;
    this.time = time;
    this.type = type;
}

@Override
public void run() {
    try {
        int width = old == null ? target == null? getWidth(): target.getWidth() : old.getWidth();
        int height = old == null ? target == null? getHeight(): target.getHeight() : old.getHeight();

        if (old != null)
            prepare(old);
        prepare(target);
        prepare(newP);

        back = clear(new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB), target.getBackground());
        BufferedImage oi = clear(new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB), target.getBackground());
        if (old != null)
            old.paint(oi.getGraphics());
        Graphics2D t = back.createGraphics();
        t.drawImage(oi, 0, 0, null);
        target.add(this, JLayeredPane.PALETTE_LAYER);
        if(old != null)
            target.remove(old);
        newP.setSize(width, height);
        newP.setPreferredSize(new Dimension(width, height));
        target.add(newP);
        target.revalidate();

        BufferedImage ni = clear(new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB), target.getBackground());
        newP.paint(ni.getGraphics());


        long curTime = System.currentTimeMillis();
        long start = curTime;
        while ((curTime = System.currentTimeMillis()) - start &lt; time &amp;&amp; run) {
            t.setPaintMode();

            // transition
            transitions[type].transition((int) (time / 20), (int) ((curTime - start) / 20), t, oi, ni, width, height);
            repaint();

            try {
                Thread.sleep(20);
            } catch (InterruptedException ignore) {
                ignore.printStackTrace();
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    target.remove(this);
    target.revalidate();
    target.repaint();
}

private static void prepare(JComponent jc) {
    // swing sucks, if the component is double buffered then you get all sorts of shitty artifacts..
    for (Component c : jc.getComponents())
        if (c instanceof JComponent)
            prepare((JComponent) c);
    jc.setDoubleBuffered(false);
}

public void stop() {
    // stop this transition (just skips the rest of the animation...)
    run = false;
    try {
        thread.join();
    } catch (InterruptedException e) {

    }
}

public void paint(Graphics g) {
    g.drawImage(back, 0, 0, null);
}

public void update(Graphics g) {
    paint(g);
}

public static void stopTransition(Container t) {
    // Check for transition in progress
    SmoothPageTransitioner oldTran = null;
    for (Component c : t.getComponents()) {
        if (c instanceof SmoothPageTransitioner) {
            oldTran = (SmoothPageTransitioner) c;
            break;
        }
    }
    if (oldTran != null)
        oldTran.stop(); // stop last transition
}

public static void transition(JLayeredPane target, JPanel old, JPanel newP, int time, int type) {
    if (type == -1)
        type = (int) (Math.random() * transitions.length);
    if (time == -1)
        time = transitions[type].defaultTime;

    SmoothPageTransitioner r = new SmoothPageTransitioner(target, old, newP, time, type);
    Thread t = new Thread(r);
    t.setPriority(1);
    t.setDaemon(true);
    t.start();
    r.thread = t;
}

private static BufferedImage clear(BufferedImage bi, Color c) {
    Graphics g = bi.getGraphics();
    g.setColor(c);
    g.fillRect(0, 0, bi.getWidth(), bi.getHeight());
    return bi;
}

private static float getFadeAlpha(int elapsed, int time) {
    return (float) elapsed * (1.0f / (float) time);
}

static abstract class Transition {
    protected int defaultTime = 500;

    public abstract void transition(int time, int elapsed, Graphics2D g, BufferedImage oi, BufferedImage ni, int width, int height);
}

public static Transition fadeOut = new Transition() {
    @Override
    public void transition(int time, int elapsed, Graphics2D g, BufferedImage oi, BufferedImage ni, int width, int height) {
        float alpha = getFadeAlpha(elapsed, time);
        g.drawImage(ni, 0, 0, null);
        g.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_ATOP, 1f - alpha));
        g.drawImage(oi, 0, 0, null);
    }
};
public static Transition fadeOutIn = new Transition() {
    {
        defaultTime = 1000;
    }

    @Override
    public void transition(int time, int elapsed, Graphics2D g, BufferedImage oi, BufferedImage ni, int width, int height) {
        // fade to 0 within half the time...
        int pic = elapsed &lt; time / 2 ? 0 : 1;
        float alpha = getFadeAlpha(elapsed, time) * 2;
        if (pic == 1)
            alpha = 1f - (alpha - 1f);
        if(alpha &gt; 1)
            alpha = 1f;
        if(alpha &lt; 0)
            alpha = 0f;

        g.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_ATOP, 1f - alpha));
        if (pic == 0)
            g.drawImage(oi, 0, 0, width, height, null);
        else
            g.drawImage(ni, 0, 0, width, height, null);
    }
};

public static Transition slideRight = new Transition() {
    @Override
    public void transition(int time, int elapsed, Graphics2D g, BufferedImage oi, BufferedImage ni, int width, int height) {
        float off = width / (float) time * elapsed;
        int x = (int) off;
        g.drawImage(oi, x, 0, null);
        g.drawImage(ni, -width + x, 0, null);
    }
};

public static Transition slideLeft = new Transition() {
    @Override
    public void transition(int time, int elapsed, Graphics2D g, BufferedImage oi, BufferedImage ni, int width, int height) {
        float off = width / (float) time * elapsed;
        int x = (int) off;
        g.drawImage(oi, -x, 0, null);
        g.drawImage(ni, width - x, 0, null);
    }
};

public static Transition slideUp = new Transition() {
    @Override
    public void transition(int time, int elapsed, Graphics2D g, BufferedImage oi, BufferedImage ni, int width, int height) {
        float off = height / (float) time * elapsed;
        int y = (int) off;
        g.drawImage(oi, 0, -y, null);
        g.drawImage(ni, 0, height - y, null);
    }
};

static Transition[] transitions = {fadeOut, fadeOutIn, slideRight, slideLeft, slideUp};
</code></pre>
<p>}[/code]</p>
<p>To re-iterate: to use this source you MUST have your content area as a JLayeredPane (the SmoothPageTransitioner sits on the JLayeredPane.PALETTE_LAYER to remove flicker), and the 2 pages must be subcomponents of JPanel.</p>
<p>Simply call</p>
<pre><code class="lang-auto"></code></pre>
<p>EDIT: As requested, I took a video of the current transitions in action (don’t forget you can write your own, e.g. shrink, grow, spin, whatever!):<br>
[youtube]<a href="http://www.youtube.com/watch?v=7BPHmD6EVT4%5B/youtube%5D" rel="nofollow noopener">http://www.youtube.com/watch?v=7BPHmD6EVT4[/youtube]</a></p>
      </div>

      <meta itemprop='headline' content='[SRC] Smooth transisitons between JPanels'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>

          <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
          </div>

  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/Smokey2.html'><span itemprop='name'>Smokey2</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2012-12-22T17:57:00Z'>
            <time itemprop='dateModified' datetime='2016-08-04T01:51:25Z' class='post-time'>
              August 4, 2016,  1:51am
            </time>
        <span itemprop='position'>#2</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>It could have been as easy as applying a fade-in, and at the utmost density call these:</p>
<pre><code class="lang-auto">            contentPane.remove(firstPanel);
            contentPane.add(secondPane);
            contentPane.validate();</code></pre>
<p>Then fade back out. Or you could just let them see the switch, it’s faster then the naked eye can see anyway.<br>
That is pretty awesome though. If you were purposely going for slideshow transition effects to begin with when “swing was being an asshole” then this seems more ethical. I don’t fully understand your intentions though, so don’t think I’m casting judgement…</p>
<p>The topic is 120 days old but has no posts and is still on the first page… That doesn’t count as grave digging does it?</p>
      </div>

      <meta itemprop='headline' content='[SRC] Smooth transisitons between JPanels'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>
  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/newbiehacker.html'><span itemprop='name'>newbiehacker</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-01-11T17:02:16Z'>
            <time itemprop='dateModified' datetime='2016-08-04T02:08:12Z' class='post-time'>
              August 4, 2016,  2:08am
            </time>
        <span itemprop='position'>#3</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>that would be one of the 4 transitions.  I’d like to see you do the others without doing bitmap manipulation xD</p>
      </div>

      <meta itemprop='headline' content='[SRC] Smooth transisitons between JPanels'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/src-smooth-transisitons-between-jpanels/443147 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:11:30 GMT -->
</html>
