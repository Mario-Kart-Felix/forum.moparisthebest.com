<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Construct map region explained [639]</title>
    <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429</link>
    <description>The point of this tutorial is to explain how to use it in 634+ revision
I am not releasing the packet itself but what you send when using and what to expect

Before I get into explaining the packet ill start by explaining the basics
this packet is used to construct a map from 8*8 tile chunks
the maxium map size is 12*12 chunks (8*8 sqaure)
You can take 8*8 sqaures from any place in runescape (you could have a chunk of falador, lumbridge, varrock, and even nex&#39;s lair all in your constructed map)

Okay for the 639 revision the packet header is 31 variable short
the first thing sent is the loading type, 1 telling the client to construct the map (not fully done researching this yet)
The next two things sent are the what I call the placement offset
how this work is you send
(player.getX() &gt;&gt; 3) + offset
(player.getY() &gt;&gt; 3) + offset
0 for offset is center of map positive x offset sends you to the right and negative sends you to the left and for y possitive sends you up and negative sends you down
how this works is for the offset itll send you that many 8*8 squares away (not changing your placement in the 8*8 square)
this allows you to place a player to an exact tile on the map
Ex. Tzhaar fight caves is roughly 8 squares wide and long so if I want the map to appear with him at the exit in the cave id have to do
(player.getX() &gt;&gt; 3) - 7 (theres one 8*8 sqaure to the left of the exit
(player.getY() &gt;&gt; 3) - 8
now the next thing sent is what I believe is sometime to do with map size, for this I just send 0
and finaly the fun part, sending your map you created
for this you use a loop and send the data as bits, this is what loop should look like
[code]
for(int z = 0; z &lt; 4; z++) {
        for(int x = 0; x &lt; 13; x++) {
                for(int y = 0; y &lt; 13; x++) {
                        if(z == player.getHeight()) {
                                regions.add(regionId); //stores the region the 8*8 sqaures uses
                                writeBits(26, (palette stuff here));
                        } else {
                               writeBit(1, 1);
                        }
                }
        }
}
[/code]
I have the palettes set up like this
private int[][][][] palette = new int[4][4][13][13];
set up is [type][height][x][y] type being x/y/height/rotation of the palette
the value should be
x = (x coordinate of palette) &gt;&gt; 3
y = (y coordinate of palette) &gt;&gt; 3
height = height of palette
rotation = rotation of palette (0 for normal/no rotation)
for example if I want a chunk of lumbridge in my map id do
palette[0][0][5][5] = 3200 &gt;&gt; 3; // 3200 &gt;&gt; 3 = 400, x coordinate
palette[1][0][5][5] = 3200 &gt;&gt; 3; // y coordinate
palette[2][0][5][5] = 0; // height (ground level)
palette[3][0][5][5] = 0; // rotation (no rotation)[hr]
Thatll make a 8*8 square from lumbridge appear bottom left center on map (center is made up of 4 8*8 squares, 5-5 5-6 6-5 6-5)
finaly we send the xtea keys (widely known as mapdata) of all the palettes use
to get the region id you use (x &gt;&gt; 3) | (y &gt;&gt; 3) &lt;&lt; 8

I typed all this on my phone do sorry for any typos</description>
    
    <lastBuildDate>Fri, 12 Aug 2011 16:34:53 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@Zach1 Zach.]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1">@Zach1</a> wrote:</p>
          <blockquote>
              <p>Thank you steven, atleast im not the only one here confused by what discarded is saying. Aparently im doing this wrong even though it works perfectly on dementhium and he has yet to prove how this is wrong</p>
<p>Edit: idk bout you but it seems like runescape only sends the plane your on - <a href="http://www.youtube.com/watch?v=rl6z8noMlss&amp;feature=youtube_gdata_player" rel="nofollow noopener">http://www.youtube.com/watch?v=rl6z8noMlss&amp;feature=youtube_gdata_player</a></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/23">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/23</link>
        <pubDate>Fri, 12 Aug 2011 16:34:53 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-23</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@Mystic_Floe Mystic Floe]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/mystic_floe">@Mystic_Floe</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="21" data-topic="409429">
<div class="title">
<div class="quote-controls"></div>
 `Discardedx2`:</div>
<blockquote>
<p>fuck and they got rid of me only to get a retard like you?</p>
</blockquote>
</aside>
<p>This “retard” doesn’t constantly need help like you do, you wouldn’t know crap if no one explained it to you, you’d probably still be doing it the wrong way if no one told you how it actually worked so hop off, you can prove us wrong the day you find something in the client that you found out all by yourself.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/22">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/22</link>
        <pubDate>Fri, 12 Aug 2011 15:26:49 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-22</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@_Discardedx21 `Discardedx2`]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/_discardedx21">@_Discardedx21</a> wrote:</p>
          <blockquote>
              <p>[quote=“Zach., post:20, topic:409429”]Wow do you have the comprehension of a 6th grader?<br>
okay the relationship between the client and server is a connection, player, entity (all right)<br>
its can be called a connection because the client and server are connected through networking, it can be called player because thats what the person using the client thats connected to the server is described as, and it can be called an entity (which is self explanitory) the point of my post was to show that some names are more specific than others yet all names are correct.<br>
also a player is represented by an entity not itself one, an entity in programing terms (shortened) is a group of classes that share or use the same data[/quote]</p>
<p>fuck and they got rid of me only to get a retard like you?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/21">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/21</link>
        <pubDate>Fri, 12 Aug 2011 12:33:03 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-21</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@Zach1 Zach.]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1">@Zach1</a> wrote:</p>
          <blockquote>
              <p>Wow do you have the comprehension of a 6th grader?<br>
okay the relationship between the client and server is a connection, player, entity (all right)<br>
its can be called a connection because the client and server are connected through networking, it can be called player because thats what the person using the client thats connected to the server is described as, and it can be called an entity (which is self explanitory) the point of my post was to show that some names are more specific than others yet all names are correct.<br>
also a player is represented by an entity not itself one, an entity in programing terms (shortened) is a group of classes that share or use the same data</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/20">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/20</link>
        <pubDate>Fri, 12 Aug 2011 03:29:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-20</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@_Discardedx21 `Discardedx2`]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/_discardedx21">@_Discardedx21</a> wrote:</p>
          <blockquote>
              <p>[quote=“Zach., post:18, topic:409429”]You finaly done raging about stupid pointless shit discarded?<br>
Btw not including information doesnt make me wrong it just allows people to research the client and learn more<br>
also naming is universal just because runescape calls it something doesnt mean its the only way to call/describe it. For instance player, entity, connection can all describe the relation between the client and the server they are all right even tho one can be more specific[/quote]</p>
<p>no, because a player is an entity</p>
<p>player,npc -&gt; actor<br>
actor -&gt; mobile<br>
mobile -&gt; animable<br>
animable -&gt; entitynode</p>
<p><img src="http://i.imgur.com/IV05x.jpg" alt width="500" height="340"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/19</link>
        <pubDate>Fri, 12 Aug 2011 03:05:33 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-19</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@Zach1 Zach.]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1">@Zach1</a> wrote:</p>
          <blockquote>
              <p>You finaly done raging about stupid pointless shit discarded?<br>
Btw not including information doesnt make me wrong it just allows people to research the client and learn more<br>
also naming is universal just because runescape calls it something doesnt mean its the only way to call/describe it. For instance player, entity, connection can all describe the relation between the client and the server they are all right even tho one can be more specific</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/18</link>
        <pubDate>Fri, 12 Aug 2011 03:02:56 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-18</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@sinisoul sini]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sinisoul">@sinisoul</a> wrote:</p>
          <blockquote>
              <p>[quote="<code>Discardedx2</code>, post:15, topic:409429"][quote author=Zach. link=topic=510712.msg3707357#msg3707357 date=1313115060]<br>
Hmm so you bitched about me about naming and for the not giving the formulas out<br>
for one I used names that I thought people would understand better not what I call them, secondly you say I have no clue what im talking about yet I can use the packet to its full potential.<br>
your little loop there only copied an area which is not what its mainly ment for, its designed for construction and dungeoneering also [editting post to add more]<br>
ok first off whats (104<em>104 &gt;&gt; 4) &lt;&lt; 4, its 96</em>96<br>
secondly the reason you dont get a decimal is not because its a integer field but because binary shifting returns full integers only, eveb if u binary shift a<br>
[/quote]</p>
<p>nah i bitched cause u dont know what your talking about… and you didnt even help make this. i helped steven make it more than any of you did, and he just ripped it from graham anyways. i just showed that you guys do it completely wrong[/quote]</p>
<p>Learn2 capitalize your sentences.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/17</link>
        <pubDate>Fri, 12 Aug 2011 02:42:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-17</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@Zach1 Zach.]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1">@Zach1</a> wrote:</p>
          <blockquote>
              <p>Oh really now, ask steven I redid the packet he had, and I dont really know what im talking about? What in my thread is wrong besides non included information?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/16</link>
        <pubDate>Fri, 12 Aug 2011 02:38:12 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-16</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@_Discardedx21 `Discardedx2`]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/_discardedx21">@_Discardedx21</a> wrote:</p>
          <blockquote>
              <p>[quote=“Zach., post:13, topic:409429”]Hmm so you bitched about me about naming and for the not giving the formulas out<br>
for one I used names that I thought people would understand better not what I call them, secondly you say I have no clue what im talking about yet I can use the packet to its full potential.<br>
your little loop there only copied an area which is not what its mainly ment for, its designed for construction and dungeoneering also [editting post to add more]<br>
ok first off whats (104<em>104 &gt;&gt; 4) &lt;&lt; 4, its 96</em>96<br>
secondly the reason you dont get a decimal is not because its a integer field but because binary shifting returns full integers only, eveb if u binary shift a[/quote]</p>
<p>nah i bitched cause u dont know what your talking about… and you didnt even help make this. i helped steven make it more than any of you did, and he just ripped it from graham anyways. i just showed that you guys do it completely wrong</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/15</link>
        <pubDate>Fri, 12 Aug 2011 02:35:05 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-15</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@sinisoul sini]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sinisoul">@sinisoul</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="12" data-topic="409429">
<div class="title">
<div class="quote-controls"></div>
 `Discardedx2`:</div>
<blockquote>
<p>all the evidence you need is in the client. p.s a palette refers only to colours, yet the “build palette” and “send palette” or w/e you call them don’t have anything to do with colours, they just project objects onto the viewport. pls stop being so ignorant and accept that i do know what im talking about</p>
</blockquote>
</aside>
<p>Don’t call me ignorant because my naming is slightly different to yours, I use the term palette to define the area that you define as the view port. Lets not turn into an arrogant ass alright?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/14</link>
        <pubDate>Fri, 12 Aug 2011 02:33:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-14</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@Zach1 Zach.]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1">@Zach1</a> wrote:</p>
          <blockquote>
              <p>Hmm so you bitched about me about naming and for the not giving the formulas out<br>
for one I used names that I thought people would understand better not what I call them, secondly you say I have no clue what im talking about yet I can use the packet to its full potential.<br>
your little loop there only copied an area which is not what its mainly ment for, its designed for construction and dungeoneering also.<br>
ok first off whats (104<em>104 &gt;&gt; 4) &lt;&lt; 4, its 96</em>96<br>
secondly the reason you dont get a decimal is not because its a integer field but because binary shifting returns full integers only, even if u binary shift a double or float you will still only get a full integer<br>
ok for viewport “depth” I left that out for the sake that im on my phone and also another reason why I didnt include formulas<br>
the height thing is just there cause I didnt have the patients to type all the checks of the “sector”</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/13</link>
        <pubDate>Fri, 12 Aug 2011 02:11:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-13</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@_Discardedx21 `Discardedx2`]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/_discardedx21">@_Discardedx21</a> wrote:</p>
          <blockquote>
              <p>all the evidence you need is in the client. p.s a palette refers only to colours, yet the “build palette” and “send palette” or w/e you call them don’t have anything to do with colours, they just project objects onto the viewport. pls stop being so ignorant and accept that i do know what im talking about</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/12</link>
        <pubDate>Fri, 12 Aug 2011 02:01:04 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-12</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@sinisoul sini]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sinisoul">@sinisoul</a> wrote:</p>
          <blockquote>
              <aside class="quote quote-modified" data-post="10" data-topic="409429">
<div class="title">
<div class="quote-controls"></div>
 `Discardedx2`:</div>
<blockquote>
<p>was talking about zach, i didnt even read your post. also the packets aren’t region update packets, they update the viewport. “dynamic viewport” and “static viewport”</p>
</blockquote>
</aside>
<p>Until I have evidence that proves me wrong, I will continue to call it ‘Update Palette’ and ‘Build Palette’.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/11</link>
        <pubDate>Fri, 12 Aug 2011 01:21:33 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-11</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@_Discardedx21 `Discardedx2`]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/_discardedx21">@_Discardedx21</a> wrote:</p>
          <blockquote>
              <p>was talking about zach, i didnt even read your post. also the packets aren’t region update packets, they update the viewport. “dynamic viewport” and “static viewport”</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/10</link>
        <pubDate>Fri, 12 Aug 2011 00:51:48 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-10</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@sinisoul sini]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sinisoul">@sinisoul</a> wrote:</p>
          <blockquote>
              <p>[quote="<code>Discardedx2</code>, post:8, topic:409429"]I helped steven a lot with this packet. anyways you guys do it wrong, and most of the info on this thread is wrong.</p>
<p>First of all, learn to calculate the depth of a region properly.</p>
<pre><code class="lang-auto">int depth = pos.getViewportSize() &gt;&gt; 4;
for (int plane = 0; plane &lt; 4; plane++) {
			for (int viewportBlockX = (sectorX - depth); viewportBlockX &lt;= (sectorX + depth); viewportBlockX++) {
				for (int viewportBlockY = (sectorY - depth); viewportBlockY &lt;= (sectorY + depth); viewportBlockY++) {[/code]
Where sectorX/Y represent the 64x64 tile location of a player. Viewport size is represented by how many tiles you can see in your viewport. there are 4 possible sizes, but ill leave you to figure those out. the one everyone uses by default is 6 ( 104 &gt;&gt; 4 = 6.5, but rounded down because it's not a double or float and integer fields dont support decimal values). Secondly, the reason why you left out the what you call "palette" hash is because you don't have it, seeing as you don't have a proper region system. for anyone wondering what the actual hash is it's:

[code]	@Override
	public int hashCode() {
		return ((rotation.direction &lt;&lt; 1) | (plane &lt;&lt; 24) | (sectorX &lt;&lt; 14) | (sectorY &lt;&lt; 3));
	}</code></pre>
<p>Thirdly, the way you do this looks soo much more mind boggling than it has to be. You can simply use two loops and a list. one loop for calculating the coordinates of the new region and writing the bits for the hash to the client, the other for sending the integers to the client for xtea keys. Fourthly… you do</p>
<pre><code class="lang-auto">if(z == player.getHeight()) {</code></pre>
<p>The whole point of the hash is to always write the hash, not only when it’s on your player’s plane. you could run into some issues doing it this way. Four. the way you do this probably won’t work if you send directly on login, which is another way to tell your doing the packet wrong. Five. To generate the sector info for a region this is all you have to do when you create a region…</p>
<p><code>	public void setDefaultSectorInfo() {
		for (int plane = 0; plane &lt; 4; plane++) {
			for (int x = 0; x &lt; 8; x++) {
				for (int y = 0; y &lt; 8; y++) {
					int sectorX = (position.getSectorX() &lt;&lt; 3) + x;
					int sectorY = (position.getSectorY() &lt;&lt; 3) + y;
					sectorInfo[plane][x][y] = new SectorInfo(sectorX, sectorY, plane, Rotation.WEST);
				}
			}
		}
	}</code></p>
<p>That will set the default sector information. anyways i’m done here, i was just trying to imply that you shouldn’t post about something you truly know nothing about. this list could go on and on, but i don’t feel like being a dick anymore</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="http://i.imgur.com/VHCDU.png" title="VHCDU.png" rel="nofollow noopener"><img src="http://i.imgur.com/VHCDU.png" alt width="690" height="450"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">VHCDU.png</span><span class="informations">763×498</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>edit:</p>
<p>also you should always write 1 or 0 before sending the hash.  i see you only send 26 bits OR 0… which is wrong</p>
<p>edit2:<br>
looks like you ripped this off graham’s post on r-s</p>
<p>rune- <a href="http://server.org/runescape-development/rs-503-client-server/tutorials/166139-real-construct-map-region-packet-rs2hd.html" rel="nofollow noopener">server.org/runescape-development/rs-503-client-server/tutorials/166139-real-construct-map-region-packet-rs2hd.html</a></p>
<p>no spaces[/quote]</p>
<p>I had my information right. Graham used some bad terms by the way, ‘Tile’ refers to a 1 x 1 space on the map which is either known as a coordinate. He should have used sector or possibly chunk to describe what you were writing because I was very confused until I rewrote that piece of the client.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/9</link>
        <pubDate>Fri, 12 Aug 2011 00:50:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-9</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@_Discardedx21 `Discardedx2`]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/_discardedx21">@_Discardedx21</a> wrote:</p>
          <blockquote>
              <p>I helped steven a lot with this packet. anyways you guys do it wrong, and most of the info on this thread is wrong.</p>
<p>First of all, learn to calculate the depth of a region properly.</p>
<pre><code class="lang-auto">int depth = pos.getViewportSize() &gt;&gt; 4;
for (int plane = 0; plane &lt; 4; plane++) {
			for (int viewportBlockX = (sectorX - depth); viewportBlockX &lt;= (sectorX + depth); viewportBlockX++) {
				for (int viewportBlockY = (sectorY - depth); viewportBlockY &lt;= (sectorY + depth); viewportBlockY++) {[/code]
Where sectorX/Y represent the 64x64 tile location of a player. Viewport size is represented by how many tiles you can see in your viewport. there are 4 possible sizes, but ill leave you to figure those out. the one everyone uses by default is 6 ( 104 &gt;&gt; 4 = 6.5, but rounded down because it's not a double or float and integer fields dont support decimal values). Secondly, the reason why you left out the what you call "palette" hash is because you don't have it, seeing as you don't have a proper region system. for anyone wondering what the actual hash is it's:

[code]	@Override
	public int hashCode() {
		return ((rotation.direction &lt;&lt; 1) | (plane &lt;&lt; 24) | (sectorX &lt;&lt; 14) | (sectorY &lt;&lt; 3));
	}</code></pre>
<p>Thirdly, the way you do this looks soo much more mind boggling than it has to be. You can simply use two loops and a list. one loop for calculating the coordinates of the new region and writing the bits for the hash to the client, the other for sending the integers to the client for xtea keys. Fourthly… you do</p>
<pre><code class="lang-auto">if(z == player.getHeight()) {</code></pre>
<p>The whole point of the hash is to always write the hash, not only when it’s on your player’s plane. you could run into some issues doing it this way. Four. the way you do this probably won’t work if you send directly on login, which is another way to tell your doing the packet wrong. Five. To generate the sector info for a region this is all you have to do when you create a region…</p>
<p><code>	public void setDefaultSectorInfo() {
		for (int plane = 0; plane &lt; 4; plane++) {
			for (int x = 0; x &lt; 8; x++) {
				for (int y = 0; y &lt; 8; y++) {
					int sectorX = (position.getSectorX() &lt;&lt; 3) + x;
					int sectorY = (position.getSectorY() &lt;&lt; 3) + y;
					sectorInfo[plane][x][y] = new SectorInfo(sectorX, sectorY, plane, Rotation.WEST);
				}
			}
		}
	}</code></p>
<p>That will set the default sector information. anyways i’m done here, i was just trying to imply that you shouldn’t post about something you truly know nothing about. this list could go on and on, but i don’t feel like being a dick anymore</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="http://i.imgur.com/VHCDU.png" title="VHCDU.png" rel="nofollow noopener"><img src="http://i.imgur.com/VHCDU.png" alt width="690" height="450"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use xlink:href="#far-image"></use></svg><span class="filename">VHCDU.png</span><span class="informations">763×498</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>edit:</p>
<p>also you should always write 1 or 0 before sending the hash.  i see you only send 26 bits OR 0… which is wrong</p>
<p>edit2:<br>
looks like you ripped this off graham’s post on r-s</p>
<p>rune- <a href="http://server.org/runescape-development/rs-503-client-server/tutorials/166139-real-construct-map-region-packet-rs2hd.html" rel="nofollow noopener">server.org/runescape-development/rs-503-client-server/tutorials/166139-real-construct-map-region-packet-rs2hd.html</a></p>
<p>no spaces</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/8</link>
        <pubDate>Fri, 12 Aug 2011 00:22:15 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-8</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@sinisoul sini]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sinisoul">@sinisoul</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="3" data-topic="409429">
<div class="title">
<div class="quote-controls"></div>
 Zach.:</div>
<blockquote>
<p>The default size is 96*96 for this and I use region cause thats what people know it as, also what packets are you talking about? Me and the rest of the dementhium team have identified all packets in the 639 client and no such packets exist? Also I might add there is no correct name for stuff either so I wouldnt get on me about what stuff is called.</p>
</blockquote>
</aside>
<p>I have reprimanded mystic for using these terms, we actually had a discussion on this system for excuse me for not stating that. 96 x 96 does not make sense as there wouldn’t be a center chunk, (96/8 % 2 != 1)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/7</link>
        <pubDate>Thu, 11 Aug 2011 23:48:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-7</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@runewings317 runewings317]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/runewings317">@runewings317</a> wrote:</p>
          <blockquote>
              <p>[quote=“Zach., post:5, topic:409429”]How to use this packet in 634+ clients[/quote]Oh I see.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/6</link>
        <pubDate>Thu, 11 Aug 2011 16:20:20 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-6</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@Zach1 Zach.]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1">@Zach1</a> wrote:</p>
          <blockquote>
              <p>How to use this packet in 634+ clients</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/5</link>
        <pubDate>Thu, 11 Aug 2011 16:13:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-5</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@runewings317 runewings317]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/runewings317">@runewings317</a> wrote:</p>
          <blockquote>
              <p>[quote=“Zach., post:1, topic:409429”]The point of this tutorial is to explain how to use it in 634+ revision<br>
I am not releasing the packet itself but what you send when using and what to expect[/quote]I’m not quite sure how this explains how to use a 634?  <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=5" title=":confused:" class="emoji" alt=":confused:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/4</link>
        <pubDate>Thu, 11 Aug 2011 16:02:50 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-4</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@Zach1 Zach.]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1">@Zach1</a> wrote:</p>
          <blockquote>
              <p>The default size is 96*96 for this and I use region cause thats what people know it as, also what packets are you talking about? Me and the rest of the dementhium team have identified all packets in the 639 client and no such packets exist? Also I might add there is no correct name for stuff either so I wouldnt get on me about what stuff is called.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/3</link>
        <pubDate>Thu, 11 Aug 2011 15:45:42 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-3</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@sinisoul sini]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sinisoul">@sinisoul</a> wrote:</p>
          <blockquote>
              <p>The default palette size is 104 x 104. Also, to add onto this the size is adjustable via any of the two palette updating packets, don’t use the term region for this. Any calculation in which you are finding the x/8 quadrant the coordinate is located with, the term used is chunk. X/64 is region.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/2</link>
        <pubDate>Thu, 11 Aug 2011 08:21:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-2</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
      <item>
        <title>Construct map region explained [639]</title>
        <dc:creator><![CDATA[@Zach1 Zach.]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/zach1">@Zach1</a> wrote:</p>
          <blockquote>
              <p>The point of this tutorial is to explain how to use it in 634+ revision<br>
I am not releasing the packet itself but what you send when using and what to expect</p>
<p>Before I get into explaining the packet ill start by explaining the basics<br>
this packet is used to construct a map from 8<em>8 tile chunks<br>
the maxium map size is 12</em>12 chunks (8<em>8 sqaure)<br>
You can take 8</em>8 sqaures from any place in runescape (you could have a chunk of falador, lumbridge, varrock, and even nex’s lair all in your constructed map)</p>
<p>Okay for the 639 revision the packet header is 31 variable short<br>
the first thing sent is the loading type, 1 telling the client to construct the map (not fully done researching this yet)<br>
The next two things sent are the what I call the placement offset<br>
how this work is you send<br>
(player.getX() &gt;&gt; 3) + offset<br>
(player.getY() &gt;&gt; 3) + offset<br>
0 for offset is center of map positive x offset sends you to the right and negative sends you to the left and for y possitive sends you up and negative sends you down<br>
how this works is for the offset itll send you that many 8<em>8 squares away (not changing your placement in the 8</em>8 square)<br>
this allows you to place a player to an exact tile on the map<br>
Ex. Tzhaar fight caves is roughly 8 squares wide and long so if I want the map to appear with him at the exit in the cave id have to do<br>
(player.getX() &gt;&gt; 3) - 7 (theres one 8*8 sqaure to the left of the exit<br>
(player.getY() &gt;&gt; 3) - 8<br>
now the next thing sent is what I believe is sometime to do with map size, for this I just send 0<br>
and finaly the fun part, sending your map you created<br>
for this you use a loop and send the data as bits, this is what loop should look like</p>
<pre><code class="lang-auto">for(int z = 0; z &lt; 4; z++) {
        for(int x = 0; x &lt; 13; x++) {
                for(int y = 0; y &lt; 13; x++) {
                        if(z == player.getHeight()) {
                                regions.add(regionId); //stores the region the 8*8 sqaures uses
                                writeBits(26, (palette stuff here));
                        } else {
                               writeBit(1, 1);
                        }
                }
        }
}</code></pre>
<p>I have the palettes set up like this<br>
private int[][][][] palette = new int[4][4][13][13];<br>
set up is [type][height][x][y] type being x/y/height/rotation of the palette<br>
the value should be<br>
x = (x coordinate of palette) &gt;&gt; 3<br>
y = (y coordinate of palette) &gt;&gt; 3<br>
height = height of palette<br>
rotation = rotation of palette (0 for normal/no rotation)<br>
for example if I want a chunk of lumbridge in my map id do<br>
palette[0][0][5][5] = 3200 &gt;&gt; 3; // 3200 &gt;&gt; 3 = 400, x coordinate<br>
palette[1][0][5][5] = 3200 &gt;&gt; 3; // y coordinate<br>
palette[2][0][5][5] = 0; // height (ground level)<br>
palette[3][0][5][5] = 0; // rotation (no rotation)[hr]<br>
Thatll make a 8<em>8 square from lumbridge appear bottom left center on map (center is made up of 4 8</em>8 squares, 5-5 5-6 6-5 6-5)<br>
finaly we send the xtea keys (widely known as mapdata) of all the palettes use<br>
to get the region id you use (x &gt;&gt; 3) | (y &gt;&gt; 3) &lt;&lt; 8</p>
<p>I typed all this on my phone do sorry for any typos</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429/1</link>
        <pubDate>Thu, 11 Aug 2011 06:37:32 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-409429-1</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-explained-639/409429.rss">Construct map region explained [639]</source>
      </item>
  </channel>
</rss>
