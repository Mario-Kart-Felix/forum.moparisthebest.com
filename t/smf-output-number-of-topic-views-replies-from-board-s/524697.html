<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/smf-output-number-of-topic-views-replies-from-board-s/524697 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:07:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>[SMF] Output number of topic views/replies from board(s) - General Programming - moparisthebest.com</title>
    <meta name="description" content="Apparently this is useful to some people. This will put a bit of a strain on your database depending on how many boards, topics, and posts your forum has so use it wisely. 

This function will output the total number of &amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="524697.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;[SMF] Output number of topic views/replies from board(s)&#39;" href="524697.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/smf-output-number-of-topic-views-replies-from-board-s/524697" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/smf-output-number-of-topic-views-replies-from-board-s/524697" />
<meta property="og:title" content="[SMF] Output number of topic views/replies from board(s)" />
<meta name="twitter:title" content="[SMF] Output number of topic views/replies from board(s)" />
<meta property="og:description" content="Apparently this is useful to some people. This will put a bit of a strain on your database depending on how many boards, topics, and posts your forum has so use it wisely.  This function will output the total number of topic views and replies from certain board(s) within two set dates.  [code=php]function ssi_getNumViewsAndReplies($idBoard, $timestamp1, $timestamp2, $childLevel = 0, $output_method = ‘echo’) {  global $smcFunc;  if (!is_numeric($timestamp1) || !is_numeric($timestamp2) || empty($i..." />
<meta name="twitter:description" content="Apparently this is useful to some people. This will put a bit of a strain on your database depending on how many boards, topics, and posts your forum has so use it wisely.  This function will output the total number of topic views and replies from certain board(s) within two set dates.  [code=php]function ssi_getNumViewsAndReplies($idBoard, $timestamp1, $timestamp2, $childLevel = 0, $output_method = ‘echo’) {  global $smcFunc;  if (!is_numeric($timestamp1) || !is_numeric($timestamp2) || empty($i..." />
<meta property="article:published_time" content="2013-07-11T23:58:58+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="524697.html">[SMF] Output number of topic views/replies from board(s)</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/general-programming.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>General Programming</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/justaguy.html'><span itemprop='name'>justaguy</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2013-07-11T23:58:58Z'>
            <time itemprop='dateModified' datetime='2016-08-04T09:14:36Z' class='post-time'>
              August 4, 2016,  9:14am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>Apparently this is useful to some people. This will put a bit of a strain on your database depending on how many boards, topics, and posts your forum has so use it wisely.</p>
<p>This function will output the total number of topic views and replies from certain board(s) within two set dates.</p>
<p>[code=php]function ssi_getNumViewsAndReplies($idBoard, $timestamp1, $timestamp2, $childLevel = 0, $output_method = ‘echo’) {</p>
<pre><code>global $smcFunc;

if (!is_numeric($timestamp1) || !is_numeric($timestamp2) || empty($idBoard))
    return -1;

$boards = array($idBoard);
if ($childLevel &gt; 0) {
    $query_parameters_joins = '';
    $query_parameters_where = '';
    for ($i = 1; $i &lt; $childLevel; $i++) {
        $query_parameters_joins .= 'LEFT JOIN {db_prefix}boards AS childLevel' . $i . 'Board ON (childLevel' . $i . 'Board.id_parent IN (' . ($i == 1 ? 'childBoard' : 'childLevel' . ($i - 1) . 'Board') . '.id_board)) ';
        $query_parameters_where .= ' OR requestedBoard.id_board IN (childLevel' . $i . 'Board.id_board)';
    }

    // Retrieve all child boards, and child boards of child boards who inherit from parent
    // !! SLOW
    $request = $smcFunc['db_query']('',
        'SELECT requestedBoard.id_board
        FROM {db_prefix}boards AS requestedBoard
        INNER JOIN {db_prefix}boards AS childBoard ON (childBoard.id_parent = {int:parentId})
        ' . $query_parameters_joins . '
        WHERE requestedBoard.id_board IN (childBoard.id_board)
        ' . $query_parameters_where,
        array(
            'parentId' =&gt; $idBoard
        )
    );

    while ($row = $smcFunc['db_fetch_assoc']($request)) {
        $boards[] = $row['id_board'];
    }

    $smcFunc['db_free_result']($request);
}

// Next, retrieve all the topics in the boards where the timestamp is between two dates.
// Once found, just output num_views
$request = $smcFunc['db_query']('',
    'SELECT t.num_views, t.num_replies
    FROM {db_prefix}topics AS t
    INNER JOIN {db_prefix}messages AS m ON (m.id_msg = t.id_first_msg)
    WHERE t.id_board IN ({array_int:boards_list}) AND m.poster_time BETWEEN {int:date1} AND {int:date2}',
    array(
        'boards_list' =&gt; $boards,
        'date1' =&gt; $timestamp1,
        'date2' =&gt; $timestamp2
    )
);

// Your total number of views in this variable
$num_views = 0;
$num_replies = 0;
while ($row = $smcFunc['db_fetch_assoc']($request)) {
    $num_views += $row['num_views'];
    $num_replies += $row['num_replies'];
}

$smcFunc['db_free_result']($request);
if ($output_method == 'echo') {
    echo $num_views . '&lt;br /&gt;' . $num_replies;    
}

return array('views' =&gt; $num_views, 'replies' =&gt; $num_replies);
</code></pre>
<p>}[/code]</p>
<p>Example of usage (board id 5, between any time, include all child boards and child of child boards (level 2)):</p>
<pre><code class="lang-auto"></code></pre>
      </div>

      <meta itemprop='headline' content='[SMF] Output number of topic views/replies from board(s)'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/smf-output-number-of-topic-views-replies-from-board-s/524697 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 03 Aug 2019 20:07:13 GMT -->
</html>
