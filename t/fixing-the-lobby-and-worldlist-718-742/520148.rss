<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Fixing the Lobby and Worldlist [718/742]</title>
    <link>https://forum.moparisthebest.com/t/fixing-the-lobby-and-worldlist-718-742/520148</link>
    <description>Please follow the tutorial to fix the Lobby on your client and server, the correct way!

[font=times new roman][size=14pt][COLOR=blue][SERVER SIDE!!][/COLOR][/size][/font]

[color=red]First:[/COLOR]
Inside &quot;SRC\COM\RS\NET\ENCODERS&quot;, Replace the entire &quot;LoginPacketsEncoder.Java&quot; file with the one below: http://pastebin.com/te9ZQeQ5

[color=red]Second:[/COLOR]
Save, and close LoginPacketsEncoder.Java, and now open &quot;WorldPacketsEncoder.Java&quot; and replace it with the following:
http://pastebin.com/B5DmcTsh

[color=red]Third:[/COLOR]
Inside &quot;SRC\COM\RS\NET\DECODERS&quot;, Replace the entire &quot;LoginPacketsDecoder.Java&quot; file with the one below:
http://pastebin.com/RiWXZbxL

[color=red]Fouth:[/COLOR]
In the same folder, &quot;SRC/COM/RS/NET/DECODERS&quot;, Open up your &quot;WorldPacketsDecoder.Java&quot;.
Underneath [code]public final class WorldPacketsDecoder extends Decoder {[/code] where all your ints, and all are, add [code]private final static int WORLD_LIST_UPDATE = 87;[/code]

Then search for (STILL INSIDE WorldPacketsDecoder):
[code]} else if (packetId == WORLD_LIST_UPDATE) {[/code]
and replace it with:
[code]} else if (packetId == WORLD_LIST_UPDATE) {
int updateType = stream.readInt();
player.getPackets().sendWorldList(updateType == 0);[/code]

After replacing that, search for:
[code]if (packetId == PING_PACKET) {[/code]
Inside your &quot;processPackets&quot;
and replace that with:
[code]if (packetId == PING_PACKET) {
//PING PA PING PING PIIIING PING!
OutputStream packet = new OutputStream(0);
packet.writePacket(player, 153);
player.getSession().write(packet);[/code]
(SAVE AND CLOSE!)

[color=red]Fifth:[/COLOR]
Located in &quot;SRC/COM/RS/GAME/WORLDLIST&quot;, Replace your ENTIRE &quot;WorldEntry.Java&quot; with the one below!
[code]package com.rs.game.worldlist;

/**
* CREDITS:
* @Thomas (KTHILLMAN)
**/

public class WorldEntry {

public String activity;
public String ip;

public int countryId;
public String countryName;

public boolean members;

public WorldEntry(String activity, String ip, int countryId, String countryName, boolean members) {
this.activity = activity;
this.ip = ip;
this.countryId = countryId;
this.countryName = countryName;
this.members = members;
}

public String getActivity() {
return activity;
}

public String getIP() {
return ip;
}

public int getCountryId() {
return countryId;
}

public String getCountryName() {
return countryName;
}

public boolean isMembers() {
return members;
}
}[/code]

And then replace your entire WorldList.Java file with the following:
[code]package com.rs.game.worldlist;

import java.util.HashMap;
import com.rs.Settings;

public class WorldList {

public static final HashMap&lt;Integer, WorldEntry&gt; WORLDS = new HashMap&lt;Integer, WorldEntry&gt;();

public static void init() {
//Name  IP FLAG COUNTRY MEMBERS?
WORLDS.put(1, new WorldEntry(Settings.SERVER_NAME, &quot;127.0.0.1&quot;, 37, &quot;Main&quot;, false)); //WORLD #1
WORLDS.put(2, new WorldEntry(&quot;Beta&quot;, &quot;127.0.0.1&quot;, 1, &quot;Beta&quot;, true)); //WORLD #2
}

public static WorldEntry getWorld(int worldId) {
return WORLDS.get(worldId);
}
}[/code]

[color=red]Sixth:[/COLOR]
Navigate towards &quot;SRC/COM/RS/UTIL&quot; - Open &quot;Utils.Java&quot;
Add the methods below:
[code]public static int getNpcMoveDirection(int dd) {
if (dd &lt; 0)
return -1;
return getNpcMoveDirection(DIRECTION_DELTA_X[dd], DIRECTION_DELTA_Y[dd]);
}

public static byte[] decipher(int[] key, byte[] data) {
return decipher(key, data, 0, data.length);
}

public static byte[] decipher(int[] key, byte[] data, int offset, int length) {
int numBlocks = (length - offset) / 8;
ByteBuffer buffer = ByteBuffer.wrap(data);
buffer.position(offset);
for (int i = 0; i &lt; numBlocks; i++) {
int y = buffer.getInt();
int z = buffer.getInt();
int sum = -957401312;
int delta = -1640531527;
int numRounds = 32;
while (numRounds &gt; 0) {
z -= ((y &gt;&gt;&gt; 5 ^ y &lt;&lt; 4) + y ^ sum + key[sum &gt;&gt;&gt; 11 &amp; 0x56c00003]);
sum -= delta;
y -= ((z &gt;&gt;&gt; 5 ^ z &lt;&lt; 4) - -z ^ sum + key[sum &amp; 0x3]);
numRounds--;
}
buffer.position(buffer.position() - 8);
buffer.putInt(y);
buffer.putInt(z);
}
return buffer.array();
}[/code]

[color=red]Seventh:[/COLOR]
Inside the same file, &quot;Utils.Java&quot;, search for [code]public static void copyFile(File sourceFile, File destFile)[/code],
and above all that add:
[code]public static String decodeBase37(long value) {
char[] chars = new char[12];
int pos = 0;
while (value != 0) {
int remainder = (int) (value % 37);
value /= 37;

char c;
if (remainder &gt;= 1 &amp;&amp; remainder &lt;= 26) {
c = (char) (&#39;a&#39; + remainder - 1);
} else if (remainder &gt;= 27 &amp;&amp; remainder &lt;= 36) {
c = (char) (&#39;0&#39; + remainder - 27);
} else {
c = &#39;_&#39;;
}

chars[chars.length - pos++ - 1] = c;
}
return new String(chars, chars.length - pos, pos);
}

public static final int[] DEFAULT_LOBBY_CONFIGS = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -476379337, -1634348113, 919975670, 100098016, -941649356, 33599227, 0, 0, 0, 2, 0, 10, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 52776083, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 4, 4, 0, 1, 1, 0, 0, 0, 0, 0, 130, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 557858, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0, 1000, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 272, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 58720640, 0, 24596, 0, 0, 0, 0, 2048, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 269026962, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0, 1073742208, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 262177, 0, 256, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1076961290, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1073741824, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1409286144, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 99, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2147483648, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 34079488, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 272, 0, 0, 0, 0, 0, 0, 0, 1073741824, 0, 0, 0, 0, 8192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 407044218, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 536870912, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134217730, 0, 2049, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 201326625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4224, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 0, 0, 0, 0, 0, 0, 0, 33554432, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4194304, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1073741824, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134232576, 32768, 0, 0, 0, 0, 0, 4194304, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 262144, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2147483648, 0, 0, 0, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 268435456, 0, 0, 0, 0, 0, 0, 0, 0, 537133056, 2048, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 262273, 536877056, 0, 393216, 32, 0, 4096, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1, 1073742848, 65536, 268435456, 0, 0, 0, 512, 0, 0, 0, 0, 0, 291912, 5672, 260092, 0, 60248, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 508, 0, 1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2048, -2130681854, 0, -1, -1, -1, -1, 0, 10, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 64, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, -1, 0, 0, 60, 0, 0, 470286336, 132096, 1, 1276, 0, 0, 0, 0, 0, 0, 0, 0, 0, 536870912, -1, 0, 54332549, 0, 0, 0, -1, 0, 67174408, -872415232, 256, 8388608, 0, 0, 0, 4353, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 590848, 0, 0, 0, 0, 0, 0, -1, 0, 1001, 0, 0, 0, 0, 82663, 1025, 0, 134217728, 14, 0, 0, 0, 0, 0, 557057, 1476461568, 16384, 4096, 3721, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 525312, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 22271787, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12582912, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, 0, 0, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 65536, 0, -1879048192, 0, 16384, 1, 16384, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 1, 0, -2147483648, 0, 0, -2147483648, 0, 0, 0, 0, 0, 0, 512, 0, 0, 0, 0, 0, 16777216, 0, 0, 0, 25165824, 0, 0, 0, 0, 0, 0, 0, 0, 0, 67108864, 0, 0, 0, 268435456, 0, 136347657, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2144919536, 0, 0, -1, 65540, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 511305630, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1073744067, 0, 65536, 0, 0, 0, 0, 0, 0, 536870912, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 65535, 1073741823, 2147483647, 1073741823, 1073741823, 1073741823, 1073741823, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134218080, 0, 0, 0, 0, 545260028, 0, 0, 0, 0, 0, 0, 0, 0, 262144, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2080374784, 0, 0, 0, 0, 0, 0, -2147483648, 279019520, -2147483648, 134217728, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 751720, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, -1, 268437504, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 4194304, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100673544, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 677729578, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 956430392, 25171979, 151589, 3, 4718466, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 393216, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8388608, 33554432, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 67108864, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41476, 0, 0, 0, 0, 32, 536870912, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40632322, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 819320, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 4194304, 0, 0, 0, 0, 0, 0, 0, 0, 0, 256, 0, 0, 0, 0, 0, 0, 0, 1048559, 589721, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 589855, 0, 0, -1, 0, 0, 402655232, 98353, 0, 0, 0, -1137689604, 1073807344, 0, 0, 0, 10, 0, 0, 0, 8386561, 0, 0, -1, -1, -1, -1, -1, -1, -1, 1536, 8192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 77, 1733, -16912800, 4594664, 5359015, 3721, 0, 0, 0, -2147483648, 1310720, -1, 0, 0, 0, 0, 0, 0, 0, 1342177408, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 16777216, 0, 0, 32289, -1, -1, 0, 0, 0, 77, 52, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, };
[/code]

[color=red]Seventh:[/COLOR]
Find &quot;Launcher.Java&quot; inside &quot;SRC/COM/RS&quot;, and add:
[code]WorldList.init();[/code]
Underneath your:
[code]Logger.log[/code] Method

[color=red]Nineth:[/COLOR]
Next you are going to want to open up &quot;Player.Java&quot; in &quot;SRC\COM\RS\GAME\PLAYER&quot;, and right above:
[code]public void lock() {[/code] 
add the following:
[code]public void init(Session session, String string, IsaacKeyPair isaacKeyPair) {
username = string;
this.session = session;
this.isaacKeyPair = isaacKeyPair;
World.addLobbyPlayer(this);// .addLobbyPlayer(this);
if (Settings.DEBUG) {
Logger.log(this, new StringBuilder(&quot;Lobby Inited Player: &quot;).append(string).append(&quot;, pass: &quot;).append(password).toString());
}
}

public void startLobby(Player player) {
player.sendLobbyConfigs(player);
friendsIgnores.setPlayer(this);
friendsIgnores.init();
player.getPackets().sendFriendsChatChannel();
friendsIgnores.sendFriendsMyStatus(true);
}

public void sendLobbyConfigs(Player player) {
for (int i = 0; i &lt; Utils.DEFAULT_LOBBY_CONFIGS.length; i++) {
int val = Utils.DEFAULT_LOBBY_CONFIGS[i];
if (val != 0) {
player.getPackets().sendConfig(i, val);
}
}
}[/code]
Also, ADD:
[code]private long lastLoggedIn;[/code]

[color=red]Next:[/COLOR]
Still inside &quot;Player.Java&quot;
Replace your entire finish and realfinish methods with the ones below:
[code]
public void finish(final int tryCount) {
if (finishing || hasFinished()) {
if (World.containsPlayer(username)) {
World.removePlayer(this);
}
if (World.containsLobbyPlayer(username)) {
World.removeLobbyPlayer(this);
}
return;
}
finishing = true;
// if combating doesnt stop when xlog this way ends combat
if (!World.containsLobbyPlayer(username)) {
stopAll(false, true, !(actionManager.getAction() instanceof PlayerCombat));
}
long currentTime = Utils.currentTimeMillis();
if ((getAttackedByDelay() + 10000 &gt; currentTime &amp;&amp; tryCount &lt; 6) || getEmotesManager().getNextEmoteEnd() &gt;= currentTime || lockDelay &gt;= currentTime) {
CoresManager.slowExecutor.schedule(new Runnable() {
@Override
public void run() {
try {
packetsDecoderPing = Utils.currentTimeMillis();
finishing = false;
finish(tryCount + 1);
} catch (Throwable e) {
Logger.handle(e);
}
}
}, 10, TimeUnit.SECONDS);
return;
}
realFinish();
}

public void realFinish() {
if (hasFinished()) {
return;
}
if (!World.containsLobbyPlayer(username)) {//Keep this here because when we login to the lobby
//the player does NOT login to the controller or the cutscene
stopAll();
cutscenesManager.logout();
controlerManager.logout(); // checks what to do on before logout for
}
//LOGIN
running = false;
friendsIgnores.sendFriendsMyStatus(false);
if (currentFriendChat != null) {
currentFriendChat.leaveChat(this, true);
}
if (familiar != null &amp;&amp; !familiar.isFinished()) {
familiar.dissmissFamiliar(true);
} else if (pet != null) {
pet.finish();
}
setFinished(true);
session.setDecoder(-1);
this.lastLoggedIn = System.currentTimeMillis();
SerializableFilesManager.savePlayer(this);
if (World.containsLobbyPlayer(username)) {
World.removeLobbyPlayer(this);
}
World.updateEntityRegion(this);
if (World.containsPlayer(username)) {
World.removePlayer(this);
}
if (Settings.DEBUG) {
Logger.log(this, &quot;Finished Player: &quot; + username + &quot;, Pass: &quot; + password);
}
}[/code]

[color=red]After:[/COLOR]
Close and save that, and go inside your World.Java located in &quot;SRC/COM/RS/GAME&quot;.
Above [code]private static final void addListUpdateTask() {[/code]
Add the the entire code below (REPLACE YOUR OLD ONE IF YOU ALREADY HAVE!)
[code]private static final EntityList&lt;Player&gt; lobbyPlayers = new EntityList&lt;Player&gt;(Settings.PLAYERS_LIMIT);

public static final Player getLobbyPlayerByDisplayName(String username) {
String formatedUsername = Utils.formatPlayerNameForDisplay(username);
for (Player player : getLobbyPlayers()) {
if (player == null) {
continue;
}
if (player.getUsername().equalsIgnoreCase(formatedUsername)
|| player.getDisplayName().equalsIgnoreCase(formatedUsername)) {
return player;
}
}
return null;
}

public static final EntityList&lt;Player&gt; getLobbyPlayers() {
return lobbyPlayers;
}

public static final void addPlayer(Player player) {
players.add(player);
if (World.containsLobbyPlayer(player.getUsername())) {
World.removeLobbyPlayer(player);
AntiFlood.remove(player.getSession().getIP());
}
AntiFlood.add(player.getSession().getIP());
}

public static final void addLobbyPlayer(Player player) {
lobbyPlayers.add(player);
AntiFlood.add(player.getSession().getIP());
}

public static final boolean containsLobbyPlayer(String username) {
for (Player p2 : lobbyPlayers) {
if (p2 == null) {
continue;
}
if (p2.getUsername().equalsIgnoreCase(username)) {
return true;
}
}
return false;
}

public static void removeLobbyPlayer(Player player) {
for (Player p : lobbyPlayers) {
if (p.getUsername().equalsIgnoreCase(player.getUsername())) {
if (player.getCurrentFriendChat() != null) {
player.getCurrentFriendChat().leaveChat(player, true);
}
lobbyPlayers.remove(p);
}
}
AntiFlood.remove(player.getSession().getIP());
}

public static void removePlayer(Player player) {
for (Player p : players) {
if (p.getUsername().equalsIgnoreCase(player.getUsername())) {
players.remove(p);
}
}
AntiFlood.remove(player.getSession().getIP());
}[/code]
Then, close and save that.

[color=red]Afterwards:[/COLOR]
Open your OutputStream class file inside &quot;SRC/COM/RS/IO&quot; folder.
Open the file, then add this somewhere
[code]public void write5ByteInteger(long value) {
writeByte((int) (value &gt;&gt; 32));
writeInt((int) (value &amp; 0xffffffff));
}[/code]

SAVE AND COMPILE!
[font=times new roman][size=14pt][COLOR=blue][CLIENT SIDE!!][/COLOR][/size][/font]

[color=red]REPLACE YOUR CLIENT.JAVA WITH THE ONE FROM BELOW:[/COLOR]
http://pastebin.com/9XR2tSe1

[color=red]NOW REPLACE YOUR CLASS460.JAVA WITH THIS ONE:[/COLOR]
http://pastebin.com/Zh0rareA

SAVE AND COMPILE!</description>
    
    <lastBuildDate>Tue, 28 May 2013 13:51:30 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/fixing-the-lobby-and-worldlist-718-742/520148.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Fixing the Lobby and Worldlist [718/742]</title>
        <dc:creator><![CDATA[@khayam khayam]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/khayam">@khayam</a> wrote:</p>
          <blockquote>
              <p>So when u login, u get taken to the lobby first? If possible culd u show pics of what it would like if u dont mind?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/fixing-the-lobby-and-worldlist-718-742/520148/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/fixing-the-lobby-and-worldlist-718-742/520148/2</link>
        <pubDate>Tue, 28 May 2013 13:51:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-520148-2</guid>
        <source url="https://forum.moparisthebest.com/t/fixing-the-lobby-and-worldlist-718-742/520148.rss">Fixing the Lobby and Worldlist [718/742]</source>
      </item>
      <item>
        <title>Fixing the Lobby and Worldlist [718/742]</title>
        <dc:creator><![CDATA[@kthillman kthillman]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/kthillman">@kthillman</a> wrote:</p>
          <blockquote>
              <p>Please follow the tutorial to fix the Lobby on your client and server, the correct way!</p>
<p>[font=times new roman][size=14pt][COLOR=blue][SERVER SIDE!!][/COLOR][/size][/font]</p>
<p>[color=red]First:[/COLOR]<br>
Inside “SRC\COM\RS\NET\ENCODERS”, Replace the entire “LoginPacketsEncoder.Java” file with the one below: <a href="http://pastebin.com/te9ZQeQ5" rel="nofollow noopener">http://pastebin.com/te9ZQeQ5</a></p>
<p>[color=red]Second:[/COLOR]<br>
Save, and close LoginPacketsEncoder.Java, and now open “WorldPacketsEncoder.Java” and replace it with the following:<br>
<a href="http://pastebin.com/B5DmcTsh" class="onebox" target="_blank" rel="nofollow noopener">http://pastebin.com/B5DmcTsh</a></p>
<p>[color=red]Third:[/COLOR]<br>
Inside “SRC\COM\RS\NET\DECODERS”, Replace the entire “LoginPacketsDecoder.Java” file with the one below:<br>
<a href="http://pastebin.com/RiWXZbxL" class="onebox" target="_blank" rel="nofollow noopener">http://pastebin.com/RiWXZbxL</a></p>
<p>[color=red]Fouth:[/COLOR]<br>
In the same folder, “SRC/COM/RS/NET/DECODERS”, Open up your “WorldPacketsDecoder.Java”.<br>
Underneath <code>public final class WorldPacketsDecoder extends Decoder {</code> where all your ints, and all are, add <code>private final static int WORLD_LIST_UPDATE = 87;</code></p>
<p>Then search for (STILL INSIDE WorldPacketsDecoder):</p>
<pre><code class="lang-auto"></code></pre>
<p>and replace it with:</p>
<p><code>} else if (packetId == WORLD_LIST_UPDATE) {
int updateType = stream.readInt();
player.getPackets().sendWorldList(updateType == 0);</code></p>
<p>After replacing that, search for:</p>
<pre><code class="lang-auto"></code></pre>
<p>Inside your “processPackets”<br>
and replace that with:</p>
<p><code>if (packetId == PING_PACKET) {
//PING PA PING PING PIIIING PING!
OutputStream packet = new OutputStream(0);
packet.writePacket(player, 153);
player.getSession().write(packet);</code><br>
(SAVE AND CLOSE!)</p>
<p>[color=red]Fifth:[/COLOR]<br>
Located in “SRC/COM/RS/GAME/WORLDLIST”, Replace your ENTIRE “WorldEntry.Java” with the one below!</p>
<p>[code]package com.rs.game.worldlist;</p>
<p>/**</p>
<ul>
<li>CREDITS:</li>
<li>
<a class="mention" href="/u/thomas">@Thomas</a> (KTHILLMAN)<br>
**/</li>
</ul>
<p>public class WorldEntry {</p>
<p>public String activity;<br>
public String ip;</p>
<p>public int countryId;<br>
public String countryName;</p>
<p>public boolean members;</p>
<p>public WorldEntry(String activity, String ip, int countryId, String countryName, boolean members) {<br>
this.activity = activity;<br>
this.ip = ip;<br>
this.countryId = countryId;<br>
this.countryName = countryName;<br>
this.members = members;<br>
}</p>
<p>public String getActivity() {<br>
return activity;<br>
}</p>
<p>public String getIP() {<br>
return ip;<br>
}</p>
<p>public int getCountryId() {<br>
return countryId;<br>
}</p>
<p>public String getCountryName() {<br>
return countryName;<br>
}</p>
<p>public boolean isMembers() {<br>
return members;<br>
}<br>
}[/code]</p>
<p>And then replace your entire WorldList.Java file with the following:</p>
<p>[code]package com.rs.game.worldlist;</p>
<p>import java.util.HashMap;<br>
import com.rs.Settings;</p>
<p>public class WorldList {</p>
<p>public static final HashMap&lt;Integer, WorldEntry&gt; WORLDS = new HashMap&lt;Integer, WorldEntry&gt;();</p>
<p>public static void init() {<br>
//Name  IP FLAG COUNTRY MEMBERS?<br>
WORLDS.put(1, new WorldEntry(Settings.SERVER_NAME, “127.0.0.1”, 37, “Main”, false)); //WORLD <span class="hashtag">#1</span><br>
WORLDS.put(2, new WorldEntry(“Beta”, “127.0.0.1”, 1, “Beta”, true)); //WORLD <span class="hashtag">#2</span><br>
}</p>
<p>public static WorldEntry getWorld(int worldId) {<br>
return WORLDS.get(worldId);<br>
}<br>
}[/code]</p>
<p>[color=red]Sixth:[/COLOR]<br>
Navigate towards “SRC/COM/RS/UTIL” - Open “Utils.Java”<br>
Add the methods below:</p>
<p>[code]public static int getNpcMoveDirection(int dd) {<br>
if (dd &lt; 0)<br>
return -1;<br>
return getNpcMoveDirection(DIRECTION_DELTA_X[dd], DIRECTION_DELTA_Y[dd]);<br>
}</p>
<p>public static byte[] decipher(int[] key, byte[] data) {<br>
return decipher(key, data, 0, data.length);<br>
}</p>
<p>public static byte[] decipher(int[] key, byte[] data, int offset, int length) {<br>
int numBlocks = (length - offset) / 8;<br>
ByteBuffer buffer = ByteBuffer.wrap(data);<br>
buffer.position(offset);<br>
for (int i = 0; i &lt; numBlocks; i++) {<br>
int y = buffer.getInt();<br>
int z = buffer.getInt();<br>
int sum = -957401312;<br>
int delta = -1640531527;<br>
int numRounds = 32;<br>
while (numRounds &gt; 0) {<br>
z -= ((y &gt;&gt;&gt; 5 ^ y &lt;&lt; 4) + y ^ sum + key[sum &gt;&gt;&gt; 11 &amp; 0x56c00003]);<br>
sum -= delta;<br>
y -= ((z &gt;&gt;&gt; 5 ^ z &lt;&lt; 4) - -z ^ sum + key[sum &amp; 0x3]);<br>
numRounds–;<br>
}<br>
buffer.position(buffer.position() - 8);<br>
buffer.putInt(y);<br>
buffer.putInt(z);<br>
}<br>
return buffer.array();<br>
}[/code]</p>
<p>[color=red]Seventh:[/COLOR]<br>
Inside the same file, “Utils.Java”, search for <code>public static void copyFile(File sourceFile, File destFile)</code>,<br>
and above all that add:</p>
<p>[code]public static String decodeBase37(long value) {<br>
char[] chars = new char[12];<br>
int pos = 0;<br>
while (value != 0) {<br>
int remainder = (int) (value % 37);<br>
value /= 37;</p>
<p>char c;<br>
if (remainder &gt;= 1 &amp;&amp; remainder &lt;= 26) {<br>
c = (char) (‘a’ + remainder - 1);<br>
} else if (remainder &gt;= 27 &amp;&amp; remainder &lt;= 36) {<br>
c = (char) (‘0’ + remainder - 27);<br>
} else {<br>
c = ‘_’;<br>
}</p>
<p>chars[chars.length - pos++ - 1] = c;<br>
}<br>
return new String(chars, chars.length - pos, pos);<br>
}</p>
<p>public static final int[] DEFAULT_LOBBY_CONFIGS = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -476379337, -1634348113, 919975670, 100098016, -941649356, 33599227, 0, 0, 0, 2, 0, 10, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 52776083, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 4, 4, 0, 1, 1, 0, 0, 0, 0, 0, 130, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 557858, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0, 1000, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 272, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 58720640, 0, 24596, 0, 0, 0, 0, 2048, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 269026962, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0, 1073742208, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 262177, 0, 256, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1076961290, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1073741824, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1409286144, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 99, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2147483648, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 34079488, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 272, 0, 0, 0, 0, 0, 0, 0, 1073741824, 0, 0, 0, 0, 8192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 407044218, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 536870912, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134217730, 0, 2049, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 201326625, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4224, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 0, 0, 0, 0, 0, 0, 0, 33554432, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4194304, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1073741824, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134232576, 32768, 0, 0, 0, 0, 0, 4194304, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 262144, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2147483648, 0, 0, 0, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 268435456, 0, 0, 0, 0, 0, 0, 0, 0, 537133056, 2048, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 262273, 536877056, 0, 393216, 32, 0, 4096, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1, 1073742848, 65536, 268435456, 0, 0, 0, 512, 0, 0, 0, 0, 0, 291912, 5672, 260092, 0, 60248, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 508, 0, 1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2048, -2130681854, 0, -1, -1, -1, -1, 0, 10, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 64, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, -1, 0, 0, 60, 0, 0, 470286336, 132096, 1, 1276, 0, 0, 0, 0, 0, 0, 0, 0, 0, 536870912, -1, 0, 54332549, 0, 0, 0, -1, 0, 67174408, -872415232, 256, 8388608, 0, 0, 0, 4353, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 590848, 0, 0, 0, 0, 0, 0, -1, 0, 1001, 0, 0, 0, 0, 82663, 1025, 0, 134217728, 14, 0, 0, 0, 0, 0, 557057, 1476461568, 16384, 4096, 3721, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 525312, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 22271787, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12582912, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, 0, 0, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 65536, 0, -1879048192, 0, 16384, 1, 16384, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 1, 0, -2147483648, 0, 0, -2147483648, 0, 0, 0, 0, 0, 0, 512, 0, 0, 0, 0, 0, 16777216, 0, 0, 0, 25165824, 0, 0, 0, 0, 0, 0, 0, 0, 0, 67108864, 0, 0, 0, 268435456, 0, 136347657, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2144919536, 0, 0, -1, 65540, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 511305630, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1073744067, 0, 65536, 0, 0, 0, 0, 0, 0, 536870912, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65535, 65535, 65535, 1073741823, 2147483647, 1073741823, 1073741823, 1073741823, 1073741823, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134218080, 0, 0, 0, 0, 545260028, 0, 0, 0, 0, 0, 0, 0, 0, 262144, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2080374784, 0, 0, 0, 0, 0, 0, -2147483648, 279019520, -2147483648, 134217728, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 751720, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, -1, 268437504, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 4194304, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 100673544, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 677729578, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 956430392, 25171979, 151589, 3, 4718466, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 393216, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8388608, 33554432, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 67108864, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41476, 0, 0, 0, 0, 32, 536870912, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40632322, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 819320, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 4194304, 0, 0, 0, 0, 0, 0, 0, 0, 0, 256, 0, 0, 0, 0, 0, 0, 0, 1048559, 589721, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 589855, 0, 0, -1, 0, 0, 402655232, 98353, 0, 0, 0, -1137689604, 1073807344, 0, 0, 0, 10, 0, 0, 0, 8386561, 0, 0, -1, -1, -1, -1, -1, -1, -1, 1536, 8192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 77, 1733, -16912800, 4594664, 5359015, 3721, 0, 0, 0, -2147483648, 1310720, -1, 0, 0, 0, 0, 0, 0, 0, 1342177408, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 16777216, 0, 0, 32289, -1, -1, 0, 0, 0, 77, 52, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, };<br>
[/code]</p>
<p>[color=red]Seventh:[/COLOR]<br>
Find “Launcher.Java” inside “SRC/COM/RS”, and add:</p>
<pre><code class="lang-auto"></code></pre>
<p>Underneath your:</p>
<p><code>Logger.log</code> Method</p>
<p>[color=red]Nineth:[/COLOR]<br>
Next you are going to want to open up “Player.Java” in “SRC\COM\RS\GAME\PLAYER”, and right above:</p>
<pre><code class="lang-auto"></code></pre>
<p>add the following:</p>
<p>[code]public void init(Session session, String string, IsaacKeyPair isaacKeyPair) {<br>
username = string;<br>
this.session = session;<br>
this.isaacKeyPair = isaacKeyPair;<br>
World.addLobbyPlayer(this);// .addLobbyPlayer(this);<br>
if (Settings.DEBUG) {<br>
Logger.log(this, new StringBuilder("Lobby Inited Player: “).append(string).append(”, pass: ").append(password).toString());<br>
}<br>
}</p>
<p>public void startLobby(Player player) {<br>
player.sendLobbyConfigs(player);<br>
friendsIgnores.setPlayer(this);<br>
friendsIgnores.init();<br>
player.getPackets().sendFriendsChatChannel();<br>
friendsIgnores.sendFriendsMyStatus(true);<br>
}</p>
<p>public void sendLobbyConfigs(Player player) {<br>
for (int i = 0; i &lt; Utils.DEFAULT_LOBBY_CONFIGS.length; i++) {<br>
int val = Utils.DEFAULT_LOBBY_CONFIGS[i];<br>
if (val != 0) {<br>
player.getPackets().sendConfig(i, val);<br>
}<br>
}<br>
}[/code]<br>
Also, ADD:</p>
<pre><code class="lang-auto"></code></pre>
<p>[color=red]Next:[/COLOR]<br>
Still inside “Player.Java”<br>
Replace your entire finish and realfinish methods with the ones below:</p>
<p>[code]<br>
public void finish(final int tryCount) {<br>
if (finishing || hasFinished()) {<br>
if (World.containsPlayer(username)) {<br>
World.removePlayer(this);<br>
}<br>
if (World.containsLobbyPlayer(username)) {<br>
World.removeLobbyPlayer(this);<br>
}<br>
return;<br>
}<br>
finishing = true;<br>
// if combating doesnt stop when xlog this way ends combat<br>
if (!World.containsLobbyPlayer(username)) {<br>
stopAll(false, true, !(actionManager.getAction() instanceof PlayerCombat));<br>
}<br>
long currentTime = Utils.currentTimeMillis();<br>
if ((getAttackedByDelay() + 10000 &gt; currentTime &amp;&amp; tryCount &lt; 6) || getEmotesManager().getNextEmoteEnd() &gt;= currentTime || lockDelay &gt;= currentTime) {<br>
CoresManager.slowExecutor.schedule(new Runnable() {<br>
<a class="mention" href="/u/override">@Override</a><br>
public void run() {<br>
try {<br>
packetsDecoderPing = Utils.currentTimeMillis();<br>
finishing = false;<br>
finish(tryCount + 1);<br>
} catch (Throwable e) {<br>
Logger.handle(e);<br>
}<br>
}<br>
}, 10, TimeUnit.SECONDS);<br>
return;<br>
}<br>
realFinish();<br>
}</p>
<p>public void realFinish() {<br>
if (hasFinished()) {<br>
return;<br>
}<br>
if (!World.containsLobbyPlayer(username)) {//Keep this here because when we login to the lobby<br>
//the player does NOT login to the controller or the cutscene<br>
stopAll();<br>
cutscenesManager.logout();<br>
controlerManager.logout(); // checks what to do on before logout for<br>
}<br>
//LOGIN<br>
running = false;<br>
friendsIgnores.sendFriendsMyStatus(false);<br>
if (currentFriendChat != null) {<br>
currentFriendChat.leaveChat(this, true);<br>
}<br>
if (familiar != null &amp;&amp; !familiar.isFinished()) {<br>
familiar.dissmissFamiliar(true);<br>
} else if (pet != null) {<br>
pet.finish();<br>
}<br>
setFinished(true);<br>
session.setDecoder(-1);<br>
this.lastLoggedIn = System.currentTimeMillis();<br>
SerializableFilesManager.savePlayer(this);<br>
if (World.containsLobbyPlayer(username)) {<br>
World.removeLobbyPlayer(this);<br>
}<br>
World.updateEntityRegion(this);<br>
if (World.containsPlayer(username)) {<br>
World.removePlayer(this);<br>
}<br>
if (Settings.DEBUG) {<br>
Logger.log(this, "Finished Player: " + username + ", Pass: " + password);<br>
}<br>
}[/code]</p>
<p>[color=red]After:[/COLOR]<br>
Close and save that, and go inside your World.Java located in “SRC/COM/RS/GAME”.<br>
Above <code>private static final void addListUpdateTask() {</code><br>
Add the the entire code below (REPLACE YOUR OLD ONE IF YOU ALREADY HAVE!)</p>
<p>[code]private static final EntityList lobbyPlayers = new EntityList(Settings.PLAYERS_LIMIT);</p>
<p>public static final Player getLobbyPlayerByDisplayName(String username) {<br>
String formatedUsername = Utils.formatPlayerNameForDisplay(username);<br>
for (Player player : getLobbyPlayers()) {<br>
if (player == null) {<br>
continue;<br>
}<br>
if (player.getUsername().equalsIgnoreCase(formatedUsername)<br>
|| player.getDisplayName().equalsIgnoreCase(formatedUsername)) {<br>
return player;<br>
}<br>
}<br>
return null;<br>
}</p>
<p>public static final EntityList getLobbyPlayers() {<br>
return lobbyPlayers;<br>
}</p>
<p>public static final void addPlayer(Player player) {<br>
players.add(player);<br>
if (World.containsLobbyPlayer(player.getUsername())) {<br>
World.removeLobbyPlayer(player);<br>
AntiFlood.remove(player.getSession().getIP());<br>
}<br>
AntiFlood.add(player.getSession().getIP());<br>
}</p>
<p>public static final void addLobbyPlayer(Player player) {<br>
lobbyPlayers.add(player);<br>
AntiFlood.add(player.getSession().getIP());<br>
}</p>
<p>public static final boolean containsLobbyPlayer(String username) {<br>
for (Player p2 : lobbyPlayers) {<br>
if (p2 == null) {<br>
continue;<br>
}<br>
if (p2.getUsername().equalsIgnoreCase(username)) {<br>
return true;<br>
}<br>
}<br>
return false;<br>
}</p>
<p>public static void removeLobbyPlayer(Player player) {<br>
for (Player p : lobbyPlayers) {<br>
if (p.getUsername().equalsIgnoreCase(player.getUsername())) {<br>
if (player.getCurrentFriendChat() != null) {<br>
player.getCurrentFriendChat().leaveChat(player, true);<br>
}<br>
lobbyPlayers.remove§;<br>
}<br>
}<br>
AntiFlood.remove(player.getSession().getIP());<br>
}</p>
<p>public static void removePlayer(Player player) {<br>
for (Player p : players) {<br>
if (p.getUsername().equalsIgnoreCase(player.getUsername())) {<br>
players.remove§;<br>
}<br>
}<br>
AntiFlood.remove(player.getSession().getIP());<br>
}[/code]<br>
Then, close and save that.</p>
<p>[color=red]Afterwards:[/COLOR]<br>
Open your OutputStream class file inside “SRC/COM/RS/IO” folder.<br>
Open the file, then add this somewhere</p>
<p><code>public void write5ByteInteger(long value) {
writeByte((int) (value &gt;&gt; 32));
writeInt((int) (value &amp; 0xffffffff));
}</code></p>
<p>SAVE AND COMPILE!<br>
[font=times new roman][size=14pt][COLOR=blue][CLIENT SIDE!!][/COLOR][/size][/font]</p>
<p>[color=red]REPLACE YOUR CLIENT.JAVA WITH THE ONE FROM BELOW:[/COLOR]<br>
<a href="http://pastebin.com/9XR2tSe1" class="onebox" target="_blank" rel="nofollow noopener">http://pastebin.com/9XR2tSe1</a></p>
<p>[color=red]NOW REPLACE YOUR CLASS460.JAVA WITH THIS ONE:[/COLOR]<br>
<a href="http://pastebin.com/Zh0rareA" class="onebox" target="_blank" rel="nofollow noopener">http://pastebin.com/Zh0rareA</a></p>
<p>SAVE AND COMPILE!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/fixing-the-lobby-and-worldlist-718-742/520148/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/fixing-the-lobby-and-worldlist-718-742/520148/1</link>
        <pubDate>Sun, 26 May 2013 23:51:29 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-520148-1</guid>
        <source url="https://forum.moparisthebest.com/t/fixing-the-lobby-and-worldlist-718-742/520148.rss">Fixing the Lobby and Worldlist [718/742]</source>
      </item>
  </channel>
</rss>
