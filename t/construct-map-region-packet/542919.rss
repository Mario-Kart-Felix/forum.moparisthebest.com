<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Construct map region packet</title>
    <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919</link>
    <description>NO clue why I can&#39;t get this working, I thought it was the way I was doing it so I used Graham&#39;s version, still doesn&#39;t work. Tried different clients... and still doesn&#39;t work. Anyone have any clue what I&#39;m doing wrong?

Whenever I do it, a new region will load but no tiles will be on it... like so:

[img]http://i891.photobucket.com/albums/ac113/zezimo52/constructmap_zps9239c327.png[/img]


The code I&#39;m using to load the region:

[code]            Palette p = new Palette();
            for (int z = 0; z &lt; 4; z++) {
                for (int x = 0; x &lt; 13; x++) {
                    for (int y = 0; y &lt; 13; y++) {
                        p.setTile(x, y, z, new PaletteTile(3222, 3222, 0));
                    }
                }
            }

            player.getPacketBuilder().sendCustomMapRegion(p);[/code]

The packet itself:

[code]    public PacketEncoder sendCustomMapRegion(Palette palette) {
        this.sendMapRegion();
        PacketBuffer.WriteBuffer out = PacketBuffer.newWriteBuffer(100);
        out.writeVariableShortPacketHeader(241);
        out.writeShort(player.getPosition().getRegionY() + 6, ValueType.A);
        out.setAccessType(AccessType.BIT_ACCESS);

        for (int z = 0; z &lt; 4; z++) {
            for (int x = 0; x &lt; 13; x++) {
                for (int y = 0; y &lt; 13; y++) {
                    PaletteTile tile = palette.getTile(x, y, z);
                    out.writeBits(1, tile != null ? 1 : 0);
                    if (tile != null) {
                        out.writeBits(26, tile.getX() &lt;&lt; 14 | tile.getY() &lt;&lt; 3 | tile.getZ() &lt;&lt; 24 | tile.getRotation() &lt;&lt; 1);
                    }
                }
            }
        }
        out.setAccessType(AccessType.BYTE_ACCESS);
        out.writeShort(player.getPosition().getRegionX() + 6);
        out.finishVariableShortPacketHeader();
        player.getSession().encode(out);
        return this;
    }[/code]

The palette class:

[code]package server.world.map;

/**
 * Manages a palette of map regions for use in the constructed map region
 * packet.
 * 
 * @author Graham
 * 
 */
public class Palette {

    /**
     * Normal direction.
     */
    public static final int DIRECTION_NORMAL = 0;

    /**
     * Rotation direction clockwise by 0 degrees.
     */
    public static final int DIRECTION_CW_0 = 0;

    /**
     * Rotation direction clockwise by 90 degrees.
     */
    public static final int DIRECTION_CW_90 = 1;

    /**
     * Rotation direction clockwise by 180 degrees.
     */
    public static final int DIRECTION_CW_180 = 2;

    /**
     * Rotation direction clockwise by 270 degrees.
     */
    public static final int DIRECTION_CW_270 = 3;

    /**
     * Represents a tile to copy in the palette.
     * 
     * @author Graham Edgecombe
     * 
     */
    public static class PaletteTile {

        /**
         * X coordinate.
         */
        private int x;

        /**
         * Y coordinate.
         */
        private int y;

        /**
         * Z coordinate.
         */
        private int z;

        /**
         * Rotation.
         */
        private int rot;

        /**
         * Creates a tile.
         * 
         * @param x
         *        The x coordinate.
         * @param y
         *        The y coordinate.
         */
        public PaletteTile(int x, int y) {
            this(x, y, 0);
        }

        /**
         * Creates a tile.
         * 
         * @param x
         *        The x coordinate.
         * @param y
         *        The y coordinate.
         * @param z
         *        The z coordinate.
         */
        public PaletteTile(int x, int y, int z) {
            this(x, y, z, DIRECTION_NORMAL);
        }

        /**
         * Creates a tile.
         * 
         * @param x
         *        The x coordinate.
         * @param y
         *        The y coordinate.
         * @param z
         *        The z coordinate.
         * @param rot
         *        The rotation.
         */
        public PaletteTile(int x, int y, int z, int rot) {
            this.x = x;
            this.y = y;
            this.z = z;
            this.rot = rot;
        }

        /**
         * Gets the x coordinate.
         * 
         * @return The x coordinate.
         */
        public int getX() {
            return x / 8;
        }

        /**
         * Gets the y coordinate.
         * 
         * @return The y coordinate.
         */
        public int getY() {
            return y / 8;
        }

        /**
         * Gets the z coordinate.
         * 
         * @return The z coordinate.
         */
        public int getZ() {
            return z % 4;
        }

        /**
         * Gets the rotation.
         * 
         * @return The rotation.
         */
        public int getRotation() {
            return rot % 4;
        }

    }

    /**
     * The array of tiles.
     */
    private PaletteTile[][][] tiles = new PaletteTile[13][13][4];

    /**
     * Gets a tile.
     * 
     * @param x
     *        X position.
     * @param y
     *        Y position.
     * @param z
     *        Z position.
     * @return The tile.
     */
    public PaletteTile getTile(int x, int y, int z) {
        return tiles[x][y][z];
    }

    /**
     * Sets a tile.
     * 
     * @param x
     *        X position.
     * @param y
     *        Y position.
     * @param z
     *        Z position.
     * @param tile
     *        The tile.
     */
    public void setTile(int x, int y, int z, PaletteTile tile) {
        tiles[x][y][z] = tile;
    }

}[/code]

Any help at all is appreciated! Thank you!</description>
    
    <lastBuildDate>Tue, 10 Jun 2014 16:14:08 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@eyeownyew Eyeownyew]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/eyeownyew">@eyeownyew</a> wrote:</p>
          <blockquote>
              <p>Did you ever get this to work?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/41">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/41</link>
        <pubDate>Tue, 10 Jun 2014 16:14:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-41</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@TabbyKiller TabbyKiller]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/tabbykiller">@TabbyKiller</a> wrote:</p>
          <blockquote>
              <p>I seemed to have screwed up this post, sorry about that. Apparently when I split the topic it completely removed other parts of the topic?</p>
<p>EDIT: all fixed, mostly, sorry about that.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/40">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/40</link>
        <pubDate>Sat, 17 May 2014 23:53:46 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-40</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@strucker Strucker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/strucker">@strucker</a> wrote:</p>
          <blockquote>
              <p>[quote=“sk8rdude461, post:35, topic:542919”][quote author=Strucker link=topic=661796.msg4424867#msg4424867 date=1400361590]<br>
what would this packet be in pi[code] public PacketEncoder sendCustomMapRegion(Palette palette) {<br>
this.sendMapRegion();<br>
PacketBuffer.WriteBuffer out = PacketBuffer.newWriteBuffer(100);<br>
out.writeVariableShortPacketHeader(241);<br>
out.writeShort(player.getPosition().getRegionY() + 6, ValueType.A);<br>
out.setAccessType(AccessType.BIT_ACCESS);</p>
<pre><code>    for (int z = 0; z &lt; 4; z++) {
        for (int x = 0; x &lt; 13; x++) {
            for (int y = 0; y &lt; 13; y++) {
                PaletteTile tile = palette.getTile(x, y, z);
                out.writeBits(1, tile != null ? 1 : 0);
                if (tile != null) {
                    out.writeBits(26, tile.getX() &lt;&lt; 14 | tile.getY() &lt;&lt; 3 | tile.getZ() &lt;&lt; 24 | tile.getRotation() &lt;&lt; 1);
                }
            }
        }
    }
    out.setAccessType(AccessType.BYTE_ACCESS);
    out.writeShort(player.getPosition().getRegionX() + 6);
    out.finishVariableShortPacketHeader();
    player.getSession().encode(out);
    return this;
}[/code]
</code></pre>
<p>[/quote]<br>
Hey bud, I know you’re wanting to get this to work and all… But this isn’t your topic…[/quote]<a href="https://www.moparisthebest.com/smf/index.php?topic=662016.new#new" rel="nofollow noopener">https://www.moparisthebest.com/smf/index.php?topic=662016.new#new</a><br>
help me now?lolol</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/39">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/39</link>
        <pubDate>Sat, 17 May 2014 21:40:33 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-39</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@Dan0194 Dan0194]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/dan0194">@Dan0194</a> wrote:</p>
          <blockquote>
              <p>[quote=“Strucker, post:34, topic:542919”]what would this packet be in pi[code] public PacketEncoder sendCustomMapRegion(Palette palette) {<br>
this.sendMapRegion();<br>
PacketBuffer.WriteBuffer out = PacketBuffer.newWriteBuffer(100);<br>
out.writeVariableShortPacketHeader(241);<br>
out.writeShort(player.getPosition().getRegionY() + 6, ValueType.A);<br>
out.setAccessType(AccessType.BIT_ACCESS);</p>
<pre><code>    for (int z = 0; z &lt; 4; z++) {
        for (int x = 0; x &lt; 13; x++) {
            for (int y = 0; y &lt; 13; y++) {
                PaletteTile tile = palette.getTile(x, y, z);
                out.writeBits(1, tile != null ? 1 : 0);
                if (tile != null) {
                    out.writeBits(26, tile.getX() &lt;&lt; 14 | tile.getY() &lt;&lt; 3 | tile.getZ() &lt;&lt; 24 | tile.getRotation() &lt;&lt; 1);
                }
            }
        }
    }
    out.setAccessType(AccessType.BYTE_ACCESS);
    out.writeShort(player.getPosition().getRegionX() + 6);
    out.finishVariableShortPacketHeader();
    player.getSession().encode(out);
    return this;
}[/code] 
</code></pre>
<p>edit found this in my packet handler<br>
packetId[241] = new ClickingInGame();<br>
is it by anychance wrong? the ClickingInGame class is empty…[/quote]<br>
This is a outgoing packet not an incoming packet.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/38">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/38</link>
        <pubDate>Sat, 17 May 2014 21:35:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-38</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>[quote=“Ashi, post:36, topic:542919”][quote author=sk8rdude461 link=topic=661796.msg4424870#msg4424870 date=1400362223]</p>
<aside class="quote">
<blockquote>
<p>what would this packet be in pi[code] public PacketEncoder sendCustomMapRegion(Palette palette) {<br>
this.sendMapRegion();<br>
PacketBuffer.WriteBuffer out = PacketBuffer.newWriteBuffer(100);<br>
out.writeVariableShortPacketHeader(241);<br>
out.writeShort(player.getPosition().getRegionY() + 6, ValueType.A);<br>
out.setAccessType(AccessType.BIT_ACCESS);</p>
<pre><code>    for (int z = 0; z &lt; 4; z++) {
        for (int x = 0; x &lt; 13; x++) {
            for (int y = 0; y &lt; 13; y++) {
                PaletteTile tile = palette.getTile(x, y, z);
                out.writeBits(1, tile != null ? 1 : 0);
                if (tile != null) {
                    out.writeBits(26, tile.getX() &lt;&lt; 14 | tile.getY() &lt;&lt; 3 | tile.getZ() &lt;&lt; 24 | tile.getRotation() &lt;&lt; 1);
                }
            }
        }
    }
    out.setAccessType(AccessType.BYTE_ACCESS);
    out.writeShort(player.getPosition().getRegionX() + 6);
    out.finishVariableShortPacketHeader();
    player.getSession().encode(out);
    return this;
}[/code]
</code></pre>
</blockquote>
</aside>
<p>Hey bud, I know you’re wanting to get this to work and all… But this isn’t your topic…<br>
[/quote]<br>
Are you trying to get your post count up by posting useless things?[/quote]<br>
No. He is technically off topic by posting his own issue(s).</p>
<p>If he wants help with the construct region packet, he should make his own topic about it. That way it doesn’t interfere with lare96 getting help.</p>
<p>Also, by stating I posted a useless reply, you posted a useless reply as well.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/37">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/37</link>
        <pubDate>Sat, 17 May 2014 21:33:53 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-37</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@Ashi Ashi]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ashi">@Ashi</a> wrote:</p>
          <blockquote>
              <p>[quote=“sk8rdude461, post:35, topic:542919”][quote author=Strucker link=topic=661796.msg4424867#msg4424867 date=1400361590]<br>
what would this packet be in pi[code] public PacketEncoder sendCustomMapRegion(Palette palette) {<br>
this.sendMapRegion();<br>
PacketBuffer.WriteBuffer out = PacketBuffer.newWriteBuffer(100);<br>
out.writeVariableShortPacketHeader(241);<br>
out.writeShort(player.getPosition().getRegionY() + 6, ValueType.A);<br>
out.setAccessType(AccessType.BIT_ACCESS);</p>
<pre><code>    for (int z = 0; z &lt; 4; z++) {
        for (int x = 0; x &lt; 13; x++) {
            for (int y = 0; y &lt; 13; y++) {
                PaletteTile tile = palette.getTile(x, y, z);
                out.writeBits(1, tile != null ? 1 : 0);
                if (tile != null) {
                    out.writeBits(26, tile.getX() &lt;&lt; 14 | tile.getY() &lt;&lt; 3 | tile.getZ() &lt;&lt; 24 | tile.getRotation() &lt;&lt; 1);
                }
            }
        }
    }
    out.setAccessType(AccessType.BYTE_ACCESS);
    out.writeShort(player.getPosition().getRegionX() + 6);
    out.finishVariableShortPacketHeader();
    player.getSession().encode(out);
    return this;
}[/code]
</code></pre>
<p>[/quote]<br>
Hey bud, I know you’re wanting to get this to work and all… But this isn’t your topic…[/quote]<br>
Are you trying to get your post count up by posting useless things?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/36">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/36</link>
        <pubDate>Sat, 17 May 2014 21:31:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-36</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <p>[quote=“Strucker, post:34, topic:542919”]what would this packet be in pi[code] public PacketEncoder sendCustomMapRegion(Palette palette) {<br>
this.sendMapRegion();<br>
PacketBuffer.WriteBuffer out = PacketBuffer.newWriteBuffer(100);<br>
out.writeVariableShortPacketHeader(241);<br>
out.writeShort(player.getPosition().getRegionY() + 6, ValueType.A);<br>
out.setAccessType(AccessType.BIT_ACCESS);</p>
<pre><code>    for (int z = 0; z &lt; 4; z++) {
        for (int x = 0; x &lt; 13; x++) {
            for (int y = 0; y &lt; 13; y++) {
                PaletteTile tile = palette.getTile(x, y, z);
                out.writeBits(1, tile != null ? 1 : 0);
                if (tile != null) {
                    out.writeBits(26, tile.getX() &lt;&lt; 14 | tile.getY() &lt;&lt; 3 | tile.getZ() &lt;&lt; 24 | tile.getRotation() &lt;&lt; 1);
                }
            }
        }
    }
    out.setAccessType(AccessType.BYTE_ACCESS);
    out.writeShort(player.getPosition().getRegionX() + 6);
    out.finishVariableShortPacketHeader();
    player.getSession().encode(out);
    return this;
}[/code][/quote]
</code></pre>
<p>Hey bud, I know you’re wanting to get this to work and all… But this isn’t your topic…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/35">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/35</link>
        <pubDate>Sat, 17 May 2014 21:30:23 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-35</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@strucker Strucker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/strucker">@strucker</a> wrote:</p>
          <blockquote>
              <p>what would this packet be in pi[code] public PacketEncoder sendCustomMapRegion(Palette palette) {<br>
this.sendMapRegion();<br>
PacketBuffer.WriteBuffer out = PacketBuffer.newWriteBuffer(100);<br>
out.writeVariableShortPacketHeader(241);<br>
out.writeShort(player.getPosition().getRegionY() + 6, ValueType.A);<br>
out.setAccessType(AccessType.BIT_ACCESS);</p>
<pre><code>    for (int z = 0; z &lt; 4; z++) {
        for (int x = 0; x &lt; 13; x++) {
            for (int y = 0; y &lt; 13; y++) {
                PaletteTile tile = palette.getTile(x, y, z);
                out.writeBits(1, tile != null ? 1 : 0);
                if (tile != null) {
                    out.writeBits(26, tile.getX() &lt;&lt; 14 | tile.getY() &lt;&lt; 3 | tile.getZ() &lt;&lt; 24 | tile.getRotation() &lt;&lt; 1);
                }
            }
        }
    }
    out.setAccessType(AccessType.BYTE_ACCESS);
    out.writeShort(player.getPosition().getRegionX() + 6);
    out.finishVariableShortPacketHeader();
    player.getSession().encode(out);
    return this;
}[/code] 
</code></pre>
<p>edit found this in my packet handler<br>
packetId[241] = new ClickingInGame();<br>
is it by anychance wrong? the ClickingInGame class is empty…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/34">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/34</link>
        <pubDate>Sat, 17 May 2014 21:19:50 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-34</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@sk8rdude461 sk8rdude461]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sk8rdude461">@sk8rdude461</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="32" data-topic="542919">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/strucker/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> Strucker:</div>
<blockquote>
<p>How would i go around doing this??? <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=5" title=":confused:" class="emoji" alt=":confused:"> <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=5" title=":confused:" class="emoji" alt=":confused:"></p>
</blockquote>
</aside>
<p><a href="http://www.rune-server.org/runescape-development/rs2-server/tutorials/518679-pi-real-construction-using-construct-map-region-packet.html" class="onebox" target="_blank" rel="nofollow noopener">http://www.rune-server.org/runescape-development/rs2-server/tutorials/518679-pi-real-construction-using-construct-map-region-packet.html</a><br>
Might help.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/33">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/33</link>
        <pubDate>Sat, 17 May 2014 19:38:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-33</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@strucker Strucker]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/strucker">@strucker</a> wrote:</p>
          <blockquote>
              <p>How would i go around doing this??? <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=5" title=":confused:" class="emoji" alt=":confused:"> <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=5" title=":confused:" class="emoji" alt=":confused:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/32">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/32</link>
        <pubDate>Sat, 17 May 2014 19:36:51 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-32</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@HcoJustin HcoJustin]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/hcojustin">@HcoJustin</a> wrote:</p>
          <blockquote>
              <p>[quote=“lare69, post:29, topic:542919”][quote author=HcoJustin link=topic=661796.msg4424698#msg4424698 date=1400288170]<br>
If that is the problem then OP needs to not send the map region before sending the new packet, or make sure he sends a different region X/Y<br>
[/quote]<br>
wait so I shouldn’t be sending the map region before the packet?[/quote]<br>
According to the code, no. If the region X/Y are the same as from the last time the packet was received it will ignore it.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/31">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/31</link>
        <pubDate>Sat, 17 May 2014 16:03:11 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-31</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@Dan0194 Dan0194]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/dan0194">@Dan0194</a> wrote:</p>
          <blockquote>
              <p>[quote=“lare69, post:29, topic:542919”][quote author=HcoJustin link=topic=661796.msg4424698#msg4424698 date=1400288170]<br>
If that is the problem then OP needs to not send the map region before sending the new packet, or make sure he sends a different region X/Y<br>
[/quote]<br>
wait so I shouldn’t be sending the map region before the packet?[/quote]<br>
I send the map region before the packet and it still works for me.  <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=5" title=":confused:" class="emoji" alt=":confused:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/30">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/30</link>
        <pubDate>Sat, 17 May 2014 14:57:55 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-30</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@Clawz_fury lare69]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/clawz_fury">@Clawz_fury</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="26" data-topic="542919">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/hcojustin/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> HcoJustin:</div>
<blockquote>
<p>If that is the problem then OP needs to not send the map region before sending the new packet, or make sure he sends a different region X/Y</p>
</blockquote>
</aside>
<p>wait so I shouldn’t be sending the map region before the packet?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/29">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/29</link>
        <pubDate>Sat, 17 May 2014 07:50:16 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-29</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@asshole_rule asshole_rule]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/asshole_rule">@asshole_rule</a> wrote:</p>
          <blockquote>
              <p>[quote=“Pure_, post:27, topic:542919”][quote author=asshole_rule link=topic=661796.msg4424697#msg4424697 date=1400287860]</p>
<aside class="quote">
<blockquote>
<aside class="quote">
<blockquote>
<p>post your client code in parsePacket() i’m 99% sure it’s a quick fix</p>
</blockquote>
</aside>
<p>[code=java]            if (pktType == 73 || pktType == 241) {</p>
<pre><code>            // mapReset();
            int l2 = anInt1069;
            int i11 = anInt1070;
            if (pktType == 73) {
                l2 = inStream.method435();
                i11 = inStream.readUnsignedWord();
                aBoolean1159 = false;
            }
            if (pktType == 241) {
                i11 = inStream.method435();
                inStream.initBitAccess();
                for (int j16 = 0; j16 &lt; 4; j16++) {
                    for (int l20 = 0; l20 &lt; 13; l20++) {
                        for (int j23 = 0; j23 &lt; 13; j23++) {
                            int i26 = inStream.readBits(1);
                            if (i26 == 1)
                                anIntArrayArrayArray1129[j16][l20][j23] = inStream.readBits(26);
                            else
                                anIntArrayArrayArray1129[j16][l20][j23] = -1;
                        }

                    }

                }
                inStream.finishBitAccess();
                l2 = inStream.readUnsignedWord();
                aBoolean1159 = true;
            }
            if (anInt1069 == l2 &amp;&amp; anInt1070 == i11 &amp;&amp; loadingStage == 2) {
                pktType = -1;
                return true;
            }
            anInt1069 = l2;
            anInt1070 = i11;
            baseX = (anInt1069 - 6) * 8;
            baseY = (anInt1070 - 6) * 8;
            aBoolean1141 = (anInt1069 / 8 == 48 || anInt1069 / 8 == 49) &amp;&amp; anInt1070 / 8 == 48;
            if (anInt1069 / 8 == 48 &amp;&amp; anInt1070 / 8 == 148)
                aBoolean1141 = true;
            loadingStage = 1;
            aLong824 = System.currentTimeMillis();
            aRSImageProducer_1165.initDrawingArea();
            aTextDrawingArea_1271.drawText(0, "Loading - please wait.", 151, 257);
            aTextDrawingArea_1271.drawText(0xffffff, "Loading - please wait.", 150, 256);
            aRSImageProducer_1165.drawGraphics(4, super.graphics, 4);
            if (pktType == 73) {
                int k16 = 0;
                for (int i21 = (anInt1069 - 6) / 8; i21 &lt;= (anInt1069 + 6) / 8; i21++) {
                    for (int k23 = (anInt1070 - 6) / 8; k23 &lt;= (anInt1070 + 6) / 8; k23++)
                        k16++;

                }

                aByteArrayArray1183 = new byte[k16][];
                aByteArrayArray1247 = new byte[k16][];
                anIntArray1234 = new int[k16];
                anIntArray1235 = new int[k16];
                anIntArray1236 = new int[k16];
                k16 = 0;
                for (int l23 = (anInt1069 - 6) / 8; l23 &lt;= (anInt1069 + 6) / 8; l23++) {
                    for (int j26 = (anInt1070 - 6) / 8; j26 &lt;= (anInt1070 + 6) / 8; j26++) {
                        anIntArray1234[k16] = (l23 &lt;&lt; 8) + j26;
                        if (aBoolean1141 &amp;&amp; (j26 == 49 || j26 == 149 || j26 == 147 || l23 == 50 || l23 == 49 &amp;&amp; j26 == 47)) {
                            anIntArray1235[k16] = -1;
                            anIntArray1236[k16] = -1;
                            k16++;
                        } else {
                            int k28 = anIntArray1235[k16] = onDemandFetcher.method562(0, j26, l23);
                            if (k28 != -1)
                                onDemandFetcher.method558(3, k28);
                            int j30 = anIntArray1236[k16] = onDemandFetcher.method562(1, j26, l23);
                            if (j30 != -1)
                                onDemandFetcher.method558(3, j30);
                            k16++;
                        }
                    }

                }

            }
            if (pktType == 241) {
                int l16 = 0;
                int ai[] = new int[676];
                for (int i24 = 0; i24 &lt; 4; i24++) {
                    for (int k26 = 0; k26 &lt; 13; k26++) {
                        for (int l28 = 0; l28 &lt; 13; l28++) {
                            int k30 = anIntArrayArrayArray1129[i24][k26][l28];
                            if (k30 != -1) {
                                int k31 = k30 &gt;&gt; 14 &amp; 0x3ff;
                                int i32 = k30 &gt;&gt; 3 &amp; 0x7ff;
                                int k32 = (k31 / 8 &lt;&lt; 8) + i32 / 8;
                                for (int j33 = 0; j33 &lt; l16; j33++) {
                                    if (ai[j33] != k32)
                                        continue;
                                    k32 = -1;
                                    break;
                                }

                                if (k32 != -1)
                                    ai[l16++] = k32;
                            }
                        }

                    }

                }

                aByteArrayArray1183 = new byte[l16][];
                aByteArrayArray1247 = new byte[l16][];
                anIntArray1234 = new int[l16];
                anIntArray1235 = new int[l16];
                anIntArray1236 = new int[l16];
                for (int l26 = 0; l26 &lt; l16; l26++) {
                    int i29 = anIntArray1234[l26] = ai[l26];
                    int l30 = i29 &gt;&gt; 8 &amp; 0xff;
                    int l31 = i29 &amp; 0xff;
                    int j32 = anIntArray1235[l26] = onDemandFetcher.method562(0, l31, l30);
                    if (j32 != -1)
                        onDemandFetcher.method558(3, j32);
                    int i33 = anIntArray1236[l26] = onDemandFetcher.method562(1, l31, l30);
                    if (i33 != -1)
                        onDemandFetcher.method558(3, i33);
                }

            }
            int i17 = baseX - anInt1036;
            int j21 = baseY - anInt1037;
            anInt1036 = baseX;
            anInt1037 = baseY;
            for (int j24 = 0; j24 &lt; 16384; j24++) {
                NPC npc = npcArray[j24];
                if (npc != null) {
                    for (int j29 = 0; j29 &lt; 10; j29++) {
                        npc.smallX[j29] -= i17;
                        npc.smallY[j29] -= j21;
                    }

                    npc.x -= i17 * 128;
                    npc.y -= j21 * 128;
                }
            }

            for (int i27 = 0; i27 &lt; maxPlayers; i27++) {
                Player player = playerArray[i27];
                if (player != null) {
                    for (int i31 = 0; i31 &lt; 10; i31++) {
                        player.smallX[i31] -= i17;
                        player.smallY[i31] -= j21;
                    }

                    player.x -= i17 * 128;
                    player.y -= j21 * 128;
                }
            }

            aBoolean1080 = true;
            byte byte1 = 0;
            byte byte2 = 104;
            byte byte3 = 1;
            if (i17 &lt; 0) {
                byte1 = 103;
                byte2 = -1;
                byte3 = -1;
            }
            byte byte4 = 0;
            byte byte5 = 104;
            byte byte6 = 1;
            if (j21 &lt; 0) {
                byte4 = 103;
                byte5 = -1;
                byte6 = -1;
            }
            for (int k33 = byte1; k33 != byte2; k33 += byte3) {
                for (int l33 = byte4; l33 != byte5; l33 += byte6) {
                    int i34 = k33 + i17;
                    int j34 = l33 + j21;
                    for (int k34 = 0; k34 &lt; 4; k34++)
                        if (i34 &gt;= 0 &amp;&amp; j34 &gt;= 0 &amp;&amp; i34 &lt; 104 &amp;&amp; j34 &lt; 104)
                            groundArray[k34][k33][l33] = groundArray[k34][i34][j34];
                        else
                            groundArray[k34][k33][l33] = null;

                }

            }

            for (Class30_Sub1 class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetFirst(); class30_sub1_1 != null; class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetNext()) {
                class30_sub1_1.anInt1297 -= i17;
                class30_sub1_1.anInt1298 -= j21;
                if (class30_sub1_1.anInt1297 &lt; 0 || class30_sub1_1.anInt1298 &lt; 0 || class30_sub1_1.anInt1297 &gt;= 104 || class30_sub1_1.anInt1298 &gt;= 104)
                    class30_sub1_1.unlink();
            }

            if (destX != 0) {
                destX -= i17;
                destY -= j21;
            }
            aBoolean1160 = false;
            pktType = -1;
            return true;
        }[/code]
</code></pre>
</blockquote>
</aside>
<p>[code=java]            if (pktType == 73 || pktType == 241) {</p>
<pre><code>            // mapReset();
            int l2 = anInt1069;
            int i11 = anInt1070;
            if (pktType == 73) {
                l2 = inStream.method435();
                i11 = inStream.readUnsignedWord();
                aBoolean1159 = false;
            }
            if (pktType == 241) {
                i11 = inStream.method435();
                inStream.initBitAccess();
                for (int j16 = 0; j16 &lt; 4; j16++) {
                    for (int l20 = 0; l20 &lt; 13; l20++) {
                        for (int j23 = 0; j23 &lt; 13; j23++) {
                            int i26 = inStream.readBits(1);
                            if (i26 == 1)
                                anIntArrayArrayArray1129[j16][l20][j23] = inStream.readBits(26);
                            else
                                anIntArrayArrayArray1129[j16][l20][j23] = -1;
                        }

                    }

                }
                inStream.finishBitAccess();
                l2 = inStream.readUnsignedWord();
                aBoolean1159 = true;
            }
            if (anInt1069 == l2 &amp;&amp; anInt1070 == i11 &amp;&amp; loadingStage == 2) {
                pktType = -1;
                //return true;
            }
            anInt1069 = l2;
            anInt1070 = i11;
            baseX = (anInt1069 - 6) * 8;
            baseY = (anInt1070 - 6) * 8;
            aBoolean1141 = (anInt1069 / 8 == 48 || anInt1069 / 8 == 49) &amp;&amp; anInt1070 / 8 == 48;
            if (anInt1069 / 8 == 48 &amp;&amp; anInt1070 / 8 == 148)
                aBoolean1141 = true;
            loadingStage = 1;
            aLong824 = System.currentTimeMillis();
            aRSImageProducer_1165.initDrawingArea();
            aTextDrawingArea_1271.drawText(0, "Loading - please wait.", 151, 257);
            aTextDrawingArea_1271.drawText(0xffffff, "Loading - please wait.", 150, 256);
            aRSImageProducer_1165.drawGraphics(4, super.graphics, 4);
            if (pktType == 73) {
                int k16 = 0;
                for (int i21 = (anInt1069 - 6) / 8; i21 &lt;= (anInt1069 + 6) / 8; i21++) {
                    for (int k23 = (anInt1070 - 6) / 8; k23 &lt;= (anInt1070 + 6) / 8; k23++)
                        k16++;

                }

                aByteArrayArray1183 = new byte[k16][];
                aByteArrayArray1247 = new byte[k16][];
                anIntArray1234 = new int[k16];
                anIntArray1235 = new int[k16];
                anIntArray1236 = new int[k16];
                k16 = 0;
                for (int l23 = (anInt1069 - 6) / 8; l23 &lt;= (anInt1069 + 6) / 8; l23++) {
                    for (int j26 = (anInt1070 - 6) / 8; j26 &lt;= (anInt1070 + 6) / 8; j26++) {
                        anIntArray1234[k16] = (l23 &lt;&lt; 8) + j26;
                        if (aBoolean1141 &amp;&amp; (j26 == 49 || j26 == 149 || j26 == 147 || l23 == 50 || l23 == 49 &amp;&amp; j26 == 47)) {
                            anIntArray1235[k16] = -1;
                            anIntArray1236[k16] = -1;
                            k16++;
                        } else {
                            int k28 = anIntArray1235[k16] = onDemandFetcher.method562(0, j26, l23);
                            if (k28 != -1)
                                onDemandFetcher.method558(3, k28);
                            int j30 = anIntArray1236[k16] = onDemandFetcher.method562(1, j26, l23);
                            if (j30 != -1)
                                onDemandFetcher.method558(3, j30);
                            k16++;
                        }
                    }

                }

            }
            if (pktType == 241) {
                int l16 = 0;
                int ai[] = new int[676];
                for (int i24 = 0; i24 &lt; 4; i24++) {
                    for (int k26 = 0; k26 &lt; 13; k26++) {
                        for (int l28 = 0; l28 &lt; 13; l28++) {
                            int k30 = anIntArrayArrayArray1129[i24][k26][l28];
                            if (k30 != -1) {
                                int k31 = k30 &gt;&gt; 14 &amp; 0x3ff;
                                int i32 = k30 &gt;&gt; 3 &amp; 0x7ff;
                                int k32 = (k31 / 8 &lt;&lt; 8) + i32 / 8;
                                for (int j33 = 0; j33 &lt; l16; j33++) {
                                    if (ai[j33] != k32)
                                        continue;
                                    k32 = -1;
                                    break;
                                }

                                if (k32 != -1)
                                    ai[l16++] = k32;
                            }
                        }

                    }

                }

                aByteArrayArray1183 = new byte[l16][];
                aByteArrayArray1247 = new byte[l16][];
                anIntArray1234 = new int[l16];
                anIntArray1235 = new int[l16];
                anIntArray1236 = new int[l16];
                for (int l26 = 0; l26 &lt; l16; l26++) {
                    int i29 = anIntArray1234[l26] = ai[l26];
                    int l30 = i29 &gt;&gt; 8 &amp; 0xff;
                    int l31 = i29 &amp; 0xff;
                    int j32 = anIntArray1235[l26] = onDemandFetcher.method562(0, l31, l30);
                    if (j32 != -1)
                        onDemandFetcher.method558(3, j32);
                    int i33 = anIntArray1236[l26] = onDemandFetcher.method562(1, l31, l30);
                    if (i33 != -1)
                        onDemandFetcher.method558(3, i33);
                }

            }
            int i17 = baseX - anInt1036;
            int j21 = baseY - anInt1037;
            anInt1036 = baseX;
            anInt1037 = baseY;
            for (int j24 = 0; j24 &lt; 16384; j24++) {
                NPC npc = npcArray[j24];
                if (npc != null) {
                    for (int j29 = 0; j29 &lt; 10; j29++) {
                        npc.smallX[j29] -= i17;
                        npc.smallY[j29] -= j21;
                    }

                    npc.x -= i17 * 128;
                    npc.y -= j21 * 128;
                }
            }

            for (int i27 = 0; i27 &lt; maxPlayers; i27++) {
                Player player = playerArray[i27];
                if (player != null) {
                    for (int i31 = 0; i31 &lt; 10; i31++) {
                        player.smallX[i31] -= i17;
                        player.smallY[i31] -= j21;
                    }

                    player.x -= i17 * 128;
                    player.y -= j21 * 128;
                }
            }

            aBoolean1080 = true;
            byte byte1 = 0;
            byte byte2 = 104;
            byte byte3 = 1;
            if (i17 &lt; 0) {
                byte1 = 103;
                byte2 = -1;
                byte3 = -1;
            }
            byte byte4 = 0;
            byte byte5 = 104;
            byte byte6 = 1;
            if (j21 &lt; 0) {
                byte4 = 103;
                byte5 = -1;
                byte6 = -1;
            }
            for (int k33 = byte1; k33 != byte2; k33 += byte3) {
                for (int l33 = byte4; l33 != byte5; l33 += byte6) {
                    int i34 = k33 + i17;
                    int j34 = l33 + j21;
                    for (int k34 = 0; k34 &lt; 4; k34++)
                        if (i34 &gt;= 0 &amp;&amp; j34 &gt;= 0 &amp;&amp; i34 &lt; 104 &amp;&amp; j34 &lt; 104)
                            groundArray[k34][k33][l33] = groundArray[k34][i34][j34];
                        else
                            groundArray[k34][k33][l33] = null;

                }

            }

            for (Class30_Sub1 class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetFirst(); class30_sub1_1 != null; class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetNext()) {
                class30_sub1_1.anInt1297 -= i17;
                class30_sub1_1.anInt1298 -= j21;
                if (class30_sub1_1.anInt1297 &lt; 0 || class30_sub1_1.anInt1298 &lt; 0 || class30_sub1_1.anInt1297 &gt;= 104 || class30_sub1_1.anInt1298 &gt;= 104)
                    class30_sub1_1.unlink();
            }

            if (destX != 0) {
                destX -= i17;
                destY -= j21;
            }
            aBoolean1160 = false;
            pktType = -1;
            return true;
        }[/code]
</code></pre>
<p>replace it with this and im pretty sure it’ll work<br>
[/quote]From the first 200 or so lines I looked at, they seem identical…[/quote]</p>
<p>ok well only 1 line is changed so…</p>
<aside class="quote" data-post="26" data-topic="542919">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/hcojustin/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> HcoJustin:</div>
<blockquote>
<p>If that is the problem then OP needs to not send the map region before sending the new packet, or make sure he sends a different region X/Y</p>
</blockquote>
</aside>
<p>i had this problem before so i think it’ll fix it</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/28">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/28</link>
        <pubDate>Sat, 17 May 2014 02:39:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-28</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@pure2ownage Pure_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/pure2ownage">@pure2ownage</a> wrote:</p>
          <blockquote>
              <p>[quote=“asshole_rule, post:25, topic:542919”][quote author=lare69 link=topic=661796.msg4424069#msg4424069 date=1399861173]</p>
<aside class="quote">
<blockquote>
<p>post your client code in parsePacket() i’m 99% sure it’s a quick fix</p>
</blockquote>
</aside>
<p>[code=java]            if (pktType == 73 || pktType == 241) {</p>
<pre><code>            // mapReset();
            int l2 = anInt1069;
            int i11 = anInt1070;
            if (pktType == 73) {
                l2 = inStream.method435();
                i11 = inStream.readUnsignedWord();
                aBoolean1159 = false;
            }
            if (pktType == 241) {
                i11 = inStream.method435();
                inStream.initBitAccess();
                for (int j16 = 0; j16 &lt; 4; j16++) {
                    for (int l20 = 0; l20 &lt; 13; l20++) {
                        for (int j23 = 0; j23 &lt; 13; j23++) {
                            int i26 = inStream.readBits(1);
                            if (i26 == 1)
                                anIntArrayArrayArray1129[j16][l20][j23] = inStream.readBits(26);
                            else
                                anIntArrayArrayArray1129[j16][l20][j23] = -1;
                        }

                    }

                }
                inStream.finishBitAccess();
                l2 = inStream.readUnsignedWord();
                aBoolean1159 = true;
            }
            if (anInt1069 == l2 &amp;&amp; anInt1070 == i11 &amp;&amp; loadingStage == 2) {
                pktType = -1;
                return true;
            }
            anInt1069 = l2;
            anInt1070 = i11;
            baseX = (anInt1069 - 6) * 8;
            baseY = (anInt1070 - 6) * 8;
            aBoolean1141 = (anInt1069 / 8 == 48 || anInt1069 / 8 == 49) &amp;&amp; anInt1070 / 8 == 48;
            if (anInt1069 / 8 == 48 &amp;&amp; anInt1070 / 8 == 148)
                aBoolean1141 = true;
            loadingStage = 1;
            aLong824 = System.currentTimeMillis();
            aRSImageProducer_1165.initDrawingArea();
            aTextDrawingArea_1271.drawText(0, "Loading - please wait.", 151, 257);
            aTextDrawingArea_1271.drawText(0xffffff, "Loading - please wait.", 150, 256);
            aRSImageProducer_1165.drawGraphics(4, super.graphics, 4);
            if (pktType == 73) {
                int k16 = 0;
                for (int i21 = (anInt1069 - 6) / 8; i21 &lt;= (anInt1069 + 6) / 8; i21++) {
                    for (int k23 = (anInt1070 - 6) / 8; k23 &lt;= (anInt1070 + 6) / 8; k23++)
                        k16++;

                }

                aByteArrayArray1183 = new byte[k16][];
                aByteArrayArray1247 = new byte[k16][];
                anIntArray1234 = new int[k16];
                anIntArray1235 = new int[k16];
                anIntArray1236 = new int[k16];
                k16 = 0;
                for (int l23 = (anInt1069 - 6) / 8; l23 &lt;= (anInt1069 + 6) / 8; l23++) {
                    for (int j26 = (anInt1070 - 6) / 8; j26 &lt;= (anInt1070 + 6) / 8; j26++) {
                        anIntArray1234[k16] = (l23 &lt;&lt; 8) + j26;
                        if (aBoolean1141 &amp;&amp; (j26 == 49 || j26 == 149 || j26 == 147 || l23 == 50 || l23 == 49 &amp;&amp; j26 == 47)) {
                            anIntArray1235[k16] = -1;
                            anIntArray1236[k16] = -1;
                            k16++;
                        } else {
                            int k28 = anIntArray1235[k16] = onDemandFetcher.method562(0, j26, l23);
                            if (k28 != -1)
                                onDemandFetcher.method558(3, k28);
                            int j30 = anIntArray1236[k16] = onDemandFetcher.method562(1, j26, l23);
                            if (j30 != -1)
                                onDemandFetcher.method558(3, j30);
                            k16++;
                        }
                    }

                }

            }
            if (pktType == 241) {
                int l16 = 0;
                int ai[] = new int[676];
                for (int i24 = 0; i24 &lt; 4; i24++) {
                    for (int k26 = 0; k26 &lt; 13; k26++) {
                        for (int l28 = 0; l28 &lt; 13; l28++) {
                            int k30 = anIntArrayArrayArray1129[i24][k26][l28];
                            if (k30 != -1) {
                                int k31 = k30 &gt;&gt; 14 &amp; 0x3ff;
                                int i32 = k30 &gt;&gt; 3 &amp; 0x7ff;
                                int k32 = (k31 / 8 &lt;&lt; 8) + i32 / 8;
                                for (int j33 = 0; j33 &lt; l16; j33++) {
                                    if (ai[j33] != k32)
                                        continue;
                                    k32 = -1;
                                    break;
                                }

                                if (k32 != -1)
                                    ai[l16++] = k32;
                            }
                        }

                    }

                }

                aByteArrayArray1183 = new byte[l16][];
                aByteArrayArray1247 = new byte[l16][];
                anIntArray1234 = new int[l16];
                anIntArray1235 = new int[l16];
                anIntArray1236 = new int[l16];
                for (int l26 = 0; l26 &lt; l16; l26++) {
                    int i29 = anIntArray1234[l26] = ai[l26];
                    int l30 = i29 &gt;&gt; 8 &amp; 0xff;
                    int l31 = i29 &amp; 0xff;
                    int j32 = anIntArray1235[l26] = onDemandFetcher.method562(0, l31, l30);
                    if (j32 != -1)
                        onDemandFetcher.method558(3, j32);
                    int i33 = anIntArray1236[l26] = onDemandFetcher.method562(1, l31, l30);
                    if (i33 != -1)
                        onDemandFetcher.method558(3, i33);
                }

            }
            int i17 = baseX - anInt1036;
            int j21 = baseY - anInt1037;
            anInt1036 = baseX;
            anInt1037 = baseY;
            for (int j24 = 0; j24 &lt; 16384; j24++) {
                NPC npc = npcArray[j24];
                if (npc != null) {
                    for (int j29 = 0; j29 &lt; 10; j29++) {
                        npc.smallX[j29] -= i17;
                        npc.smallY[j29] -= j21;
                    }

                    npc.x -= i17 * 128;
                    npc.y -= j21 * 128;
                }
            }

            for (int i27 = 0; i27 &lt; maxPlayers; i27++) {
                Player player = playerArray[i27];
                if (player != null) {
                    for (int i31 = 0; i31 &lt; 10; i31++) {
                        player.smallX[i31] -= i17;
                        player.smallY[i31] -= j21;
                    }

                    player.x -= i17 * 128;
                    player.y -= j21 * 128;
                }
            }

            aBoolean1080 = true;
            byte byte1 = 0;
            byte byte2 = 104;
            byte byte3 = 1;
            if (i17 &lt; 0) {
                byte1 = 103;
                byte2 = -1;
                byte3 = -1;
            }
            byte byte4 = 0;
            byte byte5 = 104;
            byte byte6 = 1;
            if (j21 &lt; 0) {
                byte4 = 103;
                byte5 = -1;
                byte6 = -1;
            }
            for (int k33 = byte1; k33 != byte2; k33 += byte3) {
                for (int l33 = byte4; l33 != byte5; l33 += byte6) {
                    int i34 = k33 + i17;
                    int j34 = l33 + j21;
                    for (int k34 = 0; k34 &lt; 4; k34++)
                        if (i34 &gt;= 0 &amp;&amp; j34 &gt;= 0 &amp;&amp; i34 &lt; 104 &amp;&amp; j34 &lt; 104)
                            groundArray[k34][k33][l33] = groundArray[k34][i34][j34];
                        else
                            groundArray[k34][k33][l33] = null;

                }

            }

            for (Class30_Sub1 class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetFirst(); class30_sub1_1 != null; class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetNext()) {
                class30_sub1_1.anInt1297 -= i17;
                class30_sub1_1.anInt1298 -= j21;
                if (class30_sub1_1.anInt1297 &lt; 0 || class30_sub1_1.anInt1298 &lt; 0 || class30_sub1_1.anInt1297 &gt;= 104 || class30_sub1_1.anInt1298 &gt;= 104)
                    class30_sub1_1.unlink();
            }

            if (destX != 0) {
                destX -= i17;
                destY -= j21;
            }
            aBoolean1160 = false;
            pktType = -1;
            return true;
        }[/code]
</code></pre>
<p>[/quote]</p>
<p>[code=java]            if (pktType == 73 || pktType == 241) {</p>
<pre><code>            // mapReset();
            int l2 = anInt1069;
            int i11 = anInt1070;
            if (pktType == 73) {
                l2 = inStream.method435();
                i11 = inStream.readUnsignedWord();
                aBoolean1159 = false;
            }
            if (pktType == 241) {
                i11 = inStream.method435();
                inStream.initBitAccess();
                for (int j16 = 0; j16 &lt; 4; j16++) {
                    for (int l20 = 0; l20 &lt; 13; l20++) {
                        for (int j23 = 0; j23 &lt; 13; j23++) {
                            int i26 = inStream.readBits(1);
                            if (i26 == 1)
                                anIntArrayArrayArray1129[j16][l20][j23] = inStream.readBits(26);
                            else
                                anIntArrayArrayArray1129[j16][l20][j23] = -1;
                        }

                    }

                }
                inStream.finishBitAccess();
                l2 = inStream.readUnsignedWord();
                aBoolean1159 = true;
            }
            if (anInt1069 == l2 &amp;&amp; anInt1070 == i11 &amp;&amp; loadingStage == 2) {
                pktType = -1;
                //return true;
            }
            anInt1069 = l2;
            anInt1070 = i11;
            baseX = (anInt1069 - 6) * 8;
            baseY = (anInt1070 - 6) * 8;
            aBoolean1141 = (anInt1069 / 8 == 48 || anInt1069 / 8 == 49) &amp;&amp; anInt1070 / 8 == 48;
            if (anInt1069 / 8 == 48 &amp;&amp; anInt1070 / 8 == 148)
                aBoolean1141 = true;
            loadingStage = 1;
            aLong824 = System.currentTimeMillis();
            aRSImageProducer_1165.initDrawingArea();
            aTextDrawingArea_1271.drawText(0, "Loading - please wait.", 151, 257);
            aTextDrawingArea_1271.drawText(0xffffff, "Loading - please wait.", 150, 256);
            aRSImageProducer_1165.drawGraphics(4, super.graphics, 4);
            if (pktType == 73) {
                int k16 = 0;
                for (int i21 = (anInt1069 - 6) / 8; i21 &lt;= (anInt1069 + 6) / 8; i21++) {
                    for (int k23 = (anInt1070 - 6) / 8; k23 &lt;= (anInt1070 + 6) / 8; k23++)
                        k16++;

                }

                aByteArrayArray1183 = new byte[k16][];
                aByteArrayArray1247 = new byte[k16][];
                anIntArray1234 = new int[k16];
                anIntArray1235 = new int[k16];
                anIntArray1236 = new int[k16];
                k16 = 0;
                for (int l23 = (anInt1069 - 6) / 8; l23 &lt;= (anInt1069 + 6) / 8; l23++) {
                    for (int j26 = (anInt1070 - 6) / 8; j26 &lt;= (anInt1070 + 6) / 8; j26++) {
                        anIntArray1234[k16] = (l23 &lt;&lt; 8) + j26;
                        if (aBoolean1141 &amp;&amp; (j26 == 49 || j26 == 149 || j26 == 147 || l23 == 50 || l23 == 49 &amp;&amp; j26 == 47)) {
                            anIntArray1235[k16] = -1;
                            anIntArray1236[k16] = -1;
                            k16++;
                        } else {
                            int k28 = anIntArray1235[k16] = onDemandFetcher.method562(0, j26, l23);
                            if (k28 != -1)
                                onDemandFetcher.method558(3, k28);
                            int j30 = anIntArray1236[k16] = onDemandFetcher.method562(1, j26, l23);
                            if (j30 != -1)
                                onDemandFetcher.method558(3, j30);
                            k16++;
                        }
                    }

                }

            }
            if (pktType == 241) {
                int l16 = 0;
                int ai[] = new int[676];
                for (int i24 = 0; i24 &lt; 4; i24++) {
                    for (int k26 = 0; k26 &lt; 13; k26++) {
                        for (int l28 = 0; l28 &lt; 13; l28++) {
                            int k30 = anIntArrayArrayArray1129[i24][k26][l28];
                            if (k30 != -1) {
                                int k31 = k30 &gt;&gt; 14 &amp; 0x3ff;
                                int i32 = k30 &gt;&gt; 3 &amp; 0x7ff;
                                int k32 = (k31 / 8 &lt;&lt; 8) + i32 / 8;
                                for (int j33 = 0; j33 &lt; l16; j33++) {
                                    if (ai[j33] != k32)
                                        continue;
                                    k32 = -1;
                                    break;
                                }

                                if (k32 != -1)
                                    ai[l16++] = k32;
                            }
                        }

                    }

                }

                aByteArrayArray1183 = new byte[l16][];
                aByteArrayArray1247 = new byte[l16][];
                anIntArray1234 = new int[l16];
                anIntArray1235 = new int[l16];
                anIntArray1236 = new int[l16];
                for (int l26 = 0; l26 &lt; l16; l26++) {
                    int i29 = anIntArray1234[l26] = ai[l26];
                    int l30 = i29 &gt;&gt; 8 &amp; 0xff;
                    int l31 = i29 &amp; 0xff;
                    int j32 = anIntArray1235[l26] = onDemandFetcher.method562(0, l31, l30);
                    if (j32 != -1)
                        onDemandFetcher.method558(3, j32);
                    int i33 = anIntArray1236[l26] = onDemandFetcher.method562(1, l31, l30);
                    if (i33 != -1)
                        onDemandFetcher.method558(3, i33);
                }

            }
            int i17 = baseX - anInt1036;
            int j21 = baseY - anInt1037;
            anInt1036 = baseX;
            anInt1037 = baseY;
            for (int j24 = 0; j24 &lt; 16384; j24++) {
                NPC npc = npcArray[j24];
                if (npc != null) {
                    for (int j29 = 0; j29 &lt; 10; j29++) {
                        npc.smallX[j29] -= i17;
                        npc.smallY[j29] -= j21;
                    }

                    npc.x -= i17 * 128;
                    npc.y -= j21 * 128;
                }
            }

            for (int i27 = 0; i27 &lt; maxPlayers; i27++) {
                Player player = playerArray[i27];
                if (player != null) {
                    for (int i31 = 0; i31 &lt; 10; i31++) {
                        player.smallX[i31] -= i17;
                        player.smallY[i31] -= j21;
                    }

                    player.x -= i17 * 128;
                    player.y -= j21 * 128;
                }
            }

            aBoolean1080 = true;
            byte byte1 = 0;
            byte byte2 = 104;
            byte byte3 = 1;
            if (i17 &lt; 0) {
                byte1 = 103;
                byte2 = -1;
                byte3 = -1;
            }
            byte byte4 = 0;
            byte byte5 = 104;
            byte byte6 = 1;
            if (j21 &lt; 0) {
                byte4 = 103;
                byte5 = -1;
                byte6 = -1;
            }
            for (int k33 = byte1; k33 != byte2; k33 += byte3) {
                for (int l33 = byte4; l33 != byte5; l33 += byte6) {
                    int i34 = k33 + i17;
                    int j34 = l33 + j21;
                    for (int k34 = 0; k34 &lt; 4; k34++)
                        if (i34 &gt;= 0 &amp;&amp; j34 &gt;= 0 &amp;&amp; i34 &lt; 104 &amp;&amp; j34 &lt; 104)
                            groundArray[k34][k33][l33] = groundArray[k34][i34][j34];
                        else
                            groundArray[k34][k33][l33] = null;

                }

            }

            for (Class30_Sub1 class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetFirst(); class30_sub1_1 != null; class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetNext()) {
                class30_sub1_1.anInt1297 -= i17;
                class30_sub1_1.anInt1298 -= j21;
                if (class30_sub1_1.anInt1297 &lt; 0 || class30_sub1_1.anInt1298 &lt; 0 || class30_sub1_1.anInt1297 &gt;= 104 || class30_sub1_1.anInt1298 &gt;= 104)
                    class30_sub1_1.unlink();
            }

            if (destX != 0) {
                destX -= i17;
                destY -= j21;
            }
            aBoolean1160 = false;
            pktType = -1;
            return true;
        }[/code]
</code></pre>
<p>replace it with this and im pretty sure it’ll work[/quote]From the first 200 or so lines I looked at, they seem identical…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/27">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/27</link>
        <pubDate>Sat, 17 May 2014 01:44:18 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-27</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@HcoJustin HcoJustin]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/hcojustin">@HcoJustin</a> wrote:</p>
          <blockquote>
              <p>If that is the problem then OP needs to not send the map region before sending the new packet, or make sure he sends a different region X/Y</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/26">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/26</link>
        <pubDate>Sat, 17 May 2014 00:56:10 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-26</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@asshole_rule asshole_rule]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/asshole_rule">@asshole_rule</a> wrote:</p>
          <blockquote>
              <p>[quote=“lare69, post:8, topic:542919”][quote author=asshole_rule link=topic=661796.msg4423993#msg4423993 date=1399835653]<br>
post your client code in parsePacket() i’m 99% sure it’s a quick fix<br>
[/quote]</p>
<p>[code=java]            if (pktType == 73 || pktType == 241) {</p>
<pre><code>            // mapReset();
            int l2 = anInt1069;
            int i11 = anInt1070;
            if (pktType == 73) {
                l2 = inStream.method435();
                i11 = inStream.readUnsignedWord();
                aBoolean1159 = false;
            }
            if (pktType == 241) {
                i11 = inStream.method435();
                inStream.initBitAccess();
                for (int j16 = 0; j16 &lt; 4; j16++) {
                    for (int l20 = 0; l20 &lt; 13; l20++) {
                        for (int j23 = 0; j23 &lt; 13; j23++) {
                            int i26 = inStream.readBits(1);
                            if (i26 == 1)
                                anIntArrayArrayArray1129[j16][l20][j23] = inStream.readBits(26);
                            else
                                anIntArrayArrayArray1129[j16][l20][j23] = -1;
                        }

                    }

                }
                inStream.finishBitAccess();
                l2 = inStream.readUnsignedWord();
                aBoolean1159 = true;
            }
            if (anInt1069 == l2 &amp;&amp; anInt1070 == i11 &amp;&amp; loadingStage == 2) {
                pktType = -1;
                return true;
            }
            anInt1069 = l2;
            anInt1070 = i11;
            baseX = (anInt1069 - 6) * 8;
            baseY = (anInt1070 - 6) * 8;
            aBoolean1141 = (anInt1069 / 8 == 48 || anInt1069 / 8 == 49) &amp;&amp; anInt1070 / 8 == 48;
            if (anInt1069 / 8 == 48 &amp;&amp; anInt1070 / 8 == 148)
                aBoolean1141 = true;
            loadingStage = 1;
            aLong824 = System.currentTimeMillis();
            aRSImageProducer_1165.initDrawingArea();
            aTextDrawingArea_1271.drawText(0, "Loading - please wait.", 151, 257);
            aTextDrawingArea_1271.drawText(0xffffff, "Loading - please wait.", 150, 256);
            aRSImageProducer_1165.drawGraphics(4, super.graphics, 4);
            if (pktType == 73) {
                int k16 = 0;
                for (int i21 = (anInt1069 - 6) / 8; i21 &lt;= (anInt1069 + 6) / 8; i21++) {
                    for (int k23 = (anInt1070 - 6) / 8; k23 &lt;= (anInt1070 + 6) / 8; k23++)
                        k16++;

                }

                aByteArrayArray1183 = new byte[k16][];
                aByteArrayArray1247 = new byte[k16][];
                anIntArray1234 = new int[k16];
                anIntArray1235 = new int[k16];
                anIntArray1236 = new int[k16];
                k16 = 0;
                for (int l23 = (anInt1069 - 6) / 8; l23 &lt;= (anInt1069 + 6) / 8; l23++) {
                    for (int j26 = (anInt1070 - 6) / 8; j26 &lt;= (anInt1070 + 6) / 8; j26++) {
                        anIntArray1234[k16] = (l23 &lt;&lt; 8) + j26;
                        if (aBoolean1141 &amp;&amp; (j26 == 49 || j26 == 149 || j26 == 147 || l23 == 50 || l23 == 49 &amp;&amp; j26 == 47)) {
                            anIntArray1235[k16] = -1;
                            anIntArray1236[k16] = -1;
                            k16++;
                        } else {
                            int k28 = anIntArray1235[k16] = onDemandFetcher.method562(0, j26, l23);
                            if (k28 != -1)
                                onDemandFetcher.method558(3, k28);
                            int j30 = anIntArray1236[k16] = onDemandFetcher.method562(1, j26, l23);
                            if (j30 != -1)
                                onDemandFetcher.method558(3, j30);
                            k16++;
                        }
                    }

                }

            }
            if (pktType == 241) {
                int l16 = 0;
                int ai[] = new int[676];
                for (int i24 = 0; i24 &lt; 4; i24++) {
                    for (int k26 = 0; k26 &lt; 13; k26++) {
                        for (int l28 = 0; l28 &lt; 13; l28++) {
                            int k30 = anIntArrayArrayArray1129[i24][k26][l28];
                            if (k30 != -1) {
                                int k31 = k30 &gt;&gt; 14 &amp; 0x3ff;
                                int i32 = k30 &gt;&gt; 3 &amp; 0x7ff;
                                int k32 = (k31 / 8 &lt;&lt; 8) + i32 / 8;
                                for (int j33 = 0; j33 &lt; l16; j33++) {
                                    if (ai[j33] != k32)
                                        continue;
                                    k32 = -1;
                                    break;
                                }

                                if (k32 != -1)
                                    ai[l16++] = k32;
                            }
                        }

                    }

                }

                aByteArrayArray1183 = new byte[l16][];
                aByteArrayArray1247 = new byte[l16][];
                anIntArray1234 = new int[l16];
                anIntArray1235 = new int[l16];
                anIntArray1236 = new int[l16];
                for (int l26 = 0; l26 &lt; l16; l26++) {
                    int i29 = anIntArray1234[l26] = ai[l26];
                    int l30 = i29 &gt;&gt; 8 &amp; 0xff;
                    int l31 = i29 &amp; 0xff;
                    int j32 = anIntArray1235[l26] = onDemandFetcher.method562(0, l31, l30);
                    if (j32 != -1)
                        onDemandFetcher.method558(3, j32);
                    int i33 = anIntArray1236[l26] = onDemandFetcher.method562(1, l31, l30);
                    if (i33 != -1)
                        onDemandFetcher.method558(3, i33);
                }

            }
            int i17 = baseX - anInt1036;
            int j21 = baseY - anInt1037;
            anInt1036 = baseX;
            anInt1037 = baseY;
            for (int j24 = 0; j24 &lt; 16384; j24++) {
                NPC npc = npcArray[j24];
                if (npc != null) {
                    for (int j29 = 0; j29 &lt; 10; j29++) {
                        npc.smallX[j29] -= i17;
                        npc.smallY[j29] -= j21;
                    }

                    npc.x -= i17 * 128;
                    npc.y -= j21 * 128;
                }
            }

            for (int i27 = 0; i27 &lt; maxPlayers; i27++) {
                Player player = playerArray[i27];
                if (player != null) {
                    for (int i31 = 0; i31 &lt; 10; i31++) {
                        player.smallX[i31] -= i17;
                        player.smallY[i31] -= j21;
                    }

                    player.x -= i17 * 128;
                    player.y -= j21 * 128;
                }
            }

            aBoolean1080 = true;
            byte byte1 = 0;
            byte byte2 = 104;
            byte byte3 = 1;
            if (i17 &lt; 0) {
                byte1 = 103;
                byte2 = -1;
                byte3 = -1;
            }
            byte byte4 = 0;
            byte byte5 = 104;
            byte byte6 = 1;
            if (j21 &lt; 0) {
                byte4 = 103;
                byte5 = -1;
                byte6 = -1;
            }
            for (int k33 = byte1; k33 != byte2; k33 += byte3) {
                for (int l33 = byte4; l33 != byte5; l33 += byte6) {
                    int i34 = k33 + i17;
                    int j34 = l33 + j21;
                    for (int k34 = 0; k34 &lt; 4; k34++)
                        if (i34 &gt;= 0 &amp;&amp; j34 &gt;= 0 &amp;&amp; i34 &lt; 104 &amp;&amp; j34 &lt; 104)
                            groundArray[k34][k33][l33] = groundArray[k34][i34][j34];
                        else
                            groundArray[k34][k33][l33] = null;

                }

            }

            for (Class30_Sub1 class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetFirst(); class30_sub1_1 != null; class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetNext()) {
                class30_sub1_1.anInt1297 -= i17;
                class30_sub1_1.anInt1298 -= j21;
                if (class30_sub1_1.anInt1297 &lt; 0 || class30_sub1_1.anInt1298 &lt; 0 || class30_sub1_1.anInt1297 &gt;= 104 || class30_sub1_1.anInt1298 &gt;= 104)
                    class30_sub1_1.unlink();
            }

            if (destX != 0) {
                destX -= i17;
                destY -= j21;
            }
            aBoolean1160 = false;
            pktType = -1;
            return true;
        }[/code][/quote]
</code></pre>
<p>[code=java]            if (pktType == 73 || pktType == 241) {</p>
<pre><code>            // mapReset();
            int l2 = anInt1069;
            int i11 = anInt1070;
            if (pktType == 73) {
                l2 = inStream.method435();
                i11 = inStream.readUnsignedWord();
                aBoolean1159 = false;
            }
            if (pktType == 241) {
                i11 = inStream.method435();
                inStream.initBitAccess();
                for (int j16 = 0; j16 &lt; 4; j16++) {
                    for (int l20 = 0; l20 &lt; 13; l20++) {
                        for (int j23 = 0; j23 &lt; 13; j23++) {
                            int i26 = inStream.readBits(1);
                            if (i26 == 1)
                                anIntArrayArrayArray1129[j16][l20][j23] = inStream.readBits(26);
                            else
                                anIntArrayArrayArray1129[j16][l20][j23] = -1;
                        }

                    }

                }
                inStream.finishBitAccess();
                l2 = inStream.readUnsignedWord();
                aBoolean1159 = true;
            }
            if (anInt1069 == l2 &amp;&amp; anInt1070 == i11 &amp;&amp; loadingStage == 2) {
                pktType = -1;
                //return true;
            }
            anInt1069 = l2;
            anInt1070 = i11;
            baseX = (anInt1069 - 6) * 8;
            baseY = (anInt1070 - 6) * 8;
            aBoolean1141 = (anInt1069 / 8 == 48 || anInt1069 / 8 == 49) &amp;&amp; anInt1070 / 8 == 48;
            if (anInt1069 / 8 == 48 &amp;&amp; anInt1070 / 8 == 148)
                aBoolean1141 = true;
            loadingStage = 1;
            aLong824 = System.currentTimeMillis();
            aRSImageProducer_1165.initDrawingArea();
            aTextDrawingArea_1271.drawText(0, "Loading - please wait.", 151, 257);
            aTextDrawingArea_1271.drawText(0xffffff, "Loading - please wait.", 150, 256);
            aRSImageProducer_1165.drawGraphics(4, super.graphics, 4);
            if (pktType == 73) {
                int k16 = 0;
                for (int i21 = (anInt1069 - 6) / 8; i21 &lt;= (anInt1069 + 6) / 8; i21++) {
                    for (int k23 = (anInt1070 - 6) / 8; k23 &lt;= (anInt1070 + 6) / 8; k23++)
                        k16++;

                }

                aByteArrayArray1183 = new byte[k16][];
                aByteArrayArray1247 = new byte[k16][];
                anIntArray1234 = new int[k16];
                anIntArray1235 = new int[k16];
                anIntArray1236 = new int[k16];
                k16 = 0;
                for (int l23 = (anInt1069 - 6) / 8; l23 &lt;= (anInt1069 + 6) / 8; l23++) {
                    for (int j26 = (anInt1070 - 6) / 8; j26 &lt;= (anInt1070 + 6) / 8; j26++) {
                        anIntArray1234[k16] = (l23 &lt;&lt; 8) + j26;
                        if (aBoolean1141 &amp;&amp; (j26 == 49 || j26 == 149 || j26 == 147 || l23 == 50 || l23 == 49 &amp;&amp; j26 == 47)) {
                            anIntArray1235[k16] = -1;
                            anIntArray1236[k16] = -1;
                            k16++;
                        } else {
                            int k28 = anIntArray1235[k16] = onDemandFetcher.method562(0, j26, l23);
                            if (k28 != -1)
                                onDemandFetcher.method558(3, k28);
                            int j30 = anIntArray1236[k16] = onDemandFetcher.method562(1, j26, l23);
                            if (j30 != -1)
                                onDemandFetcher.method558(3, j30);
                            k16++;
                        }
                    }

                }

            }
            if (pktType == 241) {
                int l16 = 0;
                int ai[] = new int[676];
                for (int i24 = 0; i24 &lt; 4; i24++) {
                    for (int k26 = 0; k26 &lt; 13; k26++) {
                        for (int l28 = 0; l28 &lt; 13; l28++) {
                            int k30 = anIntArrayArrayArray1129[i24][k26][l28];
                            if (k30 != -1) {
                                int k31 = k30 &gt;&gt; 14 &amp; 0x3ff;
                                int i32 = k30 &gt;&gt; 3 &amp; 0x7ff;
                                int k32 = (k31 / 8 &lt;&lt; 8) + i32 / 8;
                                for (int j33 = 0; j33 &lt; l16; j33++) {
                                    if (ai[j33] != k32)
                                        continue;
                                    k32 = -1;
                                    break;
                                }

                                if (k32 != -1)
                                    ai[l16++] = k32;
                            }
                        }

                    }

                }

                aByteArrayArray1183 = new byte[l16][];
                aByteArrayArray1247 = new byte[l16][];
                anIntArray1234 = new int[l16];
                anIntArray1235 = new int[l16];
                anIntArray1236 = new int[l16];
                for (int l26 = 0; l26 &lt; l16; l26++) {
                    int i29 = anIntArray1234[l26] = ai[l26];
                    int l30 = i29 &gt;&gt; 8 &amp; 0xff;
                    int l31 = i29 &amp; 0xff;
                    int j32 = anIntArray1235[l26] = onDemandFetcher.method562(0, l31, l30);
                    if (j32 != -1)
                        onDemandFetcher.method558(3, j32);
                    int i33 = anIntArray1236[l26] = onDemandFetcher.method562(1, l31, l30);
                    if (i33 != -1)
                        onDemandFetcher.method558(3, i33);
                }

            }
            int i17 = baseX - anInt1036;
            int j21 = baseY - anInt1037;
            anInt1036 = baseX;
            anInt1037 = baseY;
            for (int j24 = 0; j24 &lt; 16384; j24++) {
                NPC npc = npcArray[j24];
                if (npc != null) {
                    for (int j29 = 0; j29 &lt; 10; j29++) {
                        npc.smallX[j29] -= i17;
                        npc.smallY[j29] -= j21;
                    }

                    npc.x -= i17 * 128;
                    npc.y -= j21 * 128;
                }
            }

            for (int i27 = 0; i27 &lt; maxPlayers; i27++) {
                Player player = playerArray[i27];
                if (player != null) {
                    for (int i31 = 0; i31 &lt; 10; i31++) {
                        player.smallX[i31] -= i17;
                        player.smallY[i31] -= j21;
                    }

                    player.x -= i17 * 128;
                    player.y -= j21 * 128;
                }
            }

            aBoolean1080 = true;
            byte byte1 = 0;
            byte byte2 = 104;
            byte byte3 = 1;
            if (i17 &lt; 0) {
                byte1 = 103;
                byte2 = -1;
                byte3 = -1;
            }
            byte byte4 = 0;
            byte byte5 = 104;
            byte byte6 = 1;
            if (j21 &lt; 0) {
                byte4 = 103;
                byte5 = -1;
                byte6 = -1;
            }
            for (int k33 = byte1; k33 != byte2; k33 += byte3) {
                for (int l33 = byte4; l33 != byte5; l33 += byte6) {
                    int i34 = k33 + i17;
                    int j34 = l33 + j21;
                    for (int k34 = 0; k34 &lt; 4; k34++)
                        if (i34 &gt;= 0 &amp;&amp; j34 &gt;= 0 &amp;&amp; i34 &lt; 104 &amp;&amp; j34 &lt; 104)
                            groundArray[k34][k33][l33] = groundArray[k34][i34][j34];
                        else
                            groundArray[k34][k33][l33] = null;

                }

            }

            for (Class30_Sub1 class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetFirst(); class30_sub1_1 != null; class30_sub1_1 = (Class30_Sub1) aClass19_1179.reverseGetNext()) {
                class30_sub1_1.anInt1297 -= i17;
                class30_sub1_1.anInt1298 -= j21;
                if (class30_sub1_1.anInt1297 &lt; 0 || class30_sub1_1.anInt1298 &lt; 0 || class30_sub1_1.anInt1297 &gt;= 104 || class30_sub1_1.anInt1298 &gt;= 104)
                    class30_sub1_1.unlink();
            }

            if (destX != 0) {
                destX -= i17;
                destY -= j21;
            }
            aBoolean1160 = false;
            pktType = -1;
            return true;
        }[/code]
</code></pre>
<p>replace it with this and im pretty sure it’ll work</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/25">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/25</link>
        <pubDate>Sat, 17 May 2014 00:51:00 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-25</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@HcoJustin HcoJustin]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/hcojustin">@HcoJustin</a> wrote:</p>
          <blockquote>
              <p>[quote=“lare69, post:23, topic:542919”][quote author=HcoJustin link=topic=661796.msg4424466#msg4424466 date=1400129138]<br>
Are your buffers auto expanding? A buffer of 100 bytes is definitely not enough for sending that many tiles.<br>
[/quote]<br>
no, the buffer sizes are fixed. and that’s really odd because it would throw a bufferoverflowexception if the buffer became full?[/quote]<br>
No idea how they are in runesource, or what may have been changed besides the name.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/24">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/24</link>
        <pubDate>Thu, 15 May 2014 16:35:16 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-24</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@Clawz_fury lare69]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/clawz_fury">@Clawz_fury</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="22" data-topic="542919">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/hcojustin/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> HcoJustin:</div>
<blockquote>
<p>Are your buffers auto expanding? A buffer of 100 bytes is definitely not enough for sending that many tiles.</p>
</blockquote>
</aside>
<p>no, the buffer sizes are fixed. and that’s really odd because it would throw a bufferoverflowexception if the buffer became full?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/23">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/23</link>
        <pubDate>Thu, 15 May 2014 07:17:31 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-23</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@HcoJustin HcoJustin]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/hcojustin">@HcoJustin</a> wrote:</p>
          <blockquote>
              <p>Are your buffers auto expanding? A buffer of 100 bytes is definitely not enough for sending that many tiles.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/22">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/22</link>
        <pubDate>Thu, 15 May 2014 04:45:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-22</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@Clawz_fury lare69]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/clawz_fury">@Clawz_fury</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="20" data-topic="542919">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/dan0194/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> Dan0194:</div>
<blockquote>
<p>seriously that doesn’t work do you get any errors from client or server? I don’t understand how it would be a server sided issue unless your sending the frame with not the correct packet size?</p>
</blockquote>
</aside>
<p>nope, no errors at all. im almost positive its the way player updating is done in runesource. if i test this on PI and it works then it has to be, there’s nothing else that could be causing this <img src="https://forum.moparisthebest.com/images/emoji/twitter/confused.png?v=5" title=":confused:" class="emoji" alt=":confused:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/21">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/21</link>
        <pubDate>Thu, 15 May 2014 03:12:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-21</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@Dan0194 Dan0194]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/dan0194">@Dan0194</a> wrote:</p>
          <blockquote>
              <p>seriously that doesn’t work do you get any errors from client or server? I don’t understand how it would be a server sided issue unless your sending the frame with not the correct packet size?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/20">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/20</link>
        <pubDate>Wed, 14 May 2014 20:41:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-20</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@Clawz_fury lare69]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/clawz_fury">@Clawz_fury</a> wrote:</p>
          <blockquote>
              <p>[quote=“Dan0194, post:18, topic:542919”]           <code> Palette p = new Palette();
                for (int x = 0; x &lt; 13; x++) {
                    for (int y = 0; y &lt; 13; y++) {
                        p.setTile(x, y, 0, new PaletteTile(2971, 3401, 0));
                    }
                }
            player.getActionSender().sendCustomMapRegion(p);</code></p>
<p>That worked for me.[/quote]<br>
doesn’t work, I’m convinced that it’s something in Runesource. I’m going to try the exact same code on on project insanity and see if it works.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/19">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/19</link>
        <pubDate>Wed, 14 May 2014 17:32:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-19</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@Dan0194 Dan0194]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/dan0194">@Dan0194</a> wrote:</p>
          <blockquote>
              <pre><code>       [code=java5] Palette p = new Palette();
            for (int x = 0; x &lt; 13; x++) {
                for (int y = 0; y &lt; 13; y++) {
                    p.setTile(x, y, 0, new PaletteTile(2971, 3401, 0));
                }
            }
        player.getActionSender().sendCustomMapRegion(p);[/code]
</code></pre>
<p>That worked for me.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/18">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/18</link>
        <pubDate>Tue, 13 May 2014 19:52:59 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-18</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
      <item>
        <title>Construct map region packet</title>
        <dc:creator><![CDATA[@Clawz_fury lare69]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/clawz_fury">@Clawz_fury</a> wrote:</p>
          <blockquote>
              <p>[quote=“Dan0194, post:16, topic:542919”][quote author=lare69 link=topic=661796.msg4424219#msg4424219 date=1399954418]</p>
<aside class="quote">
<blockquote>
<p>Try what I posted above it works for me.</p>
</blockquote>
</aside>
<p>my packet is exactly the same, its not that</p>
<p>what server did you test it on? because I remember being able to get this to work with the exact same code on a winterlove based server a long time ago</p>
<p>maybe its the server im using, im going to test it on a winterlove and see if it works<br>
[/quote]<br>
I’m using hyperion have you tried different coordinates for your tile you want to re-create because the one you are using for me doesn’t work either(well it does but it’s all black and it’s at the side and I can’t get too it).[/quote]<br>
can you send me what you used that worked?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/construct-map-region-packet/542919/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/construct-map-region-packet/542919/17</link>
        <pubDate>Tue, 13 May 2014 12:33:09 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-542919-17</guid>
        <source url="https://forum.moparisthebest.com/t/construct-map-region-packet/542919.rss">Construct map region packet</source>
      </item>
  </channel>
</rss>
