<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Better Alternatives to Storing Passwords</title>
    <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452</link>
    <description>Let&#39;s face it, SHA-2 is very widely used and still recommended by web developers to this day. However, better alternatives exist to this, and they are (in no particular order): [i]bcrypt[/i], [i]scrypt[/i], and [i]PBKDF2[/i]. Anyone of these, are now being more widely adopted and recommended by experts for several reasons. I advise you to do your own research, and to gain a little bit of background knowledge on these methods so you know what differs between these three. You can find some useful links at the bottom of this article.

From what I interpreted from these articles, I realized [i]scrypt[/i] is the superior choice of the three. However, I will be covering bcrypt (the second best in the list) simply because there is [b]no scrypt support built-in for PHP[/b]. [url=https://github.com/DomBlack/php-scrypt](As a matter of fact, all I could find was a PHP extension that was just recently started.)[/url]

* Please note I am not a cryptographer but out of pure research feel I have the ability to confidently post this information.

[b][size=12pt]What Makes it so Effective?[/size][/b]
[hr]
What makes bcrypt an effective choice? Here are some points:

[ul][li][b]It&#39;s slow[/b] - Ironic at first, but consider why this would be an obstacle for people who want to find the plaintext password. The longer it takes to derive a password-key, it will take the same time for an attacker to find a plaintext match by bruteforcing. SHA-2 can produce hashes [i]very[/i] quickly.[/li]
[li][b]Bcrypt keeps up with Moore&#39;s Law[/b] - A bit like the first point, however, the more powerful hardware becomes, the faster it takes to compute SHA hashes. Bcrypt allows configured iterations (the [i]two digit cost parameter[/i]).[/li]
[li][b]The salt is required to be long[/b] - 22 characters in length is the number of characters that are required to use in PHP&#39;s bcrypt implementation. Salts have an advantage on their own.[/li][/ul]


[b][size=12pt]Using Bcrypt in Your PHP Code[/size][/b]
[hr]
Now to get to actual code! PHP provides bcrypt support built-in through the [url=http://php.net/crypt]crypt()[/url] function. PHP 5.3.0+ users can only take advantage of the built-in support for bcrypt. However, I would recommend users have PHP versions 5.3.7 or above for optimal security. This is explained in the page regarding &quot;potential high-bit attacks.&quot;

For users using PHP &gt;= 5.5.0, check out the new [url=http://php.net/password-hash]password hashing API[/url].

Otherwise, I found a class on NetTuts with a simple class utilizing bcrypt however I noticed it can be tweaked a bit to compensate for the above explanation.
[code=php]class Bcrypt {

	// Default Blowfish algorithm
	private static $algorithm = &#39;$2y$&#39;;
	// Cost parameter
	private static $cost = &#39;10&#39;;
        
        // Checks if Bcrypt is available and enabled - Recommended to check before usage
        public static function isAvailable() {
            return defined(&#39;CRYPT_BLOWFISH&#39;) &amp;&amp; CRYPT_BLOWFISH;
        }

	// Mainly for internal use
	public static function uniqueSalt() {
            if (function_exists(&#39;openssl_random_pseudo_bytes&#39;))
                return substr(strtr(base64_encode(openssl_random_pseudo_bytes(22)), &#39;+&#39;, &#39;.&#39;), 0, 22);
	    else
                return substr(strtr(base64_encode(mt_rand()), &#39;+&#39;, &#39;.&#39;), 0, 22);
	}

	// Generate the hash
	public static function hash($password) {
            // Change from current Bcrypt algorithm depending on PHP version
            if (version_compare(PHP_VERSION, &#39;5.3.7&#39;, &#39;&lt;&#39;))
                self::$algorithm = &#39;$2a$&#39;;

	    return crypt($password, self::$algorithm . self::$cost . &#39;$&#39; . self::uniqueSalt());
	}

	// Compare password against a hash
	public static function checkPassword($hash, $password) {
	    $new_hash = crypt($password, $hash);
	    return ($hash == $new_hash);
	}
}[/code]

Example usage,
[code=php]// Replace anthony123 with form input, etc...
if (Bcrypt::checkPassword($hashFromDatabase, &#39;anthony123&#39;))
    echo &#39;Log in user...&#39;;
else
    echo &#39;Log in failed!&#39;;[/code]

[b][size=12pt]Useful Links[/size][/b]
[hr]
http://security.stackexchange.com/questions/4781/do-any-security-experts-recommend-bcrypt-for-password-storage
http://stackoverflow.com/questions/1561174/sha512-vs-blowfish-and-bcrypt
http://www.tarsnap.com/scrypt/scrypt-slides.pdf (Especially slides 18-20)

That&#39;s all there is to it! 
Thanks for reading.</description>
    
    <lastBuildDate>Tue, 26 Nov 2013 23:50:52 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@Ruby_Forums_Coder Ruby]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ruby_forums_coder">@Ruby_Forums_Coder</a> wrote:</p>
          <blockquote>
              <p>[quote=“RSCShadow, post:15, topic:459452”]This shouldn’t be necessary anymore if one’s using the latest PHP.</p>
<p><a href="http://php.net/manual/en/function.password-hash.php%5B/quote%5D" class="onebox" target="_blank" rel="nofollow noopener">http://php.net/manual/en/function.password-hash.php[/quote]</a></p>
<p>Glad they’ve added this, life is easier.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/17">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/17</link>
        <pubDate>Tue, 26 Nov 2013 23:50:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-17</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@justaguy justaguy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/justaguy">@justaguy</a> wrote:</p>
          <blockquote>
              <p>[quote=“RSCShadow, post:15, topic:459452”]This shouldn’t be necessary anymore if one’s using the latest PHP.</p>
<p><a href="http://php.net/manual/en/function.password-hash.php%5B/quote%5D" class="onebox" target="_blank" rel="nofollow noopener">http://php.net/manual/en/function.password-hash.php[/quote]</a></p>
<p>Yay, the RFC made it in. Time to edit.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/16">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/16</link>
        <pubDate>Tue, 26 Nov 2013 23:47:16 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-16</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@RSCShadow RSCShadow]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rscshadow">@RSCShadow</a> wrote:</p>
          <blockquote>
              <p>This shouldn’t be necessary anymore if one’s using the latest PHP.</p>
<p><a href="http://php.net/manual/en/function.password-hash.php" class="onebox" target="_blank" rel="nofollow noopener">http://php.net/manual/en/function.password-hash.php</a></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/15">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/15</link>
        <pubDate>Tue, 26 Nov 2013 23:11:20 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-15</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@justaguy justaguy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/justaguy">@justaguy</a> wrote:</p>
          <blockquote>
              <p>Updated the OP to account for a better uniqueSalt() method. Not to say it wasn’t secure before, but this new version produces a <span class="bbcode-i">better</span> salt than previous.</p>
<p>The biggest change is using <a href="http://php.net/openssl-random-pseudo-bytes" data-bbcode="true" rel="nofollow noopener">openssl_random_pseudo_bytes()</a> (for PHP versions that have it) for producing cryptographically-strong randomization. <a href="http://blog.ircmaxell.com/2012/12/seven-ways-to-screw-up-bcrypt.html" data-bbcode="true" rel="nofollow noopener">This blog article</a> outlines some good points on using BCrypt.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/14">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/14</link>
        <pubDate>Mon, 25 Nov 2013 03:36:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-14</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@imthenull imthenull]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/imthenull">@imthenull</a> wrote:</p>
          <blockquote>
              <p>[quote=“Arcik, post:1, topic:519820”]I’m a noob in website development and didn’t understand 99% of what you’re talking about. [/quote]it’s not just website development, but more cryptography.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/13">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/13</link>
        <pubDate>Wed, 22 May 2013 17:48:14 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-13</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@justaguy justaguy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/justaguy">@justaguy</a> wrote:</p>
          <blockquote>
              <p>[quote=“KempiScape, post:11, topic:459452”][quote author=justaguy link=topic=562366.msg4302228#msg4302228 date=1369178901]</p>
<aside class="quote">
<blockquote>
<p>since the salt is random, how does it know the right salt? what is going on?</p>
<p>can you explain? i want to learn these things</p>
<p>it’s probably a really simple answer, i might just be retarded. either way, it would be cool if you explained</p>
<p>ty</p>
<p>or does the log in part not know it at all?</p>
</blockquote>
</aside>
<p>It doesn’t need to know if the salt is the same one used before. All it needs is the hash computed the first time to make a comparison on any subsequent password checks you want to make. Remember, you aren’t comparing passwords but hashes.</p>
<p>Check out <a href="http://ca1.php.net/manual/en/function.crypt.php#108704" data-bbcode="true" rel="nofollow noopener">this comment</a> about knowing the salt that was used. If you look at the example provided by <a href="http://php.net" rel="nofollow noopener">php.net</a>, you can see that a portion of the salt is included in the output string. <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=5" title=":wink:" class="emoji" alt=":wink:"><br>
[/quote]<br>
thanks, this does make sense<br>
i’m beginning to understand more of the advanced php :)[/quote]</p>
<p>Thanks for reading.  <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/12</link>
        <pubDate>Wed, 22 May 2013 01:29:17 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-12</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@KempiScape KempiScape]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/kempiscape">@KempiScape</a> wrote:</p>
          <blockquote>
              <p>[quote=“justaguy, post:10, topic:459452”][quote author=KempiScape link=topic=562366.msg4302211#msg4302211 date=1369176910]<br>
since the salt is random, how does it know the right salt? what is going on?</p>
<p>can you explain? i want to learn these things</p>
<p>it’s probably a really simple answer, i might just be retarded. either way, it would be cool if you explained</p>
<p>ty</p>
<p>or does the log in part not know it at all?<br>
[/quote]</p>
<p>It doesn’t need to know if the salt is the same one used before. All it needs is the hash computed the first time to make a comparison on any subsequent password checks you want to make. Remember, you aren’t comparing passwords but hashes.</p>
<p>Check out <a href="http://ca1.php.net/manual/en/function.crypt.php#108704" data-bbcode="true" rel="nofollow noopener">this comment</a> about knowing the salt that was used. If you look at the example provided by <a href="http://php.net" rel="nofollow noopener">php.net</a>, you can see that a portion of the salt is included in the output string. ;)[/quote]<br>
thanks, this does make sense<br>
i’m beginning to understand more of the advanced php <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/11</link>
        <pubDate>Wed, 22 May 2013 00:36:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-11</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@justaguy justaguy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/justaguy">@justaguy</a> wrote:</p>
          <blockquote>
              <p>[quote=“KempiScape, post:9, topic:459452”]since the salt is random, how does it know the right salt? what is going on?</p>
<p>can you explain? i want to learn these things</p>
<p>it’s probably a really simple answer, i might just be retarded. either way, it would be cool if you explained</p>
<p>ty</p>
<p>or does the log in part not know it at all?[/quote]</p>
<p>It doesn’t need to know if the salt is the same one used before. All it needs is the hash computed the first time to make a comparison on any subsequent password checks you want to make. Remember, you aren’t comparing passwords but hashes.</p>
<p>Check out <a href="http://ca1.php.net/manual/en/function.crypt.php#108704" data-bbcode="true" rel="nofollow noopener">this comment</a> about knowing the salt that was used. If you look at the example provided by <a href="http://php.net" rel="nofollow noopener">php.net</a>, you can see that a portion of the salt is included in the output string. <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=5" title=":wink:" class="emoji" alt=":wink:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/10</link>
        <pubDate>Tue, 21 May 2013 23:28:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-10</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@KempiScape KempiScape]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/kempiscape">@KempiScape</a> wrote:</p>
          <blockquote>
              <p>since the salt is random, how does it know the right salt? what is going on?</p>
<p>can you explain? i want to learn these things</p>
<p>it’s probably a really simple answer, i might just be retarded. either way, it would be cool if you explained</p>
<p>ty</p>
<p>or does the log in part not know it at all?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/9</link>
        <pubDate>Tue, 21 May 2013 22:55:10 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-9</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@RSCShadow RSCShadow]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rscshadow">@RSCShadow</a> wrote:</p>
          <blockquote>
              <p>Still relevant today. People should definitely be using this (bcrypt, not PHP of course).</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/8</link>
        <pubDate>Tue, 21 May 2013 00:45:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-8</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@Vain1 Vain_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/vain1">@Vain1</a> wrote:</p>
          <blockquote>
              <p>You’re welcome. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/7</link>
        <pubDate>Wed, 21 Nov 2012 00:13:35 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-7</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@justaguy justaguy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/justaguy">@justaguy</a> wrote:</p>
          <blockquote>
              <p>[quote=“Vain_, post:5, topic:459452”]You state that PBKDF2 is a better alternative, when it technically isn’t.<br>
PBKDF2 can be accelerated with GPUs while bcrypt cannot be.</p>
<p>Also, bcrypt is not an encryption, it is a key derivation function.</p>
<p>Though you could argue that both PBKDF2 and bcrypt are better than the other, it depends on the point you’re trying to make.<br>
However, if you wish to follow NIST’s recommendations, go with PBKDF2.</p>
<p>Anyway, good read.[/quote]</p>
<ol>
<li>
<p>Out of the list I think I placed PBKDF2 the least with bcrypt and scrypt being superior (respectively).</p>
</li>
<li>
<p>Right, good catch. Will edit that.</p>
</li>
<li>
<p>I don’t remember alot of information anymore on PBKDF2 when I was first writing this, so I won’t comment here. <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
</li>
</ol>
<p>Thanks for reading!</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/6</link>
        <pubDate>Wed, 21 Nov 2012 00:00:13 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-6</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@Vain1 Vain_]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/vain1">@Vain1</a> wrote:</p>
          <blockquote>
              <p>You state that PBKDF2 is a better alternative, when it technically isn’t.<br>
PBKDF2 can be accelerated with GPUs while bcrypt cannot be.</p>
<p>Also, bcrypt is not an encryption, it is a key derivation function.</p>
<p>Though you could argue that both PBKDF2 and bcrypt are better than the other, it depends on the point you’re trying to make.<br>
However, if you wish to follow NIST’s recommendations, go with PBKDF2.</p>
<p>Anyway, good read.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/5</link>
        <pubDate>Tue, 20 Nov 2012 23:48:27 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-5</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@justaguy justaguy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/justaguy">@justaguy</a> wrote:</p>
          <blockquote>
              <p>Fixed a bit of code (nothing serious) and renamed the class to a more appropriate name. I also figured this would be good to bump so people stop using outdated methods of storing passwords.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/4</link>
        <pubDate>Tue, 20 Nov 2012 23:22:04 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-4</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@skiller8860 skiller8860]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/skiller8860">@skiller8860</a> wrote:</p>
          <blockquote>
              <p>This is good :P… It makes me want to masturbate to this sexy line of coding until my small dick falls off.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/3</link>
        <pubDate>Sun, 30 Sep 2012 15:48:53 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-3</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@Ruby_Forums_Coder Ruby]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/ruby_forums_coder">@Ruby_Forums_Coder</a> wrote:</p>
          <blockquote>
              <p>Brilliant tutorial, I’ve read bits and pieces on bcrypt but never actually got round to reading up on it.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/2</link>
        <pubDate>Wed, 12 Sep 2012 06:06:16 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-2</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
      <item>
        <title>Better Alternatives to Storing Passwords</title>
        <dc:creator><![CDATA[@justaguy justaguy]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/justaguy">@justaguy</a> wrote:</p>
          <blockquote>
              <p>Let’s face it, SHA-2 is very widely used and still recommended by web developers to this day. However, better alternatives exist to this, and they are (in no particular order): <span class="bbcode-i">bcrypt</span>, <span class="bbcode-i">scrypt</span>, and <span class="bbcode-i">PBKDF2</span>. Anyone of these, are now being more widely adopted and recommended by experts for several reasons. I advise you to do your own research, and to gain a little bit of background knowledge on these methods so you know what differs between these three. You can find some useful links at the bottom of this article.</p>
<p>From what I interpreted from these articles, I realized <span class="bbcode-i">scrypt</span> is the superior choice of the three. However, I will be covering bcrypt (the second best in the list) simply because there is <span class="bbcode-b">no scrypt support built-in for PHP</span>. <a href="https://github.com/DomBlack/php-scrypt" data-bbcode="true" rel="nofollow noopener">(As a matter of fact, all I could find was a PHP extension that was just recently started.)</a></p>
<ul>
<li>Please note I am not a cryptographer but out of pure research feel I have the ability to confidently post this information.</li>
</ul>
<p><span class="bbcode-b">[size=12pt]What Makes it so Effective?[/size]</span><br>
[hr]<br>
What makes bcrypt an effective choice? Here are some points:</p>
<p>[ul][li]<span class="bbcode-b">It’s slow</span> - Ironic at first, but consider why this would be an obstacle for people who want to find the plaintext password. The longer it takes to derive a password-key, it will take the same time for an attacker to find a plaintext match by bruteforcing. SHA-2 can produce hashes <span class="bbcode-i">very</span> quickly.[/li]<br>
[li]<span class="bbcode-b">Bcrypt keeps up with Moore’s Law</span> - A bit like the first point, however, the more powerful hardware becomes, the faster it takes to compute SHA hashes. Bcrypt allows configured iterations (the <span class="bbcode-i">two digit cost parameter</span>).[/li]<br>
[li]<span class="bbcode-b">The salt is required to be long</span> - 22 characters in length is the number of characters that are required to use in PHP’s bcrypt implementation. Salts have an advantage on their own.[/li][/ul]</p>
<p><span class="bbcode-b">[size=12pt]Using Bcrypt in Your PHP Code[/size]</span><br>
[hr]<br>
Now to get to actual code! PHP provides bcrypt support built-in through the <a href="http://php.net/crypt" data-bbcode="true" rel="nofollow noopener">crypt()</a> function. PHP 5.3.0+ users can only take advantage of the built-in support for bcrypt. However, I would recommend users have PHP versions 5.3.7 or above for optimal security. This is explained in the page regarding “potential high-bit attacks.”</p>
<p>For users using PHP &gt;= 5.5.0, check out the new <a href="http://php.net/password-hash" data-bbcode="true" rel="nofollow noopener">password hashing API</a>.</p>
<p>Otherwise, I found a class on NetTuts with a simple class utilizing bcrypt however I noticed it can be tweaked a bit to compensate for the above explanation.</p>
<p>[code=php]class Bcrypt {</p>
<pre><code>// Default Blowfish algorithm
private static $algorithm = '$2y$';
// Cost parameter
private static $cost = '10';
    
    // Checks if Bcrypt is available and enabled - Recommended to check before usage
    public static function isAvailable() {
        return defined('CRYPT_BLOWFISH') &amp;&amp; CRYPT_BLOWFISH;
    }

// Mainly for internal use
public static function uniqueSalt() {
        if (function_exists('openssl_random_pseudo_bytes'))
            return substr(strtr(base64_encode(openssl_random_pseudo_bytes(22)), '+', '.'), 0, 22);
    else
            return substr(strtr(base64_encode(mt_rand()), '+', '.'), 0, 22);
}

// Generate the hash
public static function hash($password) {
        // Change from current Bcrypt algorithm depending on PHP version
        if (version_compare(PHP_VERSION, '5.3.7', '&lt;'))
            self::$algorithm = '$2a$';

    return crypt($password, self::$algorithm . self::$cost . '$' . self::uniqueSalt());
}

// Compare password against a hash
public static function checkPassword($hash, $password) {
    $new_hash = crypt($password, $hash);
    return ($hash == $new_hash);
}
</code></pre>
<p>}[/code]</p>
<p>Example usage,</p>
<p><code>// Replace anthony123 with form input, etc...
if (Bcrypt::checkPassword($hashFromDatabase, 'anthony123'))
    echo 'Log in user...';
else
    echo 'Log in failed!';</code></p>
<p><span class="bbcode-b">[size=12pt]Useful Links[/size]</span><br>
[hr]<br>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="https://security.stackexchange.com/questions/4781/do-any-security-experts-recommend-bcrypt-for-password-storage" target="_blank" rel="nofollow noopener">security.stackexchange.com</a>
  </header>
  <article class="onebox-body">
      <a href="https://security.stackexchange.com/users/3118/sam-saffron" target="_blank" rel="nofollow noopener">
    <img alt="Sam Saffron" src="https://www.gravatar.com/avatar/3dcae8378d46c244172a115c28ca49ce?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="https://security.stackexchange.com/questions/4781/do-any-security-experts-recommend-bcrypt-for-password-storage" target="_blank" rel="nofollow noopener">Do any security experts recommend bcrypt for password storage?</a>
</h4>

<div class="tags">
  <strong>passwords, cryptography, hash, bcrypt</strong>
</div>

<div class="date">
  asked by
  
  <a href="https://security.stackexchange.com/users/3118/sam-saffron" target="_blank" rel="nofollow noopener">
    Sam Saffron
  </a>
  on <a href="https://security.stackexchange.com/questions/4781/do-any-security-experts-recommend-bcrypt-for-password-storage" target="_blank" rel="nofollow noopener">12:05AM - 16 Sep 10</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<br>
<aside class="onebox stackexchange">
  <header class="source">
      <a href="https://stackoverflow.com/questions/1561174/sha512-vs-blowfish-and-bcrypt" target="_blank" rel="nofollow noopener">stackoverflow.com</a>
  </header>
  <article class="onebox-body">
      <a href="https://stackoverflow.com/users/184362/chris" target="_blank" rel="nofollow noopener">
    <img alt="Chris" src="https://www.gravatar.com/avatar/c852412da31623c2b92f47467b57dbfb?s=128&amp;d=identicon&amp;r=PG" class="thumbnail onebox-avatar" width="128" height="128">
  </a>
<h4>
  <a href="https://stackoverflow.com/questions/1561174/sha512-vs-blowfish-and-bcrypt" target="_blank" rel="nofollow noopener">SHA512 vs. Blowfish and Bcrypt</a>
</h4>

<div class="tags">
  <strong>security, encryption, passwords, hash</strong>
</div>

<div class="date">
  asked by
  
  <a href="https://stackoverflow.com/users/184362/chris" target="_blank" rel="nofollow noopener">
    Chris
  </a>
  on <a href="https://stackoverflow.com/questions/1561174/sha512-vs-blowfish-and-bcrypt" target="_blank" rel="nofollow noopener">03:56PM - 13 Oct 09</a>
</div>

  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>
<br>
<a href="http://www.tarsnap.com/scrypt/scrypt-slides.pdf" rel="nofollow noopener">http://www.tarsnap.com/scrypt/scrypt-slides.pdf</a> (Especially slides 18-20)</p>
<p>That’s all there is to it!<br>
Thanks for reading.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452/1</link>
        <pubDate>Tue, 11 Sep 2012 23:00:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-459452-1</guid>
        <source url="https://forum.moparisthebest.com/t/better-alternatives-to-storing-passwords/459452.rss">Better Alternatives to Storing Passwords</source>
      </item>
  </channel>
</rss>
