<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>MoparClassic database info</title>
    <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416</link>
    <description>I&#39;m wondering which column(user, username, or ownerusername) is used for the actual login in the client. Also, what form of hashing is used for the password(md5, sha1, sha256, sha512?) and there is no salt for the hash?

edit: okay it seems that you need to have &quot;user&quot; be the actual username, and ownerusername is obviously the owner of the username. but what is the field &quot;username&quot; used for? And I still can&#39;t find the code where the password is hashed. Im looking in MySQL.Java atm

edit2: upon further investigation it seems that only the username is hashed? but its hashed in a way that it can be dehashed. So I dont get how that is supposed to be secure whatsoever if the only thing that is hashed is able to be dehashed. and this wouldnt work anyways because if someone got a hold of the table data and the site had a highscore the could just compare stats and guess the username and then use the unhashed password. maybe im just overlooking the method that hashes the password</description>
    
    <lastBuildDate>Sat, 06 Apr 2013 07:56:18 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@tigerclan tigerclan]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/tigerclan">@tigerclan</a> wrote:</p>
          <blockquote>
              <p>[quote=“RSCShadow, post:11, topic:514416”]That PHP is terrible.</p>
<p>[code=php]<br>
function encode($char) {<br>
$char = strtolower($char);<br>
$hash = 0;<br>
for ( $i = 0; $i &lt; strlen($char); $i++ ) {<br>
$c = ord($char[$i]);<br>
$hash = bcmul($hash, 37);<br>
if ( $c &gt;= 97 &amp;&amp; $c &lt;= 122 )<br>
$hash = bcadd($hash, (1 + $c) - 97);<br>
else if ( $c &gt;= 48 &amp;&amp; $c &lt;= 57 )<br>
$hash = bcadd($hash, (27 + $c) - 48);<br>
}</p>
<pre><code>		$split_decimal = @explode('.', $hash);
		return is_array($split_decimal) ? $split_decimal[0] : $hash;
	}
</code></pre>
<p>[/code][/quote]</p>
<p>lol, i know. I barely know php. Just enough to make a login script basically, and not one that requires a weird string to long hashing system. thanks for the script btw</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/12">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/12</link>
        <pubDate>Sat, 06 Apr 2013 07:56:18 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-12</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@RSCShadow RSCShadow]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rscshadow">@RSCShadow</a> wrote:</p>
          <blockquote>
              <p>That PHP is terrible.</p>
<pre><code class="lang-auto">		function encode($char) {
			$char = strtolower($char);
			$hash = 0;
			for ( $i = 0; $i &lt; strlen($char); $i++ ) {
				$c = ord($char[$i]);
				$hash = bcmul($hash, 37);
				if ( $c &gt;= 97 &amp;&amp; $c &lt;= 122 ) 
					$hash = bcadd($hash, (1 + $c) - 97);
				else if ( $c &gt;= 48 &amp;&amp; $c &lt;= 57 ) 
					$hash = bcadd($hash, (27 + $c) - 48);
			}
						
			$split_decimal = @explode('.', $hash);
			return is_array($split_decimal) ? $split_decimal[0] : $hash;
		}</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/11">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/11</link>
        <pubDate>Sat, 06 Apr 2013 07:37:59 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-11</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@tigerclan tigerclan]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/tigerclan">@tigerclan</a> wrote:</p>
          <blockquote>
              <p>Okay so I figured out that “user” is just the username converted to long. The only problem I’m having now is converting the requested username to long in php during registration.</p>
<p>Here’s what I have now:</p>
<p>[code]<br>
function usernameToHash($s) {<br>
$s=strtolower($s);<br>
$s1="";<br>
for($i=0;$i&lt;strlen($s);$i++) {<br>
$c=substr($s,$i);<br>
if(preg_match(’/^[a-z]+$/i’,$c)) {<br>
$s1=$s1+$c;<br>
} else if(ctype_digit($c)) {<br>
$s1=$s1+$c;<br>
} else {<br>
$s1=$s1+’ ';<br>
}<br>
}</p>
<pre><code>$s1=trim($s1);

if(strlen($s1)&gt;12) {
$s1=substr($s1,0,12);
}

for($j=0;$j&lt;strlen($s1);$j++) {
$c1=substr($s1,$j);
$l=37*$l;
if(preg_match('/^[a-z]+$/i',$c1)) {
    $l=(((1+$c1)-97)+$l);
} else if(ctype_digit($c1)) {
    $l=(((27+$c1)-48)+$l);
}
}
$hashedUsername=$l;
</code></pre>
<p>}[/code]</p>
<p>$hashedUsername is always equal to 0 though. Any help?</p>
<p>edit: Original code for anyone fluent in php:</p>
<p>[code]<br>
public static long usernameToHash(String s) {<br>
s = s.toLowerCase();<br>
String s1 = “”;<br>
for (int i = 0; i &lt; s.length(); i++) {<br>
char c = s.charAt(i);<br>
if (c &gt;= ‘a’ &amp;&amp; c &lt;= ‘z’)<br>
s1 = s1 + c;<br>
else if (c &gt;= ‘0’ &amp;&amp; c &lt;= ‘9’)<br>
s1 = s1 + c;<br>
else<br>
s1 = s1 + ’ ';<br>
}</p>
<pre><code>s1 = s1.trim();
if (s1.length() &gt; 12)
    s1 = s1.substring(0, 12);
long l = 0L;
for (int j = 0; j &lt; s1.length(); j++) {
    char c1 = s1.charAt(j);
    l *= 37L;
    if (c1 &gt;= 'a' &amp;&amp; c1 &lt;= 'z')
	l += (1 + c1) - 97;
    else if (c1 &gt;= '0' &amp;&amp; c1 &lt;= '9')
	l += (27 + c1) - 48;
}
return l;
}[/code]</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/10</link>
        <pubDate>Sat, 06 Apr 2013 04:39:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-10</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@RSCShadow RSCShadow]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rscshadow">@RSCShadow</a> wrote:</p>
          <blockquote>
              <p>[quote=“tigerclan, post:8, topic:514416”]edit: Alright, can someone actually reply? I have my LoginServer setup to use MySQL with PersistenceAuth. On my registration page I have it set user, username, and owner_username to the same value, and I hash the password with md5. I still get invalid username/password response every single time. And I have absolutely no idea what to put in the “owner” field(which is an int)[/quote]<code>owner</code> was used for the PunBB forums with original RSCD to attach a forum account to the ingame one. I’m pretty sure it’s unnecessary now.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/9</link>
        <pubDate>Fri, 05 Apr 2013 21:12:39 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-9</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@tigerclan tigerclan]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/tigerclan">@tigerclan</a> wrote:</p>
          <blockquote>
              <p>edit: Alright, can someone actually reply? I have my LoginServer setup to use MySQL with PersistenceAuth. On my registration page I have it set user, username, and owner_username to the same value, and I hash the password with md5. I still get invalid username/password response every single time. And I have absolutely no idea what to put in the “owner” field(which is an int)</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/8</link>
        <pubDate>Thu, 04 Apr 2013 21:50:21 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-8</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@RSCShadow RSCShadow]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rscshadow">@RSCShadow</a> wrote:</p>
          <blockquote>
              <p>[quote=“CodeForFame, post:5, topic:514416”][quote author=RSCShadow link=topic=632667.msg4277414#msg4277414 date=1365110939]</p>
<p>[quote=tigerclan]edit2: upon further investigation it seems that only the username is hashed? but its hashed in a way that it can be dehashed. So I dont get how that is supposed to be secure whatsoever if the only thing that is hashed is able to be dehashed. and this wouldnt work anyways because if someone got a hold of the table data and the site had a highscore the could just compare stats and guess the username and then use the unhashed password. maybe im just overlooking the method that hashes the password[/quote]I don’t know why it was called a hash to begin with but it isn’t a hash and isn’t even necessary to store on the SQL to begin with. All it is is their username converted to a long used a few times when being sent to the client from the server and vice versa. It isn’t used for an actual security measure.</p>
<p>[code=Python]def username_to_hash(username):<br>
username_hash = 0L<br>
username = username.lower()</p>
<pre><code>for c in username:
	character = ord(c)
	username_hash *= 37
	
	if character &gt;= 97 and character &lt;= 122:
		username_hash += (1 + character) - 97
	elif character &gt;= 48 and character &lt;= 57:
		username_hash += (27 + character) - 48
		
return username_hash[/code]
</code></pre>
<p>[/quote]It’s encoded because Jagex doesn’t like sending strings, especially when they were able to convert usernames to a single long.[/quote]I said it wasn’t a security measure because he worded it as if it was being stored on the server as if it was. I know why Jagex used longs.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/7</link>
        <pubDate>Thu, 04 Apr 2013 21:44:35 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-7</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@imthenull imthenull]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/imthenull">@imthenull</a> wrote:</p>
          <blockquote>
              <p>fun fact: in early RSC clients the password was encrypted with RSA keys before being sent to the server.</p>
<p><a href="https://bitbucket.org/Hikilaka/mudclient-140/src/4bd44271cbe6/src/jagex/socket.java?at=master" data-bbcode="true" rel="nofollow noopener">Here’s how it was encrypted</a></p>
<p>[code=java]public void prsastr(String str, int sessionid, BigInteger exponent, BigInteger modulus) {<br>
byte bytes[] = str.getBytes();<br>
int strlen = bytes.length;<br>
byte magnitude[] = new byte[15];</p>
<pre><code>for (int i = 0; i &lt; strlen; i += 7) {
	magnitude[0] = (byte)(int)(1.0D + Math.random() * 127D);
	magnitude[1] = (byte)(int)(Math.random() * 256D);
	magnitude[2] = (byte)(int)(Math.random() * 256D);
	magnitude[3] = (byte)(int)(Math.random() * 256D);
	util.p4(magnitude, 4, sessionid);

	for (int l = 0; l &lt; 7; l++) {
		if (i + l &lt; strlen) {
			magnitude[8 + l] = bytes[i + l];
		} else {
			magnitude[8 + l] = 32;
		}
	}

	BigInteger bigint = new BigInteger(1, magnitude).modPow(exponent, modulus);
	byte dat[] = bigint.toByteArray();
	data[pos++] = (byte) dat.length;
	for (int j = 0; j &lt; dat.length; j++) {
		data[pos++] = dat[j];
	}
}
</code></pre>
<p>}[/code]</p>
<p><a href="https://bitbucket.org/Hikilaka/140-gameserver/src/ecccf432b8648cdac734f4d6b83c4e8a88f7922b/RuneScape%20GameServer/src/com/runescape/gameserver/core/util/Conversions.java?at=master" data-bbcode="true" rel="nofollow noopener">And my decryption algorithm:</a></p>
<p>[code=java]public static String decodeRSA(Packet packet, int sessionId) throws PacketReadException {<br>
String password = “”;<br>
do {<br>
int length = packet.readByte();<br>
byte[] magnitude = packet.readBytes(length);<br>
byte[] decoded = new BigInteger(1, magnitude).modPow(Settings.EXPONENT, Settings.MODULUS).toByteArray();<br>
Packet p = new Packet(null, -1, decoded).skip(4); //skip the random bytes<br>
int id = p.readInt();</p>
<pre><code>	if (id != sessionId) {
		// return an invalid response to the client
		// attempted session hijack
		return null;
	}

	byte[] chars = p.readBytes(p.remaining());
	password += new String(chars);
} while (packet.remaining() &gt; 4);
return password.trim();
</code></pre>
<p>}[/code]</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/6</link>
        <pubDate>Thu, 04 Apr 2013 21:39:12 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-6</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@CodeForFame CodeForFame]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/codeforfame">@CodeForFame</a> wrote:</p>
          <blockquote>
              <p>[quote=“RSCShadow, post:4, topic:514416”][quote=tigerclan]edit2: upon further investigation it seems that only the username is hashed? but its hashed in a way that it can be dehashed. So I dont get how that is supposed to be secure whatsoever if the only thing that is hashed is able to be dehashed. and this wouldnt work anyways because if someone got a hold of the table data and the site had a highscore the could just compare stats and guess the username and then use the unhashed password. maybe im just overlooking the method that hashes the password[/quote]I don’t know why it was called a hash to begin with but it isn’t a hash and isn’t even necessary to store on the SQL to begin with. All it is is their username converted to a long used a few times when being sent to the client from the server and vice versa. It isn’t used for an actual security measure.</p>
<p>[code=Python]def username_to_hash(username):<br>
username_hash = 0L<br>
username = username.lower()</p>
<pre><code>for c in username:
	character = ord(c)
	username_hash *= 37
	
	if character &gt;= 97 and character &lt;= 122:
		username_hash += (1 + character) - 97
	elif character &gt;= 48 and character &lt;= 57:
		username_hash += (27 + character) - 48
		
return username_hash[/code][/quote]It's encoded because Jagex doesn't like sending strings, especially when they were able to convert usernames to a single long.</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/5</link>
        <pubDate>Thu, 04 Apr 2013 21:33:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-5</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@RSCShadow RSCShadow]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rscshadow">@RSCShadow</a> wrote:</p>
          <blockquote>
              <blockquote>edit2: upon further investigation it seems that only the username is hashed? but its hashed in a way that it can be dehashed. So I dont get how that is supposed to be secure whatsoever if the only thing that is hashed is able to be dehashed. and this wouldnt work anyways because if someone got a hold of the table data and the site had a highscore the could just compare stats and guess the username and then use the unhashed password. maybe im just overlooking the method that hashes the password</blockquote>I don't know why it was called a hash to begin with but it isn't a hash and isn't even necessary to store on the SQL to begin with. All it is is their username converted to a long used a few times when being sent to the client from the server and vice versa. It isn't used for an actual security measure.
<p>[code=Python]def username_to_hash(username):<br>
username_hash = 0L<br>
username = username.lower()</p>
<pre><code>for c in username:
	character = ord(c)
	username_hash *= 37
	
	if character &gt;= 97 and character &lt;= 122:
		username_hash += (1 + character) - 97
	elif character &gt;= 48 and character &lt;= 57:
		username_hash += (27 + character) - 48
		
return username_hash[/code]</code></pre>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/4</link>
        <pubDate>Thu, 04 Apr 2013 21:28:59 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-4</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@tigerclan tigerclan]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/tigerclan">@tigerclan</a> wrote:</p>
          <blockquote>
              <aside class="quote" data-post="2" data-topic="514416">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.moparisthebest.com/letter_avatar/rodgerwilco/40/5_e05bb34c421432ee4d40de30c10af3e5.png" class="avatar"> Rodgerwilco:</div>
<blockquote>
<p>the hash is md5</p>
</blockquote>
</aside>
<p>so the password is converted to md5 before being sent to auth.php? Also I have the default auth.php in my wamp www folder with just the word “YES” in it(because im still trying to figure out how the username/password are sent) and it still tells me I have an invalid username/password</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/3</link>
        <pubDate>Thu, 04 Apr 2013 20:31:52 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-3</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@Rodgerwilco Rodgerwilco]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/rodgerwilco">@Rodgerwilco</a> wrote:</p>
          <blockquote>
              <p>the hash is md5</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/2</link>
        <pubDate>Thu, 04 Apr 2013 19:51:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-2</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
      <item>
        <title>MoparClassic database info</title>
        <dc:creator><![CDATA[@tigerclan tigerclan]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/tigerclan">@tigerclan</a> wrote:</p>
          <blockquote>
              <p>I’m wondering which column(user, username, or ownerusername) is used for the actual login in the client. Also, what form of hashing is used for the password(md5, sha1, sha256, sha512?) and there is no salt for the hash?</p>
<p>edit: okay it seems that you need to have “user” be the actual username, and ownerusername is obviously the owner of the username. but what is the field “username” used for? And I still can’t find the code where the password is hashed. Im looking in MySQL.Java atm</p>
<p>edit2: upon further investigation it seems that only the username is hashed? but its hashed in a way that it can be dehashed. So I dont get how that is supposed to be secure whatsoever if the only thing that is hashed is able to be dehashed. and this wouldnt work anyways because if someone got a hold of the table data and the site had a highscore the could just compare stats and guess the username and then use the unhashed password. maybe im just overlooking the method that hashes the password</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/moparclassic-database-info/514416/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/moparclassic-database-info/514416/1</link>
        <pubDate>Thu, 04 Apr 2013 18:04:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-514416-1</guid>
        <source url="https://forum.moparisthebest.com/t/moparclassic-database-info/514416.rss">MoparClassic database info</source>
      </item>
  </channel>
</rss>
