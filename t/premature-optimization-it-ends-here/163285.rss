<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Premature optimization. It ends here</title>
    <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285</link>
    <description>Premature optimization is the (pointless) act of optimizing pre-production code, i.e. trying to solve performance issues before they exist.

Here&#39;s a question for you all:
Did you write the Java just-in-time optimizer? (That&#39;s the thing that turns a lot of your bytecode into machine code when you run your java application for a huge increase in performance. It&#39;s the thing that makes java not shit-slow.)
No? So how could you know what it&#39;s optimizing and what it isn&#39;t? You can&#39;t.

Sure, to a point you all should be optimizing your code as you write it, but not to the extent of not creating objects because you&#39;re worried about the overhead (stunningly, I&#39;ve seen quite a lot of that around here.)
The way to develop an application is to code first, then run a profiler to tell you where the performance bottlenecks occur. This not only saves time, but is much more accurate then you trying to guess where the JIT optimizer is going to speed up your code.

[i]&quot;We should forget about small efficiencies, say about 97% of the time: premature optimization is the root of all evil.&quot;[/i] (Knuth, Donald. Structured Programming with go to Statements, ACM Journal Computing Surveys, Vol 6, No. 4, Dec. 1974. p.268.)
If you don&#39;t believe me, or Donald Knuth, see [url=http://www.google.co.uk/search?q=premature+optimization]http://www.google.co.uk/search?q=premature+optimization[/url] and see for yourself.


[u]Some profilers you can get for java..[/u]
[url=http://www.yourkit.com/]http://www.yourkit.com/[/url] - YourKit Java Profiler
[url=http://www.netbeans.org/]http://www.netbeans.org/[/url] - Netbeans profiler

[u]Personal experience[/u]
Having written an rsc private server based on RSCD, I can safely say that without profiling my application wouldn&#39;t be able to hold half the users it can today (frequently surpasses 300). I found performance bottlenecks in sections of code I would never have thought of, for example one method I was needlessly copying multi-dimensional object arrays saved me a lot of cpu time. 
And all in all it only took a day to go through the entire codebase (about 220 source files) and fix the slowest methods.

[u]Example[/u]
Thought it might be nice to get some screenshots of the Netbeans profiler in action, so I load it up and start my application. Let it run for a few minutes, then save a snapshot (snapshots allow more detailed analysis compared to live results), and found this:
[img]http://img139.imageshack.us/img139/5518/screenshotze6.png[/img]
That thing I circled, I didn&#39;t even realized that was still there! I added it as a quick hack, didn&#39;t intend for it to remain in the code base, much less to remain as a performance problem. Fortunately it&#39;s very easy to rectify the problem and remove the potential bottleneck.
As is the magic of profilers.</description>
    
    <lastBuildDate>Sun, 09 Dec 2007 04:42:34 +0000</lastBuildDate>
    <category>General Programming</category>
    <atom:link href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Premature optimization. It ends here</title>
        <dc:creator><![CDATA[@Stork Stork]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/stork">@Stork</a> wrote:</p>
          <blockquote>
              <p>You just described more or less every java application (if you omit the last 7 words). Kudos. Oh and no, my source hasn’t been released.</p>
<p>In the standard (mostly) single-threaded game engine server model, actions are split pretty fairly between polling and events. Obviously the events are created from interactions from the user (i.e. incoming packets), but user and npc state-updating is all done via polling to avoid synchronization issues and greatly improve stability.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/10">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/10</link>
        <pubDate>Sun, 09 Dec 2007 04:42:34 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-163285-10</guid>
        <source url="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss">Premature optimization. It ends here</source>
      </item>
      <item>
        <title>Premature optimization. It ends here</title>
        <dc:creator><![CDATA[@sh_ft sh!ft]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/sh_ft">@sh_ft</a> wrote:</p>
          <blockquote>
              <p>The right combination of events and polls is what’s necessary, each player instance is event based… But things like npc’s are polled, mostly because they’re AI they don’t actually produce events naturally. Also, other players events, and other monsters events have to be polled to the each and every client connected to the server.</p>
<pre><code class="lang-auto">And all in all it only took a day to go through the entire codebase (about 220 source files) and fix the slowest methods.</code></pre>
<p>It’s strange that I have a source kind of like this on my PC already, isn’t it? Anyway, yeah, if this is the same source it means you have ~ 200 classes that are loaded through a class loader after reading an XML document which reports to the main engine, which packet does what for what id.</p>
<p>BTW, both of those optimization routines are rather sigh-worthy, try looking into JProfiler.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/9">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/9</link>
        <pubDate>Sun, 09 Dec 2007 03:58:47 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-163285-9</guid>
        <source url="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss">Premature optimization. It ends here</source>
      </item>
      <item>
        <title>Premature optimization. It ends here</title>
        <dc:creator><![CDATA[@Stork Stork]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/stork">@Stork</a> wrote:</p>
          <blockquote>
              <p>Alright, I misinterpreted that. Yeah you’re right about event based, I apologize.</p>
<p>I’ve never come across a bottleneck that needed fixing by redesigning. If the design is ‘good’ (i.e. well thought out) you won’t have such problems. Bottlenecks are almost always poorly designed/implemented algorithms, i.e. contained within a single class or method.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/8">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/8</link>
        <pubDate>Sun, 09 Dec 2007 03:37:45 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-163285-8</guid>
        <source url="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss">Premature optimization. It ends here</source>
      </item>
      <item>
        <title>Premature optimization. It ends here</title>
        <dc:creator><![CDATA[@k00dr k00dr]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/k00dr">@k00dr</a> wrote:</p>
          <blockquote>
              <p>[quote=“Stork, post:6, topic:163285”][quote author=Stork link=topic=221912.msg1919418#msg1919418 date=1197124478]<br>
Premature optimization is the (pointless) act of optimizing pre-production code, i.e. trying to solve performance issues before they exist.</p>
<p>Here’s a question for you all:<br>
Did you write the Java just-in-time optimizer? (That’s the thing that turns a lot of your bytecode into machine code when you run your java application for a huge increase in performance. It’s the thing that makes java not shit-slow.)<br>
No? So how could you know what it’s optimizing and what it isn’t? You can’t.</p>
<p>Sure, <span class="bbcode-b">to a point you all should be optimizing your code as you write it</span>[sup]1[/sup], …<br>
The way to develop an application is to <span class="bbcode-b">code first, then run a profiler to tell you where the performance bottlenecks occur</span>. This not only saves time, but is much more accurate then you trying to guess where the JIT optimizer is going to speed up your code.[/quote]</p>
<aside class="quote no-group">
<blockquote>
<p>Good topic. I like to think I have gotten out of it… <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>Designing the code is where the optimization should actively take place.<br>
Recalculating stuff is just stupid and inefficient when you can just cache the result.<br>
Why EVER have pollers when you can have events?</p>
</blockquote>
</aside>
<p>What were you reading? The point of the topic was that optimization should be done after the application works…</p>
<p>Your second point totally depends on the situation, and your third point is fairly invalid assuming I interpreted what you were saying correctly. (and event driven architecture usually isn’t as scalable – particularly applies to I/O in networking)<br>
Apologies if you were being sarcastic and I failed to pick it up.</p>
<p>And if anyone’s interested my server surpassed concurrent 430 users this evening ;)[/quote]</p>
<p>Yes. I read it. I got the point.</p>
<p>The second paragraph of my last post is kind of unrelated to the kind of optimization you’re talking about and I apologize for that. What I meant is that designing a optimal architecture is something that should be done BEFORE the application has been finished, because if the worst bottleneck happens to exist because of a sucky architecture, you can just enjoy redesigning and eventually rewriting the whole thing.</p>
<p>You <span class="bbcode-b">can</span> and <span class="bbcode-b">should</span> have event based I/O in networking, especially if it’s a server you’re writing.<br>
Locks are beautiful. I can already see the Thread.sleep(1) in there, ahh, what a waste of cycles…!</p>
<p>Congratulations on your server, though.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/7">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/7</link>
        <pubDate>Sun, 09 Dec 2007 03:10:30 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-163285-7</guid>
        <source url="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss">Premature optimization. It ends here</source>
      </item>
      <item>
        <title>Premature optimization. It ends here</title>
        <dc:creator><![CDATA[@Stork Stork]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/stork">@Stork</a> wrote:</p>
          <blockquote>
              <p>[quote=“Stork, post:1, topic:163285”]Premature optimization is the (pointless) act of optimizing pre-production code, i.e. trying to solve performance issues before they exist.</p>
<p>Here’s a question for you all:<br>
Did you write the Java just-in-time optimizer? (That’s the thing that turns a lot of your bytecode into machine code when you run your java application for a huge increase in performance. It’s the thing that makes java not shit-slow.)<br>
No? So how could you know what it’s optimizing and what it isn’t? You can’t.</p>
<p>Sure, <span class="bbcode-b">to a point you all should be optimizing your code as you write it</span>[sup]1[/sup], …<br>
The way to develop an application is to <span class="bbcode-b">code first, then run a profiler to tell you where the performance bottlenecks occur</span>. This not only saves time, but is much more accurate then you trying to guess where the JIT optimizer is going to speed up your code.[/quote]</p>
<p>[quote=“k00dr, post:3, topic:163285”]Good topic. I like to think I have gotten out of it… <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>Designing the code is where the optimization should actively take place.<br>
Recalculating stuff is just stupid and inefficient when you can just cache the result.<br>
Why EVER have pollers when you can have events?[/quote]<br>
What were you reading? The point of the topic was that optimization should be done after the application works…</p>
<p>Your second point totally depends on the situation, and your third point is fairly invalid assuming I interpreted what you were saying correctly. (and event driven architecture usually isn’t as scalable – particularly applies to I/O in networking)<br>
Apologies if you were being sarcastic and I failed to pick it up.</p>
<p>And if anyone’s interested my server surpassed concurrent 430 users this evening <img src="https://forum.moparisthebest.com/images/emoji/twitter/wink.png?v=6" title=":wink:" class="emoji" alt=":wink:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/6">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/6</link>
        <pubDate>Sun, 09 Dec 2007 01:30:43 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-163285-6</guid>
        <source url="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss">Premature optimization. It ends here</source>
      </item>
      <item>
        <title>Premature optimization. It ends here</title>
        <dc:creator><![CDATA[@moparisthebest Moparisthebest]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/moparisthebest">@moparisthebest</a> wrote:</p>
          <blockquote>
              <p>Thank you Stork! This problem has been especially prevalent in the ‘updaters’ people have been writing around here, having epeen fights when posting by posting the time the updater took to run.  As if a 30 second difference matters in a program you run 1-2 times a week…</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/5">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/5</link>
        <pubDate>Sat, 08 Dec 2007 21:57:26 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-163285-5</guid>
        <source url="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss">Premature optimization. It ends here</source>
      </item>
      <item>
        <title>Premature optimization. It ends here</title>
        <dc:creator><![CDATA[@Cheese_Police c|p]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/cheese_police">@Cheese_Police</a> wrote:</p>
          <blockquote>
              <p>Dare someone use this on an rs2 server?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/4">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/4</link>
        <pubDate>Sat, 08 Dec 2007 21:51:44 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-163285-4</guid>
        <source url="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss">Premature optimization. It ends here</source>
      </item>
      <item>
        <title>Premature optimization. It ends here</title>
        <dc:creator><![CDATA[@k00dr k00dr]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/k00dr">@k00dr</a> wrote:</p>
          <blockquote>
              <p>Good topic. I like to think I have gotten out of it… <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
<p>Designing the code is where the optimization should actively take place.<br>
Recalculating stuff is just stupid and inefficient when you can just cache the result.<br>
Why EVER have pollers when you can have events?</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/3</link>
        <pubDate>Sat, 08 Dec 2007 19:53:51 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-163285-3</guid>
        <source url="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss">Premature optimization. It ends here</source>
      </item>
      <item>
        <title>Premature optimization. It ends here</title>
        <dc:creator><![CDATA[@Greeny Greeny]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/greeny">@Greeny</a> wrote:</p>
          <blockquote>
              <p>Awesome, I’ve never tried the netbeans one. So will give it a shot now on some old shitty project heh.</p>
<p>&lt;3</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/2</link>
        <pubDate>Sat, 08 Dec 2007 19:43:28 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-163285-2</guid>
        <source url="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss">Premature optimization. It ends here</source>
      </item>
      <item>
        <title>Premature optimization. It ends here</title>
        <dc:creator><![CDATA[@Stork Stork]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/stork">@Stork</a> wrote:</p>
          <blockquote>
              <p>Premature optimization is the (pointless) act of optimizing pre-production code, i.e. trying to solve performance issues before they exist.</p>
<p>Here’s a question for you all:<br>
Did you write the Java just-in-time optimizer? (That’s the thing that turns a lot of your bytecode into machine code when you run your java application for a huge increase in performance. It’s the thing that makes java not shit-slow.)<br>
No? So how could you know what it’s optimizing and what it isn’t? You can’t.</p>
<p>Sure, to a point you all should be optimizing your code as you write it, but not to the extent of not creating objects because you’re worried about the overhead (stunningly, I’ve seen quite a lot of that around here.)<br>
The way to develop an application is to code first, then run a profiler to tell you where the performance bottlenecks occur. This not only saves time, but is much more accurate then you trying to guess where the JIT optimizer is going to speed up your code.</p>
<p><span class="bbcode-i">“We should forget about small efficiencies, say about 97% of the time: premature optimization is the root of all evil.”</span> (Knuth, Donald. Structured Programming with go to Statements, ACM Journal Computing Surveys, Vol 6, No. 4, Dec. 1974. p.268.)<br>
If you don’t believe me, or Donald Knuth, see <a href="http://www.google.co.uk/search?q=premature+optimization" data-bbcode="true" rel="nofollow noopener">http://www.google.co.uk/search?q=premature+optimization</a> and see for yourself.</p>
<p><span class="bbcode-u">Some profilers you can get for java…</span><br>
<a href="http://www.yourkit.com/" data-bbcode="true" rel="nofollow noopener">http://www.yourkit.com/</a> - YourKit Java Profiler<br>
<a href="http://www.netbeans.org/" data-bbcode="true" rel="nofollow noopener">http://www.netbeans.org/</a> - Netbeans profiler</p>
<p><span class="bbcode-u">Personal experience</span><br>
Having written an rsc private server based on RSCD, I can safely say that without profiling my application wouldn’t be able to hold half the users it can today (frequently surpasses 300). I found performance bottlenecks in sections of code I would never have thought of, for example one method I was needlessly copying multi-dimensional object arrays saved me a lot of cpu time.<br>
And all in all it only took a day to go through the entire codebase (about 220 source files) and fix the slowest methods.</p>
<p><span class="bbcode-u">Example</span><br>
Thought it might be nice to get some screenshots of the Netbeans profiler in action, so I load it up and start my application. Let it run for a few minutes, then save a snapshot (snapshots allow more detailed analysis compared to live results), and found this:<br>
<img src="http://img139.imageshack.us/img139/5518/screenshotze6.png" alt width="" height=""><br>
That thing I circled, I didn’t even realized that was still there! I added it as a quick hack, didn’t intend for it to remain in the code base, much less to remain as a performance problem. Fortunately it’s very easy to rectify the problem and remove the potential bottleneck.<br>
As is the magic of profilers.</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285/1</link>
        <pubDate>Sat, 08 Dec 2007 14:34:38 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-163285-1</guid>
        <source url="https://forum.moparisthebest.com/t/premature-optimization-it-ends-here/163285.rss">Premature optimization. It ends here</source>
      </item>
  </channel>
</rss>
