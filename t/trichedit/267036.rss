<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>TRichEdit</title>
    <link>https://forum.moparisthebest.com/t/trichedit/267036</link>
    <description>I&#39;ve been devoloping scripts for years and i&#39;ve always come back to mopar to leech off your awesome tuts so i decided to join to show my appreciation :p, but anyway, my problem is with TRichEdit.

I&#39;m trying to make an autotalker that you can have multiple lines of code(Editable by the user, thats why i&#39;m using rich edit) but every time i try to convert the strings to an array i fail, i&#39;ve tried a for loop to output RichEdit1.text but that just splurts out the whole thing. Can anyone help me? :)
Basically what i have is below, extracted from a much larger script.

[code]program Talker;
var
  frmDesign : TForm;
  RichEdit1 : TRichEdit;
  i : Integer;

procedure InitForm;
begin
  frmDesign := CreateForm;
  frmDesign.Left := 250;
  frmDesign.Top := 114;
  frmDesign.Width := 202;
  frmDesign.Height := 221;
  frmDesign.Caption := &#39;MoparForm&#39;;
  frmDesign.Color := clBtnFace;
  frmDesign.Font.Color := clWindowText;
  frmDesign.Font.Height := -11;
  frmDesign.Font.Name := &#39;MS Sans Serif&#39;;
  frmDesign.Font.Style := [];
  frmDesign.Visible := False;
  frmDesign.PixelsPerInch := 96;
  RichEdit1 := TRichEdit.Create(frmDesign);
  RichEdit1.Parent := frmDesign;
  RichEdit1.Left := 8;
  RichEdit1.Top := 8;
  RichEdit1.Width := 177;
  RichEdit1.Height := 169;
  RichEdit1.Lines.Add(&#39;Line 1&#39;);
  RichEdit1.Lines.Add(&#39;Line 2&#39;);
  RichEdit1.Lines.Add(&#39;Etc..&#39;);
  RichEdit1.TabOrder := 8;
end;

procedure SafeInitForm;
var
  v: TVariantArray;
begin
  setarraylength(V, 0);
  ThreadSafeCall(&#39;InitForm&#39;, v);
end;

procedure ShowFormModal;
begin
  frmDesign.ShowModal;
end;

procedure SafeShowFormModal;
var
  v: TVariantArray;
begin
  setarraylength(V, 0);
  ThreadSafeCall(&#39;ShowFormModal&#39;, v);
end;

begin
  SafeInitForm;
  SafeShowFormModal;
  for i := 1 to RichEdit1.Lines.Count do
   Writeln(RichEdit1.Text);
  FreeForm(frmDesign);
end.
//Thats as neat as i am making it =[[/code]

Thanks in advance for any help :)
Edit: Forgot to make the new form visible for you guys :p</description>
    
    <lastBuildDate>Thu, 12 Mar 2009 14:59:08 +0000</lastBuildDate>
    <category>Runescape</category>
    <atom:link href="https://forum.moparisthebest.com/t/trichedit/267036.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>TRichEdit</title>
        <dc:creator><![CDATA[@FrostFyr FrostFÿr]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frostfyr">@FrostFyr</a> wrote:</p>
          <blockquote>
              <p>May i ask how that works exactly? i don’t like being left with a line (or 4) of code :<br>
Other than that it works well, just have to remove the two boxes at the end and i’ll be fine <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Ty Nashi</p>
<p>Edit: After further inspection it seem the line.string is an array cause i’m so slow, thanks very much nashi i would have done it without you <img src="https://forum.moparisthebest.com/images/emoji/twitter/smiley.png?v=6" title=":smiley:" class="emoji" alt=":smiley:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/trichedit/267036/3">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/trichedit/267036/3</link>
        <pubDate>Thu, 12 Mar 2009 14:59:08 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-267036-3</guid>
        <source url="https://forum.moparisthebest.com/t/trichedit/267036.rss">TRichEdit</source>
      </item>
      <item>
        <title>TRichEdit</title>
        <dc:creator><![CDATA[@Nashi Nashi]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/nashi">@Nashi</a> wrote:</p>
          <blockquote>
              <p>Unfortunately, TStrings are gay so you’ll pretty much have to do this:</p>
<p>[code]var<br>
Buffer: TStringArray;</p>
<p>begin<br>
SafeInitForm;<br>
SafeShowFormModal;<br>
SetArrayLength(Buffer, RichEdit1.Lines.Count);<br>
for i := 0 to High(Buffer) do<br>
Buffer[i] := RichEdit1.Lines.Strings[i];<br>
for i := 0 to High(Buffer) do<br>
Writeln(Buffer[i]);<br>
FreeForm(frmDesign);<br>
end.[/code]</p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/trichedit/267036/2">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/trichedit/267036/2</link>
        <pubDate>Thu, 12 Mar 2009 10:53:40 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-267036-2</guid>
        <source url="https://forum.moparisthebest.com/t/trichedit/267036.rss">TRichEdit</source>
      </item>
      <item>
        <title>TRichEdit</title>
        <dc:creator><![CDATA[@FrostFyr FrostFÿr]]></dc:creator>
        <description><![CDATA[
          <p><a href="https://forum.moparisthebest.com/u/frostfyr">@FrostFyr</a> wrote:</p>
          <blockquote>
              <p>I’ve been devoloping scripts for years and i’ve always come back to mopar to leech off your awesome tuts so i decided to join to show my appreciation :p, but anyway, my problem is with TRichEdit.</p>
<p>I’m trying to make an autotalker that you can have multiple lines of code(Editable by the user, thats why i’m using rich edit) but every time i try to convert the strings to an array i fail, i’ve tried a for loop to output RichEdit1.text but that just splurts out the whole thing. Can anyone help me? <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
Basically what i have is below, extracted from a much larger script.</p>
<p>[code]program Talker;<br>
var<br>
frmDesign : TForm;<br>
RichEdit1 : TRichEdit;<br>
i : Integer;</p>
<p>procedure InitForm;<br>
begin<br>
frmDesign := CreateForm;<br>
frmDesign.Left := 250;<br>
frmDesign.Top := 114;<br>
frmDesign.Width := 202;<br>
frmDesign.Height := 221;<br>
frmDesign.Caption := ‘MoparForm’;<br>
frmDesign.Color := clBtnFace;<br>
frmDesign.Font.Color := clWindowText;<br>
frmDesign.Font.Height := -11;<br>
frmDesign.Font.Name := ‘MS Sans Serif’;<br>
frmDesign.Font.Style := [];<br>
frmDesign.Visible := False;<br>
frmDesign.PixelsPerInch := 96;<br>
RichEdit1 := TRichEdit.Create(frmDesign);<br>
RichEdit1.Parent := frmDesign;<br>
RichEdit1.Left := 8;<br>
RichEdit1.Top := 8;<br>
RichEdit1.Width := 177;<br>
RichEdit1.Height := 169;<br>
RichEdit1.Lines.Add(‘Line 1’);<br>
RichEdit1.Lines.Add(‘Line 2’);<br>
RichEdit1.Lines.Add(‘Etc…’);<br>
RichEdit1.TabOrder := 8;<br>
end;</p>
<p>procedure SafeInitForm;<br>
var<br>
v: TVariantArray;<br>
begin<br>
setarraylength(V, 0);<br>
ThreadSafeCall(‘InitForm’, v);<br>
end;</p>
<p>procedure ShowFormModal;<br>
begin<br>
frmDesign.ShowModal;<br>
end;</p>
<p>procedure SafeShowFormModal;<br>
var<br>
v: TVariantArray;<br>
begin<br>
setarraylength(V, 0);<br>
ThreadSafeCall(‘ShowFormModal’, v);<br>
end;</p>
<p>begin<br>
SafeInitForm;<br>
SafeShowFormModal;<br>
for i := 1 to RichEdit1.Lines.Count do<br>
Writeln(RichEdit1.Text);<br>
FreeForm(frmDesign);<br>
end.<br>
//Thats as neat as i am making it =[[/code]</p>
<p>Thanks in advance for any help <img src="https://forum.moparisthebest.com/images/emoji/twitter/slight_smile.png?v=6" title=":slight_smile:" class="emoji" alt=":slight_smile:"><br>
Edit: Forgot to make the new form visible for you guys <img src="https://forum.moparisthebest.com/images/emoji/twitter/stuck_out_tongue.png?v=6" title=":stuck_out_tongue:" class="emoji" alt=":stuck_out_tongue:"></p>
          </blockquote>
          <p><a href="https://forum.moparisthebest.com/t/trichedit/267036/1">Read full topic</a></p>
        ]]></description>
        <link>https://forum.moparisthebest.com/t/trichedit/267036/1</link>
        <pubDate>Thu, 12 Mar 2009 09:58:58 +0000</pubDate>
        <guid isPermaLink="false">forum.moparisthebest.com-post-267036-1</guid>
        <source url="https://forum.moparisthebest.com/t/trichedit/267036.rss">TRichEdit</source>
      </item>
  </channel>
</rss>
