<!DOCTYPE html>
<html lang="en-US">
  
<!-- Mirrored from forum.moparisthebest.com/t/disabling-graphics-to-save-cpu/304611 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 07:55:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Disabling graphics to save cpu - Runescape - moparisthebest.com</title>
    <meta name="description" content="hi. So the class we want to modify is the class the client is extending (aka Applet_Sub1 aka the class that extends java.applet.Applet). The method calls we want to patch are in the &amp;quot;run&amp;quot; method of this class. One of the&amp;hellip;">
    <meta name="generator" content="Discourse 2.3.2 - https://github.com/discourse/discourse version c587df7e2a03c2962f4c8cefd6f03969bb87d525">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/2X/1/1f0dc167bcf798bdbd70b03bf0fd1bc836e54e1a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff_2_180x180.png">
<meta name="theme-color" content="#0088cc">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="304611.html" />
<script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","url":"https://forum.moparisthebest.com","potentialAction":{"@type":"SearchAction","target":"https://forum.moparisthebest.com/search?q={search_term_string}","query-input":"required name=search_term_string"}}</script>
<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="moparisthebest.com Search">

      <link href="../../stylesheets/desktop_1_ec9f75e3d0b2a904642ce53663991837b70cda3334fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop" data-theme-id="2"/>
      <link href="../../stylesheets/desktop_theme_2_6707e7ee46ac9f2f0510c29ddd10e8f6ce21c1ae34fc.css?__ws=forum.moparisthebest.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2"/>
    
    
      <link rel="alternate" type="application/rss+xml" title="RSS feed of &#39;Disabling graphics to save cpu&#39;" href="304611.rss" />
  <meta property="og:site_name" content="moparisthebest.com" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:image" content="https://forum.moparisthebest.com/uploads/default/original/2X/4/41fecb6185fddc2758aeba68c3f8c9c78e26e4ff.png" />
<meta property="og:url" content="https://forum.moparisthebest.com/t/disabling-graphics-to-save-cpu/304611" />
<meta name="twitter:url" content="https://forum.moparisthebest.com/t/disabling-graphics-to-save-cpu/304611" />
<meta property="og:title" content="Disabling graphics to save cpu" />
<meta name="twitter:title" content="Disabling graphics to save cpu" />
<meta property="og:description" content="hi. So the class we want to modify is the class the client is extending (aka Applet_Sub1 aka the class that extends java.applet.Applet). The method calls we want to patch are in the “run” method of this class. One of the methods we want to block is inside this class. It is a private method that contains the SIPUSH value of 32000. So basically in the run method we will find a call to this method and another call to a static method directly after it. These are the 2 methods we want to block.  Here..." />
<meta name="twitter:description" content="hi. So the class we want to modify is the class the client is extending (aka Applet_Sub1 aka the class that extends java.applet.Applet). The method calls we want to patch are in the “run” method of this class. One of the methods we want to block is inside this class. It is a private method that contains the SIPUSH value of 32000. So basically in the run method we will find a call to this method and another call to a static method directly after it. These are the 2 methods we want to block.  Here..." />
<meta property="article:published_time" content="2009-09-27T01:53:19+00:00" />
<meta property="og:ignore_canonical" content="true" />



    
  </head>
  <body class="crawler">
    
    <header>
      <a href="../../index.html">
          <img src="../../uploads/default/original/2X/3/37bba8fb3bd06c372ab54fa72ec38bf9f8f40b37.gif" alt="moparisthebest.com" id="site-logo" style="max-width: 150px;">
      </a>
    </header>
    <div id="main-outlet" class="wrap">
      <h1 class="crawler-topic-title">
  <a href="304611.html">Disabling graphics to save cpu</a>
</h1>

<div id='breadcrumbs'>
    <div id="breadcrumb-0" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
        itemref="breadcrumb-1"
      >
      <a href="../../c/games.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Games</span>
      </a>
    </div>
    <div id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb"
>
      <a href="../../c/games/runescape.html" itemprop="url" class='badge-wrapper bullet'>
        <span class="badge-category-bg"></span>
        <span itemprop="title" class='category-title'>Runescape</span>
      </a>
    </div>
</div>





  <div itemscope itemtype='http://schema.org/DiscussionForumPosting' class='topic-body crawler-post'>
      <div class='crawler-post-meta'>
        <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a itemprop="url" href='../../u/marluxia.html'><span itemprop='name'>marluxia</span></a>
          
        </span>

        <span class="crawler-post-infos">
            <meta itemprop='datePublished' content='2009-09-27T01:53:19Z'>
            <time itemprop='dateModified' datetime='2016-07-31T11:18:09Z' class='post-time'>
              July 31, 2016, 11:18am
            </time>
        <span itemprop='position'>#1</span>
        </span>
      </div>
      <div class='post' itemprop='articleBody'>
        <p>hi. So the class we want to modify is the class the client is extending (aka Applet_Sub1 aka the class that extends java.applet.Applet). The method calls we want to patch are in the “run” method of this class. One of the methods we want to block is inside this class. It is a private method that contains the SIPUSH value of 32000. So basically in the run method we will find a call to this method and another call to a static method directly after it. These are the 2 methods we want to block.</p>
<p>Here is the deobbed run method from the current client revision.</p>
<pre><code class="lang-auto">    public final void run() {
	do {
	    try {
		if (Class10.aString177 != null) {
		    String string = Class10.aString177.toLowerCase();
		    if ((string.indexOf("sun") ^ 0xffffffff) == 0
			&amp;&amp; string.indexOf("apple") == -1) {
			if (string.indexOf("ibm") != -1
			    &amp;&amp; (Class10.aString176 == null
				|| Class10.aString176.equals("1.4.2"))) {
			    method43("wrongjava", 10);
			    break;
			}
		    } else {
			String string_14_ = Class10.aString176;
			if (string_14_.equals("1.1")
			    || string_14_.startsWith("1.1.")
			    || string_14_.equals("1.2")
			    || string_14_.startsWith("1.2.")) {
			    method43("wrongjava", 10);
			    break;
			}
		    }
		}
		if (Class10.aString176 != null
		    &amp;&amp; Class10.aString176.startsWith("1.")) {
		    int i = 2;
		    int i_15_ = 0;
		    while (i &lt; Class10.aString176.length()) {
			int i_16_ = Class10.aString176.charAt(i);
			if (i_16_ &lt; 48 || i_16_ &gt; 57)
			    break;
			i++;
			i_15_ = 10 * i_15_ - (-i_16_ + 48);
		    }
		    if (i_15_ &gt;= 5)
			Class53.aBoolean846 = true;
		}
		if (Class186_Sub13.aClass10_4236.anApplet183 != null) {
		    Method method = Class10.aMethod196;
		    if (method != null) {
			try {
			    method.invoke((Class186_Sub13.aClass10_4236
					   .anApplet183),
					  new Object[] { Boolean.TRUE });
			} catch (Throwable throwable) {
			    /* empty */
			}
		    }
		}
		Class108.method1236(-115);
		Class186_Sub18.method2163((byte) 52);
		method37(0);
		method53(-22253);
		Class186_Sub29.aClass141_4526 = Class39.method533(true);
		method36(0);
		while (Class118.aLong1642 == 0L
		       || Class118.aLong1642 &gt; Class101.method1197(27104)) {
			    Class155.anInt2344
				= Class186_Sub29.aClass141_4526
				      .method1510(false, Class3.anInt3242);
			    for (int i = 0; Class155.anInt2344 &gt; i; i++)
				method42((byte) 6);

			    method54((byte) -104);
			    Class214_Sub2.method2828(Class54.aCanvas868, -128,
					Class186_Sub13.aClass10_4236);
		}
	    } catch (Exception exception) {
		Class25.method284(exception, 127, null);
		method43("crash", 10);
	    }
	} while (false);
	anInt13++;
	method41(-1074, true);
    }</code></pre>
<p>See this bit</p>
<blockquote>while (Class118.aLong1642 == 0L
		       || Class118.aLong1642 &gt; Class101.method1197(27104)) {
			    Class155.anInt2344
				= Class186_Sub29.aClass141_4526
				      .method1510(false, Class3.anInt3242);
			    for (int i = 0; Class155.anInt2344 &gt; i; i++)
				method42((byte) 6);
<pre><code>		    [b]method54((byte) -104);
		    Class214_Sub2.method2828(Class54.aCanvas868, -128,
				Class186_Sub13.aClass10_4236);[/b]
	}&lt;/blockquote&gt;
</code></pre>
<p>We want to cockblock the method calls “method54” and “Class214_Sub2.method2828” (highlighted in bold). Basically we want to do some shit like…</p>
<blockquote>while (Class118.aLong1642 == 0L
		       || Class118.aLong1642 &gt; Class101.method1197(27104)) {
			    Class155.anInt2344
				= Class186_Sub29.aClass141_4526
				      .method1510(false, Class3.anInt3242);
			    for (int i = 0; Class155.anInt2344 &gt; i; i++)
				method42((byte) 6);
<pre><code>		    [i]if(Controller.isEnabled()) {
		        [b]method54((byte) -104);
		        Class214_Sub2.method2828(Class54.aCanvas868, -128,
				Class186_Sub13.aClass10_4236);[/b]
		    [/i]}
	}&lt;/blockquote&gt;
</code></pre>
<p>…Create a check to a variable we control. The javaagent (javaagents turn me on!) I have attached does exactly this. Heres the transformer source for those whole cbf to download :mad:.</p>
<p>[code]import java.io.ByteArrayInputStream;<br>
import java.lang.instrument.ClassFileTransformer;<br>
import java.security.ProtectionDomain;<br>
import com.sun.org.apache.bcel.internal.classfile.<em>;<br>
import com.sun.org.apache.bcel.internal.generic.</em>;</p>
<p>public class Transformer implements ClassFileTransformer {</p>
<pre><code>public byte[] transform(ClassLoader cl, String name, Class c, ProtectionDomain pd, byte[] data) {
	if(name.contains("/") || name.equals("loader")) {
		return null;
	}
	try {
		ClassGen cg = new ClassGen(new ClassParser(new ByteArrayInputStream(data), name).parse());
		ConstantPoolGen cpg = cg.getConstantPool();
		if(cg.getSuperclassName().equals("java.applet.Applet")) {
			InstructionHandle target = null;
			InstructionHandle to = null;
			Method m;
			if((m = cg.containsMethod("run", "()V")) == null) {
				throw new RuntimeException(name + " does not extend Runnable!");
			}
			MethodGen mg = new MethodGen(m, name, cpg);
			InstructionList il = mg.getInstructionList();

			for(InstructionHandle ih : il.getInstructionHandles()) {
				Instruction in = ih.getInstruction();

				if(in instanceof INVOKESPECIAL) {
					if(ih.getPrev().getPrev().getInstruction() instanceof LoadInstruction)
						target = ih.getPrev().getPrev();
				} else if(target != null &amp;&amp; in instanceof INVOKESTATIC) {
					Type[] types = ((INVOKESTATIC)in).getArgumentTypes(cpg);
					if(types.length &gt;= 2) for(Type t : types) 
						if(t.equals(Type.OBJECT)) {
							to = ih.getNext();
							break;
						}
				}
			}
			if(to != null) {
				il.insert(target, new IFEQ(to));
				il.insert(target.getPrev(), new INVOKESTATIC(
					cpg.addMethodref("Controller", "isEnabled", "()Z")));

				mg.setInstructionList(il);
				cg.replaceMethod(m, mg.getMethod());

				return cg.getJavaClass().getBytes();
			}
		}
	} catch(Exception ex) {
		ex.printStackTrace();
	}
	return null;
}
</code></pre>
<p>}[/code]</p>
<p>CPU usage we will be at around 0% - 1% most of the time but sometimes it will fluctuate to 10%+. You can experiment and try to block some more method calls, I don’t really know what will happen <img src="../../images/emoji/twitter/confusedae52.png?v=5" title=":confused:" class="emoji" alt=":confused:">. Oh ye, the “actionsystem” still seems to work I think (I can click on shit and it does the action).</p>
</blockquote>
</blockquote>
      </div>

      <meta itemprop='headline' content='Disabling graphics to save cpu'>

      <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
         <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
         <meta itemprop="userInteractionCount" content="0" />
         <span class='post-likes'></span>
       </div>

       <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
          <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
          <meta itemprop="userInteractionCount" content="0" />
        </div>


  </div>






    </div>
    <footer class="container wrap">
      <nav class='crawler-nav' itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <ul>
        <li itemprop="name"><a href='../../index.html' itemprop="url">Home </a></li>
        <li itemprop="name"><a href='../../categories.html' itemprop="url">Categories </a></li>
        <li itemprop="name"><a href='../../guidelines.html' itemprop="url">FAQ/Guidelines </a></li>
        <li itemprop="name"><a href='../../tos.html' itemprop="url">Terms of Service </a></li>
        <li itemprop="name"><a href='../../privacy.html' itemprop="url">Privacy Policy </a></li>
        </ul>
      </nav>
      <p class='powered-by-link'>Powered by <a href="https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
    </footer>
    
  </body>
  

<!-- Mirrored from forum.moparisthebest.com/t/disabling-graphics-to-save-cpu/304611 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Aug 2019 07:55:15 GMT -->
</html>
